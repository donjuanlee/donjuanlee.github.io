window.__require=function t(e,i,s){function n(o,l){if(!i[o]){if(!e[o]){var r=o.split("/");if(r=r[r.length-1],!e[r]){var c="function"==typeof __require&&__require;if(!l&&c)return c(r,!0);if(a)return a(r,!0);throw new Error("Cannot find module '"+o+"'")}o=r}var _=i[o]={exports:{}};e[o][0].call(_.exports,function(t){return n(e[o][1][t]||t)},_,_.exports,t,e,i,s)}return i[o].exports}for(var a="function"==typeof __require&&__require,o=0;o<s.length;o++)n(s[o]);return n}({1:[function(t,e,i){"use strict";i.byteLength=function(t){var e=c(t),i=e[0],s=e[1];return 3*(i+s)/4-s},i.toByteArray=function(t){var e,i,s=c(t),o=s[0],l=s[1],r=new a(_(t,o,l)),h=0,d=l>0?o-4:o;for(i=0;i<d;i+=4)e=n[t.charCodeAt(i)]<<18|n[t.charCodeAt(i+1)]<<12|n[t.charCodeAt(i+2)]<<6|n[t.charCodeAt(i+3)],r[h++]=e>>16&255,r[h++]=e>>8&255,r[h++]=255&e;2===l&&(e=n[t.charCodeAt(i)]<<2|n[t.charCodeAt(i+1)]>>4,r[h++]=255&e);1===l&&(e=n[t.charCodeAt(i)]<<10|n[t.charCodeAt(i+1)]<<4|n[t.charCodeAt(i+2)]>>2,r[h++]=e>>8&255,r[h++]=255&e);return r},i.fromByteArray=function(t){for(var e,i=t.length,n=i%3,a=[],o=0,l=i-n;o<l;o+=16383)a.push(d(t,o,o+16383>l?l:o+16383));1===n?(e=t[i-1],a.push(s[e>>2]+s[e<<4&63]+"==")):2===n&&(e=(t[i-2]<<8)+t[i-1],a.push(s[e>>10]+s[e>>4&63]+s[e<<2&63]+"="));return a.join("")};for(var s=[],n=[],a="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",l=0,r=o.length;l<r;++l)s[l]=o[l],n[o.charCodeAt(l)]=l;function c(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var i=t.indexOf("=");return-1===i&&(i=e),[i,i===e?0:4-i%4]}function _(t,e,i){return 3*(e+i)/4-i}function h(t){return s[t>>18&63]+s[t>>12&63]+s[t>>6&63]+s[63&t]}function d(t,e,i){for(var s,n=[],a=e;a<i;a+=3)s=(t[a]<<16&16711680)+(t[a+1]<<8&65280)+(255&t[a+2]),n.push(h(s));return n.join("")}n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63},{}],2:[function(t,e,i){(function(e){"use strict";var s=t("base64-js"),n=t("ieee754"),a=t("isarray");function o(){return r.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function l(t,e){if(o()<e)throw new RangeError("Invalid typed array length");return r.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=r.prototype:(null===t&&(t=new r(e)),t.length=e),t}function r(t,e,i){if(!(r.TYPED_ARRAY_SUPPORT||this instanceof r))return new r(t,e,i);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return d(this,t)}return c(this,t,e,i)}function c(t,e,i,s){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?f(t,e,i,s):"string"==typeof e?u(t,e,i):p(t,e)}function _(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function h(t,e,i,s){return _(e),e<=0?l(t,e):void 0!==i?"string"==typeof s?l(t,e).fill(i,s):l(t,e).fill(i):l(t,e)}function d(t,e){if(_(e),t=l(t,e<0?0:0|g(e)),!r.TYPED_ARRAY_SUPPORT)for(var i=0;i<e;++i)t[i]=0;return t}function u(t,e,i){if("string"==typeof i&&""!==i||(i="utf8"),!r.isEncoding(i))throw new TypeError('"encoding" must be a valid string encoding');var s=0|v(e,i),n=(t=l(t,s)).write(e,i);return n!==s&&(t=t.slice(0,n)),t}function m(t,e){var i=e.length<0?0:0|g(e.length);t=l(t,i);for(var s=0;s<i;s+=1)t[s]=255&e[s];return t}function f(t,e,i,s){if(e.byteLength,i<0||e.byteLength<i)throw new RangeError("'offset' is out of bounds");if(e.byteLength<i+(s||0))throw new RangeError("'length' is out of bounds");return e=void 0===i&&void 0===s?new Uint8Array(e):void 0===s?new Uint8Array(e,i):new Uint8Array(e,i,s),r.TYPED_ARRAY_SUPPORT?(t=e).__proto__=r.prototype:t=m(t,e),t}function p(t,e){if(r.isBuffer(e)){var i=0|g(e.length);return 0===(t=l(t,i)).length?t:(e.copy(t,0,0,i),t)}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||$(e.length)?l(t,0):m(t,e);if("Buffer"===e.type&&a(e.data))return m(t,e.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function g(t){if(t>=o())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o().toString(16)+" bytes");return 0|t}function v(t,e){if(r.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var i=t.length;if(0===i)return 0;for(var s=!1;;)switch(e){case"ascii":case"latin1":case"binary":return i;case"utf8":case"utf-8":case void 0:return Y(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*i;case"hex":return i>>>1;case"base64":return J(t).length;default:if(s)return Y(t).length;e=(""+e).toLowerCase(),s=!0}}function b(t,e,i){var s=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===i||i>this.length)&&(i=this.length),i<=0)return"";if((i>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return D(this,e,i);case"utf8":case"utf-8":return P(this,e,i);case"ascii":return U(this,e,i);case"latin1":case"binary":return A(this,e,i);case"base64":return x(this,e,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return L(this,e,i);default:if(s)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),s=!0}}function w(t,e,i){var s=t[e];t[e]=t[i],t[i]=s}function y(t,e,i,s,n){if(0===t.length)return-1;if("string"==typeof i?(s=i,i=0):i>2147483647?i=2147483647:i<-2147483648&&(i=-2147483648),i=+i,isNaN(i)&&(i=n?0:t.length-1),i<0&&(i=t.length+i),i>=t.length){if(n)return-1;i=t.length-1}else if(i<0){if(!n)return-1;i=0}if("string"==typeof e&&(e=r.from(e,s)),r.isBuffer(e))return 0===e.length?-1:C(t,e,i,s,n);if("number"==typeof e)return e&=255,r.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?n?Uint8Array.prototype.indexOf.call(t,e,i):Uint8Array.prototype.lastIndexOf.call(t,e,i):C(t,[e],i,s,n);throw new TypeError("val must be string, number or Buffer")}function C(t,e,i,s,n){var a,o=1,l=t.length,r=e.length;if(void 0!==s&&("ucs2"===(s=String(s).toLowerCase())||"ucs-2"===s||"utf16le"===s||"utf-16le"===s)){if(t.length<2||e.length<2)return-1;o=2,l/=2,r/=2,i/=2}function c(t,e){return 1===o?t[e]:t.readUInt16BE(e*o)}if(n){var _=-1;for(a=i;a<l;a++)if(c(t,a)===c(e,-1===_?0:a-_)){if(-1===_&&(_=a),a-_+1===r)return _*o}else-1!==_&&(a-=a-_),_=-1}else for(i+r>l&&(i=l-r),a=i;a>=0;a--){for(var h=!0,d=0;d<r;d++)if(c(t,a+d)!==c(e,d)){h=!1;break}if(h)return a}return-1}function k(t,e,i,s){i=Number(i)||0;var n=t.length-i;s?(s=Number(s))>n&&(s=n):s=n;var a=e.length;if(a%2!=0)throw new TypeError("Invalid hex string");s>a/2&&(s=a/2);for(var o=0;o<s;++o){var l=parseInt(e.substr(2*o,2),16);if(isNaN(l))return o;t[i+o]=l}return o}function S(t,e,i,s){return X(Y(e,t.length-i),t,i,s)}function T(t,e,i,s){return X(Z(e),t,i,s)}function I(t,e,i,s){return T(t,e,i,s)}function E(t,e,i,s){return X(J(e),t,i,s)}function B(t,e,i,s){return X(Q(e,t.length-i),t,i,s)}function x(t,e,i){return 0===e&&i===t.length?s.fromByteArray(t):s.fromByteArray(t.slice(e,i))}function P(t,e,i){i=Math.min(t.length,i);for(var s=[],n=e;n<i;){var a,o,l,r,c=t[n],_=null,h=c>239?4:c>223?3:c>191?2:1;if(n+h<=i)switch(h){case 1:c<128&&(_=c);break;case 2:128==(192&(a=t[n+1]))&&(r=(31&c)<<6|63&a)>127&&(_=r);break;case 3:a=t[n+1],o=t[n+2],128==(192&a)&&128==(192&o)&&(r=(15&c)<<12|(63&a)<<6|63&o)>2047&&(r<55296||r>57343)&&(_=r);break;case 4:a=t[n+1],o=t[n+2],l=t[n+3],128==(192&a)&&128==(192&o)&&128==(192&l)&&(r=(15&c)<<18|(63&a)<<12|(63&o)<<6|63&l)>65535&&r<1114112&&(_=r)}null===_?(_=65533,h=1):_>65535&&(_-=65536,s.push(_>>>10&1023|55296),_=56320|1023&_),s.push(_),n+=h}return N(s)}i.Buffer=r,i.SlowBuffer=function(t){+t!=t&&(t=0);return r.alloc(+t)},i.INSPECT_MAX_BYTES=50,r.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),i.kMaxLength=o(),r.poolSize=8192,r._augment=function(t){return t.__proto__=r.prototype,t},r.from=function(t,e,i){return c(null,t,e,i)},r.TYPED_ARRAY_SUPPORT&&(r.prototype.__proto__=Uint8Array.prototype,r.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&r[Symbol.species]===r&&Object.defineProperty(r,Symbol.species,{value:null,configurable:!0})),r.alloc=function(t,e,i){return h(null,t,e,i)},r.allocUnsafe=function(t){return d(null,t)},r.allocUnsafeSlow=function(t){return d(null,t)},r.isBuffer=function(t){return!(null==t||!t._isBuffer)},r.compare=function(t,e){if(!r.isBuffer(t)||!r.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var i=t.length,s=e.length,n=0,a=Math.min(i,s);n<a;++n)if(t[n]!==e[n]){i=t[n],s=e[n];break}return i<s?-1:s<i?1:0},r.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},r.concat=function(t,e){if(!a(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return r.alloc(0);var i;if(void 0===e)for(e=0,i=0;i<t.length;++i)e+=t[i].length;var s=r.allocUnsafe(e),n=0;for(i=0;i<t.length;++i){var o=t[i];if(!r.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(s,n),n+=o.length}return s},r.byteLength=v,r.prototype._isBuffer=!0,r.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)w(this,e,e+1);return this},r.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)w(this,e,e+3),w(this,e+1,e+2);return this},r.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)w(this,e,e+7),w(this,e+1,e+6),w(this,e+2,e+5),w(this,e+3,e+4);return this},r.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?P(this,0,t):b.apply(this,arguments)},r.prototype.equals=function(t){if(!r.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===r.compare(this,t)},r.prototype.inspect=function(){var t="",e=i.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,e).match(/.{2}/g).join(" "),this.length>e&&(t+=" ... ")),"<Buffer "+t+">"},r.prototype.compare=function(t,e,i,s,n){if(!r.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===i&&(i=t?t.length:0),void 0===s&&(s=0),void 0===n&&(n=this.length),e<0||i>t.length||s<0||n>this.length)throw new RangeError("out of range index");if(s>=n&&e>=i)return 0;if(s>=n)return-1;if(e>=i)return 1;if(e>>>=0,i>>>=0,s>>>=0,n>>>=0,this===t)return 0;for(var a=n-s,o=i-e,l=Math.min(a,o),c=this.slice(s,n),_=t.slice(e,i),h=0;h<l;++h)if(c[h]!==_[h]){a=c[h],o=_[h];break}return a<o?-1:o<a?1:0},r.prototype.includes=function(t,e,i){return-1!==this.indexOf(t,e,i)},r.prototype.indexOf=function(t,e,i){return y(this,t,e,i,!0)},r.prototype.lastIndexOf=function(t,e,i){return y(this,t,e,i,!1)},r.prototype.write=function(t,e,i,s){if(void 0===e)s="utf8",i=this.length,e=0;else if(void 0===i&&"string"==typeof e)s=e,i=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(i)?(i|=0,void 0===s&&(s="utf8")):(s=i,i=void 0)}var n=this.length-e;if((void 0===i||i>n)&&(i=n),t.length>0&&(i<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");s||(s="utf8");for(var a=!1;;)switch(s){case"hex":return k(this,t,e,i);case"utf8":case"utf-8":return S(this,t,e,i);case"ascii":return T(this,t,e,i);case"latin1":case"binary":return I(this,t,e,i);case"base64":return E(this,t,e,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return B(this,t,e,i);default:if(a)throw new TypeError("Unknown encoding: "+s);s=(""+s).toLowerCase(),a=!0}},r.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var R=4096;function N(t){var e=t.length;if(e<=R)return String.fromCharCode.apply(String,t);for(var i="",s=0;s<e;)i+=String.fromCharCode.apply(String,t.slice(s,s+=R));return i}function U(t,e,i){var s="";i=Math.min(t.length,i);for(var n=e;n<i;++n)s+=String.fromCharCode(127&t[n]);return s}function A(t,e,i){var s="";i=Math.min(t.length,i);for(var n=e;n<i;++n)s+=String.fromCharCode(t[n]);return s}function D(t,e,i){var s=t.length;(!e||e<0)&&(e=0),(!i||i<0||i>s)&&(i=s);for(var n="",a=e;a<i;++a)n+=K(t[a]);return n}function L(t,e,i){for(var s=t.slice(e,i),n="",a=0;a<s.length;a+=2)n+=String.fromCharCode(s[a]+256*s[a+1]);return n}function F(t,e,i){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>i)throw new RangeError("Trying to access beyond buffer length")}function M(t,e,i,s,n,a){if(!r.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>n||e<a)throw new RangeError('"value" argument is out of bounds');if(i+s>t.length)throw new RangeError("Index out of range")}function G(t,e,i,s){e<0&&(e=65535+e+1);for(var n=0,a=Math.min(t.length-i,2);n<a;++n)t[i+n]=(e&255<<8*(s?n:1-n))>>>8*(s?n:1-n)}function H(t,e,i,s){e<0&&(e=4294967295+e+1);for(var n=0,a=Math.min(t.length-i,4);n<a;++n)t[i+n]=e>>>8*(s?n:3-n)&255}function O(t,e,i,s,n,a){if(i+s>t.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("Index out of range")}function V(t,e,i,s,a){return a||O(t,0,i,4),n.write(t,e,i,s,23,4),i+4}function W(t,e,i,s,a){return a||O(t,0,i,8),n.write(t,e,i,s,52,8),i+8}r.prototype.slice=function(t,e){var i,s=this.length;if(t=~~t,e=void 0===e?s:~~e,t<0?(t+=s)<0&&(t=0):t>s&&(t=s),e<0?(e+=s)<0&&(e=0):e>s&&(e=s),e<t&&(e=t),r.TYPED_ARRAY_SUPPORT)(i=this.subarray(t,e)).__proto__=r.prototype;else{var n=e-t;i=new r(n,void 0);for(var a=0;a<n;++a)i[a]=this[a+t]}return i},r.prototype.readUIntLE=function(t,e,i){t|=0,e|=0,i||F(t,e,this.length);for(var s=this[t],n=1,a=0;++a<e&&(n*=256);)s+=this[t+a]*n;return s},r.prototype.readUIntBE=function(t,e,i){t|=0,e|=0,i||F(t,e,this.length);for(var s=this[t+--e],n=1;e>0&&(n*=256);)s+=this[t+--e]*n;return s},r.prototype.readUInt8=function(t,e){return e||F(t,1,this.length),this[t]},r.prototype.readUInt16LE=function(t,e){return e||F(t,2,this.length),this[t]|this[t+1]<<8},r.prototype.readUInt16BE=function(t,e){return e||F(t,2,this.length),this[t]<<8|this[t+1]},r.prototype.readUInt32LE=function(t,e){return e||F(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},r.prototype.readUInt32BE=function(t,e){return e||F(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},r.prototype.readIntLE=function(t,e,i){t|=0,e|=0,i||F(t,e,this.length);for(var s=this[t],n=1,a=0;++a<e&&(n*=256);)s+=this[t+a]*n;return s>=(n*=128)&&(s-=Math.pow(2,8*e)),s},r.prototype.readIntBE=function(t,e,i){t|=0,e|=0,i||F(t,e,this.length);for(var s=e,n=1,a=this[t+--s];s>0&&(n*=256);)a+=this[t+--s]*n;return a>=(n*=128)&&(a-=Math.pow(2,8*e)),a},r.prototype.readInt8=function(t,e){return e||F(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},r.prototype.readInt16LE=function(t,e){e||F(t,2,this.length);var i=this[t]|this[t+1]<<8;return 32768&i?4294901760|i:i},r.prototype.readInt16BE=function(t,e){e||F(t,2,this.length);var i=this[t+1]|this[t]<<8;return 32768&i?4294901760|i:i},r.prototype.readInt32LE=function(t,e){return e||F(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},r.prototype.readInt32BE=function(t,e){return e||F(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},r.prototype.readFloatLE=function(t,e){return e||F(t,4,this.length),n.read(this,t,!0,23,4)},r.prototype.readFloatBE=function(t,e){return e||F(t,4,this.length),n.read(this,t,!1,23,4)},r.prototype.readDoubleLE=function(t,e){return e||F(t,8,this.length),n.read(this,t,!0,52,8)},r.prototype.readDoubleBE=function(t,e){return e||F(t,8,this.length),n.read(this,t,!1,52,8)},r.prototype.writeUIntLE=function(t,e,i,s){(t=+t,e|=0,i|=0,s)||M(this,t,e,i,Math.pow(2,8*i)-1,0);var n=1,a=0;for(this[e]=255&t;++a<i&&(n*=256);)this[e+a]=t/n&255;return e+i},r.prototype.writeUIntBE=function(t,e,i,s){(t=+t,e|=0,i|=0,s)||M(this,t,e,i,Math.pow(2,8*i)-1,0);var n=i-1,a=1;for(this[e+n]=255&t;--n>=0&&(a*=256);)this[e+n]=t/a&255;return e+i},r.prototype.writeUInt8=function(t,e,i){return t=+t,e|=0,i||M(this,t,e,1,255,0),r.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},r.prototype.writeUInt16LE=function(t,e,i){return t=+t,e|=0,i||M(this,t,e,2,65535,0),r.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):G(this,t,e,!0),e+2},r.prototype.writeUInt16BE=function(t,e,i){return t=+t,e|=0,i||M(this,t,e,2,65535,0),r.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):G(this,t,e,!1),e+2},r.prototype.writeUInt32LE=function(t,e,i){return t=+t,e|=0,i||M(this,t,e,4,4294967295,0),r.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):H(this,t,e,!0),e+4},r.prototype.writeUInt32BE=function(t,e,i){return t=+t,e|=0,i||M(this,t,e,4,4294967295,0),r.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):H(this,t,e,!1),e+4},r.prototype.writeIntLE=function(t,e,i,s){if(t=+t,e|=0,!s){var n=Math.pow(2,8*i-1);M(this,t,e,i,n-1,-n)}var a=0,o=1,l=0;for(this[e]=255&t;++a<i&&(o*=256);)t<0&&0===l&&0!==this[e+a-1]&&(l=1),this[e+a]=(t/o>>0)-l&255;return e+i},r.prototype.writeIntBE=function(t,e,i,s){if(t=+t,e|=0,!s){var n=Math.pow(2,8*i-1);M(this,t,e,i,n-1,-n)}var a=i-1,o=1,l=0;for(this[e+a]=255&t;--a>=0&&(o*=256);)t<0&&0===l&&0!==this[e+a+1]&&(l=1),this[e+a]=(t/o>>0)-l&255;return e+i},r.prototype.writeInt8=function(t,e,i){return t=+t,e|=0,i||M(this,t,e,1,127,-128),r.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},r.prototype.writeInt16LE=function(t,e,i){return t=+t,e|=0,i||M(this,t,e,2,32767,-32768),r.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):G(this,t,e,!0),e+2},r.prototype.writeInt16BE=function(t,e,i){return t=+t,e|=0,i||M(this,t,e,2,32767,-32768),r.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):G(this,t,e,!1),e+2},r.prototype.writeInt32LE=function(t,e,i){return t=+t,e|=0,i||M(this,t,e,4,2147483647,-2147483648),r.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):H(this,t,e,!0),e+4},r.prototype.writeInt32BE=function(t,e,i){return t=+t,e|=0,i||M(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),r.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):H(this,t,e,!1),e+4},r.prototype.writeFloatLE=function(t,e,i){return V(this,t,e,!0,i)},r.prototype.writeFloatBE=function(t,e,i){return V(this,t,e,!1,i)},r.prototype.writeDoubleLE=function(t,e,i){return W(this,t,e,!0,i)},r.prototype.writeDoubleBE=function(t,e,i){return W(this,t,e,!1,i)},r.prototype.copy=function(t,e,i,s){if(i||(i=0),s||0===s||(s=this.length),e>=t.length&&(e=t.length),e||(e=0),s>0&&s<i&&(s=i),s===i)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("sourceStart out of bounds");if(s<0)throw new RangeError("sourceEnd out of bounds");s>this.length&&(s=this.length),t.length-e<s-i&&(s=t.length-e+i);var n,a=s-i;if(this===t&&i<e&&e<s)for(n=a-1;n>=0;--n)t[n+e]=this[n+i];else if(a<1e3||!r.TYPED_ARRAY_SUPPORT)for(n=0;n<a;++n)t[n+e]=this[n+i];else Uint8Array.prototype.set.call(t,this.subarray(i,i+a),e);return a},r.prototype.fill=function(t,e,i,s){if("string"==typeof t){if("string"==typeof e?(s=e,e=0,i=this.length):"string"==typeof i&&(s=i,i=this.length),1===t.length){var n=t.charCodeAt(0);n<256&&(t=n)}if(void 0!==s&&"string"!=typeof s)throw new TypeError("encoding must be a string");if("string"==typeof s&&!r.isEncoding(s))throw new TypeError("Unknown encoding: "+s)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<i)throw new RangeError("Out of range index");if(i<=e)return this;var a;if(e>>>=0,i=void 0===i?this.length:i>>>0,t||(t=0),"number"==typeof t)for(a=e;a<i;++a)this[a]=t;else{var o=r.isBuffer(t)?t:Y(new r(t,s).toString()),l=o.length;for(a=0;a<i-e;++a)this[a+e]=o[a%l]}return this};var z=/[^+\/0-9A-Za-z-_]/g;function q(t){if((t=j(t).replace(z,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}function j(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function K(t){return t<16?"0"+t.toString(16):t.toString(16)}function Y(t,e){var i;e=e||1/0;for(var s=t.length,n=null,a=[],o=0;o<s;++o){if((i=t.charCodeAt(o))>55295&&i<57344){if(!n){if(i>56319){(e-=3)>-1&&a.push(239,191,189);continue}if(o+1===s){(e-=3)>-1&&a.push(239,191,189);continue}n=i;continue}if(i<56320){(e-=3)>-1&&a.push(239,191,189),n=i;continue}i=65536+(n-55296<<10|i-56320)}else n&&(e-=3)>-1&&a.push(239,191,189);if(n=null,i<128){if((e-=1)<0)break;a.push(i)}else if(i<2048){if((e-=2)<0)break;a.push(i>>6|192,63&i|128)}else if(i<65536){if((e-=3)<0)break;a.push(i>>12|224,i>>6&63|128,63&i|128)}else{if(!(i<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;a.push(i>>18|240,i>>12&63|128,i>>6&63|128,63&i|128)}}return a}function Z(t){for(var e=[],i=0;i<t.length;++i)e.push(255&t.charCodeAt(i));return e}function Q(t,e){for(var i,s,n,a=[],o=0;o<t.length&&!((e-=2)<0);++o)s=(i=t.charCodeAt(o))>>8,n=i%256,a.push(n),a.push(s);return a}function J(t){return s.toByteArray(q(t))}function X(t,e,i,s){for(var n=0;n<s&&!(n+i>=e.length||n>=t.length);++n)e[n+i]=t[n];return n}function $(t){return t!=t}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"base64-js":1,ieee754:4,isarray:3}],3:[function(t,e,i){var s={}.toString;e.exports=Array.isArray||function(t){return"[object Array]"==s.call(t)}},{}],4:[function(t,e,i){i.read=function(t,e,i,s,n){var a,o,l=8*n-s-1,r=(1<<l)-1,c=r>>1,_=-7,h=i?n-1:0,d=i?-1:1,u=t[e+h];for(h+=d,a=u&(1<<-_)-1,u>>=-_,_+=l;_>0;a=256*a+t[e+h],h+=d,_-=8);for(o=a&(1<<-_)-1,a>>=-_,_+=s;_>0;o=256*o+t[e+h],h+=d,_-=8);if(0===a)a=1-c;else{if(a===r)return o?NaN:1/0*(u?-1:1);o+=Math.pow(2,s),a-=c}return(u?-1:1)*o*Math.pow(2,a-s)},i.write=function(t,e,i,s,n,a){var o,l,r,c=8*a-n-1,_=(1<<c)-1,h=_>>1,d=23===n?Math.pow(2,-24)-Math.pow(2,-77):0,u=s?0:a-1,m=s?1:-1,f=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(l=isNaN(e)?1:0,o=_):(o=Math.floor(Math.log(e)/Math.LN2),e*(r=Math.pow(2,-o))<1&&(o--,r*=2),(e+=o+h>=1?d/r:d*Math.pow(2,1-h))*r>=2&&(o++,r/=2),o+h>=_?(l=0,o=_):o+h>=1?(l=(e*r-1)*Math.pow(2,n),o+=h):(l=e*Math.pow(2,h-1)*Math.pow(2,n),o=0));n>=8;t[i+u]=255&l,u+=m,l/=256,n-=8);for(o=o<<n|l,c+=n;c>0;t[i+u]=255&o,u+=m,o/=256,c-=8);t[i+u-m]|=128*f}},{}],5:[function(t,e,i){var s,n,a=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function l(){throw new Error("clearTimeout has not been defined")}function r(t){if(s===setTimeout)return setTimeout(t,0);if((s===o||!s)&&setTimeout)return s=setTimeout,setTimeout(t,0);try{return s(t,0)}catch(e){try{return s.call(null,t,0)}catch(e){return s.call(this,t,0)}}}function c(t){if(n===clearTimeout)return clearTimeout(t);if((n===l||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{return n(t)}catch(e){try{return n.call(null,t)}catch(e){return n.call(this,t)}}}(function(){try{s="function"==typeof setTimeout?setTimeout:o}catch(t){s=o}try{n="function"==typeof clearTimeout?clearTimeout:l}catch(t){n=l}})();var _,h=[],d=!1,u=-1;function m(){d&&_&&(d=!1,_.length?h=_.concat(h):u=-1,h.length&&f())}function f(){if(!d){var t=r(m);d=!0;for(var e=h.length;e;){for(_=h,h=[];++u<e;)_&&_[u].run();u=-1,e=h.length}_=null,d=!1,c(t)}}function p(t,e){this.fun=t,this.array=e}function g(){}a.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)e[i-1]=arguments[i];h.push(new p(t,e)),1!==h.length||d||r(f)},p.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=g,a.addListener=g,a.once=g,a.off=g,a.removeListener=g,a.removeAllListeners=g,a.emit=g,a.prependListener=g,a.prependOnceListener=g,a.listeners=function(t){return[]},a.binding=function(t){throw new Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(t){throw new Error("process.chdir is not supported")},a.umask=function(){return 0}},{}],CusRichText:[function(t,e,i){"use strict";cc._RF.push(e,"a50e4kdpRlL24+s3FHK9Y0p","CusRichText");cc.Class({extends:cc.Component,editor:!1,properties:{string:{default:"",multiline:!0,notify:function(){this.updateString()}},fontAtlas:cc.SpriteAtlas,_richNd:cc.Node,_richText:cc.RichText},ctor:function(){},onLoad:function(){this._richNd||(this._richNd=new cc.Node("CusNum"),this.node.addChild(this._richNd),this._richText=this._richNd.addComponent(cc.RichText)),this._richText.string="",this._richText.imageAtlas=this.fontAtlas,this.updateString()},updateString:function(){var t="";if(this.fontAtlas){var e=this.fontAtlas.name.substring(0,this.fontAtlas.name.length-6)+"_";for(var i in this.string){if(parseInt(this.string[i])>=0&&parseInt(this.string[i])<=9)t+="<img src = '"+e+this.string[i]+"'/>"}}this._richText&&(this._richText.string=t)},setNum:function(t){this.string=t+"",this.updateString()},getNum:function(){return parseInt(this.string)},setAtlas:function(t){t instanceof cc.SpriteAtlas&&(this.fontAtlas=t),this.updateString()}});cc._RF.pop()},{}],Stronger_panel_item:[function(t,e,i){"use strict";cc._RF.push(e,"f293aKfmbNL5o7hRR+XxMAL","Stronger_panel_item");var s=t("stronger_controller"),n=cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=PathTool.getPrefabPath("stronger","stronger_panel_item"),this.ctrl=s.getInstance()},initConfig:function(){},initPanel:function(){this.name_lb=this.seekChild("name",cc.Label),this.desc_lb=this.seekChild("desc_label",cc.Label),this.goods_icon_sp=this.seekChild("goods_icon",cc.Sprite),this.loadingbar=this.seekChild("loadingbar"),this.loadingbar_exp_lb=this.seekChild("loadingbar_exp",cc.Label),this.go_btn=this.seekChild("go_btn"),this.loading_bg_pb=this.seekChild("loading_bg",cc.ProgressBar),this.data&&this.setData(this.data)},registerEvent:function(){this.go_btn.on("click",this._onClickGoBtn,this)},_onClickGoBtn:function(){Utils.playButtonSound(1),this.data&&this.data.evt_type&&this.ctrl.clickCallBack(this.data.evt_type)},setData:function(t){if(this.data=t,this.root_wnd&&t){this.go_btn.name="go_btn_"+this.data.id,t._index,this.data=t,this.name_lb.string=t.name,this.desc_lb.string=t.desc;var e=t.score_val/t.max_val;this.loading_bg_pb.progress=e,this.loadingbar_exp_lb.string=t.score_val+"/"+t.max_val;var i=PathTool.getIconPath("strongericon","stronger_"+t.icon);this.loadRes(i,function(t){this.goods_icon_sp.spriteFrame=t}.bind(this))}}});e.exports=n,cc._RF.pop()},{stronger_controller:"stronger_controller"}],ZipLoader:[function(t,e,i){"use strict";cc._RF.push(e,"08289kZwBhJLaTAHI/wZAbL","ZipLoader");var s=function(t,e){var i=cc.loader.getXMLHttpRequest();i.open("GET",t,!0),i.overrideMimeType("text/plain; charset=x-user-defined"),i.responseType="arraybuffer",i.onload=function(t){e&&e(i.response)},i.send()};e.exports={RegisterZipLoader:function(){cc.loader.addDownloadHandlers({zip:function(t,e){s(t.url,function(t){e(null,t)})}})}},cc._RF.pop()},{}],action_acc_level_up_gift_panel:[function(t,e,i){"use strict";cc._RF.push(e,"9d519STSvhOj6I6XYU/K6r2","action_acc_level_up_gift_panel");var s=t("pathtool"),n=t("timetool"),a=t("action_controller"),o=t("action_event"),l=t("role_controller");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("action","action_acc_level_up_gift_panel"),this.ctrl=a.getInstance(),this.holiday_bid=arguments[0]},initConfig:function(){this.cell_data_list=[],this.cell_list={},this.rewardList=[]},initPanel:function(){var t=this;t.main_container=t.root_wnd.getChildByName("main_container"),t.title_con=t.main_container.getChildByName("title_con"),t.title_img=t.title_con.getChildByName("title_img");var e=t.ctrl.getActionSubTabVo(t.holiday_bid);if(e){null!=e.aim_title&&""!=e.aim_title||(e.aim_title="txt_cn_action_acc_level_up_gift");var i=s.getUIIconPath("bigbg/action",e.aim_title);this.loadRes(i,function(e){t.title_img.getComponent(cc.Sprite).spriteFrame=e}.bind(this))}t.charge_con_sv=this.seekChild("charge_con",cc.ScrollView),t.title_con.getChildByName("dec").getComponent(cc.Label).string="\u6d3b\u52a8\u671f\u95f4\uff0c\u73a9\u5bb6\u53ef\u9886\u53d6\u5df2\u8fbe\u6863\u6b21\u5956\u52b1\n\u5956\u52b1\u9650\u65f6\u9650\u91cf\uff0c\u5148\u5230\u5148\u5f97",this.time_rt=t.title_con.getChildByName("time_node").getChildByName("time_lab").getComponent(cc.RichText),t.setLessTime(e.remain_sec)},registerEvent:function(){this.addGlobalEvent(o.UPDATE_LEVEL_UP_GIFT,function(t){t&&this.setData(t)}.bind(this)),this.ctrl.send21200()},onShow:function(t){},onHide:function(){},setData:function(t){this.cell_data_list=[];for(var e=!1,i=0;i<t.gifts.length;++i){var s=t.gifts[i],n=gdata("lev_gift_data","data_level_welfare",s.id);if(n){var a={};a.id=s.id,a.config=n,this.cell_data_list.push(a)}this.cell_data_list[i]&&(1==s.status&&s.num>=this.cell_data_list[i].config.num&&(s.status=4),0==s.status?this.cell_data_list[i].order=2:4==s.status?(this.cell_data_list[i].order=3,s.status=0):2==s.status?this.cell_data_list[i].order=4:this.cell_data_list[i].order=1,this.cell_data_list[i].status=s.status,e||1!=s.status||(e=!0),this.cell_data_list[i].num=s.num)}this.cell_data_list.sort(Utils.tableLowerSorter(["order"],["id"])),this.ctrl.setHolidayStatus(this.holiday_bid,e),this.updateScrollviewList()},updateScrollviewList:function(){var t=this;this.charge_con_sv.content.height=150*this.cell_data_list.length;for(var e=function(e){var i=t.cell_data_list[e];null==t.cell_list[i.id]?Utils.delayRun(t.charge_con_sv.content,e/30,function(){this.loadRes(s.getPrefabPath("action","action_acc_level_up_gift_item"),function(t){var s=t;this.charge_con_sv.content.addChild(s);var n=s.getChildByName("main_container").getChildByName("item_scrollview").getComponent(cc.ScrollView);n.content.widht=96*i.config.reward.length+(i.config.reward.length-10);var a=i.config.reward.length;n.enabled=!(a<=4),s.getChildByName("main_container").getChildByName("btn_go").on("click",function(){Utils.playButtonSound(1),this.setCellTouched(i.id)},this);for(var o=[],l=0;l<i.config.reward.length;++l){var r=i.config.reward[l],c=ItemsPool.getInstance().getItem("backpack_item");c.setDefaultTip(),c.setPosition(60+130*l*.8,0),c.setParent(n.content),c.initConfig(!1,.8,!1,!0),c.show(),c.setData({bid:r[0],num:r[1]}),o.push(c)}this.cell_list[i.id]=s,this.setCellByIndex(s,i),this.updateCellByIndex(s,e),this.rewardList.push(o)}.bind(this))}.bind(t)):t.updateCellByIndex(t.cell_list[i.id],e)},i=0;i<this.cell_data_list.length;++i)e(i)},setCellTouched:function(t){for(var e=0;e<this.cell_data_list.length;++e){var i=this.cell_data_list[e];if(i.id==t){1==i.status&&this.ctrl.send21201(t);break}}},setCellByIndex:function(t,e){if(e){var i,s=e.config,n=l.getInstance().getRoleVo(),a=n&&n.lev||0,o=t.getChildByName("main_container").getChildByName("title");a>=s.lev?(o.color=new cc.Color(44,125,8),i="\u8fbe\u5230"+s.lev+"\u7ea7 ("+s.lev+"/"+s.lev+")"):(o.color=new cc.Color(90,58,51),i="\u8fbe\u5230"+s.lev+"\u7ea7 ("+a+"/"+s.lev+")"),o.getComponent(cc.Label).string=i}},updateCellByIndex:function(t,e){t.y=-t.height/2-e*t.height;var i=this.cell_data_list[e],s=t.getChildByName("main_container").getChildByName("btn_go"),n=t.getChildByName("main_container").getChildByName("pic_has"),a=i.config;0==i.status?(s.active=!0,n.active=!1,Utils.setGreyButton(s.getComponent(cc.Button),!0),s.getChildByName("Label").color=new cc.Color(255,255,255)):1==i.status?(s.active=!0,n.active=!1,Utils.setGreyButton(s.getComponent(cc.Button),!1),s.getChildByName("Label").color=new cc.Color(37,85,6)):(s.active=!1,n.active=!0);var o=t.getChildByName("main_container").getChildByName("portion_count"),l=a.num-i.num;l<0&&(l=0),o.getComponent(cc.Label).string="\u8fd8\u5269"+l+"\u4efd"},setVisibleStatus:function(t){t=t||!1,this.setVisible(t)},setLessTime:function(t){this.time_rt&&((t=t||0)>0?(this.setTimeFormatString(t),null==this.time_tichet&&(this.time_tichet=gcore.Timer.set(function(){t--,this.setTimeFormatString(t),t<=0&&(gcore.Timer.del(this.time_tichet),this.time_tichet=null)}.bind(this),1e3,-1))):this.setTimeFormatString(t))},setTimeFormatString:function(t){if(t>0){var e="\u5269\u4f59\u65f6\u95f4\uff1a<color=#14ff32>"+n.getTimeFormatDayIIIIII(t)+"</color>";this.time_rt.string=e}else this.time_rt.string=""},onDelete:function(){if(this.time_tichet&&(gcore.Timer.del(this.time_tichet),this.time_tichet=null),this.cell_list)for(var t=0;t<this.rewardList.length;++t)for(var e=0;e<this.rewardList[t].length;++e)this.rewardList[t][e].deleteMe&&this.rewardList[t][e].deleteMe()}});cc._RF.pop()},{action_controller:"action_controller",action_event:"action_event",pathtool:"pathtool",role_controller:"role_controller",timetool:"timetool"}],action_buy_skin_panel:[function(t,e,i){"use strict";cc._RF.push(e,"ef3b3sZK7ROeqNpO66hpKxv","action_buy_skin_panel");var s=t("pathtool"),n=t("action_controller"),a=t("common_scrollview"),o=t("action_event"),l=t("timetool"),r=t("action_const");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("action","action_buy_skin_panel"),this.holiday_bid=arguments[0],this.ctrl=n.getInstance()},initConfig:function(){this.touch_buy_skin=!0},initPanel:function(){var t=this.getPositionX();this.setPosition(t,-25),this.main_container=this.root_wnd.getChildByName("main_container"),this.holiday_bg=this.main_container.getChildByName("bg").getComponent(cc.Sprite),this.setHolidayBG(),this.btn_fight=this.main_container.getChildByName("btn_fight"),this.attr_msg_rt=this.main_container.getChildByName("attr_msg").getComponent(cc.RichText),this.btn_fight.getChildByName("Text_1").getComponent(cc.Label).string=Utils.TI18N("\u76ae\u80a4\u9884\u89c8"),this.btn_buy=this.main_container.getChildByName("btn_buy").getComponent(cc.Button),this.btn_buy_text=this.btn_buy.node.getChildByName("Text_4").getComponent(cc.Label),this.btn_buy_text.string="",this.time_text=this.main_container.getChildByName("time_text").getComponent(cc.Label),this.time_text.string="",this.goods_list=this.main_container.getChildByName("goods");var e=this.goods_list.getContentSize();this.item_scroll_view=new a,this.item_scroll_view.createScroll(this.goods_list,cc.v2(-e.width/2,0),ScrollViewDir.horizontal,ScrollViewStartPos.top,e,{item_class:"backpack_item",start_x:0,space_x:10,start_y:8,space_y:0,item_width:108,item_height:108,row:1,col:0,scale:.9})},setHolidayBG:function(){var t="txt_cn_hero_skin_buy",e=this.ctrl.getActionSubTabVo(this.holiday_bid);e&&""!=e.aim_title&&e.aim_title&&(t=e.aim_title);var i=s.getUIIconPath("bigbg/action",t,"jpg");this.loadRes(i,function(t){this.holiday_bg.spriteFrame=t}.bind(this))},registerEvent:function(){this.addGlobalEvent(o.UPDATE_HOLIDAY_SIGNLE,function(t){t.bid==this.holiday_bid&&(this.setData(t),this.setLessTime(t.remain_sec))}.bind(this)),this.btn_fight.on("click",function(){Utils.playButtonSound(1),t("timesummon_controller").getInstance().send23219(r.ActionRankCommonType.action_skin_buy)},this),this.btn_buy.node.on("click",function(){Utils.playButtonSound(1),this.setCheckHasHeroSkin()},this),this.ctrl.cs16603(this.holiday_bid)},setCheckHasHeroSkin:function(){if(this.touch_buy_skin&&this.cur_skin_id){if(t("hero_controller").getInstance().getModel().isUnlockHeroSkin(this.cur_skin_id,!0)){var e=Config.partner_skin_data.data_skin_info;if(e&&e[this.cur_skin_id]){var i=e[this.cur_skin_id].diamond_num;if(i&&i[0]){var n=Utils.getItemConfig(i[0][0]),a=s.getIconPath("item",n.icon),o=cc.js.formatStr(Utils.TI18N("\u60a8\u5df2\u62e5\u6709\u5f53\u524d\u76ae\u80a4\u7684\u6c38\u4e45\u4f7f\u7528\u6743\uff0c\u518d\u6b21\u8d2d\u4e70\u540e\u4f7f\u7528\u5c06\u4f1a\u8f6c\u5316\u6210 <img src='%s'/><color=#289b14> *%d </color>\uff0c\u662f\u5426\u7ee7\u7eed\u8d2d\u4e70\uff1f"),n.icon,i[0][1]),l=function(){this.setChargeSkin()}.bind(this),r={};return r.align=cc.macro.TextAlignment.LEFT,r.resArr=[a],void t("commonalert").show(o,Utils.TI18N("\u786e\u5b9a"),l,Utils.TI18N("\u53d6\u6d88"),null,null,null,r)}}}this.setChargeSkin()}},setChargeSkin:function(){if(Utils.delayRun(this.root_wnd,3,function(){this.touch_buy_skin=!0}.bind(this)),this.touch_buy_skin=!1,this.buy_charge_id){var t=Config.charge_data.data_charge_data[this.buy_charge_id];t&&SDK.pay(t.val,null,t.id,t.name,t.name)}},onShow:function(t){},setData:function(t){var e=t.aim_list||null;if(e&&e[0]&&e[0].aim_args){var i,s=Utils.keyfind("aim_args_key",35,e[0].aim_args)||null;if(s&&(i=s.aim_args_val||0),i&&(this.cur_skin_id=i,this.setAttrGoodsData(i,e[0].item_list)),0!=t.finish)this.btn_buy_text.string=Utils.TI18N("\u5df2\u8d2d\u4e70"),this.btn_buy_text.node.getComponent(cc.LabelOutline).enabled=!1,this.btn_buy.interactable=!1,this.btn_buy.enableAutoGrayEffect=!0;else{var n,a=Utils.keyfind("aim_args_key",33,e[0].aim_args)||null;if(a&&(n=a.aim_args_val||0),n){this.buy_charge_id=n;var o=Config.charge_data.data_charge_data;o[n]&&(this.btn_buy_text.string=Utils.TI18N("\uffe5"+o[n].val))}}}},setAttrGoodsData:function(t,e){var i=Config.partner_skin_data.data_skin_info;if(i&&i[t]){for(var s=i[t],n=[],a="<outline color=#000000 width = 2>\u5c5e\u6027\u52a0\u6210\uff1a</outline>",o=0;o<s.skin_attr.length;++o){var l=s.skin_attr[o],r=Utils.commonGetAttrInfoByKeyValue(l[0],l[1]);n.push(r.res),a+="<img src='"+r.icon+"'/> <color=#89FF83><outline color=#000000 width=2>"+r.attr_name+"+"+r.attr_val+"</outline></color> "}this.attr_msg_rt.string=a;for(var c=0;c<n.length;++c)this.loadRes(n[c],function(t,e){t.spriteFrame=e}.bind(this,this.attr_msg_rt))}if(e&&e.length){for(var _=[],h=0;h<e.length;++h){var d={};d.bid=e[h].bid,d.num=e[h].num,_.push(d)}var u=_.length,m=this.goods_list.getContentSize();this.item_scroll_view.setData(_),this.item_scroll_view.addEndCallBack(function(){var t=this.item_scroll_view.getItemList();for(var e in t)t[e].setDefaultTip();u>5?(this.item_scroll_view.setClickEnabled(!0),this.item_scroll_view.root_wnd&&(this.item_scroll_view.root_wnd.x=-m.width/2)):(this.item_scroll_view.setClickEnabled(!1),this.item_scroll_view.root_wnd&&(this.item_scroll_view.root_wnd.x=-m.width/2+(108*(5-u)+10*(5-u))/2))}.bind(this))}},setLessTime:function(t){this.time_text&&((t=t||0)>0?(this.setTimeFormatString(t),null==this.time_tichet&&(this.time_tichet=gcore.Timer.set(function(){--t<0?(gcore.Timer.del(this.time_tichet),this.time_tichet=null):this.setTimeFormatString(t)}.bind(this),1e3,-1))):this.setTimeFormatString(t))},setTimeFormatString:function(t){this.time_text.string=t>0?l.getTimeForFunction(t):"00:00:00"},onHide:function(){},onDelete:function(){this.time_tichet&&(gcore.Timer.del(this.time_tichet),this.time_tichet=null),this.item_scroll_view&&(this.item_scroll_view.deleteMe(),this.item_scroll_view=null)}});cc._RF.pop()},{action_const:"action_const",action_controller:"action_controller",action_event:"action_event",common_scrollview:"common_scrollview",commonalert:"commonalert",hero_controller:"hero_controller",pathtool:"pathtool",timesummon_controller:"timesummon_controller",timetool:"timetool"}],action_buy_skin_window:[function(t,e,i){"use strict";cc._RF.push(e,"034d5X+FiVB2YeSNUW8s5ps","action_buy_skin_window");var s=t("pathtool"),n=t("mainui_controller"),a=t("mainui_const"),o=t("action_event"),l=t("timetool"),r=t("common_scrollview");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("action","action_buy_skin_window"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Big,this.ctrl=arguments[0]},initConfig:function(){this.touch_buy_skin=!0},openCallBack:function(){this.background=this.root_wnd.getChildByName("background"),this.main_container=this.root_wnd.getChildByName("main_container"),this.bg_sp=this.main_container.getChildByName("bg").getComponent(cc.Sprite),this.attr_msg_rt=this.main_container.getChildByName("attr_msg").getComponent(cc.RichText),this.buy_btn=this.main_container.getChildByName("btn_buy"),this.btn_fight=this.main_container.getChildByName("btn_fight"),this.btn_fight.getChildByName("Label").getComponent(cc.Label).string=Utils.TI18N("\u76ae\u80a4\u9884\u89c8"),this.btn_buy_text=this.buy_btn.getChildByName("label").getComponent(cc.Label),this.time_text=this.main_container.getChildByName("time_text").getComponent(cc.Label),this.time_text.string="",this.goods_list=this.main_container.getChildByName("goods_list"),this.close_btn=this.main_container.getChildByName("close_btn");var t=this.goods_list.getContentSize();this.item_scroll_view=new r,this.item_scroll_view.createScroll(this.goods_list,cc.v2(-t.width/2,0),ScrollViewDir.horizontal,ScrollViewStartPos.top,t,{item_class:"backpack_item",start_x:10,space_x:20,start_y:8,space_y:0,item_width:108,item_height:108,row:1,col:0,scale:.9}),this.setAttrGoodsData(),this.setData();var e=n.getInstance().getFunctionIconById(a.icon.skin).end_time-gcore.SmartSocket.getTime();this.setLessTime(e),this.ctrl.sender30101()},registerEvent:function(){this.addGlobalEvent(o.SKIN_INFO_EVENT,function(t){if(2==t.code){var e=this.buy_btn.getComponent(cc.Button);e.interactable=!1,e.enableAutoGrayEffect=!0,this.buy_btn.getChildByName("label").getComponent(cc.LabelOutline).enabled=!1,this.btn_buy_text.string="\u5df2\u8d2d\u4e70"}}.bind(this)),this.close_btn.on("click",function(){Utils.playButtonSound(2),this.ctrl.openBuySkinWindow(!1)},this),this.btn_fight.on("click",function(){Utils.playButtonSound(1),this.ctrl.sender30100()},this),this.buy_btn.on("click",function(){Utils.playButtonSound(1),this.setCheckHasHeroSkin()},this)},setCheckHasHeroSkin:function(){this.touch_buy_skin&&this.cur_skin_id&&this.setChargeSkin()},setChargeSkin:function(){if(Utils.delayRun(this.root_wnd,3,function(){this.touch_buy_skin=!0}.bind(this)),this.touch_buy_skin=!1,this.buy_charge_id){var t=Config.charge_data.data_charge_data[this.buy_charge_id];t&&SDK.pay(t.val,null,t.id,t.name,t.name)}},setLessTime:function(t){this.time_text&&((t=t||0)>0?(this.setTimeFormatString(t),null==this.time_tichet&&(this.time_tichet=gcore.Timer.set(function(){t--,this.setTimeFormatString(t),t<0&&(gcore.Timer.del(this.time_tichet),this.time_tichet=null,this.setTimeFormatString(t))}.bind(this),1e3,-1))):this.setTimeFormatString(t))},setTimeFormatString:function(t){this.time_text.string=t>0?l.getTimeForFunction(t):"00:00:00"},openRootWnd:function(t){},setAttrGoodsData:function(){var t=Config.charge_data.data_constant.skin_award,e=t.val,i=Config.partner_skin_data.data_skin_info;if(i&&i[t.id]){var n=i[t.id];this.cur_skin_id=n.skin_id,this.loadRes(s.getUIIconPath("bigbg",n.hero_info_bg_res),function(t){this.bg_sp.spriteFrame=t}.bind(this));for(var a=[],o="<outline color=#000000 width = 2>\u5c5e\u6027\u52a0\u6210\uff1a</outline>",l=0;l<n.skin_attr.length;++l){var r=n.skin_attr[l],c=Utils.commonGetAttrInfoByKeyValue(r[0],r[1]);a.push(c.res),o+="<img src='"+c.icon+"'/> <color=#89FF83><outline color=#000000 width=2>"+c.attr_name+"+"+c.attr_val+"</outline></color> "}this.attr_msg_rt.string=o;for(var _=0;_<a.length;++_)this.loadRes(a[_],function(t,e){t.spriteFrame=e}.bind(this,this.attr_msg_rt))}if(e&&e.length){for(var h=[],d=0;d<e.length;++d){var u={};u.bid=e[d][0],u.num=e[d][1],h.push(u)}var m=h.length,f=this.goods_list.getContentSize();m>4?(this.item_scroll_view.setClickEnabled(!0),this.item_scroll_view.root_wnd&&(this.item_scroll_view.root_wnd.x=-f.width/2)):(this.item_scroll_view.setClickEnabled(!1),this.item_scroll_view.root_wnd&&(this.item_scroll_view.root_wnd.x=-f.width/2+10*(5-m)+55*(4-m))),this.item_scroll_view.setData(h),this.item_scroll_view.addEndCallBack(function(){var t=this.item_scroll_view.getItemList();for(var e in t)t[e].setDefaultTip()}.bind(this))}},setData:function(){var t=Config.charge_data.data_constant.skin_package_id;if(t){this.buy_charge_id=t.val||0;var e=Config.charge_data.data_charge_data[t.val];e&&e.val&&(this.btn_buy_text.string=Utils.TI18N("\uffe5"+e.val))}},closeCallBack:function(){this.time_tichet&&(gcore.Timer.del(this.time_tichet),this.time_tichet=null),this.item_scroll_view&&(this.item_scroll_view.deleteMe(),this.item_scroll_view=null),this.ctrl.openBuySkinWindow(!1)}});cc._RF.pop()},{action_event:"action_event",common_scrollview:"common_scrollview",mainui_const:"mainui_const",mainui_controller:"mainui_controller",pathtool:"pathtool",timetool:"timetool"}],action_common_Item:[function(t,e,i){"use strict";cc._RF.push(e,"9667dtEtadAro1E6zRz2+9f","action_common_Item");var s=t("pathtool"),n=t("action_controller"),a=t("action_const"),o=t("stronger_controller"),l=t("common_scrollview"),r=t("vip_controller"),c=t("hero_controller"),_=t("hero_const");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("welfare","luxury_item"),this.ctrl=n.getInstance()},initConfig:function(){},initPanel:function(){var t=this.root_wnd.getChildByName("main_container");this.btn_goto=t.getChildByName("btn_goto"),this.btn_goto_label=this.btn_goto.getChildByName("Text_7_0"),this.btn_goto_label.getComponent(cc.Label).string=Utils.TI18N("\u524d\u5f80"),this.btn_goto.active=!1,this.btn_get=t.getChildByName("btn_get"),this.btn_get_label=this.btn_get.getChildByName("Text_7"),this.btn_get_ui=t.getChildByName("btn_get").getComponent(cc.Button),this.btn_get.active=!1,this.has_get=t.getChildByName("has_get"),this.has_get.active=!1,this.text_tesk=t.getChildByName("text_tesk"),this.text_tesk.getComponent(cc.Label).string="",this.goods_con=t.getChildByName("good_cons");var e=this.goods_con.getContentSize();this.item_scrollview=new l,this.item_scrollview.createScroll(this.goods_con,cc.v2(0,0),ScrollViewDir.horizontal,ScrollViewStartPos.top,e,{item_class:"backpack_item",start_x:3,space_x:5,start_y:4,space_y:4,item_width:96,item_height:96,row:1,col:0,scale:.8}),this.title_desc=t.getChildByName("title_desc"),this.data&&this.setData(this.data)},registerEvent:function(){this.btn_goto.on("click",this.gotoSpecificView,this),this.btn_get.on("click",function(){Utils.playButtonSound(1),this.holiday_item_bid&&this.data&&this.ctrl.cs16604(this.holiday_item_bid,this.data.aim)},this)},gotoSpecificView:function(){Utils.playButtonSound(1);if(!this.holiday_item_bid||this.holiday_item_bid!=a.ActionRankCommonType.acc_luxury&&this.holiday_item_bid!=a.ActionRankCommonType.totle_charge&&this.holiday_item_bid!=a.ActionRankCommonType.limit_charge)if(this.holiday_item_bid&&this.holiday_item_bid==a.ActionRankCommonType.luckly_egg){var t=ActionRankCommonType.smashegg;this.ctrl.getActionSubTabVo(t)&&this.ctrl.action_operate&&this.ctrl.action_operate.handleSelectedTab(this.ctrl.action_operate.tab_list[t])}else if(this.holiday_item_bid&&this.holiday_item_bid==a.ActionRankCommonType.hero_awake){var e=c.getInstance().getModel().getTopLevHeroInfoByBid(this.cur_bid),i=c.getInstance().getModel().getAllHeroArray();e&&i&&0!=i.size?c.getInstance().openHeroMainInfoWindow(!0,e,i.items,{show_model_type:_.BagTab.eBagHero}):o.getInstance().clickCallBack(411)}else{var s;this.holiday_item_bid==a.ActionRankCommonType.speed_fight||this.holiday_item_bid==a.ActionRankCommonType.speed_fight1?s=132:this.holiday_item_bid==a.ActionRankCommonType.voyage||this.holiday_item_bid==a.ActionRankCommonType.voyage1?s=126:this.holiday_item_bid==a.ActionRankCommonType.hero_expedit||this.holiday_item_bid==a.ActionRankCommonType.hero_expedit1?s=151:this.holiday_item_bid==a.ActionRankCommonType.epoint_gold||this.holiday_item_bid==a.ActionRankCommonType.epoint_gold1?s=123:this.holiday_item_bid==a.ActionRankCommonType.adventure?s=407:this.holiday_item_bid==a.ActionRankCommonType.updata_star&&(s=404),s&&o.getInstance().clickCallBack(s)}else r.getInstance().openVipMainWindow(!0,VIPTABCONST.CHARGE)},onShow:function(t){},onHide:function(){},setExtendData:function(t){this.holiday_item_bid=t.bid,this.is_activity_end=t.time_end,this.finish=t.finish},setData:function(t){if(t){this.data=t;var e=this;if(this.root_wnd){e.getButtonTeskProgress(t),e.title_desc.getComponent(cc.RichText).string=StringUtil.parse(t.aim_str),e.holiday_item_bid!=a.ActionRankCommonType.longin_gift?e.btn_goto.active=0==t.status:0==t.status?(e.btn_get.active=!0,e.btn_get_ui.interactable=!1,e.btn_get_ui.enableAutoGrayEffect=!0,e.btn_get_label.color=new cc.Color(255,255,255)):(e.btn_get_ui.interactable=!0,e.btn_get_ui.enableAutoGrayEffect=!1,e.btn_get_label.color=new cc.Color(113,40,4)),1==e.is_activity_end&&0==t.status&&(e.btn_goto_label.getComponent(cc.Label).string="\u5df2\u7ed3\u675f",e.btn_goto_label.color=new cc.Color(255,255,255),Utils.setGreyButton(this.btn_goto.getComponent(cc.Button),!0));for(var i=t.item_list,s=[],n=0;n<i.length;++n){var o=i[n];o&&o.bid&&s.push(o)}e.item_scrollview.setData(s),e.item_scrollview.addEndCallBack(function(){e.item_scrollview.scroll_view_compend.enabled=!1;for(var t=e.item_scrollview.getItemList(),i=0;i<t.length;++i){t[i].setDefaultTip(!0,!1)}}.bind(this))}}},getButtonTeskProgress:function(t){var e="";if(this.holiday_item_bid!=a.ActionRankCommonType.longin_gift){var i,s,n=Utils.keyfind("aim_args_key",4,t.aim_args)||null;n&&(i=n.aim_args_val||0);var o,l=Utils.keyfind("aim_args_key",5,t.aim_args)||null;l&&(s=l.aim_args_val||0),i>=0&&s>=0&&(e="("+s+"/"+i+")");var r=Utils.keyfind("aim_args_key",6,t.aim_args)||null;r&&(o=r.aim_args_val||0),o>=0&&i>=0&&(e="("+o+"/"+i+")",o>=i&&0==t.status&&(t.status=2));var c=Utils.keyfind("aim_args_key",18,t.aim_args)||null;c&&(this.cur_bid=c.aim_args_val||0),this.holiday_item_bid==a.ActionRankCommonType.acc_luxury?e=0==t.status?"(0/1)":"(1/1)":this.holiday_item_bid!=a.ActionRankCommonType.totle_charge&&this.holiday_item_bid!=a.ActionRankCommonType.totle_consume&&this.holiday_item_bid!=a.ActionRankCommonType.limit_charge||(e="("+this.finish+"/"+t.aim+")")}else e="("+this.finish+"/"+t.aim+")";this.text_tesk.getComponent(cc.Label).string=e,this.btn_get.active=1==t.status,this.has_get.active=2==t.status},onDelete:function(){this.item_scrollview&&(this.item_scrollview.deleteMe(),this.item_scrollview=null)}});cc._RF.pop()},{action_const:"action_const",action_controller:"action_controller",common_scrollview:"common_scrollview",hero_const:"hero_const",hero_controller:"hero_controller",pathtool:"pathtool",stronger_controller:"stronger_controller",vip_controller:"vip_controller"}],action_common_panel:[function(t,e,i){"use strict";cc._RF.push(e,"a8e01LASa1EWb750z0bL5Dv","action_common_panel");var s=t("pathtool"),n=t("action_const"),a=t("action_common_Item"),o=t("common_scrollview"),l=t("action_controller"),r=t("action_event"),c=t("timetool"),_=t("rank_constant"),h=t("rank_controller");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("action","action_hero_expedit_panel"),this.ctrl=l.getInstance(),this.holiday_bid=arguments[0]},initConfig:function(){var t=new cc.Color(108,210,40),e=new cc.Color(255,0,0),i=new cc.color(255,0,0);this.colorText=[t,e,i]},initPanel:function(){this.main_container=this.root_wnd.getChildByName("main_container"),this.title_con=this.main_container.getChildByName("title_con"),this.time_label=this.title_con.getChildByName("label_time_key"),this.time_text=this.title_con.getChildByName("label_time").getComponent(cc.Label),this.time_text.node.color=new cc.Color(128,247,49,255),this.rank_btn=this.title_con.getChildByName("rank_btn"),this.rank_btn.getChildByName("label").getComponent(cc.Label).string="\u8be6\u7ec6\u6392\u884c",this.reward_btn=this.title_con.getChildByName("reward_btn"),this.reward_btn.getChildByName("label").getComponent(cc.Label).string="\u5956\u52b1\u9884\u89c8",this.btn_rule=this.title_con.getChildByName("btn_rule"),this.btn_rule.active=!1,this.loadBannerImage(),this.goods_con=this.main_container.getChildByName("charge_con");var t=this.goods_con.getContentSize(),e=cc.size(t.width,t.height),i={item_class:a,start_x:0,space_x:0,start_y:0,space_y:0,item_width:688,item_height:150,row:0,col:1,need_dynamic:!0};this.item_scrollview=new o,this.item_scrollview.createScroll(this.goods_con,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,e,i)},loadBannerImage:function(){this.holiday_bid==n.ActionRankCommonType.hero_expedit||this.holiday_bid==n.ActionRankCommonType.adventure?this.btn_rule.active=!0:this.holiday_bid==n.ActionRankCommonType.longin_gift||this.holiday_bid==n.ActionRankCommonType.luckly_egg?(this.reward_btn.active=!1,this.rank_btn.active=!1):this.holiday_bid!=n.ActionRankCommonType.acc_luxury&&this.holiday_bid!=n.ActionRankCommonType.totle_charge&&this.holiday_bid!=n.ActionRankCommonType.totle_consume&&this.holiday_bid!=n.ActionRankCommonType.fusion_blessing&&this.holiday_bid!=n.ActionRankCommonType.updata_star&&this.holiday_bid!=n.ActionRankCommonType.hero_awake&&this.holiday_bid!=n.ActionRankCommonType.limit_charge||(this.holiday_bid==n.ActionRankCommonType.acc_luxury&&(this.btn_rule.active=!0),this.btn_rule.x=318,this.time_label.setPosition(cc.v2(141,-133)),this.time_text.node.setPosition(cc.v2(234,-133)),this.reward_btn.active=!1,this.rank_btn.active=!1);var t=this.title_con.getChildByName("title_img").getComponent(cc.Sprite),e="txt_cn_welfare_banner11",i=this.ctrl.getActionSubTabVo(this.holiday_bid);i&&""!=i.reward_title&&i.reward_title&&(e=i.reward_title);var a=s.getWelfareBannerRes(e);this.loadRes(a,function(e){t.spriteFrame=e}.bind(this))},registerEvent:function(){this.addGlobalEvent(r.UPDATE_HOLIDAY_SIGNLE,function(t){t&&t.bid==this.holiday_bid&&this.setPanelData(t)}.bind(this)),this.rank_btn.on("click",function(){Utils.playButtonSound(1),this.jumpRankView()},this),this.reward_btn.on("click",function(){Utils.playButtonSound(1),h.getInstance().openRankRewardPanel(!0,this.holiday_bid)},this),this.btn_rule.on("click",function(){Utils.playButtonSound(1);var e=Config.holiday_client_data.data_constant.expedit_rules;this.holiday_bid==n.ActionRankCommonType.adventure?e=Config.holiday_client_data.data_constant.adventure_rules:this.holiday_bid==n.ActionRankCommonType.acc_luxury&&(e=Config.holiday_client_data.data_constant.luxury_rules);var i=this.btn_rule.convertToWorldSpaceAR(cc.v2(0,0));t("tips_controller").getInstance().showCommonTips(e.desc,i,null,null,500)},this),this.ctrl.cs16603(this.holiday_bid)},setPanelData:function(t){var e=!1,i=t.remain_sec||0;if(this.holiday_bid!=n.ActionRankCommonType.epoint_gold&&this.holiday_bid!=n.ActionRankCommonType.speed_fight&&this.holiday_bid!=n.ActionRankCommonType.voyage&&this.holiday_bid!=n.ActionRankCommonType.hero_expedit&&this.holiday_bid!=n.ActionRankCommonType.adventure||(i-=86400)<=0&&(i=0,e=!0),this.item_scrollview){this.ctrl.getModel().sortItemList(t.aim_list);var s={};s.bid=this.holiday_bid,s.time_end=e,s.finish=t.finish,this.item_scrollview.setData(t.aim_list,null,s)}this.holiday_bid==n.ActionRankCommonType.acc_luxury?(this.time_text.node.active=!1,this.time_label.active=!1):(this.time_text.node.active=!0,this.time_label.active=!0,this.ctrl.getModel().setCountDownTime(this.time_text,i))},jumpRankView:function(){var t=_.RankType.hero_expedit;this.holiday_bid==n.ActionRankCommonType.speed_fight?t=_.RankType.speed_fight:this.holiday_bid==n.ActionRankCommonType.voyage?t=_.RankType.voyage:this.holiday_bid==n.ActionRankCommonType.epoint_gold?t=_.RankType.pointglod:this.holiday_bid==n.ActionRankCommonType.adventure&&(t=_.RankType.adventure_muster),h.getInstance().openRankView(!0,t)},onShow:function(t){},onHide:function(){},setLessTime:function(t){this.time_text&&((t=t||0)>0?(this.setTimeFormatString(t),null==this.time_tichet&&(this.time_tichet=gcore.Timer.set(function(){if(--t<0){if(gcore.Timer.del(this.time_tichet),this.time_tichet=null,this.time_text.string="\u5df2\u7ed3\u675f",this.time_text.node.color=this.colorText[2],this.holiday_item_data&&this.item_scrollview){this.ctrl.getModel().sortItemList(this.holiday_item_data.aim_list);var e={};e.bid=this.holiday_bid,e.time_end=!0,this.item_scrollview.setData(this.holiday_item_data.aim_list,null,e)}}else this.setTimeFormatString(t)}.bind(this),1e3,-1))):this.setTimeFormatString(t))},setTimeFormatString:function(t){t>0?(this.time_text.string=c.getTimeFormatDayIIIIIIII(t),this.time_text.node.color=this.colorText[0]):(this.time_text.string="\u5df2\u7ed3\u675f",this.time_text.node.color=this.colorText[1])},onDelete:function(){this.item_scrollview&&(this.item_scrollview.deleteMe(),this.item_scrollview=null),this.time_tichet&&(gcore.Timer.del(this.time_tichet),this.time_tichet=null),this.time_text.node&&this.time_text.node.stopAllActions()}});cc._RF.pop()},{action_common_Item:"action_common_Item",action_const:"action_const",action_controller:"action_controller",action_event:"action_event",common_scrollview:"common_scrollview",pathtool:"pathtool",rank_constant:"rank_constant",rank_controller:"rank_controller",timetool:"timetool",tips_controller:"tips_controller"}],action_const:[function(t,e,i){"use strict";var s,n;function a(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}cc._RF.push(e,"6adbcZ3xfRDuqk3p+whkrcV","action_const");var o={ActionType:{Operate:0,OpenServer:1,Combine:2,Wonderful:4,SingleWonderful:3},ActionPanelTypeView:(s={},a(s,5,"action_limit_buy_panel"),a(s,15,"action_acc_level_up_gift_panel"),a(s,16,"action_common_panel"),a(s,17,"action_limit_change_panel"),a(s,30,"start_work_panel"),a(s,102,"action_limit_yuanzhen_panel"),a(s,103,"action_time_summon_panel"),a(s,104,"action_time_shop_panel"),a(s,111,"action_high_value_gift_panel"),a(s,113,"action_mysterious_store_panel"),a(s,115,"action_buy_skin_panel"),a(s,118,"limitexercise_panel"),a(s,120,"elitesummon_panel"),s),ActionExtType:{ActivityMaxCount:2,RechageTotalCount:4,RechageCurCount:5,ActivityCurrentCount:6,BossId:8,BossIcon:9,BossMinPower:10,BossReplayId:11,BossRecommendPower:12,RechargeMaxCount:13,RechargeUseCount:14,RechargeAvailableCount:15,RechargeBackOutItem:16,RechargeRMB:17,GodPartnerId:18,ItemId:19,ItemNum:20,PopItemId:21,PopItemNum:22,ActivityAddCount:23,ActivityFestvalTime:24,ActivityFestvalDiscount:25,ActivityOldPrice:26,ActivityCurrentPrice:27,ItemRechargeId:33,ItemDesc:34},ActionStatus:{un_finish:0,finish:1,completed:2},ActionSpecialID:{invest:991003,growfund:991008},FundType:{type_one:101,type_two:102},FundRedIndex:{fund_get_one:1,fund_get_two:2,fund_buy_one:3,fund_buy_two:4},ActionRankCommonType:{epoint_gold:97001,speed_fight:97002,voyage:97003,hero_expedit:97004,adventure:97005,yuanzhen_adventure:93018,exercise_1:93031,exercise_2:93032,exercise_3:93033,time_summon:93019,start_welfare:93020,dial:93022,qingming:93023,smashegg:93024,common_day:991011,festval_day:991024,lover_day:991025,longin_gift:991027,limit_charge:991028,luckly_egg:93025,acc_luxury:991021,totle_charge:91022,totle_consume:991023,fusion_blessing:993013,updata_star:993014,hero_awake:993026,open_server:91029,mysterious_store:993028,week_gift:991034,high_value_gift:991030,seven_charge:991036,elite_summon:93034,action_wolf:93018,limit_exercise:97007,action_skin_buy:991032},ActionChangeCommonType:{limit_change:93003,limit_change1:993003,limit_festive:93011,limit_festive1:993011,limit_gift:93010,limit_gift1:993010,limit_garden:93012,limit_garden1:993012,limit_yuanzhen:93017,limit_yuanzhen1:993017}};o.ActionTypeChange=(a(n={},0,o.ActionType.Operate),a(n,1,o.ActionType.OpenServer),a(n,3,o.ActionType.SingleWonderful),n),o.ActonExchangeType={Other:0,Perday:1,AllServer:2,Activity:3},e.exports=o,cc._RF.pop()},{}],action_controller:[function(t,e,i){"use strict";cc._RF.push(e,"3233cqURXpAKa0bpEoK/Loq","action_controller");var s=t("action_const"),n=t("mainui_controller"),a=t("mainui_const"),o=t("action_event"),l=t("role_controller"),r=t("welfare_controller"),c=t("orderaction_const"),_=cc.Class({extends:BaseController,ctor:function(){},initConfig:function(){var e=t("action_model");this.model=new e,this.model.initConfig(),this.mainui_ctrl=n.getInstance(),this.holiday_list={},this.holiday_del_list={},this.holiday_award_list={},this.need_show_init_red={}},getModel:function(){return this.model},registerEvents:function(){null==this.init_role_event&&(this.init_role_event=gcore.GlobalEvent.bind(EventId.EVT_ROLE_CREATE_SUCCESS,function(){gcore.GlobalEvent.unbind(this.init_role_event),this.needRequireData(),this.init_role_event=null}.bind(this)))},needRequireData:function(){this.openActionMainPanel(!1),this.holiday_list={},this.holiday_award_list={},this.need_show_init_red={},this.holiday_del_list={},this.is_init_require=!0,this.model.clearFundSrvData(),this.requestActionStatus(),this.requestHolidayList(s.ActionType.Wonderful)},registerProtocals:function(){this.RegisterProtocal(10922,this.on10922),this.RegisterProtocal(16601,this.on16601),this.RegisterProtocal(16603,this.on16603),this.RegisterProtocal(16604,this.on16604),this.RegisterProtocal(10923,this.on10923),this.RegisterProtocal(10924,this.on10924),this.RegisterProtocal(10925,this.on10925),this.RegisterProtocal(16602,this.on16602),this.RegisterProtocal(16606,this.on16606),this.RegisterProtocal(16607,this.on16607),this.RegisterProtocal(24700,this.handle24700),this.RegisterProtocal(24701,this.handle24701),this.RegisterProtocal(24702,this.handle24702),this.RegisterProtocal(21100,this.on21100),this.RegisterProtocal(21101,this.on21101),this.RegisterProtocal(13601,this.handle13601),this.RegisterProtocal(13602,this.handle13602),this.RegisterProtocal(21200,this.handle21200),this.RegisterProtocal(21201,this.handle21201),this.RegisterProtocal(16650,this.handle16650),this.RegisterProtocal(16637,this.handle16637),this.RegisterProtocal(16638,this.handle16638),this.RegisterProtocal(16639,this.handle16639),this.RegisterProtocal(16641,this.handle16641),this.RegisterProtocal(16642,this.handle16642),this.RegisterProtocal(16643,this.handle16643),this.RegisterProtocal(16688,this.handle16688),this.RegisterProtocal(16689,this.handle16689),this.RegisterProtocal(21210,this.handle21210),this.RegisterProtocal(21211,this.handle21211),this.RegisterProtocal(21016,this.handle21016),this.RegisterProtocal(16687,this.handle16687),this.RegisterProtocal(24810,this.handle24810),this.RegisterProtocal(24811,this.handle24811),this.RegisterProtocal(24812,this.handle24812),this.RegisterProtocal(21220,this.handle21220),this.RegisterProtocal(24813,this.handle24813),this.RegisterProtocal(24814,this.handle24814),this.RegisterProtocal(30101,this.handle30101),this.RegisterProtocal(30100,this.handle30100),this.RegisterProtocal(30102,this.handle30102)},requestActionStatus:function(){this.SendProtocal(10922,{}),this.SendProtocal(10924,{}),this.on10925(c.OrderActionEntranceID.entrance_id)},handleActionStatusData:function(t){if(t){if(null==Config.function_data.data_info[t.id])return;t.status==s.ActionStatus.un_finish?this.mainui_ctrl.removeFunctionIconById(t.id):(this.mainui_ctrl.addFunctionIconById(t.id,t),t.id==a.icon.seven_rank||t.id==a.icon.fund&&this.model.checkFundRedStatus())}},setHolidayStatus:function(t,e){if(null!=this.holiday_list&&null!=this.holiday_list[t]){null==this.holiday_award_list&&(this.holiday_award_list={});var i,s={bid:t,status:e};i=e?{bid:t,num:1}:{bid:t,num:0},this.holiday_award_list[t]=s;var n=this.holiday_list[t],l=a.icon.welfare;this.isSpecialBid(t)?this.mainui_ctrl.setFunctionTipsStatus(a.icon.welfare,i):(this.mainui_ctrl.setFunctionTipsStatus(n.cli_type,i),l=n.cli_type),gcore.GlobalEvent.fire(o.UPDATE_HOLIDAY_TAB_STATUS,l,s)}},on10922:function(t){if(null==this.protocal_list_22&&(this.protocal_list_22={}),null!=t&&t.act_list)for(var e=0;e<t.act_list.length;++e){var i=t.act_list[e];this.handleActionStatusData(i),i.status==s.ActionStatus.un_finish?this.protocal_list_22[i.id]=null:this.protocal_list_22[i.id]=i.id}},on10923:function(t){this.handleActionStatusData(t),t&&(null==this.protocal_list_22&&(this.protocal_list_22={}),t.status==s.ActionStatus.un_finish?this.protocal_list_22[t.id]=null:this.protocal_list_22[t.id]=t.id)},on10924:function(t){if(cc.log("\u4e2a\u4eba\u6d3b\u52a8on10924",t),null!=t&&t.act_list)for(var e=0;e<t.act_list.length;++e){var i=t.act_list[e];this.handleActionStatusData(i),a.first_red_point[i.id]&&1==i.status&&this.mainui_ctrl.setFunctionTipsStatus(i.id,a.first_red_point[i.id])}},on10925:function(t){this.handleActionStatusData(t),a.first_red_point[t.id]&&1==t.status&&this.mainui_ctrl.setFunctionTipsStatus(t.id,a.first_red_point[t.id])},requestActionAwardStatus:function(t){var e={};e.type=t,this.SendProtocal(16602,e)},requestHolidayList:function(t){var e={};e.type=t,this.SendProtocal(16601,e)},on16602:function(t){for(var e=0;e<t.holiday_list.length;++e){var i=t.holiday_list[e];this.setHolidayStatus(i.bid,0!=i.can_get_num)}},on16601:function(e){var i;cc.log(e,"on16601");for(var s={},n=0;n<e.holiday_list.length;++n){var a=e.holiday_list[n];if(null==this.holiday_del_list[a.bid]){if(null==(i=this.holiday_list[a.bid]))i=new(t("action_sub_tab_vo")),this.holiday_list[a.bid]=i;null!=(i=this.holiday_list[a.bid])&&i.update(a),this.isSpecialBid(a.bid)&&(i.setShowStatus(!1),this.cs16603(a.bid)),0!=i.cli_type&&(null==s[i.cli_type]&&(s[i.cli_type]={action_num:0,action_name:""}),this.isSpecialBid(i.bid)||(s[i.cli_type].action_num=s[i.cli_type].action_num+1,""!=i.cli_type_name&&"null"!=i.cli_type_name&&""==s[i.cli_type].action_name&&(s[i.cli_type].action_name=i.cli_type_name)))}}for(var o in 1==this.is_init_require&&(this.requestActionAwardStatus(),this.is_init_require=!1),s){var l=s[o];l&&(l.action_num>0?this.mainui_ctrl.addFunctionIconById(o,l.action_name):this.mainui_ctrl.removeFunctionIconById(o))}},on16603:function(t){if(t.bid==s.ActionRankCommonType.common_day||t.bid==s.ActionRankCommonType.festval_day||t.bid==s.ActionRankCommonType.lover_day?this.model.updataFestvalRedStatus(t.bid,t.aim_list):1011==t.bid?this.model.updataCombineLoginRedStatus(t.aim_list):991014==t.bid?this.model.updataPreferentialRedStatus(!0,a.icon.preferential):91014==t.bid&&this.model.updataPreferentialRedStatus(!0,a.icon.other_preferential),91005==t.bid?this.handle91005Data(t):(t.bid,s.ActionRankCommonType.seven_charge),this.isSpecialBid(t.bid)&&0==t.finish&&null==this.need_show_init_red[t.bid]&&0!=t.aim_list.length){var e=!1,i=Config.holiday_client_data.data_info[t.bid];if(i){var n=i.open_lev,c=l.getInstance().getRoleVo();n&&c.lev&&c.lev>=n&&(e=!0)}this.need_show_init_red[t.bid]=e,this.setHolidayStatus(t.bid,e),t.bid==s.ActionSpecialID.growfund&&r.getInstance().setWelfareStatus(s.ActionSpecialID.growfund,e)}gcore.GlobalEvent.fire(o.UPDATE_HOLIDAY_SIGNLE,t)},isSpecialBid:function(t){return t==s.ActionSpecialID.invest||t==s.ActionSpecialID.growfund},handle91005Data:function(t){if(this.today_list||(this.today_list={}),t.aim_list&&null!=Utils.next(t.aim_list))for(var e=0;e<t.aim_list.length;++e)for(var i=t.aim_list[e],s=0;s<i.aim_args.length;++s){var n=i.aim_args[s];3==n.aim_args_key?1==n.aim_args_val&&(this.today_list[e]=i,this.today_list[e].has_num=this.has_num,this.today_list[e].item_effect_list=this.item_effect_list):4==n.aim_args_key?this.today_list[e]&&(this.today_list[e].need_charge=n.aim_args_val):5==n.aim_args_key?this.today_list[e]&&(this.today_list[e].charge_day=n.aim_args_val):6==n.aim_args_key&&this.today_list[e]&&(this.today_list[e].has_charge=n.aim_args_val)}},getActionSubTabVo:function(t){if(null!=this.holiday_list)return this.holiday_list[t]},getAllActionList:function(){return this.holiday_list},cs16603:function(t){var e={};e.bid=t,this.SendProtocal(16603,e)},cs16604:function(t,e,i){var s={};s.bid=t,s.aim=e,s.arg=i||0,this.SendProtocal(16604,s)},on16604:function(t){message(t.msg)},sender24700:function(){this.SendProtocal(24700,{})},handle24700:function(t){t&&t.ids&&(this.model.setOpenFundIds(t.ids),gcore.GlobalEvent.fire(o.UPDATA_FUND_ID_LIST_EVENT))},sender24701:function(t){var e={};e.id=t,this.SendProtocal(24701,e)},handle24701:function(t){t&&(this.model.setFundSrvData(t),gcore.GlobalEvent.fire(o.UPDATA_FUND_DATA_EVENT,t.id))},sender24702:function(t){var e={};e.id=t,this.SendProtocal(24702,e)},handle24702:function(t){t.msg&&message(t.msg)},openActionFundAwardWindow:function(e,i,s){if(e){if(!this.fund_award_win){var n=t("action_fund_award_window");this.fund_award_win=new n}0==this.fund_award_win.isOpen()&&this.fund_award_win.open({group_id:i,fund_id:s})}else this.fund_award_win&&(this.fund_award_win.close(),this.fund_award_win=null)},cs21100:function(){this.SendProtocal(21100,{})},on21100:function(t){for(var e in t.status_list)if(2==t.status_list[e].status){this.mainui_ctrl.setFunctionTipsStatus(a.icon.seven_login,!0);break}e=0;for(var i in t.status_list)3==t.status_list[i].status&&(e+=1);e==t.status_list.length&&this.mainui_ctrl.setFunctionTipsStatus(a.icon.seven_login,!1),this.model.updateSevenLoginData(t),gcore.GlobalEvent.fire(o.UPDATE_SEVEN_LOGIN_STATUS,t)},cs21101:function(t){var e={};e.day=t,this.SendProtocal(21101,e)},on21101:function(t){message(t.msg),1==t.code&&(gcore.GlobalEvent.fire(o.UPDATE_SEVEN_LOGIN_REWARDS,t),this.cs21100())},openSevenLoginWin:function(t){t?(this.seven_login_win||(this.seven_login_win=Utils.createClass("action_seven_login_window",this)),this.seven_login_win&&0==this.seven_login_win.isOpen()&&this.seven_login_win.open()):this.seven_login_win&&(this.seven_login_win.close(),this.seven_login_win=null)},openSevenGoalView:function(t){t?(this.seven_goal_win||(this.seven_goal_win=Utils.createClass("action_seven_goal_window",this)),this.seven_goal_win&&0==this.seven_goal_win.isOpen()&&this.seven_goal_win.open()):this.seven_goal_win&&(this.seven_goal_win.close(),this.seven_goal_win=null)},cs13601:function(){this.SendProtocal(13601,{})},handle13601:function(t){0!=t.period&&(this.model.setSevenGoldPeriod(t.period||1),this.model.initSevenWalfare(t.period||1),this.model.setSevenGoalWelfareList(t.welfare_list),this.model.setSevenGoalGrowList(t.grow_list),this.model.setHalfGiftList(t.price_list),this.model.setSevenGoalBoxList(t.finish_list,t.num),this.model.checkRedPoint(t.cur_day),gcore.GlobalEvent.fire(o.UPDATE_SEVENT_GOAL,t))},cs13602:function(t,e,i,s){var n={};n.type=t,n.day_type=e,n.id=i,n.item=s,this.SendProtocal(13602,n)},handle13602:function(t){message(t.msg),1==t.flag&&gcore.GlobalEvent.fire(o.UPDATE_SEVENT_GET,t)},openActionMainPanel:function(t,e,i){if(0==t)null!=this.action_operate&&(this.action_operate.close(),this.action_operate=null);else{if(null!=i){var s=this.holiday_list[i];s&&(e=s.cli_type)}null==e&&(e=a.icon.action),null==this.action_operate&&(this.action_operate=Utils.createClass("action_main_window")),0==this.action_operate.isOpen()&&this.action_operate.open({function_id:e,action_bid:i})}},getActionSubList:function(t){var e=[];if(this.holiday_list)for(var i in this.holiday_list){var s=this.holiday_list[i];s.cli_type==t&&1==s.isShowInAction()&&e.push(s)}return null!=Utils.next(e)&&e.sort(function(t,e){return t.sort_val-e.sort_val}),e},send21200:function(){this.SendProtocal(21200,{})},handle21200:function(t){gcore.GlobalEvent.fire(o.UPDATE_LEVEL_UP_GIFT,t)},send21201:function(t){var e={};e.id=t,this.SendProtocal(21201,e)},handle21201:function(t){message(t.msg)},getHolidayAweradsStatus:function(t){if(null!=this.holiday_award_list&&null!=this.holiday_award_list[t])return this.holiday_award_list[t]},send16650:function(t){var e={};e.bid=t,this.SendProtocal(16650,e)},handle16650:function(t){message(t.msg),gcore.GlobalEvent.fire(o.RANK_REWARD_LIST,t)},on16606:function(t){this.setHolidayStatus(t.bid,0!=t.can_get_num)},on16607:function(t){t&&0==t.type&&this.needRequireData(!0)},requestLucky:function(){this.SendProtocal(16637,{})},handle16637:function(t){this.model.setTreasureInitData(t.dial_data),this.model.lucklyRedPoint(),gcore.GlobalEvent.fire(o.UPDATE_LUCKYROUND_GET,t)},send16638:function(t,e){var i={};i.type=t,i.type2=e,this.SendProtocal(16638,i)},handle16638:function(t){gcore.GlobalEvent.fire(o.TREASURE_SUCCESS_DATA,t)},handle16639:function(t){gcore.GlobalEvent.fire(o.UPDATE_LUCKLY_DATA,t)},send16640:function(t,e){var i={};i.type=t,i.id=e,this.SendProtocal(16640,i)},handle16641:function(t){gcore.GlobalEvent.fire(o.UPDATA_TREASURE_LOG_DATA,t)},send16642:function(t){var e={};e.type=t,this.SendProtocal(16642,e)},handle16642:function(t){message(t.msg)},send16643:function(t,e){var i={};i.type=t,i.type2=e,this.SendProtocal(16643,i)},handle16643:function(t){message(t.msg),1==t.code&&gcore.GlobalEvent.fire(o.UPDATA_TREASURE_POPUPS_SEND,t)},openLuckyTreasureWin:function(t,e){if(e=e||1,t){if(0==this.mainui_ctrl.checkMainFunctionOpenStatus(a.icon.lucky_treasure,a.function_type.other,!1))return;if(2==e){this.model.setBuyRewardData();var i=this.model.getBuyRewardData(e);if(0==this.mainui_ctrl.checkIsOpenByActivate(i[1].limit_open))return void message(Utils.TI18N("\u4eba\u7269\u7b49\u7ea7\u4e0d\u8db3"))}this.treasure_win||(this.treasure_win=Utils.createClass("action_treasure_window",this)),this.treasure_win&&0==this.treasure_win.isOpen()&&this.treasure_win.open(e)}else this.treasure_win&&(this.treasure_win.close(),this.treasure_win=null)},getTreasureView:function(){if(this.treasure_win)return this.treasure_win},checkOpenActionLimitGiftMainWindow:function(){if(2001!=this.active_limit_gift_id){if(null!=this.active_limit_gift_id){var e=Config.star_gift_data.data_limit_gift[this.active_limit_gift_id];if(e){var i=this.active_limit_gift_id;t("commonalert").show(e.desc,Utils.TI18N("\u524d\u5f80"),function(){this.openActionLimitGiftMainWindow(!0,i)}.bind(this),Utils.TI18N("\u53d6\u6d88"))}}this.active_limit_gift_id=null}else this.active_limit_gift_id=null},openActionLimitGiftMainWindow:function(e,i){if(e){if(!this.action_limit_gift){var s=t("action_limit_gift_main_window");this.action_limit_gift=new s}this.action_limit_gift.open(i)}else this.action_limit_gift&&(this.action_limit_gift.close(),this.action_limit_gift=null)},send21210:function(){this.SendProtocal(21210,{})},handle21210:function(t){message(t.msg),gcore.GlobalEvent.fire(o.LIMIT_GIFT_MAIN_EVENT,t)},handle21211:function(t){this.active_limit_gift_id=t.id},openTreasureGetItemWindow:function(e,i,s,n){if(e){if(!this.treasure_get_win){var a=t("action_treasure_get_window");this.treasure_get_win=new a(this,i,s,n)}this.treasure_get_win&&0==this.treasure_get_win.isOpen()&&this.treasure_get_win.open()}else this.treasure_get_win&&(this.treasure_get_win.close(),this.treasure_get_win=null)},getSevenLoginRoot:function(){if(this.seven_login_win)return this.seven_login_win.root_wnd},getTreasureRoot:function(){if(this.treasure_win)return this.treasure_win.root_wnd},checkCanAddWonderful:function(t){if(null==t)return!1;if(null==this.holiday_list||null==Utils.next(this.holiday_list))return!1;for(var e in this.holiday_list){if(this.holiday_list[e].cli_type==t)return!0}return!1},sender16688:function(){this.SendProtocal(16688,{})},handle16688:function(t){this.model.setStoneShopData(t.buy_info),gcore.GlobalEvent.fire(o.UPDATE_STORE_DATA_EVENT)},sender16689:function(t,e){var i={};i.id=t,i.num=e,this.SendProtocal(16689,i)},handle16689:function(t){message(t.msg),1==t.code&&gcore.GlobalEvent.fire(o.UPDATE_STORE_DATA_SUCCESS_EVENT,t)},sender16687:function(t){var e=t||{},i=0;for(var s in t){i+=1;break}0==i&&(e.bid=91029),this.SendProtocal(16687,e)},handle16687:function(t){var e=!1;1==t.code&&(e=!0),t.status=e,t.bid==s.ActionRankCommonType.open_server?n.getInstance().setFunctionTipsStatus(a.icon.open_server_recharge,e):t.bid!=s.ActionRankCommonType.high_value_gift&&t.bid!=s.ActionRankCommonType.mysterious_store||this.model.updateGiftRedPointStatus(t)},sender21016:function(t){var e={};e.charge_id=t,this.SendProtocal(21016,e)},handle21016:function(t){gcore.GlobalEvent.fire(o.Is_Charge_Event,t)},requestActionRedStatus:function(){this.sender16687({bid:s.ActionRankCommonType.open_server}),this.sender16687({bid:s.ActionRankCommonType.high_value_gift}),this.sender16687({bid:s.ActionRankCommonType.mysterious_store})},sender24810:function(){this.SendProtocal(24810,{})},handle24810:function(t){message(t.msg),gcore.GlobalEvent.fire(o.YUAN_ZHEN_DATA_EVENT,t)},handle24811:function(t){gcore.GlobalEvent.fire(o.YUAN_ZHEN_UPDATA_EVENT,t)},sender24812:function(t){var e={};e.id=t,this.SendProtocal(24812,e)},handle24812:function(t){message(t.msg),1==t.code&&gcore.GlobalEvent.fire(o.YUAN_ZHEN_TASK_EVENT,t)},openTriggerGiftWindow:function(e){if(e){if(!this.action_time_gift_big){var i=t("action_time_gift_big_window");this.action_time_gift_big=new i(this)}this.action_time_gift_big&&0==this.action_time_gift_big.isOpen()&&this.action_time_gift_big.open()}else this.action_time_gift_big&&(this.action_time_gift_big.close(),this.action_time_gift_big=null)},sender21220:function(){this.SendProtocal(21220,{})},handle21220:function(t){message(t.msg),gcore.GlobalEvent.fire(o.TRIGGER_GIFT_EVENT,t)},openActionOpenServerGiftWindow:function(e,i){if(e){if(!this.action_open_server_recharge){var s=t("action_open_server_gift_window");this.action_open_server_recharge=new s(this)}this.action_open_server_recharge&&0==this.action_open_server_recharge.isOpen()&&this.action_open_server_recharge.open(i)}else this.action_open_server_recharge&&(this.action_open_server_recharge.close(),this.action_open_server_recharge=null)},sender24813:function(){this.SendProtocal(24813,{})},handle24813:function(t){message(t.msg),gcore.GlobalEvent.fire(o.YUAN_ZHEN_DATA_EVENT,t)},checkActionExistByActionBid:function(t){return!!t&&!!this.getActionSubTabVo(t)},sender24814:function(t){var e={};e.id=t,this.SendProtocal(24814,e)},handle24814:function(t){message(t.msg),gcore.GlobalEvent.fire(o.YUAN_ZHEN_TASK_EVENT,t)},sender30101:function(){this.SendProtocal(30101,{})},handle30101:function(t){message(t.msg),gcore.GlobalEvent.fire(o.SKIN_INFO_EVENT,t)},sender30100:function(){this.SendProtocal(30100,{})},handle30100:function(t){message(t.msg)},handle30102:function(t){n.getInstance().setFunctionTipsStatus(a.icon.skin,1==t.code)},openBuySkinWindow:function(e){if(e){if(!this.action_buy_skin){var i=t("action_buy_skin_window");this.action_buy_skin=new i(this),this.action_buy_skin&&0==this.action_buy_skin.isOpen()&&this.action_buy_skin.open()}}else this.action_buy_skin&&(this.action_buy_skin.close(),this.action_buy_skin=null)}});e.exports=_,cc._RF.pop()},{action_buy_skin_window:"action_buy_skin_window",action_const:"action_const",action_event:"action_event",action_fund_award_window:"action_fund_award_window",action_limit_gift_main_window:"action_limit_gift_main_window",action_model:"action_model",action_open_server_gift_window:"action_open_server_gift_window",action_sub_tab_vo:"action_sub_tab_vo",action_time_gift_big_window:"action_time_gift_big_window",action_treasure_get_window:"action_treasure_get_window",commonalert:"commonalert",mainui_const:"mainui_const",mainui_controller:"mainui_controller",orderaction_const:"orderaction_const",role_controller:"role_controller",welfare_controller:"welfare_controller"}],action_event:[function(t,e,i){"use strict";cc._RF.push(e,"4044dWUsi9FJ6xG2yGrgq8D","action_event"),e.exports={Update_First_Charge_Status:"Update_First_Charge_Status",UPDATE_SEVEN_LOGIN_STATUS:"UPDATE_SEVEN_LOGIN_STATUS",UPDATE_SEVEN_LOGIN_REWARDS:"UPDATE_SEVEN_LOGIN_REWARDS",UPDATE_SEVEN_RANK_LIST:"UPDATE_SEVEN_RANK_LIST",UPDATE_SEVEN_RANK_DATA:"UPDATE_SEVEN_RANK_DATA",UPDATE_HOLIDAY_SIGNLE:"UPDATE_HOLIDAY_SIGNLE",UPDATE_HOLIDAY_TAB_STATUS:"UPDATE_HOLIDAY_TAB_STATUS",UPDATE_Delete_Btn:"UPDATE_Delete_Btn",UPDATE_91005_Btn:"UPDATE_91005_Btn",UPDATE_SEVENT_QUEST:"UPDATE_SEVENT_QUEST",UPDATE_SEVENT_LOTTERY:"UPDATE_SEVENT_LOTTERY",UPDATE_LOTTERY_REDPOINT:"UPDATE_LOTTERY_REDPOINT",UPDATE_CROSSSERVER_RANK_LIST:"UPDATE_CROSSSERVER_RANK_LIST",UPDATE_CROSSSERVER_RANK_DATA:"UPDATE_CROSSSERVER_RANK_DATA",UPDATE_CROSSSERVER_QUEST:"UPDATE_CROSSSERVER_QUEST",UPDATE_SEVENT_GOAL:"UPDATE_SEVENT_GOAL",UPDATE_SEVENT_GET:"UPDATE_SEVENT_GET",UPDATE_DIRECTGIFT_GET:"UPDATE_DIRECTGIFT_GET",UPDATE_LUCKYROUND_GET:"UPDATE_LUCKYROUND_GET",UPDATE_LUCKLY_DATA:"UPDATE_LUCKLY_DATA",TREASURE_SUCCESS_DATA:"TREASURE_SUCCESS_DATA",UPDATA_TREASURE_LOG_DATA:"UPDATA_TREASURE_LOG_DATA",UPDATA_TREASURE_POPUPS_SEND:"UPDATA_TREASURE_POPUPS_SEND",UPDATA_TREASURE_REFRESH:"UPDATA_TREASURE_REFRESH",UPDATE_LEVEL_UP_GIFT:"UPDATE_LEVEL_UP_GIFT",LIMIT_GIFT_MAIN_EVENT:"LIMIT_GIFT_MAIN_EVENT",RANK_REWARD_LIST:"RANK_REWARD_LIST",UPDATA_FUND_ID_LIST_EVENT:"UPDATA_FUND_ID_LIST_EVENT",UPDATA_FUND_DATA_EVENT:"UPDATA_FUND_DATA_EVENT",UPDATA_FUND_RED_STATUS_EVENT:"UPDATA_FUND_RED_STATUS_EVENT",YUAN_ZHEN_DATA_EVENT:"YUAN_ZHEN_DATA_EVENT",YUAN_ZHEN_UPDATA_EVENT:"YUAN_ZHEN_UPDATA_EVENT",YUAN_ZHEN_TASK_EVENT:"YUAN_ZHEN_TASK_EVENT",UPDATE_STORE_DATA_EVENT:"UPDATE_STORE_DATA_EVENT",UPDATE_STORE_DATA_SUCCESS_EVENT:"UPDATE_STORE_DATA_SUCCESS_EVENT",Is_Charge_Event:"Is_Charge_Event",SHOW_ACTIVITY_RED_POINT:"SHOW_ACTIVITY_RED_POINT",TRIGGER_GIFT_EVENT:"TRIGGER_GIFT_EVENT",SKIN_INFO_EVENT:"SKIN_INFO_EVENT"},cc._RF.pop()},{}],action_func_award_Item:[function(t,e,i){"use strict";cc._RF.push(e,"d26faE6G8ZLraoQcJNfkcq7","action_func_award_Item");var s=t("pathtool");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("action","action_fund_item")},initConfig:function(){},initPanel:function(){this.container=this.root_wnd.getChildByName("container");var t=this.container.getChildByName("image_bg").getComponent(cc.Sprite);this.loadRes(s.getUIIconPath("actionfund","actionfund_1002"),function(e){t.spriteFrame=e}.bind(this)),this.txt_time=this.container.getChildByName("txt_time"),this.txt_time.color=new cc.Color(100,50,35),this.data&&this.setData(this.data)},registerEvent:function(){},onShow:function(t){},onHide:function(){},setData:function(t){if(t){if(this.data=t,null!=this.root_wnd){this.txt_time.getComponent(cc.Label).string="\u7d2f\u8ba1"+(t.day||1)+"\u5929";var e=t.award[0][0],i=t.award[0][1];this.item_node||(this.item_node=ItemsPool.getInstance().getItem("backpack_item"),this.item_node.setDefaultTip(!0,!1),this.item_node.setPosition(0,25),this.item_node.setParent(this.container),this.item_node.initConfig(!1,.9,!1,!0),this.item_node.show()),this.item_node.setData({bid:e,num:i})}}},onDelete:function(){this.item_node&&this.item_node.deleteMe()}});cc._RF.pop()},{pathtool:"pathtool"}],action_func_one_Item:[function(t,e,i){"use strict";cc._RF.push(e,"ad5f4ltEO5AqqWIDoX9KjG8","action_func_one_Item");var s=t("pathtool");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("action","action_fund_item")},initConfig:function(){},initPanel:function(){this.container=this.root_wnd.getChildByName("container"),this.txt_time_lb=this.container.getChildByName("txt_time").getComponent(cc.Label),this.data&&this.setData(this.data)},registerEvent:function(){},onShow:function(t){},onHide:function(){},setData:function(t){if(t&&(this.data=t,this.root_wnd)){this.txt_time_lb.string="\u7d2f\u8ba1"+(t.day||1)+"\u5929";var e=t.award[0][0],i=t.award[0][1];this.item_node||(this.item_node=ItemsPool.getInstance().getItem("backpack_item"),this.item_node.setDefaultTip(!0,!1),this.item_node.setPosition(0,15),this.item_node.setParent(this.container),this.item_node.initConfig(!1,.8,!1,!0),this.item_node.show()),this.item_node.setData({bid:e,num:i})}},onDelete:function(){this.item_node&&this.item_node.deleteMe()}});cc._RF.pop()},{pathtool:"pathtool"}],action_fund_award_window:[function(t,e,i){"use strict";cc._RF.push(e,"6b1d8LjKwJMoI7xes1qatK0","action_fund_award_window");var s=t("pathtool"),n=t("common_scrollview"),a=t("action_func_award_Item"),o=t("action_controller");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("action","action_fund_award_window"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Full},initConfig:function(){this._controller=o.getInstance()},openCallBack:function(){this.background=this.root_wnd.getChildByName("background"),this.container=this.root_wnd.getChildByName("container");var t=this.container.getChildByName("list_panel"),e=t.getContentSize(),i={item_class:a,start_x:0,space_x:10,start_y:15,space_y:25,item_width:115,item_height:129,row:0,col:5,once_num:5};this.item_scrollview=new n,this.item_scrollview.createScroll(t,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,e,i)},registerEvent:function(){this.background.on("touchend",this._onClickCloseBtn,this)},_onClickCloseBtn:function(){this._controller.openActionFundAwardWindow(!1)},openRootWnd:function(t){var e=t.group_id,i=t.fund_id,s=Config.month_fund_data.data_fund_award[e]||{},n=[];for(var a in s){var o=s[a],l={};l.day=a,l.award=o,l.fund_id=i,n.push(l)}this.item_scrollview.setData(n)},closeCallBack:function(){this.item_scrollview&&(this.item_scrollview.deleteMe(),this.item_scrollview=null),this._controller.openActionFundAwardWindow(!1)}});cc._RF.pop()},{action_controller:"action_controller",action_func_award_Item:"action_func_award_Item",common_scrollview:"common_scrollview",pathtool:"pathtool"}],action_fund_one_panel:[function(t,e,i){"use strict";cc._RF.push(e,"b374fYXXn5HgJqP9k87LWOW","action_fund_one_panel");var s=t("pathtool"),n=t("common_scrollview"),a=t("action_func_one_Item"),o=t("action_controller"),l=t("action_event"),r=t("timetool"),c=t("action_const");cc.Class({extends:BasePanel,ctor:function(){this.fund_bid=arguments[0],this.prefabPath=s.getPrefabPath("action","action_fund_panel"),this._model=o.getInstance().getModel(),this._controller=o.getInstance()},initConfig:function(){},initPanel:function(){var t=this;t.main_container=t.root_wnd.getChildByName("main_container"),t.desc_rt=t.main_container.getChildByName("desc_txt").getComponent(cc.RichText),t.btn_award_nd=t.main_container.getChildByName("btn_award"),t.not_buy_panel=t.main_container.getChildByName("not_buy_panel"),t.not_buy_panel.active=!0,t.buy_btn=t.not_buy_panel.getChildByName("buy_btn"),t.buy_btn_label=t.buy_btn.getChildByName("label").getComponent(cc.Label);var e,i,o=t.main_container.getChildByName("image_bg").getComponent(cc.Sprite),l=this.seekChild("num",cc.Sprite);this.fund_bid==c.FundType.type_one?(e=s.getBigBg("txt_cn_action_fund_bg_1",null,"action"),i=s.getUIIconPath("actionfund","actionfund_1006")):this.fund_bid==c.FundType.type_two&&(e=s.getBigBg("txt_cn_action_fund_bg_2",null,"action"),i=s.getUIIconPath("actionfund","actionfund_1008")),this.loadRes(i,function(t){l.spriteFrame=t}.bind(this)),this.loadRes(e,function(t){o.spriteFrame=t}.bind(this)),this.loadRes(s.getItemRes(3),function(e){t.not_buy_panel.getChildByName("layout").getChildByName("item").getComponent(cc.Sprite).spriteFrame=e}.bind(this)),t.buy_panel=t.main_container.getChildByName("buy_panel"),t.buy_panel.active=!1,t.total_day_txt=t.buy_panel.getChildByName("total_day_txt"),t.time_txt=t.buy_panel.getChildByName("txt_time"),t.get_btn=t.buy_panel.getChildByName("get_btn");var r=t.main_container.getChildByName("goods_list"),_=cc.size(r.width,r.height),h={item_class:a,start_x:0,space_x:25,start_y:0,space_y:10,item_width:115,item_height:129,row:0,col:4};t.item_scrollview=new n,t.item_scrollview.createScroll(r,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,_,h),t.updateView()},registerEvent:function(){this.addGlobalEvent(l.UPDATA_FUND_DATA_EVENT,function(t){this.fund_bid==t&&this.setData()}.bind(this)),this.buy_btn.on("click",this._onClickBuyBtn,this),this.get_btn.on("click",this._onClickGetBtn,this),this.btn_award_nd.on("click",this._onClickAwardBtn,this)},onShow:function(t){},onHide:function(){},onDelete:function(){this.award_node&&(this.award_node.deleteMe(),this.award_node=null),this.item_scrollview&&(this.item_scrollview.deleteMe(),this.item_scrollview=null)},setVisibleStatus:function(t){if(t=t||!1,this.setVisible(t),1==t){var e=this._model.getFundSrvDataById(this.fund_bid);e&&null!=Utils.next(e)||this._controller.sender24701(this.fund_bid)}},updateView:function(){if(this.fund_bid){var t=Config.month_fund_data.data_fund_data[this.fund_bid];t&&(this.func_config=t,this.desc_rt.string=StringUtil.parse(t.desc),this.buy_btn_label.string=t.val+"\u5143",this.setData())}},setData:function(){var t=this._model.getFundSrvDataById(this.fund_bid);if(t&&null!=Utils.next(t)){this.srv_data=t;var e=Config.month_fund_data.data_fund_award[t.group_id]||{};if(this.func_config){for(var i=[],s=0;s<this.func_config.reward.length;++s){var n=this.func_config.reward[s],a={};a.day=n,a.award=e[n]||{},i.push(a)}this.item_scrollview.setData(i)}if(0==t.status||3==t.status){this.not_buy_panel.active=!0,this.buy_panel.active=!1;var o=this.buy_btn.getChildByName("label").getComponent(cc.LabelOutline);0==t.status?(Utils.setGreyButton(this.buy_btn.getComponent(cc.Button),!1),o.enabled=!0):(Utils.setGreyButton(this.buy_btn.getComponent(cc.Button),!0),o.enabled=!1)}else if(1==t.status||2==t.status){this.not_buy_panel.active=!1,this.buy_panel.active=!0,this.total_day_txt.getComponent(cc.Label).string="\u5f53\u524d\u7d2f\u8ba1\uff1a"+t.current_day+"\u5929";var l=t.endtime-2592e3;this.time_txt.getComponent(cc.Label).string=r.getMD2(l)+"~"+r.getMD2(t.endtime-1);var c=e[t.current_day]||[];if(c){var _=c[0][0],h=c[0][1];this.award_node||(this.award_node=ItemsPool.getInstance().getItem("backpack_item"),this.award_node.setDefaultTip(!0,!1),this.award_node.setPosition(108,104),this.award_node.setParent(this.buy_panel),this.award_node.show()),this.award_node.setData({bid:_,num:h})}var d=this.get_btn.getChildByName("label").getComponent(cc.LabelOutline);1==t.status?(Utils.setGreyButton(this.get_btn.getComponent(cc.Button),!1),d.enabled=!0):(Utils.setGreyButton(this.get_btn.getComponent(cc.Button),!0),d.enabled=!1)}}},_onClickGetBtn:function(){Utils.playButtonSound(1),this.srv_data&&1==this.srv_data.status&&this._controller.sender24702(this.srv_data.id)},_onClickAwardBtn:function(){Utils.playButtonSound(1),this.srv_data&&this._controller.openActionFundAwardWindow(!0,this.srv_data.group_id,this.fund_bid)},_onClickBuyBtn:function(){if(this.srv_data&&0==this.srv_data.status&&this.func_config){var t=this.func_config.charge_id,e=Config.charge_data.data_charge_data[t||0];e&&SDK.pay(e.val,null,e.id,e.name,e.name)}else this.srv_data&&3==this.srv_data.status&&message(Utils.TI18N("\u8bf7\u5148\u6fc0\u6d3b\u81f3\u5c0a\u6708\u5361"))}});cc._RF.pop()},{action_const:"action_const",action_controller:"action_controller",action_event:"action_event",action_func_one_Item:"action_func_one_Item",common_scrollview:"common_scrollview",pathtool:"pathtool",timetool:"timetool"}],action_grow_fund_Item:[function(t,e,i){"use strict";cc._RF.push(e,"bf8fcrhmbdNzZJjKmrzmiN/","action_grow_fund_Item");var s=t("pathtool"),n=t("action_const");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("action","action_grow_fund_Item")},initConfig:function(){},initPanel:function(){this.title_bg=this.root_wnd.getChildByName("title_bg"),this.title_lb=this.root_wnd.getChildByName("title").getComponent(cc.Label),this.get_btn=this.root_wnd.getChildByName("get_btn").getComponent(cc.Button),this.get_btn_lb=this.get_btn.node.getChildByName("label").getComponent(cc.Label),this.get_btn_lb_line=this.get_btn.node.getChildByName("label").getComponent(cc.LabelOutline),this.get_btn_lb.string="\u9886\u53d6",this.item_icon_1=this.root_wnd.getChildByName("item_icon_1").getComponent(cc.Sprite),this.item_icon_2=this.root_wnd.getChildByName("item_icon_2").getComponent(cc.Sprite),this.item_value_1=this.root_wnd.getChildByName("item_value_1").getComponent(cc.Label),this.item_value_2=this.root_wnd.getChildByName("item_value_2").getComponent(cc.Label),this.pass_icon=this.root_wnd.getChildByName("pass_icon"),this.data&&this.setData(this.data)},registerEvent:function(){this.get_btn.node.on("click",function(){Utils.playButtonSound(1),this.call_back&&this.data&&this.call_back(this.data)},this)},onShow:function(t){},onHide:function(){},setData:function(t){var e=this,i=this;if(i.data=t,t&&i.root_wnd&&(i.title_lb.string=t.aim_str||"",i.get_btn.node.active=t.status!=n.ActionStatus.completed,i.pass_icon.active=t.status==n.ActionStatus.completed,t.status==n.ActionStatus.un_finish?(i.get_btn.interactable=!1,i.get_btn.enableAutoGrayEffect=!0,i.get_btn_lb.string="\u672a\u8fbe\u6210",i.get_btn_lb_line.enabled=!1,i.title_bg.opacity=255):t.status==n.ActionStatus.finish?(i.get_btn.interactable=!0,i.get_btn.enableAutoGrayEffect=!1,i.get_btn_lb_line.enabled=!0,i.get_btn_lb.string="\u9886\u53d6",i.title_bg.opacity=255):t.status==n.ActionStatus.completed&&(i.title_bg.opacity=128),t.item_list))for(var a=function(n){var a=t.item_list[n],o=n+1;i["item_icon_"+o]&&e.loadRes(s.getItemRes(a.bid),function(t){i["item_icon_"+o].spriteFrame=t}.bind(e)),i["item_value_"+o]&&(i["item_value_"+o].string="X"+(a.num||0))},o=0;o<t.item_list.length;++o)a(o)},addCallBack:function(t){this.call_back=t},onDelete:function(){}});cc._RF.pop()},{action_const:"action_const",pathtool:"pathtool"}],action_grow_fund_panel:[function(t,e,i){"use strict";cc._RF.push(e,"608ceMjNUhJSb5oFRpAblUn","action_grow_fund_panel");var s=t("pathtool"),n=t("action_event"),a=t("action_controller"),o=t("action_const"),l=t("action_grow_fund_Item"),r=t("common_scrollview"),c=t("welfare_controller");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("action","action_grow_fund_panel")},initConfig:function(){this.item_list={},this.holiday_bid=991008,this.type=4},initPanel:function(){var t=this;t.main_container=t.root_wnd.getChildByName("main_container"),t.challenge_btn=t.main_container.getChildByName("challenge_btn"),t.challenge_btn_lb=t.challenge_btn.getChildByName("label").getComponent(cc.Label),t.goods_con=t.main_container.getChildByName("goods_con"),t.empty_tips=t.main_container.getChildByName("empty_tips"),t.empty_tips.getChildByName("label").string=Utils.TI18N("\u60a8\u5df2\u83b7\u5f97\u5168\u90e8\u6210\u957f\u57fa\u91d1"),t.title_con=t.main_container.getChildByName("title_con"),t.title_img=t.title_con.getChildByName("title_img").getComponent(cc.Sprite),this.loadRes(s.getUIIconPath("bigbg/action","txt_cn_action_grow_fund_title"),function(e){t.title_img.spriteFrame=e}.bind(this))},registerEvent:function(){var t=this;t.update_action_even_event||(t.update_action_even_event=this.addGlobalEvent(n.UPDATE_HOLIDAY_SIGNLE,function(e){e.bid==t.holiday_bid&&(t.createList(e),t.checkTabIconStatus(e))})),null==t.scroll_view&&a.getInstance().cs16603(t.holiday_bid),this.challenge_btn.on("click",function(){Utils.playButtonSound(1);var t=Config.charge_data.data_charge_data[101];t&&SDK.pay(t.val,null,t.id,t.name)},this)},onShow:function(t){},createList:function(t){var e=this;if(null!=t&&null!=t.aim_list){var i=0==t.finish&&null!=Utils.next(t.aim_list);if(e.challenge_btn_status!=i)if(e.challenge_btn_status=i,0==i)e.challenge_btn_lb.string="\u5df2\u5145\u503c",e.challenge_btn.getComponent(cc.Button).interactable=!1,e.challenge_btn.getComponent(cc.Button).enableAutoGrayEffect=!0,e.challenge_btn_lb.node.getComponent(cc.LabelOutline).enabled=!1;else{e.challenge_btn.getComponent(cc.Button).interactable=!0,e.challenge_btn.getComponent(cc.Button).enableAutoGrayEffect=!1;var s=Config.charge_data.data_charge_data[101],n=88;s&&(n=s.val);var c="\uffe5"+n+"\u8d2d\u4e70";e.challenge_btn_lb.string=c}for(var _=[],h=0;h<t.aim_list.length;++h){var d=t.aim_list[h];d.sort_index=0,d.status==o.ActionStatus.un_finish?d.sort_index=1:d.status==o.ActionStatus.finish?d.sort_index=0:d.status==o.ActionStatus.completed&&(d.sort_index=2),_.push(d)}if(null==Utils.next(_))e.empty_tips.active=!0,e.scroll_view&&(e.scroll_view.active=!1);else{if(_.sort(Utils.tableLowerSorter(["sort_index"],["aim"])),null==e.scroll_view){var u=cc.size(e.goods_con.width,e.goods_con.height),m={item_class:l,start_x:8,space_x:4,start_y:4,space_y:2,item_width:678,item_height:90,row:0,col:1,need_dynamic:!0};e.scroll_view=new r,e.scroll_view.createScroll(e.goods_con,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,u,m)}e.scroll_view.setData(_,function(t){t&&t.aim&&a.getInstance().cs16604(e.holiday_bid,t.aim,0)}),e.empty_tips.active=!1}}},checkTabIconStatus:function(t){if(null!=t&&null!=t.aim_list){for(var e=!1,i=0;i<t.aim_list.length;++i){if(t.aim_list[i].status==o.ActionStatus.finish){e=!0;break}}0!=t.finish&&0!=e||(a.getInstance().setHolidayStatus(this.holiday_bid,!1),this.holiday_bid==o.ActionSpecialID.growfund&&c.getInstance().setWelfareStatus(o.ActionSpecialID.growfund,!1))}},onHide:function(){},onDelete:function(){}});cc._RF.pop()},{action_const:"action_const",action_controller:"action_controller",action_event:"action_event",action_grow_fund_Item:"action_grow_fund_Item",common_scrollview:"common_scrollview",pathtool:"pathtool",welfare_controller:"welfare_controller"}],action_high_value_gift_panel:[function(t,e,i){"use strict";cc._RF.push(e,"79ae0DGSAJDmrW9FteIzBBg","action_high_value_gift_panel");var s=t("pathtool"),n=t("action_event"),a=t("action_const"),o=t("action_controller"),l=t("common_scrollview");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("action","action_high_value_gift_panel"),this.holiday_bid=arguments[0]},initConfig:function(){this.ctrl=o.getInstance(),this.model=this.ctrl.getModel(),this.touch_btn=!0},initPanel:function(){this.main_container=this.root_wnd.getChildByName("main_container"),this.img_bg=this.main_container.getChildByName("img_bg").getComponent(cc.Sprite);var t="txt_cn_action_high_value_gift_panel",e=Config.function_data.data_limit_little_recharge[this.holiday_bid];e&&e.bg_name&&""!=e.bg_name&&(t=e.bg_name);var i=s.getBigBg(t,null,"action");this.loadRes(i,function(t){this.img_bg.spriteFrame=t}.bind(this)),this.txt_time_title=this.main_container.getChildByName("txt_time_title").getComponent(cc.Label),this.txt_time_title.string=Utils.TI18N("\u5269\u4f59\u65f6\u95f4:"),this.txt_time_title.node.color=(new cc.Color).fromHEX(e.time_title_color.toString()),this.txt_time_title_line=this.main_container.getChildByName("txt_time_title").getComponent(cc.LabelOutline),this.txt_time_title_line.color=(new cc.Color).fromHEX(e.time_stroke_color),this.txt_time_val=this.main_container.getChildByName("txt_time_val").getComponent(cc.Label),this.txt_time_val.node.color=(new cc.Color).fromHEX(e.time_title_color),this.txt_time_val_line=this.main_container.getChildByName("txt_time_val").getComponent(cc.LabelOutline),this.txt_time_val_line.color=(new cc.Color).fromHEX(e.time_stroke_color),this.txt_price=this.main_container.getChildByName("txt_price").getComponent(cc.Label),this.txt_price.node.color=(new cc.Color).fromHEX(e.common_color),this.txt_discount_title=this.main_container.getChildByName("txt_discount_title").getComponent(cc.Label),this.txt_discount_title.string=Utils.TI18N("\u73b0\u4ef7\uff1a"),this.txt_discount_title.node.color=(new cc.Color).fromHEX(e.common_color),this.txt_discount_price=this.main_container.getChildByName("txt_discount_price").getComponent(cc.Label),this.txt_discount_price.node.color=(new cc.Color).fromHEX(e.common_color),this.txt_limit_time=this.main_container.getChildByName("txt_limit_time").getComponent(cc.Label),this.txt_limit_time.node.color=(new cc.Color).fromHEX(e.common_color),this.btn_buy=this.main_container.getChildByName("btn_buy"),this.btn_buy_bt=this.main_container.getChildByName("btn_buy").getComponent(cc.Button),this.txt_buy=this.btn_buy.getChildByName("txt_buy").getComponent(cc.Label),this.txt_buy.string=Utils.TI18N("\u7acb\u5373\u62a2\u8d2d"),this.txt_buy_line=this.btn_buy.getChildByName("txt_buy").getComponent(cc.LabelOutline);var n=e.send_data;if(n&&null!=Utils.next(n)){var o=n[0][0],r=n[0][1],c=Utils.createImage(this.main_container,null,229,616,cc.v2(0,.5),!1,1,!1);this.loadRes(s.getItemRes(o),function(t,e){t.spriteFrame=e}.bind(this,c)),c.node.scale=.4,this.send_num_nd=this.seekChild("send_val"),this.send_num_nd.active=!0,this.send_num=this.send_num_nd.getComponent("CusRichText"),this.send_num.setNum(r)}this.goods_list=this.main_container.getChildByName("goods_list");var _=this.goods_list.getContentSize();this.item_scroll_view=new l,this.item_scroll_view.createScroll(this.goods_list,cc.v2(-_.width/2,0),ScrollViewDir.horizontal,ScrollViewStartPos.top,_,{item_class:"backpack_item",start_x:10,space_x:25,start_y:8,space_y:0,item_width:108,item_height:108,row:1,col:0}),this.item_scroll_view.setClickEnabled(!1),this.holiday_bid==a.ActionRankCommonType.week_gift&&(this.txt_time_title.node.y=569,this.txt_time_val.node.y=569),this.ctrl.cs16603(this.holiday_bid),this.model.setGiftRedStatus({bid:a.ActionRankCommonType.high_value_gift,status:!1})},registerEvent:function(){this.addGlobalEvent(n.UPDATE_HOLIDAY_SIGNLE,function(t){t&&t.bid==this.holiday_bid&&this.setData(t)}.bind(this)),this.addGlobalEvent(n.Is_Charge_Event,function(t){if(t&&t.status&&t.charge_id){var e=Config.charge_data.data_charge_data[t.charge_id];e&&1==t.status&&t.charge_id==this.cur_charge_id&&SDK.pay(e.val,1,e.id,e.name,e.name)}}.bind(this)),Utils.onTouchEnd(this.btn_buy,function(){this.touch_btn&&null==this.get_item_ticket&&(this.get_item_ticket=gcore.Timer.set(function(){this.touch_btn=!0,null!=this.get_item_ticket&&(gcore.Timer.del(this.get_item_ticket),this.get_item_ticket=null)}.bind(this),2,1),this.touch_btn=null,this.data&&this.data.charge_id&&this.data.left_time>0&&(this.cur_charge_id=this.data.charge_id,this.ctrl.sender21016(this.data.charge_id)))}.bind(this),1)},setData:function(t){if(t){var e=t.remain_sec||0;this.model.setCountDownTime(this.txt_time_val,e),this.data=t.aim_list[0];var i,s,n=Utils.keyfind("aim_args_key",a.ActionExtType.RechageCurCount,this.data.aim_args),o=Utils.keyfind("aim_args_key",a.ActionExtType.RechageTotalCount,this.data.aim_args);s=n.aim_args_val||0,i=o.aim_args_val||0,this.txt_limit_time.string=Utils.TI18N(cc.js.formatStr("\u9650\u8d2d\uff1a%d/%d",s,i)),this.data.left_time=i-s;var l,r,c=Utils.keyfind("aim_args_key",a.ActionExtType.ActivityOldPrice,this.data.aim_args),_=Utils.keyfind("aim_args_key",a.ActionExtType.ActivityCurrentPrice,this.data.aim_args);l=c.aim_args_val||0,r=_.aim_args_val||0,this.txt_price.string=Utils.TI18N(cc.js.formatStr("\u539f\u4ef7\uff1a\uffe5%d",l)),this.txt_discount_price.string=Utils.TI18N(cc.js.formatStr("\uffe5%d",r));var h=Utils.keyfind("aim_args_key",a.ActionExtType.ItemRechargeId,this.data.aim_args);this.data.charge_id=h.aim_args_val||0,this.loadRewardList(this.data.item_list),0==this.data.left_time?(this.txt_buy.string=Utils.TI18N("\u5df2\u9886\u53d6"),this.txt_buy_line.color=new cc.Color(85,85,85,85),this.btn_buy_bt.interactable=!1,this.btn_buy_bt.enableAutoGrayEffect=!0):(this.btn_buy_bt.interactable=!0,this.btn_buy_bt.enableAutoGrayEffect=!1)}},loadRewardList:function(t){var e=[];if(t.length>0){for(var i in t){var s={};s&&(s.bid=t[i].bid,s.num=t[i].num,e.push(s))}var n=e.length,a=this.goods_list.getContentSize();n>5?(this.item_scroll_view.setClickEnabled(!0),this.item_scroll_view.root_wnd&&(this.item_scroll_view.root_wnd.x=-a.width/2)):(this.item_scroll_view.setClickEnabled(!1),this.item_scroll_view.root_wnd&&(this.item_scroll_view.root_wnd.x=-a.width/2+10*(5-n)+55*(4-n))),this.item_scroll_view.setData(e),this.item_scroll_view.addEndCallBack(function(){var t=this.item_scroll_view.getItemList();for(var e in t)t[e].setDefaultTip()}.bind(this))}},setVisibleStatus:function(t){t=t||!1,this.setVisible(t)},onShow:function(t){},onHide:function(){},onDelete:function(){this.item_scroll_view&&(this.item_scroll_view.deleteMe(),this.item_scroll_view=null),null!=this.get_item_ticket&&(gcore.Timer.del(this.get_item_ticket),this.get_item_ticket=null)}});cc._RF.pop()},{action_const:"action_const",action_controller:"action_controller",action_event:"action_event",common_scrollview:"common_scrollview",pathtool:"pathtool"}],action_limit_buy_item:[function(t,e,i){"use strict";cc._RF.push(e,"37f92t1dTRJi6+ivqolkPd8","action_limit_buy_item");var s=t("pathtool"),n=t("action_controller"),a=(t("action_const"),t("stronger_controller"),t("common_scrollview"));t("vip_controller"),t("hero_controller"),cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("action","action_limit_buy_item"),this.ctrl=n.getInstance()},initConfig:function(){},initPanel:function(){this.main_container=this.root_wnd.getChildByName("main_container"),this.title_label=this.main_container.getChildByName("title_label").getComponent(cc.Label),this.goods_con=this.main_container.getChildByName("goods_con"),this.has_bg=this.main_container.getChildByName("has_bg"),this.has_bg.active=!1,this.btn=this.main_container.getChildByName("btn"),this.btn_state=this.btn.getComponent(cc.Button),this.old_price=this.main_container.getChildByName("old_price"),this.price_line=this.old_price.getChildByName("price_line"),this.limit_rt=this.main_container.getChildByName("limit_label").getComponent(cc.RichText),this.num=this.btn.getChildByName("num").getComponent(cc.Label),this.line=this.btn.getChildByName("num").getComponent(cc.LabelOutline);var t=this.goods_con.getContentSize();this.item_scrollview=new a,this.item_scrollview.createScroll(this.goods_con,cc.v2(0,0),ScrollViewDir.horizontal,ScrollViewStartPos.top,t,{item_class:"backpack_item",start_x:3,space_x:15,start_y:11,space_y:4,item_width:84,item_height:84,row:1,col:0,scale:.7}),this.data&&this.setData(this.data)},registerEvent:function(){var t=this;this.btn.on("click",function(){if(Utils.playButtonSound(1),this.data)if(0==t.data.status&&1==t.touch_limit_buy){var e=Utils.keyfind("aim_args_key",27,t.data.aim_args)||{};SDK.pay(e.aim_args_val,1,t.data.aim,t.data.aim_str)}else 2==t.data.status&&message(Utils.TI18N("\u5df2\u7ecf\u8d2d\u4e70\u5b8c\u4e86"))},this)},onShow:function(t){},onHide:function(){},setData:function(t){if(t){this.data=t;var e=this;if(this.root_wnd){this.touch_limit_buy=!0,e.data=t;for(var i=[],s=0;s<t.item_list.length;++s){var n=t.item_list[s];n&&n.bid&&i.push(n)}e.item_scrollview.setData(i),e.item_scrollview.addEndCallBack(function(){e.item_scrollview.scroll_view_compend.enabled=!1;for(var t=e.item_scrollview.getItemList(),i=0;i<t.length;++i){t[i].setDefaultTip(!0,!1)}}.bind(this));var a=Utils.keyfind("aim_args_key",26,t.aim_args)||{},o=Utils.keyfind("aim_args_key",27,t.aim_args)||{},l="\u539f\u4ef7:\uffe5 "+a.aim_args_val;e.old_price.getComponent(cc.Label).string=l,e.price_line.active=!0;var r="\uffe5 "+o.aim_args_val;e.num.string=r,e.title_label.string=t.aim_str;var c=e.getValByKey(t.aim_args,7)||0,_=e.getValByKey(t.aim_args,2)||0,h=e.getValByKey(t.aim_args,6)||0,d="";1==c?_>=0&&0!=_&&h>=0&&(d="\u6bcf\u5468\u9650\u8d2d"+_+"\u4e2a:  (<color=#249003>"+h+"</color>/"+_+")"):2==c&&_>=0&&0!=_&&h>=0&&(d="\u603b\u9650\u8d2d"+_+"\u4e2a:  (<color=#249003>"+h+"</color>/"+_+")"),e.limit_rt.string=d,2==t.sort_index?(e.btn_state.interactable=!1,e.btn_state.enableAutoGrayEffect=!0,e.line.enabled=!1):(e.btn_state.interactable=!0,e.btn_state.enableAutoGrayEffect=!1,e.line.enabled=!0)}}},getValByKey:function(t,e){if(!t)return 0;for(var i=0,s=0;s<t.length;++s){var n=t[s];n.aim_args_key==e&&(i=n.aim_args_val)}return i},onDelete:function(){this.item_scrollview&&(this.item_scrollview.deleteMe(),this.item_scrollview=null)}});cc._RF.pop()},{action_const:"action_const",action_controller:"action_controller",common_scrollview:"common_scrollview",hero_controller:"hero_controller",pathtool:"pathtool",stronger_controller:"stronger_controller",vip_controller:"vip_controller"}],action_limit_buy_panel:[function(t,e,i){"use strict";cc._RF.push(e,"7483dmQ1N1IZYdTcawO5+Iz","action_limit_buy_panel");var s=t("pathtool"),n=t("action_controller"),a=t("action_event"),o=t("timetool"),l=t("common_scrollview"),r=t("action_limit_buy_item");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("action","action_limit_buy_panel"),this.ctrl=n.getInstance(),this.holiday_bid=arguments[0]},initConfig:function(){},initPanel:function(){var t=this,e=this.getPositionX();if(t.setPosition(e,-50),t.main_container=t.root_wnd.getChildByName("main_container"),t.title_con=t.main_container.getChildByName("title_con"),t.time_val=t.title_con.getChildByName("time_val").getComponent(cc.Label),t.time_title=t.title_con.getChildByName("time_title"),t.charge_con=t.main_container.getChildByName("charge_con"),t.title_img=t.title_con.getChildByName("title_img"),null!=t.holiday_bid||0!=t.holiday_bid&&null!=t.action_type||0!=t.action_type){var i=t.ctrl.getActionSubTabVo(t.holiday_bid);if(i){""==i.aim_title&&(i.aim_title="txt_cn_action_limit_title");var n=s.getUIIconPath("bigbg/action",i.aim_title);this.loadRes(n,function(e){t.title_img.getComponent(cc.Sprite).spriteFrame=e}.bind(this))}}var a=t.charge_con.getContentSize(),o={item_class:r,start_x:10,space_x:0,start_y:0,space_y:0,item_width:679,item_height:164,row:0,col:1};t.item_scrollview=new l,t.item_scrollview.createScroll(t.charge_con,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,a,o)},registerEvent:function(){this.addGlobalEvent(a.UPDATE_HOLIDAY_SIGNLE,function(t){t.bid==this.holiday_bid&&this.createList(t)}.bind(this)),this.ctrl.cs16603(this.holiday_bid)},onShow:function(t){},onHide:function(){},createList:function(t){if(t){var e=[];this.everyday_data=null;for(var i=0;i<t.aim_list.length;++i){var s=t.aim_list[i];99==s.aim?this.everyday_data=s:(s.sort_index=1,1==s.status?s.sort_index=0:2==s.status&&(s.sort_index=2),e.push(s))}var n=Utils.tableLowerSorter(["sort_index","aim"]);e.sort(n),this.item_scrollview.setData(e),this.setLessTime(t.remain_sec)}},setLessTime:function(t){this.time_val&&((t=t||0)>0?(this.setTimeFormatString(t),null==this.time_tichet&&(this.time_tichet=gcore.Timer.set(function(){--t<0?(gcore.Timer.del(this.time_tichet),this.time_tichet=null):this.setTimeFormatString(t)}.bind(this),1e3,-1))):this.setTimeFormatString(t))},setTimeFormatString:function(t){this.rest_time=t,this.time_val.string=t>0?o.getTimeFormatDayIIIIII(t):"00:00:00"},onDelete:function(){this.time_tichet&&(gcore.Timer.del(this.time_tichet),this.time_tichet=null),this.item_scrollview&&(this.item_scrollview.deleteMe(),this.item_scrollview=null)}});cc._RF.pop()},{action_controller:"action_controller",action_event:"action_event",action_limit_buy_item:"action_limit_buy_item",common_scrollview:"common_scrollview",pathtool:"pathtool",timetool:"timetool"}],action_limit_change_panel:[function(t,e,i){"use strict";var s,n;function a(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}cc._RF.push(e,"2c262hkZLNJCrnRv7647SpK","action_limit_change_panel");var o=t("pathtool"),l=t("action_controller"),r=t("action_const"),c=t("action_event"),_=t("role_controller"),h=t("timetool"),d=t("mall_controller"),u=t("role_event");a(s={},1,[231,212,153,255]),a(s,2,[220,252,255,255]),a(s,3,[246,228,173,255]),a(s,4,[255,207,144,255]),a(s,5,[100,50,35,255]),a(n={},1,[181,170,212,255]),a(n,2,[175,248,255,255]),a(n,3,[255,255,255,255]),a(n,4,[255,207,144,255]),a(n,5,[100,50,35,255]),cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=o.getPrefabPath("action","action_limit_change_panel"),this.ctrl=l.getInstance(),this.role_vo=_.getInstance().getRoleVo(),this.action_item_id=80101,this.rewardList=null,this.holiday_bid=arguments[0]},initConfig:function(){},initPanel:function(){var t=this,e=this.getPositionX();this.setPosition(e,-20),this.viewContent=this.seekChild("content"),t.main_container=t.root_wnd.getChildByName("main_container"),t.title_img=t.main_container.getChildByName("title_img");var i=Config.function_data.data_limit_change_const[this.holiday_bid],s="txt_cn_action_limit_change_panel";i&&(s=i.bg_name);var n=o.getUIIconPath("bigbg/action",s);this.loadRes(n,function(e){t.title_img.getComponent("cc.Sprite").spriteFrame=e}.bind(this)),t.dec_title=t.main_container.getChildByName("dec_title"),t.item_scrollview=t.main_container.getChildByName("item_scrollview"),this.dec_val=t.main_container.getChildByName("dec_val");var a=t.main_container.getChildByName("item_dec_label"),l="ffcf90";i&&(l=i.title_color);var r=(new cc.Color).fromHEX(l);t.dec_val.color=r,t.dec_title.color=r;var c,_="ffcf90";i&&(_=i.has_prop_color),a.color=(new cc.Color).fromHEX(_),t.item_icon=t.main_container.getChildByName("item_icon"),t.item_count=t.main_container.getChildByName("item_count"),i&&(c=i.time_color1),t.time_val_rt=t.main_container.getChildByName("time_val").getComponent(cc.RichText),t.time_val_rt.node.color=(new cc.Color).fromHEX(c),t.comfirm_btn=t.main_container.getChildByName("comfirm_btn")},registerEvent:function(){this.addGlobalEvent(c.UPDATE_HOLIDAY_SIGNLE,function(t){t&&t.bid==this.holiday_bid&&(this.setData(t),this.setLessTime(t.remain_sec-172800))}.bind(this)),this.comfirm_btn.on("click",this.onComfirmBtn,this),!this.role_lev_event&&this.role_vo&&(this.role_lev_event=this.role_vo.bind(u.UPDATE_ROLE_ACTION_ASSETS,function(t,e){if(t&&t==this.action_item_id&&this.role_vo){var i=this.role_vo.getActionAssetsNumByBid(this.action_item_id);this.item_count.getComponent(cc.Label).string=i}}.bind(this))),this.ctrl.cs16603(this.holiday_bid)},onComfirmBtn:function(){Utils.playButtonSound(1),d.getInstance().openMallActionWindow(!0,this.holiday_bid)},onShow:function(t){},onHide:function(){},setVisibleStatus:function(t){t=t||!1,this.setVisible(t)},setLessTime:function(t){this.time_val_rt&&(t>0?(this.setTimeFormatString(t),null==this.time_tichet&&(this.time_tichet=gcore.Timer.set(function(){t--,this.setTimeFormatString(t),t<0&&(gcore.Timer.del(this.time_tichet),this.time_tichet=null,this.setTimeFormatString(t))}.bind(this),1e3,-1))):this.setTimeFormatString(t))},setTimeFormatString:function(t){if(t>0){var e="\u7ed3\u675f\u65f6\u95f4\uff1a<color=#00ff0c>"+h.getTimeFormatDayIIIIII(t)+"</color>";this.holiday_bid!=r.ActionChangeCommonType.limit_yuanzhen&&this.holiday_bid!=r.ActionChangeCommonType.limit_yuanzhen1||(e="\u7ed3\u675f\u65f6\u95f4\uff1a<color=#249003>"+h.getTimeFormatDayIIIIII(t)+"</color>"),this.time_val_rt.string=e}else{var i="\u7ed3\u675f\u65f6\u95f4\uff1a<color=#00ff0c>\u6d3b\u52a8\u5df2\u7ed3\u675f</color>";this.holiday_bid!=r.ActionChangeCommonType.limit_yuanzhen&&this.holiday_bid!=r.ActionChangeCommonType.limit_yuanzhen1||(i="\u7ed3\u675f\u65f6\u95f4\uff1a<color=#249003>\u6d3b\u52a8\u5df2\u7ed3\u675f</color>"),this.time_val_rt.string=i}},setData:function(t){var e,i=this,s=t.client_reward;s=(s=s.replace("\uff08","(")).replace("\uff09",")"),i.dec_val.getComponent(cc.Label).string=s;var n=Utils.keyfind("aim_args_key",4,t.aim_list[0].aim_args)||null;if(n&&(e=n.aim_args_val),e){i.action_item_id=e;var a=Utils.getItemConfig(e);if(a&&i.item_icon){var l=o.getItemRes(a.icon);i.item_icon.setScale(.4),this.loadRes(l,function(t){i.item_icon.getComponent(cc.Sprite).spriteFrame=t}.bind(this))}var r=i.role_vo.getActionAssetsNumByBid(e);i.item_count.getComponent(cc.Label).string=r}if(!i.rewardList){i.rewardList=[];for(var c=0;c<t.item_effect_list.length;++c){var _=t.item_effect_list[c],h=new cc.Node;h.width=108,h.height=108;var d=ItemsPool.getInstance().getItem("backpack_item");if(d.setDefaultTip(),d.setParent(h),d.initConfig(!1,.9,!1,!0),d.show(),d.setData({bid:_.bid,num:1}),_.effect_1>0){var u=Utils.getItemConfig(_.bid);u&&u.quality>=4?d.showItemEffect(!0,263,PlayerAction.action_1,!0,1.1):d.showItemEffect(!0,263,PlayerAction.action_2,!0,1.1)}this.rewardList.push(d),this.viewContent.addChild(h)}}},onDelete:function(){if(this.action_item_id=null,this.rewardList=null,this.holiday_bid=null,this.time_tichet&&(gcore.Timer.del(this.time_tichet),this.time_tichet=null),this.rewardList)for(var t=0;t<this.rewardList.length;++t)this.rewardList[t].deleteMe&&this.rewardList[t].deleteMe();this.role_lev_event&&(this.role_vo.unbind(this.role_lev_event),this.role_lev_event=null)}});cc._RF.pop()},{action_const:"action_const",action_controller:"action_controller",action_event:"action_event",mall_controller:"mall_controller",pathtool:"pathtool",role_controller:"role_controller",role_event:"role_event",timetool:"timetool"}],action_limit_common_item:[function(t,e,i){"use strict";cc._RF.push(e,"e65ef2LNbxCWIi0KVVHhhhm","action_limit_common_item");var s=t("pathtool"),n=t("action_controller"),a=t("task_const"),o=t("timetool"),l=t("action_const");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("action","action_limit_yuanzhen_item"),this.ctrl=n.getInstance()},initConfig:function(){this.action_yuanzhen_id=13005},initPanel:function(){var t=this.root_wnd.getChildByName("main_container");this.btn_goto=t.getChildByName("btn_goto"),this.btn_goto.getChildByName("Text_6").getComponent(cc.Label).string=Utils.TI18N("\u524d\u5f80"),this.btn_goto.active=!1,this.btn_get=t.getChildByName("btn_get"),this.btn_get.getChildByName("Text_5").getComponent(cc.Label).string=Utils.TI18N("\u9886\u53d6"),this.btn_get.active=!1,this.btn_has=t.getChildByName("btn_has"),this.btn_has.active=!1,this.goods_con=t.getChildByName("good_cons"),this.Image_1=t.getChildByName("Image_1"),this.line=t.getChildByName("line"),this.action_id==this.action_yuanzhen_id||(this.btn_goto.y=0,this.btn_get.y=0,this.btn_has.y=0,this.Image_1.active=!1,this.title_desc=Utils.createLabel(28,new cc.Color(100,50,35,255),null,-196,24,null,null,null,cc.v2(0,.5)),t.addChild(this.title_desc.node),this.little_desc=Utils.createRichLabel(22,new cc.Color(149,83,34,255),cc.v2(0,1),cc.v2(-196,-4),null,320),this.little_desc.horizontalAlign=cc.macro.TextAlignment.LEFT,t.addChild(this.little_desc.node),this.time_desc=Utils.createLabel(22,new cc.Color(147,83,34,255),null,254,-52,null,null,null,cc.v2(.5,.5)),t.addChild(this.time_desc.node),this.item=ItemsPool.getInstance().getItem("backpack_item"),this.item.initConfig(!1,.9,!1,!0),this.item.setPosition(-264,0),this.item.setParent(t),this.item.show()),this.data&&this.setData(this.data)},registerEvent:function(){this.btn_get.on("click",function(){Utils.playButtonSound(1),this.data&&(this.holiday_bid==l.ActionRankCommonType.yuanzhen_adventure?this.ctrl.sender24812(this.data.config.id):this.holiday_bid==l.ActionRankCommonType.exercise_1?this.ctrl.sender24814(this.data.config.id):this.holiday_bid==l.ActionRankCommonType.exercise_2?this.ctrl.sender24816(this.data.config.id):this.holiday_bid==l.ActionRankCommonType.exercise_3&&this.ctrl.sender24818(this.data.config.id))},this),this.btn_goto.on("click",this.onGotoBtn,this)},onGotoBtn:function(){if(this.data&&this.data.config)if(130051==this.data.config.source_id){var e=this.ctrl.getActionSubTabVo(l.AnimateActionCommonType.YuanZhen_Kitchen);e&&this.ctrl.action_operate&&this.ctrl.action_operate.tab_list[e.bid]?this.ctrl.action_operate.handleSelectedTab(this.ctrl.action_operate.tab_list[e.bid]):message(Utils.TI18N("\u8be5\u6d3b\u52a8\u5df2\u7ed3\u675f"))}else if(250131==this.data.config.source_id);else if(250132==this.data.config.source_id||250133==this.data.config.source_id||250134==this.data.config.source_id){var i=l.ActionRankCommonType.time_summon;250133==this.data.config.source_id||250134==this.data.config.source_id&&(i=l.ActionRankCommonType.limit_exercise);var s=this.ctrl.getActionSubTabVo(i);s&&this.ctrl.action_operate&&this.ctrl.action_operate.tab_list[s.bid]?this.ctrl.action_operate.handleSelectedTab(this.ctrl.action_operate.tab_list[s.bid]):message(Utils.TI18N("\u8be5\u6d3b\u52a8\u5df2\u7ed3\u675f"))}else{var n=Config.source_data.data_source_data[this.data.config.source_id];if(n)t("backpack_controller").getInstance().gotoItemSources(n.evt_type,n.extend);else t("stronger_controller").getInstance().clickCallBack(this.data.config.source_id)}},setData:function(t){if(this.data=t,this.root_wnd){if(this.holiday_bid=t.holiday_bid,this.btn_goto.active=t.status==a.task_status.un_finish,this.btn_get.active=t.status==a.task_status.finish,this.btn_has.active=t.status==a.task_status.completed,this.time_desc&&(this.time_desc.node.active=t.status!=a.task_status.completed),this.action_id==this.action_yuanzhen_id);else{this.title_desc.string=t.title;var e=t.desc+t.goal;t.status==a.task_status.finish?this.little_desc.string=cc.js.formatStr(StringUtil.parseStr("<div fontColor=#249003>%s</div>").string,e):this.little_desc.string=e,this.item&&null!=t.item_list&&null!=Utils.next(t.item_list)&&this.item.setData({bid:t.item_list[0][0],num:t.item_list[0][1]})}if(this.time_desc.node.active){var i=t.end_time-gcore.SmartSocket.getTime();i<0&&(i=0),this.time_desc.string=cc.js.formatStr("%s%s",Utils.TI18N("\u5269\u4f59"),o.getDayOrHour(i))}}},onShow:function(t){},onHide:function(){},onDelete:function(){this.item&&(this.item.deleteMe(),this.item=null)}});cc._RF.pop()},{action_const:"action_const",action_controller:"action_controller",backpack_controller:"backpack_controller",pathtool:"pathtool",stronger_controller:"stronger_controller",task_const:"task_const",timetool:"timetool"}],action_limit_gift_main_panel:[function(t,e,i){"use strict";cc._RF.push(e,"4ed04BQijlLZabeYNzOWJEK","action_limit_gift_main_panel");var s=t("pathtool"),n=t("timetool");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("action","action_limit_gift_main_panel"),this.data=arguments[0]},initConfig:function(){},initPanel:function(){var t=this;t.main_container=t.root_wnd.getChildByName("main_container");var e=this.getPositionX();if(this.setPosition(e,-20),t.title_img=t.main_container.getChildByName("title_img"),t.is_level_gift=!1,t.data&&t.data.config){var i=t.data.config.res_1||"txt_cn_action_limit_gift_level",n=s.getUIIconPath("bigbg/limit_gift",i);if(this.loadRes(n,function(e){t.title_img.getComponent(cc.Sprite).spriteFrame=e}.bind(this)),t.data.config.codition&&null!=t.data.config.codition[0]&&(t.level_img=t.main_container.getChildByName("level_img"),"lev"==t.data.config.codition[0])){var a;t.is_level_gift=!0,a=null==t.data.config.res_2||""==t.data.config.res_2?"action_limit_gift_level_18":t.data.config.res_2;var o=s.getUIIconPath("bigbg/limit_gift",a);this.loadRes(o,function(e){t.level_img.getComponent(cc.Sprite).spriteFrame=e}.bind(this))}}t.item_scrollview=t.main_container.getChildByName("item_scrollview"),t.content=t.item_scrollview.getChildByName("content"),t.comfirm_btn=t.main_container.getChildByName("comfirm_btn"),t.comfirm_label=t.comfirm_btn.getChildByName("label"),t.time_val=t.main_container.getChildByName("time_val").getComponent(cc.Label);var l=t.data.end_time;t.setLessTime(l),t.value=t.main_container.getChildByName("value"),t.is_level_gift&&(t.time_val.node.y=-51,t.item_scrollview.width=240,t.item_scrollview.y=-97,t.content.y=-t.item_scrollview.width/2),t.setData(this.data)},registerEvent:function(){this.comfirm_btn.on("click",function(){Utils.playButtonSound(1),this.onComfirmBtn()},this)},onComfirmBtn:function(){if(this.data&&this.data.config){var t=this.data.config.package_id||0,e=Config.charge_data.data_charge_data[t];e&&SDK.pay(e.val,null,e.id,e.name,e.name)}},onShow:function(t){},onHide:function(){},setData:function(t){var e=this,i=this;if(t&&t.config){this.data=t;var s=i.data.num||0;if(i.value.getComponent(cc.Label).string="\u5269\u4f59: "+s,!i.item_list){var n=Config.charge_data.data_charge_data[i.data.config.package_id];if(n){var a=n.val+"\u5143";i.comfirm_label.getComponent(cc.Label).string=a}var o=i.data.config.reward||[];i.item_list={};for(var l=function(t){Utils.delayRun(i.content,t/30,function(){var e=new cc.Node;if(e.setContentSize(108,108),i.content.addChild(e),!i.item_list[t]){var s=o[t][0],n=o[t][1],a=ItemsPool.getInstance().getItem("backpack_item");a.setDefaultTip(!0,!1),a.setParent(e),a.initConfig(!1,.9,!1,!0),a.show(),i.item_list[t]=a,a.setData({bid:s,num:n})}}.bind(e))},r=0;r<o.length;++r)l(r)}}},setLessTime:function(t){this.time_val&&((t=t||0)>0?(this.setTimeFormatString(t),null==this.time_tichet&&(this.time_tichet=gcore.Timer.set(function(){t--,this.setTimeFormatString(t),t<0&&(gcore.Timer.del(this.time_tichet),this.time_tichet=null,this.setTimeFormatString(t))}.bind(this),1e3,-1))):this.setTimeFormatString(t))},setTimeFormatString:function(t){if(t>0){var e="\u5269\u4f59\u65f6\u95f4: "+n.getTimeFormatDayIIIIII(t);this.time_val.string=e}else this.time_val.string=""},onDelete:function(){if(this.time_tichet&&(gcore.Timer.del(this.time_tichet),this.time_tichet=null),this.item_list)for(var t in this.item_list)this.item_list[t].deleteMe()}});cc._RF.pop()},{pathtool:"pathtool",timetool:"timetool"}],action_limit_gift_main_window:[function(t,e,i){"use strict";cc._RF.push(e,"cae2eCCJTVGcqeqwe/Y5VPB","action_limit_gift_main_window");var s=t("pathtool"),n=t("action_controller"),a=t("action_event"),o=t("action_limit_gift_main_panel");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("welfare","welfare_main_view"),this.win_type=WinType.Full,this.ctrl=n.getInstance();var e=t("newfirstcharge_controller");e.getInstance().getNewFirstChargeView()&&e.getInstance().getNewFirstChargeView().setVisible(!1)},initConfig:function(){this.tab_width=78,this.off_space=50,this.tab_list={},this.panel_list={},this.selected_tab=null},openCallBack:function(){this.background=this.root_wnd.getChildByName("background"),this.background.scale=this.background.scale*FIT_SCALE,null!=this.background&&this.loadRes(s.getBigBg("welfare/welfare_bg","jpg"),function(t){this.background.getComponent(cc.Sprite).spriteFrame=t}.bind(this)),this.main_container_nd=this.root_wnd.getChildByName("main_container"),this.close_btn_nd=this.seekChild(this.main_container_nd,"close_btn"),this.container_nd=this.seekChild(this.main_container_nd,"container");var t=this.main_container_nd.getChildByName("main_panel");this.container=t.getChildByName("container"),this.tab_container_nd=this.seekChild(this.main_container_nd,"tab_container"),this.tab_scroll_nd=this.seekChild(this.tab_container_nd,"tab_scroll"),this.tab_scroll_content_nd=this.seekChild(this.tab_scroll_nd,"content"),this.tab_scroll_sv=this.seekChild(this.tab_container_nd,"tab_scroll",cc.ScrollView),this.tab_sprite_bg=t.getChildByName("tab_sprite_bg"),this.loadRes(s.getUIIconPath("bigbg/welfare","welfare_bg_1"),function(t){this.tab_sprite_bg.getComponent(cc.Sprite).spriteFrame=t}.bind(this))},registerEvent:function(){this.close_btn_nd.on("click",function(){Utils.playButtonSound(2),this.ctrl.openActionLimitGiftMainWindow(!1)},this),this.addGlobalEvent(a.LIMIT_GIFT_MAIN_EVENT,function(t){this.initData(t)}.bind(this))},openRootWnd:function(t){this.record_id=t,this.ctrl.send21210()},initData:function(t){if(t){if(0!=t.gifts.length){this.sub_list=[];for(var e=0;e<t.gifts.length;++e){var i=t.gifts[e],s=Config.star_gift_data.data_limit_gift[i.id];s&&(i.ico=s.ico,i.config=s,i.title=s.name,this.sub_list.push(i))}this.sub_list.sort(function(t,e){return t.id-e.id}),this.createSubType()}else this.ctrl.openActionLimitGiftMainWindow(!1)}},createSubType:function(){if(null!=this.sub_list&&null!=Utils.next(this.sub_list)){var e=this.sub_list.length,i=e*(this.tab_width+this.off_space)+110;this.max_width=Math.max(this.tab_scroll_nd.width,i),this.tab_scroll_content_nd.width=this.max_width,this.tab_scroll_sv.scrollToLeft(0);var s=function(t){this.handleSelectedTab(t)}.bind(this);for(var n in this.tab_list){for(var a=this.tab_list[n].getData(),o=!0,l=0;l<this.sub_list.length;++l){var r=this.sub_list[l];if(a.id==r.id){o=!1;break}}o&&(this.tab_list[n].deleteMe(),this.tab_list[n]=null,delete this.tab_list[n],this.panel_list[a.id].deleteMe(),this.panel_list[a.id]=null,delete this.panel_list[a.id],this.selected_tab=this.tab_list[this.sub_list[0].id],null!=this.selected_tab&&this.selected_tab.setSelected(!0))}for(var c=null,_=null,h=null,d=0,u=0;u<e;u++){if(h=this.sub_list[u],null==(c=this.tab_list[h.id]))(c=new(t("welfare_tab_panel"))).show(),c.setData(h),c.setClickCallBack(s),c.setParent(this.tab_scroll_content_nd),this.tab_list[h.id]=c,c.updateTipsStatus(!1);else c.setData(h);_=u*(this.tab_width+this.off_space)+110,c.setPosition(_,-68),null!=this.record_id&&this.record_id==h.id&&(d=u)}null!=(h=this.sub_list[d])&&null==this.selected_tab?this.handleSelectedTab(this.tab_list[h.id]):this.changePanelByTab()}},handleSelectedTab:function(t){null!=this.selected_tab&&this.selected_tab==t||(null!=this.selected_tab&&this.selected_tab.setSelected(!1),this.selected_tab=t,null!=this.selected_tab&&this.selected_tab.setSelected(!0),this.changePanelByTab())},changePanelByTab:function(){if(null!=this.selected_tab&&null!=this.selected_tab.data){var t=this.selected_tab.data;null!=t.id&&0!=t.id&&(null!=this.selected_panel&&(this.selected_panel.setVisibleStatus?this.selected_panel.setVisibleStatus(!1):this.selected_panel.setVisible(!1),this.selected_panel=null),null==this.panel_list[t.id]?(this.panel_list[t.id]=new o(t),this.panel_list[t.id].show(),this.panel_list[t.id].setParent(this.container_nd)):this.panel_list[t.id].setData(t),this.selected_panel=this.panel_list[t.id],null!=this.selected_panel&&(this.selected_panel.setVisibleStatus?this.selected_panel.setVisibleStatus(!0):this.selected_panel.setVisible(!0)))}},closeCallBack:function(){if(this.tab_list)for(var e in this.tab_list)this.tab_list[e]&&(this.tab_list[e].deleteMe(),this.tab_list[e]=null);if(this.tab_list=null,this.panel_list){for(var i in this.panel_list)this.panel_list[i]&&(this.panel_list[i].deleteMe(),this.panel_list[i]=null);this.panel_list=null}this.selected_tab=null;var s=t("newfirstcharge_controller");s.getInstance().getNewFirstChargeView()&&s.getInstance().getNewFirstChargeView().setVisible(!0),this.ctrl.openActionLimitGiftMainWindow(!1)}});cc._RF.pop()},{action_controller:"action_controller",action_event:"action_event",action_limit_gift_main_panel:"action_limit_gift_main_panel",newfirstcharge_controller:"newfirstcharge_controller",pathtool:"pathtool",welfare_tab_panel:"welfare_tab_panel"}],action_limit_yuanzhen_panel:[function(t,e,i){"use strict";cc._RF.push(e,"a6ba046mTRAcbyWUgQMxQCf","action_limit_yuanzhen_panel");var s=t("pathtool"),n=t("action_controller"),a=t("timetool"),o=t("action_const"),l=t("action_event"),r=t("common_scrollview"),c=t("action_limit_common_item"),_=t("task_const");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("action","action_limit_yuanzhen_panel"),this.holiday_bid=arguments[0],this.ctrl=n.getInstance()},initConfig:function(){this.dic_task_list={},this.dic_limit_list={},this.limit_list=[],this.action_yuanzhen_id=13005,this.action_summer_id=25013,this.action_wolf_id=26002},initPanel:function(){var t=this.getPositionX();this.setPosition(t,-10),this.main_container=this.root_wnd.getChildByName("main_container"),this.main_container_size=this.main_container.getContentSize();var e=this.main_container.getChildByName("title_con");this.title_desc_lb=e.getChildByName("title_desc").getComponent(cc.Label),this.title_desc_lb.node.active=!1,e.getChildByName("time_title").getComponent(cc.Label).string=Utils.TI18N("\u5269\u4f59\u65f6\u95f4:"),this.time_val=e.getChildByName("time_val").getComponent(cc.Label),this.goods_con=this.main_container.getChildByName("goods_con");var i=e.getChildByName("title_img").getComponent(cc.Sprite),n="txt_cn_welfare_banner17";this.activity_id=0;var a=Utils.deepCopy(this.ctrl.getActionSubTabVo(this.holiday_bid));a&&(null!=a.reward_title&&""!=a.reward_title&&(n=a.reward_title),this.activity_id=a.camp_id);var l=s.getWelfareBannerRes(n);this.loadRes(l,function(t){i.spriteFrame=t});var _=0;a&&(_=a.remain_sec||0),_<0&&(_=0),this.setLessTime(_),this.common_btn=e.getChildByName("common_btn"),this.holiday_bid==o.ActionRankCommonType.action_wolf||this.holiday_bid==o.ActionRankCommonType.exercise_1||this.holiday_bid==o.ActionRankCommonType.exercise_2||this.holiday_bid==o.ActionRankCommonType.exercise_3?this.common_btn.active=!1:this.common_btn.active=!0,this.holiday_bid==o.ActionRankCommonType.yuanzhen_adventure?this.ctrl.sender24810():this.holiday_bid==o.ActionRankCommonType.exercise_1?this.ctrl.sender24813():this.holiday_bid==o.ActionRankCommonType.exercise_2?this.ctrl.sender24815():this.holiday_bid==o.ActionRankCommonType.exercise_3?this.ctrl.sender24817():this.ctrl.cs16603(this.holiday_bid);var h=this.goods_con.getContentSize(),d={item_class:c,start_x:0,space_x:0,start_y:0,space_y:0,item_width:688,item_height:152,row:1,col:1,once_num:1};this.item_scrollview=new r,this.item_scrollview.createScroll(this.goods_con,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,h,d,cc.v2(0,0))},registerEvent:function(){this.common_btn.on("click",this.onCommonBtn,this),this.addGlobalEvent(l.YUAN_ZHEN_DATA_EVENT,function(t){if(t&&t.camp_id==this.activity_id){var e=Utils.tableLowerSorter(["id"]);t.quest_list.sort(e),this.action_id=t.camp_id,this.initUI(),this.initYuanZhenData(t.quest_list,!0)}}.bind(this)),this.addGlobalEvent(l.YUAN_ZHEN_UPDATA_EVENT,function(t){t&&this.initYuanZhenData([t])}.bind(this)),this.addGlobalEvent(l.YUAN_ZHEN_TASK_EVENT,function(t){if(t&&this.action_id){var e=Utils.getNorKey(this.action_id,t.id),i=Config.holiday_lanterm_adventure_data.data_lanterm_adventure[e];if(i&&this.dic_limit_list[i.f_id]){this.dic_limit_list[i.f_id].status=_.task_status.completed,this.dic_limit_list[i.f_id].sort=_.task_status.completed;var s=Config.holiday_lanterm_adventure_data.data_lanterm_adventure_task_list[this.action_id][i.f_id];if(s[i.s_id+1]){var n=Utils.getNorKey(this.action_id,s[i.s_id+1].id),a=Config.holiday_lanterm_adventure_data.data_lanterm_adventure[n];a&&this.dic_task_list[a.id]?this.initYuanZhenData([this.dic_task_list[a.id]]):this.sortYuanZhenInfo()}else this.sortYuanZhenInfo()}}}.bind(this))},onCommonBtn:function(){this.holiday_bid==l.ActionRankCommonType.yuanzhen_adventure&&(Utils.playButtonSound(1),t("mall_controller").getInstance().openMallActionWindow(!0,this.holiday_bid))},onShow:function(t){},onHide:function(){},setLessTime:function(t){this.time_val&&((t=t||0)>0?(this.setTimeFormatString(t),null==this.time_tichet&&(this.time_tichet=gcore.Timer.set(function(){t--,this.setTimeFormatString(t),t<=0&&(gcore.Timer.del(this.time_tichet),this.time_tichet=null)}.bind(this),1e3,-1))):this.setTimeFormatString(t))},setTimeFormatString:function(t){if(t>0){var e=a.getTimeFormatDayIIIIIIII(t);this.time_val.string=e}else this.time_val.string="00:00:00"},initUI:function(){if(this.action_id==this.action_yuanzhen_id){var t=this.common_btn.getChildByName("icon").getComponent(cc.Sprite);if(t){var e=s.getIconPath("welfare/action_icon","welfare_icon_99");this.loadRes(e,function(e){t.spriteFrame=e}.bind(this))}this.common_btn.getChildByName("label").getComponent(cc.Label).string=Utils.TI18N("\u82b1\u706f\u96c6\u5e02"),this.title_desc_lb.node.active=!1,this.title_desc_lb.string=Utils.TI18N("\u6d3b\u52a8\u671f\u95f4\u5b8c\u6210\u4efb\u52a1\u83b7\u53d6\u5143\u5bb5\u82b1\u706f\u7b49\u9650\u65f6\u5956\u52b1")}else this.action_id==this.action_summer_id&&(this.common_btn.active=!1)},initYuanZhenData:function(t){if(this.action_id&&t){for(var e=0;e<t.length;++e){var i=t[e];this.dic_task_list[i.id]=i;var s=Utils.getNorKey(this.action_id,i.id),n=Config.holiday_lanterm_adventure_data.data_lanterm_adventure[s];if(n&&i.finish!=_.task_status.over){var a=this.dic_limit_list[n.f_id];null==a&&((a={}).holiday_bid=this.holiday_bid,this.dic_limit_list[n.f_id]=a,this.limit_list.push(a));var o=!0;if(a.config&&(n.s_id>a.config.s_id?a.status!=_.task_status.completed&&(o=!1):n.s_id<a.config.s_id&&i.finish==_.task_status.completed&&(o=!1)),o){a.config=n,a.f_id=n.f_id,i.finish==_.task_status.finish?a.sort=0:i.finish==_.task_status.un_finish?a.sort=1:a.sort=i.finish,a.status=i.finish,a.title=n.title,a.desc=n.desc;var l=void 0,r=void 0;i.progress[0]&&(l=i.progress[0].target_val,r=i.progress[0].value),a.goal=cc.js.formatStr("(%s/%s)",r,l),a.end_time=i.end_time,a.item_list=n.award}}}this.sortYuanZhenInfo()}},sortYuanZhenInfo:function(){var t=Utils.tableLowerSorter(["sort","f_id"]);this.limit_list.sort(t),this.item_scrollview.getItemList().length?this.item_scrollview.resetAddPosition(this.limit_list):this.item_scrollview.setData(this.limit_list)},onDelete:function(){this.time_tichet&&(gcore.Timer.del(this.time_tichet),this.time_tichet=null),this.item_scrollview&&(this.item_scrollview.deleteMe(),this.item_scrollview=null)}});cc._RF.pop()},{action_const:"action_const",action_controller:"action_controller",action_event:"action_event",action_limit_common_item:"action_limit_common_item",common_scrollview:"common_scrollview",mall_controller:"mall_controller",pathtool:"pathtool",task_const:"task_const",timetool:"timetool"}],action_main_window:[function(t,e,i){"use strict";cc._RF.push(e,"d08cbyACEhKK734Odnrhx6G","action_main_window");var s=t("action_const"),n=t("pathtool"),a=t("action_controller"),o=t("action_event"),l=t("mainui_const");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=n.getPrefabPath("welfare","welfare_main_view"),this.win_type=WinType.Full,this.ctrl=a.getInstance(),this.model=this.ctrl.getModel()},initConfig:function(){this.sub_list=[],this.tab_list={},this.panel_list={},this.tab_width=78,this.off_space=50,this.selected_tab=null},openCallBack:function(){this.background=this.seekChild("background"),this.background.scale=this.background.scale*FIT_SCALE,this.main_container_nd=this.seekChild("main_container"),this.main_panel_nd=this.seekChild(this.main_container_nd,"main_panel"),this.container_nd=this.seekChild(this.main_panel_nd,"container"),this.close_btn_nd=this.seekChild(this.main_container_nd,"close_btn"),this.tab_container_nd=this.seekChild(this.main_container_nd,"tab_container"),this.tab_scroll_nd=this.seekChild(this.tab_container_nd,"tab_scroll"),this.tab_scroll_sv=this.seekChild(this.tab_container_nd,"tab_scroll",cc.ScrollView),this.tab_scroll_content_nd=this.seekChild(this.tab_scroll_nd,"content"),this.loadRes(n.getBigBg("welfare/welfare_bg","jpg"),function(t){this.background.getComponent(cc.Sprite).spriteFrame=t}.bind(this)),this.loadRes(n.getBigBg("welfare/welfare_bg_1"),function(t){this.main_panel_nd.getChildByName("tab_sprite_bg").getComponent(cc.Sprite).spriteFrame=t}.bind(this))},registerEvent:function(){Utils.onTouchEnd(this.close_btn_nd,function(){Utils.playButtonSound(2),this.ctrl.openActionMainPanel(!1)}.bind(this),1),this.addGlobalEvent(o.UPDATE_HOLIDAY_TAB_STATUS,function(t,e){t==this.function_id&&this.setTabStatus(e.bid)}.bind(this)),this.addGlobalEvent(o.SHOW_ACTIVITY_RED_POINT,function(t,e){this.setSpecialTabStatus(t,e)}.bind(this))},openRootWnd:function(t){this.function_id=t.function_id||l.icon.action,this.sub_list=this.ctrl.getActionSubList(this.function_id),this.action_bid=t.action_bid,this.createSubType()},createSubType:function(){if(null==this.sub_list||null==Utils.next(this.sub_list));else{var e=this.sub_list.length,i=e*(this.tab_width+this.off_space)+110;this.max_width=Math.max(this.tab_scroll_nd.width,i),this.tab_scroll_content_nd.width=this.max_width,this.tab_scroll_sv.scrollToLeft(0);for(var s=function(t){this.handleSelectedTab(t)}.bind(this),n=null,a=null,o=null,l=0;l<e;l++){if(null!=(o=this.sub_list[l])&&null!=o.bid&&null==this.tab_list[o.bid])(n=new(t("welfare_tab_panel"))).show(),n.setData(o),a=l*(this.tab_width+this.off_space)+110,n.setPosition(a,-68),n.setClickCallBack(s),n.setParent(this.tab_scroll_content_nd),this.tab_list[o.bid]=n,this.setTabStatus(o.bid)}this.action_bid?this.handleSelectedTab(this.tab_list[this.action_bid]):this.handleSelectedTab(this.tab_list[this.sub_list[0].bid])}},handleSelectedTab:function(t){null!=this.selected_tab&&this.selected_tab==t||(null!=this.selected_tab&&this.selected_tab.setSelected(!1),this.selected_tab=t,null!=this.selected_tab&&this.selected_tab.setSelected(!0),this.changePanelByTab())},changePanelByTab:function(){if(null!=this.selected_tab&&null!=this.selected_tab.data){var t=this.selected_tab.data;if(null!=t.bid&&0!=t.bid){if(null!=this.selected_panel&&(this.selected_panel.setVisibleStatus?this.selected_panel.setVisibleStatus(!1):this.selected_panel.setVisible(!1),this.selected_panel=null),null==this.panel_list[t.bid]){var e=t.panel_type;18!=t.panel_type&&12!=t.panel_type&&21!=t.panel_type&&23!=t.panel_type&&22!=t.panel_type||(e=16);var i=s.ActionPanelTypeView[e];i&&null==this.panel_list[t.bid]&&(this.panel_list[t.bid]=Utils.createClass(i,t.bid),this.panel_list[t.bid].show({bid:t.bid,function_id:this.function_id}),this.panel_list[t.bid].setParent(this.container_nd))}this.selected_panel=this.panel_list[t.bid],null!=this.selected_panel&&(this.selected_panel.setVisibleStatus?this.selected_panel.setVisibleStatus(!0):this.selected_panel.setVisible(!0))}}},setTabStatus:function(t){var e=this.ctrl.getHolidayAweradsStatus(t),i=this.tab_list[t];if(null!=i){null==e||0==e.status?i.updateTipsStatus&&i.updateTipsStatus(!1):i.updateTipsStatus&&i.updateTipsStatus(!0);var s=this.model.getGiftRedStatusByBid(t);this.setSpecialTabStatus(t,s)}},isSpecialTabByBid:function(t){return t==s.ActionRankCommonType.high_value_gift||t==s.ActionRankCommonType.mysterious_store},setSpecialTabStatus:function(t,e){if((!this.specail_tab_status||this.specail_tab_status!=e)&&(this.specail_tab_status=e,this.isSpecialTabByBid(t))){var i=this.tab_list[t];if(null==i)return;e?i.updateTipsStatus&&i.updateTipsStatus(!0):i.updateTipsStatus&&i.updateTipsStatus(!1)}},closeCallBack:function(){for(var t in this.tab_list)this.tab_list[t].deleteMe&&(this.tab_list[t].deleteMe(),this.tab_list[t]=null);for(var t in this.tab_list=null,this.panel_list)this.panel_list[t].deleteMe&&(this.panel_list[t].deleteMe(),this.panel_list[t]=null);this.panel_list=null,this.selected_tab=null,this.ctrl.openActionMainPanel(!1)}});cc._RF.pop()},{action_const:"action_const",action_controller:"action_controller",action_event:"action_event",mainui_const:"mainui_const",pathtool:"pathtool",welfare_tab_panel:"welfare_tab_panel"}],action_model:[function(t,e,i){"use strict";function s(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}cc._RF.push(e,"3f27dqUQapJ4LUEFzPeFEif","action_model");var n=t("mainui_controller"),a=t("mainui_const"),o=t("action_event"),l=t("action_const");cc.Class({extends:BaseClass,ctor:function(){},properties:{},initConfig:function(){this.fund_red_list={}},setOpenFundIds:function(t){this.fund_id_list=t||[],this.checkFundRedStatus()},getOpenFundIds:function(){return this.fund_id_list||[]},setFundSrvData:function(t){this.fund_datas=this.fund_datas||{},t&&t.id&&(this.fund_datas[t.id]=t,this.updateFundStatus(t.id,t.status))},getFundSrvDataById:function(t){return this.fund_datas=this.fund_datas||{},this.fund_datas[t]||{}},updateFundStatus:function(t,e){this.fund_id_list=this.fund_id_list||[];for(var i=0;i<this.fund_id_list.length;++i){var s=this.fund_id_list[i];if(s.id==t){s.status=e;break}}this.checkFundRedStatus()},checkFundRedStatus:function(){this.fund_id_list=this.fund_id_list||[];for(var t=0;t<this.fund_id_list.length;++t){var e=this.fund_id_list[t];e.id==l.FundType.type_one?(this.updateFundRedStatus(l.FundRedIndex.fund_get_one,1==e.status),this.updateFundRedStatus(l.FundRedIndex.fund_buy_one,0==e.status)):e.id==l.FundType.type_two&&(this.updateFundRedStatus(l.FundRedIndex.fund_get_two,1==e.status),this.updateFundRedStatus(l.FundRedIndex.fund_buy_two,0==e.status))}},updateFundRedStatus:function(t,e){var i=this.fund_red_list[t];if(i!=e&&(t!=l.FundRedIndex.fund_buy_one&&t!=l.FundRedIndex.fund_buy_two||0!=i)){this.fund_red_list[t]=e;var s=!1;for(var r in this.fund_red_list){if(1==this.fund_red_list[r]){s=!0;break}}n.getInstance().setFunctionTipsStatus(a.icon.fund,s),gcore.GlobalEvent.fire(o.UPDATA_FUND_RED_STATUS_EVENT)}},updateSevenLoginData:function(t){this.seven_login_data=t},getSevenLoginData:function(){return this.seven_login_data},getMaxSevenDay:function(){if(null!=this.seven_login_data&&null!=this.seven_login_data.status_list){var t=this.seven_login_data.status_list;t.sort(function(t,e){return t.day-e.day});var e=null;for(var i in t)if(2==t[i].status){e=t[i];break}return null==e&&(e=t[t.length]),e}},setFirstBtnStatus:function(t){this.firstBtnStatus={};for(var e=0;e<t.length;++e){var i=t[e];this.firstBtnStatus[i.id]=i.status}},getFirstBtnStatus:function(t){if(this.firstBtnStatus)return this.firstBtnStatus[t]||0},setSevenGoldPeriod:function(t){this.sevenPeriod=t},getSevenGoldPeriod:function(){return this.sevenPeriod},checkRedPoint:function(t){if(!(t<1||t>7)){t=t||1,this.welfareRetPoint=[];for(var e=1;e<=t;e++){var i=this.getSevenGoalWelfareList(e);for(var s in this.welfareRetPoint[e]=!1,i)if(1==i[s].status){this.welfareRetPoint[e]=!0;break}}this.growRetPoint=[];for(e=1;e<=t;e++){var o=this.getServerGrowListData(e-1);for(var s in this.growRetPoint[e]=!1,o)if(1==o[s].status){this.growRetPoint[e]=!0;break}}this.giftRetPoint=[];for(e=1;e<=t;e++){o=this.getServerGiftListData(e-1);for(var s in this.giftRetPoint[e]=!1,o)if(1==o[s].status){this.giftRetPoint[e]=!0;break}}this.halfRedPoint=[];for(e=1;e<=t;e++){var l=this.getHalfGiftList(e);for(var s in this.halfRedPoint[e]=!1,l)if(0==s&&0==l[s].status){this.halfRedPoint[e]=!0;break}}this.boxRedPoint=[];var r=this.getSevenGoalBoxList();for(var e in r)this.boxRedPoint[e]=!1,1==r[e].status&&(this.boxRedPoint[e]=!0);var c,_=!1,h=!1,d=!1,u=!1,m=!1;for(var e in this.welfareRetPoint)if(1==this.welfareRetPoint[e]){_=!0;break}for(var e in this.growRetPoint)if(1==this.growRetPoint[e]){h=!0;break}for(var e in this.giftRetPoint)if(1==this.giftRetPoint[e]){d=!0;break}for(var e in this.halfRedPoint)if(1==this.halfRedPoint[e]){m=!0;break}for(var e in this.boxRedPoint)if(1==this.boxRedPoint[e]){u=!0;break}c=_||h||d||u||m;var f=a.icon.seven_goal;f=1==this.getSevenGoldPeriod()?a.icon.seven_goal:2==this.getSevenGoldPeriod()?a.icon.seven_goal1:3==this.getSevenGoldPeriod()?a.icon.seven_goal2:a.icon.seven_goal3,n.getInstance().setFunctionTipsStatus(f,c)}},getRedPointWelfareStatus:function(t){if(this.welfareRetPoint){return this.welfareRetPoint[t]}},updataRedPointWelfareStatus:function(t,e){this.welfareRetPoint&&(this.welfareRetPoint[t]=e)},getRedPointGrowStatus:function(t){if(this.growRetPoint){return this.growRetPoint[t]}},updataRedPointGrowStatus:function(t,e){this.growRetPoint&&(this.growRetPoint[t]=e)},getRedPointGiftStatus:function(t){if(this.giftRetPoint){return this.giftRetPoint[t]}},updataRedPointGiftStatus:function(t,e){this.giftRetPoint&&(this.giftRetPoint[t]=e)},getRedPointHalfStatus:function(t){if(this.halfRedPoint){return this.halfRedPoint[t]}},updataRedPointHalfStatus:function(t,e){this.halfRedPoint&&(this.halfRedPoint[t]=e)},getRedPointBoxStatus:function(t){if(this.boxRedPoint){return this.boxRedPoint[t]}},updataRedPointBoxStatus:function(t,e){this.boxRedPoint&&(this.boxRedPoint[t]=e)},initSevenWalfare:function(t){this.setWalfareData(t),this.setWalfareGrowUpData(t),this.setHalfGiftData(t),this.setBoxRewardData(t)},setBoxRewardData:function(t){var e=Config.day_goals_data.data_all_target[t];for(var i in this.boxRewardData=[],e)this.boxRewardData.push(e[i][0]);this.boxRewardData.sort(function(t,e){return t.id-e.id})},getBoxRewardData:function(){return this.boxRewardData||[]},setWalfareData:function(t){var e=Config.day_goals_data.data_welfarecollection[t];this.welfareData=Utils.deepCopy(e)},setWalfareGrowUpData:function(t){var e=Config.day_goals_data.data_growthtarget[t];for(var i in this.welfareGrowData=[],this.welfareGiftData=[],e){var s=[],n=[];for(var a in e[i])1==e[i][a].target_type?s.push(e[i][a]):2==e[i][a].target_type&&n.push(e[i][a]);this.welfareGrowData.push(s),this.welfareGiftData.push(n)}},setHalfGiftData:function(t){var e=Config.day_goals_data.data_halfdiscount[t];this.walfareHalfData=[];for(var i=1;i<=7;i++)this.walfareHalfData[i]=[];for(var i in e)this.walfareHalfData[e[i][0].day].push(e[i][0]);for(i=1;i<=7;i++)this.walfareHalfData[i].sort(function(t,e){return t.id-e.id})},getWalfareData:function(t){if(this.welfareData)return this.welfareData[t]||[]},getWalfareGrowUpData:function(t){if(this.welfareGrowData)return this.welfareGrowData[t]||[]},getWelfareGiftData:function(t){if(this.welfareGiftData)return this.welfareGiftData[t]||[]},getWelfareHalfData:function(t){if(this.walfareHalfData&&this.walfareHalfData[t])return this.walfareHalfData[t]||[]},setSevenGoalWelfareList:function(t){this.welfareList=[];for(var e=1;e<=7;e++)this.welfareList[e]=[];for(var e in t)this.welfareList[t[e].day].push(t[e])},getSevenGoalWelfareList:function(t){if(this.welfareList)return this.welfareList[t]||[]},updataGoalWelfareList:function(t,e,i){this.welfareList[t][e].status=i},setSevenGoalGrowList:function(t){for(var e=[],i=1;i<=7;i++)e[i]=[];for(var i in t)e[t[i].day].push(t[i]);for(var i in this.serverGrowListData=[],this.serverGiftListData=[],e){var s=[],n=[];for(var a in e[i])1==e[i][a].target_type?s.push(e[i][a]):2==e[i][a].target_type&&n.push(e[i][a]);this.serverGrowListData.push(s),this.serverGiftListData.push(n)}},getServerGrowListData:function(t){return this.serverGrowListData&&this.serverGrowListData[t]&&this.serverGrowListData[t]||[]},updataGrowListData:function(t,e,i){this.serverGrowListData[t][e].status=i},getServerGiftListData:function(t){if(this.serverGiftListData)return this.serverGiftListData[t]||[]},updataGiftListData:function(t,e,i){this.serverGiftListData[t][e].status=i},setHalfGiftList:function(t){this.halfGiftList=[];for(var e=1;e<=7;e++)this.halfGiftList[e]=[];for(e=1;e<=7;e++){var i=this.getWelfareHalfData(e);for(var s in i)for(var n in t)i[s].id==t[n].day&&this.halfGiftList[e].push(t[n])}},getHalfGiftList:function(t){if(this.halfGiftList&&this.halfGiftList[t])return this.halfGiftList[t]||[]},updataHalfListData:function(t,e,i){this.halfGiftList[t][e].status=i},setSevenGoalBoxList:function(t){this.boxList=t},getSevenGoalBoxList:function(){if(this.boxList)return this.boxList.sort(Utils.tableLowerSorter(["goal_id"])),this.boxList||[]},updataBoxListData:function(t,e){this.boxList[t].status=e},sortItemList:function(t){var e,i=(s(e={},0,2),s(e,1,1),s(e,2,3),e);t.sort(function(t,e){return t.status!=e.status?i[t.status]&&i[e.status]?i[t.status]-i[e.status]:-1:t.aim-e.aim})},setCountDownTime:function(t,e){var i=t.node;if(i)if(i.stopAllActions(),e>0){this.setTimeFormatString(t,e);var s=cc.callFunc(function(){(e-=1)<0?(i.stopAllActions(),t.string="00:00:00"):this.setTimeFormatString(t,e)}.bind(this));i.runAction(cc.repeatForever(cc.sequence(cc.delayTime(1),s)))}else this.setTimeFormatString(t,e)},setTimeFormatString:function(e,i){var s=t("timetool");i>0?e.string=s.getTimeForFunction(i):(e.node.stopAllActions(),e.string="00:00:00")},setLucklyRewardData:function(){var t=Config.dial_data.data_get_lucky_award,e=this.sortLucklyData(t);this.lucky_num1=e[0],this.lucky_num2=e[1]},getLucklyRewardData:function(t){return this.lucky_num1&&this.lucky_num2?1==t?this.lucky_num1||[]:2==t?this.lucky_num2||[]:void 0:[]},setBuyRewardData:function(){var t=Config.dial_data.data_get_limit_open,e=this.sortLucklyData(t,!0);this.buy_num_list1=e[0],this.buy_num_list2=e[1]},getBuyRewardData:function(t){return this.buy_num_list1&&this.buy_num_list2?1==t?this.buy_num_list1||[]:2==t?this.buy_num_list2||[]:void 0:[]},sortLucklyData:function(t,e){var i=[],s=[];for(var n in t){var a=t[n];1==a.type?i.push(a):2==a.type&&s.push(a)}return e?(i.sort(function(t,e){return t.type2-e.type2}),s.sort(function(t,e){return t.type2-e.type2})):(i.sort(function(t,e){return t.id-e.id}),s.sort(function(t,e){return t.id-e.id})),[i,s]},setTreasureInitData:function(t){for(var e in this.treasureInitData=[],t)this.treasureInitData[t[e].type]=t[e]},getTreasureInitData:function(t){return this.treasureInitData&&this.treasureInitData[t]||[]},updataTreasureInitData:function(t,e){this.treasureInitData&&(this.treasureInitData[t].count=e.count,this.treasureInitData[t].end_time=e.end_time,this.treasureInitData[t].lucky=e.lucky,this.treasureInitData[t].lucky_award=e.lucky_award,this.treasureInitData[t].rand_lists=e.rand_lists)},updataTreasureLogData:function(t,e){this.treasureInitData&&(this.treasureInitData[t].log_list=e)},lucklyRedPoint:function(){this.setLucklyRewardData(),this.tab_redpoint=[!1,!1];for(var t=1;t<=2;t++){var e=this.getLucklyRewardData(t),i=this.getTreasureInitData(t),s=!1;for(var o in e){var l=!0;for(var r in i.lucky_award)if(e[o].id==i.lucky_award[r].lucky){l=!1;break}if(i.lucky<e[o].lucky_val&&(l=!1),1==l){s=!0;break}}this.setLucklyTabRedPoint(t,s)}n.getInstance().setFunctionTipsStatus(a.icon.lucky_treasure,this.tab_redpoint[1]||this.tab_redpoint[2])},setLucklyTabRedPoint:function(t,e){this.tab_redpoint[t]=e},getLucklyTabRedPoint:function(t){return!(!this.tab_redpoint||!this.tab_redpoint[t])&&this.tab_redpoint[t]},getFundRedStatusByBid:function(t){return this.fund_red_list[t]},setStoneShopData:function(t){for(var e in this.stone_shop_data={},t){var i=t[e];this.stone_shop_data[i.id]=i}},getStoneShopData:function(t){return this.stone_shop_data&&null!=this.stone_shop_data[t]?this.stone_shop_data[t]:null},updateGiftRedPointStatus:function(t){var e=t.bid;this.gift_id_list=this.gift_id_list||[],this.gift_id_list[e]=t},getGiftRedStatusByBid:function(t){if(this.gift_id_list){var e=this.gift_id_list[t];return e?e.status:void 0}},setGiftRedStatus:function(t){if(this.gift_id_list){var e=t.bid,i=t.status,s=this.gift_id_list[e];s&&s.status!=i&&(s.status=i),gcore.GlobalEvent.fire(o.SHOW_ACTIVITY_RED_POINT,e,i)}},updataFestvalRedStatus:function(t,e){var i=this.getRedPointStatus(e),s=a.icon.festval;t==l.ActionRankCommonType.festval_day?s=a.icon.festval_spring:t==l.ActionRankCommonType.lover_day&&(s=a.icon.festval_lover),n.getInstance().setFunctionTipsStatus(s,i)},getRedPointStatus:function(t){if(!t)return!1;for(var e=!1,i=0;i<t.length;++i){if(1==t[i].status){e=!0;break}}return e},updataCombineLoginRedStatus:function(t){if(t){for(var e=!1,i=0;i<t.length;++i){if(1==t[i].status){e=!0;break}}n.getInstance().setFunctionTipsStatus(a.icon.combine_login,e)}},updataPreferentialRedStatus:function(t,e){},clearFundSrvData:function(){this.fund_datas={}}});cc._RF.pop()},{action_const:"action_const",action_event:"action_event",mainui_const:"mainui_const",mainui_controller:"mainui_controller",timetool:"timetool"}],action_mysterious_store_item:[function(t,e,i){"use strict";cc._RF.push(e,"bc628UK4Q9L1Yyiy7cMVPfp","action_mysterious_store_item");var s=t("pathtool"),n=t("common_scrollview"),a=t("action_const"),o=t("commonalert"),l=t("action_controller"),r=t("mall_const");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("action","action_mysterious_store_item")},initConfig:function(){this.ctrl=l.getInstance(),this.color_1=new cc.Color(255,255,255,255),this.color_2=new cc.Color(113,40,4,255),this.item_list={}},initPanel:function(){var t=this.seekChild("main_container");this.txt_title_lb=this.seekChild(t,"txt_title",cc.Label),this.txt_task_lb=this.seekChild(t,"txt_task",cc.Label),this.btn_exchange=this.seekChild(t,"btn_exchange"),this.btn_exchange_btn=this.btn_exchange.getComponent(cc.Button),this.txt_exchange_lb=this.seekChild(this.btn_exchange,"txt_exchange",cc.Label),this.img_has_get=this.seekChild(t,"img_has_get"),this.img_has_get.active=!1,this.img_equal_nd=this.seekChild(t,"img_equal"),this.cost_good_cons=this.seekChild("cost_good_cons");var e=this.cost_good_cons.getContentSize();this.cost_item_scrollview=new n,this.cost_item_scrollview.createScroll(this.cost_good_cons,cc.v2(0,0),ScrollViewDir.horizontal,ScrollViewStartPos.top,e,{item_class:"backpack_item",start_x:3,space_x:5,start_y:4,space_y:4,item_width:96,item_height:96,row:1,col:0,scale:.8},cc.v2(.5,.5)),this.get_good_cons=this.seekChild("get_good_cons")},registerEvent:function(){this.btn_exchange.on("click",function(){Utils.playButtonSound(1),this.btnExchange()},this)},btnExchange:function(){if(this.data&&this.data.award&&this.data.award[0]){var e=0;if(this.data.sub_type==a.ActonExchangeType.Perday?e=this.data.sort||0:this.data.sub_type==a.ActonExchangeType.AllServer||this.data.sub_type==a.ActonExchangeType.Activity&&(e=this.data.sort||0),e<=1){var i=cc.js.formatStr(Utils.TI18N("\u662f\u5426\u6d88\u8017<color=#289b14><size=26>%s</></c>\u5151\u6362\u7269\u54c1\uff1f"),this.data.name_str);o.show(i,Utils.TI18N("\u786e\u5b9a"),function(){this.data&&this.data.charge_id&&this.ctrl.sender16689(this.data.charge_id,1)}.bind(this),Utils.TI18N("\u53d6\u6d88"),null,2)}else{var s={};s.bid=this.data.award[0][0],s.item_bid=this.data.award[0][0],s.num=this.data.award[0][1],s.shop_type=r.MallType.SteriousShop,s.limit_num=e,s.has_buy=0,s.is_show_limit_label=!0;var n=Utils.getItemConfig(this.data.award[0][0]);s.name=n.name,s.aim=this.data.charge_id||0,s.pay_type=3,s.price=1,s.quantity=1,t("mall_controller").getInstance().openMallBuyWindow(!0,s)}}},setData:function(t){this.data=t,this.root_wnd&&this.onShow()},onShow:function(t){if(null!=this.data){var e=this.data;this.data.charge_id=e.id,this.txt_title_lb.string=e.title,this.txt_task_lb.string=cc.js.formatStr(Utils.TI18N("\u5269\u4f59:%s"),e.count);var i=1,s=cc.size(100,100);cc.size(270,100);Utils.getArrLen(e.expend)>1&&(i=2,s=cc.size(200,100),cc.size(220,100)),this.cost_good_cons.x=50*(i-1)-279,this.cost_item_scrollview.resetSize(s),this.img_equal_nd.x=77*(i-1)-176.5,this.get_good_cons.x=6+50*(i-1),this.updateItemList(this.cost_item_scrollview,e.expend);var n=[];for(var a in e.award){var o=e.award[a],l={};l.bid=o[0],l.num=o[1],n.push(l)}for(var r in n){var c=n[r];if(!this.item_list[r]){var _=ItemsPool.getInstance().getItem("backpack_item");_.initConfig(!1,.8,!1,!0),_.show(),_.setParent(this.get_good_cons),_.setPosition(100*r-80,0),this.item_list[r]=_}this.item_list[r].setData({bid:c.bid,num:c.num})}0==e.count?(this.txt_exchange_lb.string=Utils.TI18N("\u4e0d\u53ef\u5151\u6362"),this.txt_exchange_lb.node.color=this.color_1,Utils.setGreyButton(this.btn_exchange_btn)):(this.txt_exchange_lb.string=Utils.TI18N("\u5151\u6362"),Utils.setGreyButton(this.btn_exchange_btn,!1),this.txt_exchange_lb.node.color=this.color_2)}},updateItemList:function(t,e){var i=[];for(var s in e){var n=e[s],a={};a.bid=n[0],a.num=n[1],i.push(a)}t.setData(i),t.addEndCallBack(function(){var e=t.getItemList();for(var i in e)e[i]&&e[i].setDefaultTip()}.bind(this))},onHide:function(){},onDelete:function(){if(this.cost_item_scrollview&&(this.cost_item_scrollview.deleteMe(),this.cost_item_scrollview=null),this.item_list){for(var t in this.item_list){var e=this.item_list[t];e&&(e.deleteMe(),e=null)}this.item_list=null}}});cc._RF.pop()},{action_const:"action_const",action_controller:"action_controller",common_scrollview:"common_scrollview",commonalert:"commonalert",mall_const:"mall_const",mall_controller:"mall_controller",pathtool:"pathtool"}],action_mysterious_store_panel:[function(t,e,i){"use strict";cc._RF.push(e,"05072BzCwdDoYgrHuUZTXdg","action_mysterious_store_panel");var s=t("pathtool"),n=t("action_controller"),a=t("common_scrollview"),o=t("action_mysterious_store_item"),l=t("action_const"),r=t("action_event");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("action","action_hero_expedit_panel")},initConfig:function(){this.ctrl=n.getInstance(),this.model=this.ctrl.getModel(),this.first_come_in=!1,this.is_change_id=null},initPanel:function(){this.main_container=this.seekChild("main_container"),this.title_con_nd=this.seekChild("title_con"),this.time_txt_lb=this.seekChild(this.title_con_nd,"label_time",cc.Label),this.time_txt_lb.node.color=new cc.Color(128,247,49,255),this.rank_btn=this.seekChild(this.title_con_nd,"rank_btn"),this.reward_btn=this.seekChild(this.title_con_nd,"reward_btn"),this.btn_rule=this.seekChild(this.title_con_nd,"btn_rule"),this.btn_rule.x=318;var t=this.seekChild(this.main_container,"charge_con"),e=t.getContentSize(),i={item_class:o,start_x:0,space_x:0,start_y:0,space_y:0,item_width:688,item_height:150,row:0,col:1,need_dynamic:!0};this.child_scrollview=new a,this.child_scrollview.createScroll(t,cc.v2(e.width/2,e.height/2),ScrollViewDir.vertical,ScrollViewStartPos.top,e,i,cc.v2(.5,.5))},registerEvent:function(){this.addGlobalEvent(r.UPDATE_STORE_DATA_EVENT,function(){this.setItemData&&0==this.first_come_in&&(this.first_come_in=!0,this.setItemData())},this),this.addGlobalEvent(r.UPDATE_STORE_DATA_SUCCESS_EVENT,function(t){this.changeSuccessData(t.id)},this),Utils.onTouchEnd(this.reward_btn,function(){null!=this.holiday_bid&&t("rank_controller").getInstance().openRankRewardPanel(!0,this.holiday_bid)}.bind(this),1),this.btn_rule.on(cc.Node.EventType.TOUCH_END,function(e){Utils.playButtonSound(1);var i=e.touch.getLocation(),s=Config.holiday_client_data.data_constant.expedit_rules;this.holiday_bid==l.ActionRankCommonType.mysterious_store&&(s=Config.holiday_client_data.data_constant.mysterious_store_rules),t("tips_controller").getInstance().showCommonTips(s.desc,i,null,null,500)},this)},loadBannerImage:function(){var t=this.seekChild(this.title_con_nd,"title_img",cc.Sprite),e="";this.holiday_bid==l.ActionRankCommonType.mysterious_store&&(e="txt_cn_welfare_banner24",this.reward_btn.active=!1,this.rank_btn.active=!1);var i=s.getWelfareBannerRes(e);this.loadRes(i,function(e){t.spriteFrame=e}.bind(this))},onShow:function(t){this.holiday_bid=t.bid,this.setPanelData(),this.ctrl.sender16688(),this.loadBannerImage(),this.model.setGiftRedStatus({bid:l.ActionRankCommonType.mysterious_store,status:!1})},setPanelData:function(){var t=this.ctrl.getActionSubTabVo(this.holiday_bid).remain_sec||0;this.model.setCountDownTime(this.time_txt_lb,t)},setItemData:function(){if(this.child_scrollview){var t=this.setConfigData();this.child_scrollview.setData(t)}},setConfigData:function(){var t=[],e=Config.holiday_exchange_data.data_get_config_const;for(var i in e){var s=e[i],n=this.model.getStoneShopData(s.id);if(n){var a,o=n.day_num||0,r=n.all_num||0,c=0;for(var _ in s.sub_type==l.ActonExchangeType.Perday?c=s.r_limit_day-o:s.sub_type==l.ActonExchangeType.AllServer||s.sub_type==l.ActonExchangeType.Activity&&(c=s.r_limit_all-r),s.count=c,s.count<=0?s.sort=1e5:s.sort=c,s.expend){var h=s.expend[_][0],d=Utils.getItemConfig(h);a=d&&0==_?d.name:a+"\u3001"+d.name}s.name_str=a,t.push(s)}}return t.sort(Utils.tableCommonSorter([["sort",!1],["id",!1]])),t},changeSuccessData:function(t){var e=Config.holiday_exchange_data.data_get_config_const,i=this.model.getStoneShopData(t);if(i&&e&&e[t]){var s=i.day_num||0,n=i.all_num||0,a=0;if(e[t].sub_type==l.ActonExchangeType.Perday?a=e[t].r_limit_day-s:e[t].sub_type==l.ActonExchangeType.AllServer||e[t].sub_type==l.ActonExchangeType.Activity&&(a=e[t].r_limit_all-n),this.child_scrollview)if(a<=0){var o=this.setConfigData();this.child_scrollview.setData(o)}else{o=this.setConfigData();this.child_scrollview.setData(o)}}},setVisibleStatus:function(t){t=t||!1,this.setVisible(t)},onHide:function(){},onDelete:function(){this.child_scrollview&&(this.child_scrollview.deleteMe(),this.child_scrollview=null)}});cc._RF.pop()},{action_const:"action_const",action_controller:"action_controller",action_event:"action_event",action_mysterious_store_item:"action_mysterious_store_item",common_scrollview:"common_scrollview",pathtool:"pathtool",rank_controller:"rank_controller",tips_controller:"tips_controller"}],action_open_server_gift_item_panel:[function(t,e,i){"use strict";cc._RF.push(e,"205c92q/LtNjIlKjlhrH+kO","action_open_server_gift_item_panel");var s=t("pathtool"),n=t("action_const"),a=t("action_controller"),o=t("action_event");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("action","action_open_server_gift_item"),this.ctrl=a.getInstance()},initConfig:function(){this.open_server_charge_id=0,this.itemArr=[],this.touch_get_btn=!0},initPanel:function(){this.main_container=this.root_wnd.getChildByName("main_container"),this.label_title=this.main_container.getChildByName("label_title").getComponent(cc.Label),this.label_title.string="",this.label_item_desc=this.main_container.getChildByName("label_item_desc").getComponent(cc.Label),this.label_item_desc.string="",this.label_cost=this.main_container.getChildByName("label_cost").getComponent(cc.Label),this.label_cost.string="",this.label_limit=this.main_container.getChildByName("label_limit").getComponent(cc.Label),this.label_limit.string="",this.img_line=this.main_container.getChildByName("img_line"),this.img_has_get=this.main_container.getChildByName("img_has_get"),this.img_has_get.active=!1,this.btn_get=this.main_container.getChildByName("btn_get"),this.rmb_num_lb=this.btn_get.getChildByName("Label").getComponent(cc.Label),this.rmb_num_lb.string="",this.good_cons=this.main_container.getChildByName("goods_con"),this.data&&this.setData(this.data)},registerEvent:function(){this.addGlobalEvent(o.Is_Charge_Event,function(t){if(t&&null!=t.status&&t.charge_id){var e=Config.charge_data.data_charge_data[t.charge_id];e&&1==t.status&&t.charge_id==this.open_server_charge_id&&SDK.pay(e.val,1,e.id,e.name,e.name)}}.bind(this)),this.btn_get.on("click",function(){Utils.playButtonSound(1),this.touch_get_btn&&(Utils.delayRun(this.main_container,2,function(){this.touch_get_btn=!0}.bind(this)),this.touch_get_btn=null,this.data&&this.data.charge_id&&this.data.left_time>0&&(this.open_server_charge_id=this.data.charge_id,this.ctrl.sender21016(this.data.charge_id)))},this)},onShow:function(t){},setData:function(t){if(this.data=t,this.root_wnd){0==this.itemArr.length&&this.loadRewardList(t.item_list),this.label_title.string=t.aim_str;var e,i,s=Utils.keyfind("aim_args_key",n.ActionExtType.ItemDesc,t.aim_args);this.label_item_desc.string=s.aim_args_str||"";var a,o,l=Utils.keyfind("aim_args_key",n.ActionExtType.RechageCurCount,t.aim_args),r=Utils.keyfind("aim_args_key",n.ActionExtType.RechageTotalCount,t.aim_args);i=l.aim_args_val||0,e=r.aim_args_val||0,this.label_limit.string=Utils.TI18N(cc.js.formatStr("\u9650\u8d2d\uff1a%d/%d",i,e)),this.data.left_time=e-i;var c=Utils.keyfind("aim_args_key",n.ActionExtType.ActivityOldPrice,t.aim_args),_=Utils.keyfind("aim_args_key",n.ActionExtType.ActivityCurrentPrice,t.aim_args);a=c.aim_args_val||0,o=_.aim_args_val||0,this.label_cost.string=Utils.TI18N(cc.js.formatStr("%d\u5143",a)),this.rmb_num_lb.string=Utils.TI18N(cc.js.formatStr("%d\u5143\u9886\u53d6",o));var h=Utils.keyfind("aim_args_key",n.ActionExtType.ItemRechargeId,t.aim_args);this.data.charge_id=h.aim_args_val||0,this.btn_get.active=this.data.left_time>0,this.img_has_get.active=this.data.left_time<=0}},loadRewardList:function(t){if(t.length>0){this.updateItem=this.startUpdate(t.length,function(e){var i=new cc.Node;i.setContentSize(96,96),this.good_cons.addChild(i);var s=ItemsPool.getInstance().getItem("backpack_item");s.initConfig(!1,.8,!0,!0),s.setParent(i),s.show(),s.setData({bid:t[e].bid,num:t[e].num}),this.itemArr.push(s)}.bind(this))}},onHide:function(){},onDelete:function(){if(this.main_container&&this.main_container.stopAllActions(),this.itemArr){for(var t=0;t<this.itemArr.length;++t)this.itemArr[t]&&(this.itemArr[t].deleteMe(),this.itemArr[t]=null);this.itemArr=null}this.updateItem&&(gcore.Timer.del(this.updateItem),this.updateItem=null)}});cc._RF.pop()},{action_const:"action_const",action_controller:"action_controller",action_event:"action_event",pathtool:"pathtool"}],action_open_server_gift_window:[function(t,e,i){"use strict";cc._RF.push(e,"2bffbvXPI5AHKjIIjx2RIsV","action_open_server_gift_window");var s=t("pathtool"),n=t("action_event"),a=t("action_open_server_gift_item_panel");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("action","action_open_server_gift_window"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Big,this.ctrl=arguments[0],this.model=this.ctrl.getModel(),this.open_server_charge_id=0},initConfig:function(){this.item_gift={}},openCallBack:function(){this.main_container=this.root_wnd.getChildByName("main_container"),this.time_text=this.main_container.getChildByName("label_time").getComponent(cc.Label),this.time_text.string="",this.btn_close=this.main_container.getChildByName("btn_close"),this.panel_item=this.main_container.getChildByName("panel_item"),this.main_container.active=!1,this.loadRes(s.getBigBg("action/txt_cn_action_open_server_gift"),function(t){this.main_container.getChildByName("img_bg").getComponent(cc.Sprite).spriteFrame=t,this.main_container.active=!0}.bind(this)),this.loadRes(s.getUIIconPath("aciontopenserver","aciontopenserver_4"),function(t){this.main_container.getChildByName("img_gift").getComponent(cc.Sprite).spriteFrame=t}.bind(this))},registerEvent:function(){this.addGlobalEvent(n.UPDATE_HOLIDAY_SIGNLE,function(t){t.bid==this.holiday_bid&&this.setData(t)}.bind(this)),this.btn_close.on("click",function(){Utils.playButtonSound(2),this.ctrl.openActionOpenServerGiftWindow(!1)},this)},openRootWnd:function(e){if(e){this.holiday_bid=e,this.ctrl.cs16603(this.holiday_bid);var i=t("mainui_controller"),s=t("mainui_const");i.getInstance().setFunctionTipsStatus(s.icon.open_server_recharge,!1)}},setData:function(t){this.data=t;var e=t.remain_sec||0;this.model.setCountDownTime(this.time_text,e);t.aim_list.sort(function(t,e){if(t.status==e.status){for(var i=0,s=0,n=0;n<t.aim_args.length;++n){var a=t.aim_args[n];27==a.aim_args_key&&(i=a.aim_args_val)}for(var o=0;o<e.aim_args.length;++o){var l=e.aim_args[o];27==l.aim_args_key&&(s=l.aim_args_val)}return i-s}return t.status-e.status});for(var i=0;i<t.aim_list.length;++i){var s=t.aim_list[i],n=this.item_gift[s.aim];null==n&&((n=new a).setParent(this.panel_item),n.show(),this.item_gift[s.aim]=n);var o=2+284*i;n.setData(s),n.setPosition(0,-o)}},closeCallBack:function(){if(this.item_gift){for(var t in this.item_gift)this.item_gift[t]&&(this.item_gift[t].deleteMe(),this.item_gift[t]=null);this.item_gift=null}this.ctrl.openActionOpenServerGiftWindow(!1)}});cc._RF.pop()},{action_event:"action_event",action_open_server_gift_item_panel:"action_open_server_gift_item_panel",mainui_const:"mainui_const",mainui_controller:"mainui_controller",pathtool:"pathtool"}],action_seven_goal_item_panel:[function(t,e,i){"use strict";cc._RF.push(e,"73f8e1jNc9DyIIdlHVI7slu","action_seven_goal_item_panel");var s=t("pathtool"),n=t("action_controller"),a=t("stronger_controller");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("action","action_seven_goal_item")},initConfig:function(){this.goods_list=[]},initPanel:function(){this.main_container=this.root_wnd.getChildByName("main_container"),this.goods_con=this.main_container.getChildByName("goods_con"),this.has_bg=this.main_container.getChildByName("has_bg"),this.has_bg.active=!1,this.textGet=this.main_container.getChildByName("textGet").getComponent(cc.Label),this.btn_get=this.main_container.getChildByName("btn_get"),this.btn_get_lab=this.btn_get.getChildByName("Label").getComponent(cc.Label),this.btn_get_lab.string=Utils.TI18N("\u9886\u53d6"),this.btn_get.active=!1,this.btn_goto=this.main_container.getChildByName("btn_goto"),this.btn_goto_lab=this.btn_goto.getChildByName("Label").getComponent(cc.Label),this.btn_goto_lab.string=Utils.TI18N("\u524d\u5f80"),this.btn_goto.active=!1,this.half_panel=this.main_container.getChildByName("half_panel"),this.image_2=this.half_panel.getChildByName("Image_2").getComponent(cc.Sprite),this.price_1=this.half_panel.getChildByName("price_1").getComponent(cc.Label),this.btn_buy=this.half_panel.getChildByName("btn_buy"),this.price_2=this.btn_buy.getChildByName("price_2").getComponent(cc.Label),this.image_2_0=this.btn_buy.getChildByName("Image_2_0").getComponent(cc.Sprite),this.half_panel.active=!1;var t=s.getItemRes(3);this.loadRes(t,function(t){this.image_2.spriteFrame=t,this.image_2_0.spriteFrame=t}.bind(this)),this.title_txt=this.main_container.getChildByName("title_txt").getComponent(cc.Label),this.data&&this.updateInfo()},registerEvent:function(){Utils.onTouchEnd(this.btn_get,function(){n.getInstance().cs13602(this.type,this.cur_day,this.serve_list[this.data._index].goal_id,this.data._index)}.bind(this),1),Utils.onTouchEnd(this.btn_goto,function(){n.getInstance().openSevenGoalView(!1),a.getInstance().clickCallBack(this.data.show_icon)}.bind(this),1),Utils.onTouchEnd(this.btn_buy,function(){n.getInstance().cs13602(this.type,this.cur_day,this.data.id,this.data._index)}.bind(this),1)},setExtendData:function(t){this.serve_list=t.list,this.type=t.type,this.cur_day=t.day},setData:function(t){this.data=t,this.updateInfo()},updateInfo:function(){if(this.root_wnd){for(var t in this.data.desc&&(this.title_txt.string=this.data.desc),this.goods_list)this.goods_list[t].setVisible(!1);for(t=0;t<this.data.award1.length;t++){if(!this.goods_list[t]){var e=ItemsPool.getInstance().getItem("backpack_item");e.setAnchorPoint(0,.5),e.initConfig(!1,.7,!1,!0),e.setParent(this.goods_con),e.show(),this.goods_list[t]=e}(e=this.goods_list[t])&&(e.setVisible(!0),e.setPosition(109*t+42,45),e.setData({bid:this.data.award1[t][0],num:this.data.award1[t][1]}))}if(1==this.type){var i=this.serve_list[this.data._index],s=cc.js.formatStr("%d/%d",i.value,i.target_val);this.textGet.string=s}else if(2==this.type||3==this.type){if(this.serve_list[this.data._index].progress&&this.serve_list[this.data._index].progress[0]){i=this.serve_list[this.data._index].progress[0],s=cc.js.formatStr("%d/%d",i.value,i.target_val);this.textGet.string=s}}else 4==this.type&&(this.btn_goto.active=!1,this.btn_get.active=!1,this.has_bg.active=!1,this.price_1.string=this.data.price1,this.price_2.string=this.data.price2,0==this.serve_list[this.data._index].status?(this.half_panel.active=!0,this.has_bg.active=!1,this.textGet.string=Utils.TI18N("\u5269\u4f59: 1")):(this.half_panel.active=!1,this.has_bg.active=!0,this.textGet.string=Utils.TI18N("\u5269\u4f59: 0")));4!=this.type&&(this.half_panel.active=!1,this.btn_goto.active=0==this.serve_list[this.data._index].status,this.btn_get.active=1==this.serve_list[this.data._index].status,this.has_bg.active=2==this.serve_list[this.data._index].status)}},onShow:function(t){},onHide:function(){},onDelete:function(){if(this.goods_list&&null!=Utils.next(this.goods_list||{}))for(var t in this.goods_list)this.goods_list[t].deleteMe&&this.goods_list[t].deleteMe()}});cc._RF.pop()},{action_controller:"action_controller",pathtool:"pathtool",stronger_controller:"stronger_controller"}],action_seven_goal_window:[function(t,e,i){"use strict";function s(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}cc._RF.push(e,"460e8wKJ3lMlq1WVw28V0q9","action_seven_goal_window");var n=t("pathtool"),a=t("timetool"),o=t("action_event");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=n.getPrefabPath("action","action_seven_goal_window"),this.viewTag=SCENE_TAG.ui,this.win_type=WinType.Full,this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){this.cur_index=null,this.cur_select=null,this.cur_grop_select=null,this.welfareList=null,this.growthTarget=null,this.priceList=null,this.item_scrollview_walfare=null,this.currentDay=1,this.initCurrentDay=1,this.load_touch_day=[]},openCallBack:function(){this.background=this.root_wnd.getChildByName("background"),this.bigBg=this.background.getChildByName("Image_bg"),this.bigBg.scale=FIT_SCALE,this.bg_sprite=this.bigBg.getComponent(cc.Sprite),this.main_container=this.background.getChildByName("main_container"),this.layer_tab=this.background.getChildByName("layer_tab"),this.boxSprite=[],this.award_list=[108,108,108,110];this.box_list=[];for(var e=this.model.getBoxRewardData(),i=1;i<=4;i++){this.boxSprite[i]=this.background.getChildByName("box_"+i),this.boxSprite[i].effect=this.boxSprite[i].getChildByName("eff_nd").getComponent(sp.Skeleton),this.boxSprite[i].redpoint=this.boxSprite[i].getChildByName("redpoint"),this.boxSprite[i].redpoint.zIndex=11,this.boxSprite[i].redpoint.active=!1,this.box_list[i]=this.background.getChildByName("box_"+i),this.box_list[i].x=559/4*i-280;var s=this.box_list[i].getChildByName("textNum").getComponent(cc.Label);s.node.zIndex=11,s.string=e[i-1].goal}this.goods_walfare=this.main_container.getChildByName("goods_walfare"),this.close_btn=this.main_container.getChildByName("close_btn"),this.btn_list=[];var n=[Utils.TI18N("\u798f\u5229\u9886\u53d6"),Utils.TI18N(""),Utils.TI18N(""),Utils.TI18N("\u798f\u5229\u793c\u5305")];for(i=1;i<=4;i++){var a=this.layer_tab.getChildByName("btnSelect_"+i);a.red_point=a.getChildByName("redpoint"),a.red_point.active=!1,a.normal=a.getChildByName("normal"),a.select=a.getChildByName("select"),a.select.active=!1,a.title=a.getChildByName("title").getComponent(cc.Label),a.title.string=n[i-1],a.title.node.color=new cc.Color(207,181,147,255),a.index=i,this.btn_list[i]=a}var o=this.background.getChildByName("layerReward");this.rewardItem=[];for(i=1;i<=7;i++){this.rewardItem[i]=o.getChildByName("reward_"+i);var l=this.rewardItem[i].getChildByName("redpoint");this.rewardItem[i].red_point=l,this.rewardItem[i].red_point.active=!1,this.rewardItem[i].getChildByName("day").string=Utils.TI18N("\u7b2c")+i+Utils.TI18N("\u5929");var r=this.rewardItem[i].getChildByName("rewardImage").getComponent(cc.Sprite);this.rewardItem[i].rewardImage=r;var c=this.rewardItem[i].getChildByName("rewardItem").getComponent(cc.Sprite);this.rewardItem[i].show_day_icon=c,this.rewardItem[i].show_day_icon.node.setScale(.8)}this.finish_round=this.background.getChildByName("finish_round").getComponent(cc.Sprite),this.day_title=this.background.getChildByName("day_title").getComponent(cc.Sprite),this.main_container.getChildByName("Text_19").getComponent(cc.Label).string=Utils.TI18N("\u5269\u4f59\u65f6\u95f4: "),this.background.getChildByName("Text_1").getComponent(cc.Label).string=Utils.TI18N("\u5b8c\u6210\u4e2a\u6570"),this.sevenGoalTime=this.main_container.getChildByName("sevenGoalTime").getComponent(cc.Label),this.bar=this.background.getChildByName("bar").getComponent(cc.ProgressBar),this.successNum=this.background.getChildByName("successNum").getComponent(cc.Label);var _=this.goods_walfare.getContentSize(),h=cc.size(_.width,_.height),d={item_class:t("action_seven_goal_item_panel"),start_x:0,space_x:0,start_y:0,space_y:5,item_width:641,item_height:156,row:0,col:1},u=t("common_scrollview");this.item_scrollview_walfare=new u,this.item_scrollview_walfare.createScroll(this.goods_walfare,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,h,d)},registerEvent:function(){for(var e in this.addGlobalEvent(o.UPDATE_SEVENT_GOAL,function(t){if(!t||t.cur_day>7||t.cur_day<1)this.ctrl.openSevenGoalView(!1);else{t.period=t.period||1;var e=Config.day_goals_data.data_constant.day_item;e=2==t.period?Config.day_goals_data.data_constant.day_item:(t.period,Config.day_goals_data.data_constant.day_item);for(var i=1;i<=7;i++){var s=Utils.getItemConfig(e.val[i-1]);if(s){var o=n.getItemRes(s.icon);this.loadRes(o,function(t,e){t.spriteFrame=e}.bind(this,this.rewardItem[i].show_day_icon))}}var l=cc.js.formatStr("seven_goals/%d",t.period),r=n.getUIIconPath(l,"action_seven_goal_bg1","jpg");this.loadRes(r,function(t){this.bg_sprite.spriteFrame=t}.bind(this));var c=n.getUIIconPath(l,"seven_goals_1_3");this.loadRes(c,function(t){this.finish_round.spriteFrame=t}.bind(this));var _=n.getUIIconPath(l,"seven_goals_1_4");this.loadRes(_,function(t){this.day_title.spriteFrame=t}.bind(this)),this.day_title.node.scaleX=8,this.goalEndTime=t.end_time,this.currentDay=t.cur_day||1,this.initCurrentDay=t.cur_day||1,this.noArriveDayGray(this.currentDay),this.success_num=t.num||1,this.successNum.string=this.success_num,this.bar.progress=this.setSemgentPercent(this.success_num),this.sevenGoalTime.node.stopAllActions(),this.goalEndTime>0?(this.sevenGoalTime.node.runAction(cc.repeatForever(cc.sequence(cc.delayTime(1),cc.callFunc(function(){this.goalEndTime=this.goalEndTime-1,this.goalEndTime<=0?(this.sevenGoalTime.node.stopAllActions(),this.sevenGoalTime.string="00:00:00"):this.sevenGoalTime.string=a.getTimeFormatDayIIIIIIII(this.goalEndTime)}.bind(this))))),this.sevenGoalRemainTime()):(this.sevenGoalTime.node.stopAllActions(),this.sevenGoalTime.string="00:00:00");var h=this.model.getSevenGoalBoxList();this.updateTaskList(h),null==this.cur_index?this.selectByBtn(1):this.selectByBtn(this.cur_index);var d=this.initRedPointDay(this.currentDay);for(var i in d)this.rewardItem[i].red_point.active=d[i];this.redPointTabDayList(this.currentDay)}}.bind(this)),this.addGlobalEvent(o.UPDATE_SEVENT_GET,function(t){this.success_num=t.num||1,this.successNum.string=t.num,this.bar.progress=this.setSemgentPercent(t.num);var e=[],i=[],s=[],n=[];if(1==t.type||2==t.type||3==t.type){1==t.type?(i=this.model.getWalfareData(t.day_type),s=this.model.getSevenGoalWelfareList(t.day_type)):2==t.type?(i=this.model.getWalfareGrowUpData(t.day_type-1),s=this.model.getServerGrowListData(t.day_type-1)):3==t.type&&(i=this.model.getWelfareGiftData(t.day_type-1),s=this.model.getServerGiftListData(t.day_type-1));var a=1;for(var o in s)if(s[o].goal_id==t.id){a=o;break}for(var o in 1==t.type?(this.model.updataGoalWelfareList(t.day_type,a,t.status),n=this.model.getSevenGoalWelfareList(this.currentDay)):2==t.type?(this.model.updataGrowListData(t.day_type-1,a,t.status),n=this.model.getServerGrowListData(t.day_type-1)):3==t.type&&(this.model.updataGiftListData(t.day_type-1,a,t.status),n=this.model.getServerGiftListData(t.day_type-1)),n=this.reverseTable(Utils.deepCopy(n)),n=this.sortFunc(n))for(var l in i)n[o].goal_id==i[l].goal_id&&e.push(i[l]);i=e;var r=!1;for(var o in n)if(1==n[o].status){r=!0;break}for(var o in i)i[o]._index=parseInt(o);1==t.type?this.model.updataRedPointWelfareStatus(t.day_type,r):2==t.type?this.model.updataRedPointGrowStatus(t.day_type,r):3==t.type&&this.model.updataRedPointGiftStatus(t.day_type,r),(d={}).list=Utils.deepCopy(n),d.type=this.cur_index,d.day=t.day_type,this.item_scrollview_walfare.setData(i,null,d)}else if(4==t.type){var c=this.model.getWelfareHalfData(t.day_type),_=this.model.getHalfGiftList(t.day_type);a=1;for(var o in _)if(_[o].day==t.id){a=o;break}this.model.updataHalfListData(t.day_type,a,t.status);var h=this.model.getHalfGiftList(t.day_type);for(var o in h.sort(function(t,e){return t.status-e.status}),h)for(var l in c)h[o].day==c[l].id&&e.push(c[l]);for(var o in c=e)c[o]._index=parseInt(o);var d;r=!1;for(var o in h)if(h[o].day<=7&&0==h[o].status){r=!0;break}this.model.updataRedPointHalfStatus(t.day_type,r),(d={}).list=Utils.deepCopy(h),d.type=this.cur_index,d.day=t.day_type,this.item_scrollview_walfare.setData(c,null,d)}else if(5==t.type){var u=this.model.getBoxRewardData(),m=1;for(var o in u)if(u[o].id==t.id){m=o;break}this.model.updataBoxListData(m,t.status);var f=this.model.getSevenGoalBoxList();this.updateTaskList(f),this.model.updataRedPointBoxStatus(m,f[m].status)}u=this.model.getBoxRewardData();if(this.success_num==u[0].goal||this.success_num==u[1].goal||this.success_num==u[2].goal||this.success_num==u[3].goal){for(f=this.model.getSevenGoalBoxList(),o=1;o<=4;o++)this.success_num==u[o-1].goal&&0==f[o-1].status&&(f[o-1].status=1);this.updateTaskList(f)}this.redPointTabDayList(t.day_type,!0)}.bind(this)),this.btn_list)Utils.onTouchEnd(this.btn_list[e],function(t){this.selectByBtn(t)}.bind(this,e),1);for(var e in this.rewardItem)Utils.onTouchEnd(this.rewardItem[e],function(t){t>this.initCurrentDay?message(Utils.TI18N("\u672a\u8fbe\u5230\u5f00\u653e\u5929\u6570")):this.noArriveDayGray(t)}.bind(this,e),1);for(var e in this.box_list)Utils.onTouchEnd(this.box_list[e],function(e){var i=this.model.getBoxRewardData(),s=function(){this.ctrl.cs13602(5,this.currentDay,i[parseInt(e)-1].id,0)}.bind(this);t("commonalert").showItemApply(Utils.TI18N("\u5f53\u524d\u6d3b\u8dc3\u5ea6\u5956\u52b1"),i[parseInt(e)-1].award,s,Utils.TI18N("\u786e\u5b9a"),null,null,Utils.TI18N("\u5956\u52b1"),null,null,!0,null,null,{off_y:50})}.bind(this,e),1);Utils.onTouchEnd(this.close_btn,function(){this.ctrl.openSevenGoalView(!1)}.bind(this),2)},openRootWnd:function(t){this.ctrl.cs13601()},sevenGoalRemainTime:function(){this.goalEndTime=this.goalEndTime-1,this.goalEndTime<=0&&(this.sevenGoalTime.node.stopAllActions(),this.sevenGoalTime.string="00:00:00"),this.sevenGoalTime.string=a.getTimeFormatDayIIIIIIII(this.goalEndTime)},noArriveDayGray:function(t){t=t||1,this.cur_index&&(this.currentDay=t,this.selectByBtn(this.cur_index));for(var e=cc.js.formatStr("seven_goals/%d",this.model.getSevenGoldPeriod()),i=1;i<=7;i++)if(i<=this.initCurrentDay){if(i==t){var s=n.getUIIconPath(e,"seven_goals_1_2");this.loadRes(s,function(t,e){t.spriteFrame=e}.bind(this,this.rewardItem[t].rewardImage))}else{s=n.getUIIconPath(e,"seven_goals_1_1");this.loadRes(s,function(t,e){t.spriteFrame=e}.bind(this,this.rewardItem[i].rewardImage))}this.rewardItem[i]&&this.rewardItem[i].show_day_icon&&this.rewardItem[i].show_day_icon.setMaterial(0,cc.Material.getBuiltinMaterial("2d-sprite"))}else{this.rewardItem[i]&&this.rewardItem[i].show_day_icon&&this.rewardItem[i].show_day_icon.setMaterial(0,cc.Material.getBuiltinMaterial("gray-sprite"));s=n.getUIIconPath(e,"seven_goals_1_1");this.loadRes(s,function(t,e){t.spriteFrame=e}.bind(this,this.rewardItem[i].rewardImage))}},reverseTable:function(t){return t.reverse(),t},sortFunc:function(t){var e,i=(s(e={},0,2),s(e,1,1),s(e,2,3),e),n=function(t,e){return t.status!=e.status?i[t.status]&&i[e.status]?i[t.status]-i[e.status]:-1:t.goal_id-e.goal_id};return t.sort(n),t},getTabName:function(t){var e=this.model.getWalfareGrowUpData(t-1),i=this.model.getWelfareGiftData(t-1);return[e[0].type_name,i[0].type_name]},selectByBtn:function(t){t=t||1,null!=this.cur_select&&(this.cur_select.select.active=!1,this.cur_select.title.node.color=new cc.Color(207,181,147,255)),this.cur_index=t,this.cur_select=this.btn_list[this.cur_index],null!=this.cur_select&&(this.cur_select.select.active=!0,this.cur_select.title.node.color=new cc.Color(255,237,214,255)),this.redPointTabDayList(this.currentDay);var e=[],i=[],s=[];1==this.cur_index?(e=this.model.getWalfareData(this.currentDay),i=this.model.getSevenGoalWelfareList(this.currentDay)):2==this.cur_index?(e=this.model.getWalfareGrowUpData(this.currentDay-1),i=this.model.getServerGrowListData(this.currentDay-1)):3==this.cur_index?(e=this.model.getWelfareGiftData(this.currentDay-1),i=this.model.getServerGiftListData(this.currentDay-1)):4==this.cur_index&&(e=this.model.getWelfareHalfData(this.currentDay),i=this.model.getHalfGiftList(this.currentDay));var n=this.getTabName(this.currentDay);if(this.btn_list[2].title.string=n[0],this.btn_list[3].title.string=n[1],4==this.cur_index)for(var a in i.sort(function(t,e){return t.status-e.status}),i)for(var o in e)i[a].day==e[o].id&&s.push(e[o]);else for(var a in i=this.reverseTable(Utils.deepCopy(i)),i=this.sortFunc(i))for(var l in e)i[a].goal_id==e[l].goal_id&&s.push(e[l]);for(var a in e=s)e[a]._index=parseInt(a);var r={};r.list=Utils.deepCopy(i),r.type=this.cur_index,r.day=this.currentDay,this.item_scrollview_walfare.setData(e,null,r)},initRedPointDay:function(t){if(!(t<1||t>7)){for(var e=[],i=1;i<=t;i++){e[i]=!1;var s,n=this.model.getRedPointWelfareStatus(i),a=this.model.getRedPointGrowStatus(i),o=this.model.getRedPointGiftStatus(i),l=this.model.getRedPointHalfStatus(i);s=n||a||o||l,e[i]=s}return e}},redPointTabDayList:function(e,i){if(!(this.currentDay<1||this.currentDay>7)){var s=this.model.getRedPointWelfareStatus(e);this.btn_list[1]&&this.btn_list[1].red_point&&(this.btn_list[1].red_point.active=s);var n=this.model.getRedPointGrowStatus(e);this.btn_list[2]&&this.btn_list[2].red_point&&(this.btn_list[2].red_point.active=n);var a=this.model.getRedPointGiftStatus(e);this.btn_list[3]&&this.btn_list[3].red_point&&(this.btn_list[3].red_point.active=a);var o=this.model.getRedPointHalfStatus(e);if(this.btn_list[4]&&this.btn_list[4].red_point&&(this.btn_list[4].red_point.active=o),i){var l;l=s||n||a||o,this.rewardItem[e].red_point.active=l;var r=this.initRedPointDay(this.currentDay),c=!1;for(var _ in r)if(1==r[_]){c=!0;break}var h=!1;for(_=1;_<=3;_++){if(1==this.model.getRedPointBoxStatus(_)){h=!0;break}}var d=t("mainui_const"),u=d.icon.seven_goal;u=1==this.model.getSevenGoldPeriod()?d.icon.seven_goal:2==this.model.getSevenGoldPeriod()?d.icon.seven_goal1:3==this.model.getSevenGoldPeriod()?d.icon.seven_goal2:d.icon.seven_goal3,t("mainui_controller").getInstance().setFunctionTipsStatus(u,c||h)}}},updateTaskList:function(t){for(var e=1;e<=4;e++){var i=PlayerAction.action_1;this.boxSprite[e].redpoint.active=!1,t[e-1]&&(0==t[e-1].status?i=PlayerAction.action_1:1==t[e-1].status?(i=PlayerAction.action_2,this.boxSprite[e].redpoint.active=!0):2==t[e-1].status&&(i=PlayerAction.action_3));var s=this.boxSprite[e].effect;if(s&&(s.setToSetupPose(),s.clearTracks()),s){var a=n.getEffectRes(this.award_list[e-1]),o=n.getSpinePath(a,"action");this.loadRes(o,function(t,e,i){t.skeletonData=i,t.setAnimation(0,e,!0)}.bind(this,s,i))}}},setSemgentPercent:function(t){var e=0,i=this.model.getBoxRewardData();if(null==i[0]||null==i[1]||null==i[2]||null==i[3])return 0;if(t<=i[0].goal)return t/i[0].goal*25/100;if(t>i[0].goal&&t<=i[1].goal)e=1;else if(t>i[1].goal&&t<=i[2].goal)e=2;else{if(!(t>i[2].goal&&t<=i[3].goal))return 1;e=3}var s=i[e].goal-i[e-1].goal;return(25*e+(t-i[e-1].goal)/s*25)/100},closeCallBack:function(){this.cur_select=null,this.boxList=[],this.item_scrollview_walfare&&this.item_scrollview_walfare.deleteMe(),this.item_scrollview_walfare=null,this.sevenGoalTime.node.stopAllActions(),this.ctrl.openSevenGoalView(!1)}});cc._RF.pop()},{action_event:"action_event",action_seven_goal_item_panel:"action_seven_goal_item_panel",common_scrollview:"common_scrollview",commonalert:"commonalert",mainui_const:"mainui_const",mainui_controller:"mainui_controller",pathtool:"pathtool",timetool:"timetool"}],action_seven_login_item_panel:[function(t,e,i){"use strict";cc._RF.push(e,"8434eOqrx1E85rTPOvfwOkV","action_seven_login_item_panel");var s=t("pathtool");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("action","action_seven_login_item")},initConfig:function(){this.status=1},initPanel:function(){this.main_container=this.root_wnd.getChildByName("main_container"),this.main_container.getChildByName("title_bg").zIndex=21,this.title=this.main_container.getChildByName("title").getComponent(cc.Label),this.title.node.zIndex=21,this.get=this.main_container.getChildByName("get"),this.get.active=!1,this.select=this.main_container.getChildByName("select"),this.select.active=!1,this.effect_node=this.seekChild("get_eff_node"),this.effect=this.seekChild("get_eff_node",sp.Skeleton),this.effect_node.active=!1,this.effect_node.zIndex=20;var t=s.getSpinePath(s.getEffectRes(257),"action");this.loadRes(t,function(t){this.effect.skeletonData=t,this.effect.setAnimation(0,PlayerAction.action,!0)}.bind(this)),this.icon=this.main_container.getChildByName("icon").getComponent(cc.Sprite),this.data&&this.updateInfo(),null!=this.isSelect&&this.setSelect(this.isSelect),null!=this.status?this.setStatus(this.status):this.setStatus(1)},registerEvent:function(){Utils.onTouchEnd(this.main_container,function(){this.callback&&this.callback()}.bind(this),2)},setData:function(t){this.data=t,this.updateInfo()},updateInfo:function(){if(this.root_wnd&&this.data){var e=this.data,i=t("string_util");if(this.title.string=Utils.TI18N("\u7b2c")+i.numToChinese(e)+Utils.TI18N("\u5929"),this.loadRes(s.getUIIconPath("actionsevenlogin","seven_login_item"+e),function(t){this.icon.spriteFrame=t}.bind(this)),2==e||3==e){if(null==this.effect2){var n=new cc.Node;n.setAnchorPoint(.5,.5),n.setPosition(this.main_container.getContentSize().width/2,this.main_container.getContentSize().height/2),this.main_container.addChild(n,19),this.effect2=n.addComponent(sp.Skeleton);var a=s.getSpinePath(s.getEffectRes(258),"action");this.loadRes(a,function(t){this.effect2&&(this.effect2.skeletonData=t,this.effect2.setAnimation(0,PlayerAction.action,!0))}.bind(this))}this.effect2&&(this.effect2.node.active=!0)}else this.effect2&&(this.effect2.node.active=!1)}},setStatus:function(t){this.status=t,this.root_wnd&&(3==this.status?(this.get.active=!0,this.effect2&&(this.effect2.node.active=!1),this.effect_node&&(this.effect_node.active=!1)):this.get&&(this.get.active=!1),2==this.status?this.effect_node&&(this.effect_node.active=!0):this.effect_node&&(this.effect_node.active=!1))},setSelect:function(t){this.isSelect=t,this.root_wnd&&(this.select.active=!!t)},addCallBack:function(t){this.callback=t},onShow:function(t){},onHide:function(){},onDelete:function(){this.effect&&(this.effect.setToSetupPose(),this.effect.clearTracks()),this.effect2&&(this.effect2.setToSetupPose(),this.effect2.clearTracks()),this.effect2=null}});cc._RF.pop()},{pathtool:"pathtool",string_util:"string_util"}],action_seven_login_window:[function(t,e,i){"use strict";cc._RF.push(e,"849e55TWYpI3LI6fr1Kjmqa","action_seven_login_window");var s=t("pathtool"),n=t("common_scrollview"),a=t("action_event");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("action","action_seven_login_window"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Big,this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){this.day_list=[],this.cur_select=null,this.cur_index=null},openCallBack:function(){this.bigbackground=this.root_wnd.getChildByName("background"),this.bigbackground.scale=2*FIT_SCALE,this.background=this.bigbackground.getComponent(cc.Sprite),this.loadRes(s.getBigBg("action_bigbg_2","jpg","action"),function(t){this.background.spriteFrame=t}.bind(this)),this.main_panel=this.root_wnd.getChildByName("main_panel"),this.container=this.main_panel.getChildByName("container"),this.close_btn=this.main_panel.getChildByName("close_btn"),1==USE_SDK&&"QQ_SDK"==PLATFORM_TYPR?this.close_btn.x=-312:this.close_btn.x=312,this.model_icon_node=this.main_panel.getChildByName("model_icon"),this.model_icon_node.scale=2,this.model_icon=this.model_icon_node.getComponent(cc.Sprite),this.title_node=this.main_panel.getChildByName("title"),this.title_node.scale=2,this.title=this.title_node.getComponent(cc.Sprite),this.btn=this.container.getChildByName("btn"),this.btn.name="get_btn",this.btn_label=this.btn.getChildByName("Label").getComponent(cc.Label),this.btn_label.string=Utils.TI18N("\u9886\u53d6"),this.btn_out_line=this.btn.getChildByName("Label").getComponent(cc.LabelOutline),this.day_label=this.container.getChildByName("day_label").getComponent(cc.Label),this.day_label.node.zIndex=21,this.day_bg=this.container.getChildByName("day_bg"),this.day_bg.zIndex=20,this.seven_con=this.container.getChildByName("seven_con");for(var e=t("action_seven_login_item_panel"),i=1;i<=7;i++){var a=this.seven_con.getChildByName("day"+i),o=new e;o.setParent(a),o.setData(i),o.show(),this.day_list[i]=o,o.addCallBack(function(t){this.selectByIndex(t)}.bind(this,i))}this.goods_con=this.container.getChildByName("goods_con");var l=this.goods_con.getContentSize();this.item_scrollview=new n,this.item_scrollview.createScroll(this.goods_con,cc.v2(-this.goods_con.getContentSize().width/2,2),ScrollViewDir.horizontal,ScrollViewStartPos.top,l,{item_class:"backpack_item",start_x:10,space_x:15,start_y:2,space_y:4,item_width:120,item_height:120,row:1,col:0}),this.ctrl.cs21100()},selectByIndex:function(e,i){if(this.cur_index!=e||i){this.index=e,null!=this.cur_select&&this.cur_select.setSelect(!1),this.cur_index=e,this.cur_select=this.day_list[e],this.cur_select.setSelect(!0);var n=s.getBigBg("action_seven_bg1",null,"action"),a=s.getBigBg("txt_cn_action_seven_login_title1",null,"action");if(e<=2)n=s.getBigBg("action_seven_bg1",null,"action"),a=s.getBigBg("txt_cn_action_seven_login_title1",null,"action");else n=s.getBigBg("action_seven_bg2",null,"action"),a=s.getBigBg("txt_cn_action_seven_login_title2",null,"action");this.loadRes(n,function(t){this.model_icon.spriteFrame=t}.bind(this)),this.loadRes(a,function(t){this.title.spriteFrame=t}.bind(this));var o=t("string_util");this.day_label.string=Utils.TI18N("\u7b2c")+o.numToChinese(e)+Utils.TI18N("\u5929");var l=[],r=Config.login_days_data.data_day[e].spec_reward,c=[];if(r)for(var _ in r)c[r[_]]||(c[r[_]]={effect_id:r[_]});for(var _ in Config.login_days_data.data_day[e].rewards){var h=Config.login_days_data.data_day[e].rewards[_],d={};(d=Utils.deepCopy(Utils.getItemConfig(h[0])))&&(d.bid=d.id,d.show_effect=c[h[0]],d.num=h[1],l.push(d))}2==this.day_list[this.index].status?(this.btn.getComponent(cc.Button).interactable=!0,this.btn.getComponent(cc.Button).enableAutoGrayEffect=!1,null!=this.btn_out_line&&(this.btn_out_line.color=new cc.Color(196,90,20,255),this.btn_out_line.width=2)):(this.btn.getComponent(cc.Button).interactable=!1,this.btn.getComponent(cc.Button).enableAutoGrayEffect=!0,null!=this.btn_out_line&&(this.btn_out_line.width=0)),this.item_scrollview.setData(l),this.item_scrollview.addEndCallBack(function(){var t=this.item_scrollview.getItemList();for(var e in t){var i=t[e];i.setDefaultTip(),i.data&&i.data.show_effect?i.data.quality>=4?i.showItemEffect(!0,263,PlayerAction.action_1,!0,1.1):i.showItemEffect(!0,263,PlayerAction.action_2,!0,1.1):i.showItemEffect(!1)}}.bind(this))}},registerEvent:function(){Utils.onTouchEnd(this.close_btn,function(){this.ctrl.openSevenLoginWin(!1)}.bind(this),2),Utils.onTouchEnd(this.btn,function(){this.day_list[this.index]&&(2==this.day_list[this.index].status?(this.ctrl.cs21101(this.index),this.btn.getComponent(cc.Button).interactable=!0,this.btn.getComponent(cc.Button).enableAutoGrayEffect=!1,this.btn_out_line.color=new cc.Color(196,90,20,255),this.btn_out_line.width=2):3==this.day_list[this.index].status?(this.btn.getComponent(cc.Button).interactable=!1,this.btn.getComponent(cc.Button).enableAutoGrayEffect=!0,this.btn_out_line.width=0,message(Utils.TI18N("\u5df2\u7ecf\u9886\u53d6\u8fc7\u5566"))):1==this.day_list[this.index].status&&(this.btn.getComponent(cc.Button).interactable=!1,this.btn.getComponent(cc.Button).enableAutoGrayEffect=!0,this.btn_out_line.width=0,message(Utils.TI18N("\u672a\u5230\u5929\u6570"))))}.bind(this),1),this.addGlobalEvent(a.UPDATE_SEVEN_LOGIN_STATUS,function(t){if(t.status_list){for(var e in t.status_list)this.day_list[t.status_list[e].day].setStatus(t.status_list[e].status);this.now_day=Math.min(t.status_list.length+1,7);var i=this.getMinGetDay(t.status_list);this.selectByIndex(i,!0)}}.bind(this)),this.addGlobalEvent(a.UPDATE_SEVEN_LOGIN_REWARDS,function(t){}.bind(this))},getMinGetDay:function(t){var e=this.now_day;for(var i in t){if(1==t[i].day&&2==t[i].status)return 1;t[i].day<e&&2==t[i].status&&(e=t[i].day)}return e},openRootWnd:function(t){},closeCallBack:function(){for(var t in this.item_scrollview&&this.item_scrollview.deleteMe(),this.item_scrollview=null,this.day_list)this.day_list[t]&&this.day_list[t].deleteMe();this.day_list=null,this.ctrl.openSevenLoginWin(!1)}});cc._RF.pop()},{action_event:"action_event",action_seven_login_item_panel:"action_seven_login_item_panel",common_scrollview:"common_scrollview",pathtool:"pathtool",string_util:"string_util"}],action_sub_tab_vo:[function(t,e,i){"use strict";cc._RF.push(e,"30377eMilNDnq0DCf75jmSx","action_sub_tab_vo");var s=cc.Class({extends:gcore.BaseEvent,ctor:function(){this.bid=0,this.sort_val=0,this.title="",this.ico="",this.type_ico=0,this.panel_type=0,this.is_show_in_action=!0,this.reward_title="",this.aim_title="",this.title2="",this.top_banner="",this.rule_str="",this.time_str="",this.bottom_alert="",this.channel_ban="",this.remain_sec=0,this.cli_type=0,this.cli_type_name="",this.camp_id=0,this.tips_status=!1},update:function(t){if(t)for(var e in t)this.setParam(e,t[e])},setShowStatus:function(t){this.is_show_in_action=t},isShowInAction:function(){return this.is_show_in_action},setParam:function(t,e){this[t]!=e&&(this[t]=e)},updateTime:function(){this.remain_sec--},setTipsStatus:function(t){this.tips_status=0!=stauts,this.fire(s.UPDATE_TIPS_STATUS)},_delete:function(){}});s.UPDATE_TIPS_STATUS="ActionSubTabVo.UPDATE_TIPS_STATUS",e.exports=s,cc._RF.pop()},{}],action_time_gift_big_window:[function(t,e,i){"use strict";cc._RF.push(e,"0ec11gr+ORDlZ/zaTYnew0a","action_time_gift_big_window");var s=t("pathtool"),n=t("action_event"),a=t("action_time_gift_item");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("action","action_time_gift_big_window"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Big,this.ctrl=arguments[0]},initConfig:function(){this.pageItem={}},openCallBack:function(){this.pageView=this.seekChild("PageView",cc.PageView),this.btn_close=this.seekChild("btn_close"),this.left_btn=this.seekChild("left_btn"),this.right_btn=this.seekChild("right_btn"),this.indicator=this.seekChild("indicator",cc.PageViewIndicator),this.loadRes(s.getUIIconPath("timegiftbig","time_gift_big_2"),function(t){this.left_btn.getComponent(cc.Sprite).spriteFrame=t,this.right_btn.getComponent(cc.Sprite).spriteFrame=t}.bind(this)),this.loadRes(s.getUIIconPath("timegiftbig","time_gift_big_1"),function(t){this.indicator.spriteFrame=t}.bind(this)),this.indicator._changedState=function(){var t=this,e=this.indicator._indicators;if(0!==e.length){var i=this.pageView._curPageIdx;if(!(i>=e.length)){var n=0;if(!(e.length<=1))for(var a=function(a){var o=e[a];n=n,t.loadRes(s.getUIIconPath("timegiftbig","time_gift_big_0"),function(t){n++,o.getComponent(cc.Sprite).spriteFrame=t,n==e.length&&this.loadRes(s.getUIIconPath("timegiftbig","time_gift_big_1"),function(t){e[i].getComponent(cc.Sprite).spriteFrame=t}.bind(this))}.bind(t))},o=0;o<e.length;++o)a(o)}}}.bind(this)},registerEvent:function(){this.pageView.node.off("touchstart",this.pageView._onTouchBegan,this.pageView,!0),this.pageView.node.off("touchmove",this.pageView._onTouchMoved,this.pageView,!0),this.pageView.node.off("touchend",this.pageView._onTouchEnded,this.pageView,!0),this.pageView.node.off("touchcancel",this.pageView._onTouchCancelled,this.pageView,!0),this.pageView.node.on("page-turning",this.scrollEnded,this),this.left_btn.on("click",function(){Utils.playButtonSound(1);var t=this.pageView.getCurrentPageIndex();0!=t&&this.pageView.setCurrentPageIndex(t-1)},this),this.right_btn.on("click",function(){Utils.playButtonSound(1);var t=this.pageView.getCurrentPageIndex();t!=this.pageView.getPages().length-1&&this.pageView.setCurrentPageIndex(t+1)},this),this.btn_close.on("click",function(){Utils.playButtonSound(2),this.ctrl.openTriggerGiftWindow(!1)},this),this.addGlobalEvent(n.TRIGGER_GIFT_EVENT,function(t){this.setData(t)}.bind(this)),this.ctrl.sender21220()},scrollEnded:function(){var t=this.pageView.getCurrentPageIndex(),e=this.pageView.getPages().length-1;0==t?(this.left_btn.active=!1,this.right_btn.active=!0):t==e?(this.left_btn.active=!0,this.right_btn.active=!1):(this.left_btn.active=!0,this.right_btn.active=!0)},openRootWnd:function(t){},setButtonState:function(){1==this.data.length&&(this.left_btn.active=!1,this.right_btn.active=!1,this.indicator.node.active=!1)},setData:function(t){if(null==this.data&&(this.left_btn.active=!1,this.right_btn.active=!0),this.data)for(var e=0;e<this.data.length;++e){for(var i=this.data[e],s=!1,n=0;n<t.gifts.length;++n)if(i.id==t.gifts[n].id){s=!0;break}if(0==s){var o=Config.tri_gift_data.data_limit_gift[i.id];i.num=o.limit_num,t.gifts.push(i)}}this.data=t.gifts,this.setButtonState();for(var l=0;l<t.gifts.length;++l){var r=t.gifts[l],c=this.pageItem[r.id];null==c&&((c=new a).setParent(this.pageView.content),c.show(),c.addCallFunc(function(t){this.pageView._pages.push(t.root_wnd),this.pageView._updatePageView()}.bind(this)),this.pageItem[r.id]=c),c.setPosition(720*l,0),c.setData(r)}this.pageView.content.width=720*t.gifts.length},closeCallBack:function(){if(this.pageItem){for(var t in this.pageItem)this.pageItem[t]&&(this.pageItem[t].deleteMe(),this.pageItem[t]=null);this.pageItem=null}this.ctrl.openTriggerGiftWindow(!1)}});cc._RF.pop()},{action_event:"action_event",action_time_gift_item:"action_time_gift_item",pathtool:"pathtool"}],action_time_gift_item:[function(t,e,i){"use strict";cc._RF.push(e,"5eb4e8Vy5dIzZW42xAX+Xy4","action_time_gift_item");var s=t("pathtool"),n=t("timetool");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("action","action_time_gift_big_panel")},initConfig:function(){this.itemArr=[]},initPanel:function(){var t=this.seekChild("bg",cc.Sprite);this.loadRes(s.getBigBg("action/action_time_gift_bg"),function(e){t.spriteFrame=e}.bind(this));var e=this.seekChild("text",cc.Sprite);this.loadRes(s.getUIIconPath("timegiftbig","time_gift_big_text_1"),function(t){e.spriteFrame=t}.bind(this));var i=this.seekChild("jia",cc.Sprite);this.loadRes(s.getUIIconPath("timegiftbig","time_gift_big_text_jia"),function(t){i.spriteFrame=t}.bind(this));var n=this.seekChild("timegiftbig_percent",cc.Sprite);this.loadRes(s.getUIIconPath("timegiftbig","timegiftbig_percent"),function(t){n.spriteFrame=t}.bind(this)),this.num_lb=this.seekChild("num",cc.Label),this.rmb_lb=this.seekChild("Label",cc.Label),this.buyCount_lb=this.seekChild("text",cc.Label),this.buy_btn=this.seekChild("buy_btn",cc.Button),this.goods_list=this.seekChild("goods_list",cc.Layout),this.time_lb=this.seekChild("time",cc.Label),this.data&&this.setData(this.data)},registerEvent:function(){this.buy_btn.node.on("click",function(){var t=Config.tri_gift_data.data_limit_gift[this.data.id],e=Config.charge_data.data_charge_data[t.package_id||0];e&&SDK.pay(e.val,null,e.id,e.name,e.name)}.bind(this))},onShow:function(t){},setData:function(t){if(this.data=t,this.root_wnd){var e=Config.tri_gift_data.data_limit_gift[t.id];if(e){if(this.buyCount_lb.string=Utils.TI18N(cc.js.formatStr("\u9650\u8d2d\uff1a%d/%d",t.num,e.limit_num)),0==this.itemArr.length){this.loadRes(s.getUIIconPath("timegiftbig","time_gift_big_num","labelatlas"),function(t){this.num_lb.font=t,this.num_lb.string=e.desc}.bind(this));var i=Config.charge_data.data_charge_data[e.package_id];i&&(this.rmb_lb.string=Utils.TI18N(i.val+"\u5143"));var n,a=e.reward;a.length>4?(n=.8,this.goods_list.type=cc.Layout.Type.GRID,this.goods_list.spacingX=20,this.goods_list.spacingY=15,this.goods_list.node.width=450):(n=.9,this.goods_list.type=cc.Layout.Type.HORIZONTAL,this.goods_list.node.width=0,this.goods_list.spacingX=8),this.setLessTime(),this.time_ticket=gcore.Timer.set(function(){this.setLessTime()}.bind(this),1e3,-1),this.updateItem=this.startUpdate(a.length,function(t){var e=new cc.Node;e.setContentSize(120*n,120*n),this.goods_list.node.addChild(e);var i=ItemsPool.getInstance().getItem("backpack_item");i.initConfig(!1,n,!1,!0),i.setParent(e),i.show(),i.setData({bid:a[t][0],num:a[t][1]}),this.itemArr.push(i)}.bind(this)),this.item_callback&&this.item_callback(this)}t.num>=e.limit_num&&(this.buy_btn.interactable=!1,this.buy_btn.enableAutoGrayEffect=!0,this.rmb_lb.node.getComponent(cc.LabelOutline).enabled=!1)}}},onHide:function(){},setLessTime:function(){var t=this.data.end_time-gcore.SmartSocket.getTime();t<=0&&(t=0,this.time_ticket&&(gcore.Timer.del(this.time_ticket),this.time_ticket=null,this.buy_btn.interactable=!1,this.buy_btn.enableAutoGrayEffect=!0,this.rmb_lb.node.getComponent(cc.LabelOutline).enabled=!1));var e=n.getTimeForFunction(t);this.time_lb.string=Utils.TI18N(e+"\u540e\u793c\u5305\u6d88\u5931")},addCallFunc:function(t){this.item_callback=t},onDelete:function(){if(this.time_ticket&&(gcore.Timer.del(this.time_ticket),this.time_ticket=null),this.updateItem&&(gcore.Timer.del(this.updateItem),this.updateItem=null),this.itemArr){for(var t=0;t<this.itemArr.length;++t)this.itemArr[t]&&(this.itemArr[t].deleteMe(),this.itemArr[t]=null);this.itemArr=null}}});cc._RF.pop()},{pathtool:"pathtool",timetool:"timetool"}],action_time_shop_item:[function(t,e,i){"use strict";cc._RF.push(e,"a9284mwZEtASK0iHOwYM03K","action_time_shop_item");var s=t("pathtool"),n=t("common_scrollview");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("welfare","week_month_panel_item")},initConfig:function(){this.touch_buy_limit_shop=!0},initPanel:function(){this.has_get=this.seekChild("has_get"),this.btn_charge=this.seekChild("btn_charge"),this.charge_price_lb=this.seekChild("Text_4_0",cc.Label),this.text_remian_lb=this.seekChild("Text_4",cc.Label);var t=this.seekChild("good_cons"),e=t.getContentSize();this.good_scrollview=new n,this.good_scrollview.createScroll(t,cc.v2(0,0),ScrollViewDir.horizontal,ScrollViewStartPos.top,e,{item_class:"backpack_item",start_x:3,space_x:5,start_y:4,space_y:4,item_width:96,item_height:96,row:1,col:0,scale:.8},cc.v2(.5,.5))},registerEvent:function(){Utils.onTouchEnd(this.btn_charge,function(){if(this.touch_buy_limit_shop&&(null==this.buy_limit_shop_ticket&&(this.buy_limit_shop_ticket=gcore.Timer.set(function(){this.touch_buy_limit_shop=!0,null!=this.buy_limit_shop_ticket&&(gcore.Timer.del(this.buy_limit_shop_ticket),this.buy_limit_shop_ticket=null)}.bind(this),2e3,1)),this.touch_buy_limit_shop=null,this.data&&this.data.aim)){var t=Config.charge_data.data_charge_data[this.data.aim];t&&SDK.pay(t.val,null,t.id,t.name,t.name,null,null)}}.bind(this),1)},setData:function(t){this.data=t,this.root_wnd&&this.onShow()},onShow:function(){if(null!=this.data){var t=this.data,e=[];for(var i in t.item_list){var s=t.item_list[i],n={};n.bid=s.bid,n.num=s.num,e.push(n)}if(this.good_scrollview.setData(e),this.good_scrollview.addEndCallBack(function(){var t=this.good_scrollview.getItemList();for(var e in t)t[e]&&t[e].setDefaultTip()}.bind(this)),2==t.status)this.btn_charge.active=!1,this.text_remian_lb.node.active=!1,this.has_get.active=!0;else{this.btn_charge.active=!0,this.text_remian_lb.node.active=!0,this.has_get.active=!1;var a=0,o=0,l=0;for(var i in t.aim_args){2==(s=t.aim_args[i]).aim_args_key?a=s.aim_args_val:6==s.aim_args_key?o=s.aim_args_val:27==s.aim_args_key&&(l=s.aim_args_val)}this.text_remian_lb.string=cc.js.formatStr(Utils.TI18N("\u5269\u4f59:%s"),a-o),this.charge_price_lb.string=cc.js.formatStr(Utils.TI18N("%s\u5143"),l)}}},onHide:function(){},onDelete:function(){this.good_scrollview&&(this.good_scrollview.deleteMe(),this.good_scrollview=null),null!=this.buy_limit_shop_ticket&&(gcore.Timer.del(this.buy_limit_shop_ticket),this.buy_limit_shop_ticket=null)}});cc._RF.pop()},{common_scrollview:"common_scrollview",pathtool:"pathtool"}],action_time_shop_panel:[function(t,e,i){"use strict";cc._RF.push(e,"93bbc4tBABIt6Rq0yLh52TC","action_time_shop_panel");var s=t("pathtool"),n=t("action_controller"),a=t("action_time_shop_item"),o=t("common_scrollview"),l=t("action_event");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("welfare","week_month_panel")},initConfig:function(){this.ctrl=n.getInstance()},initPanel:function(){this.btn_rule=this.seekChild("btn_rule"),this.btn_rule.active=!1,this.remain_time_lb=this.seekChild("remain_time",cc.Label),this.remain_time_lb.string="";var t=this.seekChild("good_cons"),e=t.getContentSize(),i={item_class:a,start_x:0,space_x:0,start_y:0,space_y:0,item_width:688,item_height:136,row:0,col:1,need_dynamic:!0};this.child_scrollview=new o,this.child_scrollview.createScroll(t,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,e,i,cc.v2(.5,.5))},registerEvent:function(){this.addGlobalEvent(l.UPDATE_HOLIDAY_SIGNLE,function(t){t.bid==this.holiday_bid&&(this.ctrl.getModel().setCountDownTime(this.remain_time_lb,t.remain_sec),this.setLimitShopData(t))},this)},setLimitShopData:function(t){for(var e=[],i=0;i<t.aim_list.length;++i){var s=t.aim_list[i],n=Utils.keyfind("aim_args_key",39,s.aim_args)||null;if(n){var a=n.aim_args_val;2==s.status&&(a=5),s.sort_id=a,e.push(s)}}if(null==Utils.next(e)){var o=function(t,e){if(t.status==e.status){var i=0,s=0;for(var n in t.aim_args){27==(a=t.aim_args[n]).aim_args_key&&(i=a.aim_args_val)}for(var n in e.aim_args){var a;27==(a=e.aim_args[n]).aim_args_key&&(s=a.aim_args_val)}return i-s}return t.status<e.status?-1:1}.bind(this);t.aim_list.sort(o),this.child_scrollview.setData(t.aim_list)}else e.sort(function(t,e){return t.sort_id-e.sort_id}),this.child_scrollview.setData(e)},onShow:function(t){this.holiday_bid=t.bid,this.ctrl.cs16603(this.holiday_bid),this.loadBannerImage()},loadBannerImage:function(){var t=this.seekChild("sprite_title",cc.Sprite),e="txt_cn_welfare_banner22",i=this.ctrl.getActionSubTabVo(this.holiday_bid);i&&""!=i.reward_title&&i.reward_title&&(e=i.reward_title);var n=s.getWelfareBannerRes(e);this.loadRes(n,function(e){t.spriteFrame=e}.bind(this))},setVisibleStatus:function(t){t=t||!1,this.setVisible(t)},onHide:function(){},onDelete:function(){this.child_scrollview&&(this.child_scrollview.deleteMe(),this.child_scrollview=null)}});cc._RF.pop()},{action_controller:"action_controller",action_event:"action_event",action_time_shop_item:"action_time_shop_item",common_scrollview:"common_scrollview",pathtool:"pathtool"}],action_time_summon_panel:[function(t,e,i){"use strict";cc._RF.push(e,"9c0138j0WVGHa8i965vYoCW","action_time_summon_panel");var s=t("pathtool"),n=t("timesummon_event"),a=t("timesummon_controller"),o=t("backpack_controller"),l=t("timetool"),r=t("backpack_const"),c=(t("hero_controller"),t("role_controller")),_=t("partnersummon_event"),h=t("partnersummon_controller"),d=t("mainui_controller"),u=t("backpack_event"),m=t("action_const");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("action","action_time_summon_panel");var t=Config.recruit_holiday_data.data_const.common_s;this.ctrl=a.getInstance(),t&&(this.summon_item_bid=t.val)},initConfig:function(){this._summon_type_1=1,this._summon_type_10=3,this.role_vo=c.getInstance().getRoleVo(),this.arard_data=Config.recruit_holiday_data.data_award},initPanel:function(){var t=this.getPositionX();this.setPosition(t,-20);var e=this.root_wnd.getChildByName("main_container");this.image_bg_sp=e.getChildByName("image_bg").getComponent(cc.Sprite),this.progress_txt=e.getChildByName("progress_txt").getComponent(cc.Label),this.item_num_txt=e.getChildByName("item_num_txt").getComponent(cc.Label),this.progress=e.getChildByName("progress").getComponent(cc.ProgressBar),this.baodi_bg=e.getChildByName("baodi_bg"),this.award_btn=e.getChildByName("award_btn"),this.award_btn.getChildByName("label").getComponent(cc.Label).string=Utils.TI18N("\u5956\u52b1\u9884\u89c8"),this.preview_btn=e.getChildByName("preview_btn"),this.preview_btn.getChildByName("label").getComponent(cc.Label).string=Utils.TI18N("\u6218\u6597\u9884\u89c8"),this.summon_btn_1=e.getChildByName("summon_btn_1"),this.summon_btn_1.getChildByName("label").getComponent(cc.Label).string=Utils.TI18N("\u62db\u52df1\u6b21"),this.summon_txt_1_rt=this.summon_btn_1.getChildByName("summon_txt_1").getComponent(cc.RichText),this.summon_prop_1_nd=this.summon_btn_1.getChildByName("summon_prop"),this.summon_prop_num_lb=this.summon_prop_1_nd.getChildByName("summon_prop_num").getComponent(cc.Label);var i=Utils.getItemConfig(this.summon_item_bid),n=s.getItemRes(i.icon);this.loadRes(n,function(t){this.summon_prop_1_nd.getChildByName("summon_prop_item").getComponent(cc.Sprite).spriteFrame=t,e.getChildByName("item_icon").getComponent(cc.Sprite).spriteFrame=t}.bind(this)),this.summon_btn_10=e.getChildByName("summon_btn_10"),this.summon_btn_10.getChildByName("label").getComponent(cc.Label).string=Utils.TI18N("\u62db\u52df10\u6b21"),this.summon_prop_10_nd=this.summon_btn_10.getChildByName("summon_prop"),this.summon_prop_sp=this.summon_prop_10_nd.getChildByName("summon_prop_item").getComponent(cc.Sprite),this.summon_10_num_lb=this.summon_prop_10_nd.getChildByName("summon_prop_num").getComponent(cc.Label),this.time_txt=e.getChildByName("time_txt").getComponent(cc.Label),this.baodi_text_rt=this.seekChild("baodi_text",cc.RichText),this.award_item=ItemsPool.getInstance().getItem("backpack_item"),this.award_item.setParent(e),this.award_item.setPosition(60,728),this.award_item.initConfig(!1,.6,!1,!1),this.award_item.show(),this.award_item.addCallBack(this._onClickAwardItem.bind(this))},registerEvent:function(){this.addGlobalEvent(n.Update_Summon_Data_Event,function(t){this.setData(t)},this),this.addGlobalEvent(_.PartnerSummonSuccess,function(){this.playRecruitEffect()}.bind(this)),this.addGlobalEvent(u.ADD_GOODS,function(t,e){this.updateItemNum(t,e)}.bind(this)),this.addGlobalEvent(u.DELETE_GOODS,function(t,e){this.updateItemNum(t,e)}.bind(this)),this.addGlobalEvent(u.MODIFY_GOODS_NUM,function(t,e){this.updateItemNum(t,e)}.bind(this)),this.preview_btn.on("click",function(){this.ctrl.send23219(m.ActionRankCommonType.time_summon)},this),this.summon_btn_1.on("click",function(){if(Utils.playButtonSound(1),!(this.checkHeroBagIsFull(1)||(cc.log(this.last_time,gcore.SmartSocket.getTime()),this.last_time&&gcore.SmartSocket.getTime()-this.last_time<2)))if(this.last_time=gcore.SmartSocket.getTime(),3==this._summon_type_1&&this.config){var t=this.config.loss_gold_once[0][1],e=Utils.getItemConfig(this.config.loss_gold_once[0][0]).icon,i=Utils.getItemConfig(this.config.gain_once[0][0]).name||"",s=this.config.gain_once[0][1];this.showGoldTips(e,t,1,s,i,function(){this.ctrl.requestTimeSummon(1,this._summon_type_1)})}else this.ctrl.requestTimeSummon(1,this._summon_type_1)},this),this.summon_btn_10.on("click",function(){if(Utils.playButtonSound(1),!(this.checkHeroBagIsFull(10)||this.last_time&&Math.abs(gcore.SmartSocket.getTime()-this.last_time)<.5))if(this.last_time=gcore.SmartSocket.getTime(),3==this._summon_type_10&&this.config){var t=this.config.loss_gold_ten[0][1],e=Utils.getItemConfig(this.config.loss_gold_ten[0][0]).icon,i=Utils.getItemConfig(this.config.gain_ten[0][0]).name||"",s=this.config.gain_ten[0][1];this.showGoldTips(e,t,10,s,i,function(){this.ctrl.requestTimeSummon(10,this._summon_type_10)})}else this.ctrl.requestTimeSummon(10,this._summon_type_10)},this),this.award_btn.on("click",function(){this.ctrl.openTimeSummonAwardView(!0,this.config.group_id,this.data)},this)},_onClickAwardItem:function(){this.data&&(this.is_can_award?this.ctrl.requestSummonGetAward():this.ctrl.openTimeSummonProgressView(!0,this.data.times,this.data.camp_id))},checkHeroBagIsFull:function(e){var i=t("hero_controller").getInstance().getModel().getHeroMaxCount();if(e>i.max_count-i.have_coutn){var s=Utils.TI18N("\u82f1\u96c4\u5217\u8868\u5df2\u6ee1\uff0c\u53ef\u901a\u8fc7\u63d0\u5347\u8d35\u65cf\u7b49\u7ea7\u6216\u8d2d\u4e70\u589e\u52a0\u82f1\u96c4\u643a\u5e26\u6570\u91cf\uff0c\u662f\u5426\u524d\u5f80\u8d2d\u4e70\uff1f");return t("commonalert").show(s,Utils.TI18N("\u786e\u5b9a"),function(){var e=t("mainui_const"),i=t("action_controller");d.getInstance().changeMainUIStatus(e.btn_index.partner),i.getInstance().openActionMainPanel(!1)},Utils.TI18N("\u53d6\u6d88"),function(){}),!0}return!1},onShow:function(t){this.ctrl.requestTimeSummonData()},setVisibleStatus:function(t){this.root_wnd&&t&&this.ctrl.requestTimeSummonData(),t=t||!1,this.setVisible(t)},setData:function(t){if(t){this.data=t;var e=Config.recruit_holiday_data.data_action[this.data.camp_id];e&&e.group_id&&(this.config=Config.recruit_holiday_data.data_summon[e.group_id]),this.time_txt.string=l.getMD2(this.data.start_time)+"~"+l.getMD2(this.data.end_time),this.nextRewardLevel(),this.updateImageBg(),this.updateSummonBtnStatus(),this.updateItemNum(),this.updateBaodiCount()}},nextRewardLevel:function(){var t=this.nextCount(this.data.times);if(this.arard_data[this.data.camp_id]&&this.arard_data[this.data.camp_id][t]){var e=this.arard_data[this.data.camp_id],i=!1;if(this.award_item){var s=e[t].reward[0][0],n=e[t].reward[0][1];this.award_item.setData({bid:s,num:n});var a=this.getBaoDIStatus();this.is_can_award=a.status;var o=a.id;if(1==this.is_can_award){if(o){var l=e[o].reward[0][0],r=e[o].reward[0][1];this.award_item.setData({bid:l,num:r})}this.award_item.showItemEffect(!0,263,PlayerAction.action_1,!0,1.1)}else this.award_item.showItemEffect(!1);0==this.is_can_award&&this.data.times>=e[Utils.getArrLen(e)].times&&(this.award_item.setReceivedIcon(!0),i=!0)}var c=e[t].times,_="";_=i?Utils.TI18N("\u62db\u52df\u6b21\u6570 ")+this.data.times+"/"+c:Utils.TI18N("\u4e0b\u4e00\u9636\u6bb5 ")+this.data.times+"/"+c,this.progress_txt.string=_;var h=0,d=c;1==t?h=this.data.times:(h=this.data.times-e[t-1].times,d=c-e[t-1].times);var u=h/d;this.data.times>=e[Utils.getArrLen(e)].times&&(u=1),this.progress.progress=u}},nextCount:function(t){var e=1,i=this.arard_data[this.data.camp_id];if(this.arard_data&&i){var s=Utils.getArrLen(i);if(t>=i[s].times)return i[s].id;for(var n in i){var a=n+1;if(a>=s&&(a=s),i[n].times>t&&t<=i[a].times){e=i[n].id;break}}}return e},getBaoDIStatus:function(){var t=!1,e=null;if(this.data&&this.arard_data[this.data.camp_id])for(var i in this.arard_data[this.data.camp_id]){var s=this.arard_data[this.data.camp_id][i],n=!1,a=null;this.data.times>=s.times&&(n=!0,a=s.id);var o=!0;if(1==n)for(var l=0;l<this.data.reward_list.length;++l){if(this.data.reward_list[l].id==a){o=!1;break}}a&&1==o&&(t=!0,e=a)}return{status:t,id:e}},updateImageBg:function(){if(this.config&&this.config.res_id&&(!this.cur_res_id||this.cur_res_id!=this.config.res_id)){var t=s.getBigBg("timesummon/txt_cn_timesummon_bigbg_"+this.config.res_id,"jpg");this.loadRes(t,function(t){this.image_bg_sp.spriteFrame=t}.bind(this)),this.cur_res_id=this.config.res_id}},updateSummonBtnStatus:function(){if(this.data&&this.config&&this.summon_item_bid){var t=o.getInstance().getModel().getItemNumByBid(this.summon_item_bid),e=gcore.SmartSocket.getTime();if(0==this.data.free_time&&this.data.free_time<=e){var i=Utils.TI18N(StringUtil.parseStr("<div fontcolor=#ffffff>\u514d\u8d39\u53ec\u5524</div>").string);this._summon_type_1=1,this.openSummonFreeTimer(!1),this.summon_txt_1_rt.node.active=!0,this.summon_prop_1_nd.active=!1,this.summon_txt_1_rt.string=i}else t>=1?(this._summon_type_1=4,this.openSummonFreeTimer(!1),this.summon_txt_1_rt.node.active=!1,this.summon_prop_1_nd.active=!0,this.summon_prop_num_lb.string=t):this.data.free_time&&(this.left_time=this.data.free_time-e,this.summon_txt_1_rt.node.active=!0,this.summon_prop_1_nd.active=!1,this._summon_type_1=3,this.openSummonFreeTimer(!0));if(t>=10){var n=Utils.getItemConfig(this.summon_item_bid);if(n){var a=s.getItemRes(n.icon);this.summon_10_num_lb.string=t,this.summon_prop_sp.node.scale=.4,this.loadRes(a,function(t){this.summon_prop_sp.spriteFrame=t}.bind(this))}this._summon_type_10=4}else{var l=this.config.loss_gold_ten[0][0],r=this.config.loss_gold_ten[0][1],c=s.getItemRes(l);this.summon_prop_sp.node.scale=.3,this.loadRes(c,function(t){this.summon_prop_sp.spriteFrame=t}.bind(this)),this.summon_10_num_lb.string=r,this._summon_type_10=3}}},openSummonFreeTimer:function(t){t?this.left_time>0&&this.summon_txt_1_rt?this.summon_timer||(this.setTimeFormatString(),this.summon_timer=gcore.Timer.set(function(){this.setTimeFormatString()}.bind(this),1e3,-1)):this.summon_timer&&(gcore.Timer.del(this.summon_timer),this.summon_timer=null):null!=this.summon_timer&&(gcore.Timer.del(this.summon_timer),this.summon_timer=null)},setTimeFormatString:function(){this.data&&this.data.free_time-gcore.SmartSocket.getTime()>0?(this.left_time=this.data.free_time-gcore.SmartSocket.getTime(),this.summon_txt_1_rt.string=cc.js.formatStr(Utils.TI18N(StringUtil.parseStr("<div fontcolor=#35ff14>%s</div><div fontcolor=#ffffff>\u540e\u514d\u8d39</div>").string),l.getTimeFormat(this.left_time)),this._summon_type_1=3):(this.summon_txt_1_rt.string=Utils.TI18N(StringUtil.parseStr("<div fontcolor=#ffffff>\u514d\u8d39\u53ec\u5524</div>").string),this._summon_type_1=1,this.summon_timer&&(gcore.Timer.del(this.summon_timer),this.summon_timer=null))},updateProgress:function(){if(this.data&&this._cur_award_data&&null!=Utils.next(this._cur_award_data)){var t=this._cur_award_data.reward[0],e=t[0],i=t[1];this.award_item.setData({bid:e,num:i});var s=this.data.times/this._cur_award_data.times;this.progress.progress=s,this._award_is_over?(this.progress_txt.string=Utils.TI18N("\u62db\u52df\u6b21\u6570 ")+this.data.times+"/"+this._cur_award_data.times,this.award_item.setReceivedIcon(!0)):(this.progress_txt.string=Utils.TI18N("\u4e0b\u4e00\u9636\u6bb5 ")+this.data.times+"/"+this._cur_award_data.times,this.award_item.setReceivedIcon(!1)),1==this._can_get_award?this.award_item.showItemEffect(!0,263,PlayerAction.action_1,!0,1.1):this.award_item.showItemEffect(!1)}},updateItemNum:function(t,e){if(this.summon_item_bid)if(t&&e){if(t==r.Bag_Code.BACKPACK)for(var i in e){var s=e[i];if(s&&s.base_id&&this.summon_item_bid==s.base_id){var n=o.getInstance().getModel().getItemNumByBid(this.summon_item_bid);this.item_num_txt.string=n,this.updateSummonBtnStatus();break}}}else{var a=o.getInstance().getModel().getItemNumByBid(this.summon_item_bid);this.item_num_txt.string=a}},updateBaodiCount:function(){if(this.baodi_bg&&this.data)if(this.data.item_id&&0!=this.data.item_id){this.baodi_bg.active=!0,this.baodi_item||(this.baodi_item=ItemsPool.getInstance().getItem("backpack_item"),this.baodi_item.setParent(this.baodi_bg),this.baodi_item.initConfig(!1,.35,!1,!0),this.baodi_item.setPosition(-118,0),this.baodi_item.show()),this.cur_show_bid&&this.cur_show_bid==this.data.item_id||(this.baodi_item.setData({bid:this.data.item_id,num:this.data.item_num}),this.cur_show_bid=this.data.item_id);var t=this.data.must_count||0;this.baodi_text_rt.string=Utils.TI18N(cc.js.formatStr(StringUtil.parseStr("<div fontcolor=#ffffff outline=2,#000000>\u5269\u4f59</div><div fontcolor=#5fde46 outline=2,#000000>%d</div><div fontcolor=#ffffff outline=2,#000000>\u6b21\u62db\u52df\u5185\u5fc5\u51fa</div>").string,t))}else this.baodi_bg.active=!1},showGoldTips:function(e,i,n,a,o,l){this.alert&&(this.alert.close(),this.alert=null);var r=this.role_vo.gold,c=cc.js.formatStr(StringUtil.parseStr(Lang.DIAMOND_CONSUME).string,e,i,r)+cc.js.formatStr(StringUtil.parseStr(Lang.BUY_DES).string,a,o,n),_=[],h=s.getIconPath("item","3");_.push(h);var d=t("commonalert");this.alert=d.show(c,"\u786e\u5b9a",l.bind(this),"\u53d6\u6d88",null,null,null,{resArr:_,maxWidth:450,align:cc.macro.TextAlignment.LEFT})},playRecruitEffect:function(){if(null==this.summonBg){this.summonBg=(new cc.Node).addComponent(cc.Sprite),ViewManager.getInstance().addToSceneNode(this.summonBg.node,SCENE_TAG.dialogue),this.summonBg.node.scale=FIT_SCALE,this.summonBg.node.setPosition(0,0);var t="timesummon_bg";this.config&&this.config.res_id&&(t="timesummon_bg_"+this.config.res_id);var e=s.getBigBg("timesummon/"+t,"jpg");this.loadRes(e,function(t){this.summonBg.spriteFrame=t,this.summonBg.node.setContentSize(cc.size(720,1280))}.bind(this)),this.summonBg.node.on("touchend",function(){this.summonBg.node.active=!this.summonBg.node.active,this.floor_effect&&(this.floor_effect.paused=!0),this.book_effect&&(this.book_effect.paused=!0),this.light_effect&&(this.light_effect.paused=!0),this.animaComplete()},this)}else this.summonBg.node.active=!this.summonBg.node.active;var i=h.getInstance().getModel().getRecruitData(),n=this.ctrl.getModel().getEffectAction(i.rewards);this.floor_action=n[0],this.light_action=n[1];var a=Config.recruit_holiday_data.data_summon[i.group_id],o="action";a&&(o=a.action_name);var l="recruit_"+o;Utils.playEffectSound(AUDIO_TYPE.Recruit,l),this.handleFloorEffect(),this.handleLightEffect(),this.handleBookEffect(),d.getInstance().setMainUIBottomStatus(!1),d.getInstance().setMainUITopStatus(!1)},handleFloorEffect:function(){var t=this.floor_action||PlayerAction.action_1;if(this.summonBg&&null==this.floor_effect){this.floor_effect=(new cc.Node).addComponent(sp.Skeleton),this.summonBg.node.addChild(this.floor_effect.node),this.floor_effect.node.setPosition(0,-270);var e=s.getEffectRes("671"),i=s.getSpinePath(e,"action");this.loadRes(i,function(e){this.floor_effect.skeletonData=e,this.floor_effect.setAnimation(0,t)}.bind(this))}else this.floor_effect&&(this.floor_effect.setToSetupPose(),this.floor_effect.paused=!1,this.floor_effect.setAnimation(0,t))},handleLightEffect:function(){var t=this.light_action||PlayerAction.action_1;if(this.summonBg&&null==this.light_effect){this.light_effect=(new cc.Node).addComponent(sp.Skeleton),this.summonBg.node.addChild(this.light_effect.node),this.light_effect.node.setPosition(0,-240);var e=s.getEffectRes("670"),i=s.getSpinePath(e,"action");this.light_effect.setCompleteListener(this.animaComplete.bind(this)),this.loadRes(i,function(e){this.light_effect.skeletonData=e,this.light_effect.setAnimation(0,t)}.bind(this))}else this.light_effect&&(this.light_effect.setToSetupPose(),this.light_effect.paused=!1,this.light_effect.setAnimation(0,t))},handleBookEffect:function(){if(this.summonBg&&null==this.book_effect){this.book_effect=(new cc.Node).addComponent(sp.Skeleton),this.summonBg.node.addChild(this.book_effect.node),this.book_effect.node.setPosition(0,-240);var t=s.getEffectRes("672"),e=s.getSpinePath(t,"action");this.loadRes(e,function(t){this.book_effect.skeletonData=t,this.book_effect.setAnimation(0,PlayerAction.action)}.bind(this))}else this.book_effect&&(this.book_effect.setToSetupPose(),this.book_effect.paused=!1,this.book_effect.setAnimation(0,PlayerAction.action))},animaComplete:function(){cc.log("animaComplete"),this.summonBg.node.active=!1,d.getInstance().setMainUIBottomStatus(!0),d.getInstance().setMainUITopStatus(!0),t("partnersummon_controller").getInstance().openSummonGainWindow(!0)},onHide:function(){},onDelete:function(){this.summon_timer&&(gcore.Timer.del(this.summon_timer),this.summon_timer=null),this.award_item&&(this.award_item.deleteMe(),this.award_item=null),this.summonBg&&(this.summonBg.node.destroy(),this.summonBg=null)}});cc._RF.pop()},{action_const:"action_const",action_controller:"action_controller",backpack_const:"backpack_const",backpack_controller:"backpack_controller",backpack_event:"backpack_event",commonalert:"commonalert",hero_controller:"hero_controller",mainui_const:"mainui_const",mainui_controller:"mainui_controller",partnersummon_controller:"partnersummon_controller",partnersummon_event:"partnersummon_event",pathtool:"pathtool",role_controller:"role_controller",timesummon_controller:"timesummon_controller",timesummon_event:"timesummon_event",timetool:"timetool"}],action_treasure_get_window:[function(t,e,i){"use strict";cc._RF.push(e,"a6b61Eow+pIp7uN2xrFuuBr","action_treasure_get_window");var s=t("pathtool");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("augury","augury_get_window"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Mini,this.ctrl=arguments[0],this.model=this.ctrl.getModel(),this.data=arguments[1]||{},this.index=arguments[2]||1,this.touchTreasure_type=arguments[3]||2},initConfig:function(){this.cache_list=[],this.can_click=!1},openCallBack:function(){if(this.background=this.root_wnd.getChildByName("background"),this.background.scale=FIT_SCALE,this.main_panel=this.root_wnd.getChildByName("main_panel"),this.size=this.main_panel.getContentSize(),this.title_model=this.root_wnd.getChildByName("titlepanel"),this.close_sp=this.main_panel.getChildByName("close_sp"),this.scroll_view=this.main_panel.getChildByName("scroll_view"),this.scroll_view_compend=this.scroll_view.getComponent(cc.ScrollView),this.content=this.scroll_view.getChildByName("content"),1==this.touchTreasure_type||2==this.touchTreasure_type){this.btn_left=Utils.createImage(this.main_panel,null,-178,-304,cc.v2(.5,.5),!0,10,!0),this.btn_left.node.setContentSize(cc.size(130,64)),this.loadRes(s.getCommonIcomPath("common_1017"),function(t){this.btn_left.spriteFrame=t}.bind(this));Utils.createLabel(24,new cc.Color(255,255,255,255),new cc.Color(108,43,0,255),0,0,Utils.TI18N("\u786e\u5b9a"),this.btn_left.node,2,cc.v2(.5,.5));var t=cc.js.formatStr(Utils.TI18N("\u518d\u6765%d\u6b21"),Config.dial_data.data_const.treasure_num.val[this.index-1][this.touchTreasure_type-1]);this.btn_right=Utils.createImage(this.main_panel,null,178,-304,cc.v2(.5,.5),!0,0,!0),this.loadRes(s.getCommonIcomPath("common_1017"),function(t){this.btn_right.spriteFrame=t}.bind(this));var e=Utils.createLabel(24,new cc.Color(255,255,255,255),new cc.Color(108,43,0,255),0,0,"",this.btn_right.node,2,cc.v2(.5,.5));this.btn_right.node.setContentSize(cc.size(130,64)),e.string=t,this.close_sp.active=!1}else 3==this.touchTreasure_type&&(this.close_sp.active=!0);this.title_effect=this.title_model.getChildByName("title_container").getComponent(sp.Skeleton),this.handleEffect(!0),this.updatData()},registerEvent:function(){this.btn_left&&Utils.onTouchEnd(this.btn_left.node,function(){this.ctrl.openTreasureGetItemWindow(!1)}.bind(this),2),this.btn_right&&Utils.onTouchEnd(this.btn_right.node,function(){1==this.touchTreasure_type||2==this.touchTreasure_type?this.ctrl.send16643(this.index,this.touchTreasure_type):this.touchTreasure_type,this.ctrl.openTreasureGetItemWindow(!1)}.bind(this),2),3==this.touchTreasure_type&&Utils.onTouchEnd(this.background,function(){this.ctrl.openTreasureGetItemWindow(!1)}.bind(this),2)},handleEffect:function(t){if(0==t)this.title_effect&&(this.title_effect.setToSetupPose(),this.title_effect.clearTracks());else if(this.title_effect){var e=s.getSpinePath(Config.effect_data.data_effect_info[103],"action");this.loadRes(e,function(t){this.title_effect.skeletonData=t,this.title_effect.setAnimation(0,PlayerAction.action_1,!1)}.bind(this))}},updatData:function(){if(this.data&&null!=Utils.next(this.data)){var e=this.data,i=0,n=[];for(var a in this.space=20,this.ref_height=119,this.ref_width=119,e)n[i+=1]={bid:e[a].bid,num:e[a].num};this.row=Math.ceil(i/5),this.scroll_height=this.scroll_view.getContentSize().height,this.scroll_width=this.scroll_view.getContentSize().width;var o=this.space+(this.space+this.ref_height+45)*this.row;this.max_height=Math.max(o,this.scroll_height),this.content.setContentSize(cc.size(this.scroll_width,this.max_height));var l=i;l>=5&&(l=5);var r=l*this.ref_width+(l-1)*this.space,c=.5*(this.scroll_width-r);for(var a in this.action_effect=[],n)Utils.delayRun(this.main_panel,10*a/60,function(e,i){var n=function(t){this.action_effect[t]&&(this.action_effect[t].node.runAction(cc.removeSelf(!0)),this.action_effect[t]=null)}.bind(this,e),a=c+.5*this.ref_width+(e-1)%5*(this.ref_width+this.space),o=this.max_height-Math.floor((e-1)/5)*(this.ref_height+this.space+45)-this.ref_height/2-40;this.row<=1&&(o-=100);var l=Config.effect_data.data_effect_info[156],r=PlayerAction.action_3,_=new cc.Node;_.setAnchorPoint(.5,.5),_.setPosition(a,o),this.content.addChild(_,90),this.action_effect[e]=_.addComponent(sp.Skeleton),this.action_effect[e].setCompleteListener(n);var h=function(e,i){var s=e[i],n=ItemsPool.getInstance().getItem("backpack_item");n.initConfig(!1,1,!1,!0,!0),n.show(),n.setData(s);var a=Utils.getItemConfig(s.bid);if(a&&a.quality>=3){var o=PlayerAction.action_2;a.quality>=4&&(o=PlayerAction.action_1),n.showItemEffect(!0,156,o,!0)}if(a){var l=t("backpack_const").quality_color(a.quality);n.setExtendLabel(a.name,l,22)}var r=c+.5*this.ref_width+(i-1)%5*(this.ref_width+this.space),_=this.max_height-Math.floor((i-1)/5)*(this.ref_height+this.space+45)-this.ref_height/2-40;this.row<=1&&(_-=100),n.setPosition(r,_),n.setParent(this.content),this.cache_list.push(n);var h=Math.ceil(i/5);if(h>2){var d=h/this.row;this.scroll_view_compend.scrollToPercentVertical(1-d,.5,!0)}}.bind(this,i,e);this.action_effect[e].setStartListener(h);var d=s.getSpinePath(l,"action");this.loadRes(d,function(t){this.action_effect[e].skeletonData=t,this.action_effect[e].setAnimation(0,r,!1)}.bind(this))}.bind(this,a,n))}},openRootWnd:function(t){this.can_click=!1,Utils.delayRun(this.background,2,function(){this.can_click=!0}.bind(this))},closeCallBack:function(){for(var t in this.ctrl.openTreasureGetItemWindow(!1),this.handleEffect(!1),this.cache_list)this.cache_list[t]&&this.cache_list[t].deleteMe&&this.cache_list[t].deleteMe();this.cache_list=null}});cc._RF.pop()},{backpack_const:"backpack_const",pathtool:"pathtool"}],action_treasure_window:[function(t,e,i){"use strict";cc._RF.push(e,"e57f89y561MuquqyUlVjaes","action_treasure_window");var s=t("pathtool"),n=t("backpack_controller"),a=t("role_controller"),o=t("mainui_controller"),l=t("action_event"),r=[[0,204],[148,133],[221,-19],[143,-165],[0,-239],[-142,-170],[-225,-19],[-144,136]],c=[0,1,2,3,4,5,6,7,0];cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("action","action_treasure_window"),this.viewTag=SCENE_TAG.ui,this.win_type=WinType.Full,this.ctrl=arguments[0],this.model=this.ctrl.getModel();var e=t("mall_controller");e.getInstance().getMallView()&&e.getInstance().getMallView().setVisible(!1)},initConfig:function(){this.touchEnable=!1,this.touchRefresh=!1,this.tab_list=[],this.cur_index=null,this.desc_item_name=[],this.desc_item_Lv=[],this.hasTreasure_num=[],this.touchTreasure_type=1,this.checkMoreCount=1,this.touchEffect=[!0,!0],this.getRewardList=[],this.arriveLuckly_label=[],this.item_list=[],this.luckly_item=[]},openCallBack:function(){this.bigbg=this.root_wnd.getChildByName("bg"),this.bigbg.scale=2*FIT_SCALE,this.bg=this.root_wnd.getChildByName("bg").getComponent(cc.Sprite);var t=s.getUIIconPath("bigbg/action","action_treasure","jpg");this.loadRes(t,function(t){this.bg.spriteFrame=t}.bind(this)),this.background=this.root_wnd.getChildByName("background");var e=this.root_wnd.getChildByName("main_container");this.main_container=e,this.text_scroll=e.getChildByName("text_scroll"),this.content=this.text_scroll.getChildByName("content"),this.probablity=e.getChildByName("probablity"),this.probablity.active=!1,this.item_panel=e.getChildByName("item_panel"),this.round_certer_node=this.item_panel.getChildByName("round"),this.round_certer_node.scale=2,this.round_certer=this.round_certer_node.getComponent(cc.Sprite),this.btnLockOther=this.item_panel.getChildByName("btnLockOther"),e.getChildByName("Text_6").getComponent(cc.Label).string=Utils.TI18N("\u4e0b\u6b21\u514d\u8d39\u5237\u65b0: "),this.refresh_time=e.getChildByName("refresh_time").getComponent(cc.Label),this.refresh_time.string="00:00:00",this.run_light=Utils.createImage(this.item_panel,null,0,0,cc.v2(.5,.5),null,10),this.run_light.active=!1;var i=s.getUIIconPath("welfare","welfare_37");this.loadRes(i,function(t){this.run_light.spriteFrame=t}.bind(this)),this.status_count=0,this.model.setLucklyRewardData(),this.model.setBuyRewardData(),e.getChildByName("Text_2").getComponent(cc.Label).string=Utils.TI18N("\u63a2\u5b9d\u8bb0\u5f55");var a=this.main_container.getChildByName("treasure_bg");this.treasure_total=Utils.createRichLabel(22,new cc.Color(255,255,248,255),cc.v2(0,.5),cc.v2(-a.width/2,0),45,150),this.treasure_total.horizontalAlign=cc.macro.TextAlignment.LEFT,a.addChild(this.treasure_total.node),this.luckyBar=e.getChildByName("luckyBar");for(var o=e.getChildByName("tab_container"),l=[Utils.TI18N("\u5e78\u8fd0\u63a2\u5b9d"),Utils.TI18N("\u9ad8\u7ea7\u63a2\u5b9d")],r=1;r<=2;r++){var c=o.getChildByName(cc.js.formatStr("tab_btn_%s",r));c.label=c.getChildByName("title").getComponent(cc.Label),c.label.string=l[r-1],c.normal=c.getChildByName("normal"),c.select=c.getChildByName("select"),c.select.active=!1,c.redpoint=c.getChildByName("redpoint"),c.redpoint.active=!1,c.label.node.color=new cc.Color(255,195,141,255),c.index=r,this.tab_list[r]=c}for(r=1;r<=2;r++){var _=this.model.getBuyRewardData(r)[0].expend_item[0][0];this.hasTreasure_num[r]=n.getInstance().getModel().getBackPackItemNumByBid(_)}this.btnTreasure=[];for(r=1;r<=3;r++){var h={};h.btn=e.getChildByName("btn_treasure_"+r),h.price=Utils.createRichLabel(24,new cc.Color(255,255,255,255),cc.v2(.5,.5),cc.v2(0,0),31),h.btn.addChild(h.price.node),this.btnTreasure[r]=h}this.text_lucky_num=e.getChildByName("text_lucky_num").getComponent(cc.Label),this.text_lucky_num.string="",this.btnRule=e.getChildByName("btnRule"),this.btn_shop=e.getChildByName("btn_shop"),this.btn_shop.getChildByName("Text_1").getComponent(cc.Label).string=Utils.TI18N("\u63a2\u5b9d\u5546\u5e97"),this.btn_return=e.getChildByName("btn_return"),this.btn_return.getChildByName("Text_3").getComponent(cc.Label).string=Utils.TI18N("\u8fd4\u56de")},registerEvent:function(){for(var e in this.addGlobalEvent(l.UPDATE_LUCKYROUND_GET,function(t){t?this.changeTabView(this.cur_index||this.jump_index):this.ctrl.openLuckyTreasureWin(!1)}.bind(this)),this.addGlobalEvent(l.TREASURE_SUCCESS_DATA,function(t){if(t){if(0==t.code)return this.touchEnable=!1,void message(t.msg);this.showRewardList=t,this.pos=0,this.runProcess=0,this.process=this.status_count,this.speed=1,this.addSpeed=0,this.targetPos=t.awards3[0].pos-1,this.step=0,this.round=5,this.targetPos<=3&&(this.round=4),this.runLightUniformSpeedHide(),null==this.lottery_ticket&&(this.lottery_ticket=gcore.Timer.set(function(){this.runHandler()}.bind(this),30,-1))}}.bind(this)),this.addGlobalEvent(l.UPDATA_TREASURE_LOG_DATA,function(t){if(t){this.model.updataTreasureLogData(t.type,t.log_list);var e=this.model.getTreasureInitData(t.type);this.showTreasureLog(e)}}.bind(this)),this.addGlobalEvent(l.UPDATA_TREASURE_POPUPS_SEND,function(t){this.showRewardList=t,this.runLightReward()}.bind(this)),this.addGlobalEvent(l.UPDATE_LUCKLY_DATA,function(t){if(t){var e=this.model.getBuyRewardData(t.type)[0].expend_item[0][0];this.hasTreasure_num[t.type]=n.getInstance().getModel().getBackPackItemNumByBid(e),this.hasTreasure_num[t.type]<=0&&(this.hasTreasure_num[t.type]=0);var i=Utils.getItemConfig(e);if(i){var a=s.getItemRes(i.icon),o=cc.js.formatStr(Utils.TI18N("<img src='%s'/>  %d"),i.icon,this.hasTreasure_num[t.type]);this.treasure_total.string=o,this.loadRes(a,function(t){this.treasure_total.spriteFrame=t}.bind(this))}this.model.updataTreasureInitData(t.type,t);var l=this.model.getLucklyRewardData(t.type),r=this.model.getTreasureInitData(t.type);this.commonShowData(r,l)}}.bind(this)),this.addGlobalEvent(EventId.ADD_GOODS,function(t,e){this.changeTreasureNumber(e)}.bind(this)),this.addGlobalEvent(EventId.DELETE_GOODS,function(t,e){this.changeTreasureNumber(e)}.bind(this)),this.addGlobalEvent(EventId.MODIFY_GOODS_NUM,function(t,e){this.changeTreasureNumber(e)}.bind(this)),this.tab_list)Utils.onTouchEnd(this.tab_list[e],function(t){if(1!=this.touchEnable){this.probablity.active=!1;var e=a.getInstance().getRoleVo(),i=this.model.getBuyRewardData(t.index);if(i&&i[0].limit_open)if(e.lev>=i[0].limit_open[0][1])this.changeTabvarData(t.index),this.changeTabView(t.index);else{var s=cc.js.formatStr(Utils.TI18N("\u4eba\u7269\u7b49\u7ea7%d\u7ea7\u5f00\u542f"),i[0].limit_open[0][1]);message(s)}}}.bind(this,this.tab_list[e]),1);for(var e in Utils.onTouchEnd(this.btn_return,function(){this.ctrl.openLuckyTreasureWin(!1)}.bind(this),2),this.btnRule.on(cc.Node.EventType.TOUCH_END,function(e){Utils.playButtonSound(1);var i=Config.dial_data.data_const.game_rule1;2==this.cur_index&&(i=Config.dial_data.data_const.game_rule2);var s=e.touch.getLocation();t("tips_controller").getInstance().showCommonTips(i.desc,s,null,null,500)},this),Utils.onTouchEnd(this.btnLockOther,function(){this.probablity.active=!0,this.rewardProbility(this.cur_index)}.bind(this),1),Utils.onTouchEnd(this.probablity,function(){this.probablity.active=!1}.bind(this),1),Utils.onTouchEnd(this.background,function(){this.probablity.active=!1}.bind(this),1),Utils.onTouchEnd(this.btn_shop,function(){t("mall_controller").getInstance().getMallView()&&this.setVisible(!1),t("stronger_controller").getInstance().clickCallBack(406)}.bind(this),1),this.btnTreasure)Utils.onTouchEnd(this.btnTreasure[e].btn,function(t){if(1!=this.touchEnable)if(this.cur_index=this.cur_index||1,3==t){if(a.getInstance().getRoleVo().gold<Config.dial_data.data_const.refreash.val[0][1]&&0==this.touchEffect[this.cur_index])return void message(Utils.TI18N("\u94bb\u77f3\u4e0d\u8db3"));if(1==this.touchRefresh)return void message(Utils.TI18N("\u5237\u65b0\u4e2d..."));this.touchRefresh=!0,this.runLightUniformSpeedHide(),this.startRefreshAction()}else{var e=this.model.getBuyRewardData(this.cur_index);this.touchEnable=!0,1==o.getInstance().checkIsOpenByActivate(e[t-1].limit_open)?this.touchTreasure_type=t:this.touchEnable=!1,this.ctrl.send16638(this.cur_index,t)}else message(Utils.TI18N("\u63a2\u5b9d\u8fdb\u884c\u4e2d"))}.bind(this,e),1)},rewardProbility:function(t){t=t||1;var e,i=1,s=a.getInstance().getRoleVo();if(null!=(e=Config.dial_data.data_magnificat_list[t])){for(var n in e)if(s.lev>=e[n].min&&s.lev<=e[n].max){i=n;break}var o=e[parseInt(i)];for(n=1;n<=this.checkMoreCount;n++)this.desc_item_name[n]&&(this.desc_item_name[n].node.active=!1),this.desc_item_Lv[n]&&(this.desc_item_Lv[n].node.active=!1);this.checkMoreCount=o.award.length;var l=Math.floor(this.checkMoreCount/2);this.probablity.setContentSize(cc.size(this.probablity.getContentSize().width,45*l));this.probablity.stopAllActions();for(n=1;n<=this.checkMoreCount;n++)Utils.delayRun(this.probablity,2*n/cc.game.getFrameRate(),function(t,e){if(t<=e){var i=Utils.getItemConfig(o.award[t-1][0]);this.desc_item_name[t]||(this.desc_item_name[t]=Utils.createLabel(26,new cc.Color(76,216,73,255),null,0,0,"",this.probablity,null,cc.v2(0,.5))),this.desc_item_name[t]&&(this.desc_item_name[t].node.active=!0,this.desc_item_name[t].node.setContentSize(cc.size(150,30)),this.desc_item_name[t].string=Utils.TI18N(i.name),this.desc_item_name[t].node.setPosition(-320,-35-36*(t-1))),this.desc_item_Lv[t]||(this.desc_item_Lv[t]=Utils.createLabel(26,new cc.Color(255,167,42,255),null,0,0,"",this.probablity,null,cc.v2(0,.5))),this.desc_item_Lv[t]&&(this.desc_item_Lv[t].node.active=!0,this.desc_item_Lv[t].string=o.award[t-1][1]+"%",this.desc_item_Lv[t].node.setPosition(-95,-35-36*(t-1)))}else{i=Utils.getItemConfig(o.award[t-1][0]);this.desc_item_name[t]||(this.desc_item_name[t]=Utils.createLabel(26,new cc.Color(76,216,73,255),null,0,0,"",this.probablity,null,cc.v2(0,.5))),this.desc_item_name[t]&&(this.desc_item_name[t].node.active=!0,this.desc_item_name[t].node.setContentSize(cc.size(150,30)),this.desc_item_name[t].string=Utils.TI18N(i.name),this.desc_item_name[t].node.setPosition(-10,-35-36*(t-(e+1)))),this.desc_item_Lv[t]||(this.desc_item_Lv[t]=Utils.createLabel(26,new cc.Color(255,167,42,255),null,0,0,"",this.probablity,null,cc.v2(0,.5))),this.desc_item_Lv[t]&&(this.desc_item_Lv[t].node.active=!0,this.desc_item_Lv[t].string=o.award[t-1][1]+"%",this.desc_item_Lv[t].node.setPosition(215,-35-36*(t-(e+1))))}}.bind(this,n,l))}else this.probablity.active=!1},itemRewardPos:function(t){if(t&&null!=Utils.next(t)){for(var e=1;e<=t.length;e++)Utils.delayRun(this.item_panel,2*e/cc.game.getFrameRate(),function(e){if(!this.item_list[e]){var i=ItemsPool.getInstance().getItem("backpack_item");i.initConfig(!0,.8,!1,!0),i.setParent(this.item_panel),i.show(),this.item_list[e]=i}this.item_list[e]&&(this.item_list[e].setPosition(r[e-1][0],r[e-1][1]),this.item_list[e].setData({bid:Config.dial_data.data_get_rand_list[t[e-1].id][0].item_id,num:Config.dial_data.data_get_rand_list[t[e-1].id][0].item_num}),t[e-1]&&(1==t[e-1].status?this.item_list[e].setItemIconUnEnabled(!0):0==t[e-1].status&&this.item_list[e].setItemIconUnEnabled(!1)),this.item_list[e].root_wnd&&(this.item_list[e].root_wnd.active=!0))}.bind(this,e));this.runLightUniformSpeed()}},changeTabvarData:function(t){if(this.cur_index!=t){t=t||1;var e=s.getUIIconPath("bigbg/action","action_treasure_round_"+t);this.loadRes(e,function(t){this.round_certer.spriteFrame=t}.bind(this));var i=this.model.getBuyRewardData(t),n=i[0].expend_item[0][0],a=Utils.getItemConfig(n),o=cc.js.formatStr(Utils.TI18N("<img src='%s'/>  %d"),a.icon,this.hasTreasure_num[t]);this.treasure_total.string=o;var l=s.getItemRes(a.icon);this.loadRes(l,function(t){this.treasure_total.spriteFrame=t}.bind(this));for(var r=1;r<=3;r++)if(3==r){o=cc.js.formatStr(Utils.TI18N("<outline=2,color=#651D00>\u514d\u8d39\u5237\u65b0</outline>"));this.btnTreasure[r].price.string=o,this.btnTreasure[r].price.node.setPosition(0,0)}else{o=cc.js.formatStr(Utils.TI18N("<outline=2,color=#651D00>\u63a2\u5b9d%d\u6b21</outline>\n<img src='%s'/><color=#fffb94 fontsize=20><outline=2,color=#651D00> %d</outline></color>"),Config.dial_data.data_const.treasure_num.val[t-1][r-1],a.icon,i[r-1].expend_item[0][1]);this.btnTreasure[r].price.string=o,this.loadRes(l,function(t,e){t.spriteFrame=e}.bind(this,this.btnTreasure[r].price))}this.initRoundItem(t)}},initRoundItem:function(e){for(var i=this.main_container.getChildByName("Image_2_0"),s=this.model.getLucklyRewardData(e),n=i.getContentSize().width/5,a=1;a<=5;a++){if(!this.luckly_item[a]){var o=t("round_item_panel");this.luckly_item[a]=new o(!0,.55,.7),this.luckly_item[a].setParent(this.luckyBar),this.luckly_item[a].show(),this.luckly_item[a].setPosition(n*a,0)}if(!this.arriveLuckly_label[a]&&this.luckly_item[a]&&(this.arriveLuckly_label[a]=Utils.createLabel(28,new cc.Color(255,255,255,255),null,n*a,-40,"",this.luckyBar,null,cc.v2(.5,.5)),this.arriveLuckly_label[a].node.scale=.55),this.arriveLuckly_label[a]&&(this.arriveLuckly_label[a].string=s[a-1].lucky_val),this.luckly_item[a]){this.luckly_item[a].setBaseData({bid:s[a-1].award[0][0],num:s[a-1].award[0][1]}),this.luckly_item[a].setVisibleRedPoint(!1),this.luckly_item[a].setVisibleRoundBG(!1);var l=function(t){this.ctrl.send16640(e,s[t-1].id)}.bind(this,a);this.luckly_item[a].addCallBack(l)}}},sectionCalculation:function(t,e){t=t||10;var i=0;if(e[0]&&e[1]&&e[2]&&e[3]&&e[4]){if(t<=e[0].lucky_val)return t/e[0].lucky_val*20/100;if(t>e[0].lucky_val&&t<=e[1].lucky_val)i=1;else if(t>e[1].lucky_val&&t<=e[2].lucky_val)i=2;else if(t>e[2].lucky_val&&t<=e[3].lucky_val)i=3;else{if(!(t>e[3].lucky_val&&t<=e[4].lucky_val))return 1;i=4}var s=e[i].lucky_val-e[i-1].lucky_val;return(20*i+(t-e[i-1].lucky_val)/s*20)/100}return 0},commonShowData:function(t,e){if(Utils.next(t)&&Utils.next(e)){var i=0;e[4]&&(i=e[4].lucky_val),this.text_lucky_num.string=t.lucky+"/"+i;var n=this.sectionCalculation(t.lucky,e);this.luckyBar.getComponent(cc.ProgressBar).progress=n;var a=t.end_time-gcore.SmartSocket.getTime();if(a>0){this.model.setCountDownTime(this.refresh_time,a);var o=Utils.getItemConfig(Config.dial_data.data_const.refreash.val[0][0]),l=s.getItemRes(o.icon),r=cc.js.formatStr(Utils.TI18N("<img src='%s'/><outline=2,color=#651D00> %d\u5237\u65b0</outline>"),o.icon,Config.dial_data.data_const.refreash.val[0][1]);this.btnTreasure[3].price.string=r,this.touchEffect[t.type]=!1,this.loadRes(l,function(t){this.btnTreasure[3].price.spriteFrame=t}.bind(this))}else{r=cc.js.formatStr(Utils.TI18N("<outline=2,color=#651D00>\u514d\u8d39\u5237\u65b0</outline>"));this.btnTreasure[3].price.string=r,this.refresh_time.node.stopAllActions(),this.refresh_time.string="00:00:00",this.touchEffect[t.type]=!0}var c=!1;for(var _ in e){var h=!0;for(var d in t.lucky_award)if(e[_].id==t.lucky_award[d].lucky){h=!1;break}t.lucky<e[_].lucky_val&&(h=!1),this.luckly_item[parseInt(_)+1]&&(this.luckly_item[parseInt(_)+1].setItemUnEnabled(!1),this.luckly_item[parseInt(_)+1].setDefaultTip(!h),c=c||h,this.luckly_item[parseInt(_)+1].setVisibleRedPoint(h),0==h&&t.lucky>=e[_].lucky_val&&this.luckly_item[parseInt(_)+1].setItemUnEnabled(!0))}this.model.setLucklyTabRedPoint(t.type,c),this.showRedpoint()}},showRedpoint:function(){for(var e=!1,i=1;i<=2;i++){var s=this.model.getLucklyTabRedPoint(i);this.tab_list[i].redpoint.active=s,e=e||s}var n=t("mainui_const");o.getInstance().setFunctionTipsStatus(n.icon.lucky_treasure,e)},showTreasureLog:function(t){if(t&&null!=Utils.next(t)){var e="",i=t.log_list.length;for(var s in i>=10&&(i=10),this.getRewardList)this.getRewardList[s]&&(this.getRewardList[s].node.active=!1);this.content.setContentSize(cc.size(this.text_scroll.getContentSize().width,26*i));for(s=0;s<i;s++)if(t.log_list[s]&&(this.getRewardList[s]=Utils.createRichLabel(22,new cc.Color(255,255,248,255),cc.v2(.5,1),cc.v2(this.content.getContentSize().width/2,0),null,600),this.content.addChild(this.getRewardList[s].node)),this.getRewardList[s]){this.getRewardList[s].node.active=!0,this.getRewardList[s].node.y=-26*s;var n=Utils.getItemConfig(t.log_list[s].bid);e=cc.js.formatStr(Utils.TI18N(" <color=#4cd849>%s</color> \u83b7\u5f97 <color=#ffa72a>%s</color>"),t.log_list[s].role_name,n.name),this.getRewardList[s].string=e}}},changeTabView:function(t){if(t=t||1,this.cur_index!=t){null!=this.cur_tab&&(this.cur_tab.label.node.color=new cc.Color(255,195,141,255),this.cur_tab.normal.active=!0,this.cur_tab.select.active=!1),this.cur_index=t,this.cur_tab=this.tab_list[this.cur_index],null!=this.cur_tab&&(this.cur_tab.label.node.color=new cc.Color(254,255,205,255),this.cur_tab.normal.active=!1,this.cur_tab.select.active=!0),this.touchEnable=!1;var e=this.model.getLucklyRewardData(t),i=this.model.getTreasureInitData(t);this.commonShowData(i,e),this.itemRewardPos(i.rand_lists),Utils.delayRun(this.content,20/cc.game.getFrameRate(),function(t){this.showTreasureLog(t)}.bind(this,i))}},changeTreasureNumber:function(t){for(var e in t)if(37001==t[e].base_id){if(this.hasTreasure_num[1]=n.getInstance().getModel().getBackPackItemNumByBid(37001),1==this.cur_index){var i=Utils.getItemConfig(37001),a=s.getItemRes(i.icon),o=cc.js.formatStr(Utils.TI18N("<img src='%s'/>  %d"),i.icon,this.hasTreasure_num[1]);this.treasure_total.string=o,this.loadRes(a,function(t){this.treasure_total.spriteFrame=t}.bind(this))}}else if(37002==t[e].base_id&&(this.hasTreasure_num[2]=n.getInstance().getModel().getBackPackItemNumByBid(37002),2==this.cur_index)){i=Utils.getItemConfig(37002),a=s.getItemRes(i.icon),o=cc.js.formatStr(Utils.TI18N("<img src='%s'/>  %d"),i.icon,this.hasTreasure_num[2]);this.treasure_total.string=o,this.loadRes(a,function(t){this.treasure_total.spriteFrame=t}.bind(this))}},runHandler:function(){0==this.step?(this.process=this.process+.33,this.process>=3&&(this.step=1,this.speed=.6)):1==this.step?(this.process=this.process+this.speed,this.process>8*this.round&&this.targetPos>-1&&(this.targetPos>3?this.process%8>3&&(this.speed=.04,this.step=2):this.targetPos<=3&&this.process%(8*this.round)>=this.targetPos-3+8&&(this.speed=.04,this.step=2))):2==this.step&&(this.process=this.process+this.speed,this.process%8>=this.targetPos&&Math.floor(this.process/8)>=5&&null!=this.lottery_ticket&&(gcore.Timer.del(this.lottery_ticket),this.lottery_ticket=null,this.stopRunHandler()));var t=Math.floor(this.process);this.setPos(t)},setPos:function(t){t<=0?t+=8:t>=8&&(t%=8),this.run_light.node.active=!0,this.run_light.node.setPosition(r[c[t]][0],r[c[t]][1])},stopRunHandler:function(){this.touchEnable=!1,null==this.run_light_show_reward&&(this.run_light_show_reward=gcore.Timer.set(function(){this.run_light&&(this.runLightReward(),this.showRewardList=null,this.runLightUniformSpeed())}.bind(this),1e3,-1))},runLightReward:function(){if(this.showRewardList){var t=[];for(var e in this.showRewardList.awards1)this.showRewardList.awards1[e]&&t.push(this.showRewardList.awards1[e]);for(var e in this.showRewardList.awards2)this.showRewardList.awards2[e]&&t.push(this.showRewardList.awards2[e]);this.ctrl.openTreasureGetItemWindow(!0,t,this.cur_index,this.touchTreasure_type)}var i=this.model.getTreasureInitData(this.cur_index);i&&this.itemRewardPos(i.rand_lists)},runLightUniformSpeedHide:function(){this.run_light.node.active=!1,null!=this.open_view_ticket&&(gcore.Timer.del(this.open_view_ticket),this.open_view_ticket=null),null!=this.run_light_show_reward&&(gcore.Timer.del(this.run_light_show_reward),this.run_light_show_reward=null)},runLightUniformSpeed:function(){null==this.open_view_ticket&&(this.open_view_ticket=gcore.Timer.set(function(){this.run_light&&(this.run_light.node.active=!0,this.status_count=this.status_count%8,this.run_light.node.setPosition(r[c[this.status_count]][0],r[c[this.status_count]][1]),this.status_count=this.status_count+1)}.bind(this),500,-1))},getActionFunc:function(t){if(t){var e=cc.fadeOut(.07);t.runAction(e)}},startRefreshAction:function(){for(var t=1;t<=8;t++)this.item_list[t]&&this.item_list[t].root_wnd&&(this.item_list[t].root_wnd.active=!1);var e=new cc.Node;this.item_panel.addChild(e);var i=function(){this.ctrl.send16642(this.cur_index),this.handleEffect()}.bind(this);e.runAction(cc.sequence(cc.callFunc(i),cc.removeSelf(!0)))},handleEffect:function(){var t=function(){this.touchRefresh=!1;var t=this.model.getTreasureInitData(this.cur_index);this.itemRewardPos(t.rand_lists)}.bind(this);Utils.playEffectOnce(s.getEffectRes(614),0,0,this.item_panel,t,PlayerAction.action_1,1)},openRootWnd:function(t){this.jump_index=t||1,this.changeTabvarData(this.jump_index),this.ctrl.requestLucky()},closeCallBack:function(){if(this.refresh_time.node.stopAllActions(),null!=this.lottery_ticket&&(gcore.Timer.del(this.lottery_ticket),this.lottery_ticket=null),this.item_list&&null!=Utils.next(this.item_list||{}))for(var e in this.item_list)this.item_list[e]&&this.item_list[e].deleteMe&&this.item_list[e].deleteMe();if(this.luckly_item&&null!=Utils.next(this.luckly_item||{}))for(var e in this.luckly_item)this.luckly_item[e]&&this.luckly_item[e].deleteMe&&this.luckly_item[e].deleteMe();this.runLightReward(),this.probablity.stopAllActions(),this.runLightUniformSpeedHide();var i=t("mall_controller");i.getInstance().getMallView()&&i.getInstance().getMallView().setVisible(!0),this.ctrl.openLuckyTreasureWin(!1)}});cc._RF.pop()},{action_event:"action_event",backpack_controller:"backpack_controller",mainui_const:"mainui_const",mainui_controller:"mainui_controller",mall_controller:"mall_controller",pathtool:"pathtool",role_controller:"role_controller",round_item_panel:"round_item_panel",stronger_controller:"stronger_controller",tips_controller:"tips_controller"}],activity_const:[function(t,e,i){"use strict";cc._RF.push(e,"ac487aJvjJPvYaaCMjBo+AN","activity_const");e.exports={ActivitySignType:{arena_champion:1,arena_champion_guess:2,godbattle_sign:3,godbattle:4},limit_index:{escort:1,union:2,fightFirst:3,allGod:4,guildwar:5,champion:6,ladder:7}},cc._RF.pop()},{}],activity_controller:[function(t,e,i){"use strict";cc._RF.push(e,"0a0ef13dQdBuLYQG/euicni","activity_controller");var s=t("guildboss_event"),n=t("mainui_controller"),a=t("battle_const"),o=t("activity_const"),l=t("mainui_const"),r=cc.Class({extends:BaseController,ctor:function(){},initConfig:function(){var e=t("activity_model");this.model=new e,this.model.initConfig()},getModel:function(){return this.model},registerEvents:function(){null==this.init_role_event&&(this.init_role_event=gcore.GlobalEvent.bind(EventId.EVT_ROLE_CREATE_SUCCESS,function(){gcore.GlobalEvent.unbind(this.init_role_event),this.init_role_event=null;var e=t("role_controller");if(this._roleVo=e.getInstance().getRoleVo(),null!=this._roleVo&&null==this.role_assets_event){t("role_event");this.role_assets_event=this.role_vo.bind(EventId.UPDATE_ROLE_ATTRIBUTE,function(t,e){"lev"==t&&this.requestInitProtocal()}.bind(this))}}.bind(this))),this.re_link_game_event||(this.re_link_game_event=gcore.GlobalEvent.bind(EventId.EVT_RE_LINK_GAME,function(){this.requestInitProtocal()}.bind(this)))},requestInitProtocal:function(){var t=Config.dailyplay_data.data_limitactivity;1==t[2].is_open&&this._roleVo&&this._roleVo.lev>=t[2].activate[0][1]&&this.SendProtocal(21322,{})},registerProtocals:function(){this.RegisterProtocal(21322,this.handle21322)},handle21322:function(e){if(e){0==e.code?this._doubleTime=!1:1==e.code&&(this._doubleTime=!0),this._firstComein=this._doubleTime;var i=t("guildboss_controller").getInstance().getModel().getBaseInfo();1==this._doubleTime&&i&&i.count&&i.count>0&&!0,gcore.GlobalEvent.fire(s.BossActivityDoubleTime,this._doubleTime)}},setFirstComeGuild:function(t){this._firstComein=t},getFirstComeGuild:function(){return this._firstComein},getBossActivityDoubleTime:function(){return this._doubleTime},openActivityView:function(t){1==t?(this.activityView||(this.activityView=Utils.createClass("activity_window",this)),this.activityView&&0==this.activityView.isOpen()&&this.activityView.open()):this.activityView&&(this.activityView.close(),this.activityView=null)},openSignView:function(t,e,i){0==t?null!=this.activity_sign_view&&(this.activity_sign_view.close(),this.activity_sign_view=null):(null==this.activity_sign_view&&(this.activity_sign_view=Utils.createClass("activity_sign_window",this)),this.activity_sign_view&&0==this.activity_sign_view.isOpen()&&this.activity_sign_view.open([e,i]))},switchLimitActivityView:function(t){t==o.limit_index.escort?n.getInstance().requestOpenBattleRelevanceWindow(a.Fight_Type.Escort):t==o.limit_index.union?0==this.getBossActivityDoubleTime()?message(Utils.TI18N("\u5f53\u524d\u4e0d\u5904\u4e8e\u6d3b\u52a8\u65f6\u6bb5\uff0c\u8bf7\u5728\u6d3b\u52a8\u5f00\u542f\u540e\u518d\u6765\u54e6")):n.getInstance().requestOpenBattleRelevanceWindow(a.Fight_Type.GuildDun):t==o.limit_index.fightFirst||(t==o.limit_index.allGod?n.getInstance().requestOpenBattleRelevanceWindow(a.Fight_Type.Godbattle):t==o.limit_index.guildwar||(t==o.limit_index.champion?n.getInstance().changeMainUIStatus(l.btn_index.main_scene,l.sub_type.champion_call):o.limit_index.ladder))},getActivityRoot:function(){if(this.activityView)return this.activityView.root_wnd}});e.exports=r,cc._RF.pop()},{activity_const:"activity_const",activity_model:"activity_model",battle_const:"battle_const",guildboss_controller:"guildboss_controller",guildboss_event:"guildboss_event",mainui_const:"mainui_const",mainui_controller:"mainui_controller",role_controller:"role_controller",role_event:"role_event"}],activity_event:[function(t,e,i){"use strict";cc._RF.push(e,"88c94FaRG1MMp/nTvYKOSMN","activity_event"),e.exports={EscortCount:"EscortCount"},cc._RF.pop()},{}],activity_item_panel:[function(t,e,i){"use strict";cc._RF.push(e,"cb705YL5LFHF6D9qaJoi8H3","activity_item_panel");var s=t("pathtool"),n=t("activity_const"),a=t("guildboss_controller"),o=t("activity_controller"),l=t("mainui_controller");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("activity","activity_item"),this.ctrl=o.getInstance()},initConfig:function(){this.is_double=!1,this.list_item=[]},initPanel:function(){this.mainContainer=this.root_wnd.getChildByName("main_container"),this.itemMask=this.mainContainer.getChildByName("itemMask"),this.textLimit=this.itemMask.getChildByName("textLimit").getComponent(cc.Label),this.textLimit.string=Utils.TI18N("\u656c\u8bf7\u671f\u5f85"),this.itemMask.zIndex=11,this.btnRule=this.mainContainer.getChildByName("btnRule"),this.btnRule.active=!1,this.textTimeStart=this.mainContainer.getChildByName("textTimeStart").getComponent(cc.Label),this.textTimeStart.string="",this.textTimeStart.node.active=!1,this.itemBG=this.mainContainer.getChildByName("itemBG"),this.redPoint=this.mainContainer.getChildByName("redPoint"),this.redPoint.active=!1},changeEscortCount:function(){if(this.activityData.id==n.limit_index.escort){var t=totle-current;t<0&&(t=0);var e=cc.js.formatStr(Utils.TI18N("\u62a4\u9001\u6b21\u6570\uff1a%d/%d"),t,totle);this.count?this.count.string=e:this.count=Utils.createLabel(20,new cc.Color(255,255,255,255),new cc.Color(116,53,11,255),582,65,e,this.mainContainer,2,cc.v2(1,.5))}},setData:function(t){this.activityData=t,this.activityData.id==n.limit_index.escort&&this.changeEscortCount(),this.changeItemData(t)},getData:function(){return this.activityData},addCallBack:function(t){this.callback=t},registerEvent:function(){Utils.onTouchEnd(this.btnRule,function(){this.activityData.id==n.limit_index.escort?l.getInstance().openCommonExplainView(!0,Config.EscortData.data_explain):this.activityData.id==n.limit_index.union?l.getInstance().openCommonExplainView(!0,Config.GuildDunData.data_explain):this.activityData.id==n.limit_index.fightFirst||(this.activityData.id==n.limit_index.allGod?l.getInstance().openCommonExplainView(!0,Config.ZsWarData.data_explain):this.activityData.id==n.limit_index.guildwar?l.getInstance().openCommonExplainView(!0,Config.GuildWarData.data_explain):this.activityData.id==n.limit_index.champion?l.getInstance().openCommonExplainView(!0,Config.ArenaChampionData.data_explain):this.activityData.id==n.limit_index.ladder&&l.getInstance().openCommonExplainView(!0,Config.SkyLadderData.data_explain))}.bind(this),1),this.root_wnd.on(cc.Node.EventType.TOUCH_START,function(t){var e=t.getTouches();this.touch_began=e[0].getDelta()},this),this.root_wnd.on(cc.Node.EventType.TOUCH_END,function(t){var e=t.getTouches();this.touch_end=e[0].getDelta();var i=!0;null!=this.touch_began&&(i=Math.abs(this.touch_end.x-this.touch_began.x)<=20&&Math.abs(this.touch_end.y-this.touch_began.y)<=20),1==i&&(Utils.playButtonSound(ButtonSound.Normal),this.callback&&this.callback())},this)},updateRedStatus:function(){if(this.activityData){var t=!1;this.activityData.id==n.limit_index.escort||(this.activityData.id==n.limit_index.union?1==a.getInstance().getModel().getChangeCount()&&1==this.ctrl.getBossActivityDoubleTime()&&1==this.ctrl.getFirstComeGuild()&&(t=!0):this.activityData.id==n.limit_index.guildwar||(this.activityData.id,n.limit_index.ladder)),this.redPoint.active=t}},changeItemData:function(t){if(t.val[0])for(var e in t.val[0]){if(!this.list_item[e]){var i=ItemsPool.getInstance().getItem("backpack_item");this.mainContainer&&i.setParent(this.mainContainer),this.list_item[e]=i}this.list_item[e]&&(this.list_item[e].initConfig(!1,.5,!1,!0),this.list_item[e].show(),this.list_item[e].setPosition(40*e+(24*e-1),67),this.list_item[e].setData(t.val[0][e]))}this.limitItemData(t),t.desc&&this.textTimeStart&&(this.textTimeStart.string=t.desc,this.textTimeStart.node.active=!0)},limitItemData:function(e){var i=t("role_controller").getInstance().getRoleVo(),a=s.getIconPath("activity/activity_big","txt_cn_activity_item_"+e.id,!1,!1);(this.loadRes(a,function(t){this.itemBG.getComponent(cc.Sprite).spriteFrame=t}.bind(this)),1==e.is_open)?1==l.getInstance().checkIsOpenByActivate(e.activate)?(this.handleEffect(!0),this.itemMask.active=!1,this.btnRule&&(this.btnRule.active=!0),e.id==n.limit_index.union&&""==i.gname&&(this.textLimit.string=Utils.TI18N("\u5f53\u524d\u672a\u52a0\u5165\u516c\u4f1a"),this.handleEffect(!1))):(this.handleEffect(!1),this.btnRule&&(this.btnRule.active=!1),this.textLimit.string=e.lock_desc):e.id==n.limit_index.union&&""!=i.gname&&(this.textLimit.string=Utils.TI18N("\u516c\u4f1a\u526f\u672c\u73a9\u6cd5\u6682\u672a\u5f00\u542f"))},handleEffect:function(t){if(0==t)this.play_effect&&(this.play_effect.setToSetupPose(),this.play_effect.clearTracks(),this.play_effect=null);else if(this.mainContainer&&null==this.play_effect){var e=new cc.Node;e.setAnchorPoint(1,0),e.setPosition(this.itemBG.getContentSize().width-106,28),this.mainContainer.addChild(e,1),this.play_effect=e.addComponent(sp.Skeleton);var i=s.getSpinePath(s.getEffectRes(505),"action");LoaderManager.getInstance().loadRes(i,function(t){this.play_effect&&(this.play_effect.skeletonData=t,this.play_effect.setAnimation(0,PlayerAction.action,!0))}.bind(this))}},onShow:function(t){},onHide:function(){},onDelete:function(){if(this.list_item&&null!=Utils.next(this.list_item))for(var t in this.list_item)this.list_item[t].deleteMe&&this.list_item[t].deleteMe();this.list_item=[],this.handleEffect(!1),this.count=null}});cc._RF.pop()},{activity_const:"activity_const",activity_controller:"activity_controller",guildboss_controller:"guildboss_controller",mainui_controller:"mainui_controller",pathtool:"pathtool",role_controller:"role_controller"}],activity_model:[function(t,e,i){"use strict";cc._RF.push(e,"34708OjettPI71ecpmq7iFM","activity_model");cc.Class({extends:BaseClass,ctor:function(){},properties:{},initConfig:function(){}});cc._RF.pop()},{}],activity_sign_window:[function(t,e,i){"use strict";cc._RF.push(e,"fa662d7qhpEWLCKSJGaPb0N","activity_sign_window");var s=t("pathtool"),n=t("mainui_controller"),a=t("mainui_const"),o=t("activity_const");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("activity","activity_sign_window"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Tips,this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){this.item_list=[]},openCallBack:function(){this.main_panel=this.root_wnd.getChildByName("main_panel"),this.background=this.root_wnd.getChildByName("background_panel"),this.background.scale=FIT_SCALE,this.main_container=this.main_panel.getChildByName("main_container"),this.label=Utils.createRichLabel(24,new cc.Color(104,69,42,255),cc.v2(0,.5),cc.v2(-this.main_container.width/2+30,-this.main_container.height/2+60),30,500),this.label.horizontalAlign=cc.macro.TextAlignment.LEFT,this.main_container.addChild(this.label.node),this.item_container=this.main_panel.getChildByName("item_container"),this.item_view=this.item_container.getChildByName("item_view"),this.item_content=this.item_view.getChildByName("content"),this.ok_btn=this.main_panel.getChildByName("ok_btn"),this.cancel_btn=this.main_panel.getChildByName("cancel_btn"),this.close_btn=this.main_panel.getChildByName("close_btn"),this.cancel_lab=this.cancel_btn.getChildByName("Label").getComponent(cc.Label),this.ok_lab=this.ok_btn.getChildByName("Label").getComponent(cc.Label)},registerEvent:function(){Utils.onTouchEnd(this.close_btn,function(){this.ctrl.openSignView(!1)}.bind(this),2),Utils.onTouchEnd(this.cancel_btn,function(){this.ctrl.openSignView(!1)}.bind(this),2),Utils.onTouchEnd(this.ok_btn,function(){this.clickHandle(),this.ctrl.openSignView(!1)}.bind(this),2)},openRootWnd:function(t){if(t&&null!=t[0]){var e=Config.activity_data.data_sign_info[t[0]];e&&(this.id=t[0],this.time=e.time,this.label.string=e.desc,this.createItemList(e.items),this.cancel_lab.string=e.cancel,this.ok_lab.string=e.ok,t[1]&&t[1].timer&&this.setTimer(e))}},createItemList:function(t){if(null!=t&&null!=Utils.next(t)){for(var e in this.item_list)this.item_list[e].suspendAllActions(),this.item_list[e].setVisible(!1);var i=null,s=0,n=t.length,a=120*n*.8+6*(n-1),o=0,l=Math.max(this.item_view.getContentSize().width,a);for(var e in this.item_content.setContentSize(cc.size(l,this.item_view.getContentSize().height)),t){var r=t[e];if(Utils.getItemConfig(r)){if(null==(i=this.item_list[o])){i=ItemsPool.getInstance().getItem("backpack_item");this.item_view&&i.setParent(this.item_content),this.item_list.push(i),i.initConfig(!1,.8,!1,!0),i.show()}s=0+102*o+48,i.setData({bid:r,num:1}),i.setPosition(s,0),i.setVisible(!0),o+=1}}}},setTimer:function(){var t=Config.activity_data.data_sign_info[this.id];this.timer_id&&gcore.Timer.del(this.timer_id),this.timer_id=gcore.Timer.set(function(){this.time=this.time-1,0==this.time?this.ctrl.openSignView(!1):this.cancel_lab&&(this.cancel_lab.string=cc.js.formatStr("%s(%s)",t.cancel,this.time))}.bind(this),1e3,this.time),this.cancel_lab.string=cc.js.formatStr("%s(%s)",t.cancel,this.time)},clickHandle:function(){this.id==o.ActivitySignType.arena_champion?n.getInstance().changeMainUIStatus(a.btn_index.main_scene,a.sub_type.champion_call):this.id==o.ActivitySignType.arena_champion_guess?n.getInstance().changeMainUIStatus(a.btn_index.main_scene,a.sub_type.champion_call):this.id==o.ActivitySignType.godbattle||(this.id,o.ActivitySignType.godbattle_sign)},closeCallBack:function(){for(var t in this.item_list)this.item_list[t].deleteMe();this.timer_id&&gcore.Timer.del(this.timer_id),this.item_list=null}});cc._RF.pop()},{activity_const:"activity_const",mainui_const:"mainui_const",mainui_controller:"mainui_controller",pathtool:"pathtool"}],activity_window:[function(t,e,i){"use strict";cc._RF.push(e,"2016dmayRBHirbwfElj5DZY","activity_window");var s=t("pathtool"),n=t("activity_event");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("activity","activity_window"),this.viewTag=SCENE_TAG.ui,this.win_type=WinType.Full,this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){},openCallBack:function(){this._main_container=this.root_wnd.getChildByName("main_container"),this._scoreView=this._main_container.getChildByName("scoreView");var e=this._scoreView.getContentSize(),i={item_class:t("activity_item_panel"),start_x:7.5,space_x:6,start_y:3,space_y:0,item_width:605,item_height:165,row:0,col:1,delay:2},s=t("common_scrollview");this.itemScrollview=new s,this.itemScrollview.createScroll(this._scoreView,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,e,i)},registerEvent:function(){this.addGlobalEvent(n.EscortCount,function(){if(this.itemScrollview){var t=this.itemScrollview.getItemList();if(t)for(var e in t)t[e].changeEscortCount()}}.bind(this)),this.addGlobalEvent(EventId.UPDATE_ROLE_ATTRIBUTE,function(t,e){"lev"==t&&this.itemScrollview&&null!=Utils.next(this.dataInfo)&&this.itemScrollview.setData(this.dataInfo)}.bind(this))},openRootWnd:function(t){},updateItemListRedStatus:function(){var t=this.itemScrollview.getItemList();if(t)for(var e in t)t[e].updateRedStatus()},closeCallBack:function(){this.build_vo=null,this.itemScrollview&&(this.itemScrollview.deleteMe(),this.itemScrollview=null),this.ctrl.openActivityView(!1)}});cc._RF.pop()},{activity_event:"activity_event",activity_item_panel:"activity_item_panel",common_scrollview:"common_scrollview",pathtool:"pathtool"}],adventure_box_reward_item_panel:[function(t,e,i){"use strict";cc._RF.push(e,"9c76cpVyOZAK6PR35ywf08O","adventure_box_reward_item_panel");var s=t("pathtool"),n=t("adventure_controller");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("adventure","adventure_box_reward_item"),this.ctrl=n.getInstance()},initConfig:function(){},initPanel:function(){var e=this.root_wnd.getChildByName("main_container");this.name_text=e.getChildByName("name_text").getComponent(cc.Label),this.btn_goto=e.getChildByName("btn_goto"),this.btn_goto.active=!1,this.btn_goto.getChildByName("Text_2").getComponent(cc.Label).string=Utils.TI18N("\u524d\u5f80"),this.btn_get=e.getChildByName("btn_get"),this.btn_get.active=!1,this.btn_get.getChildByName("Text_2").getComponent(cc.Label).string=Utils.TI18N("\u9886\u53d6"),this.spr_has=e.getChildByName("spr_has"),this.spr_has.active=!1;var i=e.getChildByName("good_cons"),s=i.getContentSize(),n=t("common_scrollview");this.item_scrollview=new n,this.item_scrollview.createScroll(i,cc.v2(0,0),ScrollViewDir.horizontal,ScrollViewStartPos.top,s,{item_class:"backpack_item",start_x:0,space_x:10,start_y:5,space_y:0,item_width:96,item_height:96,row:1,col:0,scale:.8}),this.item_scrollview.setClickEnabled(!1),this.data&&this.updateInfo()},registerEvent:function(){Utils.onTouchEnd(this.btn_goto,function(){this.ctrl.openAdventureBoxRewardView(!1)}.bind(this),1),Utils.onTouchEnd(this.btn_get,function(){this.data&&this.data.id&&this.ctrl.send20635(this.data.id)}.bind(this),1)},setData:function(t){t&&(this.data=t,this.root_wnd&&this.updateInfo())},updateInfo:function(){this.btn_goto.active=0==this.data.status,this.btn_get.active=1==this.data.status,this.spr_has.active=2==this.data.status;var t=cc.js.formatStr(Utils.TI18N("\u51fb\u6740%d\u4e2a\u5b88\u536b  (%d/%d)"),this.data.count,this.kill_index,this.data.count);this.name_text.string=t;var e=[];for(var i in this.data.items){var s={};s&&(s.bid=this.data.items[i][0],s.num=this.data.items[i][1],e.push(s))}this.item_scrollview.setData(e),this.item_scrollview.addEndCallBack(function(){var t=this.item_scrollview.getItemList();for(var e in t)t[e].setDefaultTip()}.bind(this))},setExtendData:function(t){this.kill_index=t},onShow:function(t){},onHide:function(){},onDelete:function(){this.item_scrollview&&this.item_scrollview.deleteMe(),this.item_scrollview=null}});cc._RF.pop()},{adventure_controller:"adventure_controller",common_scrollview:"common_scrollview",pathtool:"pathtool"}],adventure_box_reward_window:[function(t,e,i){"use strict";function s(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}cc._RF.push(e,"81d74QaDpNNWoRHkH7Jqb/2","adventure_box_reward_window");var n=t("pathtool"),a=t("adventure_event");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=n.getPrefabPath("adventure","adventure_box_reward_window"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Big,this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){this.kill_master=0},openCallBack:function(){this.background=this.root_wnd.getChildByName("background"),this.background.scale=FIT_SCALE;var e=this.root_wnd.getChildByName("main_container");e.getChildByName("title").getComponent(cc.Label).string=Utils.TI18N("\u76ee\u6807\u5956\u52b1"),this.btn_close=e.getChildByName("btn_close");var i=e.getChildByName("good_cons"),s=i.getContentSize(),n={item_class:t("adventure_box_reward_item_panel"),start_x:10,space_x:0,start_y:0,space_y:0,item_width:600,item_height:168,row:0,col:1,need_dynamic:!0},a=t("common_scrollview");this.item_scrollview=new a,this.item_scrollview.createScroll(i,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,s,n)},registerEvent:function(){Utils.onTouchEnd(this.btn_close,function(){this.ctrl.openAdventureBoxRewardView(!1)}.bind(this),2),Utils.onTouchEnd(this.background,function(){this.ctrl.openAdventureBoxRewardView(!1)}.bind(this),2),this.addGlobalEvent(a.UpdateBoxTeskEvent,function(t){this.updataTeskRewardList()}.bind(this))},updataTeskRewardList:function(){var t=Config.adventure_data.data_round_reward_list,e=[];for(var i in t){var s=t[i];s.status=0,this.kill_master>=s.count&&(s.status=1),2==this.model.getAdventureBoxStatus(s.id)&&(s.status=2),e.push(s)}this.sortItemList(e),this.item_scrollview.setData(e,null,this.kill_master)},sortItemList:function(t){var e,i=(s(e={},0,2),s(e,1,1),s(e,2,3),e);t.sort(function(t,e){return t.status!=e.status?i[t.status]&&i[e.status]?i[t.status]-i[e.status]:-1:t.id-e.id})},openRootWnd:function(t){this.kill_master=t,this.updataTeskRewardList()},closeCallBack:function(){this.item_scrollview&&this.item_scrollview.deleteMe(),this.item_scrollview=null,this.ctrl.openAdventureBoxRewardView(!1)}});cc._RF.pop()},{adventure_box_reward_item_panel:"adventure_box_reward_item_panel",adventure_event:"adventure_event",common_scrollview:"common_scrollview",pathtool:"pathtool"}],adventure_buff_tips:[function(t,e,i){"use strict";cc._RF.push(e,"3b3fdxid1NEkLdSG5xltvzo","adventure_buff_tips");var s=t("loadermanager"),n=t("pathtool"),a=t("partner_calculate");cc.Class({extends:BaseClass,ctor:function(){this.prefabPath=n.getPrefabPath("tips","adventure_buff_tips"),this.delay=10,this.buff_list=arguments[0]||[],this.holiday_buff_list=arguments[1]||{},this.initConfig()},initConfig:function(){this.label_list={},this.holiday_label_list={},s.getInstance().loadRes(this.prefabPath,function(t){var e=t;this.createRootWnd(e)}.bind(this))},createRootWnd:function(t){this.root_wnd=t,this.root_wnd.setAnchorPoint(cc.v2(.5,.5)),this.root_wnd.setContentSize(cc.size(SCREEN_WIDTH,1280)),this.root_wnd.setPosition(0,0),ViewManager.getInstance().addToSceneNode(this.root_wnd,SCENE_TAG.msg),this.main_nd=this.root_wnd.getChildByName("main"),this.bg_nd=this.main_nd.getChildByName("bg"),this.registerEvent(),this.showTips()},registerEvent:function(){this.root_wnd.on(cc.Node.EventType.TOUCH_END,function(){t("tips_controller").getInstance().closeAllTips()},this)},setPosition:function(t,e){this.main_nd.setPosition(cc.v2(t,e))},addToParent:function(t,e){cc.log("common_tips")},setPos:function(t,e){this.main_nd.setPosition(cc.v2(t,e))},getBgContentSize:function(){if(this.root_wnd)return this.main_nd.getContentSize()},getScreenBg:function(){return this.root_wnd},addCallBack:function(t){this.callback=t,this.root_wnd&&this.callback()},showTips:function(){if(null!=this.root_wnd){this.buff_list=this.buff_list||[],this.holiday_buff_list=this.holiday_buff_list||[];var t=this.buff_list.length,e=510;1==t&&(e=255);var i=40*Math.ceil(.5*t)+55,a=0;if(null!=Utils.next(this.holiday_buff_list)){var o=this.holiday_buff_list.length;a=40*Math.ceil(.5*o)+10,e=510}this.main_nd.setContentSize(cc.size(e,i+a)),this.bg_nd.setContentSize(cc.size(e,i+a)),null==this.desc_label&&(this.desc_label=Utils.createLabel(20,new cc.Color(180,169,154,255),null,0,-(i+a)/2+8,Utils.TI18N("\u8be5\u5c5e\u6027\u4ec5\u672c\u8f6e\u5192\u9669\u751f\u6548"),this.main_nd,null,cc.v2(.5,0))),a>0&&(null==this.line_image&&(this.line_image=Utils.createImage(this.main_nd,null,0,i-10,cc.v2(.5,.5),!0,null,!0),s.getInstance().loadRes(n.getCommonIcomPath("common_1097"),function(t){this.line_image.spriteFrame=t}.bind(this))),null==this.holiday_label&&(this.holiday_label=Utils.createLabel(24,new cc.Color(224,191,153,255),null,30,i+a-20,Utils.TI18N("\u6d3b\u52a8\u52a0\u6210:"),this.main_nd,null,cc.v2(0,1)))),this.createBuffList(e,i,a),this.callback&&this.callback()}},createBuffList:function(t,e,i){var s=new cc.Color(224,191,153,255),n=Config.buff_data.data_get_buff_data;for(var a in this.holiday_buff_list||{}){if(null==this.holiday_label_list[a]){this.holiday_label_list[a]=Utils.createRichLabel(24,s,cc.v2(0,1)),this.holiday_label_list[a].horizontalAlign=cc.macro.TextAlignment.LEFT,this.main_nd.addChild(this.holiday_label_list[a].node);var o=-t/2+30+a%2*220,l=(e+i)/2-40*Math.floor(a/2)-20;this.holiday_label_list[a].node.setPosition(cc.v2(o,l))}var r=this.holiday_label_list[a],c=n[this.holiday_buff_list[a].bid],_=this.holiday_buff_list[a].time||1;this.setBuffLabelData(r,c,_)}for(var a in this.buff_list){if(null==this.label_list[a]){this.label_list[a]=Utils.createRichLabel(24,s,cc.v2(0,1)),this.label_list[a].horizontalAlign=cc.macro.TextAlignment.LEFT,this.main_nd.addChild(this.label_list[a].node);o=-t/2+30+a%2*220,l=-(e+i)/2+e-40*Math.floor(a/2)-20;this.label_list[a].node.setPosition(cc.v2(o,l))}r=this.label_list[a],c=n[this.buff_list[a].bid],_=this.buff_list[a].time||1;this.setBuffLabelData(r,c,_)}},setBuffLabelData:function(t,e,i){if(t&&e&&i){var o="";for(var l in e.effect){var r=e.effect[l][0],c=e.effect[l][1]*i;""!=o&&(o+=",");var _=Config.attr_data.data_key_to_name[r]||"";o=a.isShowPerByStr(r)?cc.js.formatStr(Utils.TI18N("%s\u63d0\u5347%s%s"),_,.1*c,"%"):cc.js.formatStr(Utils.TI18N("%s\u63d0\u5347%s"),_,c)}var h=cc.js.formatStr("<img src='%s'/>%s",e.icon,o);s.getInstance().loadRes(n.getBuffRes(e.icon),function(t,e){t.spriteFrame=e}.bind(this,t)),t.string=h}},setAnchorPoint:function(t){this.root_wnd&&this.root_wnd.setAnchorPoint(t)},open:function(){gcore.Timer.set(function(){t("tips_controller").getInstance().closeAllTips()},1e3*this.delay,1,"close")},close:function(){this.root_wnd&&(this.root_wnd.destroy(),this.root_wnd=null),s.getInstance().releasePrefab(this.prefabPath),gcore.Timer.del("close")}});cc._RF.pop()},{loadermanager:"loadermanager",partner_calculate:"partner_calculate",pathtool:"pathtool",tips_controller:"tips_controller"}],adventure_cell_item_panel:[function(t,e,i){"use strict";cc._RF.push(e,"b8c57VO6MhBtY8V10jV1tQ5","adventure_cell_item_panel");var s=t("pathtool"),n=t("adventure_event"),a=t("adventure_const"),o=t("adventure_controller"),l=t("playerhead");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("adventure","adventure_cell_item"),this.ctrl=o.getInstance(),this.model=this.ctrl.getModel()},initConfig:function(){this.cell_path="ui_res/adventure/img/%s.png",this.evt_path="ui_res/adventure/evt/%s.png",this.is_last_floor=!1},initPanel:function(){this.container=this.root_wnd.getChildByName("container"),this.background=this.container.getChildByName("background"),this.cell=this.container.getChildByName("cell").getComponent(cc.Sprite),this.evt_container=this.container.getChildByName("evt_container"),this.data&&this.updateInfo()},setVisible:function(t){this._super(t),t&&this.updateEvtInfo()},registerEvent:function(){Utils.onTouchEnd(this.container,function(){if(this.data&&this.call_back){if(this.data&&this.data.config&&this.data.status==a.status.over&&this.data.config.evt_type!=n.EventType.next&&this.data.config.evt_type!=n.EventType.shop)return;this.call_back(this)}}.bind(this),1)},addCallBack:function(t){this.call_back=t},setExtendData:function(t){this.is_update=t},setData:function(t){this.data=t,this.root_wnd&&this.updateInfo()},updateInfo:function(){if(this.data){this.is_last_floor=!1;var t=Utils.getNorKey(this.data.lock,this.data.id,this.data.status,this.data.evt_id);if(this.cell_key_str==t)return;this.cell_key_str=t,this.setOtherDesc(!1),this.cell_id!=this.data.id&&(this.cell_id=this.data.id),this.updateEvtInfo(),this.data.status==a.status.open||this.data.status==a.status.over?this.cell.node.active=!1:this.data.config&&this.data.config.evt_type==n.EventType.mysterious?this.cell.node.active=!1:this.createCellSytle()}},createCellSytle:function(){if(null!=this.data){var t=this.data;this.cell.node.active=!0;var e=cc.js.formatStr(this.cell_path,t.res_id);this.cell_res!=e?(this.cell_res=e,this.cell&&(this.loadRes(e,function(t){this.cell.spriteFrame=t}.bind(this)),this.setCellStatus())):this.setCellStatus()}},setCellStatus:function(){null!=this.data&&this.cell_status!=this.data.status&&(this.cell_status=this.data.status,this.data.status==a.status.lock?this.cell.node.color=new cc.Color(115,115,115,255):this.data.status==a.status.can_open&&(this.cell.node.color=new cc.Color(255,255,255,255)))},clearEvtResources:function(){this.event_img&&this.event_img.node.stopAllActions(),this.head&&this.head.deleteMe(),this.head=null,this.head_node&&this.head_node.stopAllActions(),this.head_node=null,this.event_model&&(this.event_model.setToSetupPose&&this.event_model.setToSetupPose(),this.event_model.clearTracks&&this.event_model.clearTracks(),this.event_model.node&&(this.event_model.node.removeAllChildren(),this.event_model.node.removeFromParent()),this.event_model=null),this.event_model_res=""},updateEvtInfo:function(){if(null!=this.data&&this.getVisible()){var t=this.data.evt_id>0?gdata("adventure_data","data_adventure_event",this.data.evt_id):null;if(this.data.config=t,null!=t&&null!=t.res_id&&null!=t.res_id[0]){if(t.evt_type==n.EventType.next){var e=this.model.getAdventureBaseData();if(null==e||null==e.id)return void this.clearEvtResources();null==Config.adventure_data.data_floor_reward[e.id+1]&&t.evt_type==n.EventType.next&&(this.is_last_floor=!0)}this.data.status!=a.status.over||t.evt_type==n.EventType.init||t.evt_type==n.EventType.next||t.evt_type==n.EventType.block||t.evt_type==n.EventType.shop?this.createEvtShowInfo(t):this.clearEvtResources()}else this.clearEvtResources()}},setOtherDesc:function(t,e){t?(null==this.other_desc&&(this.other_desc=Utils.createLabel(24,new cc.Color(255,255,255,255),new cc.Color(0,0,0,255),71,60,e,this.container,null,cc.v2(.5,0))),this.other_desc.string=e,this.other_desc.node.active=!0):this.other_desc&&(this.other_desc.node.active=!1)},createEvtShowInfo:function(t){if(null!=t){var e=t.res_id[0],i=e[0],n=e[1],a=1==t.shadow;if(null!=i&&null!=n&&this.event_model_res!=Utils.getNorKey(i,n))if(this.clearEvtResources(),this.event_model_res=Utils.getNorKey(i,n),2==i){var o=new cc.Node;o.setAnchorPoint(.5,.5),o.setPosition(0,5),this.evt_container.addChild(o),this.event_model=o.addComponent(sp.Skeleton),this.eff_time&&gcore.Timer.del(this.eff_time),this.eff_time=gcore.Timer.set(function(){var t=s.getSpinePath(n,"action");this.loadRes(t,function(t){this.event_model.skeletonData=t,this.event_model.setAnimation(0,PlayerAction.action,!0)}.bind(this))}.bind(this),100,1)}else if(1==a){this.event_model=Utils.createImage(this.evt_container,null,0,-33,cc.v2(.5,.5),!1),this.loadRes(s.getUIIconPath("adventurewindow","adventurewindow_3"),function(t){this.event_model.spriteFrame=t}.bind(this)),this.head_node=new cc.Node,this.head_node.setAnchorPoint(.5,.5),this.head_node.setPosition(0,0),this.event_model.node.addChild(this.head_node);var r=cc.js.formatStr(this.evt_path,n);this.ctrl.isMonster(t.evt_type)?(null==this.head&&(this.head=new l,this.head.setFrameRes(r,1),this.head.setPosition(0,62),this.head.setParent(this.head_node),this.head.show()),CommonAction.breatheShineAction4(this.head_node),this.head.setHeadRes(t.face)):(this.event_img=Utils.createImage(this.event_model.node,null,0,66,cc.v2(.5,.5),!1),CommonAction.breatheShineAction4(this.event_img.node),this.event_img&&this.loadRes(r,function(t){this.event_img.spriteFrame=t}.bind(this)))}else{this.event_model=Utils.createImage(this.evt_container,null,0,-31,cc.v2(.5,0),!1);r=cc.js.formatStr(this.evt_path,n);this.event_model&&this.loadRes(r,function(t){this.event_model.spriteFrame=t}.bind(this))}}},changeBossEffectStatus:function(t,e){1!=this.is_in_playing&&null!=this.data&&null!=this.data.config&&null!=this.event_model&&this.data.config.evt_type==n.EventType.mysterious&&(this.is_in_playing=!0,this.event_model.setAnimation(0,e,!1),Utils.delayRun(this.event_model.node,1.5,function(){this.is_in_playing=!1,t(this.data.id)}.bind(this)))},getEvtImg:function(){return this.event_img},onShow:function(t){},onHide:function(){},onDelete:function(){this.eff_time&&gcore.Timer.del(this.eff_time),this.clearEvtResources()}});cc._RF.pop()},{adventure_const:"adventure_const",adventure_controller:"adventure_controller",adventure_event:"adventure_event",pathtool:"pathtool",playerhead:"playerhead"}],adventure_const:[function(t,e,i){"use strict";cc._RF.push(e,"d6b90+jmXxJr5ORu6cqVV8B","adventure_const");e.exports={status:{lock:0,can_open:1,open:2,over:3}},cc._RF.pop()},{}],adventure_controller:[function(t,e,i){"use strict";var s;function n(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}cc._RF.push(e,"2a75aWyuEhNnp+ieh6x44kp","adventure_controller");var a=t("adventure_event"),o=t("battle_const"),l=t("mainui_controller"),r=t("mainui_const"),c=t("battle_controller"),_=cc.Class((n(s={extends:BaseController,ctor:function(){},initConfig:function(){var e=t("adventure_model");this.model=new e,this.model.initConfig()},getModel:function(){return this.model},registerEvents:function(){},registerProtocals:function(){this.RegisterProtocal(20600,this.handle20600),this.RegisterProtocal(20601,this.handle20601),this.RegisterProtocal(20602,this.handle20602),this.RegisterProtocal(20603,this.handle20603),this.RegisterProtocal(20604,this.handle20604),this.RegisterProtocal(20605,this.handle20605),this.RegisterProtocal(20606,this.handle20606),this.RegisterProtocal(20607,this.handle20607),this.RegisterProtocal(20608,this.handle20608),this.RegisterProtocal(20609,this.handle20609),this.RegisterProtocal(20610,this.handle20610),this.RegisterProtocal(20611,this.handle20611),this.RegisterProtocal(20612,this.handle20612),this.RegisterProtocal(20620,this.handle20620),this.RegisterProtocal(20621,this.handle20621),this.RegisterProtocal(20622,this.handle20622),this.RegisterProtocal(20623,this.handle20623),this.RegisterProtocal(20624,this.handle20624),this.RegisterProtocal(20625,this.handle20625),this.RegisterProtocal(20627,this.handle20627),this.RegisterProtocal(20628,this.handle20628),this.RegisterProtocal(20630,this.handle20630),this.RegisterProtocal(20631,this.handle20631),this.RegisterProtocal(20632,this.handle20632),this.RegisterProtocal(20633,this.handle20633),this.RegisterProtocal(20634,this.handle20634),this.RegisterProtocal(20635,this.handle20635)},isMonster:function(t){return t==a.EventType.boss||t==a.EventType.mon||t==a.EventType.mon1||t==a.EventType.mon2||t==a.EventType.mon3},openAnswerView:function(t,e){0==t?null!=this.adventure_answer_view&&(this.adventure_answer_view.close(),this.adventure_answer_view=null):(null==this.adventure_answer_view&&(this.adventure_answer_view=Utils.createClass("adventure_evt_answer_window",this)),this.adventure_answer_view&&0==this.adventure_answer_view.isOpen()&&this.adventure_answer_view.open(e))},requestEnterAdventure:function(){var t=this.model.getFormList();null==t||null==Utils.next(t)?this.openAdventureFormWindow(!0):l.getInstance().requestOpenBattleRelevanceWindow(o.Fight_Type.Adventrue)},openAdventureFormWindow:function(t){t?(null==this.form_window&&(this.form_window=Utils.createClass("adventure_form_window",this)),this.form_window&&0==this.form_window.isOpen()&&this.form_window.open()):this.form_window&&(this.form_window.close(),this.form_window=null)},openAdventureMainWindow:function(t){if(t){var e=this.model.getFormList();if(null==e||null==Utils.next(e))return;if(null==this.model.getAdventureBaseData())return;null==this.adventure_window&&(this.adventure_window=Utils.createClass("adventure_main_window",this)),this.adventure_window&&0==this.adventure_window.isOpen()&&this.adventure_window.open()}else this.adventure_window&&(this.adventure_window.close(),this.adventure_window=null)},openWindowByConfig:function(t){if(null!=t&&null!=t.config){var e=t.config;if(this.isMonster(e.evt_type)){if(1==this.model.allHeroIsDie())return void message(Utils.TI18N("\u82f1\u96c4\u5168\u90e8\u9635\u4ea1,\u672c\u8f6e\u5192\u9669\u5df2\u7ed3\u675f!"));this.openEvtViewByType(!0,"adventure_evt_challenge_window",t)}else e.evt_type==a.EventType.box?this.openEvtViewByType(!0,"adventure_evt_box_window",t):e.evt_type==a.EventType.finger_guessing?this.openEvtViewByType(!0,"adventure_evt_fighterguess_window",t):e.evt_type==a.EventType.answer?this.openEvtViewByType(!0,"adventure_evt_answer_start_window",t):e.evt_type==a.EventType.npc?this.openEvtViewByType(!0,"adventure_evt_npc_window",t):e.evt_type==a.EventType.freebox?this.openEvtViewByType(!0,"adventure_evt_free_box_window",t):e.evt_type==a.EventType.npc_talk?this.openEvtViewByType(!0,"adventure_evt_other_npc_window",t):e.evt_type==a.EventType.shop?this.openEvtViewByType(!0,"adventure_evt_shop_window",t):e.evt_type==a.EventType.effect&&this.send20620(t.id,a.AdventureEvenHandleType.handle,{})}},openEvtViewByType:function(t,e,i,s,n){if(0==t)null!=this.adventure_evt_view&&(this.adventure_evt_view.close(),this.adventure_evt_view=null);else{if(null==i)return;e=e||"adventure_evt_challenge_window";null==this.adventure_evt_view&&(this.adventure_evt_view=Utils.createClass(e,this)),this.adventure_evt_view&&0==this.adventure_evt_view.isOpen()&&this.adventure_evt_view.open(i)}},openAdventrueShopWindow:function(t){t?(null==this.shop_window&&(this.shop_window=Utils.createClass("adventure_shop_window",this)),this.shop_window&&0==this.shop_window.isOpen()&&this.shop_window.open()):this.shop_window&&(this.shop_window.close(),this.shop_window=null)},openAdventureShotKillWindow:function(t,e){if(t){if(null==e)return;null==this.shot_kill_window&&(this.shot_kill_window=Utils.createClass("adventure_shot_kill_window",this)),this.shot_kill_window&&0==this.shot_kill_window.isOpen()&&this.shot_kill_window.open(e)}else this.shot_kill_window&&(this.shot_kill_window.close(),this.shot_kill_window=null)},openAdventureUseHPWindow:function(t,e){if(t){if(null==e)return;null==this.use_hp_window&&(this.use_hp_window=Utils.createClass("adventure_use_hp_window",this)),this.use_hp_window&&0==this.use_hp_window.isOpen()&&this.use_hp_window.open(e)}else this.use_hp_window&&(this.use_hp_window.close(),this.use_hp_window=null)},send20620:function(t,e,i){var s={};s.room_id=t,s.action=e,s.ext_list=i||{},this.SendProtocal(20620,s)},handle20620:function(t){message(t.msg),2==t.code&&this.openEvtViewByType(!1)},send20602:function(){this.SendProtocal(20602,{})},handle20602:function(t){this.model.setRoomList(t)},handle20603:function(t){this.model.updateRoomList(t)},send20604:function(){this.SendProtocal(20604,{})},handle20604:function(t){this.model.updateFormPartner(t.partners,t.id)},requestSetForm:function(t){var e={};e.plist=t||{},this.SendProtocal(20605,e)},handle20605:function(t){1==t.code&&(this.openAdventureFormWindow(!1),l.getInstance().requestOpenBattleRelevanceWindow(o.Fight_Type.Adventrue))},send20608:function(t){var e={};e.room_id=t,this.SendProtocal(20608,e)},handle20608:function(t){message(t.msg),1==t.code&&gcore.GlobalEvent.fire(a.HandleRoomOverEvent,t.room_id)},send20600:function(){this.SendProtocal(20600,{})},handle20600:function(t){t&&this.model.setAdventureBaseData(t)},send20601:function(){this.SendProtocal(20601,{})},handle20601:function(t){t&&this.model.setBuffData(t)},handle20622:function(t){t&&gcore.GlobalEvent.fire(a.Update_Evt_Buff_Info,t)},handle20621:function(t){t&&gcore.GlobalEvent.fire(a.Update_Evt_Guess_Result,t)},handle20623:function(t){t&&gcore.GlobalEvent.fire(a.Update_Evt_Answer_Info,t)},handle20628:function(t){t&&(message(t.msg),gcore.Timer.set(function(){this.openEvtViewByType(!1),this.showGetItemTips(t.items)}.bind(this),1e3,1))},handle20630:function(t){t&&gcore.GlobalEvent.fire(a.Update_Evt_Box_Result_Info,t)},handle20627:function(t){t&&gcore.GlobalEvent.fire(a.Update_Evt_Npc_Info,t)},handle20631:function(t){1==t.type?gcore.GlobalEvent.fire(a.Update_Evt_Shop_Info,t):2==t.type&&this.openAdventureEvtShopView(!0,t.list)},openAdventureEvtShopView:function(t,e){t?(null==this.shop_evt_window&&(this.shop_evt_window=Utils.createClass("adventure_evt_shop_window",this)),this.shop_evt_window&&0==this.shop_evt_window.isOpen()&&(e&&(e.is_auto=!0),this.shop_evt_window.open(e))):this.shop_evt_window&&(this.shop_evt_window.close(),this.shop_evt_window=null)},showGetItemTips:function(e,i,s){if(e){var n="";for(var a in e){var o=e[a];""!=n&&(n+="\uff0c");var l=Utils.getItemConfig(o.bid);if(gdata("item_data","data_assets_id2label",o.bid))n=cc.js.formatStr("%s<img src=%s></img><color=#289b14>x%s</color>",n,l.icon,o.num);else{var r=t("backpack_const");n=cc.js.formatStr("%s<color=%s>%s</color><color=#289b14>x%s</color>",n,r.quality_color(l.quality),l.name,o.num)}}n=1==i?0==(s=s||0)?cc.js.formatStr(Utils.TI18N("\u5e73\u5c40\uff01\u592a\u53ef\u60dc\u4e86\uff0c%s\u8fd8\u4f60"),n):1==s?cc.js.formatStr(Utils.TI18N("\u597d\u5427\uff0c\u8fd9%s\u5f52\u4f60\u4e86"),n):cc.js.formatStr(Utils.TI18N("\u770b\u4f60\u8fd9\u4e48\u53ef\u601c\uff0c\u8fd8\u4f60%s\u5427"),n):cc.js.formatStr(Utils.TI18N("\u83b7\u53d6%s"),n),Utils.playButtonSound("c_get"),message(n)}},openAdventureFloorResultWindow:function(t,e){if(t){if(null==e||null==e.items_list)return;null==this.floor_result_window&&(this.floor_result_window=Utils.createClass("adventure_floor_result_window",this)),this.floor_result_window&&0==this.floor_result_window.isOpen()&&this.floor_result_window.open(e)}else this.floor_result_window&&(this.floor_result_window.close(),this.floor_result_window=null)},handle20606:function(t){this.openAdventureFloorResultWindow(!0,t)},send20609:function(){this.SendProtocal(20609,{})},send20607:function(t,e){var i={};i.skill_id=t,i.val=e,this.SendProtocal(20607,i)},handle20607:function(t){message(t.msg),1==t.code&&(this.openAdventureShotKillWindow(!1),this.openAdventureUseHPWindow(!1))}},"send20609",function(t){this.SendProtocal(20609,{})}),n(s,"handle20609",function(t){t&&gcore.GlobalEvent.fire(a.UpdateSkillInfo,t.skill_list)}),n(s,"requestSelectPartner",function(t){var e={};e.id=t,this.SendProtocal(20610,e)}),n(s,"handle20610",function(t){1==t.code&&this.model.updateSelectPartnerID(t.id)}),n(s,"handle20624",function(t){gcore.GlobalEvent.fire(a.UpdateMonsterHP,t.hp_per)}),n(s,"send20611",function(){this.SendProtocal(20611,{})}),n(s,"handle20611",function(t){gcore.GlobalEvent.fire(a.UpdateShotKillInfo,t.room_list)}),n(s,"requestShopTotal",function(){this.SendProtocal(20632,{})}),n(s,"handle20632",function(t){gcore.GlobalEvent.fire(a.UpdateShopTotalEvent,t.list)}),n(s,"requestBuyShopItem",function(t){var e={};e.id=t,this.SendProtocal(20633,e)}),n(s,"handle20633",function(t){message(t.msg),1==t.code&&gcore.GlobalEvent.fire(a.UpdateShopItemEvent,t.id)}),n(s,"send20634",function(){this.SendProtocal(20634,{})}),n(s,"handle20634",function(t){this.model.setAdventureBoxStatus(t),gcore.GlobalEvent.fire(a.UpdateBoxTeskEvent,t)}),n(s,"send20635",function(t){var e={};e.id=t,this.SendProtocal(20635,e)}),n(s,"handle20635",function(t){message(t.msg)}),n(s,"openAdventureBoxRewardView",function(t,e){1==t?(null==this.box_reward_window&&(this.box_reward_window=Utils.createClass("adventure_box_reward_window",this)),this.box_reward_window&&0==this.box_reward_window.isOpen()&&this.box_reward_window.open(e)):this.box_reward_window&&(this.box_reward_window.close(),this.box_reward_window=null)}),n(s,"handle20625",function(t){gcore.GlobalEvent.fire(a.GetSkillForEffectAction,t.id,t.skill_id)}),n(s,"handle20612",function(t){l.getInstance().getUIFightType()==r.ui_fight_type.sky_scene&&(c.getInstance().isInFight()?null==this.battle_exit_event&&(this.battle_exit_event=gcore.GlobalEvent.bind(EventId.EXIT_FIGHT,function(t){t==o.Fight_Type.Adventrue&&this.showAdventureReset()}.bind(this))):this.showAdventureReset())}),n(s,"showAdventureReset",function(){this.battle_exit_event&&(gcore.GlobalEvent.unbind(this.battle_exit_event),this.battle_exit_event=null),l.getInstance().changeMainUIStatus(r.btn_index.main_scene),gcore.Timer.set(function(){var e=Utils.TI18N("\u795e\u754c\u5192\u9669\u5df2\u91cd\u7f6e\uff0c\u662f\u5426\u91cd\u65b0\u8fdb\u5165\uff1f");t("commonalert").show(e,Utils.TI18N("\u786e\u5b9a"),function(){this.requestEnterAdventure()}.bind(this),Utils.TI18N("\u53d6\u6d88"))}.bind(this),200,1)}),s));e.exports=_,cc._RF.pop()},{adventure_event:"adventure_event",adventure_model:"adventure_model",backpack_const:"backpack_const",battle_const:"battle_const",battle_controller:"battle_controller",commonalert:"commonalert",mainui_const:"mainui_const",mainui_controller:"mainui_controller"}],adventure_event:[function(t,e,i){"use strict";cc._RF.push(e,"44b50KPUKxJeLlSLUrcCvNt","adventure_event");var s={UPDATE_ROLE_ATTRIBUTE:"AdventureEvent.UPDATE_ROLE_ATTRIBUTE",SCENE_WALKEND:"AdventureEvent.SCENE_WALKEND",SCENE_CHANGE:"AdventureEvent.SCENE_CHANGE",UPDATE_RED_INFO:"AdventureEvent.UPDATE_RED_INFO",Update_Room_Base_Info:"AdventureEvent.Update_Room_Base_Info",Update_Buff_Info:"AdventureEvent.Update_Buff_Info",Update_Room_Info:"AdventureEvent.Update_Room_Info",Update_BackPack_Info:"AdventureEvent.Update_BackPack_Info",Update_Single_Room_Info:"AdventureEvent.Update_Single_Room_Info",Update_Evt_Buff_Info:"AdventureEvent.Update_Evt_Buff_Info",Update_Evt_Answer_Info:"AdventureEvent.Update_Evt_Answer_Info",Update_Adventure_Formation_Info:"AdventureEvent.Update_Adventure_Formation_Info",Update_Evt_Plunder_Info:"AdventureEvent.Update_Evt_Plunder_Info",Update_Evt_Npc_Info:"AdventureEvent.Update_Evt_Npc_Info",Update_Evt_Plunder_Partner_Info:"AdventureEvent.Update_Evt_Plunder_Partner_Info",Update_Evt_Guess_Result:"AdventureEvent.Update_Evt_Guess_Result",Update_Evt_Box_Result_Info:"AdventureEvent.Update_Evt_Box_Result_Info",Update_Plunder_Record_Info:"AdventureEvent.Update_Plunder_Record_Info",Update_Record_Plunder_View_Info:"AdventureEvent.Update_Record_Plunder_View_Info",Update_Red_Point_Info:"AdventureEvent.Update_Red_Point_Info",Update_Evt_Shop_Info:"AdventureEvent.Update_Evt_Shop_Info",Update_event_over_Info:"AdventureEvent.Update_event_over_Info",ResetFloorEvent:"AdventureEvent.ResetFloorEvent",HandleRoomOverEvent:"AdventureEvent.HandleRoomOverEvent",UpdateAdventureForm:"AdventureEvent.UpdateAdventureForm",UpdateSkillInfo:"AdventureEvent.UpdateSkillInfo",UpdateAdventureSelectHero:"AdventureEvent.UpdateAdventureSelectHero",UpdateMonsterHP:"AdventureEvent.UpdateMonsterHP",UpdateShotKillInfo:"AdventureEvent.UpdateShotKillInfo",UpdateShopTotalEvent:"AdventureEvent.UpdateShopTotalEvent",UpdateShopItemEvent:"AdventureEvent.UpdateShopItemEvent",GetSkillForEffectAction:"AdventureEvent.GetSkillForEffectAction",UpdateBoxTeskEvent:"AdventureEvent.UpdateBoxTeskEvent",BackPackType:{BackPackView:1,NextFloor:2},EventType:{null:0,buff:1,boss:2,finger_guessing:3,box:4,mon:5,npc:6,answer:7,next:9,effect:10,block:11,freebox:12,npc_talk:13,shop:14,mysterious:15,init:16,mon1:17,mon2:18,mon3:19,skill:20},AdventureEvenHandleType:{requst:0,handle:1,refresh:2,hook:3},AdventurePluderRecordType:{defence:1,act:2},AdventureResetType:{reset:1,next:2},AdventureViewType:{myself:1,other:2}};e.exports=s,cc._RF.pop()},{}],adventure_evt_answer_start_window:[function(t,e,i){"use strict";cc._RF.push(e,"85ee26WszVOm78fFbB2kBM7","adventure_evt_answer_start_window");var s=t("pathtool");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("adventure","adventure_evt_answer_start_view"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Mini,this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){this.data=null,this.config=null},openCallBack:function(){this.background=this.root_wnd.getChildByName("background"),this.background.scale=FIT_SCALE,this.main_container=this.root_wnd.getChildByName("root"),this.item_icon_node=this.main_container.getChildByName("item_icon"),this.item_icon_node.scale=2,this.item_icon=this.item_icon_node.getComponent(cc.Sprite),this.loadRes(s.getBigBg("bigbg_47"),function(t){this.item_icon.spriteFrame=t}.bind(this)),this.close_btn=this.main_container.getChildByName("close_btn"),this.ack_button=this.main_container.getChildByName("ack_button"),this.ack_label=this.ack_button.getChildByName("Label").getComponent(cc.Label),this.ack_label.string=Utils.TI18N("\u5f00\u59cb\u7b54\u9898"),this.title_label=this.main_container.getChildByName("title_label").getComponent(cc.Label),this.title_label.string=Utils.TI18N("\u667a\u529b\u5927\u4e71\u6597"),this.swap_desc_label=Utils.createRichLabel(26,new cc.Color(104,69,42,255),cc.v2(.5,.5),cc.v2(0,-this.main_container.getContentSize().height/2+440),30,600),this.swap_desc_label.horizontalAlign=cc.macro.TextAlignment.LEFT,this.main_container.addChild(this.swap_desc_label.node),this.swap_desc_label.node.active=!0},registerEvent:function(){Utils.onTouchEnd(this.background,function(){this.ctrl.openEvtViewByType(!1)}.bind(this),2),Utils.onTouchEnd(this.close_btn,function(){this.ctrl.openEvtViewByType(!1)}.bind(this),2),Utils.onTouchEnd(this.ack_button,function(){this.config&&(this.ctrl.openEvtViewByType(!1),this.ctrl.openAnswerView(!0,this.data))}.bind(this),1)},updatedata:function(){this.config&&(this.swap_desc_label.string=this.config.desc)},openRootWnd:function(t){this.data=t,this.config=t.config,this.updatedata()},closeCallBack:function(){this.ctrl.openEvtViewByType(!1)}});cc._RF.pop()},{pathtool:"pathtool"}],adventure_evt_answer_window:[function(t,e,i){"use strict";function s(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}cc._RF.push(e,"a5347drZDtBtbdFf0cF1F7n","adventure_evt_answer_window");var n=t("pathtool"),a=t("adventure_event");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=n.getPrefabPath("adventure","adventure_evt_answer_view"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Full,this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){this.data=null,this.config=null,this.item_list=[],this.btn_list=[],this.str=""},openCallBack:function(){this.background=this.root_wnd.getChildByName("background"),this.background.scale=FIT_SCALE,this.main_container=this.root_wnd.getChildByName("root"),this.close_btn=this.main_container.getChildByName("close_btn"),this.start_container=this.main_container.getChildByName("start_container"),this.role_bg=this.main_container.getChildByName("role_bg").getComponent(cc.Sprite),this.loadRes(n.getBigBg("bigbg_25"),function(t){this.role_bg.spriteFrame=t}.bind(this)),this.total_desc=this.main_container.getChildByName("total_desc").getComponent(cc.Label),this.total_desc.string=Utils.TI18N("\u5168\u5bf9\u5956\u52b1"),this.title_label=this.main_container.getChildByName("title_label").getComponent(cc.Label),this.title_label.string=Utils.TI18N("\u667a\u529b\u5927\u4e71\u6597"),this.this_desc=this.main_container.getChildByName("this_desc").getComponent(cc.Label),this.this_desc.string=Utils.TI18N("\u5f53\u524d\u5956\u52b1"),this.item_container=this.main_container.getChildByName("item_container"),this.base_reward_label=Utils.createRichLabel(26,new cc.Color(202,114,36,255),cc.v2(0,.5),cc.v2(-this.main_container.width/2+315,-this.main_container.height/2+455),36,500),this.main_container.addChild(this.base_reward_label.node),this.base_reward_label.node.active=!0,this.base_reward_label.horizontalAlign=cc.macro.TextAlignment.LEFT,this.talk_bg=this.main_container.getChildByName("talk_bg")},registerEvent:function(){Utils.onTouchEnd(this.background,function(){this.ctrl.openAnswerView(!1)}.bind(this),2),Utils.onTouchEnd(this.close_btn,function(){this.ctrl.openAnswerView(!1)}.bind(this),2),this.addGlobalEvent(a.Update_Evt_Answer_Info,function(t){this.updateAnswerData(t)}.bind(this))},updateBackItem:function(t){if(t){var e=120*t.length+5*t.length;for(var i in this.start_x=.5*(this.item_container.getContentSize().width-e)+60,t){if(!this.item_list[i]){var s=ItemsPool.getInstance().getItem("backpack_item");s.initConfig(!0),s.setAnchorPoint(0,.5),s.setParent(this.item_container),s.show(),this.item_list[i]=s}var n=this.item_list[i];if(n){n.setData({bid:t[i].bid,num:t[i].num}),n.setDefaultTip();var a=this.start_x+130*i;n.setPosition(a,this.item_container.getContentSize().height/2)}}}},updateAnswerData:function(t){if(this.answer_data=t,this.cur_answer_bid=t.bid,t.now_items&&null!=Utils.next(t.now_items||{}))for(var e in this.str="",t.now_items){var i=t.now_items[e];if(Utils.getItemConfig(i.bid)){var s=Utils.getItemConfig(i.bid).icon,a=cc.js.formatStr("<img src='%s'/><color=#ffce0c>%s   </color>",s,i.num);this.str=this.str+a,this.loadRes(n.getItemRes(s),function(t){this.base_reward_label.spriteFrame=t}.bind(this))}}this.base_reward_label.string=this.str,this.updateBackItem(t.max_items),0==t.ret?this.updateNext():this.main_container.runAction(cc.sequence(cc.callFunc(function(t){if(this.btn_list)for(var e in this.btn_list){var i=this.btn_list[e];i.right.node.active=!1,i.fail.node.active=!1,i&&i.index==t.sel_val?1==t.ret?i.right.node.active=!0:i.fail.node.active=!0:i&&i.index==t.right&&2==t.ret&&(i.right.node.active=!0)}}.bind(this,t)),cc.delayTime(1),cc.callFunc(function(t){0==t.bid?(this.ctrl.openAnswerView(!1),message(t.ret_msg),t.ret_items&&null!=Utils.next(t.ret_items||{})&&this.ctrl.showGetItemTips(t.ret_items)):this.updateNext()}.bind(this,t))))},updateNext:function(){if(this.answer_num||(this.answer_num=Utils.createRichLabel(26,new cc.Color(104,69,42,255),cc.v2(0,1),cc.v2(-this.main_container.width/2+345,-this.main_container.height/2+960),30),this.answer_num.horizontalAlign=cc.macro.TextAlignment.LEFT,this.main_container.addChild(this.answer_num.node)),this.answer_desc||(this.answer_desc=Utils.createRichLabel(26,new cc.Color(104,69,42,255),cc.v2(0,1),cc.v2(-this.main_container.width/2+345,-this.main_container.height/2+920),30,325),this.answer_desc.horizontalAlign=cc.macro.TextAlignment.LEFT,this.main_container.addChild(this.answer_desc.node)),this.answer_num&&(this.answer_num.string=Utils.TI18N("\u7b2c")+this.answer_data.num+"/"+this.answer_data.max+Utils.TI18N("\u9898")),0!=this.answer_data.bid){if(this.btn_list)for(var t in this.btn_list)this.btn_list[t]&&(this.btn_list[t].node.active=!1);var e=Config.adventure_data.data_adventure_answer[this.answer_data.bid];this.answer_desc.string=e.desc;var i=Config.adventure_data.data_adventure_kind_answer[this.answer_data.bid],a=cc.size(290,87);if(i){var o,l,r=(s(o={},1,"a"),s(o,2,"b"),s(o,3,"c"),s(o,4,"d"),o),c=[],_=0;for(t=1;t<=4;t++)i[r[t]]&&i[r[t]].length>0&&(c[t]=i[r[t]],_+=1);var h=(s(l={},1,"A "),s(l,2,"B "),s(l,3,"C "),s(l,4,"D "),l);for(t=1;t<=_;t++){if(!this.btn_list[t]){var d=new cc.Node;d.setAnchorPoint(.5,.5),d.setContentSize(a),this.start_container.addChild(d);var u=d.addComponent(cc.Sprite);u.type=cc.Sprite.Type.SLICED,u.sizeMode=cc.Sprite.SizeMode.CUSTOM,(b=d.addComponent(cc.Button)).transition=cc.Button.Transition.SPRITE,this.loadRes(n.getCommonIcomPath("common_1029"),function(t,e,i){t.normalSprite=i,e.spriteFrame=i}.bind(this,b,u)),this.loadRes(n.getCommonIcomPath("common_1020"),function(t,e){t.pressedSprite=e}.bind(this,b)),d.active=!1;var m=Utils.createImage(d,null,-a.width/2+55,0);m.node.active=!0,this.loadRes(n.getUIIconPath("adventure","adventure_50"),function(t,e){t.spriteFrame=e}.bind(this,m));var f=Utils.createLabel(33,new cc.Color(104,69,42,255),null,-a.width/2+89,0,"",d,null,cc.v2(0,.5));b.name=f;var p=Utils.createLabel(26,new cc.Color(104,69,42,255),null,-a.width/2+120,0,"",d,null,cc.v2(0,.5));b.answer=p;var g=Utils.createImage(d,null,-a.width/2+240,0);g.node.active=!1,this.loadRes(n.getUIIconPath("adventure","adventure_54"),function(t,e){t.spriteFrame=e}.bind(this,g));var v=Utils.createImage(d,null,-a.width/2+240,0);v.node.active=!1,this.loadRes(n.getUIIconPath("adventure","adventure_47"),function(t,e){t.spriteFrame=e}.bind(this,v)),b.fail=v,b.right=g,b.index=t,b.node.index=t,this.btn_list[t]=b}var b;(b=this.btn_list[t])&&(b.node.off(cc.Node.EventType.TOUCH_END,this.onBtnClick,this),b.node.active=!0,b.fail.node.active=!1,b.right.node.active=!1,b.name.string=h[t],b.answer.string=c[t],b.node.setPosition(-this.start_container.width/2+155+(a.width+20)*((t-1)%2),160-this.start_container.height-(a.height+20)*Math.floor((t-1)/2)),b.node.on(cc.Node.EventType.TOUCH_END,this.onBtnClick,this))}}}},onBtnClick:function(t){if(this.data){var e=[{type:1,val:t.target.index}];this.ctrl.send20620(this.data.id,a.AdventureEvenHandleType.handle,e)}},openRootWnd:function(t){this.data=t,this.config=t.config,this.data&&this.ctrl.send20620(this.data.id,a.AdventureEvenHandleType.requst,{})},closeCallBack:function(){for(var t in this.item_list)this.item_list[t].deleteMe();this.item_list=null,this.ctrl.openAnswerView(!1)}});cc._RF.pop()},{adventure_event:"adventure_event",pathtool:"pathtool"}],adventure_evt_box_window:[function(t,e,i){"use strict";cc._RF.push(e,"ab8149PZSRLzbaLoKSV2y/9","adventure_evt_box_window");var s=t("pathtool"),n=t("backpack_controller"),a=t("adventure_event");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("adventure","adventure_evt_box_view"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Big,this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){this.data=null,this.config=null,this.item_list=[],this.need_list=[]},openCallBack:function(){this.background=this.root_wnd.getChildByName("background"),this.background.scale=FIT_SCALE,this.main_container=this.root_wnd.getChildByName("root"),this.close_btn=this.main_container.getChildByName("close_btn"),this.item_container=this.main_container.getChildByName("item_container"),this.ack_button=this.main_container.getChildByName("ack_button"),this.ack_button.getChildByName("label").getComponent(cc.Label).string=Utils.TI18N("\u6253 \u5f00"),this.title_label=this.main_container.getChildByName("title_label").getComponent(cc.Label),this.title_label.string=Utils.TI18N("\u5b9d\u7bb1"),this.reward_label=this.main_container.getChildByName("reward_label").getComponent(cc.Label),this.reward_label.string=Utils.TI18N("\u968f\u673a\u5956\u52b1\u9884\u89c8"),this.swap_desc_label=Utils.createRichLabel(24,new cc.Color(104,69,42,255),cc.v2(.5,1),cc.v2(0,-this.main_container.height/2+760),30,610),this.main_container.addChild(this.swap_desc_label.node);var e=this.item_container.getContentSize(),i=t("common_scrollview");this.item_scrollview=new i,this.item_scrollview.createScroll(this.item_container,cc.v2(-e.width/2,-e.height),ScrollViewDir.vertical,ScrollViewStartPos.top,cc.size(e.width,e.height-49),{item_class:"backpack_item",start_x:10,space_x:15,start_y:5,space_y:10,item_width:108,item_height:108,row:0,col:5,scale:.9})},registerEvent:function(){Utils.onTouchEnd(this.background,function(){this.ctrl.openEvtViewByType(!1)}.bind(this),2),Utils.onTouchEnd(this.close_btn,function(){this.ctrl.openEvtViewByType(!1)}.bind(this),2),Utils.onTouchEnd(this.ack_button,function(){if(this.data){this.ctrl.send20620(this.data.id,a.AdventureEvenHandleType.handle,[{type:1,val:0}])}}.bind(this),1),this.addGlobalEvent(a.Update_Evt_Box_Result_Info,function(t){t&&this.updateResult(t)}.bind(this))},updatedata:function(){this.config&&(this.swap_desc_label.string=this.config.desc,this.config.lose&&null!=Utils.next(this.config.lose[0]||{})&&this.updateItemData(this.config.lose),this.createEffect(this.config.effect_str),this.config.box_show_item&&null!=Utils.next(this.config.box_show_item||{})&&this.updateRankItemData(this.config.box_show_item))},createEffect:function(t){if(""!=t&&this.main_container&&null==this.box_effect){var e=new cc.Node;e.setAnchorPoint(.5,.5),e.setPosition(-this.main_container.width/2+375,-this.main_container.height/2+855),e.setScale(1.5),this.main_container.addChild(e),this.box_effect=e.addComponent(sp.Skeleton);var i=s.getSpinePath(t,"action");this.loadRes(i,function(t){this.box_effect.skeletonData=t,this.box_effect.setAnimation(0,PlayerAction.action,!0)}.bind(this))}},updateItemData:function(t){if(t&&null!=Utils.next(t||{})){this.need_list=t;var e=120*t.length+5*t.length;for(var i in this.start_x=.5*(this.item_container.getContentSize().width-e),t){var s=t[i];if(!this.item_list[i]){var a=ItemsPool.getInstance().getItem("backpack_item");a.initConfig(!0),a.setAnchorPoint(.5,.5),a.setScale(.8),a.show(),a.setData({bid:s[0],num:s[1]}),a.setDefaultTip();var o=n.getInstance().getModel().getBackPackItemNumByBid(s[0]);a.setNeedNum(s[1],o),a.bid=s[0],a.setParent(this.main_container),a.setPosition(-this.main_container.width/2+360,-this.main_container.height/2+408),this.item_list[i]=a}}}},updateRankItemData:function(t){if(t){var e=[];for(var i in t){var s=t[i],n={};(n=Utils.deepCopy(Utils.getItemConfig(s[0]))).num=s[1],e.push(n)}this.item_scrollview.setData(e),this.item_scrollview.addEndCallBack(function(){var t=this.item_scrollview.getItemList();for(var e in t)t[e].setDefaultTip(),t[e].data&&1!=t[e].data.num&&t[e].setItemNum(t[e].data.num)}.bind(this))}},updateResult:function(t){this.box_effect.setAnimation(0,PlayerAction.action_1,!1),gcore.Timer.set(function(){this.ctrl.showGetItemTips(t.items),this.ctrl.openEvtViewByType(!1)}.bind(this),1e3,1)},updateNum:function(t){if(this.item_list)for(var e in this.item_list){var i=this.item_list[e];if(i&&i.num_label&&i.bid==t){var s=n.getInstance().getModel().getBackPackItemNumByBid(i.bid);i.num_label.string=cc.js.formatStr(Utils.TI18N("\u62e5\u6709<color=#e14737>%s</color>\u4e2a"),s)}}},openRootWnd:function(t){this.data=t,this.config=t.config,this.updatedata()},closeCallBack:function(){if(this.item_list){for(var t in this.item_list)this.item_list[t]&&this.item_list[t].deleteMe();this.item_list=null}this.item_scrollview&&(this.item_scrollview.deleteMe(),this.item_scrollview=null),this.ctrl.openEvtViewByType(!1)}});cc._RF.pop()},{adventure_event:"adventure_event",backpack_controller:"backpack_controller",common_scrollview:"common_scrollview",pathtool:"pathtool"}],adventure_evt_challenge_window:[function(t,e,i){"use strict";cc._RF.push(e,"fc9b2pTThpPK4Gu1jwJgeGB","adventure_evt_challenge_window");var s=t("pathtool"),n=t("adventure_event");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("adventure","adventure_evt_challenge_window"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Big,this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){this.hero_list={},this.data=null,this.is_skip_fight=!1},openCallBack:function(){this.background=this.root_wnd.getChildByName("background"),this.background.scale=FIT_SCALE;var t=this.root_wnd.getChildByName("container");t.getChildByName("win_title").getComponent(cc.Label).string=Utils.TI18N("\u6311\u6218\u5b88\u536b"),t.getChildByName("change_title").getComponent(cc.Label).string=Utils.TI18N("\u9009\u62e9\u82f1\u96c4"),t.getChildByName("self_title").getComponent(cc.Label).string=Utils.TI18N("\u6211\u65b9"),t.getChildByName("other_title").getComponent(cc.Label).string=Utils.TI18N("\u5b88\u536b"),this.challenge_btn=t.getChildByName("challenge_btn"),this.challenge_btn.getChildByName("label").getComponent(cc.Label).string=Utils.TI18N("\u8fdb\u5165\u6218\u6597"),this.cur_hero_item=ItemsPool.getInstance().getItem("hero_exhibition_item"),this.cur_hero_item.setExtendData({can_click:!0}),this.cur_hero_item.setRootPosition(cc.v2(-t.width/2+158,-t.height/2+447)),this.cur_hero_item.showProgressbar(100),this.cur_hero_item.show(),this.cur_hero_item.setParent(t),this.target_hero_item=ItemsPool.getInstance().getItem("hero_exhibition_item"),this.target_hero_item.setExtendData({can_click:!0}),this.target_hero_item.setRootPosition(cc.v2(-t.width/2+560,-t.height/2+447)),this.target_hero_item.showProgressbar(100),this.target_hero_item.show(),this.target_hero_item.setParent(t),this.other_name=t.getChildByName("other_name").getComponent(cc.Label),this.power_val_nd=this.seekChild("power_val"),this.fight_label=this.power_val_nd.getComponent("CusRichText"),this.container=t,this.checkboxNode=t.getChildByName("checkbox"),this.checkBg=this.checkboxNode.getChildByName("Background"),this.checkbox=this.checkboxNode.getComponent(cc.Toggle),this.checkBg.getChildByName("name").getComponent(cc.Label).string=Utils.TI18N("\u8df3\u8fc7\u6218\u6597"),this.checkboxNode.active=!1},registerEvent:function(){Utils.onTouchEnd(this.background,function(){this.ctrl.openEvtViewByType(!1)}.bind(this),2),Utils.onTouchEnd(this.challenge_btn,function(){if(this.data){var t=[];this.is_skip_fight&&t.push({type:2,val:1}),this.ctrl.send20620(this.data.id,n.AdventureEvenHandleType.handle,t)}}.bind(this),1),Utils.onTouchEnd(this.checkboxNode,function(){var t=!this.checkbox.isChecked;this.is_skip_fight=t}.bind(this),1),this.addGlobalEvent(n.UpdateMonsterHP,function(t){this.target_hero_item&&(t=t||0,this.target_hero_item.showProgressbar(t))}.bind(this))},openRootWnd:function(t){var e;(this.data=t,this.data)&&(this.ctrl.send20620(this.data.id,n.AdventureEvenHandleType.requst,{}),this.target_hero_item&&this.data&&this.data.config&&(this.target_hero_item.setUnitData(this.data.config.unit_id),(e=Utils.getUnitConfig(this.data.config.unit_id))&&(this.other_name.string=e.name)));(this.createHeroList(),this.base_data=this.model.getAdventureBaseData(),this.base_data)&&((e=Config.adventure_data.data_floor_reward[this.base_data.id])&&1==e.auto_combat&&(this.checkboxNode.active=!0,this.is_skip_fight=gcore.SysEnv.getBool("adventure_skip_fight",!0),this.checkbox.isChecked=this.is_skip_fight))},createHeroList:function(){var t=this.model.getFormList(),e=this.model.getSelectPartnerID();for(var i in t){var s=function(t){this.selectHeroItem(t)}.bind(this);null==this.hero_list[i]&&(this.hero_list[i]=ItemsPool.getInstance().getItem("hero_exhibition_item"),this.hero_list[i].setExtendData({scale:.9,can_click:!0}),this.hero_list[i].setRootPosition(cc.v2(-this.container.width/2+110+124*i,-this.container.height/2+206)),this.hero_list[i].addCallBack(s),this.hero_list[i].show(),this.hero_list[i].setParent(this.container));var n=this.hero_list[i];this.updateHeroInfo(n,t[i]),0!=e&&t[i].partner_id==e&&this.selectHeroItem(n)}},selectHeroItem:function(t){if(t){var e=t.getData();if(e)if(0!=e.now_hp){if(this.select_cell!=t){this.select_cell&&(this.select_cell.setSelected(!1),this.select_cell=null),this.select_cell=t,this.select_cell.setSelected(!0),this.fight_label.setNum(e.power),this.ctrl.requestSelectPartner(e.partner_id),this.cur_hero_item.setData(e);var i=e.now_hp/e.hp;this.cur_hero_item.showProgressbar(100*i)}}else message(Utils.TI18N("\u6b7b\u4ea1\u82f1\u96c4\u65e0\u6cd5\u9009\u62e9"))}},updateHeroInfo:function(t,e){if(null!=t){t.setData(e);var i=e.now_hp/e.hp;t.showProgressbar(100*i),0==i?t.showStrTips(!0,Utils.TI18N("\u5df2\u9635\u4ea1")):t.showStrTips(!1)}},closeCallBack:function(){for(var t in gcore.SysEnv.set("adventure_skip_fight",this.is_skip_fight,!0),this.cur_hero_item&&this.cur_hero_item.deleteMe(),this.cur_hero_item=null,this.target_hero_item&&this.target_hero_item.deleteMe(),this.target_hero_item=null,this.hero_list)this.hero_list[t].deleteMe();this.item_list=null,this.ctrl.openEvtViewByType(!1)}});cc._RF.pop()},{adventure_event:"adventure_event",pathtool:"pathtool"}],adventure_evt_fighterguess_window:[function(t,e,i){"use strict";cc._RF.push(e,"69efcddvKVAUZjN7U8Ok/cn","adventure_evt_fighterguess_window");var s=t("pathtool"),n=t("adventure_event");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("adventure","adventure_finger_guessing_view"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Mini,this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){this.data=null,this.config=null,this.ext_list=[],this.btn_list={},this.item_btn={},this.cur_item_index=null},openCallBack:function(){this.background=this.root_wnd.getChildByName("background"),this.background.scale=FIT_SCALE,this.main_container=this.root_wnd.getChildByName("root"),this.close_btn=this.main_container.getChildByName("close_btn"),this.role_bg=this.main_container.getChildByName("role_bg"),this.bg_node=this.main_container.getChildByName("bg"),this.bg_node.scale=2,this.bg=this.bg_node.getComponent(cc.Sprite),this.loadRes(s.getBigBg("bigbg_21"),function(t){this.bg.spriteFrame=t}.bind(this)),this.role_bg=this.main_container.getChildByName("role_bg").getComponent(cc.Sprite),this.loadRes(s.getBigBg("bigbg_22"),function(t){this.role_bg.spriteFrame=t}.bind(this)),this.bottom_container=this.main_container.getChildByName("bottom_container"),this.title=this.main_container.getChildByName("window_title_label").getComponent(cc.Label),this.title.string=Utils.TI18N("\u731c\u62f3"),this.swap_desc_label=Utils.createRichLabel(26,new cc.Color(104,69,42,255),cc.v2(.5,.5),cc.v2(-this.main_container.width/2+227,-this.main_container.height/2+835),30,340),this.swap_desc_label.horizontalAlign=cc.macro.TextAlignment.LEFT,this.main_container.addChild(this.swap_desc_label.node),this.swap_desc_label.node.active=!0,this.desc_label=this.main_container.getChildByName("desc_label").getComponent(cc.Label),this.guide_container=this.main_container.getChildByName("guide_container"),this.guide_container_pos=cc.v2(this.guide_container.x,this.guide_container.y),this.guidel_label=this.guide_container.getChildByName("guide_label").getComponent(cc.Label),this.guidel_label.string=Utils.TI18N("\u8bf7\u4e0b\u6ce8"),Config.adventure_data.data_adventure_const.describe_mora&&(this.desc_label.string=Config.adventure_data.data_adventure_const.describe_mora.val);for(var t=1;t<=4;t++){var e=this.bottom_container.getChildByName(cc.js.formatStr("item_button_%s",t));e.label=e.getChildByName("item_label").getComponent(cc.Label),e.btn=e.getComponent(cc.Button),e.btn.interactable=!1,e.btn.enableAutoGrayEffect=!0,e.index=t,this.item_btn[t]=e}},registerEvent:function(){for(var t in this.item_btn)this.item_btn[t]&&Utils.onTouchEnd(this.item_btn[t],function(t){this.selecItem(t)}.bind(this,this.item_btn[t].index),3);Utils.onTouchEnd(this.background,function(){this.ctrl.openEvtViewByType(!1)}.bind(this),2),Utils.onTouchEnd(this.close_btn,function(){this.ctrl.openEvtViewByType(!1)}.bind(this),2),this.addGlobalEvent(n.Update_Evt_Guess_Result,function(t){t&&this.updateResult(t)}.bind(this))},updatedata:function(){this.config&&(this.swap_desc_label.string=this.config.desc,this.updateItemData(this.config.lose),this.updateGuessContainer())},updateGuessContainer:function(){if(this.main_container&&null==this.left_effect){var t=new cc.Node;t.setAnchorPoint(.5,.5),t.setPosition(-this.main_container.width/2+210,-this.main_container.height/2+640),this.main_container.addChild(t),this.left_effect=t.addComponent(sp.Skeleton);var e=s.getSpinePath(s.getEffectRes(134),"action");this.loadRes(e,function(t){this.left_effect&&(this.left_effect.skeletonData=t,this.left_effect.setAnimation(0,PlayerAction.action_4,!0))}.bind(this))}if(this.main_container&&null==this.right_effect){var i=new cc.Node;i.color=new cc.Color(115,115,115,255),i.setAnchorPoint(.5,.5),i.setPosition(-this.main_container.width/2+510,-this.main_container.height/2+640),i.scaleX=-1,this.main_container.addChild(i),this.right_effect=i.addComponent(sp.Skeleton);e=s.getSpinePath(s.getEffectRes(134),"action");this.loadRes(e,function(t){this.right_effect&&(this.right_effect.skeletonData=t,this.right_effect.setAnimation(0,PlayerAction.action_4,!0))}.bind(this))}for(var n=1;n<=3;n++){var a=this.main_container.getChildByName(cc.js.formatStr("Button_%s",n));a.btn=a.getComponent(cc.Button),a.btn.interactable=!1,a.btn.enableAutoGrayEffect=!0,a.index=n,this.btn_list[n]=a}for(var n in this.btn_list)this.btn_list[n]&&Utils.onTouchEnd(this.btn_list[n],function(t){this.selectBtn(t)}.bind(this,this.btn_list[n].index),3)},selectBtn:function(t){this.deleteExtlist(1),this.cur_select_index!=t?(null!=this.cur_tab&&(this.cur_tab.interactable=!1,this.cur_tab.enableAutoGrayEffect=!0),this.cur_select_index=t,this.cur_tab=this.btn_list[t].btn,null!=this.cur_tab&&(this.cur_tab.interactable=!0,this.cur_tab.enableAutoGrayEffect=!1),this.ext_list.push({type:1,val:t}),this.checkAsk()):null!=this.cur_tab&&(this.cur_tab.interactable=!1,this.cur_tab.enableAutoGrayEffect=!0,this.cur_tab=null,this.cur_select_index=null)},deleteExtlist:function(t){if(this.ext_list)for(var e in this.ext_list)this.ext_list[e].type==t&&this.ext_list.splice(e,1)},updateItemData:function(t){if(t)for(var e in t){var i=this.item_btn[parseInt(e)+1].label;i&&(i.string=t[e][1])}},selecItem:function(t){if(this.deleteExtlist(2),this.cur_item_index==t)return null!=this.cur_item_tab&&(this.cur_item_tab.interactable=!1,this.cur_item_tab.enableAutoGrayEffect=!0,this.cur_item_tab=null,this.cur_item_index=null),this.guide_container.active=!0,void this.guide_container.runAction(cc.sequence(cc.moveTo(.4,cc.v2(this.guide_container_pos)),cc.callFunc(function(){this.guidel_label.string=Utils.TI18N("\u8bf7\u4e0b\u6ce8")}.bind(this))));null!=this.cur_item_tab&&(this.cur_item_tab.interactable=!1,this.cur_item_tab.enableAutoGrayEffect=!0),this.cur_item_index=t,this.cur_item_tab=this.item_btn[t].btn,null!=this.cur_item_tab&&(this.cur_item_tab.interactable=!0,this.cur_item_tab.enableAutoGrayEffect=!1),this.guide_container.active=!0,this.guide_container.runAction(cc.sequence(cc.moveTo(.4,cc.v2(-this.main_container.width/2+123,-this.main_container.height/2+425)),cc.callFunc(function(){this.guidel_label.string=Utils.TI18N("\u8bf7\u51fa\u62f3")}.bind(this)))),this.ext_list.push({type:2,val:t}),this.checkAsk()},checkAsk:function(){if(null!=this.data){var t=0;for(var e in this.ext_list)t+=1;t>=2&&(this.guide_container.active=!1,this.ctrl.send20620(this.data.id,n.AdventureEvenHandleType.handle,this.ext_list))}},updateResult:function(t){if(this.left_effect){var e="action"+t.sel_val;this.left_effect.setAnimation(0,e,!1)}if(this.right_effect){e="action"+t.ret_val;this.right_effect.setAnimation(0,e,!1)}var i="";i=0==t.ret?Utils.TI18N("\u8d81\u4f60\u6ca1\u8f93\uff0c\u8d76\u7d27\u56de\u53bb\u5427"):1==t.ret?Utils.TI18N("\u613f\u8d4c\u670d\u8f93\uff0c\u4f60\u8d62\u4e86"):Utils.TI18N("\u5c0f\u5b50\uff0c\u56de\u53bb\u7ec3\u7ec3\u518d\u6765"),gcore.Timer.set(function(){this.showStr(i)}.bind(this),800),gcore.Timer.set(function(){this.ctrl.openEvtViewByType(!1),this.ctrl.showGetItemTips(t.items,!0,t.ret)}.bind(this),3e3)},showStr:function(t){StringUtil.splitStr(t);var e="";for(var i in void 0)Utils.delayRun(this.root_wnd,.1*i,function(t){e+=t.char,this.swap_desc_label.string=e}.bind(this,(void 0)[i]))},openRootWnd:function(t){this.data=t,this.config=t.config,this.updatedata()},closeCallBack:function(){this.ext_list=[],this.ctrl.openEvtViewByType(!1)}});cc._RF.pop()},{adventure_event:"adventure_event",pathtool:"pathtool"}],adventure_evt_free_box_window:[function(t,e,i){"use strict";cc._RF.push(e,"4c9247HC1lOxYUnd+moh9o8","adventure_evt_free_box_window");var s=t("pathtool"),n=t("common_scrollview"),a=t("adventure_event");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("adventure","adventure_evt_free_box_view"),this.viewTag=SCENE_TAG.ui,this.win_type=WinType.Big,this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){this.data=null,this.config=null},openCallBack:function(){this.background=this.root_wnd.getChildByName("background"),this.background.scale=FIT_SCALE,this.container=this.root_wnd.getChildByName("container"),this.close_btn=this.container.getChildByName("close_btn"),this.item_container=this.container.getChildByName("item_container"),this.ack_button=this.container.getChildByName("ack_button"),this.ack_button.getChildByName("Label").getComponent(cc.Label).string=Utils.TI18N("\u6253\u5f00"),this.title_label=this.container.getChildByName("title_label").getComponent(cc.Label),this.title_label.string=Utils.TI18N("\u5b9d\u7bb1"),this.reward_label=this.container.getChildByName("reward_label").getComponent(cc.Label),this.reward_label.string=Utils.TI18N("\u968f\u673a\u5956\u52b1\u9884\u89c8");var t=this.item_container.getContentSize(),e={item_class:BackPackItem,start_x:10,space_x:15,start_y:5,space_y:10,item_width:108,item_height:108,row:0,col:5,scale:.9};this.is_select=!1,this.item_scrollview=new n,this.item_scrollview.createScroll(this.item_container,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,cc.size(t.width,t.height-49),e),this.open_desc=this.container.getChildByName("open_desc").getComponent(cc.Label),this.open_desc.string="",this.desc=this.container.getChildByName("desc").getComponent(cc.Label),this.desc.node.setContentSize(cc.size(556,80)),this.updatedata()},updatedata:function(){this.config&&(this.desc.string=this.config.desc,this.config.lose&&null!=Utils.next(this.config.lose[1]||{})&&this.updateItemData(this.config.lose),this.createEffect(this.config.effect_str),this.config.box_show_item&&null!=Utils.next(this.config.box_show_item||{})&&this.updateRankItemData(this.config.box_show_item))},createEffect:function(t){if(""!=t&&this.container&&null==this.box_effect){var e=new cc.Node;e.setAnchorPoint(.5,.5),e.setPosition(360,608),e.setScale(1.5),this.container.addChild(e),this.box_effect=e.addComponent(sp.Skeleton),this.loadRes(t,function(t){this.box_effect&&(this.box_effect.skeletonData=t,this.box_effect.setAnimation(0,PlayerAction.action,!0))}.bind(this))}},updateRankItemData:function(t){if(t){var e=[];for(var i in t){var s={};(s=Utils.deepCopy(Utils.getItemConfig(v[1]))).num=v[2],e.push(s)}this.item_scrollview.setData(e),this.item_scrollview.addEndCallBack(function(){var t=this.item_scrollview.getItemList();for(var e in t)t[e].setDefaultTip(),t[e].data&&1!=t[e].data.num&&t[e].setNum(t[e].data.num)}.bind(this))}},registerEvent:function(){Utils.onTouchEnd(this.background,function(){this.ctrl.openEvtViewByType(!1)}.bind(this),2),Utils.onTouchEnd(this.close_btn,function(){this.ctrl.openEvtViewByType(!1)}.bind(this),2),Utils.onTouchEnd(this.ack_button,function(){if(this.data){var t=[{type:1,val:0}];1==this.is_select&&(t=[{type:1,val:1}]),this.ctrl.send20620(this.data.id,a.AdventureEvenHandleType.handle,t)}}.bind(this),2),this.addGlobalEvent(a.Update_Evt_Box_Result_Info,function(t){t&&this.updateResult(t)}.bind(this))},updateResult:function(t){this.box_effect&&this.box_effect.setAnimation(0,PlayerAction.action_1,!1),gcore.Timer.set(function(){this.ctrl.showGetItemTips(t.items),this.ctrl.openEvtViewByType(!1)}.bind(this),1e3)},openRootWnd:function(t){this.data=t,this.config=t.config,this.updatedata()},closeCallBack:function(){this.item_scrollview&&(this.item_scrollview.deleteMe(),this.item_scrollview=null),this.ctrl.openEvtViewByType(!1)}});cc._RF.pop()},{adventure_event:"adventure_event",common_scrollview:"common_scrollview",pathtool:"pathtool"}],adventure_evt_npc_window:[function(t,e,i){"use strict";function s(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}cc._RF.push(e,"1ebd6qI7ANG/ag/4SiGrAky","adventure_evt_npc_window");var n=t("pathtool"),a=t("role_controller"),o=t("adventure_event");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=n.getPrefabPath("adventure","adventure_evt_npc_view"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Big,this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){this.btn_list=[],this.data=null,this.config=null,this.role_vo=a.getInstance().getRoleVo()},openCallBack:function(){this.background=this.root_wnd.getChildByName("background"),this.background.scale=FIT_SCALE,this.main_container=this.root_wnd.getChildByName("root"),this.close_btn=this.main_container.getChildByName("close_btn"),this.title_label=this.main_container.getChildByName("title_label"),this.role_bg_node=this.main_container.getChildByName("role_bg"),this.role_bg_node.scale=3,this.role_bg=this.role_bg_node.getComponent(cc.Sprite),this.loadRes(n.getBigBg("bigbg_45"),function(t){this.role_bg.spriteFrame=t}.bind(this)),this.bg=this.main_container.getChildByName("bg").getComponent(cc.Sprite),this.loadRes(n.getBigBg("bigbg_18"),function(t){this.bg.spriteFrame=t}.bind(this)),this.tips_desc_label=Utils.createRichLabel(26,new cc.Color(104,69,42,255),cc.v2(.5,1),cc.v2(0,-this.main_container.getContentSize().height/2+680),30,610),this.tips_desc_label.horizontalAlign=cc.macro.TextAlignment.LEFT,this.main_container.addChild(this.tips_desc_label.node),this.tips_desc_label.node.active=!0,this.item_bg=this.main_container.getChildByName("item_bg")},registerEvent:function(){Utils.onTouchEnd(this.close_btn,function(){this.ctrl.openEvtViewByType(!1)}.bind(this),2),this.addGlobalEvent(o.Update_Evt_Npc_Info,function(t){this.updateData(t)}.bind(this))},updateData:function(t){if(this.config&&t){var e=Config.adventure_data.data_adventure_npc_data[t.evt_id][t.id],i=[];for(var a in e)i.push(e[a]);var l=cc.size(604,87);if(i.sort(function(t,e){return t.num-e.num}),i){var r;this.tips_desc_label.string=i[0].lable_desc;var c=(s(r={},0,""),s(r,1,""),s(r,2,""),s(r,3,""),r);for(a=0;a<i.length;a++){if(!this.btn_list[a]){var _=new cc.Node;_.setAnchorPoint(.5,.5),_.setContentSize(l),this.item_bg.addChild(_);var h=_.addComponent(cc.Sprite);h.type=cc.Sprite.Type.SLICED,h.sizeMode=cc.Sprite.SizeMode.CUSTOM,(m=_.addComponent(cc.Button)).transition=cc.Button.Transition.SPRITE,this.loadRes(n.getCommonIcomPath("common_1029"),function(t,e,i){t.normalSprite=i,e.spriteFrame=i}.bind(this,m,h)),this.loadRes(n.getCommonIcomPath("common_1020"),function(t,e){t.pressedSprite=e}.bind(this,m)),_.active=!1;var d=Utils.createLabel(26,new cc.Color(104,69,42,255),null,0,0,"",_,null,cc.v2(.5,.5));m.title=d;var u=Utils.createImage(_,null,250,0,null,null,3);u.node.active=!1,this.loadRes(n.getUIIconPath("adventure","adventure_54"),function(t,e){t.spriteFrame=e}.bind(this,u)),m.i=a+1,m.tag=u,this.btn_list[a]=m}var m;(m=this.btn_list[a])&&(m.node.active=!0,m.title&&(m.title.string=c[a]+i[a].msg),m.node.setPosition(0,-this.item_bg.getContentSize().height/2+230-(l.height+5)*a),m.node.on(cc.Node.EventType.TOUCH_START,function(t){if(this.btn_list)for(var e in this.btn_list)this.btn_list[e]&&(this.btn_list[e].tag.node.active=!1)},this),m.node.on(cc.Node.EventType.TOUCH_CANCEL,function(t){t.tag.node.active=!1}.bind(this,m),this),m.node.on(cc.Node.EventType.TOUCH_END,function(t){if(this.data){var e=[{type:1,val:t.i}];t.tag.node.active=!0,this.ctrl.send20620(this.data.id,o.AdventureEvenHandleType.handle,e)}}.bind(this,m),this))}}}},openRootWnd:function(t){this.data=t,this.config=t.config,this.data&&this.ctrl.send20620(this.data.id,o.AdventureEvenHandleType.requst,{})},closeCallBack:function(){this.ctrl.openEvtViewByType(!1)}});cc._RF.pop()},{adventure_event:"adventure_event",pathtool:"pathtool",role_controller:"role_controller"}],adventure_evt_other_npc_window:[function(t,e,i){"use strict";cc._RF.push(e,"ccc7biOgl5IAriQjFJqC6te","adventure_evt_other_npc_window");var s=t("pathtool"),n=t("adventure_event");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("adventure","adventure_evt_other_npc_view"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Big,this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){this.data=null,this.config=null,this.btn_list=[]},openCallBack:function(){this.background=this.root_wnd.getChildByName("background"),this.background.scale=FIT_SCALE;var t=this.root_wnd.getChildByName("container");this.title_label=t.getChildByName("title_label").getComponent(cc.Label),this.title_label.string=Utils.TI18N("\u795e\u79d8\u4e8b\u4ef6"),this.close_btn=t.getChildByName("close_btn"),this.swap_desc_label=Utils.createRichLabel(24,new cc.Color(104,69,42,255),cc.v2(.5,1),cc.v2(0,-t.height/2+320),30,610),t.addChild(this.swap_desc_label.node),this.item_bg=t.getChildByName("item_bg"),this.container=t},registerEvent:function(){Utils.onTouchEnd(this.close_btn,function(){this.ctrl.openEvtViewByType(!1)}.bind(this),2),this.addGlobalEvent(n.Update_Evt_Npc_Info,function(t){this.updateAnswerData(t)}.bind(this))},openRootWnd:function(t){this.data=t,this.config=t.config,this.updatedata(),this.data&&this.ctrl.send20620(this.data.id,n.AdventureEvenHandleType.requst,{})},updateAnswerData:function(t){if(this.config&&t){var e=Config.adventure_data.data_adventure_npc_data[t.evt_id][t.id];if(null==e||null==Utils.next(e))return;var i=[];for(var a in e)i.push(e[a]);var o=cc.size(604,87);for(var a in i.sort(function(t,e){return t.num-e.num}),i){var l=i[a];if(0==a&&(this.swap_desc_label.string=l.lable_desc),!this.btn_list[a]){var r=new cc.Node;r.setAnchorPoint(.5,.5),r.setContentSize(o),this.item_bg.addChild(r);var c,_=r.addComponent(cc.Sprite);_.type=cc.Sprite.Type.SLICED,_.sizeMode=cc.Sprite.SizeMode.CUSTOM,(c=r.addComponent(cc.Button)).transition=cc.Button.Transition.SPRITE,this.loadRes(s.getCommonIcomPath("common_1029"),function(t,e,i){t.normalSprite=i,e.spriteFrame=i}.bind(this,c,_)),this.loadRes(s.getCommonIcomPath("common_1020"),function(t,e){t.pressedSprite=e}.bind(this,c)),r.active=!1;var h=Utils.createRichLabel(24,new cc.Color(104,69,42,255),cc.v2(.5,.5),cc.v2(0,0),30,600);r.addChild(h.node),c.title=h;var d=Utils.createImage(r,null,250,0,null,null,3);d.node.active=!1,this.loadRes(s.getUIIconPath("adventure","adventure_54"),function(t,e){t.spriteFrame=e}.bind(this,d)),c.i=parseInt(a)+1,c.tag=d,this.btn_list[a]=c}if(c=this.btn_list[a]){c.node.active=!0;var u="";if(l.lose){for(var m in l.lose){var f=l.lose[m];""!=u&&(u+=",");var p=f[0],g=f[1],v=Utils.getItemConfig(p);v&&(u=u+cc.js.formatStr("<img src='%s'/>  ",v.icon)+g,this.loadRes(s.getItemRes(v.icon),function(t,e){t.spriteFrame=e}.bind(this,c.title)))}""!=u&&(u=cc.js.formatStr(Utils.TI18N("<color=#a95f0f>(\u6d88\u8017 %s)</color>"),u))}c.title.string=l.msg+"  "+u,c.node.setPosition(0,-this.item_bg.getContentSize().height/2+140-(o.height+5)*a),c&&(c.node.on(cc.Node.EventType.TOUCH_START,function(t){if(this.btn_list)for(var e in this.btn_list)this.btn_list[e]&&(this.btn_list[e].tag.node.active=!1)},this),c.node.on(cc.Node.EventType.TOUCH_CANCEL,function(t){t.tag.node.active=!1}.bind(this,c),this),c.node.on(cc.Node.EventType.TOUCH_END,function(t){if(this.data){var e=[{type:1,val:t.i}];t.tag.node.active=!0,this.ctrl.send20620(this.data.id,n.AdventureEvenHandleType.handle,e)}}.bind(this,c),this))}}}},updatedata:function(){this.config&&(this.swap_desc_label.string=this.config.desc,this.createEffect(this.config.effect_str))},createEffect:function(t){if(""!=t&&this.container&&null==this.box_effect){var e=new cc.Node;e.setAnchorPoint(.5,.5),e.setPosition(0,-this.container.height/2+433),e.setScale(1.5),this.container.addChild(e),this.box_effect=e.addComponent(sp.Skeleton);var i=s.getSpinePath(t,"action");this.loadRes(i,function(t){this.box_effect.skeletonData=t,this.box_effect.setAnimation(0,PlayerAction.action,!0)}.bind(this))}},closeCallBack:function(){this.ctrl.openEvtViewByType(!1)}});cc._RF.pop()},{adventure_event:"adventure_event",pathtool:"pathtool"}],adventure_evt_shop_window:[function(t,e,i){"use strict";cc._RF.push(e,"3364c2ny5JEmq1XfCmwnwRn","adventure_evt_shop_window");var s=t("pathtool"),n=t("backpack_const"),a=t("commonalert"),o=t("adventure_event");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("adventure","adventure_evt_shop_view"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Big,this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){this.data=null,this.config=null,this.is_auto_open=!1,this.shop_item_list={}},openCallBack:function(){this.background=this.root_wnd.getChildByName("background"),this.background.scale=FIT_SCALE;var t=this.root_wnd.getChildByName("container");t.getChildByName("title_label").getComponent(cc.Label).string=Utils.TI18N("\u795e\u79d8\u5546\u5e97"),this.item_container=t.getChildByName("item_container"),this.desc=t.getChildByName("desc").getComponent(cc.Label),this.desc.node.setContentSize(cc.size(330,112)),this.close_btn=t.getChildByName("close_btn"),this.bigbg_55_1=t.getChildByName("bigbg_55_1").getComponent(cc.Sprite),this.loadRes(s.getBigBg("bigbg_55"),function(t){this.bigbg_55_1.spriteFrame=t}.bind(this)),this.total_width=this.item_container.getContentSize().width},registerEvent:function(){Utils.onTouchEnd(this.background,function(){this.ctrl.openEvtViewByType(!1),this.ctrl.openAdventureEvtShopView(!1)}.bind(this),2),Utils.onTouchEnd(this.close_btn,function(){this.ctrl.openEvtViewByType(!1),this.ctrl.openAdventureEvtShopView(!1)}.bind(this),2),this.addGlobalEvent(o.Update_Evt_Shop_Info,function(t){this.updateShopItem(t.list)}.bind(this)),this.addGlobalEvent(o.UpdateShopItemEvent,function(t){this.updateSingleShopItem(t)}.bind(this))},openRootWnd:function(t){if(this.data=t,this.config=t.config,t&&t.is_auto){this.is_auto_open=!0,this.updateShopItem(t);var e=Config.adventure_data.data_adventure_const.businessman_description;e&&(this.desc.string=e.desc)}else this.config&&(this.desc.string=this.config.desc),this.data&&this.ctrl.send20620(this.data.id,o.AdventureEvenHandleType.requst,{})},updateShopItem:function(t){var e=t.length,i=100*e+50*(e-1),n=.5*(this.total_width-i);for(var a in t)if("is_auto"!=a){var o=t[a],l=this.shop_item_list[o.id];if(null==l){if(l=this.createShopItem(a,n,100,50,o.id),this.shop_item_list[o.id]=l,l.item.setData({bid:o.bid,num:o.num}),null==l.buy_config){var r=Utils.getItemConfig(o.pay_type);r&&(l.label.string=cc.js.formatStr("<img src='%s'/><outline=1, color=#6c2b00> %s</outline>",r.icon,o.pay_val),this.loadRes(s.getItemRes(r.icon),function(t,e){t.spriteFrame=e}.bind(this,l.label)),l.buy_config=r)}if(null==l.item_config){var c=Utils.getItemConfig(o.bid);c&&(l.item_name.string=c.name,l.item_config=c)}0==o.discount||10==o.discount?l.discount.node.active=!1:(l.discount.node.active=!0,l.discount_label.string=o.discount+Utils.TI18N("\u6298"))}1==o.is_buy?l.sell_over.node.active=!0:l.sell_over.node.active=!1,l.data=o}},updateSingleShopItem:function(t){if(null!=this.shop_item_list){var e=this.shop_item_list[t];null!=e&&(e.data.is_buy=1,e.sell_over.node.active=!0)}},clickBuyIndex:function(t){var e=t.target.touch_id;if(null!=e){var i=this.shop_item_list[e];if(null!=i&&null!=i.data)if(1!=i.data.is_buy){if(null!=i.item_config&&null!=i.buy_config){var l=n.quality_color(i.item_config.quality)||0,r=cc.js.formatStr("%s <img src='%s'/>%s%s<Color=%s>%s</Color>x%s",Utils.TI18N("\u662f\u5426\u6d88\u8017"),i.buy_config.icon,i.data.pay_val,Utils.TI18N("\u8d2d\u4e70"),l,i.item_config.name,i.data.num);a.show(r,Utils.TI18N("\u786e\u5b9a"),function(){if(1==this.is_auto_open)this.ctrl.requestBuyShopItem(i.data.id);else if(this.data){var t=[{type:1,val:i.data.id}];this.ctrl.send20620(this.data.id,o.AdventureEvenHandleType.handle,t)}}.bind(this),Utils.TI18N("\u53d6\u6d88"),null,null,null,{resArr:[s.getItemRes(i.buy_config.icon)]})}}else message(Utils.TI18N("\u8be5\u7269\u54c1\u5df2\u88ab\u8d2d\u4e70"))}},createShopItem:function(t,e,i,n,a){var o={},l=new cc.Node;l.setAnchorPoint(.5,.5),l.setContentSize(cc.size(i,100));var r=-this.item_container.width/2+e+.5*i+t*(i+n),c=118-this.item_container.height;l.setPosition(r,c),this.item_container.addChild(l);var _=ItemsPool.getInstance().getItem("backpack_item");_.initConfig(!1,1,!1,!0),_.setParent(l),_.show(),_.setPosition(0,52);var h=Utils.createLabel(24,new cc.Color(104,69,42,255),null,0,-25,"\u6211\u662f\u7269\u54c1\u540d\u5b57",l,null,cc.v2(.5,.5)),d=Utils.createImage(l,null,0,-70,cc.v2(.5,.5),!0,0,!0);d.node.setContentSize(cc.size(130,61)),this.loadRes(s.getCommonIcomPath("common_1017"),function(t){d.spriteFrame=t}.bind(this));var u=d.node.addComponent(cc.Button);u.transition=cc.Button.Transition.SCALE,u.duration=.1,u.zoomScale=.9,d.node.touch_id=a,d.node.on(cc.Node.EventType.TOUCH_END,this.clickBuyIndex,this);var m=Utils.createRichLabel(24,new cc.Color(255,255,255,255),cc.v2(.5,.5),cc.v2(0,0),28);m.string=Utils.TI18N("\u6211\u662f\u6309\u94ae\u540d\u5b57"),m.handleTouchEvent=!1,d.node.addChild(m.node);var f=Utils.createImage(l,null,0,46,cc.v2(.5,.5),null,4);this.loadRes(s.getUIIconPath("mall","txt_cn_mall_sell_finish"),function(t){f.spriteFrame=t}.bind(this)),f.node.active=!1;var p=Utils.createImage(l,null,-44,80,cc.v2(.5,.5),null,3);this.loadRes(s.getUIIconPath("mall","mall_06"),function(t){p.spriteFrame=t}.bind(this)),p.node.active=!1;var g=Utils.createLabel(24,new cc.Color(255,255,255,255),new cc.Color(174,42,0,255),0,10,"",p.node,null,cc.v2(.5,.5));return o.node=l,o.item=_,o.item_name=h,o.button=d,o.label=m,o.sell_over=f,o.discount=p,o.discount_label=g,o},closeCallBack:function(){for(var t in this.shop_item_list)this.shop_item_list[t].item&&this.shop_item_list[t].item.deleteMe();this.shop_item_list=null,this.ctrl.openEvtViewByType(!1),this.ctrl.openAdventureEvtShopView(!1)}});cc._RF.pop()},{adventure_event:"adventure_event",backpack_const:"backpack_const",commonalert:"commonalert",pathtool:"pathtool"}],adventure_floor_result_item_panel:[function(t,e,i){"use strict";cc._RF.push(e,"19045l0mIlJL47l1HTz/p4z","adventure_floor_result_item_panel");var s=t("pathtool");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("adventure","adventure_floor_result_item")},initConfig:function(){this.is_completed=!1},initPanel:function(){this.init_pos_y=this.root_wnd.y,this.container=this.root_wnd.getChildByName("container"),this.item_name=this.container.getChildByName("item_name").getComponent(cc.Label),this.item_num=this.container.getChildByName("item_num").getComponent(cc.Label),this.playEnterActions(),this.data&&this.updateInfo()},registerEvent:function(){},playEnterActions:function(){this.root_wnd.x=200,this.root_wnd.opacity=0;var t=cc.moveTo(.2,cc.v2(460,this.init_pos_y)),e=cc.fadeIn(.2),i=cc.moveTo(.1,cc.v2(360,this.init_pos_y));this.root_wnd.runAction(cc.sequence(cc.spawn(t,e),i))},setData:function(t){this.data=t,this.root_wnd&&this.updateInfo()},updateInfo:function(){if(this.data){var t=Utils.getItemConfig(this.data.bid);t&&(null==this.item_icon&&(this.item_icon=Utils.createImage(this.container,null,-this.container.width/2+164,0,cc.v2(.5,.5)),this.item_icon.node.setScale(.4)),this.item_icon_res!=t.icon&&(this.item_icon_res=t.icon,this.loadRes(s.getItemRes(t.icon),function(t){this.item_icon.spriteFrame=t}.bind(this))),this.item_name.string=t.name,this.item_num.string=this.data.num)}},onShow:function(t){},onHide:function(){},onDelete:function(){}});cc._RF.pop()},{pathtool:"pathtool"}],adventure_floor_result_window:[function(t,e,i){"use strict";cc._RF.push(e,"1dc8dXE/WhJOpLT42PZb6eV","adventure_floor_result_window");var s=t("pathtool"),n=t("common_scrollview"),a=t("adventure_floor_result_item_panel");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("adventure","adventure_floor_result_window"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Tips,this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){},openCallBack:function(){this.background=this.root_wnd.getChildByName("background"),this.background.scale=FIT_SCALE,this.main_container=this.root_wnd.getChildByName("main_container"),this.title_container=this.main_container.getChildByName("title_container"),this.list_view=this.root_wnd.getChildByName("list_view");var t=this.list_view.getContentSize(),e={item_class:a,start_x:0,space_x:0,start_y:8,space_y:12,item_width:720,item_height:43,row:0,col:1,need_dynamic:!0};this.scroll_view=new n,this.scroll_view.createScroll(this.list_view,cc.v2(-t.width/2,-t.height/2),null,null,t,e),this.item=this.root_wnd.getChildByName("item")},registerEvent:function(){Utils.onTouchEnd(this.background,function(){this.ctrl.openAdventureFloorResultWindow(!1)}.bind(this),2)},openRootWnd:function(t){Utils.playButtonSound("c_get"),this.handleEffect(!0);var e=t.items_list;e&&e.sort(function(t,e){return e.num-t.num}),this.scroll_view.setData(e)},handleEffect:function(t){if(0==t)this.play_effect&&(this.play_effect.setToSetupPose(),this.play_effect.clearTracks(),this.play_effect=null);else{var e=PlayerAction.action_4;if(this.title_container&&null==this.play_effect){var i=new cc.Node;i.setAnchorPoint(.5,.5),i.setPosition(0,0),this.title_container.addChild(i),this.play_effect=i.addComponent(sp.Skeleton);var n=s.getSpinePath(s.getEffectRes(274),"action");this.loadRes(n,function(t){this.play_effect.skeletonData=t,this.play_effect.setAnimation(0,e,!1)}.bind(this))}}},closeCallBack:function(){this.scroll_view&&(this.scroll_view.deleteMe(),this.scroll_view=null),this.ctrl.openAdventureFloorResultWindow(!1)}});cc._RF.pop()},{adventure_floor_result_item_panel:"adventure_floor_result_item_panel",common_scrollview:"common_scrollview",pathtool:"pathtool"}],adventure_form_window:[function(t,e,i){"use strict";cc._RF.push(e,"b9241pLxv5L0px4HAgdPkeb","adventure_form_window");var s=t("pathtool"),n=t("hero_const"),a=t("commonalert"),o=t("hero_controller"),l=t("common_scrollview");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("adventure","adventure_form_window"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Big,this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){this.five_hero_vo=[],this.hero_item_list=[],this.select_list=[]},openCallBack:function(){this.background=this.root_wnd.getChildByName("background"),this.background.scale=FIT_SCALE;var t=this.root_wnd.getChildByName("main_container");t.getChildByName("win_title").getComponent(cc.Label).string=Utils.TI18N("\u5192\u9669\u51fa\u6218");var e=t.getChildByName("top_panel");this.lay_scrollview=e.getChildByName("lay_scrollview"),this.no_vedio_image=e.getChildByName("no_vedio_image"),this.no_vedio_image.getChildByName("label").getComponent(cc.Label).string=Utils.TI18N("\u6682\u65e0\u8be5\u7c7b\u578b\u82f1\u96c4");var i=e.getChildByName("camp_node");this.camp_btn_list=[],this.camp_btn_list[0]=i.getChildByName("camp_btn0"),this.camp_btn_list[n.CampType.eWater]=i.getChildByName("camp_btn1"),this.camp_btn_list[n.CampType.eFire]=i.getChildByName("camp_btn2"),this.camp_btn_list[n.CampType.eWind]=i.getChildByName("camp_btn3"),this.camp_btn_list[n.CampType.eLight]=i.getChildByName("camp_btn4"),this.camp_btn_list[n.CampType.eDark]=i.getChildByName("camp_btn5"),this.img_select=i.getChildByName("img_select");var s=this.camp_btn_list[0].x,a=this.camp_btn_list[0].y;this.img_select.setPosition(s-.5,a+1);for(var o=t.getChildByName("bottom_panel"),l=1;l<=5;l++){var r=ItemsPool.getInstance().getItem("hero_exhibition_item");r.setRootScale(.9),r.setButtonEffect(!1),r.setRootPosition(cc.v2(104+128*(l-1),229)),r.setParent(o),r.addTouchCb(function(t){this.onClickHeroItemEnd(t)}.bind(this,l)),r.show(),this.hero_item_list[l]=r}o.getChildByName("pos_tips").getComponent(cc.Label).string=Utils.TI18N("\u4ece\u5217\u8868\u4e2d\u9009\u62e9\u82f1\u96c4"),this.fight_btn=o.getChildByName("fight_btn"),this.key_up_btn=o.getChildByName("key_up_btn"),this.fight_btn.getChildByName("label").getComponent(cc.Label).string=Utils.TI18N("\u8fdb\u5165\u5192\u9669"),this.key_up_btn.getChildByName("label").getComponent(cc.Label).string=Utils.TI18N("\u4e00\u952e\u5e03\u9635"),this.power_click=o.getChildByName("power_click"),this.power_val_nd=this.seekChild("power_val"),this.fight_label=this.power_val_nd.getComponent("CusRichText")},registerEvent:function(){for(var t in Utils.onTouchEnd(this.background,function(){this.ctrl.openAdventureFormWindow(!1)}.bind(this),2),this.camp_btn_list)Utils.onTouchEnd(this.camp_btn_list[t],function(t){this.onClickBtnShowByIndex(t)}.bind(this,t),1);Utils.onTouchEnd(this.key_up_btn,function(){this.onClickKeyUpBtn()}.bind(this),1),Utils.onTouchEnd(this.fight_btn,function(){this.onClickSaveBtn()}.bind(this),1)},openRootWnd:function(t){this.onClickBtnShowByIndex(0)},onClickBtnShowByIndex:function(t){if(this.img_select&&this.camp_btn_list[t]){var e=this.camp_btn_list[t].x,i=this.camp_btn_list[t].y;this.img_select.setPosition(e-.5,i+1)}this.updateHeroList(t)},updateHeroList:function(t){if((t=t||0)!=this.select_camp){if(!this.list_view){var e=this.lay_scrollview.getContentSize();this.list_view=new l,this.list_view.createScroll(this.lay_scrollview,cc.v2(-e.width/2,-e.height/2),ScrollViewDir.vertical,ScrollViewStartPos.top,e,{item_class:"hero_exhibition_item",start_x:0,space_x:8,start_y:0,space_y:10,item_width:119,item_height:119,row:5,col:5,once_num:5,need_dynamic:!0})}this.select_camp=t;var i=function(t){this.selectHero(t)}.bind(this);null==this.hero_array&&(this.hero_array=Utils.deepCopy(o.getInstance().getModel().getAllHeroArray()));for(var s=[],a=1;a<=this.hero_array.length;a++){var r=this.hero_array[a-1];0!=t&&t!=r.camp_type||s.push(r)}s.length>0?(s.sort(Utils.tableUpperSorter(["star","power","lev","sort_order"])),this.list_view.setData(s,i,{scale:.9,from_type:n.ExhibitionItemType.eHeroSelect,can_click:!0}),this.no_vedio_image.active=!1):(this.list_view.setData({}),this.no_vedio_image.active=!0),this.show_list=s}},onClickKeyUpBtn:function(){var t=0;for(var e in this.five_hero_vo)this.five_hero_vo[e]&&t++;if(t>=5)message(Utils.TI18N("\u4e0a\u9635\u4eba\u6570\u5df2\u6ee1"));else if(null!=this.show_list&&null!=Utils.next(this.show_list)){for(e=1;e<=5;e++)if(null==this.five_hero_vo[e]){var i=this.getFreeHero();i&&(i.is_ui_select=!0,this.five_hero_vo[e]=i,this.hero_item_list[e].setData(i),this.setTopSelect(i,e))}this.updateFightPower()}else message(Utils.TI18N("\u5f53\u524d\u5217\u8868\u6ca1\u6709\u53ef\u4e0a\u9635\u7684\u82f1\u96c4"))},setTopSelect:function(t,e){if(null!=this.list_view&&!this.select_list[e]){var i=this.list_view.getItemList();for(var s in i){var n=i[s],a=n.getData();if(a&&a.partner_id==t.partner_id){a.is_ui_select=t.is_ui_select,n.setSelected(t.is_ui_select),this.select_list[e]=n;break}}}},getFreeHero:function(){for(var t in this.show_list){var e=this.show_list[t],i=!0;for(var s in this.five_hero_vo)if(this.five_hero_vo[s]){var n=this.five_hero_vo[s];if(e.partner_id==n.partner_id||e.bid==n.bid){i=!1;break}}if(1==i)return e}},selectHero:function(t){if(null!=t){var e=this.show_list[t.tmp_index];if(null!=e){var i=-1,s=e.partner_id;for(var n in this.five_hero_vo)if(this.five_hero_vo[n]&&s==this.five_hero_vo[n].partner_id){i=n;break}if(-1!=i){e.is_ui_select=!1,t.getData().is_ui_select=e.is_ui_select,t.setSelected(e.is_ui_select),this.hero_item_list[i].setData(null),this.five_hero_vo[i]=null,this.select_list[i]=null}else{var a=0;for(var o in this.five_hero_vo)if(this.five_hero_vo[o]){if(this.five_hero_vo[o].bid==e.bid)return void message(Utils.TI18N("\u4e0d\u80fd\u540c\u65f6\u4e0a\u96352\u4e2a\u76f8\u540c\u82f1\u96c4"));a+=1}if(a>=5)return void message(Utils.TI18N("\u4e0a\u9635\u4eba\u6570\u5df2\u6ee1"));var l=0;for(o=1;o<=5;o++)if(null==this.five_hero_vo[o]){l=o;break}if(0==l)return void message(Utils.TI18N("\u6ca1\u6709\u4e0a\u9635\u4f4d\u7f6e"));this.five_hero_vo[l]=e,this.hero_item_list[l].setData(e),this.select_list[l]=t,e.is_ui_select=!0,t.getData().is_ui_select=e.is_ui_select,t.setSelected(e.is_ui_select)}this.updateFightPower()}}},updateFightPower:function(){var t=0;for(var e in this.five_hero_vo)this.five_hero_vo[e]&&(t+=this.five_hero_vo[e].power);this.fight_label.setNum(t)},onClickHeroItemEnd:function(t,e){var i=this.five_hero_vo[t];if(null!=i){i.is_ui_select=!1;var s=this.list_view.getItemList();for(var n in s){var a=s[n],o=a.getData();if(o.partner_id==i.partner_id){o.is_ui_select=i.is_ui_select,a.setSelected(i.is_ui_select);break}}this.five_hero_vo[t]=null,this.select_list[t]=null,this.hero_item_list[t].setData(null),this.updateFightPower()}},onClickSaveBtn:function(){var t=[],e=0;for(var i in this.five_hero_vo)this.five_hero_vo[i]&&(t.push({id:this.five_hero_vo[i].partner_id}),e+=1);if(0!=e){var s=o.getInstance().getModel().getAllHeroArray().length;if(e<5&&e<s){var n=Utils.TI18N("\u5f53\u524d\u4e0a\u9635\u82f1\u96c4\u4e0d\u8db35\u4e2a\uff0c\u662f\u5426\u786e\u8ba4\u4ee5\u6b64\u9635\u5bb9\u8fdb\u5165\u5192\u9669\uff1f");a.show(n,Utils.TI18N("\u786e\u5b9a"),function(t){this.ctrl.requestSetForm(t)}.bind(this,t),Utils.TI18N("\u53d6\u6d88"))}else this.ctrl.requestSetForm(t)}else message(Utils.TI18N("\u8bf7\u8bbe\u7f6e\u51fa\u6218\u82f1\u96c4"))},closeCallBack:function(){if(this.list_view&&(this.list_view.deleteMe(),this.list_view=null),this.hero_item_list){for(var t in this.hero_item_list)this.hero_item_list[t].deleteMe();this.hero_item_list=null}this.hero_array=null,this.ctrl.openAdventureFormWindow(!1)}});cc._RF.pop()},{common_scrollview:"common_scrollview",commonalert:"commonalert",hero_const:"hero_const",hero_controller:"hero_controller",pathtool:"pathtool"}],adventure_main_window:[function(t,e,i){"use strict";cc._RF.push(e,"82bde70bdJAwozYBJVoBIh8","adventure_main_window");var s=t("pathtool"),n=t("common_scrollview"),a=t("mainui_controller"),o=t("rank_controller"),l=t("rank_constant"),r=t("adventure_event"),c=t("adventure_const"),_=t("commonalert"),h=t("chat_const"),d=t("adventure_cell_item_panel"),u=t("timetool"),m=t("tips_controller");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("adventure","adventure_main_window"),this.viewTag=SCENE_TAG.ui,this.win_type=WinType.Full,this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){this.had_register=!1,this.box_effect=null,this.cur_box_status=null,this.skill_list={},this.hero_list={},this.room_skill_list={},this.collect_effect_list={},this.fly_cache_item_list=[],this.fly_item_list={}},setVisible:function(t){this._super(t),t&&(this.item_scrollview&&this.item_scrollview.setClickEnabled(!1),this.updateBoxTeskList(this.box_tesk_data))},openCallBack:function(){this.cell_container=this.root_wnd.getChildByName("cell_container");var t=this.cell_container.getContentSize(),e={item_class:d,start_x:10,space_x:-1,start_y:118,space_y:-1,item_width:142,item_height:126,row:5,col:5,once_num:5};this.item_scrollview=new n,this.item_scrollview.createScroll(this.cell_container,cc.v2(-t.width/2,0),ScrollViewDir.vertical,ScrollViewStartPos.bottom,t,e),this.item_scrollview.setItemZIndexByType(2),this.item_scrollview.setClickEnabled(!1),this.other_container=this.root_wnd.getChildByName("other_container"),this.Sprite_21=this.other_container.getChildByName("Sprite_21").getComponent(cc.Sprite),this.Sprite_22=this.other_container.getChildByName("Sprite_22").getComponent(cc.Sprite),this.Sprite_23=this.other_container.getChildByName("Sprite_23").getComponent(cc.Sprite),this.Sprite_24=this.other_container.getChildByName("Sprite_24").getComponent(cc.Sprite),this.top_container=this.root_wnd.getChildByName("top_container"),this.top_back=this.top_container.getChildByName("background"),this.top_back.scale=2*FIT_SCALE,this.top_back_ground=this.top_container.getChildByName("background").getComponent(cc.Sprite),this.title_container=this.top_container.getChildByName("title_container"),this.top_title=this.title_container.getChildByName("label").getComponent(cc.Label),this.title_background=this.title_container.getChildByName("title").getComponent(cc.Sprite),this.explain_btn=this.top_container.getChildByName("explain_btn"),this.rank_btn=this.top_container.getChildByName("rank_btn"),this.explain_btn.getChildByName("label").getComponent(cc.Label).string=Utils.TI18N("\u73a9\u6cd5\u8bf4\u660e"),this.rank_btn.getChildByName("label").getComponent(cc.Label).string=Utils.TI18N("\u6392\u884c"),this.bottom_container=this.root_wnd.getChildByName("bottom_container"),this.bottom_back=this.bottom_container.getChildByName("background"),this.bottom_back.scale=2*FIT_SCALE,this.bottom_back_ground=this.bottom_container.getChildByName("background").getComponent(cc.Sprite),this.return_btn=this.bottom_container.getChildByName("return_btn"),this.list_conatiner=this.bottom_container.getChildByName("list_conatiner");for(var i=Config.adventure_data.data_skill_data,s=1;s<=3;s++){var a=this.bottom_container.getChildByName("buff_"+s);if(a){var o={};o.node=a,o.index=s,o.num=a.getChildByName("num").getComponent(cc.Label),o.num.string=0,o.label=a.getChildByName("label").getComponent(cc.Label),o.num_value=0,o.use_count=0,this.skill_list[s]=o;var l=i[s];l&&(o.config=l,o.label.string=l.name)}}this.shop=this.bottom_container.getChildByName("shop"),this.btn_box=this.bottom_container.getChildByName("btn_box"),this.btn_box_label=this.btn_box.getChildByName("Text_1").getComponent(cc.Label),this.btn_box_label.string="",this.btn_box_label.node.zIndex=10,this.buff_container=this.bottom_container.getChildByName("buff_container"),this.holiday_buff=this.bottom_container.getChildByName("holiday_buff"),this.holiday_buff.active=!1,this.bottom_container.getChildByName("end_time_title").getComponent(cc.Label).string=Utils.TI18N("\u5192\u9669\u91cd\u7f6e"),this.end_time_value=this.bottom_container.getChildByName("end_time_value").getComponent(cc.Label)},registerEvent:function(){for(var t in Utils.onTouchEnd(this.return_btn,function(){this.ctrl.openAdventureMainWindow(!1)}.bind(this),2),Utils.onTouchEnd(this.explain_btn,function(){a.getInstance().openCommonExplainView(!0,Config.adventure_data.data_explain,Utils.TI18N("\u73a9\u6cd5\u89c4\u5219"))}.bind(this),1),Utils.onTouchEnd(this.rank_btn,function(){o.getInstance().openRankView(!0,l.RankType.adventure)}.bind(this),1),Utils.onTouchEnd(this.buff_container,function(){var t=this.model.getBuffData(),e=this.model.getHolidayBuffData();if(null!=t&&null!=Utils.next(t)||null!=e&&null!=Utils.next(e)){var i=this.buff_container.convertToWorldSpaceAR(cc.v2(0,0));m.getInstance().showAdventureBuffTips(t,i,e)}else message(Utils.TI18N("\u6682\u65e0\u5c5e\u6027\u52a0\u6210"))}.bind(this),1),this.skill_list)this.skill_list[t].node&&Utils.onTouchEnd(this.skill_list[t].node,function(t){this.handleSkillChoose(t)}.bind(this,this.skill_list[t].index),1);Utils.onTouchEnd(this.shop,function(){this.ctrl.openAdventrueShopWindow(!0)}.bind(this),1),this.addGlobalEvent(r.Update_Room_Info,function(){this.playEnterEffect(!0),this.updateRoomData()}.bind(this)),this.addGlobalEvent(r.Update_Single_Room_Info,function(){this.updateRoomData(!0)}.bind(this)),this.addGlobalEvent(r.Update_Room_Base_Info,function(){this.updateBaseData()}.bind(this)),this.addGlobalEvent(r.Update_Buff_Info,function(){this.updateBuffData(),this.updateHolidayBuffTips()}.bind(this)),this.addGlobalEvent(r.UpdateSkillInfo,function(t){this.updateSkillData(t)}.bind(this)),this.addGlobalEvent(r.UpdateAdventureForm,function(){this.updateHeroList()}.bind(this)),this.addGlobalEvent(r.UpdateAdventureSelectHero,function(){this.changeSelectHero()}.bind(this)),this.addGlobalEvent(r.GetSkillForEffectAction,function(t,e){this.playSkillEffectAction(t,e)}.bind(this)),this.addGlobalEvent(r.UpdateBoxTeskEvent,function(t){this.updateBoxTeskList(t)}.bind(this)),Utils.onTouchEnd(this.btn_box,function(){this.box_tesk_data&&null!=this.box_tesk_data.kill_mon&&(this.cur_box_status&&1==this.cur_box_status?this.ctrl.send20635(0):this.ctrl.openAdventureBoxRewardView(!0,this.box_tesk_data.kill_mon))}.bind(this),1)},openRootWnd:function(t){this.ctrl.send20602(),this.ctrl.send20609(),this.ctrl.send20634(),this.updateBuffData(),this.updateBaseData(),this.updateHeroList(),this.updateHolidayBuffTips(),this.model.updateRedStatus(!1)},getNextLevelNumber:function(t,e,i){if(null==t[e])return 1;var s=0;if(i>=t[e].count)s=t[e].id;else{for(var n in t){var a=t[n],o=a.id;if((o+=1)>=e&&(o=e),i>=a.count&&i<=t[o].count){s=a.id;break}}(s+=1)>=e&&(s=e)}return s},updateBoxTeskList:function(t){if(null!=t){var e=Config.adventure_data.data_round_reward_list,i=Config.adventure_data.data_round_reward_list_length;this.box_tesk_data=t;var n=this.box_tesk_data.kill_mon||0,a=0;for(var o in t.list)if(1==t.list[o].status){a=1;break}var l=!1;if(0==a){for(var o in t.list)if(0==t.list[o].status){l=!0;break}0==l&&(a=2)}var r=this.getNextLevelNumber(e,i,n);if(2==a){var c=Utils.TI18N("\u5df2\u9886\u53d6");this.btn_box_label.string=c}else{c=cc.js.formatStr(Utils.TI18N("%d/%d"),n,e[r].count);this.btn_box_label.string=c}if(this.cur_box_status!=a&&this.getVisible()){this.cur_box_status=a;var _=PlayerAction.action_1;if(1==a?_=PlayerAction.action_2:2==a&&(_=PlayerAction.action_3),this.box_effect&&(this.box_effect.setToSetupPose(),this.box_effect.clearTracks(),this.box_effect=null),this.btn_box&&null==this.box_effect){var h=new cc.Node;h.setAnchorPoint(0,0),h.setPosition(0,-20),this.btn_box.addChild(h),this.box_effect=h.addComponent(sp.Skeleton);var d=s.getSpinePath(s.getEffectRes(602),"action");this.loadRes(d,function(t){this.box_effect.skeletonData=t,this.box_effect.setAnimation(0,_,!0)}.bind(this))}}}},updateHeroList:function(){var t=this.model.getFormList(),e=this.model.getSelectPartnerID();for(var i in t){var s=t[i],n=function(t){this.selectHeroItem(t)}.bind(this);null==this.hero_list[i]&&(this.hero_list[i]=ItemsPool.getInstance().getItem("hero_exhibition_item"),this.hero_list[i].setExtendData({scale:.9,can_click:!0}),this.hero_list[i].setRootPosition(cc.v2(-this.bottom_container.width/2+90+135*i,260-this.bottom_container.height)),this.hero_list[i].show(),this.hero_list[i].setParent(this.bottom_container),this.hero_list[i].addCallBack(n));var a=this.hero_list[i];0!=e&&s.partner_id==e&&this.selectHeroItem(a),this.updateHeroInfo(a,s)}},changeSelectHero:function(){var t=this.model.getSelectPartnerID();if(0!=t){var e=null;for(var i in this.hero_list){var s=this.hero_list[i],n=s.getData();if(n&&n.partner_id==t){e=s;break}}e&&this.selectHeroItem(e)}},selectHeroItem:function(t,e){t&&((e=t.getData())&&(0!=e.now_hp?this.select_cell!=t&&(this.select_cell&&(this.select_cell.setSelected(!1),this.select_cell=null),this.select_cell=t,this.select_cell.setSelected(!0),this.ctrl.requestSelectPartner(e.partner_id)):message(Utils.TI18N("\u6b7b\u4ea1\u82f1\u96c4\u65e0\u6cd5\u9009\u62e9"))))},updateHeroInfo:function(t,e){if(null!=t){t.setData(e);var i=e.now_hp/e.hp;t.showProgressbar(100*i),0==i?t.showStrTips(!0,Utils.TI18N("\u5df2\u9635\u4ea1")):t.showStrTips(!1)}},updateSkillData:function(t){if(t)for(var e in t){var i=t[e],s=this.skill_list[i.bid];s&&(s.num_value=i.num,s.use_count=i.use_count,s.num.string=i.num)}},updateBuffData:function(){},updateHolidayBuffTips:function(){var t=this.model.getHolidayBuffData();t&&null!=Utils.next(t)?this.holiday_buff.active=!0:this.holiday_buff.active=!1},updateBaseData:function(){if(this.base_data=this.model.getAdventureBaseData(),null!=this.base_data){var t=this.base_data;if(this.changeBackgroundResources(t.map_id),this.name_layer!=t.id){this.name_layer=t.id;var e=Config.adventure_data.data_floor_reward[t.id];e&&(this.top_title.string=e.name)}this.updateEndTime()}},updateEndTime:function(){null!=this.base_data&&null==this.timeticket&&(this.countDownEndTime(),this.timeticket=gcore.Timer.set(function(){this.countDownEndTime()}.bind(this),1e3,-1))},countDownEndTime:function(){if(null!=this.base_data){var t=this.base_data.end_time-gcore.SmartSocket.getTime();t<=0&&(t=0,this.clearEneTime()),this.end_time_value.string=u.getTimeFormat(t)}else this.clearEneTime()},clearEneTime:function(){this.timeticket&&(gcore.Timer.del(this.timeticket),this.timeticket=null)},changeBackgroundResources:function(t){if(null!=t&&this.layer!=t){this.layer=t;var e=Config.adventure_data.data_map[t];if(e){var i="adventure/background/"+e.res_id;if(this.background_path==i)return;this.background_path=i}null!=this.background_path&&(this.loadRes(s.getUIIconPath(this.background_path,"top"),function(t){this.top_back_ground.spriteFrame=t}.bind(this)),this.loadRes(s.getUIIconPath(this.background_path,"bottom"),function(t){this.bottom_back_ground.spriteFrame=t}.bind(this)),this.loadRes(s.getUIIconPath(this.background_path,"title"),function(t){this.title_background.spriteFrame=t}.bind(this)),this.loadRes(s.getUIIconPath(this.background_path,"bg_1"),function(t){this.Sprite_21.spriteFrame=t,this.Sprite_23.spriteFrame=t}.bind(this)),this.loadRes(s.getUIIconPath(this.background_path,"bg_2"),function(t){this.Sprite_22.spriteFrame=t,this.Sprite_24.spriteFrame=t}.bind(this)))}},playEnterEffect:function(t){if(t){if(null==this.enter_effect){var e=new cc.Node;e.setAnchorPoint(.5,.5),e.setPosition(0,.2*SCREEN_HEIGHT),this.root_wnd.addChild(e,0),this.enter_effect=e.addComponent(sp.Skeleton)}var i=function(){this.enter_effect.node.active=!1}.bind(this),n=s.getSpinePath(s.getEffectRes(157),"action");this.loadRes(n,function(t){this.enter_effect.skeletonData=t,this.enter_effect.node.active=!0,this.enter_effect.setAnimation(0,PlayerAction.action_1,!1)}.bind(this)),0==this.had_register&&this.enter_effect&&(this.had_register=!0,this.enter_effect.setCompleteListener(i))}else this.enter_effect&&(this.enter_effect.setToSetupPose(),this.enter_effect.clearTracks(),this.enter_effect=null)},updateRoomData:function(t){var e=this.model.getRoomList(),i=function(t){this.clickCellItem(t)}.bind(this);t=t||!1;var s=[];for(var n in e)s.push(e[n]);this.item_scrollview.setData(s,i,t)},clickCellItem:function(t){if(null!=t&&null!=t.data&&null!=this.base_data&&null!=this.base_data.id){var e=t.data,i=e.config;if(e.status==c.status.can_open)i&&i.evt_type==r.EventType.mysterious?this.playSpecialEffect(t,"E23013",function(t){this.ctrl.send20608(t)}.bind(this)):this.ctrl.send20608(e.id);else if(e.status==c.status.lock)message(Utils.TI18N("\u51fb\u8d25\u9644\u8fd1\u5b88\u536b\u540e\u53ef\u63a2\u7d22\u8be5\u533a\u57df"));else if(i)if(e.status==c.status.open)i.evt_type==r.EventType.effect&&null!=Utils.next(i.handle_type)?this.ctrl.send20620(e.id,r.AdventureEvenHandleType.handle,{}):i.evt_type==r.EventType.buff?this.ctrl.send20620(e.id,r.AdventureEvenHandleType.handle,{}):i.evt_type==r.EventType.skill?(this.room_skill_list[e.id]=t,this.ctrl.send20620(e.id,r.AdventureEvenHandleType.handle,{})):this.ctrl.openWindowByConfig(e);else if(i.evt_type==r.EventType.shop)this.ctrl.openWindowByConfig(e);else if(i.evt_type==r.EventType.next&&e.status==c.status.over&&this.base_data){if(1==t.is_last_floor)return void message(Utils.TI18N("\u5df2\u8fbe\u5192\u9669\u6700\u9876\u5c42,\u8bf7\u7b49\u5f85\u5192\u9669\u91cd\u7f6e"));this.gotoNextFloor(e.id)}}},playSpecialEffect:function(t,e,i){null!=t&&null!=t.data&&t.changeBossEffectStatus(i,PlayerAction.action_1)},playCollectEffect:function(t,e){if(null!=t&&null!=t.data&&null!=t.data.config&&null!=t.data.config.handle_type&&!this.collect_effect_list[t.data.id]){var i=t.data,n=t.data.config.handle_type;if(null!=n&&null!=n[1]&&null!=Utils.next(n[1])){var a=n[1][1],o=n[1][2],l=function(){if(t&&t.setOtherDesc(!1),this.root_wnd){var s=this.collect_effect_list[i.id];s&&(s.node.runAction(cc.removethis(!0)),this.collect_effect_list[i.id]=null)}e(i)}.bind(this),r=t.convertToWorldSpaceAR(cc.v2(0,0)),c=this.root_wnd.convertToNodeSpaceAR(r),_=new cc.Node;_.setAnchorPoint(.5,.5),_.setPosition(c.x+71,c.y+45),this.root_wnd.addChild(_);var h=_.addComponent(sp.Skeleton);h.setCompleteListener(l);var d=s.getSpinePath(a,"action");this.loadRes(d,function(t,e){t.skeletonData=e,t.setAnimation(0,PlayerAction.action,!1)}.bind(this,h)),h.setTimeScale(1.3),this.collect_effect_list[i.id]=h,""!=o&&t.setOtherDesc(!0,o)}else e(i)}},handleSkillChoose:function(t){if(null!=t){var e=this.skill_list[t];null!=e&&null!=e.config&&(1==t?this.openChooseHP(e.config,e.num_value,e.use_count):2==t?this.openShotKill(e.config,e.num_value,e.use_count):3==t&&this.ctrl.send20607(t,0))}},openChooseHP:function(t,e,i){1!=this.model.allHeroIsDie()?this.ctrl.openAdventureUseHPWindow(!0,{config:t,num:e,use_count:i}):message(Utils.TI18N("\u6ca1\u6709\u53ef\u4f7f\u7528\u82f1\u96c4"))},openShotKill:function(t,e,i){this.ctrl.openAdventureShotKillWindow(!0,{config:t,num:e,use_count:i})},gotoNextFloor:function(t){if(!this.goto_next_alert){var e=function(){this.goto_next_alert=null}.bind(this);t=t||0;var i=function(){this.ctrl.send20620(t,r.AdventureEvenHandleType.handle,{}),this.goto_next_alert=null}.bind(this),s=Utils.TI18N("\u8fdb\u5165\u4e0b\u4e00\u5c42\u540e\uff0c\u5c06\u65e0\u6cd5\u8fd4\u56de\u8be5\u5c42\uff0c\u662f\u5426\u8fdb\u5165\uff1f"),n=this.model.getRoomList();if(n)for(var a in n)if(n[a].status==c.status.can_open){s=Utils.TI18N("\u672c\u5c42\u8fd8\u6709\u672a\u63a2\u7d22\u533a\u57df\uff0c\u6b64\u65f6\u8fdb\u5165\u4e0b\u4e00\u5c42\u53ef\u80fd\u4f1a\u9519\u8fc7\u4e8b\u4ef6\u5956\u52b1\uff0c\u662f\u5426\u7ee7\u7eed\uff1f");break}this.goto_next_alert=_.show(s,Utils.TI18N("\u786e\u5b9a"),i,Utils.TI18N("\u53d6\u6d88"),e,null,e)}},playSkillEffectAction:function(t,e){if(null!=t&&null!=e){var i=this.room_skill_list[t];if(null!=i){var n=i.getEvtImg();if(null!=n){var a=this.skill_list[e];if(null!=a&&null!=a.node){var o=n.node.getContentSize(),l=n.node.convertToWorldSpaceAR(cc.v2(0,0)),r=this.root_wnd.convertToNodeSpaceAR(l),c=a.node.convertToWorldSpaceAR(cc.v2(0,0)),_=this.root_wnd.convertToNodeSpaceAR(c),h="adventurewindow_6";2==e?h="adventurewindow_7":3==e&&(h="adventurewindow_8");var d=r.x+.5*o.width,u=r.y+.5*o.height,m=a.node.getContentSize(),f=_.x+.5*m.width,p=_.y+.5*m.height,g=s.getUIIconPath("adventurewindow",h),v=null;0==this.fly_cache_item_list.length?((v={}).item=Utils.createImage(this.root_wnd,null,d,u,cc.v2(.5,.5),!1),this.loadRes(g,function(t,e){t.spriteFrame=e}.bind(this,v.item)),v.res_id=g):v=this.fly_cache_item_list.shift(),v.item&&v.res_id&&(v.id=t,v.item.node.setScale(1.3),v.item.node.active=!0,v.item.node.setPosition(d,u),v.res_id!=g&&(v.res_id=g,this.loadRes(g,function(t,e){t.spriteFrame=e}.bind(this,v.item))),this.fly_item_list[t]=v,this.flySkillItemToTarget(v,d,u,f,p))}}}}},flySkillItemToTarget:function(t,e,i,s,n){if(null!=t&&null!=t.item){var a=[],o=cc.v2(e,i);a.push(o);var l=cc.v2(s,n),r=o.add(l).mul(.5),c=cc.v2(r.x+-30,o.y-10);a.push(c),a.push(l);var _=cc.bezierTo(1,a),h=function(t){t.item.node.active=!1,this.fly_item_list[t.id]=null,this.fly_cache_item_list.push(t)}.bind(this,t),d=cc.sequence(_,cc.callFunc(h)),u=cc.scaleTo(1,.5),m=cc.spawn(u,d);t.item.node.runAction(m)}},closeCallBack:function(){if(a.getInstance().resetUIFightType(),this.item_scrollview&&(this.item_scrollview.deleteMe(),this.item_scrollview=null),this.fly_item_list){for(var t in this.fly_item_list)this.fly_item_list[t]&&this.fly_item_list[t].item&&this.fly_item_list[t].item.node.stopAllActions();this.fly_item_list=null}for(var t in this.box_effect&&(this.box_effect.setToSetupPose(),this.box_effect.clearTracks(),this.box_effect=null),this.clearEneTime(),this.hero_list)this.hero_list[t].deleteMe();this.hero_list=null,this.playEnterEffect(!1),this.ctrl.openAdventureMainWindow(!1),this.is_wide_screen&&a.getInstance().setMainChatBoxCurViewType(h.ViewType.Normal)}});cc._RF.pop()},{adventure_cell_item_panel:"adventure_cell_item_panel",adventure_const:"adventure_const",adventure_event:"adventure_event",chat_const:"chat_const",common_scrollview:"common_scrollview",commonalert:"commonalert",mainui_controller:"mainui_controller",pathtool:"pathtool",rank_constant:"rank_constant",rank_controller:"rank_controller",timetool:"timetool",tips_controller:"tips_controller"}],adventure_model:[function(t,e,i){"use strict";cc._RF.push(e,"c4a6c1KRGZPGoer42/oM1wb","adventure_model");var s=t("adventure_event"),n=t("adventureactivity_controller"),a=t("adventureactivity_const"),o=t("mainscene_controller"),l=t("scene_const"),r=t("role_controller");cc.Class({extends:BaseClass,ctor:function(){},properties:{},initConfig:function(){this.room_list=[],this.base_data=[],this.buff_data=[],this.holiday_buff_data=[],this.form_list=[],this.select_partner_id=0,this.red_status=!1,this.backpack_list=[],this.plist=[],this.before_room=0,this.plunder_record_list=[],this.is_first_record_red=!0},updateFormPartner:function(t,e){this.form_list=t,this.select_partner_id=e,this.updateRedStatus(0==t.length),gcore.GlobalEvent.fire(s.UpdateAdventureForm)},updateRedStatus:function(t){this.red_status=t,0==n.getInstance().isOpenActivity(a.Ground_Type.adventure)&&(this.red_status=!1),o.getInstance().setBuildRedStatus(l.CenterSceneBuild.adventure,{bid:a.Red_Type.adventure,status:this.red_status})},setAdventureBoxStatus:function(t){for(var e in this.box_status_list={},t.list)this.box_status_list[t.list[e].id]=t.list[e].status;var i=!1;for(var e in t.list)if(1==t.list[e].status){i=!0;break}this.box_redpoint=i,gcore.GlobalEvent.fire(s.UpdateAdventureForm);var n=this.getAdventureRedPoint();o.getInstance().setBuildRedStatus(l.CenterSceneBuild.adventure,{bid:a.Red_Type.adventure,status:n})},getAdventureBoxStatus:function(t){return this.box_status_list&&this.box_status_list[t]?this.box_status_list[t]:0},getAdventureRedPoint:function(){var t=this.red_status||!1,e=this.box_redpoint||!1;return t||e},getFormList:function(){return this.form_list},allHeroIsDie:function(){var t=!0;for(var e in this.form_list)if(0!=this.form_list[e].now_hp){t=!1;break}return t},getSelectPartnerID:function(){return this.select_partner_id},updateSelectPartnerID:function(t){this.select_partner_id=t,gcore.GlobalEvent.fire(s.UpdateAdventureSelectHero)},setAdventureBaseData:function(t){this.base_data=t,gcore.GlobalEvent.fire(s.Update_Room_Base_Info)},getAdventureBaseData:function(){return this.base_data},setBuffData:function(t){this.buff_data=t.buff_list,this.holiday_buff_data=t.holiday_buff_list,gcore.GlobalEvent.fire(s.Update_Buff_Info)},getBuffData:function(){if(this.buff_data&&null!=Utils.next(this.buff_data||{}))return this.buff_data},getHolidayBuffData:function(){if(this.holiday_buff_data&&null!=Utils.next(this.holiday_buff_data||{}))return this.holiday_buff_data},setRoomList:function(t){if(null!=t&&null!=t.room_list){for(var e in t.room_list)this.room_list[t.room_list[e].id]=t.room_list[e];gcore.GlobalEvent.fire(s.Update_Room_Info)}},getRoomList:function(){if(this.room_list&&null!=Utils.next(this.room_list||{}))return this.room_list},updateRoomList:function(t){for(var e in t.room_list){var i=this.room_list[t.room_list[e].id];i&&(i.status=t.room_list[e].status,i.lock=t.room_list[e].lock,i.evt_id=t.room_list[e].evt_id)}gcore.GlobalEvent.fire(s.Update_Single_Room_Info,t)},getRoomInfoByRoomID:function(t){if(this.room_list&&null!=Utils.next(this.room_list||{})){var e=null;for(var i in this.room_list)if(this.room_list[i].id==t){e=this.room_list[i];break}return e}},getCurIndex:function(t,e){for(var i=t+1,s=0,n=0,a=r.getInstance().getRoleVo().vip_lev;e[i];)0==e[i].cost?s+=1:a>=e[i].vip&&(n+=1),i+=1;return[s,n]}});cc._RF.pop()},{adventure_event:"adventure_event",adventureactivity_const:"adventureactivity_const",adventureactivity_controller:"adventureactivity_controller",mainscene_controller:"mainscene_controller",role_controller:"role_controller",scene_const:"scene_const"}],adventure_shop_item_panel:[function(t,e,i){"use strict";cc._RF.push(e,"01657jVtvlJj5ZNWDUT5NGB","adventure_shop_item_panel");var s=t("pathtool");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("adventure","adventure_shop_item")},initConfig:function(){this.is_completed=!1},initPanel:function(){this.container=this.root_wnd.getChildByName("container"),this.name=this.container.getChildByName("name").getComponent(cc.Label);var t=this.container.getChildByName("count_bg");this.coin=t.getChildByName("coin").getComponent(cc.Sprite),this.price=t.getChildByName("price").getComponent(cc.Label),this.discount=this.container.getChildByName("discount"),this.discount_num=this.discount.getChildByName("discount_num").getComponent(cc.Label),this.sold=this.container.getChildByName("sold"),this.grey=this.container.getChildByName("grey"),this.item_container=this.container.getChildByName("item_container"),this.backpack_item=ItemsPool.getInstance().getItem("backpack_item"),this.backpack_item.initConfig(!1,1,!1,!0),this.backpack_item.setParent(this.item_container),this.backpack_item.show(),this.backpack_item.setPosition(0,0),this.grey.active=!1,this.data&&this.updateInfo()},registerEvent:function(){Utils.onTouchEnd(this.container,function(){this.call_back&&this.call_back(this)}.bind(this),1)},updateOverStatus:function(){null!=this.data&&(1==this.data.is_buy?(this.sold.active=!0,this.grey.active=!0):(this.sold.active=!1,this.grey.active=!1))},setData:function(t){this.data=t,this.root_wnd&&this.updateInfo()},getData:function(){return this.data},updateInfo:function(){if(this.data){var t=Utils.getItemConfig(this.data.bid),e=Utils.getItemConfig(this.data.pay_type);if(this.item_config=t,this.buy_config=e,t&&e){this.backpack_item.setData({bid:this.data.bid,num:this.data.num}),this.name.string=t.name;var i=s.getItemRes(e.icon);this.icon_res_id!=i&&(this.icon_res_id=i,this.loadRes(i,function(t){this.coin.spriteFrame=t}.bind(this)))}this.price.string=Utils.getMoneyString(this.data.pay_val),0!=this.data.discount?(this.discount.active=!0,this.discount_num.string=this.data.discount+Utils.TI18N("\u6298")):this.discount.active=!1,this.updateOverStatus()}},addCallBack:function(t){this.call_back=t},onShow:function(t){},onHide:function(){},onDelete:function(){this.backpack_item&&this.backpack_item.deleteMe(),this.backpack_item=null}});cc._RF.pop()},{pathtool:"pathtool"}],adventure_shop_window:[function(t,e,i){"use strict";cc._RF.push(e,"e0383QuGcxLlrVyDJkDxZrT","adventure_shop_window");var s=t("pathtool"),n=t("adventure_event"),a=t("common_scrollview"),o=t("backpack_const"),l=t("commonalert"),r=t("adventure_shop_item_panel"),c=t("timetool");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("adventure","adventure_shop_window"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Big,this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){},openCallBack:function(){this.background=this.root_wnd.getChildByName("background"),this.background.scale=FIT_SCALE;var t=this.root_wnd.getChildByName("container");t.getChildByName("win_title").getComponent(cc.Label).string=Utils.TI18N("\u5192\u9669\u5546\u5e97"),t.getChildByName("time_title").getComponent(cc.Label).string=Utils.TI18N("\u5546\u5e97\u91cd\u7f6e:"),this.close_btn=t.getChildByName("close_btn"),this.list_panel=t.getChildByName("list_panel"),this.time_value=t.getChildByName("time_value").getComponent(cc.Label),this.empty_tips=t.getChildByName("empty_tips"),this.empty_tips.getChildByName("desc").getComponent(cc.Label).string=Utils.TI18N("\u6682\u65e0\u5546\u54c1\uff0c\u5feb\u53bb\u5bfb\u627e\u5192\u9669\u5546\u4eba\u5427")},registerEvent:function(){Utils.onTouchEnd(this.close_btn,function(){this.ctrl.openAdventrueShopWindow(!1)}.bind(this),2),Utils.onTouchEnd(this.background,function(){this.ctrl.openAdventrueShopWindow(!1)}.bind(this),2),this.addGlobalEvent(n.UpdateShopTotalEvent,function(t){this.updateShopTotalList(t)}.bind(this)),this.addGlobalEvent(n.UpdateShopItemEvent,function(t){this.updateSingleShopItem(t)}.bind(this))},updateShopTotalList:function(t){if(null==t||null==Utils.next(t))this.scroll_view&&this.scroll_view.setVisible(!1),this.empty_tips.active=!0;else{this.empty_tips.active=!1;var e=function(t){this.selectItemHandle(t)}.bind(this);if(null==this.scroll_view){var i=this.list_panel.getContentSize(),s={item_class:r,start_x:0,space_x:0,start_y:0,space_y:4,item_width:306,item_height:143,row:2,col:2,need_dynamic:!0};this.scroll_view=new a,this.scroll_view.createScroll(this.list_panel,cc.v2(-i.width/2,-i.height/2),null,null,i,s)}t.sort(function(t,e){return t.is_buy-e.is_buy}),this.scroll_view.setVisible(!0),this.scroll_view.setData(t,e)}},selectItemHandle:function(t){if(null!=t&&null!=t.item_config&&null!=t.buy_config){var e=t.getData();if(e&&1==e.is_buy)message(Utils.TI18N("\u8be5\u7269\u54c1\u5df2\u88ab\u8d2d\u4e70"));else{var i=t.item_config,n=t.buy_config,a=o.quality_color(i.quality)||0,r=cc.js.formatStr("%s <img src='%s'/>%s%s<Color=%s>%s</Color>x%s",Utils.TI18N("\u662f\u5426\u6d88\u8017"),n.icon,Utils.getMoneyString(e.pay_val),Utils.TI18N("\u8d2d\u4e70"),a,i.name,e.num);l.show(r,Utils.TI18N("\u786e\u5b9a"),function(t){t&&this.ctrl.requestBuyShopItem(t.id)}.bind(this,e),Utils.TI18N("\u53d6\u6d88"),null,null,null,{resArr:[s.getItemRes(n.icon)]}),this.select_item=t,this.select_data=e}}},updateSingleShopItem:function(t){null!=this.select_item&&(this.select_data.id==t&&(this.select_data.is_buy=1),this.select_item.updateOverStatus())},openRootWnd:function(t){this.ctrl.requestShopTotal(),this.updateEndTime()},updateEndTime:function(){this.base_data=this.model.getAdventureBaseData(),null==this.timeticket&&(this.countDownEndTime(),this.timeticket=gcore.Timer.set(function(){this.countDownEndTime()}.bind(this),1e3,-1))},countDownEndTime:function(){if(null!=this.base_data){var t=this.base_data.end_time-gcore.SmartSocket.getTime();t<=0&&(t=0,this.clearEneTime()),this.time_value.string=c.getTimeFormat(t)}else this.clearEneTime()},clearEneTime:function(){this.timeticket&&(gcore.Timer.del(this.timeticket),this.timeticket=null)},closeCallBack:function(){this.ctrl.openAdventrueShopWindow(!1),this.clearEneTime(),this.scroll_view&&this.scroll_view.deleteMe(),this.scroll_view=null}});cc._RF.pop()},{adventure_event:"adventure_event",adventure_shop_item_panel:"adventure_shop_item_panel",backpack_const:"backpack_const",common_scrollview:"common_scrollview",commonalert:"commonalert",pathtool:"pathtool",timetool:"timetool"}],adventure_shot_kill_window:[function(t,e,i){"use strict";cc._RF.push(e,"81552HFmW5FWa062+GR6KXr","adventure_shot_kill_window");var s=t("pathtool"),n=t("playerhead"),a=t("adventure_event");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("adventure","adventure_shot_kill_window"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Big,this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){this.monster_list={}},openCallBack:function(){this.background=this.root_wnd.getChildByName("background"),this.background.scale=FIT_SCALE;var t=this.root_wnd.getChildByName("container");this.skill_name=t.getChildByName("skill_name").getComponent(cc.Label),this.skill_desc=t.getChildByName("skill_desc").getComponent(cc.Label),this.skill_num=t.getChildByName("skill_num").getComponent(cc.Label),this.empty_desc=t.getChildByName("empty_desc").getComponent(cc.Label),this.empty_desc.string=Utils.TI18N("\u6682\u65e0\u53ef\u51fb\u6740\u5b88\u536b"),this.choose_container=t.getChildByName("choose_container"),this.choose_container.getChildByName("choose_title").getComponent(cc.Label).string=Utils.TI18N("\u8bf7\u9009\u62e9\u4f7f\u7528\u76ee\u6807"),this.total_width=this.choose_container.getContentSize().width,this.cancen_btn=this.choose_container.getChildByName("cancen_btn"),this.confirm_btn=this.choose_container.getChildByName("confirm_btn")},registerEvent:function(){Utils.onTouchEnd(this.background,function(){this.ctrl.openAdventureShotKillWindow(!1)}.bind(this),2),Utils.onTouchEnd(this.cancen_btn,function(){this.ctrl.openAdventureShotKillWindow(!1)}.bind(this),2),Utils.onTouchEnd(this.confirm_btn,function(){null!=this.select_object&&null!=this.select_object.data?this.config&&this.ctrl.send20607(this.config.id,this.select_object.data.id):message(Utils.TI18N("\u8bf7\u9009\u62e9\u51fb\u6740\u76ee\u6807"))}.bind(this),1),this.addGlobalEvent(a.UpdateShotKillInfo,function(t){this.updateMonsterList(t)}.bind(this))},openRootWnd:function(t){if(this.ctrl.send20611(),t&&t.config){this.config=t.config,this.skill_name.string=this.config.name,this.skill_desc.string=Utils.TI18N("\u6548\u679c\uff1a")+this.config.desc;var e=t.num||0,i=this.config.max_num;if(i&&i>0){var s=t.use_count||0;this.skill_num.string=cc.js.formatStr(Utils.TI18N("\u672c\u8f6e\u5269\u4f59\u4f7f\u7528\u6570\u91cf\uff1a%d/%d"),i-s,e)}else this.skill_num.string=Utils.TI18N("\u5269\u4f59\u6570\u91cf\uff1a")+e}},updateMonsterList:function(t){if(null==t||null==Utils.next(t))this.choose_container.active=!1,this.empty_desc.active=!0;else{this.choose_container.active=!0,this.empty_desc.active=!1;var e=120*t.length,i=.5*(this.total_width-e);for(var s in t)this.createMonsterHead(t[s],s,i)}},createMonsterHead:function(t,e,i){if(null!=t&&null!=t.evt_id){var a=gdata("adventure_data","data_adventure_event",t.evt_id);if(null!=a&&null!=a.res_id&&null!=a.res_id[0]&&null!=a.res_id[0][1]&&!this.monster_list[t.evt_id]){var o={},l=new cc.Node;l.setContentSize(cc.size(120,120)),l.setAnchorPoint(.5,.5),l.setPosition(-this.choose_container.width/2+i+60+120*e,-this.choose_container.height/2+142),Utils.onTouchEnd(l,function(t){this.selectMonsterIcon(t.evt_id)}.bind(this,t),1),this.choose_container.addChild(l);var r=new n;r.setPosition(0,0),r.setParent(l),r.show(),r.setHeadRes(a.face);var c=Utils.createImage(l,null,0,0,cc.v2(.5,.5),!1,2);this.loadRes(s.getUIIconPath("adventurewindow","adventurewindow_15"),function(t,e){t.spriteFrame=e}.bind(this,c));var _=Utils.createImage(c.node,null,0,0,cc.v2(.5,.5),!1,3);this.loadRes(s.getCommonIcomPath("common_1043"),function(t,e){t.spriteFrame=e}.bind(this,_)),c.node.active=!1;var h=s.getUIIconPath("adventure/evt",a.res_id[0][1]),d=Utils.createImage(l,null,0,0,cc.v2(.5,.5),!1,4);this.loadRes(h,function(t,e){t.spriteFrame=e}.bind(this,d)),o.container=l,o.head=r,o.select=c,o.data=t,this.monster_list[t.evt_id]=o}}},selectMonsterIcon:function(t){this.select_object&&this.select_object.data&&this.select_object.data.evt_id==t||(this.select_object&&(this.select_object.select.node.active=!1,this.select_object=null),this.select_object=this.monster_list[t],this.select_object&&(this.select_object.select.node.active=!0))},closeCallBack:function(){for(var t in this.monster_list)this.monster_list[t].head&&this.monster_list[t].head.deleteMe();this.monster_list=null,this.ctrl.openAdventureShotKillWindow(!1)}});cc._RF.pop()},{adventure_event:"adventure_event",pathtool:"pathtool",playerhead:"playerhead"}],adventure_use_hp_window:[function(t,e,i){"use strict";cc._RF.push(e,"260b9aV0k5BFK+5KdA4Vq95","adventure_use_hp_window");var s=t("pathtool");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("adventure","adventure_use_hp_window"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Big,this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){this.index=2,this.hero_list=[]},openCallBack:function(){this.background=this.root_wnd.getChildByName("background"),this.background.scale=FIT_SCALE;var t=this.root_wnd.getChildByName("container");this.skill_name=t.getChildByName("skill_name").getComponent(cc.Label),this.skill_desc=t.getChildByName("skill_desc").getComponent(cc.Label),this.skill_num=t.getChildByName("skill_num").getComponent(cc.Label),this.choose_container=t.getChildByName("choose_container"),this.choose_container.getChildByName("choose_title").getComponent(cc.Label).string=Utils.TI18N("\u8bf7\u9009\u62e9\u4f7f\u7528\u76ee\u6807"),this.total_width=this.choose_container.getContentSize().width,this.cancen_btn=this.choose_container.getChildByName("cancen_btn"),this.confirm_btn=this.choose_container.getChildByName("confirm_btn")},registerEvent:function(){Utils.onTouchEnd(this.background,function(){this.ctrl.openAdventureUseHPWindow(!1)}.bind(this),2),Utils.onTouchEnd(this.cancen_btn,function(){this.ctrl.openAdventureUseHPWindow(!1)}.bind(this),2),Utils.onTouchEnd(this.confirm_btn,function(){if(null!=this.select_cell){var t=this.select_cell.getData();null!=t&&null!=t.partner_id&&0!=t.partner_id?this.config&&this.ctrl.send20607(this.config.id,t.partner_id):message(Utils.TI18N("\u6570\u636e\u5f02\u5e38,\u8bf7\u5173\u95ed\u91cd\u65b0\u6253\u5f00"))}else message(Utils.TI18N("\u8bf7\u9009\u62e9\u4f7f\u7528\u82f1\u96c4"))}.bind(this),1)},openRootWnd:function(t){if(t&&t.config){this.config=t.config,this.skill_name.string=this.config.name,this.skill_desc.string=Utils.TI18N("\u6548\u679c\uff1a")+this.config.desc;var e=t.num||0,i=this.config.max_num;if(i&&i>0){var s=t.use_count||0;this.skill_num.string=cc.js.formatStr(Utils.TI18N("\u672c\u8f6e\u5269\u4f59\u4f7f\u7528\u6570\u91cf\uff1a%d/%d"),i-s,e)}else this.skill_num.string=Utils.TI18N("\u5269\u4f59\u6570\u91cf\uff1a")+e;this.updateHeroList()}},updateHeroList:function(){var t=this.model.getFormList(),e=this.model.getSelectPartnerID(),i=130*t.length*.8,s=.5*(this.total_width-i);for(var n in t){var a=t[n],o=function(t){this.selectHeroItem(t)}.bind(this);null==this.hero_list[n]&&(this.hero_list[n]=ItemsPool.getInstance().getItem("hero_exhibition_item"),this.hero_list[n].setExtendData({can_click:!0}),this.hero_list[n].setParent(this.choose_container),this.hero_list[n].show(),this.hero_list[n].setScale(.8),this.hero_list[n].addCallBack(o),this.hero_list[n].setPosition(-this.choose_container.width/2+s+.8*(65+130*n),-this.choose_container.height/2+152));var l=this.hero_list[n];this.updateHeroInfo(l,a),0!=e&&a.partner_id==e&&this.selectHeroItem(l)}},updateHeroInfo:function(t,e){if(null!=t){t.setData(e);var i=e.now_hp/e.hp;t.showProgressbar(100*i),0==i?t.showStrTips(!0,Utils.TI18N("\u5df2\u9635\u4ea1")):t.showStrTips(!1)}},selectHeroItem:function(t){if(t){var e=t.getData();e&&(0!=e.now_hp?this.select_cell!=t&&(this.select_cell&&(this.select_cell.setSelected(!1),this.select_cell=null),this.select_cell=t,this.select_cell.setSelected(!0)):message(Utils.TI18N("\u6b7b\u4ea1\u82f1\u96c4\u65e0\u6cd5\u9009\u62e9")))}},closeCallBack:function(){for(var t in this.hero_list)this.hero_list[t].deleteMe();this.hero_list=null,this.ctrl.openAdventureUseHPWindow(!1)}});cc._RF.pop()},{pathtool:"pathtool"}],adventureactivity_const:[function(t,e,i){"use strict";cc._RF.push(e,"a472bAE/qdMGJaWfvfP0r8A","adventureactivity_const");e.exports={Ground_Type:{adventure:1,element:2,heaven:3},Red_Type:{adventure:1,element:2,heaven:3}},cc._RF.pop()},{}],adventureactivity_controller:[function(t,e,i){"use strict";cc._RF.push(e,"cd6ed3mIx5FUqQ23Jz6gSIR","adventureactivity_controller");var s=t("mainui_controller"),n=t("battle_const"),a=t("adventureactivity_const"),o=t("adventure_controller"),l=cc.Class({extends:BaseController,ctor:function(){},initConfig:function(){var e=t("adventureactivity_model");this.model=new e,this.model.initConfig()},getModel:function(){return this.model},registerEvents:function(){},registerProtocals:function(){},openAdventureActivityMainWindow:function(t){1==t?(null==this.adventure_activity_window&&(this.adventure_activity_window=Utils.createClass("adventureactivity_window",this)),0==this.adventure_activity_window.isOpen()&&this.adventure_activity_window.open()):this.adventure_activity_window&&(this.adventure_activity_window.close(),this.adventure_activity_window=null)},onClickGotoAdvenTureAcivity:function(t){t==a.Ground_Type.adventure?o.getInstance().requestEnterAdventure():t==a.Ground_Type.element?s.getInstance().requestOpenBattleRelevanceWindow(n.Fight_Type.ElementWar):t==a.Ground_Type.heaven&&s.getInstance().requestOpenBattleRelevanceWindow(n.Fight_Type.HeavenWar)},isOpenActivity:function(t){var e=Config.cross_ground_data.data_adventure_activity,i=!1;e[t]&&(1==s.getInstance().checkIsOpenByActivate(e[t].activate)&&(i=!0));return i}});e.exports=l,cc._RF.pop()},{adventure_controller:"adventure_controller",adventureactivity_const:"adventureactivity_const",adventureactivity_model:"adventureactivity_model",battle_const:"battle_const",mainui_controller:"mainui_controller"}],adventureactivity_item_panel:[function(t,e,i){"use strict";cc._RF.push(e,"ab139obfzZPRbcq7m3tWfJe","adventureactivity_item_panel");var s=t("pathtool"),n=t("adventureactivity_const"),a=t("mainui_controller"),o=t("adventureactivity_controller"),l=t("adventure_controller");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("adventureactivity","adventureactivity_item"),this.ctrl=o.getInstance()},initConfig:function(){},initPanel:function(){this.main_container=this.root_wnd.getChildByName("main_container"),this.item_bg_node=this.main_container.getChildByName("item_bg"),this.item_bg=this.item_bg_node.getComponent(cc.Sprite),this.open_desc=this.main_container.getChildByName("open_desc").getComponent(cc.Label),this.open_desc.node.active=!1,this.open_desc2=this.main_container.getChildByName("open_desc_2").getComponent(cc.Label),this.open_desc2.node.active=!1,this.join_bg=this.main_container.getChildByName("join_bg"),this.join_desc=this.main_container.getChildByName("join_desc").getComponent(cc.Label),this.join_desc.string="",this.lock_layer=this.main_container.getChildByName("lock_layer"),this.award_list=this.main_container.getChildByName("award_list"),this.award_list.active=!1;var e=this.award_list.getContentSize(),i=t("common_scrollview");this.award_scrollview=new i,this.award_scrollview.createScroll(this.award_list,cc.v2(0,0),ScrollViewDir.horizontal,ScrollViewStartPos.top,e,{item_class:"backpack_item",start_x:0,space_x:10,start_y:0,space_y:0,item_width:84,item_height:84,row:1,col:0,need_dynamic:!0,scale:.7}),this.data&&this.updateInfo()},registerEvent:function(){this.main_container.on(cc.Node.EventType.TOUCH_START,function(t){var e=t.getTouches();this.touch_began=e[0].getDelta()},this),this.main_container.on(cc.Node.EventType.TOUCH_END,function(t){var e=t.getTouches();this.touch_end=e[0].getDelta();var i=!0;if((null!=this.touch_began&&(i=Math.abs(this.touch_end.x-this.touch_began.x)<=20&&Math.abs(this.touch_end.y-this.touch_began.y)<=20),i)&&this.data)if(1==a.getInstance().checkIsOpenByActivate(this.data.activate))this.ctrl.onClickGotoAdvenTureAcivity(this.data.retrue_id);else if(this.data.id==n.Ground_Type.heaven){var s=cc.js.formatStr(Utils.TI18N("%s\uff0c\u89d2\u8272%s\u53ef\u8fdb\u5165"),this.data.desc2,this.data.desc);message(s)}else message(this.data.desc)},this)},setData:function(t){t&&(this.data=t,this.root_wnd&&this.updateInfo())},updateInfo:function(){var t=s.getBigBg(cc.js.formatStr("txt_cn_adventrueactivity_%d",this.data.res_id),null,"adventrueactivity");this.loadRes(t,function(t){this.item_bg.spriteFrame=t}.bind(this)),this.join_desc.string=this.data.item_desc;var e=this.join_desc.node.getContentSize();e.width<250&&(e.width=250),this.join_bg.setContentSize(cc.size(e.width+60,e.height));var i=[];for(var n in this.data.award){var o=this.data.award[n],l={};l&&(l.bid=o[0],l.num=o[1],i.push(l))}this.award_scrollview.setData(i),this.award_scrollview.addEndCallBack(function(){var t=this.award_scrollview.getItemList();for(var e in t){t[e].getData();t[e].setDefaultTip(!0,null,null,void 0)}}.bind(this)),1==a.getInstance().checkIsOpenByActivate(this.data.activate)?(this.lock_layer.active=!1,this.open_desc.node.active=!1,this.award_list.active=!0):(this.lock_layer.active=!0,this.open_desc.string=this.data.desc,this.open_desc.node.active=!0,""!=this.data.desc&&(this.open_desc2.string=this.data.desc2,this.open_desc2.node.active=!0),this.award_list.active=!1),this.updateRedStatus()},updateRedStatus:function(){if(this.data){var t=!1;this.data.id==n.Ground_Type.adventure?t=l.getInstance().getModel().getAdventureRedPoint():this.data.id==n.Ground_Type.element||(this.data.id,n.Ground_Type.heaven),0==a.getInstance().checkIsOpenByActivate(this.data.activate)&&(t=!1),Utils.addRedPointToNodeByStatus(this.main_container,t,this.main_container.width/2,this.main_container.height/2,99,2)}},onShow:function(t){},onHide:function(){},onDelete:function(){this.award_scrollview&&(this.award_scrollview.deleteMe(),this.award_scrollview=null)}});cc._RF.pop()},{adventure_controller:"adventure_controller",adventureactivity_const:"adventureactivity_const",adventureactivity_controller:"adventureactivity_controller",common_scrollview:"common_scrollview",mainui_controller:"mainui_controller",pathtool:"pathtool"}],adventureactivity_model:[function(t,e,i){"use strict";cc._RF.push(e,"3db44ySW01FpZEwD8p6m2JN","adventureactivity_model");cc.Class({extends:BaseClass,ctor:function(){},properties:{},initConfig:function(){}});cc._RF.pop()},{}],adventureactivity_window:[function(t,e,i){"use strict";cc._RF.push(e,"53fe27YedtO7IamEbg1xEYV","adventureactivity_window");var s=t("pathtool"),n=t("adventure_event");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("adventureactivity","adventureactivity_window"),this.viewTag=SCENE_TAG.ui,this.win_type=WinType.Full,this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){},openCallBack:function(){this.background=this.root_wnd.getChildByName("background").getComponent(cc.Sprite),this.background.node.scale=FIT_SCALE;var e=s.getBigBg("bigbg_83");this.loadRes(e,function(t){this.background.spriteFrame=t}.bind(this));var i=this.root_wnd.getChildByName("main_container");this.close_btn=i.getChildByName("close_btn");var n=i.getChildByName("scroll_list"),a=n.getContentSize(),o={item_class:t("adventureactivity_item_panel"),start_x:0,space_x:0,start_y:0,space_y:23,item_width:687,item_height:214,row:0,col:1,need_dynamic:!0},l=t("common_scrollview");this.item_scrollview=new l,this.item_scrollview.createScroll(n,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,a,o)},registerEvent:function(){Utils.onTouchEnd(this.close_btn,function(){this.ctrl.openAdventureActivityMainWindow(!1)}.bind(this),2),this.addGlobalEvent(n.UpdateAdventureForm,function(){this.updateItemListRedStatus()}.bind(this))},updateItemListRedStatus:function(){if(this.item_scrollview){var t=this.item_scrollview.getItemList();if(t)for(var e in t)t[e].updateRedStatus()}},openRootWnd:function(t){if(this.item_scrollview){var e=Config.cross_ground_data.data_adventure_activity,i=[];for(var s in e)1==e[s].id&&i.push(e[s]);this.item_scrollview.setData(i)}},closeCallBack:function(){this.item_scrollview&&(this.item_scrollview.deleteMe(),this.item_scrollview=null),this.ctrl.openAdventureActivityMainWindow(!1)}});cc._RF.pop()},{adventure_event:"adventure_event",adventureactivity_item_panel:"adventureactivity_item_panel",common_scrollview:"common_scrollview",pathtool:"pathtool"}],arean_loop_rank_item:[function(t,e,i){"use strict";cc._RF.push(e,"83a2eooCrpFxKbDaUq7wKuQ","arean_loop_rank_item");var s=t("pathtool"),n=t("playerhead"),a=t("role_controller");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("arena","arean_loop_rank_item")},initConfig:function(){this.data_avatar=Config.avatar_data.data_avatar},initPanel:function(){this.rank_img_nd=this.seekChild("rank_img"),this.rank_img_sp=this.seekChild("rank_img",cc.Sprite),this.rank_txt_nd=this.seekChild("rank_txt"),this.rank_txt_ct=this.rank_txt_nd.getComponent("CusRichText"),this.loadRes(s.getIconPath("num","type1","plist"),function(t){this.rank_txt_ct.fontAtlas=t}.bind(this)),this.head_nd=this.seekChild("head"),this.role_name_lb=this.seekChild("role_name",cc.Label),this.role_power_lb=this.seekChild("role_power",cc.Label),this.wish_num_lb=this.seekChild("wish_num",cc.Label),this.duanwei_num_lb=this.seekChild("duanwei_num",cc.Label),this.wish_container_sp=this.seekChild("wish_container",cc.Sprite),this.finger_sp=this.seekChild("finger",cc.Sprite),this.wish_container_btn=this.seekChild("wish_container",cc.Button),this.wish_container_nd=this.seekChild("wish_container"),this.role_head=new n,this.role_head.setParent(this.head_nd),this.role_head.show(),this.wish_container_nd.on(cc.Node.EventType.TOUCH_END,this.onClickWishBtn,this)},registerEvent:function(){},onShow:function(t){this.role_data&&this.updageWidgets()},onHide:function(){},onDelete:function(){},initRankList:function(){},setExtendData:function(){},addCallBack:function(t){this.click_cb=t},setData:function(t){this.role_data=t,this.root_wnd&&this.updageWidgets()},updageWidgets:function(){if(this.role_name_lb.string=this.role_data.name,this.role_power_lb.string=this.role_data.power,this.wish_num_lb.string=this.role_data.worship,this.duanwei_num_lb.string=this.role_data.score,this.role_head.setHeadRes(this.role_data.face),this.role_head.setLev(this.role_data.lev),this.data_avatar){var t=this.data_avatar[this.role_data.avatar_id].res_id||0,e=s.getIconPath("headcircle","txt_cn_headcircle_"+t);this.role_head.showBg(e)}if(this.role_data.rank<=3){this.rank_img_nd.active=!0,this.rank_txt_nd.active=!1;var i=s.getUIIconPath("common","common_200"+this.role_data.rank);this.loadRes(i,function(t){this.rank_img_sp.spriteFrame=t}.bind(this))}else this.rank_img_nd.active=!1,this.rank_txt_nd.active=!0,this.rank_txt_ct.setNum(this.role_data.rank);this.role_data.worship_status?(this.wish_container_sp.setMaterial(0,cc.Material.getBuiltinMaterial("2d-gray-sprite")),this.finger_sp.setMaterial(0,cc.Material.getBuiltinMaterial("2d-gray-sprite")),this.wish_container_btn.interactable=!1):(this.wish_container_btn.interactable=!0,this.wish_container_sp.setMaterial(0,cc.Material.getBuiltinMaterial("2d-sprite")),this.finger_sp.setMaterial(0,cc.Material.getBuiltinMaterial("2d-sprite")))},onClickWishBtn:function(){a.getInstance().sender10316(this.role_data.rid,this.role_data.srv_id,this.role_data.rank)}});cc._RF.pop()},{pathtool:"pathtool",playerhead:"playerhead",role_controller:"role_controller"}],arena_champion_cur_guess_panel:[function(t,e,i){"use strict";cc._RF.push(e,"500d4JGxaZCYoRxcfgT5eE5","arena_champion_cur_guess_panel");var s=t("pathtool"),n=t("arena_event"),a=t("arena_const"),o=t("battle_controller");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("arena","arena_champion_cur_guess_panel"),this.ctrl=arguments[0],this.model=this.ctrl.getChamPionModel()},initConfig:function(){},initPanel:function(){this.main_panel_nd=this.seekChild("main_panel"),this.container_nd=this.seekChild("container"),this.guess_value_lb=this.seekChild("guess_value",cc.Label),this.left_name_lb=this.seekChild("left_name",cc.Label),this.right_name_lb=this.seekChild("right_name",cc.Label),this.left_total_value_lb=this.seekChild("left_total_value",cc.Label),this.right_total_value_lb=this.seekChild("right_total_value",cc.Label),this.left_guess_btn_nd=this.seekChild("left_guess_btn"),this.right_guess_btn_nd=this.seekChild("right_guess_btn"),this.left_btn_title_lb=this.seekChild("left_btn_title",cc.Label),this.right_btn_title_lb=this.seekChild("right_btn_title",cc.Label),this.left_guess_btn_nd.btn_tag=1,this.right_guess_btn_nd.btn_tag=2,this.left_guess_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickGussBtn,this),this.right_guess_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickGussBtn,this),this.progress_bar_pb=this.seekChild("progress_bar",cc.ProgressBar);var t=this.seekChild("item_img_2",cc.Sprite);this.loadRes(s.getIconPath("item","19"),function(e){t.spriteFrame=e}.bind(this))},registerEvent:function(){this.addGlobalEvent(n.UpdateGuessMatchInfoEvent,function(t){cc.log("\u7ade\u731c\u6570\u636e"),cc.log(t),t&&this.updateFightInfo(t)}.bind(this)),this.addGlobalEvent(n.UpdateRoleInfoBetEvent,function(t,e){t=t||0,this.guess_value_lb.string=t,this.changeGuessBtnStatus(e)}.bind(this)),this.addGlobalEvent(n.UpdateBetMatchValueEvent,function(t){t&&(this.bet_data=t,this.updateBetMatchValue(t)),cc.log("\u62bc\u6ce8\u540e\u8fd4\u56de"),cc.log(t)}.bind(this))},onShow:function(t){this.updageWidget(t)},onHide:function(){},onDelete:function(){this.vs_panel&&(this.vs_panel.deleteMe(),this.vs_panel=null)},onVisible:function(t){t&&(this.is_change_tab=!0)},updateMyGuessList:function(){},updateBaseInfo:function(){this.root_wnd&&this.updageWidget()},updageWidget:function(){var t=this.base_info=this.model.getBaseInfo(),e=this.role_info=this.model.getRoleInfo();t&&e&&(t.step==a.champion_step.unopened||t.step==a.champion_step.score&&(0==t.round||1===t.round&&t.round_status==a.champion_round_status.prepare)?this.root_wnd.active=!1:(this.root_wnd.active=!0,this.ctrl.sender20253()),this.guess_value_lb.string=e.can_bet)},updateFightInfo:function(e){if(e){if(!this.vs_panel){var i=t("arena_champion_vs_panel");this.vs_panel=new i,this.vs_panel.setParent(this.container_nd),this.vs_panel.show()}if(this.vs_panel.updateFightInfo(e),this.bet_data=e,this.updateBetMatchValue(e),this.root_wnd&&this.root_wnd.active&&!this.is_change_tab)if(this.base_info&&2==this.base_info.flag&&0!=e.replay_id&&this.cur_data&&!this.cur_data.replay_id)this.base_info.step+"_"+this.base_info.round==e.step+"_"+e.round&&o.getInstance().csRecordBattle(e.replay_id);this.cur_data=e,this.is_change_tab=!1}},updateBetMatchValue:function(t){var e=t.a_bet||0,i=t.b_bet||0;this.left_total_value_lb.string=cc.js.formatStr(Utils.TI18N("\u8d54\u7387:%s"),parseInt(t.a_bet_ratio/10)/100),this.right_total_value_lb.string=cc.js.formatStr(Utils.TI18N("\u8d54\u7387:%s"),parseInt(t.b_bet_ratio/10)/100),this.bet_data&&(this.bet_data.a_bet_ratio=t.a_bet_ratio,this.bet_data.b_bet_ratio=t.b_bet_ratio);var s=e+i;this.progress_bar_pb.progress=0===s?.5:e/s,t.a_name&&(this.left_name_lb.string=t.a_name),t.b_name&&(this.right_name_lb.string=t.b_name),void 0!==t.bet_type&&this.changeGuessBtnStatus(t.bet_type)},changeGuessBtnStatus:function(t){if(t=t||0,this.guess_bet_type!=t){this.guess_bet_type=t;var e="",i="";0==t?(e=Utils.TI18N("\u7ade\u731c"),i=Utils.TI18N("\u7ade\u731c")):1==t?(e=Utils.TI18N("\u5df2\u7ade\u731c"),i=Utils.TI18N("\u7ade\u731c")):(e=Utils.TI18N("\u7ade\u731c"),i=Utils.TI18N("\u5df2\u7ade\u731c")),this.left_btn_title_lb.string=e,this.right_btn_title_lb.string=i}},onClickGussBtn:function(t){cc.log(t.target.btn_tag);var e="a_";if(2==t.target.btn_tag&&(e="b_"),0!==this.guess_bet_type)message(Utils.TI18N("\u5df2\u7ecf\u7ade\u731c\u8fc7\u5566"));else if(this.base_info&&this.role_info&&this.bet_data)if(this.base_info.round_status==a.champion_round_status.guess){var i={};i.name=this.bet_data[e+"name"],i.srv_id=this.bet_data[e+"srv_id"],i.rid=this.bet_data[e+"rid"],i.bet_ratio=this.bet_data[e+"bet_ratio"],i.can_bet=this.role_info.can_bet,i.bet_type=t.target.btn_tag,this.ctrl.openArenaChampionGuessWindow(!0,i)}else message(Utils.TI18N("\u5f53\u524d\u9636\u6bb5\u4e0d\u53ef\u4ee5\u62bc\u6ce8"))}});cc._RF.pop()},{arena_champion_vs_panel:"arena_champion_vs_panel",arena_const:"arena_const",arena_event:"arena_event",battle_controller:"battle_controller",pathtool:"pathtool"}],arena_champion_cur_rank_item:[function(t,e,i){"use strict";cc._RF.push(e,"2663clctltN0a/09dTGwg8Z","arena_champion_cur_rank_item");var s=t("pathtool"),n=t("role_controller");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("arena","arena_champion_cur_rank_item")},initConfig:function(){},initPanel:function(){this.rank_img_nd=this.seekChild("rank_img"),this.rank_img_sp=this.rank_img_nd.getComponent(cc.Sprite),this.rank_txt_nd=this.seekChild("rank_txt"),this.rank_txt_rt=this.rank_txt_nd.getComponent("CusRichText"),this.role_name_lb=this.seekChild("role_name",cc.Label),this.role_power_lb=this.seekChild("role_power",cc.Label),this.worship_num_lb=this.seekChild("num",cc.Label),this.head_con_nd=this.seekChild("head_con"),this.score_num_lb=this.seekChild("score_num",cc.Label),this.finger_img_sp=this.seekChild("finger_img",cc.Sprite),this.wish_container_nd=this.seekChild("wish_container"),this.wish_container_btn=this.seekChild("wish_container",cc.Button),this.wish_container_sp=this.seekChild("wish_container",cc.Sprite);var e=t("playerhead");this.role_head=new e,this.role_head.setParent(this.head_con_nd),this.role_head.show(),this.wish_container_nd.on(cc.Node.EventType.TOUCH_END,this.onClickWorshipBtn,this)},registerEvent:function(){},onShow:function(t){this.updateWidgets()},onHide:function(){},onDelete:function(){},setData:function(t){this.rank_data=t,this.root_wnd&&this.updateWidgets()},updateWidgets:function(){if(this.rank_data){var t=this.rank_data;if(t.rank<=3){this.rank_img_nd.active=!0,this.rank_txt_nd.active=!1;var e=s.getUIIconPath("common",cc.js.formatStr("common_300%s",t.rank));this.loadRes(e,function(t){this.rank_img_sp.spriteFrame=t}.bind(this))}else this.rank_img_nd.active=!1,this.rank_txt_nd.active=!0,this.rank_txt_rt.setNum(t.rank);this.role_name_lb.string=t.name,this.role_power_lb.string=t.power,this.worship_num_lb.string=t.worship,this.score_num_lb.string=t.score,this.role_head.setHeadRes(t.face),this.role_head.setLev(t.lev),this.rank_data.worship_status?(this.wish_container_sp.setMaterial(0,cc.Material.getBuiltinMaterial("2d-gray-sprite")),this.wish_container_btn.interactable=!1,this.finger_img_sp.setMaterial(0,cc.Material.getBuiltinMaterial("2d-gray-sprite"))):(this.wish_container_btn.interactable=!0,this.wish_container_sp.setMaterial(0,cc.Material.getBuiltinMaterial("2d-sprite")),this.finger_img_sp.setMaterial(0,cc.Material.getBuiltinMaterial("2d-sprite")))}},onClickWorshipBtn:function(){n.getInstance().sender10316(this.rank_data.rid,this.rank_data.srv_id,this.rank_data.rank)}});cc._RF.pop()},{pathtool:"pathtool",playerhead:"playerhead",role_controller:"role_controller"}],arena_champion_cur_rank_panel:[function(t,e,i){"use strict";cc._RF.push(e,"23f6eZJlRZG/4Aiz3Ouv2AU","arena_champion_cur_rank_panel");var s=t("pathtool"),n=t("arena_event"),a=t("role_event"),o=t("common_scrollview"),l=t("arena_champion_cur_rank_item");a=t("role_event"),cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("arena","arena_champion_cur_rank_panel"),this.ctrl=arguments[0],this.model=this.ctrl.getChamPionModel()},initConfig:function(){var e=t("role_controller");this.role_vo=e.getInstance().getRoleVo()},initPanel:function(){this.items_container_nd=this.seekChild("items_container"),this.empty_tips_nd=this.seekChild("empty_tips"),this.rank_img_nd=this.seekChild("rank_img"),this.rank_img_sp=this.rank_img_nd.getComponent(cc.Sprite),this.rank_txt_nd=this.seekChild("rank_txt"),this.rank_txt_rt=this.rank_txt_nd.getComponent("CusRichText"),this.role_name_lb=this.seekChild("role_name",cc.Label),this.role_power_lb=this.seekChild("role_power",cc.Label),this.worship_num_lb=this.seekChild("num",cc.Label),this.head_con_nd=this.seekChild("head_con");var e=t("playerhead");this.role_head=new e,this.role_head.setParent(this.head_con_nd),this.role_head.show(),this.initRankList()},registerEvent:function(){this.addGlobalEvent(n.UpdateChampionRankEvent,function(t){t&&this.updateRankList(t)}.bind(this)),this.addGlobalEvent(a.WorshipOtherRole,function(t){t&&this.updateOtherWorship(t)}.bind(this))},onShow:function(t){this.ctrl.sender20281()},onVisible:function(t){t&&this.ctrl.sender20281()},onDelete:function(){this.activity_sv&&this.activity_sv.deleteMe(),this.activity_sv=null},updateBaseInfo:function(){},initRankList:function(){var t=this.items_container_nd.getContentSize(),e=cc.size(t.width,t.height),i={item_class:l,start_x:0,space_x:0,start_y:0,space_y:0,item_width:680,item_height:140,row:0,col:1,need_dynamic:!0};this.activity_sv=new o,this.activity_sv.createScroll(this.items_container_nd,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,e,i,cc.v2(.5,.5))},updateRankList:function(t){var e=this.rank_list=t.rank_list;this.activity_sv.setData(e),0===e.length?this.empty_tips_nd.active=!0:this.empty_tips_nd.active=!1,this.updateMyInfo(t)},updateMyInfo:function(t){if(t){if(t.rank<=3&&t.rank>0){this.rank_img_nd.active=!0,this.rank_txt_nd.active=!1;var e=s.getUIIconPath("common",cc.js.formatStr("common_300%s",t.rank));this.loadRes(e,function(t){this.rank_img_sp.spriteFrame=t}.bind(this))}else 0===t.rank?(this.rank_img_nd.active=!1,this.rank_txt_nd.active=!1):(this.rank_img_nd.active=!1,this.rank_txt_nd.active=!0,this.rank_txt_rt.setNum(t.rank));this.role_name_lb.string=this.role_vo.name,this.role_power_lb.string=this.role_vo.power,this.worship_num_lb.string=t.worship,this.role_head.setHeadRes(this.role_vo.face_id),this.role_head.setLev(this.role_vo.lev)}},updateOtherWorship:function(t){var e=t.idx-1,i=this.rank_list[e];i.worship+=1,i.worship_status=1,this.activity_sv.updateItemData(e,i)}});cc._RF.pop()},{arena_champion_cur_rank_item:"arena_champion_cur_rank_item",arena_event:"arena_event",common_scrollview:"common_scrollview",pathtool:"pathtool",playerhead:"playerhead",role_controller:"role_controller",role_event:"role_event"}],arena_champion_guess_window:[function(t,e,i){"use strict";cc._RF.push(e,"f8dcfudriBKxZy58C3Lejyv","arena_champion_guess_window");var s=t("pathtool");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("arena","arena_champion_guess_window"),this.viewTag=SCENE_TAG.ui,this.win_type=WinType.Full,this.ctrl=arguments[0],this.model=this.ctrl.getChamPionModel()},initConfig:function(){this.can_bet=0,this.guess_config=Config.arena_champion_data.data_const.guess_coin,this.max_config=Config.arena_champion_data.data_const.guess_limit,this.guess_coin=this.guess_config.val},openCallBack:function(){this.set_left_nd=this.seekChild("set_left"),this.set_right_nd=this.seekChild("set_right"),this.set_max_nd=this.seekChild("set_max"),this.cancel_btn_nd=this.seekChild("cancel_btn"),this.confirm_btn_nd=this.seekChild("confirm_btn"),this.mask_nd=this.seekChild("mask"),this.close_btn_nd=this.seekChild("close_btn"),this.mask_nd.scale=FIT_SCALE,this.set_value_lb=this.seekChild("set_value",cc.Label),this.guess_value_lb=this.seekChild("guess_value",cc.Label),this.get_value_lb=this.seekChild("get_value",cc.Label),this.guess_role_lb=this.seekChild("guess_role",cc.Label);var t=this.seekChild("Sprite_2",cc.Sprite),e=this.seekChild("Sprite_1",cc.Sprite);this.close_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickCloseBtn,this),this.mask_nd.on(cc.Node.EventType.TOUCH_END,this.onClickCloseBtn,this),this.cancel_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickCloseBtn,this),this.set_left_nd.on(cc.Node.EventType.TOUCH_END,this.onClickLeftBtn,this),this.set_right_nd.on(cc.Node.EventType.TOUCH_END,this.onClickRightBtn,this),this.set_max_nd.on(cc.Node.EventType.TOUCH_END,this.onClickMaxBtn,this),this.confirm_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickConfirmBtn,this);var i=s.getIconPath("item","19");this.loadRes(i,function(i){t.spriteFrame=i,e.spriteFrame=i}.bind(this))},registerEvent:function(){},openRootWnd:function(t){t&&(this.guess_data=t,this.updateWidgets())},closeCallBack:function(){this.ctrl.openArenaChampionGuessWindow(!1)},updateWidgets:function(){this.guess_role_lb.string=this.guess_data.name||"",this.guess_value_lb.string=this.guess_data.can_bet;var t=this.guess_data.bet_ratio||2e3;this.guess_times=.001*t,this.can_bet=this.guess_data.can_bet,this.max_config.val<this.can_bet&&(this.can_bet=this.max_config.val),this.guess_value_lb.string=this.can_bet,this.can_bet<this.guess_coin?(this.set_value_lb.string=0,this.get_value_lb.string=0):this.setGuessValue(this.guess_coin)},onClickCloseBtn:function(t){this.ctrl.openArenaChampionGuessWindow(!1)},setGuessValue:function(t){if(this.guess_data){this.cur_set_val=t;var e=Math.floor(this.cur_set_val*this.guess_times);this.set_value_lb.string=this.cur_set_val,this.get_value_lb.string=e}},onClickLeftBtn:function(t){if(this.guess_data){var e=this.cur_set_val-this.guess_coin;e<0&&(e=0),this.setGuessValue(e)}},onClickRightBtn:function(t){if(this.guess_data){var e=this.cur_set_val+this.guess_coin;e>this.can_bet&&(e=this.can_bet),this.setGuessValue(e)}},onClickMaxBtn:function(t){this.guess_data&&this.can_bet>this.guess_coin&&this.setGuessValue(this.can_bet)},onClickConfirmBtn:function(){this.guess_data&&this.cur_set_val>0&&this.ctrl.sender20254(this.guess_data.bet_type,this.cur_set_val)}});cc._RF.pop()},{pathtool:"pathtool"}],arena_champion_info_vo:[function(t,e,i){"use strict";cc._RF.push(e,"c44cdNmI8BGoJZ3criG1a51","arena_champion_info_vo"),cc._RF.pop()},{}],arena_champion_match_window:[function(t,e,i){"use strict";cc._RF.push(e,"c9628InEnJOMav2nFg/+Dft","arena_champion_match_window");var s=t("pathtool"),n=t("arena_event"),a=t("arena_const"),o=t("timetool"),l=t("hero_controller"),r=t("hero_const"),c=t("partner_const"),_=t("mall_controller"),h=t("mall_const");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("arena","arena_champion_match_window"),this.viewTag=SCENE_TAG.ui,this.win_type=WinType.Full,this.ctrl=arguments[0],this.model=this.ctrl.getChamPionModel()},initConfig:function(){this.cur_tab=null,this.cur_panel=null,this.update_timer=null,this.tab_panels={}},openCallBack:function(){this.select_img_nd=this.seekChild("select_img"),this.container_nd=this.seekChild("container"),this.close_btn_nd=this.seekChild("close_btn"),this.panel_title_nd=this.seekChild("panel_title"),this.panel_title_lb=this.seekChild("panel_title",cc.Label),this.match_time_nd=this.seekChild("match_time"),this.match_time_lb=this.seekChild("match_time",cc.Label),this.my_guess_btn_nd=this.seekChild("my_guess_btn"),this.guess_btn_title_lb=this.seekChild("guess_btn_title",cc.Label),this.explain_btn_nd=this.seekChild("explain_btn"),this.shop_btn_nd=this.seekChild("shop_btn"),this.awards_btn_nd=this.seekChild("awards_btn"),this.background=this.seekChild("background"),this.background.scale=FIT_SCALE,this.loadRes(s.getBattleSingleBg("10010"),function(t){this.background.getComponent(cc.Sprite).spriteFrame=t}.bind(this)),this.tab_btn_infos={};for(var t=1;t<=4;t++){var e=this.tab_btn_infos[t]={};e.btn_nd=this.seekChild("tab_btn_"+t),e.btn_lb_nd=this.seekChild(e.btn_nd,"title"),e.btn_nd.tab_tag=t,e.btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickTabBtn,this)}this.close_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickCloseBtn,this),this.my_guess_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickBtnTitle,this),this.explain_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickExplainBtn,this),this.shop_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickShopBtn,this),this.awards_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickAwardsBtn,this)},registerEvent:function(){this.addGlobalEvent(n.UpdateChampionRoleInfoEvent,function(t){t&&this.updateBaseInfo()}.bind(this)),this.addGlobalEvent(n.ChangeTanFromTop324,function(){}.bind(this))},openRootWnd:function(t){this.updateTab(1),this.updateBaseInfo()},closeCallBack:function(){for(var t in this.tab_panels)this.tab_panels[t]&&(this.tab_panels[t].deleteMe(),this.tab_panels[t]=null);this.ctrl.openArenaChampionMatchWindow(!1)},onClickTabBtn:function(t){t&&t.target&&t.target.tab_tag!==this.cur_tab&&this.updateTab(t.target.tab_tag)},updateTab:function(e){if(e){if(this.cur_tab)this.tab_btn_infos[this.cur_tab].btn_lb_nd.color=(new cc.Color).fromHEX("#D6FBFF");var i=this.tab_btn_infos[e];this.select_img_nd.position=i.btn_nd.position,i.btn_lb_nd.color=(new cc.Color).fromHEX("#593429"),e<=3?(this.my_guess_btn_nd.active=!0,this.guess_btn_title_lb.string=1==e?Utils.TI18N("\u6211\u7684\u5e03\u9635"):Utils.TI18N("\u6211\u7684\u7ade\u731c")):this.my_guess_btn_nd.active=!1;var s=e;if(1===e&&(s=this.getMyMacthPanelIndex()),this.tab_panels[s])this.tab_panels[s].setVisible(!0);else{var n=null;switch(s){case 1:n=t("arena_champion_my_match_ready_panel");break;case 2:n=t("arena_champion_cur_guess_panel");break;case 3:n=t("arena_champion_top_32_panel");break;case 4:n=t("arena_champion_cur_rank_panel");break;case 5:n=t("arena_champion_my_match_panel")}this.tab_panels[s]=new n(this.ctrl),this.tab_panels[s].setParent(this.container_nd),this.tab_panels[s].show()}this.cur_panel&&this.tab_panels[this.cur_panel]&&this.tab_panels[this.cur_panel].setVisible(!1),this.cur_tab=e,this.cur_panel=s,this.updateBaseInfo()}},getMyMacthPanelIndex:function(){var t=this.model.getMyMatchStatus(),e=a.champion_index.my_match_ready;return t===a.champion_my_status.in_match&&(e=a.champion_index.my_match),e},updateBaseInfo:function(){var t=this.base_info=this.model.getBaseInfo();this.role_info=this.model.getRoleInfo();if(t){if(this.cur_panel==a.champion_index.my_match_ready||this.cur_panel==a.champion_index.rank)this.panel_title_nd.active=!1,this.match_time_nd.active=!1;else if(this.panel_title_nd.active=!0,this.setChampionStepInfo(),t.step==a.champion_step.match_4&&t.step_status==a.champion_step_status.over)this.cleanTimer(),this.match_time_nd.active=!1;else{this.match_time_nd.active=!0,this.time_title="",t.step==a.champion_step.unopened&&t.step_status==a.champion_step_status.unopened?this.time_title=Utils.TI18N("\u8ddd\u79bb\u5f00\u59cb:%s"):t.round_status==a.champion_round_status.prepare?this.time_title=Utils.TI18N("\u51c6\u5907\u9636\u6bb5:%s"):t.round_status==a.champion_round_status.guess?this.time_title=Utils.TI18N("\u7ade\u731c\u9636\u6bb5:%s"):this.time_title=Utils.TI18N("\u6bd4\u8d5b\u9636\u6bb5:%s");var e=gcore.SmartSocket.getTime();e=t.step==a.champion_step.unopened?t.step_status_time:t.step==a.champion_step.score&&t.step_status==a.champion_step_status.unopened?t.step_status_time:t.round_status_time,this.less_time=this.init_time=e-gcore.SmartSocket.getTime(),this.less_time<0&&(this.less_time=0),this.startUpdate()}this.updateCurPanelInfo()}},updateCurPanelInfo:function(){1===this.cur_tab&&(this.getMyMacthPanelIndex()!==this.cur_panel&&this.updateTab(this.cur_tab));this.tab_panels[this.cur_panel]&&this.tab_panels[this.cur_panel].updateBaseInfo&&this.tab_panels[this.cur_panel].updateBaseInfo(!0)},cleanTimer:function(){this.update_timer&&(this.stopUpdate(),this.update_timer=null)},update:function(t){var e=Math.ceil(this.less_time-t);if(e<Math.ceil(this.less_time)||this.less_time===this.init_time){var i=o.getTimeFormat(e);this.match_time_lb.string=cc.js.formatStr(this.time_title,i)}this.less_time<0&&this.stopUpdate(),this.less_time-=t},setChampionStepInfo:function(){var t=this.base_info,e=this.role_info,i="";t.step==a.champion_step.unopened?i=cc.js.formatStr(Utils.TI18N("\u4e0b\u6b21\u51a0\u519b\u8d5b %s"),o.getMD2(t.step_status_time)):t.step==a.champion_step.score?t.step_status==a.champion_step_status.unopened?i=cc.js.formatStr(Utils.TI18N("\u4e0b\u6b21\u51a0\u519b\u8d5b %s"),o.getMD2(t.step_status_time)):t.step_status==a.champion_step_status.opened&&(i=cc.js.formatStr(Utils.TI18N("%s\u7b2c%s\u56de\u5408"),a.getMatchStepDesc(t.step),t.round)):t.step==a.champion_step.match_32?t.step_status==a.champion_step_status.unopened?i=Utils.TI18N("\u4e0b\u8f6e32\u5f3a\u8d5b"):t.step_status==a.champion_step_status.opened&&(t.round<=1?i=e.rank>32?Utils.TI18N("16\u5f3a\u8d5b"):cc.js.formatStr(Utils.TI18N("16\u5f3a\u8d5b%s"),a.getGroup(e.group)):2==t.round?i=e.rank>16?Utils.TI18N("8\u5f3a\u8d5b"):cc.js.formatStr(Utils.TI18N("8\u5f3a\u8d5b%s"),a.getGroup(e.group)):3==t.round&&(i=e.rank>8?Utils.TI18N("4\u5f3a\u8d5b"):cc.js.formatStr(Utils.TI18N("4\u5f3a\u8d5b%s"),a.getGroup(e.group)))):t.step==a.champion_step.match_4&&(t.step_status==a.champion_step_status.opened?1==t.round?i=Utils.TI18N("\u534a\u51b3\u8d5b"):2==t.round&&(i=Utils.TI18N("\u51b3\u8d5b")):t.step_status==a.champion_step_status.over&&(i=Utils.TI18N("\u672c\u8f6e\u51a0\u519b\u8d5b\u5df2\u7ed3\u675f"))),this.panel_title_lb.string=i},onClickCloseBtn:function(){3==this.cur_panel&&this.tab_panels[this.cur_panel].isShowVS()?this.tab_panels[this.cur_panel].closeVS():this.ctrl.openArenaChampionMatchWindow(!1)},onClickBtnTitle:function(){1==this.cur_tab?l.getInstance().openFormGoFightPanel(!0,c.Fun_Form.ArenaChampion,null,r.FormShowType.eFormSave):this.ctrl.openArenaChampionMyGuessWindow(!0)},onClickExplainBtn:function(){t("mainui_controller").getInstance().openCommonExplainView(!0,Config.arena_champion_data.data_explain)},onClickShopBtn:function(){_.getInstance().openMallPanel(!0,h.MallType.ArenaShop)},onClickAwardsBtn:function(){this.ctrl.openArenaChampionRankAwardsWindow(!0)}});cc._RF.pop()},{arena_champion_cur_guess_panel:"arena_champion_cur_guess_panel",arena_champion_cur_rank_panel:"arena_champion_cur_rank_panel",arena_champion_my_match_panel:"arena_champion_my_match_panel",arena_champion_my_match_ready_panel:"arena_champion_my_match_ready_panel",arena_champion_top_32_panel:"arena_champion_top_32_panel",arena_const:"arena_const",arena_event:"arena_event",hero_const:"hero_const",hero_controller:"hero_controller",mainui_controller:"mainui_controller",mall_const:"mall_const",mall_controller:"mall_controller",partner_const:"partner_const",pathtool:"pathtool",timetool:"timetool"}],arena_champion_model:[function(t,e,i){"use strict";cc._RF.push(e,"ac988kj0FFC+q6KUtdZxsUo","arena_champion_model");var s=t("arena_event"),n=t("arena_const");cc.Class({extends:BaseClass,ctor:function(){},properties:{},initConfig:function(){this.base_info=null,this.role_info=null},updateChampionBaseInfo:function(t){this.base_info=t,gcore.GlobalEvent.fire(s.UpdateChampionBaseInfoEvent,t)},getBaseInfo:function(){return this.base_info},setRoleInfo:function(t){this.role_info=t,gcore.GlobalEvent.fire(s.UpdateChampionRoleInfoEvent,t)},getRoleInfo:function(t){return this.role_info},getMyMatchStatus:function(){return this.base_info&&this.role_info?this.base_info.step==n.champion_step.unopened?n.champion_my_status.unopened:this.base_info.step==n.champion_step.score&&this.base_info.step_status==n.champion_step_status.unopened?n.champion_my_status.unopened:0===this.role_info.rank?n.champion_my_status.unjoin:n.champion_my_status.in_match:n.champion_my_status.unopened}});cc._RF.pop()},{arena_const:"arena_const",arena_event:"arena_event"}],arena_champion_my_guess_item:[function(t,e,i){"use strict";cc._RF.push(e,"a7805qu2WZOHYBpcZ+Uf6vl","arena_champion_my_guess_item");var s=t("pathtool"),n=t("arena_const"),a=(t("role_head_item"),t("playerhead")),o=t("battle_controller"),l=t("friend_controller"),r=t("arena_controller");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("arena","arena_champion_my_guess_item")},initConfig:function(){},initPanel:function(){this.left_role_nd=this.seekChild("left_role"),this.right_role_nd=this.seekChild("right_role"),this.left_name_lb=this.seekChild("left_name",cc.Label),this.right_name_lb=this.seekChild("right_name",cc.Label),this.success_img_nd=this.seekChild("success_img"),this.match_step_lb=this.seekChild("match_step",cc.Label),this.result_label_lb=this.seekChild("result_label",cc.Label),this.role_name_nd=this.seekChild("role_name"),this.role_name_lb=this.seekChild("role_name",cc.Label),this.assets_img_sp=this.seekChild("assets_img",cc.Sprite),this.assets_value_lb=this.seekChild("assets_value",cc.Label),this.assets_value_nd=this.seekChild("assets_value"),this.assets_container_nd=this.seekChild("assets_container"),this.info_btn_nd=this.seekChild("info_btn"),this.check_fight_btn_nd=this.seekChild("check_fight_btn"),this.match_step_lb=this.seekChild("match_step",cc.Label),this.role_name_y=this.role_name_nd.y,this.assets_y=this.assets_container_nd.y,this.left_success_x=-268,this.right_success_x=-107,this.left_head=new a,this.left_head.setParent(this.left_role_nd),this.left_head.show(),this.right_head=new a,this.right_head.setParent(this.right_role_nd),this.right_head.show(),this.info_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickInfoBtn,this),this.check_fight_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickCheckFightBtn,this),this.left_role_nd.on(cc.Node.EventType.TOUCH_END,this.onClickLeftRole,this),this.right_role_nd.on(cc.Node.EventType.TOUCH_END,this.onClickRightRole,this)},registerEvent:function(){},onShow:function(t){this.data&&this.updateWidgets()},onHide:function(){},onDelete:function(){},setData:function(t){this.data=t,this.root_wnd&&this.updateWidgets()},updateWidgets:function(){if(0==this.data.ret){this.success_img_nd.active=!1,this.info_btn_nd.active=!1,this.check_fight_btn_nd.active=!1,this.role_name_nd.active=!0,this.assets_container_nd.y=this.assets_y,this.result_label_lb.string=Utils.TI18N("\u6295\u6ce8:");var t=Config.color_data.data_color16[175];this.assets_value_nd.color=(new cc.Color).fromHEX(t),this.assets_value_lb.string=this.data.bet,1==this.data.target?this.role_name_lb.string=this.data.a_name:this.role_name_lb.string=this.data.b_name}else{if(this.success_img_nd.active=!0,this.info_btn_nd.active=!0,this.check_fight_btn_nd.active=!0,this.role_name_nd.active=!1,this.assets_container_nd.y=this.role_name_y,this.data.target==this.data.ret){this.result_label_lb.string=Utils.TI18N("\u5f97\u5230:");t=Config.color_data.data_color16[202];this.assets_value_nd.color=(new cc.Color).fromHEX(t),this.assets_value_lb.string=this.data.get_bet}else{this.result_label_lb.string=Utils.TI18N("\u5931\u53bb:");t=Config.color_data.data_color16[183];this.assets_value_nd.color=(new cc.Color).fromHEX(t),this.assets_value_lb.string=this.data.bet}1==this.data.ret?this.success_img_nd.x=this.left_success_x:this.success_img_nd.x=this.right_success_x}var e=s.getItemRes(19);this.loadRes(e,function(t){this.assets_img_sp.spriteFrame=t}.bind(this)),this.left_head.setHeadRes(this.data.a_face),this.right_head.setHeadRes(this.data.b_face),this.left_name_lb.string=this.data.a_name,this.right_name_lb.string=this.data.b_name,this.match_step_lb.string=n.getMatchStepDesc2(this.data.step,this.data.round)},onClickInfoBtn:function(){r.getInstance().openArenaChampionReportWindow(!0,this.data)},onClickCheckFightBtn:function(){this.data&&0!=this.data.replay_id&&o.getInstance().csRecordBattle(this.data.replay_id)},onClickRightRole:function(){l.getInstance().openFriendCheckPanel(!0,{srv_id:this.data.a_srv_id,rid:this.data.a_rid})},onClickLeftRole:function(){l.getInstance().openFriendCheckPanel(!0,{srv_id:this.data.b_srv_id,rid:this.data.b_rid})}});cc._RF.pop()},{arena_const:"arena_const",arena_controller:"arena_controller",battle_controller:"battle_controller",friend_controller:"friend_controller",pathtool:"pathtool",playerhead:"playerhead",role_head_item:"role_head_item"}],arena_champion_my_guess_window:[function(t,e,i){"use strict";cc._RF.push(e,"182488HZWlPEKdQKeg0ziON","arena_champion_my_guess_window");var s=t("pathtool"),n=t("arena_event"),a=t("arena_champion_my_guess_item"),o=t("common_scrollview");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("arena","arena_champion_my_guess_window"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Full,this.ctrl=arguments[0]},initConfig:function(){},openCallBack:function(){this.close_btn_nd=this.seekChild("close_btn"),this.mask_bg_nd=this.seekChild("mask_bg"),this.list_view_nd=this.seekChild("list_view"),this.empty_tips_nd=this.seekChild("empty_tips"),this.mask_bg_nd.scale=FIT_SCALE,this.initGuessList(),this.close_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickCloseBtn,this),this.mask_bg_nd.on(cc.Node.EventType.TOUCH_END,this.onClickCloseBtn,this)},registerEvent:function(){this.addGlobalEvent(n.UpdateMyGuessListEvent,function(t){t&&this.updateWidgets(t)}.bind(this))},openRootWnd:function(t){this.ctrl.sender20255()},closeCallBack:function(){},onClickCloseBtn:function(){this.ctrl.openArenaChampionMyGuessWindow(!1)},initGuessList:function(){var t=this.list_view_nd.getContentSize(),e=cc.size(t.width,t.height),i={item_class:a,start_x:0,space_x:0,start_y:0,space_y:0,item_width:600,item_height:136,row:0,col:1,need_dynamic:!0};this.my_guess_sv=new o,this.my_guess_sv.createScroll(this.list_view_nd,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,e,i,cc.v2(.5,0))},updateWidgets:function(t){(t=t||[]).length>0?this.empty_tips_nd.active=!1:this.empty_tips_nd.active=!0,this.my_guess_sv.setData(t)}});cc._RF.pop()},{arena_champion_my_guess_item:"arena_champion_my_guess_item",arena_event:"arena_event",common_scrollview:"common_scrollview",pathtool:"pathtool"}],arena_champion_my_match_panel:[function(t,e,i){"use strict";cc._RF.push(e,"b7fecFd7nxE7oTXdF/nhDYV","arena_champion_my_match_panel");var s=t("pathtool"),n=t("arena_event"),a=t("arena_const"),o=t("battle_controller"),l=t("partner_const"),r=t("hero_event");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("arena","arena_champion_my_match_panel"),this.ctrl=arguments[0],this.model=this.ctrl.getChamPionModel(),this.vs_panel=null},initConfig:function(){},initPanel:function(){this.container_nd=this.seekChild("container"),this.notice_txt_nd=this.seekChild("notice_txt"),this.notice_txt_lb=this.seekChild("notice_txt",cc.Label)},registerEvent:function(){this.addGlobalEvent(r.Update_Save_Form,function(t){cc.log("UUUUUUUUUUUUUUUUUU"),cc.log(t),t&&t.type==l.Fun_Form.ArenaChampion&&this.ctrl.sender20252()}.bind(this)),this.addGlobalEvent(n.UpdateMyMatchInfoEvent,function(t){this.updateFightInfo(t)}.bind(this))},onShow:function(t){this.updateBaseInfo()},onHide:function(){},onVisible:function(t){t&&(this.is_change_tab=!0)},onDelete:function(){this.vs_panel&&(this.vs_panel.deleteMe(),this.vs_panel=null)},updateFightInfo:function(e){if(e){if(!this.vs_panel){var i=t("arena_champion_vs_panel");this.vs_panel=new i,this.vs_panel.setParent(this.container_nd),this.vs_panel.show()}if(this.root_wnd&&this.root_wnd.active&&!this.is_change_tab){var s=this.model.getBaseInfo();if(s&&2==s.flag&&0!=e.replay_id&&this.cur_data&&!this.cur_data.replay_id)s.step+"_"+s.round==e.step+"_"+e.round&&o.getInstance().csRecordBattle(e.replay_id)}this.vs_panel.updateFightInfo(e),this.cur_data=e,this.is_change_tab=!1}},updateBothSidesBaseInfo:function(){},updateBaseInfo:function(){this.root_wnd&&(this.updateChampionMyStepStatusInfo(),this.ctrl.sender20252())},updateChampionMyStepStatusInfo:function(){var t=this.model.getBaseInfo(),e=this.model.getRoleInfo();if(t&&e){this.notice_txt_nd.active=!0;var i=null;t.step==a.champion_step.match_32&&e.rank>32?i=Utils.TI18N("\u60a8\u672a\u8fdb\u516532\u5f3a"):t.step==a.champion_step.match_32?2==t.round&&e.rank>16?i=Utils.TI18N("\u60a8\u672a\u8fdb\u516516\u5f3a"):3==t.round&&e.rank>8?i=Utils.TI18N("\u60a8\u672a\u8fdb\u51658\u5f3a"):this.notice_txt_nd.active=!1:t.step==a.champion_step.match_4?1==t.round&&e.rank>4?i=Utils.TI18N("\u60a8\u672a\u8fdb4\u5f3a\u8d5b"):2==t.round&&e.rank>2?i=Utils.TI18N("\u60a8\u672a\u8fdb\u5165\u51b3\u8d5b"):this.notice_txt_nd.active=!1:this.notice_txt_nd.active=!1,i&&(this.notice_txt_lb.string=i)}}});cc._RF.pop()},{arena_champion_vs_panel:"arena_champion_vs_panel",arena_const:"arena_const",arena_event:"arena_event",battle_controller:"battle_controller",hero_event:"hero_event",partner_const:"partner_const",pathtool:"pathtool"}],arena_champion_my_match_ready_panel:[function(t,e,i){"use strict";cc._RF.push(e,"55e4biS50VPmLsdjJGqwJZT","arena_champion_my_match_ready_panel");var s=t("pathtool"),n=t("arena_const"),a=t("timetool");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("arena","arena_champion_my_match_ready_panel"),this.ctrl=arguments[0],this.model=this.ctrl.getChamPionModel()},initConfig:function(){var t=Config.arena_champion_data.data_const.battle_members;this.need_rank_index=t?t.val:1024},initPanel:function(){this.notice_txt_lb=this.seekChild("notice_txt",cc.Label),this.des_txt_rt=this.seekChild("des_txt",cc.RichText)},registerEvent:function(){},onShow:function(t){this.updateWidget()},onHide:function(){},onDelete:function(){},updateWidget:function(){var t=this.model.getMyMatchStatus();if(t!=n.champion_my_status.in_match)if(t==n.champion_my_status.unopened)this.notice_txt_lb.string=Utils.TI18N("\u672c\u6b21\u51a0\u519b\u8d5b\u5c1a\u672a\u5f00\u542f"),this.base_info=this.model.getBaseInfo(),this.base_info&&(this.less_time=this.base_info.step_status_time-gcore.SmartSocket.getTime(),this.less_time>0&&this.startUpdate());else if(t==n.champion_my_status.unjoin){this.notice_txt_lb.string=Utils.TI18N("\u60a8\u672a\u80fd\u53c2\u4e0e\u672c\u6b21\u51a0\u519b\u8d5b");var e=Utils.TI18N("\u53ef\u524d\u5f80\u7ade\u731c\u754c\u9762\u53c2\u4e0e\u7ade\u731c\u73a9\u6cd5\uff0c\u5404\u79cd\u7a00\u6709\u9053\u5177\u7b49\u4f60\u6765\u5151\u6362");this.des_txt_rt.string=e}},update:function(t){var e=Math.ceil(this.less_time-t);if(e<Math.ceil(this.less_time)||this.less_time===this.base_info.step_status_time-gcore.SmartSocket.getTime()){var i=a.getTimeFormat(Math.ceil(this.less_time)),s=cc.js.formatStr("\u5f00\u542f\u5012\u8ba1\u65f6:<color=#66e734>%s</color>\n\u6392\u4f4d\u8d5b\u540d\u524d<color=#66e734>%s\u540d</color>\u7684\u73a9\u5bb6\u5c06\u81ea\u52a8\u53c2\u4e0e",i,this.need_rank_index);this.des_txt_rt.string=Utils.TI18N(s),this.less_time=e}this.less_time-=t,this.less_time<0&&this.stopUpdate()},updateBaseInfo:function(){}});cc._RF.pop()},{arena_const:"arena_const",pathtool:"pathtool",timetool:"timetool"}],arena_champion_rank_awards_item:[function(t,e,i){"use strict";cc._RF.push(e,"69ceeF615RJXq8fTn5MsSkq","arena_champion_rank_awards_item");var s=t("pathtool");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("arena","arena_champion_rank_awards_item")},initConfig:function(){},initPanel:function(){this.rank_img_nd=this.seekChild("rank_img"),this.rank_img_sp=this.seekChild("rank_img",cc.Sprite),this.rank_txt_nd=this.seekChild("rank_txt"),this.rank_txt_lb=this.seekChild("rank_txt",cc.Label),this.role_rank_lb=this.seekChild("role_rank",cc.Label),this.list_items={};for(var t=0;t<3;t++){var e=this.seekChild("item_nd_"+t);this.list_items[t]=ItemsPool.getInstance().getItem("backpack_item"),this.list_items[t].setParent(e),this.list_items[t].setExtendData({scale:.8,is_show_tips:!0}),this.list_items[t].show(),this.list_items[t].setVisible(!1)}},registerEvent:function(){},onShow:function(t){this.updateWidgets()},onHide:function(){},onDelete:function(){if(this.list_items){for(var t in this.list_items)this.list_items[t]&&(this.list_items[t].deleteMe(),this.list_items[t]=null);this.list_items=null}},setData:function(t){this.reward_data=t,this.root_wnd&&this.updateWidgets()},updateWidgets:function(){for(var t in this.list_items)this.list_items[t].setVisible(!1);if(this.reward_data.min==this.reward_data.max&&this.reward_data.max>0&&this.reward_data.max<=3){this.rank_img_nd.active=!0,this.rank_txt_nd.active=!1;var e=s.getUIIconPath("common","common_200"+this.reward_data.max);this.loadRes(e,function(t){this.rank_img_sp.spriteFrame=t}.bind(this))}else this.reward_data.min>3&&(this.rank_img_nd.active=!1,this.rank_txt_nd.active=!0,this.reward_data.min==this.reward_data.max?this.rank_txt_lb.string=this.reward_data.min:this.rank_txt_lb.string=this.reward_data.min+"~"+this.reward_data.max);var i=this.reward_data.items.length;for(var t in this.reward_data.items){var n={};n.bid=this.reward_data.items[i-1-t][0],n.num=this.reward_data.items[i-1-t][1],this.list_items[t].setData(n),this.list_items[t].setVisible(!0)}}});cc._RF.pop()},{pathtool:"pathtool"}],arena_champion_rank_awards_window:[function(t,e,i){"use strict";cc._RF.push(e,"0e967HJuDBIq66DUJX10wCu","arena_champion_rank_awards_window");var s=t("pathtool"),n=t("arena_champion_rank_awards_item"),a=t("common_scrollview");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("arena","arena_champion_rank_awards_window"),this.ctrl=arguments[0],this.model=this.ctrl.getModel(),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Big},initConfig:function(){this.awards_list=Config.arena_data.data_awards},openCallBack:function(){this.list_view_nd=this.seekChild("list_view"),this.mask_bg_nd=this.seekChild("mask_bg"),this.close_btn_nd=this.seekChild("close_btn"),this.mask_bg_nd.scale=FIT_SCALE,this.initAwardsList(),this.mask_bg_nd.on(cc.Node.EventType.TOUCH_END,this.onClickCloseBtn,this),this.close_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickCloseBtn,this)},registerEvent:function(){},openRootWnd:function(t){this.updateAwardsList()},closeCallBack:function(){this.awards_sv&&this.awards_sv.deleteMe(),this.ctrl.openArenaChampionRankAwardsWindow(!1)},updateWidgets:function(){},initAwardsList:function(){var t=this.list_view_nd.getContentSize(),e=cc.size(t.width,t.height),i={item_class:n,start_x:0,space_x:0,start_y:0,space_y:0,item_width:614,item_height:143,row:0,col:1,need_dynamic:!0};this.awards_sv=new a,this.awards_sv.createScroll(this.list_view_nd,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,e,i,cc.v2(.5,0))},updateAwardsList:function(){var t=Utils.deepCopy(Config.arena_champion_data.data_awards);for(var e in t)t[e].index=e;this.awards_sv.setData(t)},onClickCloseBtn:function(){this.ctrl.openArenaChampionRankAwardsWindow(!1)}});cc._RF.pop()},{arena_champion_rank_awards_item:"arena_champion_rank_awards_item",common_scrollview:"common_scrollview",pathtool:"pathtool"}],arena_champion_rank_item:[function(t,e,i){"use strict";cc._RF.push(e,"e8181qD3EdJF7cxrTgE7uYO","arena_champion_rank_item");var s=t("pathtool"),n=t("role_controller");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("arena","arena_champion_rank_item")},initConfig:function(){},initPanel:function(){this.rank_img_nd=this.seekChild("rank_img"),this.rank_img_sp=this.rank_img_nd.getComponent(cc.Sprite),this.rank_txt_nd=this.seekChild("rank_txt"),this.rank_txt_rt=this.rank_txt_nd.getComponent("CusRichText"),this.role_name_lb=this.seekChild("role_name",cc.Label),this.role_power_lb=this.seekChild("role_power",cc.Label),this.worship_num_lb=this.seekChild("num",cc.Label),this.head_con_nd=this.seekChild("head_con"),this.score_num_lb=this.seekChild("score_num",cc.Label),this.finger_img_sp=this.seekChild("finger_img",cc.Sprite),this.wish_container_nd=this.seekChild("wish_container"),this.wish_container_btn=this.seekChild("wish_container",cc.Button),this.wish_container_sp=this.seekChild("wish_container",cc.Sprite);var e=t("playerhead");this.role_head=new e,this.role_head.setParent(this.head_con_nd),this.role_head.show(),this.wish_container_nd.on(cc.Node.EventType.TOUCH_END,this.onClickWorshipBtn,this)},registerEvent:function(){},onShow:function(t){this.updateWidgets()},onHide:function(){},onDelete:function(){},setData:function(t){this.rank_data=t,this.root_wnd&&this.updateWidgets()},updateWidgets:function(){if(this.rank_data){var t=this.rank_data;if(t.rank<=3){this.rank_img_nd.active=!0,this.rank_txt_nd.active=!1;var e=s.getUIIconPath("common",cc.js.formatStr("common_300%s",t.rank));this.loadRes(e,function(t){this.rank_img_sp.spriteFrame=t}.bind(this))}else this.rank_img_nd.active=!1,this.rank_txt_nd.active=!0,this.rank_txt_rt.setNum(t.rank);this.role_name_lb.string=t.name,this.role_power_lb.string=t.power,this.worship_num_lb.string=t.worship,this.score_num_lb.string=t.score,this.role_head.setHeadRes(t.face),this.role_head.setLev(t.lev),this.rank_data.worship_status?(this.wish_container_sp.setMaterial(0,cc.Material.getBuiltinMaterial("2d-gray-sprite")),this.wish_container_btn.interactable=!1,this.finger_img_sp.setMaterial(0,cc.Material.getBuiltinMaterial("2d-gray-sprite"))):(this.wish_container_btn.interactable=!0,this.wish_container_sp.setMaterial(0,cc.Material.getBuiltinMaterial("2d-sprite")),this.finger_img_sp.setMaterial(0,cc.Material.getBuiltinMaterial("2d-sprite")))}},onClickWorshipBtn:function(){n.getInstance().sender10316(this.rank_data.rid,this.rank_data.srv_id,this.rank_data.rank)}});cc._RF.pop()},{pathtool:"pathtool",playerhead:"playerhead",role_controller:"role_controller"}],arena_champion_rank_window:[function(t,e,i){"use strict";cc._RF.push(e,"a5c34mw1ElERY3dxs401Q+m","arena_champion_rank_window");var s=t("pathtool"),n=t("arena_event"),a=t("role_event"),o=t("common_scrollview"),l=t("arena_champion_rank_item");a=t("role_event"),cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("arena","arena_champion_rank_window"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Full,this.ctrl=arguments[0],this.model=this.ctrl.getChamPionModel()},initConfig:function(){var e=t("role_controller");this.role_vo=e.getInstance().getRoleVo()},openCallBack:function(){this.items_container_nd=this.seekChild("items_container"),this.empty_tips_nd=this.seekChild("empty_tips"),this.rank_img_nd=this.seekChild("rank_img"),this.rank_img_sp=this.rank_img_nd.getComponent(cc.Sprite),this.rank_txt_nd=this.seekChild("rank_txt"),this.rank_txt_rt=this.rank_txt_nd.getComponent("CusRichText"),this.role_name_lb=this.seekChild("role_name",cc.Label),this.role_power_lb=this.seekChild("role_power",cc.Label),this.worship_num_lb=this.seekChild("num",cc.Label),this.head_con_nd=this.seekChild("head_con"),this.close_btn_nd=this.seekChild("close_btn"),this.mask_bg_nd=this.seekChild("mask_bg"),this.mask_bg_nd.scale=FIT_SCALE;var e=t("playerhead");this.role_head=new e,this.role_head.setParent(this.head_con_nd),this.role_head.show(),this.initRankList(),this.close_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickCloseBtn,this),this.mask_bg_nd.on(cc.Node.EventType.TOUCH_END,this.onClickCloseBtn,this)},registerEvent:function(){this.addGlobalEvent(n.UpdateChampionRankEvent,function(t){t&&this.updateRankList(t)}.bind(this)),this.addGlobalEvent(a.WorshipOtherRole,function(t){t&&this.updateOtherWorship(t)}.bind(this))},openRootWnd:function(t){this.ctrl.sender20281()},closeCallBack:function(){this.activity_sv&&this.activity_sv.deleteMe(),this.activity_sv=null},initRankList:function(){var t=this.items_container_nd.getContentSize(),e=cc.size(t.width,t.height),i={item_class:l,start_x:0,space_x:0,start_y:0,space_y:0,item_width:630,item_height:140,row:0,col:1,need_dynamic:!0};this.activity_sv=new o,this.activity_sv.createScroll(this.items_container_nd,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,e,i,cc.v2(.5,.5))},updateRankList:function(t){var e=this.rank_list=t.rank_list;this.activity_sv.setData(e),0===e.length?this.empty_tips_nd.active=!0:this.empty_tips_nd.active=!1,this.updateMyInfo(t)},updateMyInfo:function(t){if(t){if(t.rank<=3&&t.rank>0){this.rank_img_nd.active=!0,this.rank_txt_nd.active=!1;var e=s.getUIIconPath("common",cc.js.formatStr("common_300%s",t.rank));this.loadRes(e,function(t){this.rank_img_sp.spriteFrame=t}.bind(this))}else 0===t.rank?(this.rank_img_nd.active=!1,this.rank_txt_nd.active=!1):(this.rank_img_nd.active=!1,this.rank_txt_nd.active=!0,this.rank_txt_rt.setNum(t.rank));this.role_name_lb.string=this.role_vo.name,this.role_power_lb.string=this.role_vo.power,this.worship_num_lb.string=t.worship,this.role_head.setHeadRes(this.role_vo.face_id),this.role_head.setLev(this.role_vo.lev)}},updateOtherWorship:function(t){var e=t.idx-1,i=this.rank_list[e];i.worship+=1,i.worship_status=1,this.activity_sv.updateItemData(e,i)},onClickCloseBtn:function(){this.ctrl.openArenaChampionRankWindow(!1)}});cc._RF.pop()},{arena_champion_rank_item:"arena_champion_rank_item",arena_event:"arena_event",common_scrollview:"common_scrollview",pathtool:"pathtool",playerhead:"playerhead",role_controller:"role_controller",role_event:"role_event"}],arena_champion_report_item:[function(t,e,i){"use strict";cc._RF.push(e,"dd5cf1eTI9Psqq2GzRvu4pN","arena_champion_report_item");var s=t("pathtool");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("arena","arena_champion_report_item")},initConfig:function(){},initPanel:function(){this.desc_1_lb=this.seekChild("desc_1",cc.Label),this.desc_2_lb=this.seekChild("desc_2",cc.Label),this.desc_3_lb=this.seekChild("desc_3",cc.Label),this.progress_1_pb=this.seekChild("progress_1",cc.ProgressBar),this.progress_2_pb=this.seekChild("progress_2",cc.ProgressBar),this.progress_3_pb=this.seekChild("progress_3",cc.ProgressBar),this.role_con_nd=this.seekChild("role_con");var t=this.hero_item=ItemsPool.getInstance().getItem("hero_exhibition_item");t.setParent(this.role_con_nd),t.setExtendData({scale:.8}),t.show()},registerEvent:function(){},onShow:function(t){this.data&&this.updateWidgets()},onHide:function(){},onDelete:function(){},setData:function(t){this.data=t,this.root_wnd&&this.updateWidgets()},setExtendData:function(t){this.total_hurt=t.total_hurt,this.total_behurt=t.total_behurt,this.total_curt=t.total_curt},updateWidgets:function(){var t=this.data;this.desc_1_lb.string=t.hurt,this.desc_2_lb.string=t.behurt,this.desc_3_lb.string=t.curt,0==this.total_hurt?this.progress_1_pb.progress=0:this.progress_1_pb.progress=t.hurt/this.total_hurt,0==this.total_behurt?this.progress_2_pb.progress=0:this.progress_2_pb.progress=t.behurt/this.total_behurt,0==this.total_curt?this.progress_3_pb.progress=0:this.progress_3_pb.progress=t.curt/this.total_curt,this.hero_item.setData(t)}});cc._RF.pop()},{pathtool:"pathtool"}],arena_champion_report_window:[function(t,e,i){"use strict";cc._RF.push(e,"d8dc48kPMVIEZdTRkfYjvAa","arena_champion_report_window");var s=t("pathtool"),n=t("arena_champion_report_item"),a=t("common_scrollview");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("arena","arena_champion_report_window"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Full,this.ctrl=arguments[0]},initConfig:function(){},openCallBack:function(){this.close_btn_nd=this.seekChild("close_btn"),this.mask_bg_nd=this.seekChild("mask_bg"),this.check_btn_nd=this.seekChild("check_btn"),this.mask_bg_nd.scale=FIT_SCALE,this.top_name_lb=this.seekChild("top_name",cc.Label),this.bottom_name_lb=this.seekChild("bottom_name",cc.Label),this.bottom_name_nd=this.seekChild("bottom_name"),this.success_img_nd=this.seekChild("success_img"),this.top_list_view_nd=this.seekChild("top_list_view"),this.bottom_list_view_nd=this.seekChild("bottom_list_view"),this.top_success_img_y=this.success_img_nd.y,this.bottom_success_img_y=this.bottom_name_nd.y,this.close_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickCloseBtn,this),this.mask_bg_nd.on(cc.Node.EventType.TOUCH_END,this.onClickCloseBtn,this),this.check_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickCheckBtn,this)},registerEvent:function(){},openRootWnd:function(t){this.data=t,this.updateWidgets()},closeCallBack:function(){this.ctrl.openArenaChampionReportWindow(!1)},onClickCloseBtn:function(){Utils.playButtonSound(2),this.ctrl.openArenaChampionReportWindow(!1)},updateWidgets:function(){cc.log("DDDDDDDDDDDDDDD"),cc.log(this.data),this.data&&(this.setBaseInfo(),this.setTopInfo(),this.setBottomInfo())},setBaseInfo:function(){this.success_img_nd.active=0!=this.data.ret,1==this.data.ret?this.success_img_nd.y=this.top_success_img_y:2==this.data.ret&&(this.success_img_nd.y=this.bottom_success_img_y),this.top_name_lb.string=this.data.a_name,this.bottom_name_lb.string=this.data.b_name},setTopInfo:function(){var t=0,e=0,i=0;for(var s in this.data.a_plist){var o=this.data.a_plist[s];t+=o.hurt,e+=o.behurt,i+=o.curt}var l=this.top_list_view_nd.getContentSize(),r=cc.size(l.width,l.height),c={item_class:n,start_x:0,space_x:0,start_y:0,space_y:0,item_width:122,item_height:278,row:1,col:1,need_dynamic:!1};this.topinfo_sv=new a,this.topinfo_sv.createScroll(this.top_list_view_nd,cc.v2(0,0),ScrollViewDir.horizontal,ScrollViewStartPos.top,r,c,cc.v2(.5,1)),this.topinfo_sv.setData(this.data.a_plist,null,{total_hurt:t,total_behurt:e,total_curt:i})},setBottomInfo:function(){var t=0,e=0,i=0;for(var s in this.data.b_plist){var o=this.data.b_plist[s];t+=o.hurt,e+=o.behurt,i+=o.curt}var l=this.bottom_list_view_nd.getContentSize(),r=cc.size(l.width,l.height),c={item_class:n,start_x:0,space_x:0,start_y:0,space_y:0,item_width:122,item_height:278,row:1,col:1,need_dynamic:!1};this.bottominfo_sv=new a,this.bottominfo_sv.createScroll(this.bottom_list_view_nd,cc.v2(0,0),ScrollViewDir.horizontal,ScrollViewStartPos.top,r,c,cc.v2(.5,1)),this.bottominfo_sv.setData(this.data.b_plist,null,{total_hurt:t,total_behurt:e,total_curt:i})},onClickCheckBtn:function(){(Utils.playButtonSound(1),this.data&&0!=this.data.replay_id)&&t("battle_controller").getInstance().csRecordBattle(this.data.replay_id)}});cc._RF.pop()},{arena_champion_report_item:"arena_champion_report_item",battle_controller:"battle_controller",common_scrollview:"common_scrollview",pathtool:"pathtool"}],arena_champion_top_32_1_panel:[function(t,e,i){"use strict";cc._RF.push(e,"8a45c6fsZRMipMZYWey4Pe5","arena_champion_top_32_1_panel");var s=t("pathtool"),n=t("arena_event"),a=t("arena_const");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("arena","arena_champion_top_32_1_panel"),this.ctrl=arguments[0],this.model=this.ctrl.getChamPionModel()},initConfig:function(){this.cur_page=0,this.role_list=null,this.page_infos={}},initPanel:function(){this.page_item_nd=this.seekChild("page_item"),this.page_content_nd=this.seekChild("page_content"),this.pageview_nd=this.seekChild("pageview"),this.pageview_pg=this.seekChild("pageview",cc.PageView),this.left_btn=this.seekChild("left_btn",cc.Button),this.right_btn=this.seekChild("right_btn",cc.Button);var t=this.pagte_item_nds=[];t[0]=this.page_item_nd;for(var e=1;e<4;e++){t[e]=cc.instantiate(this.page_item_nd),this.seekChild("page_item_conten_"+e).addChild(t[e])}this.pageview_nd.on("page-turning",this.onPageChanged,this),this.notice_label=(new cc.Node).addComponent(cc.Label),this.root_wnd.addChild(this.notice_label.node),this.notice_label.fontSize=22,this.notice_label.horizontalAlign=cc.macro.TextAlignment.CENTER,this.notice_label.verticalAlign=cc.macro.TextAlignment.CENTER,this.notice_label.lineHeight=24,this.notice_label.node.color=new cc.Color(255,141,85),this.notice_label.node.setAnchorPoint(cc.v2(.5,0)),this.notice_label.node.setPosition(0,this.root_wnd.height/2),this.addTurnCallBack()},onPageChanged:function(t){this.cur_page=t.getCurrentPageIndex(),this.updatePageInfo(),this.addTurnCallBack()},registerEvent:function(){this.addGlobalEvent(n.UpdateTop32InfoEvent,function(t){t&&this.updateTop32InfoList(t)}.bind(this)),this.addGlobalEvent(n.UpdateTop324GuessGroupEvent,function(t,e){if(this.group=t,this.pos=e,t&&e)this.updateGuessStatus();else for(var i in this.page_infos)this.page_infos[i].guess_btn_nd.active=!1}.bind(this)),this.left_btn.node.on("click",function(){this.pageview_pg.scrollToPage(this.cur_page-1)},this),this.right_btn.node.on("click",function(){this.pageview_pg.scrollToPage(this.cur_page+1)},this)},onShow:function(t){this.updateWidgets()},onHide:function(){},onDelete:function(){},updateBaseInfo:function(){this.root_wnd&&this.updateWidgets()},updateWidgets:function(){var t=this.base_info=this.model.getBaseInfo(),e=this.role_info=this.model.getRoleInfo();t&&e&&this.ctrl.sender20260()},updateTop32InfoList:function(t){t&&t.list&&(this.data=t,this.goup_list=t.list,this.root_wnd&&this.updatePageInfo()),this.ctrl.sender20262()},updatePageInfo:function(){var t=this.page_infos[this.cur_page];if(!t){(t=this.page_infos[this.cur_page]={}).role_name_list={},t.role_pos_list={},t.pos_line_list={},t.pos_line_list_2={},t.check_bnt_list={};var e=this.pagte_item_nds[this.cur_page];t.guess_btn_nd=this.seekChild(e,"guess_btn"),t.guess_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickGuessBtn,this),t.guess_btn_nd.active=!1;for(var i=1;i<=14;i++){(p=t.role_name_list[i]={}).name_nd=this.seekChild(e,"role_name_"+i),p.name_lb=p.name_nd.getComponent(cc.Label),p.name_lb.string="";var s=t.role_pos_list[i]={},n=this.seekChild(e,"role_pos_"+i);s.normal=n.getChildByName("normal"),s.normal_sp=s.normal.getComponent(cc.Sprite),s.select=n.getChildByName("select"),s.select.active=!1}for(var o=1;o<=12;o++){var l=t.pos_line_list[o]={},r=this.seekChild(e,"pos_line_"+o);l.normal_1=r.getChildByName("normal_1"),l.normal_2=r.getChildByName("normal_2"),l.select_1=r.getChildByName("select_1"),l.select_2=r.getChildByName("select_2"),l.select_1.active=!1,l.select_2.active=!1,l.normal_1.active=!0,l.normal_2.active=!0}for(o=1;o<=7;o++){var c=2*(o-1)+1,_=2*o,h=t.pos_line_list_2[c+"_"+_]={},d=this.seekChild(e,"pos_line_"+c+"_"+_);h.normal=d.getChildByName("normal"),h.select=d.getChildByName("select"),h.select.active=!1,h.normal.active=!0;var u=this.seekChild(e,"check_btn_"+c);t.check_bnt_list[c]=u,u.index_1=c,u.active=!1,u.on(cc.Node.EventType.TOUCH_END,this.onClickCheckBtn,this)}}var m=this.role_list=this.goup_list[this.cur_page].pos_list;for(var i in this.notice_label.string=a.getGroup(this.goup_list[this.cur_page].group),m){var f=m[i];if(t.role_name_list[f.pos]){var p=t.role_name_list[f.pos];l=t.pos_line_list[f.pos],s=t.role_pos_list[f.pos];p.name_lb.string=f.name;var g=null,v=null,b=!1,w=!1;0===f.ret?(g=(new cc.Color).fromHEX("#68452a"),v=cc.Material.getBuiltinMaterial("2d-sprite")):1===f.ret?(g=(new cc.Color).fromHEX("#68452a"),v=cc.Material.getBuiltinMaterial("2d-sprite"),b=!0,w=!0):(g=new cc.Color(91,91,91,255),v=cc.Material.getBuiltinMaterial("2d-gray-sprite")),p.name_nd.color=g,s.normal_sp.setMaterial(0,v),s.select.active=b,l&&l.select_1&&(l.select_1.active=w),l&&l.select_2&&(l.select_2.active=w);var y=0,C=0;if(f.pos%2==0)C=(y=f.pos-1)+"_"+f.pos;else C=(y=f.pos)+"_"+f.pos+1;var k=!1;0!==f.ret&&(k=!0),t.pos_line_list_2[C]&&(t.pos_line_list_2[C].select.active=k),t.check_bnt_list[y].active=k}}this.group&&this.pos&&this.updateGuessStatus()},onClickCheckBtn:function(t){t.target.index_1&&gcore.GlobalEvent.fire(n.CheckFightInfoEvent,!0,this.role_list.group,t.target.index_1)},updateGuessStatus:function(){var t=this.group,e=this.pos;if(t&&e&&this.page_infos[t-1]){var i=this.page_infos[t-1],s=i.check_bnt_list[e];i.guess_btn_nd.active=!0,i.guess_btn_nd.position=s.position}},onClickGuessBtn:function(){this.ctrl.updateChampionTab(2)},addTurnCallBack:function(){0==this.cur_page?(this.left_btn.interactable=!1,this.left_btn.enableAutoGrayEffect=!0,this.right_btn.interactable=!0,this.right_btn.enableAutoGrayEffect=!1):3==this.cur_page?(this.left_btn.interactable=!0,this.left_btn.enableAutoGrayEffect=!1,this.right_btn.interactable=!1,this.right_btn.enableAutoGrayEffect=!0):(this.left_btn.interactable=!0,this.left_btn.enableAutoGrayEffect=!1,this.right_btn.interactable=!0,this.right_btn.enableAutoGrayEffect=!1)}});cc._RF.pop()},{arena_const:"arena_const",arena_event:"arena_event",pathtool:"pathtool"}],arena_champion_top_32_2_panel:[function(t,e,s){"use strict";cc._RF.push(e,"ca170QCzaFJqqIIrR3aONJQ","arena_champion_top_32_2_panel");var n=t("pathtool"),a=t("arena_event"),o=t("playerhead");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=n.getPrefabPath("arena","arena_champion_top_32_2_panel"),this.ctrl=arguments[0],this.model=this.ctrl.getChamPionModel()},initConfig:function(){},initPanel:function(){this.container_nd=this.seekChild("container"),this.guess_btn_nd=this.seekChild("guess_btn"),this.head_container_nd=this.seekChild("head_container"),this.guess_btn_nd.active=!1;var t=this.champion_head=new o;t.setPosition(0,0),t.setParent(this.head_container_nd),t.show(),this.pos_line_list={},this.pos_line_list_2={},this.role_pos_list={},this.role_name_list={},this.check_bnt_list={};for(var e=1;e<=6;e++){var s=this.pos_line_list[e]={},n=this.seekChild(this.container_nd,"pos_line_"+e);s.normal_1=n.getChildByName("normal_1"),s.normal_2=n.getChildByName("normal_2"),s.select_1=n.getChildByName("select_1"),s.select_2=n.getChildByName("select_2"),s.select_1&&(s.select_1.active=!1),s.select_2&&(s.select_2.active=!1);var a=this.role_pos_list[e]={},l=this.seekChild(this.container_nd,"role_pos_"+e);a.normal=l.getChildByName("normal"),a.normal_sp=a.normal.getComponent(cc.Sprite),a.select=l.getChildByName("select"),a.select.active=!1;var r=this.role_name_list[e]={};r.name_nd=this.seekChild(this.container_nd,"role_name_"+e),r.name_lb=r.name_nd.getComponent(cc.Label),r.name_lb.string="",e%2==1&&(this.check_bnt_list[e]=this.seekChild(this.container_nd,"check_btn_"+e),this.check_bnt_list[e].index=e,this.check_bnt_list[e].active=!1,this.check_bnt_list[e].on(cc.Node.EventType.TOUCH_END,this.onClickCheckBtn,this))}for(;e<=2;e++){var c=2*(i-1)+1,_=2*i;s=this.pos_line_list_2[c+"_"+_]={},n=this.seekChild(this.container_nd,"pos_line_"+c+"_"+index_2s);s.normal=n.getChildByName("normal"),s.select=n.getChildByName("select")}this.guess_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickGuessBtn,this)},registerEvent:function(){this.addGlobalEvent(a.UpdateTop4InfoEvent,function(t){t&&this.updateTop4Info(t)}.bind(this)),this.addGlobalEvent(a.UpdateTop324GuessGroupEvent,function(t,e){!t&&e?this.updateGuessStatus(e):this.guess_btn_nd.active=!1}.bind(this))},onShow:function(t){this.updateWidgets()},onHide:function(){},onDelete:function(){},updateBaseInfo:function(){this.root_wnd&&this.updateWidgets()},updateWidgets:function(){var t=this.base_info=this.model.getBaseInfo(),e=this.role_info=this.model.getRoleInfo();t&&e&&this.ctrl.sender20261()},updateTop4Info:function(t){var e=t.pos_list;if(e){for(var i in e){var s=e[i];if(this.role_name_list[s.pos]){var n=this.role_name_list[s.pos],a=this.pos_line_list[s.pos],o=this.role_pos_list[s.pos];n.name_lb.string=s.name;var l=null,r=null,c=!1,_=!1;0===s.ret?(l=(new cc.Color).fromHEX("#68452a"),r=cc.Material.getBuiltinMaterial("2d-sprite")):1===s.ret?(l=(new cc.Color).fromHEX("#68452a"),r=cc.Material.getBuiltinMaterial("2d-sprite"),c=!0,_=!0):(l=new cc.Color(91,91,91,255),r=cc.Material.getBuiltinMaterial("2d-gray-sprite")),n.name_nd.color=l,o.normal_sp.setMaterial(0,r),o.select.active=c,a.select_1&&(a.select_1.active=_),a.select_2&&(a.select_2.active=_);var h=0,d=0;if(s.pos%2==0)d=(h=s.pos-1)+"_"+s.pos;else d=(h=s.pos)+"_"+s.pos+1;var u=!1;0!==s.ret&&(u=!0),this.pos_line_list_2[d]&&(this.pos_line_list_2[d].select.active=u),this.check_bnt_list[h].active=u}}7==e.length?this.champion_head.setHeadRes(e[0].face):this.champion_head.clearHead(),this.ctrl.sender20262()}},onClickCheckBtn:function(t){gcore.GlobalEvent.fire(a.CheckFightInfoEvent,!0,null,t.target.index)},updateGuessStatus:function(t){var e=this.check_bnt_list[t];e&&(this.guess_btn_nd.active=!0,this.guess_btn_nd.position=e.position)},onClickGuessBtn:function(){this.ctrl.updateChampionTab(2)}});cc._RF.pop()},{arena_event:"arena_event",pathtool:"pathtool",playerhead:"playerhead"}],arena_champion_top_32_panel:[function(t,e,i){"use strict";cc._RF.push(e,"d9d98xBYjhClaSnVb1w/zp0","arena_champion_top_32_panel");var s=t("pathtool"),n=t("arena_const"),a=t("arena_event"),o=1,l=2;cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("arena","arena_champion_top_32_panel"),this.ctrl=arguments[0],this.model=this.ctrl.getChamPionModel()},initConfig:function(){this.panle_tabs={},this.cur_panel=null},initPanel:function(){this.container_nd=this.seekChild("container"),this.panel_conatiner_nd=this.seekChild("page_container"),this.vs_container_nd=this.seekChild("vs_container"),this.btn_infos={};for(var e=1;e<=2;e++){var i=this.btn_infos[e]={},s=this.seekChild("tab_btn_"+e);s.tab_tag=e,i.btn_sp=s.getComponent(cc.Sprite),i.txt_nd=this.seekChild(s,"title"),s.on(cc.Node.EventType.TOUCH_END,this.onClickTabBtn,this)}var n=t("arena_champion_top_32_1_panel");this.panle_tabs[o]=new n(this.ctrl),this.panle_tabs[o].setParent(this.panel_conatiner_nd),this.panle_tabs[o].show(),this.panle_tabs[o].setVisible(!1);var a=t("arena_champion_top_32_2_panel");this.panle_tabs[l]=new a(this.ctrl),this.panle_tabs[l].setParent(this.panel_conatiner_nd),this.panle_tabs[l].show(),this.panle_tabs[l].setVisible(!1),this.updateTab(o)},registerEvent:function(){this.addGlobalEvent(a.CheckFightInfoEvent,function(t,e,i){this.changeToFightinfo(t,e,i)}.bind(this)),this.addGlobalEvent(a.UpdateTop324GroupPosEvent,function(t){this.updateFightInfo(t)}.bind(this))},onShow:function(t){this.updateWidget()},onHide:function(){},onDelete:function(){for(var t in this.panle_tabs)this.panle_tabs[t].deleteMe(),this.panle_tabs[t]=null;this.vs_panel&&this.vs_panel.deleteMe()},updateBaseInfo:function(){if(this.root_wnd)for(var t in this.updateWidget(),this.panle_tabs)this.panle_tabs[t]&&this.panle_tabs[t].updateBaseInfo()},updateWidget:function(){var t=this.base_info=this.model.getBaseInfo(),e=this.role_info=this.model.getRoleInfo();t&&e&&(t.step==n.champion_step.unopened||t.step==n.champion_step.score||t.step==n.champion_step.match_32&&t.step_status==n.champion_step_status.unopened?this.root_wnd.active=!1:this.root_wnd.active=!0)},updateTab:function(t){if(!this.cur_panel||this.cur_panel!==t){var e=1;1==t&&(e=2);var i=this.btn_infos[t];this.loadRes(s.getUIIconPath("arenachampion","arenachampion_1022"),function(t){i.btn_sp.spriteFrame=t}.bind(this)),i.txt_nd.color=new cc.Color(255,255,255,255);var n=this.btn_infos[e];this.loadRes(s.getUIIconPath("arenachampion","arenachampion_1023"),function(t){n.btn_sp.spriteFrame=t}.bind(this)),n.txt_nd.color=new cc.Color(254,209,156,255),this.panle_tabs[t].setVisible(!0),this.cur_panel&&this.panle_tabs[this.cur_panel].setVisible(!1),this.cur_panel=t}},onClickTabBtn:function(t){this.cur_panel&&this.cur_panel===t.target.tab_tag||this.updateTab(t.target.tab_tag)},changeToFightinfo:function(t,e,i){t&&this.ctrl.sender20263(e,i)},updateFightInfo:function(e){if(this.container_nd.active=!1,this.vs_panel)this.vs_panel.setVisible(!0);else{var i=t("arena_champion_vs_panel");this.vs_panel=new i,this.vs_panel.setParent(this.vs_container_nd),this.vs_panel.show()}this.vs_panel.updateFightInfo(e)},isShowVS:function(){if(this.vs_panel&&!this.container_nd.active)return!0},closeVS:function(){this.container_nd.active=!0,this.vs_panel.setVisible(!1)}});cc._RF.pop()},{arena_champion_top_32_1_panel:"arena_champion_top_32_1_panel",arena_champion_top_32_2_panel:"arena_champion_top_32_2_panel",arena_champion_vs_panel:"arena_champion_vs_panel",arena_const:"arena_const",arena_event:"arena_event",pathtool:"pathtool"}],arena_champion_vs_panel:[function(t,e,i){"use strict";cc._RF.push(e,"69d72NkSjtMDoyFzoUMsBbZ","arena_champion_vs_panel");var s=t("pathtool"),n=t("playerhead"),a=t("battle_controller");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("arena","arena_champion_vs_panel")},initConfig:function(){},initPanel:function(){this.check_btn_nd=this.seekChild("check_btn"),this.look_btn_nd=this.seekChild("look_btn"),this.vs_img_nd=this.seekChild("vs_img"),this.fight_forms={};for(var t=1;t<=2;t++){var e=this.fight_forms[t]={},i=this.seekChild("role_container_"+t);e.role_name_lb=this.seekChild(i,"role_name",cc.Label),e.role_lev_lb=this.seekChild(i,"role_lev",cc.Label),e.form_icon_sp=this.seekChild(i,"form_icon",cc.Sprite),e.success_img_nd=this.seekChild(i,"success_img");var s=this.seekChild(i,"power_val");e.power_cr=s.getComponent("CusRichText"),e.hero_items={},e.hero_nds={};for(var a=1;a<=9;a++){var o=this.seekChild(i,"hero_iten_"+a),l=ItemsPool.getInstance().getItem("hero_exhibition_item");l.setParent(o),l.show(),e.hero_items[a]=l,e.hero_nds[a]=o}var r=this.seekChild(i,"head_con");e.role_head=new n,e.role_head.setParent(r),e.role_head.show()}this.check_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickCheckBtn,this),this.look_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickLookBtn,this)},registerEvent:function(){},onShow:function(t){this.updateWiget()},onHide:function(){},onDelete:function(){for(var t in this.fight_forms){var e=this.fight_forms[t];for(var i in e.hero_items)e.hero_items[i].deleteMe(),e.hero_items[i]=null;e.role_head&&(e.role_head.deleteMe(),e.role_head=null),e=null}},updateFightInfo:function(t){t&&(this.fight_info=t,this.root_wnd&&this.updateWiget())},updateWiget:function(){var t=this.fight_info;if(t){for(var e in this.fight_forms){var i="a_";2==e&&(i="b_");var n=this.fight_forms[e];for(var a in n.hero_items)n.hero_items[a].setData(null),this.isFightPos(t[i+"formation_type"],a)?n.hero_nds[a].opacity=255:n.hero_nds[a].opacity=128;n.role_name_lb.string=t[i+"name"],n.role_lev_lb.string=t[i+"lev"]+"\u7ea7";var o=s.getUIIconPath("form","form_icon_"+t[i+"formation_type"]);this.loadRes(o,function(t,e){t.spriteFrame=e}.bind(this,n.form_icon_sp));var l=t[i+"plist"];for(var a in l){var r=l[a],c=this.getHeroItemPos(t[i+"formation_type"],r.pos);n.hero_items[c].setData(r),n.hero_nds[c].opacity=255}n.role_head.setHeadRes(t[i+"face"]),n.power_cr.setNum(t[i+"power"])}0==t.ret?(this.fight_forms[1].success_img_nd.active=!1,this.fight_forms[2].success_img_nd.active=!1,0===t.replay_id?(this.check_btn_nd.active=!1,this.look_btn_nd.active=!1,this.vs_img_nd.active=!0):(this.check_btn_nd.active=!1,this.look_btn_nd.active=!0,this.vs_img_nd.active=!1)):(this.check_btn_nd.active=!0,this.look_btn_nd.active=!1,this.vs_img_nd.active=!1,1===t.ret?(this.fight_forms[1].success_img_nd.active=!0,this.fight_forms[2].success_img_nd.active=!1):(this.fight_forms[1].success_img_nd.active=!1,this.fight_forms[2].success_img_nd.active=!0))}},getHeroItemPos:function(t,e){return Config.formation_data.data_form_data[t].pos[e-1][1]},isFightPos:function(t,e){var i=Config.formation_data.data_form_data[t];for(var s in i.pos)if(i.pos[s][1]===e)return!0;return!1},onClickCheckBtn:function(){t("arena_controller").getInstance().openArenaChampionReportWindow(!0,this.fight_info)},onClickLookBtn:function(){this.fight_info&&0!=this.fight_info.replay_id&&a.getInstance().csRecordBattle(this.fight_info.replay_id)}});cc._RF.pop()},{arena_controller:"arena_controller",battle_controller:"battle_controller",pathtool:"pathtool",playerhead:"playerhead"}],arena_const:[function(t,e,i){"use strict";cc._RF.push(e,"6c1ff/Zu4ZN/6yqD/bvUykO","arena_const");var s={arena_type:{loop:1,rank:2},loop_index:{challenge:1,activity:2,rank:3,awards:4},red_type:{loop_challenge:1,loop_artivity:2,loop_reward:5,champion_guess:3,loop_log:4},champion_index:{my_match_ready:1,guess:2,match:3,rank:4,my_match:5},champion_step_status:{unopened:0,opened:1,over:2},champion_round_status:{prepare:1,guess:2,fight:3},champion_step:{unopened:0,score:1,match_32:32,match_4:4},champion_my_status:{unopened:0,unjoin:1,in_match:2},getMatchStepDesc:function(t){return t==s.champion_step.unopened?Utils.TI18N("\u6682\u672a\u5f00\u59cb"):t==s.champion_step.score?Utils.TI18N("\u9009\u62d4\u8d5b"):t==s.champion_step.match_32?Utils.TI18N("32\u5f3a\u8d5b"):t==s.champion_step.match_4?Utils.TI18N("4\u5f3a\u8d5b"):Utils.TI18N("\u6682\u672a\u5f00\u59cb")},getMatchStepDesc2:function(t,e){return t==s.champion_step.match_32?e<=1?Utils.TI18N("16\u5f3a\u8d5b"):2==e?Utils.TI18N("8\u5f3a\u8d5b"):Utils.TI18N("4\u5f3a\u8d5b"):t==s.champion_step.match_4?1==e?Utils.TI18N("\u534a\u51b3\u8d5b"):2==e?Utils.TI18N("\u51b3\u8d5b"):Utils.TI18N("\u672c\u8f6e\u51a0\u519b\u8d5b\u5df2\u7ed3\u675f"):t==s.champion_step.score?0==e?Utils.TI18N("\u4e0b\u6b21\u51a0\u519b\u8d5b"):cc.js.formatStr(Utils.TI18N("%s\u7b2c%s\u56de\u5408"),s.getMatchStepDesc(t),e):t==s.champion_step.unopened?Utils.TI18N("\u4e0b\u6b21\u51a0\u519b\u8d5b"):Utils.TI18N("\u51a0\u519b\u8d5b\u6682\u672a\u5f00\u59cb")},getGroup:function(t){return 1==t?Utils.TI18N("A\u7ec4"):2==t?Utils.TI18N("B\u7ec4"):3==t?Utils.TI18N("C\u7ec4"):4==t?Utils.TI18N("D\u7ec4"):""}};e.exports=s,cc._RF.pop()},{}],arena_controller:[function(t,e,i){"use strict";cc._RF.push(e,"dc621YSOudGo7RpjtEKyJw1","arena_controller");var s=t("mainscene_controller"),n=t("mainui_controller"),a=t("scene_const"),o=t("arena_const"),l=(t("role_controller"),t("battle_drama_event"),t("arena_event")),r=t("battle_const"),c=t("mainui_event"),_=cc.Class(function(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}({extends:BaseController,ctor:function(){},initConfig:function(){var e=t("arena_model"),i=t("arena_champion_model");this.model=new e,this.model.initConfig(),this.champion_model=new i,this.champion_model.initConfig(),this.cache_list=[]},getModel:function(){return this.model},getChamPionModel:function(){return this.champion_model},registerEvents:function(){this.login_event_success||(this.login_event_success=gcore.GlobalEvent.bind(EventId.EVT_ROLE_CREATE_SUCCESS,function(){gcore.GlobalEvent.unbind(this.login_event_success)}.bind(this))),this.re_link_game_event||(this.re_link_game_event=gcore.GlobalEvent.bind(EventId.EVT_RE_LINK_GAME,function(){t("guide_controller").getInstance().isInGuide()||this.openArenaLoopMathWindow(!1)}.bind(this))),null==this.loading_enter_scene&&(this.loading_enter_scene=gcore.GlobalEvent.bind(c.LOADING_ENTER_SCENE,function(){this.showCachePanel()}.bind(this)))},requestInitProtocal:function(){this.sender20208(),this.SendProtocal(20200,{}),this.SendProtocal(20250,{}),this.SendProtocal(20223,{})},registerProtocals:function(){this.RegisterProtocal(20200,this.handle20200.bind(this)),this.RegisterProtocal(20201,this.handle20201.bind(this)),this.RegisterProtocal(20202,this.handle20202.bind(this)),this.RegisterProtocal(20203,this.handle20203.bind(this)),this.RegisterProtocal(20206,this.handle20206.bind(this)),this.RegisterProtocal(20207,this.handle20207.bind(this)),this.RegisterProtocal(20208,this.handle20208.bind(this)),this.RegisterProtocal(20209,this.handle20209.bind(this)),this.RegisterProtocal(20210,this.handle20210.bind(this)),this.RegisterProtocal(20220,this.handle20220.bind(this)),this.RegisterProtocal(20221,this.handle20221.bind(this)),this.RegisterProtocal(20222,this.handle20222.bind(this)),this.RegisterProtocal(20223,this.handle20223.bind(this)),this.RegisterProtocal(20250,this.handle20250.bind(this)),this.RegisterProtocal(20251,this.handle20251.bind(this)),this.RegisterProtocal(20252,this.handle20252.bind(this)),this.RegisterProtocal(20253,this.handle20253.bind(this)),this.RegisterProtocal(20254,this.handle20254.bind(this)),this.RegisterProtocal(20255,this.handle20255.bind(this)),this.RegisterProtocal(20256,this.handle20256.bind(this)),this.RegisterProtocal(20257,this.handle20257.bind(this)),this.RegisterProtocal(20258,this.handle20258.bind(this)),this.RegisterProtocal(20260,this.handle20260.bind(this)),this.RegisterProtocal(20261,this.handle20261.bind(this)),this.RegisterProtocal(20262,this.handle20262.bind(this)),this.RegisterProtocal(20263,this.handle20263.bind(this)),this.RegisterProtocal(20280,this.handle20280.bind(this)),this.RegisterProtocal(20281,this.handle20281.bind(this)),this.RegisterProtocal(20282,this.handle20282.bind(this)),this.RegisterProtocal(20204,this.handle20204.bind(this))},handle20200:function(t){this.model.updateMyLoopData(t)},sender20201:function(){this.SendProtocal(20201,{})},handle20201:function(t){this.model.updateLoopChallengeList(t)},handle20202:function(t){this.loop_challenge_role_rid!=t.rid&&this.loop_challenge_role_srv_id!=t.srv_id||this.openCheckLoopChallengeRole(!0,t)},openCheckLoopChallengeRole:function(e,i){if(0==e)null!=this.loop_challenge_check_window&&(this.loop_challenge_check_window.close(),this.loop_challenge_check_window=null);else{if(null==i)return;if(null==this.loop_challenge_check_window){var s=t("arena_loop_challenge_check_window");this.loop_challenge_check_window=new s}this.loop_challenge_check_window.open(i)}},sender20203:function(t,e){var i={};i.rid=t,i.srv_id=e,this.SendProtocal(20203,i)},handle20203:function(t){message(t.msg)},sender20206:function(){this.SendProtocal(20206,{})},handle20206:function(t){message(t.msg)},sender20207:function(t){var e={};e.num=t,this.SendProtocal(20207,e)},handle20207:function(t){message(t.msg),1==t.code&&gcore.GlobalEvent.fire(l.UpdateArena_Number),this.openArenaLoopChallengeBuy(!1)},sender20208:function(){this.SendProtocal(20208,{})},handle20208:function(t){t&&this.model.updateChallengeTimesAwards(t)},sender20209:function(t){var e={};e.num=t,this.SendProtocal(20209,e)},handle20209:function(t){},handle20210:function(e){var i=t("battle_const");t("battle_controller").getInstance().openFinishView(!0,i.Fight_Type.Arena,e),this.SendProtocal(20200,{})},sender20220:function(){this.SendProtocal(20220,{})},handle20220:function(t){t&&t.rank_list&&gcore.GlobalEvent.fire(l.UpdateLoopChallengeStatueList,t.rank_list)},sender20221:function(){this.SendProtocal(20221,{})},handle20221:function(t){t&&gcore.GlobalEvent.fire(l.UpdateLoopChallengeRank,t)},sender20222:function(t){this.SendProtocal(20222,{})},handle20222:function(t){t&&gcore.GlobalEvent.fire(l.UpdateMylogListEvent,t.log_list)},handle20223:function(t){this.model.updateArenaLoopLogStatus(t.flag)},handle20250:function(e){this.champion_model.updateChampionBaseInfo(e),this.sender20251();var i=t("guide_controller"),n=t("story_controller");if(!i.getInstance().isInGuide()&&!n.getInstance().isInStory()){var l=s.getInstance().getBuildVo(a.CenterSceneBuild.arena);if(l&&!l.is_lock)if(1!=IS_LOADING)if(e.step_status===o.champion_step_status.opened){var r=t("activity_controller").getInstance(),c=t("activity_const");this.champion_window||(e.round_status==o.champion_round_status.guess?r.openSignView(!0,c.ActivitySignType.arena_champion_guess,{timer:!0}):this.had_show_notice||(r.openSignView(!0,c.ActivitySignType.arena_champion,{timer:!0}),this.had_show_notice=!0))}else this.alert_window&&(this.alert_window.close(),this.alert_window=null);else this.cache_list.push({function:function(t){this.handle20250(t)}.bind(this,e)})}},sender20251:function(t){this.SendProtocal(20251,{})},handle20251:function(t){this.champion_model.setRoleInfo(t)},sender20252:function(){this.SendProtocal(20252,{})},handle20252:function(t){gcore.GlobalEvent.fire(l.UpdateMyMatchInfoEvent,t)},sender20253:function(){this.SendProtocal(20253,{})},handle20253:function(t){gcore.GlobalEvent.fire(l.UpdateGuessMatchInfoEvent,t)},sender20254:function(t,e){var i={};i.bet_type=t,i.bet_val=e,this.SendProtocal(20254,i)},handle20254:function(t){(message(t.msg),1==t.code)&&(this.champion_model.getRoleInfo().can_bet=t.can_bet,gcore.GlobalEvent.fire(l.UpdateRoleInfoBetEvent,t.can_bet,t.bet_type),this.openArenaChampionGuessWindow(!1))},sender20255:function(){this.SendProtocal(20255,{})},handle20255:function(t){gcore.GlobalEvent.fire(l.UpdateMyGuessListEvent,t.list)},handle20256:function(t){},handle20257:function(t){gcore.GlobalEvent.fire(l.UpdateBetMatchValueEvent,t)},handle20258:function(t){},sender20260:function(){this.SendProtocal(20260,{})},handle20260:function(t){gcore.GlobalEvent.fire(l.UpdateTop32InfoEvent,t)},sender20261:function(){this.SendProtocal(20261,{})},handle20261:function(t){gcore.GlobalEvent.fire(l.UpdateTop4InfoEvent,t)},sender20262:function(){this.SendProtocal(20262,{})},handle20262:function(t){t&&gcore.GlobalEvent.fire(l.UpdateTop324GuessGroupEvent,t.group,t.pos)},sender20263:function(t,e){var i={};i.group=t,i.pos=e,this.SendProtocal(20263,i)},handle20263:function(t){t&&gcore.GlobalEvent.fire(l.UpdateTop324GroupPosEvent,t)},sender20280:function(){this.SendProtocal(20280,{})},handle20280:function(t){t&&t.rank_list&&gcore.GlobalEvent.fire(l.UpdateChampionTop3Event,t.rank_list)},sender20281:function(){this.SendProtocal(20281,{})},handle20281:function(t){gcore.GlobalEvent.fire(l.UpdateChampionRankEvent,t)},handle20282:function(t){},handle20204:function(t){},showCachePanel:function(){if(!(null==this.cache_list||this.cache_list.length<=0)){for(var t in this.cache_list)this.cache_list[t].function&&this.cache_list[t].function();this.cache_list=[]}},requestOpenArenWindow:function(t,e){var i=s.getInstance().getBuildVo(a.CenterSceneBuild.arena);if(i&&i.is_lock)message(i.desc);else if(e==o.arena_type.rank)this.openArenaChampionMatchWindow(!0);else{var n=this.champion_model.getBaseInfo();n&&n.step_status==o.champion_step_status.opened?this.openArenaEnterWindow(!0,o.arena_type.rank):this.requestOpenArenaLoopMathWindow(!0)}},requestOpenArenaLoopMathWindow:function(t,e){t&&n.getInstance().requestOpenBattleRelevanceWindow(r.Fight_Type.Arena)},openArenaLoopMathWindow:function(e,i){if(e){var n=s.getInstance().getBuildVo(a.CenterSceneBuild.arena);if(n&&n.is_lock)return void message(n.desc);if(i=i||o.loop_index.challenge,!this.loop_match_window){var l=t("arena_loop_match_window");this.loop_match_window=new l(this)}this.loop_match_window.isOpen()||this.loop_match_window.open(i)}else this.loop_match_window&&(this.loop_match_window.close(),this.loop_match_window=null)},openArenaEnterWindow:function(e,i){if(e){var n=s.getInstance().getBuildVo(a.CenterSceneBuild.arena);if(n&&n.is_lock)return void message(n.desc);if(!this.enter_window){var l=t("arena_enter_window");this.enter_window=new l(this)}i=i||o.arena_type.loop,this.enter_window.isOpen()||this.enter_window.open(i)}else this.enter_window&&(this.enter_window.close(),this.enter_window=null)},openArenaChampionMatchWindow:function(e,i){if(e){if(!this.champion_window){var s=t("arena_champion_match_window");this.champion_window=new s(this)}this.champion_window.open(i)}else this.champion_window&&(this.champion_window.close(),this.champion_window=null)},openArenaChampionGuessWindow:function(e,i){if(e){if(!this.guess_window){var s=t("arena_champion_guess_window");this.guess_window=new s(this)}this.guess_window.open(i)}else this.guess_window&&(this.guess_window.close(),this.guess_window=null)},openLoopResultWindow:function(e,i){if(e){if(!this.loop_result_window){var s=t("arena_loop_result_window");this.loop_result_window=new s(this)}this.loop_result_window.open(i)}else this.loop_result_window&&(this.loop_result_window.close(),this.loop_result_window=null)},openArenaLoopMyLogWindow:function(e){if(e){if(!this.loop_log_window){var i=t("arena_loop_my_log_window");this.loop_log_window=new i(this)}this.loop_log_window.open()}else this.loop_log_window&&(this.loop_log_window.close(),this.loop_log_window=null)},openArenaLoopChallengeBuy:function(e){if(e){if(!this.arena_champion_buy){var i=t("arena_loop_challenge_buy_window");this.arena_champion_buy=new i(this)}this.arena_champion_buy.open()}else this.arena_champion_buy&&(this.arena_champion_buy.close(),this.arena_champion_buy=null)},openArenaChampionMyGuessWindow:function(e){if(e){if(!this.my_guess_window){var i=t("arena_champion_my_guess_window");this.my_guess_window=new i(this)}this.my_guess_window.open()}else this.my_guess_window&&(this.my_guess_window.close(),this.my_guess_window=null)},openArenaChampionRankAwardsWindow:function(e){if(e){if(!this.champion_rank_awards){var i=t("arena_champion_rank_awards_window");this.champion_rank_awards=new i(this)}this.champion_rank_awards.open()}else this.champion_rank_awards&&(this.champion_rank_awards.close(),this.champion_rank_awards=null)},openArenaChampionRankWindow:function(e,i){if(e){if(!this.champion_rank){var s=t("arena_champion_rank_window");this.champion_rank=new s(this)}this.champion_rank.open(i)}else this.champion_rank&&(this.champion_rank.close(),this.champion_rank=null)},getArenaRoot:function(){if(this.loop_match_window)return this.loop_match_window.root_wnd},openArenaChampionReportWindow:function(e,i){if(e){if(!this.report_window){var s=t("arena_champion_report_window");this.report_window=new s(this)}this.report_window.open(i)}else this.report_window&&(this.report_window.close(),this.report_window=null)},updateChampionTab:function(t){this.champion_window&&this.champion_window.updateTab(t)},requestLoopChallengeRoleInfo:function(t,e){if(null!=t&&null!=e){this.loop_challenge_role_rid=t,this.loop_challenge_role_srv_id=e;var i={};i.rid=t,i.srv_id=e,this.SendProtocal(20202,i)}},requestRabotInfo:function(t,e,i){var s={};s.rid=t,s.srv_id=e,s.pos=i,this.SendProtocal(20204,s)}},"handle20204",function(t){0==t.code&&message(t.msg)}));e.exports=_,cc._RF.pop()},{activity_const:"activity_const",activity_controller:"activity_controller",arena_champion_guess_window:"arena_champion_guess_window",arena_champion_match_window:"arena_champion_match_window",arena_champion_model:"arena_champion_model",arena_champion_my_guess_window:"arena_champion_my_guess_window",arena_champion_rank_awards_window:"arena_champion_rank_awards_window",arena_champion_rank_window:"arena_champion_rank_window",arena_champion_report_window:"arena_champion_report_window",arena_const:"arena_const",arena_enter_window:"arena_enter_window",arena_event:"arena_event",arena_loop_challenge_buy_window:"arena_loop_challenge_buy_window",arena_loop_challenge_check_window:"arena_loop_challenge_check_window",arena_loop_match_window:"arena_loop_match_window",arena_loop_my_log_window:"arena_loop_my_log_window",arena_loop_result_window:"arena_loop_result_window",arena_model:"arena_model",battle_const:"battle_const",battle_controller:"battle_controller",battle_drama_event:"battle_drama_event",guide_controller:"guide_controller",mainscene_controller:"mainscene_controller",mainui_controller:"mainui_controller",mainui_event:"mainui_event",role_controller:"role_controller",scene_const:"scene_const",story_controller:"story_controller"}],arena_enter_champion_panel:[function(t,e,i){"use strict";cc._RF.push(e,"659876rb3RHFqMKSn/9bdcq","arena_enter_champion_panel");var s=t("pathtool"),n=t("timetool"),a=t("arena_event"),o=t("baserole"),l=t("arena_const"),r=t("role_controller"),c=t("role_event"),_=t("hero_controller"),h=t("partner_const"),d=t("hero_const");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("arena","arena_enter_champion_view"),this.ctrl=arguments[0],this.model=this.ctrl.getChamPionModel()},initConfig:function(){this.honor_list={1:"battle_champion",2:"battle_secondplace",3:"battle_thirdplace"},this.const_cfg=Config.arena_champion_data.data_const},initPanel:function(){this.close_btn_nd=this.seekChild("close_btn"),this.enter_btn_nd=this.seekChild("enter_btn"),this.rank_btn_nd=this.seekChild("rank_btn"),this.fight_btn_nd=this.seekChild("fight_btn"),this.champion_step_rt=this.seekChild("label_value_1",cc.RichText),this.worship_num_lb=this.seekChild("worship_num",cc.Label),this.tips_btn_nd=this.seekChild("tips_btn"),this.background=this.seekChild("background"),this.background.scale=FIT_SCALE,this.loadRes(s.getBattleSingleBg("10010"),function(t){this.background.getComponent(cc.Sprite).spriteFrame=t}.bind(this)),this.value_labels={};for(var t=2;t<=6;t++)this.value_labels[t]=this.seekChild("label_value_"+t,cc.Label);this.rank_infos={};for(var e=1;e<=3;e++){var i=this.rank_infos[e]={},n=this.seekChild("rank_"+e);i.role_name_nd=n.getChildByName("role_name"),i.role_name_lb=this.seekChild(n,"role_name",cc.Label),i.honor_nd=n.getChildByName("honor"),i.honor_sp=this.seekChild(n,"honor",cc.Sprite),i.desc_nd=n.getChildByName("desc"),i.desc_lb=this.seekChild(n,"desc",cc.Label),i.desc_lb.string=Utils.TI18N("\u865a\u4f4d\u4ee5\u5f85");var a=n.getChildByName("model");i.role_model=new o,i.role_model.setParent(a);var l=n.getChildByName("worship_btn");i.worship_btn_nd=l,l.rank_tag=e,i.worship_lb=this.seekChild(l,"label",cc.Label),l.on(cc.Node.EventType.TOUCH_END,this.onClickWorshipBtn,this),i.worship_btn=l.getComponent(cc.Button),i.finger_sp=this.seekChild(l,"finger",cc.Sprite)}this.close_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickCloseBtn,this),this.enter_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickEnterBtn,this),this.rank_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickRankBtn,this),this.tips_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickTipBtn,this),this.fight_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickFightBtn,this)},registerEvent:function(){this.addGlobalEvent(a.UpdateChampionTop3Event,function(t){t&&this.updateStatueInfo(t)}.bind(this)),this.addGlobalEvent(a.UpdateChampionBaseInfoEvent,function(t){t&&this.updateBaseInfo()}.bind(this)),this.addGlobalEvent(a.UpdateChampionRoleInfoEvent,function(t){t&&this.updateRoleInfo()}.bind(this)),this.addGlobalEvent(c.WorshipOtherRole,function(t){t&&this.updateOtherWorship(t)}.bind(this))},onShow:function(t){this.ctrl.sender20280(),this.updateBaseInfo()},onHide:function(){},onDelete:function(){for(var t in this.rank_infos)this.rank_infos[t].role_model&&(this.rank_infos[t].role_model.deleteMe(),this.rank_infos[t].role_model=null);this.rank_infos=null},updateBaseInfo:function(){var t=this.base_info=this.model.getBaseInfo(),e=this.role_info=this.model.getRoleInfo(),i="<outline=1 color=#000000>%s</outline>",s="";t.step==l.champion_step.unopened?s=cc.js.formatStr(i,Utils.TI18N("\u6682\u672a\u5f00\u542f")):t.step==l.champion_step.score?s=t.step_status==l.champion_step_status.unopened?cc.js.formatStr(i,Utils.TI18N("\u9009\u62d4\u8d5b"),Utils.TI18N("\u6682\u672a\u5f00\u542f")):cc.js.formatStr(i,Utils.TI18N("\u9009\u62d4\u8d5b"),Utils.TI18N("\u6b63\u5f0f\u8fdb\u884c")):t.step==l.champion_step.match_32?s=t.step_status==l.champion_step_status.unopened?cc.js.formatStr(i,Utils.TI18N("32\u5f3a\u8d5b"),Utils.TI18N("\u6682\u672a\u5f00\u542f")):cc.js.formatStr(i,Utils.TI18N("32\u5f3a\u8d5b"),Utils.TI18N("\u6b63\u5f0f\u8fdb\u884c")):t.step==l.champion_step.match_4&&(s=t.step_status==l.champion_step_status.over?cc.js.formatStr(i,Utils.TI18N("\u51a0\u519b\u8d5b\u5df2\u7ed3\u675f")):cc.js.formatStr(i,Utils.TI18N("4\u5f3a\u8d5b"),Utils.TI18N("\u6b63\u5f0f\u8fdb\u884c"))),this.champion_step_rt.string=s,0===e.rank?this.value_labels[2].string=Utils.TI18N("\u672a\u4e0a\u699c"):this.value_labels[2].string=e.rank,0===e.best_rank?this.value_labels[3].string=Utils.TI18N("\u672a\u4e0a\u699c"):this.value_labels[3].string=e.best_rank;var a=this.less_time=t.step_status_time-gcore.SmartSocket.getTime();a<0?(a=0,this.update_timer&&(this.stopUpdate(),this.update_timer=null)):this.update_timer||(this.update_timer=this.startUpdate());var o=n.getMD(t.start_time),c=n.getMD(t.end_time),_=n.GetTimeFormatTwo(a);this.value_labels[4].string=o+"-"+c,this.value_labels[6].string="\uff08\u5269\u4f59\u65f6\u95f4\uff1a"+_+"\uff09";var h=r.getInstance().getRoleVo();this.worship_num_lb.string=h.worship||0},updateRoleInfo:function(){},updateStatueInfo:function(t){if(this.rank_list=t,t)for(var e in this.rank_infos){var i=this.rank_infos[e],n=t[e-1];if(n){i.worship_btn_nd.active=!0,i.desc_nd.active=!1,i.role_name_nd.active=!0,i.honor_nd.active=!0,cc.log(i.role_name_lb),i.role_name_lb.string=n.name,i.worship_lb.string=n.worship,i.role_model.setData(o.type.role,n.lookid,PlayerAction.show,!0,.72,{scale:.72}),n.worship_status?(i.worship_btn.interactable=!1,i.finger_sp.setMaterial(0,cc.Material.getBuiltinMaterial("2d-gray-sprite"))):(i.worship_btn.interactable=!0,i.finger_sp.setMaterial(0,cc.Material.getBuiltinMaterial("2d-sprite")));var a=this.const_cfg[this.honor_list[n.rank]],l=Config.honor_data.data_title[a.val],r=s.getIconPath("honor","txt_cn_honor_"+l.res_id);this.loadRes(r,function(t,e){t.spriteFrame=e}.bind(this,i.honor_sp))}else i.role_name_nd.active=!1,i.desc_nd.active=!0,i.honor_nd.active=!1,i.worship_btn_nd.active=!1}},onClickWorshipBtn:function(t){var e=t.target.rank_tag,i=null;for(var s in this.rank_list)if(this.rank_list[s].rank===e){i=this.rank_list[s];break}r.getInstance().sender10316(i.rid,i.srv_id,i.rank)},onClickCloseBtn:function(){this.ctrl.openArenaEnterWindow(!1)},onClickEnterBtn:function(){this.ctrl.openArenaChampionMatchWindow(!0)},onClickRankBtn:function(){this.ctrl.openArenaChampionRankWindow(!0)},onClickFightBtn:function(){_.getInstance().openFormGoFightPanel(!0,h.Fun_Form.ArenaChampion,null,d.FormShowType.eFormSave)},updateOtherWorship:function(t){var e=t.idx;for(var i in this.rank_list)if(this.rank_list[i].rank==e){this.rank_list[i].worship+=1,this.rank_list[i].worship_status=1,this.updateStatueInfo(this.rank_list);break}},onClickTipBtn:function(){t("mainui_controller").getInstance().openCommonExplainView(!0,Config.arena_champion_data.data_explain)},update:function(t){this.less_time>0?this.less_time-=t:(this.less_time=0,this.stopUpdate(),this.update_timer=null);var e=n.GetTimeFormatTwo(Math.ceil(this.less_time)),i=Utils.TI18N("\uff08\u5269\u4f59\u65f6\u95f4\uff1a"+e+"\uff09");i!=this.value_labels[6].string&&(this.value_labels[6].string=i)}});cc._RF.pop()},{arena_const:"arena_const",arena_event:"arena_event",baserole:"baserole",hero_const:"hero_const",hero_controller:"hero_controller",mainui_controller:"mainui_controller",partner_const:"partner_const",pathtool:"pathtool",role_controller:"role_controller",role_event:"role_event",timetool:"timetool"}],arena_enter_loop_panel:[function(t,e,i){"use strict";cc._RF.push(e,"1d1d3OcUOxGVYTH4wgkdhFe","arena_enter_loop_panel");var s=t("pathtool"),n=t("timetool"),a=t("arena_event"),o=t("baserole"),l=t("role_controller"),r=t("role_event"),c=t("mainui_controller");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("arena","arena_enter_loop_view"),this.ctrl=arguments[0],this.model=this.ctrl.getModel(),this.startUpdate()},initConfig:function(){},initPanel:function(){this.close_btn_nd=this.seekChild("close_btn"),this.enter_btn_nd=this.seekChild("enter_btn"),this.worship_num_lb=this.seekChild("worship_num",cc.Label),this.buy_btn_nd=this.seekChild("buy_btn"),this.tips_btn_nd=this.seekChild("tips_btn"),this.red_tips_nd=this.seekChild("tips"),this.background=this.seekChild("background"),this.background.scale=FIT_SCALE,this.loadRes(s.getBattleSingleBg("10005"),function(t){this.background.getComponent(cc.Sprite).spriteFrame=t}.bind(this)),this.value_labels={};for(var t=1;t<=6;t++)this.value_labels[t]=this.seekChild("label_value_"+t,cc.Label);this.rank_infos={};for(var e=1;e<=3;e++){var i=this.rank_infos[e]={},n=this.seekChild("rank_"+e);i.role_name_nd=n.getChildByName("role_name"),i.role_name_lb=this.seekChild(n,"role_name",cc.Label);var a=n.getChildByName("model");i.role_model=new o,i.role_model.setParent(a);var l=n.getChildByName("worship_btn");l.rank_tag=e,l.on(cc.Node.EventType.TOUCH_END,this.onClickWorshipBtn,this),i.worship_lb=this.seekChild(l,"label",cc.Label),i.worship_btn=l.getComponent(cc.Button),i.finger_sp=this.seekChild(l,"finger",cc.Sprite),i.desc_nd=n.getChildByName("desc")}this.close_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickCloseBtn,this),this.enter_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickEnterBtn,this),this.buy_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickByBtn,this),this.tips_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickTipBtn,this)},registerEvent:function(){this.addGlobalEvent(a.UpdateLoopChallengeStatueList,function(t){t&&this.updateStatueInfo(t)}.bind(this)),this.addGlobalEvent(r.WorshipOtherRole,function(t){t&&this.updateOtherWorship(t)}.bind(this)),this.addGlobalEvent(a.UpdateArena_Number,function(){this.updateWidgets()}.bind(this)),this.addGlobalEvent(a.UpdateMyLoopData,function(){this.updateWidgets()}.bind(this))},onShow:function(t){this.ctrl.sender20220(),this.updateWidgets()},onHide:function(){},onDelete:function(){if(this.rank_infos){for(var t in this.rank_infos)this.rank_infos[t].role_model.deleteMe(),this.rank_infos[t]=null;this.rank_infos=null}},onClickCloseBtn:function(){this.ctrl.openArenaEnterWindow(!1)},onClickEnterBtn:function(){this.ctrl.requestOpenArenaLoopMathWindow(!0)},updateWidgets:function(){var e=this.loop_data=this.model.getMyLoopData(),i=this.cup_cfg=this.model.getZoneConfigBySoure();if(e&&i){this.value_labels[1].string=e.score;var s=e.rank;0===s&&(s=Utils.TI18N("\u5343\u91cc\u4e4b\u5916")),this.value_labels[2].string=s;var a=t("backpack_controller").getInstance().getModel(),o=Config.arena_data.data_const.arena_ticketcost.val[0][0],r=a.getBackPackItemNumByBid(o);this.value_labels[3].string=r;var c=e.end_time-gcore.SmartSocket.getTime(),_=n.getMD(e.start_time),h=n.getMD(e.end_time),d=n.GetTimeFormatTwo(c);this.value_labels[4].string=_+"-"+h,this.value_labels[6].string="\uff08"+d+"\uff09"}var u=l.getInstance().getRoleVo();this.worship_num_lb.string=u.worship||0,e.can_combat_num>0?this.red_tips_nd.active=!0:this.red_tips_nd.active=!1},updateStatueInfo:function(t){if(this.rank_list=t,t)for(var e in this.rank_infos){var i=this.rank_infos[e],s=t[e-1];s?(i.role_name_nd.active=!0,i.role_name_lb.string=s.name,i.worship_btn.node.active=!0,i.worship_lb.string=s.worship,i.role_model.setData(o.type.role,s.lookid,PlayerAction.show,!0,.72,{scale:.72}),s.worship_status?(i.worship_btn.interactable=!1,i.finger_sp.setMaterial(0,cc.Material.getBuiltinMaterial("2d-gray-sprite"))):(i.worship_btn.interactable=!0,i.finger_sp.setMaterial(0,cc.Material.getBuiltinMaterial("2d-sprite")))):(i.role_name_nd.active=!1,i.desc_nd.active=!0,i.worship_btn.node.active=!1)}},onClickWorshipBtn:function(t){var e=t.target.rank_tag,i=null;for(var s in this.rank_list)if(this.rank_list[s].rank===e){i=this.rank_list[s];break}l.getInstance().sender10316(i.rid,i.srv_id,i.rank)},updateOtherWorship:function(t){var e=t.idx;for(var i in this.rank_list)if(this.rank_list[i].rank==e){this.rank_list[i].worship+=1,this.rank_list[i].worship_status=1,this.updateStatueInfo(this.rank_list);break}},onClickByBtn:function(){this.ctrl.openArenaLoopChallengeBuy(!0)},onClickTipBtn:function(){c.getInstance().openCommonExplainView(!0,Config.arena_data.data_explain)}});cc._RF.pop()},{arena_event:"arena_event",backpack_controller:"backpack_controller",baserole:"baserole",mainui_controller:"mainui_controller",pathtool:"pathtool",role_controller:"role_controller",role_event:"role_event",timetool:"timetool"}],arena_enter_window:[function(t,e,i){"use strict";cc._RF.push(e,"13c78cgv15Ixq8fyaz0DDMp","arena_enter_window");var s=1,n=2,a=t("pathtool"),o=t("role_controller");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=a.getPrefabPath("arena","arena_enter_window"),this.viewTag=SCENE_TAG.ui,this.win_type=WinType.Full,this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){this.cur_tab=null,this.tab_panels={}},openCallBack:function(){this.panel_container_nd=this.seekChild("panel_container"),this.loop_btn_nd=this.seekChild("loop_btn"),this.rank_btn_nd=this.seekChild("rank_btn"),this.loop_normal_bg_nd=this.seekChild("loop_normal_bg"),this.rank_normal_bg_nd=this.seekChild("rank_normal_bg"),this.set_btn_nd=this.seekChild("set_btn"),this.loop_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickLoopBtn,this),this.rank_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickRankBtn,this),this.set_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickSetBtn,this),this.updateTab(s)},registerEvent:function(){},openRootWnd:function(t){this.updateWidgets()},closeCallBack:function(){for(var t in this.tab_panels)this.tab_panels[t]&&this.tab_panels[t].deleteMe();this.ctrl.openArenaEnterWindow(!1)},updateWidgets:function(){},updateTab:function(e){if(e&&e!=this.cur_tab){var i=null;if(e==s?(this.loop_normal_bg_nd.active=!1,this.rank_normal_bg_nd.active=!0,i=n):e==n&&(this.loop_normal_bg_nd.active=!0,this.rank_normal_bg_nd.active=!1,i=s),this.tab_panels[e])this.tab_panels[e].setVisible(!0);else{var a=null;a=t(e==s?"arena_enter_loop_panel":"arena_enter_champion_panel"),this.tab_panels[e]=new a(this.ctrl),this.tab_panels[e].setParent(this.panel_container_nd),this.tab_panels[e].show()}this.tab_panels[i]&&this.tab_panels[i].setVisible(!1),this.cur_tab=e}},onClickLoopBtn:function(){this.updateTab(s)},onClickRankBtn:function(){this.updateTab(n)},onClickSetBtn:function(){o.getInstance().openRoleDecorateView(!0,3)}});cc._RF.pop()},{arena_enter_champion_panel:"arena_enter_champion_panel",arena_enter_loop_panel:"arena_enter_loop_panel",pathtool:"pathtool",role_controller:"role_controller"}],arena_event:[function(t,e,i){"use strict";cc._RF.push(e,"ad769XRP5BCzqdx2T9D97k7","arena_event");var s={UpdateMyLoopData:"ArenaEvent.UpdateMyLoopData",UpdateLoopChallengeTimesList:"ArenaEvent.UpdateLoopChallengeTimesList",UpdateLoopChallengeList:"ArenaEvent.UpdateLoopChallengeList",UpdateLoopChallengeListItem:"ArenaEvent.UpdateLoopChallengeListItem",UpdateLoopChallengeStatueList:"ArenaEvent.UpdateLoopChallengeStatueList",UpdateLoopChallengeRank:"ArenaEvent:UpdateLoopChallengeRank ",UpdateArenaRedStatus:"ArenaEvent.UpdateArenaRedStatus",UpdateArena_Number:"ArenaEvent.UpdateArena_Number",CheckFightInfoEvent:"ArenaEvent.CheckFightInfoEvent",ChangeTanFromTop324:"ArenaEvent.ChangeTanFromTop324",UpdateChampionBaseInfoEvent:"ArenaEvent.UpdateChampionBaseInfoEvent",UpdateChampionRoleInfoEvent:"ArenaEvent.UpdateChampionRoleInfoEvent",UpdateChampionTop3Event:"ArenaEvent.UpdateChampionTop3Event",UpdateMyMatchInfoEvent:"ArenaEvent.UpdateMyMatchInfoEvent",UpdateGuessMatchInfoEvent:"ArenaEvent.UpdateGuessMatchInfoEvent",UpdateBetMatchValueEvent:"ArenaEvent.UpdateBetMatchValueEvent",UpdateMyGuessListEvent:"ArenaEvent.UpdateMyGuessListEvent",UpdateChampionRankEvent:"ArenaEvent.UpdateChampionRankEvent",UpdateTop32InfoEvent:"ArenaEvent.UpdateTop32InfoEvent",UpdateTop4InfoEvent:"ArenaEvent.UpdateTop4InfoEvent",UpdateTop324GuessGroupEvent:"ArenaEvent.UpdateTop324GuessGroupEvent",UpdateTop324GroupPosEvent:"ArenaEvent.UpdateTop324GroupPosEvent",UpdateRoleInfoBetEvent:"ArenaEvent.UpdateRoleInfoBetEvent",UpdateMylogListEvent:"ArenaEvent.UpdateMylogListEvent"};e.exports=s,cc._RF.pop()},{}],arena_loop_activity_item:[function(t,e,i){"use strict";cc._RF.push(e,"daa878x1QBHh6U3wVU2fecv","arena_loop_activity_item");var s=t("pathtool");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("arena","arean_loop_activity_item")},initConfig:function(){},initPanel:function(){this.rank_img_nd=this.seekChild("rank_img"),this.rank_img_sp=this.seekChild("rank_img",cc.Sprite),this.rank_txt_nd=this.seekChild("rank_txt"),this.rank_txt_lb=this.seekChild("rank_txt",cc.Label),this.role_rank_lb=this.seekChild("role_rank",cc.Label),this.list_items={};for(var t=0;t<2;t++){var e=this.seekChild("item_nd_"+t);this.list_items[t]=ItemsPool.getInstance().getItem("backpack_item"),this.list_items[t].setParent(e),this.list_items[t].setExtendData({scale:.8}),this.list_items[t].setDefaultTip(!0,!1),this.list_items[t].show()}},registerEvent:function(){},onShow:function(t){this.updateWidgets()},onHide:function(){},onDelete:function(){if(this.list_items){for(var t in this.list_items)this.list_items[t]&&(this.list_items[t].deleteMe(),this.list_items[t]=null);this.list_items=null}},setData:function(t){t&&(this.active_data=t,this.root_wnd&&this.updateWidgets())},updateWidgets:function(){if(this.active_data.min==this.active_data.max&&this.active_data.max>0&&this.active_data.max<=3){this.rank_img_nd.active=!0,this.rank_txt_nd.active=!1;var t=s.getUIIconPath("common","common_200"+this.active_data.max);this.loadRes(t,function(t){this.rank_img_sp.spriteFrame=t}.bind(this))}else this.active_data.min>3&&(this.rank_img_nd.active=!1,this.rank_txt_nd.active=!0,this.rank_txt_lb.string=this.active_data.min+"~"+this.active_data.max);for(var e in this.active_data.items){var i={};i.bid=this.active_data.items[e][0],i.num=this.active_data.items[e][1],this.list_items[e].setData(i)}}});cc._RF.pop()},{pathtool:"pathtool"}],arena_loop_activity_panel:[function(t,e,i){"use strict";cc._RF.push(e,"bdefa9fr2ZIf6lfbV/PtekS","arena_loop_activity_panel");var s=t("pathtool"),n=t("arena_loop_activity_item"),a=t("common_scrollview");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("arena","arena_loop_activity_panel"),this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){this.activity_list=Config.arena_data.data_activity},initPanel:function(){this.scroll_container_nd=this.seekChild("scroll_container"),this.role_rank_lb=this.seekChild("role_rank",cc.Label),this.list_items={};for(var t=0;t<2;t++){var e=this.seekChild("item_nd_"+t);this.list_items[t]=ItemsPool.getInstance().getItem("backpack_item"),this.list_items[t].setParent(e),this.list_items[t].setExtendData({scale:.8}),this.list_items[t].show()}this.initActivityList()},registerEvent:function(){},onShow:function(t){this.updateWidgets(),this.updateActiveList()},onHide:function(){},onDelete:function(){if(this.list_items){for(var t in this.list_items)this.list_items[t]&&(this.list_items[t].deleteMe(),this.list_items[t]=null);this.list_items=null}this.activity_sv&&(this.activity_sv.deleteMe(),this.activity_sv=null)},initActivityList:function(){var t=this.scroll_container_nd.getContentSize(),e=cc.size(t.width,t.height),i={item_class:n,start_x:0,space_x:0,start_y:0,space_y:0,item_width:614,item_height:143,row:0,col:1,need_dynamic:!1};this.activity_sv=new a,this.activity_sv.createScroll(this.scroll_container_nd,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,e,i,cc.v2(.5,.5))},updateWidgets:function(){if(this.root_wnd){var t=this.model.getMyLoopData();this.role_rank_lb.string=t.rank;var e=null;if(0!==t.rank)for(var i in this.activity_list)if(cc.log(this.activity_list[i]),t.rank<=this.activity_list[i].max&&t.rank>=this.activity_list[i].min){e=this.activity_list[i].items;break}for(var s in this.list_items)if(e&&e[s]){var n={};n.bid=e[s][0],n.num=e[s][1],this.list_items[s].setVisible(!0),this.list_items[s].setData(n)}else this.list_items[s].setVisible(!1)}},updateActiveList:function(){this.activity_sv.setData(this.activity_list)},updatePanelInfo:function(){this.updateWidgets()}});cc._RF.pop()},{arena_loop_activity_item:"arena_loop_activity_item",common_scrollview:"common_scrollview",pathtool:"pathtool"}],arena_loop_awards_item:[function(t,e,i){"use strict";cc._RF.push(e,"10244bwD2FJ1Z6/suCyr8wZ","arena_loop_awards_item");var s=t("pathtool");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("arena","arean_loop_awards_item")},initConfig:function(){},initPanel:function(){this.rank_img_nd=this.seekChild("rank_img"),this.rank_img_sp=this.seekChild("rank_img",cc.Sprite),this.rank_txt_nd=this.seekChild("rank_txt"),this.rank_txt_lb=this.seekChild("rank_txt",cc.Label),this.role_rank_lb=this.seekChild("role_rank",cc.Label),this.list_items={};for(var t=0;t<3;t++){var e=this.seekChild("item_nd_"+t);this.list_items[t]=ItemsPool.getInstance().getItem("backpack_item"),this.list_items[t].setParent(e),this.list_items[t].setExtendData({scale:.8}),this.list_items[t].show(),this.list_items[t].setVisible(!1),this.list_items[t].setDefaultTip(!0,!1)}},registerEvent:function(){},onShow:function(t){this.updateWidgets()},onHide:function(){},onDelete:function(){if(this.list_items){for(var t in this.list_items)this.list_items[t]&&(this.list_items[t].deleteMe(),this.list_items[t]=null);this.list_items=null}},setData:function(t){this.reward_data=t,this.root_wnd&&this.updateWidgets()},updateWidgets:function(){for(var t in this.list_items)this.list_items[t].setVisible(!1);if(this.reward_data.min==this.reward_data.max&&this.reward_data.max>0&&this.reward_data.max<=3){this.rank_img_nd.active=!0,this.rank_txt_nd.active=!1;var e=s.getUIIconPath("common","common_200"+this.reward_data.max);this.loadRes(e,function(t){this.rank_img_sp.spriteFrame=t}.bind(this))}else this.reward_data.min>3&&(this.rank_img_nd.active=!1,this.rank_txt_nd.active=!0,this.rank_txt_lb.string=this.reward_data.min+"~"+this.reward_data.max);var i=this.reward_data.items.length;for(var t in this.reward_data.items){var n={};n.bid=this.reward_data.items[i-1-t][0],n.num=this.reward_data.items[i-1-t][1],this.list_items[t].setData(n),this.list_items[t].setVisible(!0)}}});cc._RF.pop()},{pathtool:"pathtool"}],arena_loop_awards_panel:[function(t,e,i){"use strict";cc._RF.push(e,"4d4671CNihKbqRzadkgB/1t","arena_loop_awards_panel");var s=t("pathtool"),n=t("arena_loop_awards_item"),a=t("common_scrollview"),o=t("timetool");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("arena","arena_loop_awards_panel"),this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){this.awards_list=Config.arena_data.data_awards},initPanel:function(){this.scroll_container_nd=this.seekChild("scroll_container"),this.role_rank_lb=this.seekChild("role_rank",cc.Label),this.limit_time_lb=this.seekChild("limit_time",cc.Label),this.list_items={};for(var t=0;t<3;t++){var e=this.seekChild("item_nd_"+t);this.list_items[t]=ItemsPool.getInstance().getItem("backpack_item"),this.list_items[t].setParent(e),this.list_items[t].setExtendData({scale:.8}),this.list_items[t].show(),this.list_items[t].setVisible(!1)}this.initAwardsList()},registerEvent:function(){},onShow:function(t){this.updateWidgets(),this.updateAwardsList()},onHide:function(){},onDelete:function(){if(this.list_items){for(var t in this.list_items)this.list_items[t]&&(this.list_items[t].deleteMe(),this.list_items[t]=null);this.list_items=null}this.awards_sv&&(this.awards_sv.deleteMe(),this.awards_sv=null)},updateWidgets:function(){if(this.root_wnd){var t=this.model.getMyLoopData();this.role_rank_lb.string=t.rank;var e=null;if(0!==t.rank)for(var i in this.awards_list)if(cc.log(this.awards_list[i]),t.rank<=this.awards_list[i].max&&t.rank>=this.awards_list[i].min){e=this.awards_list[i].items;break}for(var s in this.list_items)this.list_items[s].setVisible(!1);if(e){var n=e.length;for(var s in e){var a={};a.bid=e[n-1-s][0],a.num=e[n-1-s][1],this.list_items[s].setData(a),this.list_items[s].setVisible(!0)}}t=this.model.getMyLoopData();(this.less_time=t.end_time-gcore.SmartSocket.getTime())>0?this.update_timer||(this.update_timer=this.startUpdate()):this.update_timer&&this.stopUpdate()}},initAwardsList:function(){var t=this.scroll_container_nd.getContentSize(),e=cc.size(t.width,t.height),i={item_class:n,start_x:0,space_x:0,start_y:0,space_y:0,item_width:614,item_height:143,row:0,col:1,need_dynamic:!0};this.awards_sv=new a,this.awards_sv.createScroll(this.scroll_container_nd,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,e,i,cc.v2(0,.5))},updateAwardsList:function(){this.awards_sv.setData(this.awards_list)},updatePanelInfo:function(){this.updateWidgets()},update:function(t){this.less_time>0?this.less_time-=t:(this.less_time=0,this.stopUpdate(),this.update_timer=null);var e=o.getTimeFormat(Math.ceil(this.less_time));this.limit_time_lb.string=Utils.TI18N("\u8d5b\u5b63\u5269\u4f59\u65f6\u95f4:"+e)}});cc._RF.pop()},{arena_loop_awards_item:"arena_loop_awards_item",common_scrollview:"common_scrollview",pathtool:"pathtool",timetool:"timetool"}],arena_loop_challenge_buy_window:[function(t,e,i){"use strict";cc._RF.push(e,"3b274EfUsZO+7pc1f545d7e","arena_loop_challenge_buy_window");var s=t("pathtool"),n=t("role_controller");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("arena","arean_loop_challenge_buy"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Full,this.ctrl=arguments[0]},initConfig:function(){this.buy_num=0,this.role_vo=n.getInstance().getRoleVo(),this.arena_ticketcost_item=Config.arena_data.data_const.arena_ticketcost.val[0][0],this.item_config_item=gdata("item_data","data_unit1",this.arena_ticketcost_item,!1),this.ticket_price_info=Config.arena_data.data_const.ticket_price,this.ticket_price=this.ticket_price_info.val[0][1],this.ticket_id=this.ticket_price_info.val[0][0]},openCallBack:function(){this.btn_close_nd=this.seekChild("btn_close"),this.mask_nd=this.seekChild("mask"),this.item_con_nd=this.seekChild("item_con"),this.btn_add_nd=this.seekChild("btn_add"),this.btn_redu_nd=this.seekChild("btn_redu"),this.btn_buy_nd=this.seekChild("btn_buy"),this.buy_num_lb=this.seekChild("buy_num",cc.Label),this.expand_num_rt=this.seekChild("expand_num",cc.RichText),this.icon_img_sp=this.seekChild("icon_img",cc.Sprite),this.background_nd=this.seekChild("background"),this.background_nd.scale=FIT_SCALE,this.backpack_item=ItemsPool.getInstance().getItem("backpack_item"),this.backpack_item.setParent(this.item_con_nd),this.backpack_item.show(),this.btn_close_nd.on(cc.Node.EventType.TOUCH_END,this.onClickCloseBtn,this),this.mask_nd.on(cc.Node.EventType.TOUCH_END,this.onClickCloseBtn,this),this.btn_add_nd.on(cc.Node.EventType.TOUCH_END,this.onClickAddBtn,this),this.btn_redu_nd.on(cc.Node.EventType.TOUCH_END,this.onClickRedBtn,this),this.btn_buy_nd.on(cc.Node.EventType.TOUCH_END,this.onClickBuyBtn,this)},registerEvent:function(){},openRootWnd:function(t){this.updateWidgets()},closeCallBack:function(){this.backpack_item&&(this.backpack_item.deleteMe(),this.backpack_item=null),this.ctrl.openArenaLoopChallengeBuy(!1)},onClickCloseBtn:function(){this.ctrl.openArenaLoopChallengeBuy(!1)},onClickAddBtn:function(){this.buy_num<this.can_buy-1?(this.buy_num+=1,this.updateValue()):message(Utils.TI18N("\u5df2\u8fbe\u6700\u5927\u8d2d\u4e70\u503c"))},onClickRedBtn:function(){this.buy_num>1?(this.buy_num-=1,this.updateValue()):message(Utils.TI18N("\u8d2d\u4e70\u6570\u91cf\u4e0d\u80fd\u5c0f\u4e8e0"))},updateWidgets:function(){this.item_config_item&&this.backpack_item.setData(this.item_config_item.id),this.role_vo.gold>this.ticket_price&&(this.buy_num=1),this.can_buy=Math.floor(this.role_vo.gold/this.ticket_price);var t=s.getIconPath("item",this.ticket_id);this.loadRes(t,function(t){this.icon_img_sp.spriteFrame=t}.bind(this)),this.updateValue()},updateValue:function(){this.buy_num_lb.string=this.buy_num;var t=cc.js.formatStr("<color=#68452a>%s/</color><color=#249003>%s</color>",Utils.getMoneyString(this.role_vo.gold),this.ticket_price*this.buy_num);this.expand_num_rt.string=t},onClickBuyBtn:function(){this.ctrl.sender20207(this.buy_num)}});cc._RF.pop()},{pathtool:"pathtool",role_controller:"role_controller"}],arena_loop_challenge_check_window:[function(t,e,i){"use strict";cc._RF.push(e,"a44ddcS7C5MjLOVeWR4DPKD","arena_loop_challenge_check_window");var s=t("pathtool"),n=t("playerhead"),a=t("arena_controller");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("arena","arena_loop_challenge_check_window"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Mini,this.ctrl=a.getInstance()},initConfig:function(){this.item_list=[]},openCallBack:function(){this.background=this.root_wnd.getChildByName("background");var t=this.root_wnd.getChildByName("container");this.close_btn=t.getChildByName("close_btn"),this.scroll_view=t.getChildByName("scroll_view").getComponent(cc.ScrollView),this.scroll_size=this.scroll_view.node.getContentSize(),this.challenge_btn=t.getChildByName("challenge_btn"),this.challenge_btn_label=this.challenge_btn.getChildByName("label").getComponent(cc.Label),this.challenge_btn_label.string=Utils.TI18N("\u6311 \u6218"),this.role_name=t.getChildByName("role_name").getComponent(cc.Label),this.role_score=t.getChildByName("role_score").getComponent(cc.Label),this.score_title=t.getChildByName("score_title").getComponent(cc.Label),this.score_title.string=Utils.TI18N("\u7ade\u6280\u573a\u79ef\u5206\uff1a"),this.role_head=new n,this.role_head.setParent(t),this.role_head.show(),this.role_head.setPosition(-218,113),this.fight_label=t.getChildByName("power_img").getChildByName("num").getComponent("CusRichText"),this.container=t},registerEvent:function(){this.background.on("touchend",function(){Utils.playButtonSound(2),this.ctrl.openCheckLoopChallengeRole(!1)},this),this.close_btn.on("click",function(){Utils.playButtonSound(2),this.ctrl.openCheckLoopChallengeRole(!1)},this),this.challenge_btn.on("click",function(){Utils.playButtonSound(1),null!=this.data&&(this.ctrl.openCheckLoopChallengeRole(!1),this.ctrl.sender20203(this.data.rid,this.data.srv_id))},this)},openRootWnd:function(t){this.data=t;null!=this.data&&(this.role_name.string=this.data.name,this.fight_label.setNum(this.data.power),this.role_head.setHeadRes(this.data.face),this.role_head.setLev(this.data.lev),this.role_score.string=this.data.score),this.setCheckRoleHero()},setCheckRoleHero:function(){var t=this,e=this;if(null!=e.data&&null!=e.data.p_list)for(var i=e.data.p_list.length,s=104*i+6*(i-1),n=(e.scroll_size.width-s)/2,a=function(i){var s=e.data.p_list[i];Utils.delayRun(e.container,i/40,function(){var t=ItemsPool.getInstance().getItem("hero_exhibition_item");t.setRootScale(.8),t.show();var a=n+52+110*i;t.setPosition(a,.5*e.scroll_size.height),t.setData(s),t.addCallBack(function(){e.data&&e.ctrl.requestRabotInfo(e.data.rid,e.data.srv_id,s.pos)}),t.setParent(e.scroll_view.content),e.item_list.push(t)}.bind(t))},o=0;o<e.data.p_list.length;++o)a(o)},closeCallBack:function(){if(this.role_head&&this.role_head.deleteMe(),this.item_list){for(var t=0;t<this.item_list.length;++t)this.item_list[t].deleteMe(),this.item_list[t]=null;this.item_list=null}this.ctrl.openCheckLoopChallengeRole(!1)}});cc._RF.pop()},{arena_controller:"arena_controller",pathtool:"pathtool",playerhead:"playerhead"}],arena_loop_challenge_item:[function(t,e,i){"use strict";cc._RF.push(e,"f63c4O07lRL+qeSKc7F7tBO","arena_loop_challenge_item");var s=t("pathtool"),n=t("playerhead");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("arena","arean_loop_challenge_item"),this.ctrl=t("arena_controller").getInstance()},initConfig:function(){},initPanel:function(){this.challenge_btn_nd=this.seekChild("challenge_btn"),this.role_name_lb=this.seekChild("role_name",cc.Label),this.role_score_lb=this.seekChild("role_score",cc.Label),this.role_power_lb=this.seekChild("role_power",cc.Label),this.head_container_nd=this.seekChild("head_container"),this.icon_title_con_nd=this.seekChild("icon_title_con"),this.btn_title_nd=this.seekChild("btn_title"),this.btn_img_title_rt=this.seekChild("btn_img_title",cc.RichText),this.icon_title_sp=this.seekChild("icon_title",cc.Sprite),this.role_head=new n,this.role_head.setParent(this.head_container_nd),this.role_head.show(),this.challenge_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickChallengeBtn,this)},registerEvent:function(){this.role_head.addCallBack(function(){null!=this.role_data&&(0==this.role_data.score?message(Utils.TI18N("\u795e\u79d8\u9ad8\u624b\u4e0d\u80af\u900f\u9732\u4fe1\u606f\u54e6!")):this.ctrl.requestLoopChallengeRoleInfo(this.role_data.rid,this.role_data.srv_id))}.bind(this))},onShow:function(t){this.updateWidgets()},onHide:function(){},onDelete:function(){this.role_head&&this.role_head.deleteMe()},setExtendData:function(t){this.has_num=t.has_num,this.free_num=t.free_num},setData:function(t){t&&(this.role_data=t,this.root_wnd&&this.updateWidgets())},addCallBack:function(){},updateWidgets:function(){if(this.free_num>0?(this.icon_title_con_nd.active=!1,this.btn_title_nd.active=!0):(this.icon_title_con_nd.active=!0,this.btn_title_nd.active=!1,this.has_num>0?this.btn_img_title_rt.string="<outline color=#2B610D width=2>1 \u6311\u6218</outline>":this.btn_img_title_rt.string="<outline color=#ba3b3b width=2>1 </outline> <outline color=#2B610D width=2>\u6311\u6218</outline>"),this.challenge_btn_nd.ui_tag=1e3+this.role_data.idx,!this.icon_title_sp.spriteFrame){var t=Config.arena_data.data_const.arena_ticketcost.val[0][0],e=gdata("item_data","data_unit1",t,!1),i=s.getIconPath("item",e.icon);this.loadRes(i,function(t){this.icon_title_sp.spriteFrame=t}.bind(this))}this.role_name_lb.string=this.role_data.name,0===this.role_data.power?this.role_power_lb.string="???":this.role_power_lb.string=this.role_data.power,0===this.role_data.score?this.role_score_lb.string="???":this.role_score_lb.string=this.role_data.score,this.role_head.setHeadRes(this.role_data.face),this.role_head.setLev(this.role_data.lev),this.updatePowerColor()},onClickChallengeBtn:function(){this.role_data&&this.ctrl.sender20203(this.role_data.rid,this.role_data.srv_id)},updatePowerColor:function(){var e=t("role_controller").getInstance().getRoleVo(),i=this.role_power_lb.node.color,s=Config.color_data.data_color16[180];this.role_data.power>1.2*e.power&&(s=Config.color_data.data_color16[11]),i.fromHEX(s),this.role_power_lb.node.color=i}});cc._RF.pop()},{arena_controller:"arena_controller",pathtool:"pathtool",playerhead:"playerhead",role_controller:"role_controller"}],arena_loop_challenge_panel:[function(t,e,i){"use strict";cc._RF.push(e,"2c49fCL3qJF+axxsA6Qnfli","arena_loop_challenge_panel");var s=t("pathtool"),n=t("timetool"),a=t("arena_event"),o=t("common_scrollview"),l=t("arena_loop_challenge_item");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("arena","arena_loop_challenge_panel"),this.rleasePrefab=!1,this.ctrl=arguments[0],this.model=this.ctrl.getModel(),this.startUpdate()},initConfig:function(){this.is_ref_status=!0,this.is_finish_awards=!1;var e=t("backpack_controller");this.bag_model=e.getInstance().getModel(),this.item_eff={1:109,2:109,3:108,4:108,5:110,6:110,7:110}},initPanel:function(){this.list_container_nd=this.seekChild("list_container"),this.rank_num_lb=this.seekChild("rank_num",cc.Label),this.score_num_lb=this.seekChild("score_num",cc.Label),this.text_add_time_lb=this.seekChild("text_add_time",cc.Label),this.time_label_lb=this.seekChild("time_label",cc.Label),this.times_item_sp=this.seekChild("times_item",cc.Sprite),this.ref_time_lb=this.seekChild("ref_time",cc.Label),this.ref_time_nd=this.seekChild("ref_time"),this.ref_title_nd=this.seekChild("ref_title"),this.refresh_btn=this.seekChild("refresh_btn",cc.Button),this.box_bar_nd=this.seekChild("box_bar",cc.ProgressBar),this.addtimes_btn_nd=this.seekChild("addtimes_btn"),this.protect_btn_nd=this.seekChild("protect_btn"),this.refresh_btn_nd=this.seekChild("refresh_btn"),this.my_log_btn_nd=this.seekChild("my_log_btn"),this.change_num_lb=this.seekChild("change_num",cc.Label),this.tip_panel_nd=this.seekChild("tip_panel"),this.tip_con_nd=this.seekChild("tip_con"),this.iten_con_nd=this.seekChild("iten_con"),this.item_num_lb=this.seekChild("item_num",cc.Label),this.challenge_shop_nd=this.seekChild("challenge_shop"),this.log_red_tips=this.seekChild("tips"),this.award_item=ItemsPool.getInstance().getItem("backpack_item"),this.award_item.setParent(this.iten_con_nd),this.award_item.setExtendData({scale:.8}),this.award_item.show(),this.protect_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickProtectBtn,this),this.refresh_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickRefreshBtn,this),this.my_log_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickMyLogBtn,this),this.addtimes_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickAddBtn,this),this.tip_panel_nd.on(cc.Node.EventType.TOUCH_END,this.onClickTipPanel,this),this.challenge_shop_nd.on(cc.Node.EventType.TOUCH_END,this.onClickShopBtn,this),this.times_awards={},this.bool_box_status={};for(var t=1;t<=7;t++){this.times_awards[t]={};var e=this.seekChild("box_btn"+t);e.award_tag=t,e.on(cc.Node.EventType.TOUCH_END,this.onClickAwardItem,this);var i=this.seekChild("box_"+t);this.times_awards[t].btn_nd=e,this.times_awards[t].root_nd=i,this.times_awards[t].num_lb=this.seekChild(i,"num",cc.Label),this.times_awards[t].item_sk=i.getComponent(sp.Skeleton),this.bool_box_status[t]=1}this.initTimeAwards()},registerEvent:function(){this.addGlobalEvent(a.UpdateLoopChallengeList,function(){this.updateChallengeList()}.bind(this)),this.addGlobalEvent(a.UpdateLoopChallengeTimesList,function(t){this.is_finish_awards&&this.updateTimesAwards()}.bind(this)),this.addGlobalEvent(a.UpdateArena_Number,function(){this.updageWidgets()}.bind(this)),this.addGlobalEvent(a.UpdateArenaRedStatus,function(){this.updateLogRedStatus()}.bind(this))},onShow:function(t){this.ctrl.sender20201(),this.initChallenteList(),this.updageWidgets()},onHide:function(){},onDelete:function(){this.challenge_sv&&(this.challenge_sv.deleteMe(),this.challenge_sv=null),this.award_item&&(this.award_item.deleteMe(),this.award_item=null);var e=t("guide_event");gcore.GlobalEvent.fire(e.CloseTaskEffect)},updageWidgets:function(){if(this.root_wnd){var t=this.loop_data=this.model.getMyLoopData();if(this.loop_data){this.rank_num_lb.string=t.rank+"\u540d",this.score_num_lb.string=t.score;var e=Config.arena_data.data_const.arena_ticketcost.val[0][0],i=this.bag_model.getBackPackItemNumByBid(e);if(this.has_num=t.can_combat_num+i,this.text_add_time_lb.string=i,this.free_num=t.can_combat_num,!this.times_item_sp.spriteFrame){var a=gdata("item_data","data_unit1",e,!1),o=s.getIconPath("item",a.icon);this.loadRes(o,function(t){this.times_item_sp.spriteFrame=t}.bind(this))}var l=this.less_time=t.end_time-gcore.SmartSocket.getTime();n.getTimeFormat(l),this.refresh_time=t.ref_time-gcore.SmartSocket.getTime();this.updateChallengeList(),this.updateLogRedStatus()}}},onClickProtectBtn:function(){var e=t("partner_const"),i=t("hero_const");t("hero_controller").getInstance().openFormGoFightPanel(!0,e.Fun_Form.Arena,null,i.FormShowType.eFormSave)},onClickRefreshBtn:function(){this.ctrl.sender20206()},onClickMyLogBtn:function(){this.ctrl.openArenaLoopMyLogWindow(!0)},update:function(t){if(this.less_time>0){this.less_time-=t;var e=n.getTimeFormat(Math.ceil(this.less_time));this.time_label_lb.string!==e&&(this.time_label_lb.string=e)}if(this.refresh_time>0){this.refresh_time-=t;var i=n.getTimeFormat(Math.ceil(this.refresh_time));this.ref_time_lb.string!==i&&(this.ref_time_lb.string=i),this.is_ref_status&&(this.is_ref_status=!1,this.updateRefTimeStatus(!1))}else this.is_ref_status||(this.is_ref_status=!0,this.updateRefTimeStatus(!0))},updateRefTimeStatus:function(t){t?(this.ref_title_nd.active=!0,this.ref_time_nd.active=!1,this.refresh_btn.interactable=!0):(this.ref_title_nd.active=!1,this.ref_time_nd.active=!0,this.refresh_btn.interactable=!1)},initTimeAwards:function(){this.finis_award=0;var t=this.award_cfg=Config.arena_data.data_season_num_reward;if(t){var e=1;for(var i in t){var n=t[i];this.times_awards[e].num_lb.string=n.num;var a=s.getEffectRes(this.item_eff[e]),o=s.getSpinePath(a);this.loadRes(o,function(t,e){this.times_awards[t].item_sk.skeletonData=e,this.times_awards[t].item_sk.setAnimation(0,"action1",!0),this.finis_award++,7==this.finis_award&&(this.is_finish_awards=!0,this.updateTimesAwards(),this.finis_award=0)}.bind(this,e)),e++}}},updateTimesAwards:function(){var t=this.times_awards_data=this.model.getChallengeTimesAwards();if(t){var e=cc.js.formatStr("(\u6311\u6218%s\u6b21)",t.had_combat_num);this.change_num_lb.string=e;var i=0;if(t.had_combat_num>=120)i=1;else for(var s=0,n=1/this.award_cfg.length,a=0;a<this.award_cfg.length;++a){var o=this.award_cfg[a];if(t.had_combat_num<o.num){i+=(t.had_combat_num-s)/(o.num-s)*n;break}s=o.num,i+=n}for(var l in this.box_bar_nd.progress=i,this.bool_box_status){var r=this.award_cfg[l-1];if(t.had_combat_num>=r.num){this.bool_box_status[l]=2;var c=t.num_list;for(var _ in c)if(c[_].num==r.num){this.bool_box_status[l]=3;break}}else this.bool_box_status[l]=1}for(var h in this.bool_box_status){var d="action1";2==this.bool_box_status[h]?d="action2":3==this.bool_box_status[h]&&(d="action3"),this.times_awards[h].item_sk.setAnimation(0,d,!0)}}},onClickAwardItem:function(t){var e=t.target.award_tag;2==this.bool_box_status[e]?this.ctrl.sender20209(this.award_cfg[e-1].num):1==this.bool_box_status[e]&&this.showRewardItems(e)},showRewardItems:function(t){this.tip_panel_nd.active=!0,this.tip_con_nd.x=this.times_awards[t].btn_nd.x;var e=this.award_cfg[t-1].items[0][0];this.award_item.setData(e);var i=this.award_cfg[t-1].items[0][1];this.item_num_lb.string="\xd7"+i},initChallenteList:function(){var t=this.list_container_nd.getContentSize(),e=cc.size(t.width,t.height),i={item_class:l,start_x:0,space_x:0,start_y:10,space_y:10,item_width:614,item_height:132,row:0,col:1,need_dynamic:!0};this.challenge_sv=new o,this.challenge_sv.createScroll(this.list_container_nd,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,e,i,cc.v2(0,.5))},updateChallengeList:function(){var t=this.model.getLoopChallengeList();this.challenge_sv.setData(t,this.onClickHeroExhibiton.bind(this),{has_num:this.has_num,free_num:this.free_num})},onClickHeroExhibiton:function(){},onClickAddBtn:function(){this.ctrl.openArenaLoopChallengeBuy(!0)},onClickTipPanel:function(){this.tip_panel_nd.active&&(this.tip_panel_nd.active=!1)},onClickShopBtn:function(){var e=t("mall_const");t("mall_controller").getInstance().openMallPanel(!0,e.MallType.ArenaShop)},updatePanelInfo:function(){this.updageWidgets()},updateLogRedStatus:function(){var t=this.model.getArenaLoopLogStatus();this.log_red_tips.active=!!t}});cc._RF.pop()},{arena_event:"arena_event",arena_loop_challenge_item:"arena_loop_challenge_item",backpack_controller:"backpack_controller",common_scrollview:"common_scrollview",guide_event:"guide_event",hero_const:"hero_const",hero_controller:"hero_controller",mall_const:"mall_const",mall_controller:"mall_controller",partner_const:"partner_const",pathtool:"pathtool",timetool:"timetool"}],arena_loop_challenge_vo:[function(t,e,i){"use strict";cc._RF.push(e,"e7751Y7k9BDRaulW1DRSOCR","arena_loop_challenge_vo");t("arena_loop_challenge_vo"),cc.Class({extends:gcore.BaseEvent,ctor:function(){this.idx=0,this.rid=0,this.srv_id="",this.name="",this.lev=0,this.sex=0,this.face=0,this.power=0,this.score=0,this.get_score=0,this.status=0},updatetAttributeData:function(t){if(t)for(var e in t)this.setAttribute(e,t[e])},setAttribute:function(t,e){this[t]!==e&&(this[t]=e)}});cc._RF.pop()},{arena_loop_challenge_vo:"arena_loop_challenge_vo"}],arena_loop_match_window:[function(t,e,i){"use strict";cc._RF.push(e,"df46bp/EuhKUKEeZaHeCXfO","arena_loop_match_window");var s=t("pathtool"),n=t("arena_event");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("arena","arena_loop_match_window"),this.viewTag=SCENE_TAG.ui,this.win_type=WinType.Full,this.rleasePrefab=!1,this.ctrl=arguments[0]},initConfig:function(){this.tab_index=null,this.tab_panels={}},openCallBack:function(){this.close_btn_nd=this.seekChild("close_btn"),this.container_nd=this.seekChild("container"),this.background=this.seekChild("background"),this.close_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickCloseBtn,this),this.loadRes(s.getBattleSingleBg("10005"),function(t){this.background.getComponent(cc.Sprite).spriteFrame=t}.bind(this)),this.tab_btns={};for(var t=1;t<=4;t++){this.tab_btns[t]={};var e=this.seekChild("tab_btn_"+t);this.tab_btns[t].normal_bg_nd=e.getChildByName("unselect_bg"),this.tab_btns[t].select_bg_nd=e.getChildByName("select_bg"),e.tab_index=t,e.on(cc.Node.EventType.TOUCH_END,this.onClickTabBtn,this)}this.tab_panels={},this.background.scale=FIT_SCALE},registerEvent:function(){this.addGlobalEvent(n.UpdateMyLoopData,function(){this.updateMyInfoData()}.bind(this))},openRootWnd:function(t){this.updateWidgets(),this.updateTap(1)},closeCallBack:function(){for(var e in this.tab_panels)this.tab_panels[e]&&this.tab_panels[e].deleteMe();var i=t("guide_event");gcore.GlobalEvent.fire(i.CloseTaskEffect),this.ctrl.openArenaLoopMathWindow(!1)},updateWidgets:function(){},updateTap:function(e){if(this.tab_index!=e){if(this.tab_index&&(this.tab_btns[this.tab_index].normal_bg_nd.active=!0,this.tab_btns[this.tab_index].select_bg_nd.active=!1,this.tab_panels[this.tab_index].setVisible(!1)),this.tab_btns[e].normal_bg_nd.active=!1,this.tab_btns[e].select_bg_nd.active=!0,this.tab_panels[e])this.tab_panels[e].setVisible(!0);else{var i=null;switch(e){case 1:i=new(t("arena_loop_challenge_panel"))(this.ctrl);break;case 2:i=new(t("arena_loop_rank_panel"))(this.ctrl);break;case 3:i=new(t("arena_loop_activity_panel"))(this.ctrl);break;case 4:i=new(t("arena_loop_awards_panel"))(this.ctrl)}i&&(i.setParent(this.container_nd),i.show(),this.tab_panels[e]=i)}this.tab_index=e}},onClickCloseBtn:function(){this.ctrl.openArenaEnterWindow(!0),this.ctrl.openArenaLoopMathWindow(!1)},onClickTabBtn:function(t){var e=t.target.tab_index;this.updateTap(e)},updateMyInfoData:function(){this.tab_index&&this.tab_panels[this.tab_index]&&this.tab_panels[this.tab_index].updatePanelInfo()}});cc._RF.pop()},{arena_event:"arena_event",arena_loop_activity_panel:"arena_loop_activity_panel",arena_loop_awards_panel:"arena_loop_awards_panel",arena_loop_challenge_panel:"arena_loop_challenge_panel",arena_loop_rank_panel:"arena_loop_rank_panel",guide_event:"guide_event",pathtool:"pathtool"}],arena_loop_my_log_item:[function(t,e,i){"use strict";cc._RF.push(e,"e5612BfZ4hM2ZR697gDpqGX","arena_loop_my_log_item");var s=t("pathtool"),n=t("playerhead"),a=t("role_controller"),o=t("timetool");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("arena","arena_loop_my_log_item")},initConfig:function(){this.role_vo=a.getInstance().getRoleVo(),this.score_iocn=Config.arena_data.data_const.score_iocn},initPanel:function(){this.left_role_nd=this.seekChild("left_role"),this.right_role_nd=this.seekChild("right_role"),this.down_arrow_nd=this.seekChild("down_arrow"),this.up_arrow_nd=this.seekChild("up_arrow"),this.score_item_sp=this.seekChild("score_item",cc.Sprite),this.fight_result_nd=this.seekChild("fight_result"),this.fight_result_lb=this.seekChild("fight_result",cc.Label),this.arrow_con_nd=this.seekChild("arrow_con"),this.check_fight_btn_nd=this.seekChild("check_fight_btn"),this.right_name_lb=this.seekChild("right_name",cc.Label),this.left_name_lb=this.seekChild("left_name",cc.Label),this.fight_type_lb=this.seekChild("fight_type",cc.Label),this.time_lb=this.seekChild("time",cc.Label),this.success_img_nd=this.seekChild("success_img"),this.faild_img_nd=this.seekChild("faild_img"),this.left_head=new n,this.left_head.setParent(this.left_role_nd),this.left_head.show(),this.right_head=new n,this.right_head.setParent(this.right_role_nd),this.right_head.show(),this.check_fight_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickFightBtn,this)},registerEvent:function(){},onShow:function(t){this.updateWidgets()},onHide:function(){},onDelete:function(){this.left_head&&(this.left_head.deleteMe(),this.left_head=null),this.right_head&&(this.right_head.deleteMe(),this.right_head=null)},setData:function(t){this.data=t,this.root_wnd&&this.updateWidgets()},updateWidgets:function(){if(this.data){this.left_head.setHeadRes(this.role_vo.face_id),this.right_head.setHeadRes(this.data.face),this.left_name_lb.string=this.role_vo.name,this.right_name_lb.string=this.data.name,1===this.data.ret?(this.success_img_nd.active=!0,this.faild_img_nd.active=!1):(this.success_img_nd.active=!1,this.faild_img_nd.active=!0);var t="";t=1===this.data.type?1===this.data.ret?Utils.TI18N("\u8fdb\u653b\u6210\u529f"):Utils.TI18N("\u8fdb\u653b\u5931\u8d25"):1===this.data.ret?Utils.TI18N("\u9632\u5b88\u6210\u529f"):Utils.TI18N("\u9632\u5b88\u5931\u8d25"),this.fight_type_lb.string=t,this.time_lb.string=o.getYMDHMS(this.data.time);var e="";if(this.score_iocn){0===this.data.score?(e=Utils.TI18N("\u4e0d\u53d8"),this.score_item_sp.spriteFrame=null,this.arrow_con_nd.active=!1):1==this.data.ret?(this.up_arrow_nd.active=!0,this.down_arrow_nd.active=!1,this.fight_result_nd.color=(new cc.Color).fromHEX("#249003"),e="+"+this.data.score):(this.up_arrow_nd.active=!1,this.down_arrow_nd.active=!0,this.fight_result_nd.color=(new cc.Color).fromHEX("#e14737"),e=this.data.score),this.fight_result_lb.string=e;var i=s.getIconPath("item",this.score_iocn.val);this.loadRes(i,function(t){this.score_item_sp.spriteFrame=t}.bind(this))}else this.score_item_sp.spriteFrame=null,this.arrow_con_nd.active=!1}},onClickFightBtn:function(){this.data&&t("battle_controller").getInstance().csRecordBattle(this.data.replay_id)}});cc._RF.pop()},{battle_controller:"battle_controller",pathtool:"pathtool",playerhead:"playerhead",role_controller:"role_controller",timetool:"timetool"}],arena_loop_my_log_window:[function(t,e,i){"use strict";cc._RF.push(e,"3052fTGrelJ3oxYh1WtsGG5","arena_loop_my_log_window");var s=t("pathtool"),n=t("common_scrollview"),a=t("arena_event");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("arena","arena_loop_my_log_window"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Full,this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){},openCallBack:function(){this.close_btn_nd=this.seekChild("close_btn"),this.mask_nd=this.seekChild("mask"),this.background_nd=this.seekChild("background"),this.list_panel_nd=this.seekChild("list_panel"),this.empty_tips_nd=this.seekChild("empty_tips"),this.background_nd.scale=FIT_SCALE,this.close_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickCloseBtn,this),this.mask_nd.on(cc.Node.EventType.TOUCH_END,this.onClickCloseBtn,this),this.initItenList()},registerEvent:function(){this.addGlobalEvent(a.UpdateMylogListEvent,function(t){t&&this.updateChallengeList(t)}.bind(this))},openRootWnd:function(t){this.ctrl.sender20222(),this.model.updateArenaLoopLogStatus(!1)},closeCallBack:function(){this.my_log_sv&&(this.my_log_sv.deleteMe(),this.my_log_sv=null),this.ctrl.openArenaLoopMyLogWindow(!1)},initItenList:function(){var e=t("arena_loop_my_log_item"),i=this.list_panel_nd.getContentSize(),s=cc.size(i.width,i.height),a={item_class:e,start_x:4,space_x:0,start_y:0,space_y:0,item_width:600,item_height:136,row:0,col:1,need_dynamic:!0};this.my_log_sv=new n,this.my_log_sv.createScroll(this.list_panel_nd,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,s,a,cc.v2(.5,.5))},onClickCloseBtn:function(){this.ctrl.openArenaLoopMyLogWindow(!1)},updateChallengeList:function(t){0==t.length?this.empty_tips_nd.active=!0:(this.my_log_sv.setData(t),this.empty_tips_nd.active=!1)}});cc._RF.pop()},{arena_event:"arena_event",arena_loop_my_log_item:"arena_loop_my_log_item",common_scrollview:"common_scrollview",pathtool:"pathtool"}],arena_loop_rank_panel:[function(t,e,i){"use strict";cc._RF.push(e,"63fb0ldwLdJXYPjJkvIh4TV","arena_loop_rank_panel");var s=t("pathtool"),n=t("arean_loop_rank_item"),a=t("arena_event"),o=t("common_scrollview"),l=t("playerhead"),r=t("role_event");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("arena","arena_loop_rank_panel"),this.ctrl=arguments[0]},initConfig:function(){var e=t("role_controller");this.role_vo=e.getInstance().getRoleVo()},initPanel:function(){this.container_nd=this.seekChild("item_container"),this.role_name_lb=this.seekChild("role_name",cc.Label),this.role_power_lb=this.seekChild("role_power",cc.Label),this.wish_num_lb=this.seekChild("wish_num",cc.Label),this.rank_img_nd=this.seekChild("rank_img"),this.rank_img_sp=this.seekChild("rank_img",cc.Sprite),this.rank_txt_nd=this.seekChild("rank_txt"),this.rank_txt_ct=this.rank_txt_nd.getComponent("CusRichText"),this.head_nd=this.seekChild("head"),this.duanwei_num_bl=this.seekChild("duanwei_num",cc.Label),this.role_head=new l,this.role_head.setParent(this.head_nd),this.role_head.show(),this.initRankList()},registerEvent:function(){this.addGlobalEvent(a.UpdateLoopChallengeRank,function(t){t&&(this.rank_data=t,this.updateRankList(),this.updateWidgets())}.bind(this)),this.addGlobalEvent(r.WorshipOtherRole,function(t){t&&this.updateOtherWorship(t)}.bind(this))},onShow:function(t){this.ctrl.sender20221()},onHide:function(){},onDelete:function(){this.role_head&&(this.role_head.deleteMe(),this.role_head=null),this.rank_sv&&(this.rank_sv.deleteMe(),this.rank_sv=null)},initRankList:function(){var t=this.container_nd.getContentSize(),e=cc.size(t.width,t.height),i={item_class:n,start_x:0,space_x:0,start_y:10,space_y:0,item_width:614,item_height:125,row:0,col:1,need_dynamic:!0};this.rank_sv=new o,this.rank_sv.createScroll(this.container_nd,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,e,i,cc.v2(0,.5))},updateRankList:function(){var t=this.rank_list=this.rank_data.rank_list;this.rank_sv.setData(t)},updateWidgets:function(){if(this.root_wnd){if(this.rank_data.rank>0&&this.rank_data.rank<=3){this.rank_img_nd.active=!0,this.rank_txt_nd.active=!1;var t=s.getUIIconPath("common","common_200"+this.rank_data.rank);this.loadRes(t,function(t){this.rank_img_sp.spriteFrame=t}.bind(this))}else this.rank_data.rank>3?(this.rank_img_nd.active=!1,this.rank_txt_nd.active=!0,this.rank_txt_ct.setNum(this.rank_data.rank)):(this.rank_img_nd.active=!1,this.rank_txt_nd.active=!1);this.role_name_lb.string=this.role_vo.name,this.role_power_lb.string=this.role_vo.power,this.wish_num_lb.string=this.rank_data.worship,this.duanwei_num_bl.string=this.rank_data.score,this.role_head.setHeadRes(this.role_vo.face_id),this.role_head.setLev(this.role_vo.lev)}},updateOtherWorship:function(t){var e=t.idx-1,i=this.rank_list[e];i.worship+=1,i.worship_status=1,this.rank_sv.updateItemData(e,i)},updatePanelInfo:function(){this.updateWidgets()}});cc._RF.pop()},{arean_loop_rank_item:"arean_loop_rank_item",arena_event:"arena_event",common_scrollview:"common_scrollview",pathtool:"pathtool",playerhead:"playerhead",role_controller:"role_controller",role_event:"role_event"}],arena_loop_result_window:[function(t,e,i){"use strict";cc._RF.push(e,"0d221IR0MNFFZDrG7Ce0/mJ","arena_loop_result_window");var s=t("pathtool"),n=t("mainui_controller"),a=t("playerhead"),o=t("role_controller"),l=t("mainui_const"),r=t("arena_controller");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("arena","arena_loop_result_window"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Tips,this.ctrl=arguments[0]},initConfig:function(){this.role_vo=o.getInstance().getRoleVo(),this.score_iocn=Config.arena_data.data_const.score_iocn},openCallBack:function(){this.confirm_btn_nd=this.seekChild("confirm_btn"),this.cancel_btn_nd=this.seekChild("cancel_btn"),this.mask_nd=this.seekChild("mask"),this.background_nd=this.seekChild("background"),this.top_head_nd=this.seekChild("top_head"),this.bottom_head_nd=this.seekChild("bottom_head"),this.success_bg_nd=this.seekChild("success_bg"),this.fail_bg_nd=this.seekChild("fail_bg"),this.top_name_lb=this.seekChild("top_name",cc.Label),this.bottom_name_lb=this.seekChild("bottom_name",cc.Label),this.top_sk_node=this.seekChild("title_container"),this.top_sk=this.seekChild("title_container",sp.Skeleton),this.items_con_nd=this.seekChild("items_con"),this.top_item_img_sp=this.seekChild("top_item_img",cc.Sprite),this.top_score_val_lb=this.seekChild("top_score_val",cc.Label),this.top_score_val_nd=this.seekChild("top_score_val"),this.top_fight_result_lb=this.seekChild("top_fight_result",cc.Label),this.top_fight_result_nd=this.seekChild("top_fight_result"),this.top_down_arrow_nd=this.seekChild("top_down_arrow"),this.top_up_arrow_nd=this.seekChild("top_up_arrow"),this.bottom_item_img_sp=this.seekChild("bottom_item_img",cc.Sprite),this.bottom_score_val_lb=this.seekChild("bottom_score_val",cc.Label),this.bottom_score_val_nd=this.seekChild("bottom_score_val"),this.bottom_fight_result_lb=this.seekChild("bottom_fight_result",cc.Label),this.bottom_fight_result_nd=this.seekChild("bottom_fight_result"),this.bottom_down_arrow_nd=this.seekChild("bottom_down_arrow"),this.bottom_up_arrow_nd=this.seekChild("bottom_up_arrow"),this.harm_nd=this.seekChild("harm_btn"),this.top_head=new a,this.top_head.setParent(this.top_head_nd),this.top_head.setScale(.8),this.top_head.show(),this.bottom_head=new a,this.bottom_head.setParent(this.bottom_head_nd),this.bottom_head.setScale(.8),this.bottom_head.show(),this.background_nd.scale=FIT_SCALE,this.confirm_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickCloseBtn,this),this.cancel_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickCancelBtn,this),this.mask_nd.on(cc.Node.EventType.TOUCH_END,this.onClickCloseBtn,this)},registerEvent:function(){this.harm_nd.on("click",function(){(Utils.playButtonSound(1),this.data)&&t("battle_controller").getInstance().openBattleHarmInfoView(!0,this.data)},this)},openRootWnd:function(t){Utils.playButtonSound("c_arenasettlement"),this.data=t,this.updateWidgets()},closeCallBack:function(){if(this._backpack_item_list)for(var t in this._backpack_item_list)this._backpack_item_list[t].deleteMe();this.ctrl.openLoopResultWindow(!1)},onClickCloseBtn:function(){Utils.playButtonSound(1),this.ctrl.openLoopResultWindow(!1)},onClickCancelBtn:function(){Utils.playButtonSound(1),this.ctrl.openLoopResultWindow(!1),null==r.getInstance().getArenaRoot()&&n.getInstance().changeMainUIStatus(l.btn_index.main_scene,l.sub_type.arena_call)},updateWidgets:function(){if(this.data){var t=this.data;if(this.top_head.setHeadRes(this.role_vo.face_id),this.top_head.setLev(this.role_vo.lev),this.bottom_head.setHeadRes(this.data.tar_face),this.bottom_head.setLev(this.data.tar_lev),this.top_name_lb.string=this.role_vo.name,this.bottom_name_lb.string=this.data.tar_name,this.score_iocn){var e=s.getIconPath("item",this.score_iocn.val);this.loadRes(e,function(t){this.top_item_img_sp.spriteFrame=t,this.bottom_item_img_sp.spriteFrame=t}.bind(this))}this.top_score_val_lb.string=t.score,this.bottom_score_val_lb.string=t.tar_score;0!==t.get_score&&(1===t.result?(this.top_up_arrow_nd.active=!0,this.top_score_val_nd.color=(new cc.Color).fromHEX("#ffcc00"),this.top_fight_result_nd.color=(new cc.Color).fromHEX("#ffcc00")):(this.top_down_arrow_nd.active=!0,this.top_score_val_nd.color=(new cc.Color).fromHEX("#e14737"),this.top_fight_result_nd.color=(new cc.Color).fromHEX("#ff3a3a")),this.top_fight_result_lb.string=Math.abs(t.get_score));0!==t.lose_score&&(1===t.result?(this.bottom_down_arrow_nd.active=!0,this.bottom_score_val_nd.color=(new cc.Color).fromHEX("#ffffff"),this.bottom_fight_result_nd.color=(new cc.Color).fromHEX("#ff3a3a")):(this.bottom_up_arrow_nd.active=!0,this.bottom_score_val_nd.color=(new cc.Color).fromHEX("#ffffff"),this.bottom_fight_result_nd.color=(new cc.Color).fromHEX("#ffcc00")),this.bottom_fight_result_lb.string=Math.abs(t.lose_score)),this.updateRewardList(),this.handleEffect()}},updateRewardList:function(){if(this._backpack_item_list=[],this.data&&this.data.items)for(var t in this.data.items){var e=this.data.items[t],i=new cc.Node;i.setContentSize(130,130),this.items_con_nd.addChild(i);var s=ItemsPool.getInstance().getItem("backpack_item");s.setParent(i),s.setExtendData({scale:.8}),s.show(),s.setData(e),this._backpack_item_list.push(s)}},handleEffect:function(t){var e=103,i=890,n=PlayerAction.action_2;2===this.data.result&&(i=930,e=104,n=PlayerAction.action),this.top_sk_node.y=i;var a=s.getEffectRes(e),o=s.getSpinePath(a,"action");this.loadRes(o,function(t){this.top_sk.skeletonData=t,this.top_sk.setAnimation(0,n,!1)}.bind(this))}});cc._RF.pop()},{arena_controller:"arena_controller",battle_controller:"battle_controller",mainui_const:"mainui_const",mainui_controller:"mainui_controller",pathtool:"pathtool",playerhead:"playerhead",role_controller:"role_controller"}],arena_model:[function(t,e,i){"use strict";cc._RF.push(e,"96a6c/OkeZJu4NhjPlRHfom","arena_model");var s=t("arena_event"),n=t("arena_loop_challenge_vo"),a=t("arena_const");cc.Class({extends:BaseClass,ctor:function(){},properties:{},initConfig:function(){this.my_loop_data=null,this.times_awards=null,this.loop_challenge_list=null,this.arena_loop_red_list={},this.had_combat_num=0},updateMyLoopData:function(t){this.my_loop_data=t,gcore.GlobalEvent.fire(s.UpdateMyLoopData),this.updateArenaRedStatus(a.red_type.loop_challenge,t.can_combat_num>0)},getMyLoopData:function(){return this.my_loop_data},updateChallengeTimesAwards:function(t){this.times_awards=t;var e={};for(var i in this.had_combat_num=t.had_combat_num||0,Config.arena_data.data_season_num_reward){var n=Config.arena_data.data_season_num_reward[i];if(e[i]=0,t.had_combat_num&&n.num<=t.had_combat_num)for(var o in e[i]=1,t.num_list){t.num_list[o].num==n.num&&(e[i]=2)}}var l=!1;for(var r in e)if(1===e[r]){l=!0;break}this.updateArenaRedStatus(a.red_type.loop_reward,l),gcore.GlobalEvent.fire(s.UpdateLoopChallengeTimesList,t)},getChallengeTimesAwards:function(){return this.times_awards},updateLoopChallengeList:function(t){if(this.loop_challenge_list||1!==t.type){for(var e in this.loop_challenge_list||(this.loop_challenge_list={}),t.f_list)this.loop_challenge_list[t.f_list[e].idx]||(this.loop_challenge_list[t.f_list[e].idx]=new n),this.loop_challenge_list[t.f_list[e].idx].updatetAttributeData(t.f_list[e]);0===t.type&&gcore.GlobalEvent.fire(s.UpdateLoopChallengeList)}},getLoopChallengeList:function(){var t=[];for(var e in this.loop_challenge_list)t.push(this.loop_challenge_list[e]);return t},cleanChallengeList:function(){this.loop_challenge_list=null},getZoneConfigBySoure:function(t){t=t||this.my_loop_data.score;var e=null,i=Config.arena_data.data_cup[0];if(!t||t<i.min_score)e=i;else for(var s in Config.arena_data.data_cup)if(Config.arena_data.data_cup[s].min_score<=t&&t<=Config.arena_data.data_cup[s].max_score){e=Config.arena_data.data_cup[s];break}return e},updateArenaRedStatus:function(e,i){if(this.arena_loop_red_list[e]!==i){this.arena_loop_red_list[e]=i;var n=t("scene_const");t("mainscene_controller").getInstance().setBuildRedStatus(n.CenterSceneBuild.arena,{bid:e,status:i}),gcore.GlobalEvent.fire(s.UpdateArenaRedStatus,e)}},updateArenaLoopLogStatus:function(t){this.updateArenaRedStatus(a.red_type.loop_log,!!t)},getHadCombatNum:function(){return this.had_combat_num||0},getArenaLoopLogStatus:function(){return this.arena_loop_red_list[a.red_type.loop_log]}});cc._RF.pop()},{arena_const:"arena_const",arena_event:"arena_event",arena_loop_challenge_vo:"arena_loop_challenge_vo",mainscene_controller:"mainscene_controller",scene_const:"scene_const"}],artifact_award_window:[function(t,e,i){"use strict";cc._RF.push(e,"9a860cYdWJKhYDaL1wlolBh","artifact_award_window");var s=t("pathtool"),n=t("hero_controller");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("forgehouse","artifact_award_window"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Mini},initConfig:function(){this.ctrl=n.getInstance()},openCallBack:function(){this.background=this.seekChild("background"),this.background.scale=FIT_SCALE;var t=this.seekChild("main_panel"),e=this.seekChild(t,"main_container");this.close_btn=this.seekChild("close_btn"),this.ok_btn=this.seekChild("ok_btn"),this.ok_btn_btn=this.ok_btn.getComponent(cc.Button),this.ok_btn_lb=this.seekChild(this.ok_btn,"label",cc.Label),this.ok_btn_lo=this.seekChild(this.ok_btn,"label",cc.LabelOutline),this.ok_btn_lb.string=Utils.TI18N("\u9886\u53d6");var i=this.seekChild(e,"content_label",cc.Label),s=Config.partner_artifact_data.data_artifact_const.change_condition,n=Config.partner_artifact_data.data_artifact_const.change_gift;if(s&&n&&n.val&&n.val[0]){var a=n.val[0][0],o=n.val[0][1],l=Utils.getItemConfig(a);l&&(this.award_item_bid=a,i.string=cc.js.formatStr(Utils.TI18N("\u7194\u70bc\u503c\u8fbe\u5230%s\u70b9\u540e\u53ef\u9886\u53d6[%s]x%s"),s.val,l.name,o),this.award_item||(this.award_item=ItemsPool.getInstance().getItem("backpack_item"),this.award_item.initConfig(!1,1,!1,!0),this.award_item.addCallBack(this._onClickItemCallBack.bind(this)),this.award_item.setData({bid:a,num:o}),this.award_item.setPosition(0,-20),this.award_item.show(),this.award_item.setParent(e)))}},registerEvent:function(){Utils.onTouchEnd(this.close_btn,function(){this.ctrl.openArtifactAwardWindow(!1)}.bind(this),2),Utils.onTouchEnd(this.background,function(){this.ctrl.openArtifactAwardWindow(!1)}.bind(this),2),this.ok_btn.on("click",function(){this.ctrl.sender11038(),this.ctrl.openArtifactAwardWindow(!1),Utils.playButtonSound(1)},this)},_onClickItemCallBack:function(){this.award_item_bid&&this.ctrl.openArtifactComTipsWindow(!0,this.award_item_bid)},openRootWnd:function(t){this.refreshBtnStatus()},refreshBtnStatus:function(){var t=this.ctrl.getModel().getArtifactLucky(),e=0,i=Config.partner_artifact_data.data_artifact_const.change_condition;i&&i.val&&(e=i.val),t>=e?(Utils.setGreyButton(this.ok_btn_btn,!1),this.ok_btn_lo.enabled=!0):(Utils.setGreyButton(this.ok_btn_btn,!0),this.ok_btn_lo.enabled=!1)},closeCallBack:function(){this.ctrl.openArtifactAwardWindow(!1),this.award_item&&(this.award_item.deleteMe(),this.award_item=null)}});cc._RF.pop()},{hero_controller:"hero_controller",pathtool:"pathtool"}],artifact_chose_window:[function(t,e,i){"use strict";cc._RF.push(e,"82f3fWeEo9AuarN8tS+8+T3","artifact_chose_window");var s=t("pathtool"),n=t("common_scrollview"),a=t("hero_controller"),o=t("hero_event"),l=t("backpack_controller"),r=t("backpack_const"),c=t("partner_const"),_=t("goods_vo");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("hero","artifact_chose_window"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Mini},initConfig:function(){this.chose_num=0,this.ctrl=a.getInstance()},openCallBack:function(){this.background=this.seekChild("background"),this.main_container=this.seekChild("main_container"),this.chose_lb=this.seekChild("chose_label",cc.Label),this.chose_lb.string=cc.js.formatStr(Utils.TI18N("(\u5df2\u9009\u62e9:%d)"),this.chose_num),this.ok_btn=this.seekChild("ok_btn"),this.close_btn=this.seekChild("close_btn"),this.empty_bg_sp=this.seekChild("empty_bg",cc.Sprite),this.empty_bg_sp.node.active=!1;var t=this.seekChild(this.main_container,"goods_con"),e=t.getContentSize(),i=cc.size(e.width,e.height-10),s={item_class:"backpack_item",start_x:15,space_x:20,start_y:0,space_y:10,item_width:BackPackItem.Width,item_height:BackPackItem.Height,row:0,col:4,need_dynamic:!0};this.item_scrollview=new n,this.item_scrollview.createScroll(t,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,i,s,cc.v2(.5,.5))},registerEvent:function(){Utils.onTouchEnd(this.close_btn,function(){this.ctrl.openArtifactChoseWindow(!1)}.bind(this),2),Utils.onTouchEnd(this.background,function(){this.ctrl.openArtifactChoseWindow(!1)}.bind(this),2),Utils.onTouchEnd(this.ok_btn,function(){this._onClickBtnOk()}.bind(this),1)},_onClickBtnOk:function(){var e=!1,i=[];for(var s in this.item_data){var n=this.item_data[s];null!=n.showSellStatus&&1==n.showSellStatus.select&&(n.enchant>=3&&(e=!0),i.push(n.id))}var a=function(){gcore.GlobalEvent.fire(o.Artifact_Chose_Event,i),this.ctrl.openArtifactChoseWindow(!1)}.bind(this);if(e){var l=Utils.TI18N("\u60a8\u9009\u62e9\u4e86\u9ad8\u661f\u7ea7\u7684\u7b26\u6587\u4f5c\u4e3a\u5347\u661f\u6750\u6599\uff0c\u662f\u5426\u7ee7\u7eed\uff1f");t("commonalert").show(l,Utils.TI18N("\u786e\u5b9a"),a,Utils.TI18N("\u53d6\u6d88"))}else a()},openRootWnd:function(t){this.setData(t)},setData:function(t){this.artifact_bid=t.bid,this.max_num=t.max_num||0,this.chose_list=t.chose_list||[],this.chose_num=Utils.getArrLen(this.chose_list),this.chose_lb.string=cc.js.formatStr(Utils.TI18N("(\u5df2\u9009\u62e9:%s/%s)"),this.chose_num,this.max_num);var e=l.getInstance().getModel().getAllBackPackArray(r.item_tab_type.SPECIAL),i=[];for(var n in e){var a=new _;a.initAttrData(e[n]),i.push(a)}var o=[];for(var n in i){var h=i[n];if(h&&h.config&&h.config.type==r.item_type.ARTIFACTCHIPS){var d=Config.partner_artifact_data.data_artifact_data[h.config.id];if(d&&0!=d.com_artifact){var u=!1;for(var m in this.chose_list)if(this.chose_list[m]==h.id){u=!0;break}h.setGoodsAttr("showSellStatus",{status:!0,select:u}),o.push(h)}}}o.sort(Utils.tableLowerSorter(["quality","id"])),this.item_data=o;var f=function(t){var e=t.getData();this.ctrl.openArtifactTipsWindow(!0,e,c.ArtifactTips.normal)}.bind(this);this.item_scrollview.setData(o,f,{showCheckBox:!0,checkBoxClickCallBack:this._onCheckBoxCallBack.bind(this),adjustCheckBoxPos:cc.v2(BackPackItem.Width-25,BackPackItem.Height-25)}),0==o.length?(this.empty_bg_sp.node.active=!0,this.loadRes(s.getUIIconPath("bigbg","bigbg_3"),function(t){this.empty_bg_sp.spriteFrame=t}.bind(this))):this.empty_bg_sp.node.active=!1},_onCheckBoxCallBack:function(t,e){var i=e.getData();if(1==t){if(!this.checkItemIsCanChose(i.config.id))return i.setGoodsAttr("showSellStatus",{status:!0,select:!1}),e.setCheckBoxStatus(!0,!1),void message(Utils.TI18N("\u8bf7\u9009\u62e9\u540c\u7c7b\u578b\u7b26\u6587"));if(this.chose_num>=this.max_num)return i.setGoodsAttr("showSellStatus",{status:!0,select:!1}),e.setCheckBoxStatus(!0,!1),void message(Utils.TI18N("\u5df2\u8fbe\u6700\u5927\u9009\u62e9\u6570\u91cf"))}if(1==t){this.chose_num=this.chose_num+1;var s=Config.partner_artifact_data.data_artifact_data[i.config.id];s&&s.com_artifact&&(this.artifact_bid=s.com_artifact)}else this.chose_num=this.chose_num-1,this.chose_num<=0&&(this.artifact_bid=0);this.chose_lb.string=cc.js.formatStr(Utils.TI18N("(\u5df2\u9009\u62e9:%s/%s)"),this.chose_num,this.max_num)},checkItemIsCanChose:function(t){var e=!1;if(this.artifact_bid&&0!=this.artifact_bid){var i=Config.partner_artifact_data.data_artifact_data[t];i&&i.com_artifact==this.artifact_bid&&(e=!0)}else e=!0;return e},closeCallBack:function(){for(var t in this.item_scrollview&&(this.item_scrollview.deleteMe(),this.item_scrollview=null),this.item_data){this.item_data[t].setGoodsAttr("showSellStatus",{status:!0,select:!1})}this.ctrl.openArtifactChoseWindow(!1)}});cc._RF.pop()},{backpack_const:"backpack_const",backpack_controller:"backpack_controller",common_scrollview:"common_scrollview",commonalert:"commonalert",goods_vo:"goods_vo",hero_controller:"hero_controller",hero_event:"hero_event",partner_const:"partner_const",pathtool:"pathtool"}],artifact_com_tips_window:[function(t,e,i){"use strict";cc._RF.push(e,"a4522O++/ZPzpryHle4Dvyk","artifact_com_tips_window");var s=t("pathtool"),n=t("hero_controller");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("hero","artifact_com_tips"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Tips},initConfig:function(){this.ctrl=n.getInstance()},openCallBack:function(){this.background=this.seekChild("background"),this.main_panel=this.seekChild("main_panel"),this.container=this.seekChild("container"),this.base_panel=this.seekChild("base_panel"),this.base_panel_sp=this.seekChild("base_panel",cc.Sprite),this.equip_item=ItemsPool.getInstance().getItem("backpack_item"),this.equip_item.initConfig(!1,1,!1,!1),this.equip_item.show(),this.equip_item.setPosition(-134,-70),this.equip_item.setParent(this.base_panel),this.name_lb=this.seekChild(this.base_panel,"name",cc.Label),this.equip_type_lb=this.seekChild("equip_type",cc.Label),this.baseattr_panel=this.seekChild("baseattr_panel"),this.attr_text_rt=this.seekChild("attr_text",cc.RichText),this.line=this.seekChild("line"),this.skill_panel=this.seekChild("skill_panel"),this.skill_text_rt=this.seekChild("skill_text",cc.RichText),this.close_btn=this.seekChild("close_btn")},registerEvent:function(){Utils.onTouchEnd(this.close_btn,function(){this.ctrl.openArtifactComTipsWindow(!1)}.bind(this),2),Utils.onTouchEnd(this.background,function(){this.ctrl.openArtifactComTipsWindow(!1)}.bind(this),2)},openRootWnd:function(t){this.artifact_bid=t,this.setBaseInfo(),this.setAttrAndSkillInfo()},setBaseInfo:function(){if(this.artifact_bid){var e=Utils.getItemConfig(this.artifact_bid);if(e){this.equip_item.setData({bid:this.artifact_bid,num:0});var i=0;e.quality>=0&&e.quality<=5&&(i=e.quality);var n=s.getUIIconPath("tips","tips_"+i);this.loadRes(n,function(t){this.base_panel_sp.spriteFrame=t}.bind(this));var a=t("backpack_const").getEquipTipsColor(i);this.name_lb.node.color=a,this.name_lb.string=e.name,this.equip_type_lb.string=Utils.TI18N("\u7c7b\u578b\uff1a")+e.type_desc}}},setAttrAndSkillInfo:function(){if(this.artifact_bid){var t=Config.partner_artifact_data.data_artifact_data[this.artifact_bid];if(t){this.attr_text_rt.string=t.arrt_desc||"",this.skill_text_rt.string=t.skill_desc||"";var e=this.container.getContentSize(),i=this.base_panel.getContentSize(),s=50;s+=this.attr_text_rt.node.getContentSize().height;var n=50;n+=this.skill_text_rt.node.getContentSize().height;e.height=4+i.height+s+10+n+20,this.container.setContentSize(e),this.base_panel.y=e.height-4,this.baseattr_panel.y=e.height-4-i.height,this.skill_panel.y=20+n+20,this.close_btn.y=e.height-25}}},closeCallBack:function(){this.equip_item&&(this.equip_item.deleteMe(),this.equip_item=null),this.ctrl.openArtifactComTipsWindow(!1)}});cc._RF.pop()},{backpack_const:"backpack_const",hero_controller:"hero_controller",pathtool:"pathtool"}],artifact_list_item:[function(t,e,i){"use strict";cc._RF.push(e,"d6303W2SO1MuolS6Yx1jcqN","artifact_list_item");var s=t("pathtool"),n=t("hero_controller"),a=t("partner_calculate");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("hero","artifact_list_item"),this.index=arguments[0],null==this.index&&(this.index=1)},initConfig:function(){this.skill_list={},this.attr_list={},this.config_list={},this.ctrl=n.getInstance()},initPanel:function(){this.bg=this.seekChild("bg"),this.artifact_item=ItemsPool.getInstance().getItem("backpack_item"),this.artifact_item.initConfig(!1,.8,!1,!1),this.artifact_item.show(),this.artifact_item.setPosition(-220,0),this.artifact_item.setParent(this.root_wnd),this.equip_btn=this.seekChild("equip_btn"),this.equip_sp=this.seekChild("equip_btn",cc.Sprite)},registerEvent:function(){Utils.onTouchEnd(this.equip_btn,function(){this.call_fun&&this.call_fun(this.vo)}.bind(this),1)},setData:function(t){this.data=t,this.root_wnd&&this.onShow()},onShow:function(t){var e=this;if(null!=this.data){this.vo=this.data;var i=this.data;if(this.artifact_item.setData({bid:i.config.id,num:0}),i.config){for(var n in null!=this.partner_id&&0!=this.partner_id?this.loadRes(s.getCommonIcomPath("txt_cn_common_90011"),function(t){this.equip_sp.spriteFrame=t}.bind(this)):this.loadRes(s.getCommonIcomPath("txt_cn_common_90015"),function(t){this.equip_sp.spriteFrame=t}.bind(this)),this.attr_list)this.attr_list[n]&&(this.attr_list[n].string="");var o=i.attr,l=2,r=Config.partner_artifact_data.data_artifact_data[i.config.id];l=2;for(var n in r&&(l=r.attr_num),o){var c=o[n];if(n>l)break;var _,h,d=c.attr_id,u=Config.attr_data.data_id_to_key[d],m=c.attr_val/1e3,f=Config.attr_data.data_key_to_name[u];if(f)(function(){e.attr_list[n]||(e.attr_list[n]=Utils.createRichLabel(22,new cc.Color(193,183,171,255),cc.v2(0,.5),cc.v2(20,28),24,400,e.bg),e.attr_list[n].horizontalAlign=cc.macro.TextAlignment.LEFT);var t=e.attr_list[n];t.node.setPosition(cc.v2(170*n-145,23)),_=s.getAttrIconByStr(u),1==a.isShowPerByStr(u)&&(m=m/10+"%"),h=cc.js.formatStr("<img src='%s' /> <color=#68452a> %s\uff1a</c><color=#68452a>%s</c>",_,f,m),t.string=h,e.loadRes(s.getUIIconPath("common",_),function(e){t.spriteFrame=e}.bind(e))})()}for(var p in this.skill_list)this.skill_list[p]&&(this.skill_list[p].string="");var g=i.extra||{};for(var n in g){if((c=g[n])&&c.extra_k&&(1==c.extra_k||2==c.extra_k||8==c.extra_k)){var v=c.extra_v||0,b=gdata("skill_data","data_get_skill",[v]);this.config_list[n]=b,this.skill_list[n]||(this.skill_list[n]=Utils.createRichLabel(22,new cc.Color(118,69,25,255),cc.v2(0,0),cc.v2(110,35),24,136,this.bg),this.skill_list[n].horizontalAlign=cc.macro.TextAlignment.LEFT,this.touchFunc(this.skill_list[n].node,n));var w="";b&&(w=cc.js.formatStr("\u3010<u>%s</u>\u3011",b.name));var y=this.skill_list[n];y.node.setPosition(cc.v2(120*n-155,-32)),y.string=w}}}}},touchFunc:function(e,i){e.on(cc.Node.EventType.TOUCH_END,function(){this.config_list&&this.config_list[i]&&t("tips_controller").getInstance().showSkillTips(this.config_list[i])},this)},addCallBack:function(t){this.call_fun=t},setExtendData:function(t){this.partner_id=t},isHaveData:function(){return!!this.vo},onHide:function(){},onDelete:function(){this.artifact_item&&(this.artifact_item.deleteMe(),this.artifact_item=null)}});cc._RF.pop()},{hero_controller:"hero_controller",partner_calculate:"partner_calculate",pathtool:"pathtool",tips_controller:"tips_controller"}],artifact_list_window:[function(t,e,i){"use strict";cc._RF.push(e,"4573ftXh6VL+6kOiktkE4YK","artifact_list_window");var s=t("pathtool"),n=t("common_scrollview"),a=t("artifact_list_item"),o=t("backpack_const"),l=t("hero_controller"),r=t("backpack_controller"),c=t("hero_event");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("hero","artifact_list_panel"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Big},initConfig:function(){this.ctrl=l.getInstance()},openCallBack:function(){this.background=this.seekChild("background"),this.main_panel=this.seekChild("main_panel"),this.bg=this.seekChild(this.main_panel,"bg"),this.close_btn=this.seekChild("close_btn"),this.source_btn=this.seekChild("source_btn");var t=this.bg.getContentSize(),e=cc.size(t.width-10,t.height-10),i={item_class:a,start_x:0,space_x:0,start_y:0,space_y:0,item_width:600,item_height:135,row:0,col:1,need_dynamic:!0};this.order_scrollview=new n,this.order_scrollview.createScroll(this.bg,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,e,i,cc.v2(.5,.5))},registerEvent:function(){Utils.onTouchEnd(this.background,function(){this.ctrl.openArtifactListWindow(!1)}.bind(this),2),Utils.onTouchEnd(this.close_btn,function(){this.ctrl.openArtifactListWindow(!1)}.bind(this),2),Utils.onTouchEnd(this.source_btn,function(){var t=0;null!=Config.partner_artifact_data.data_artifact_const.main_shenqi&&(t=Config.partner_artifact_data.data_artifact_const.main_shenqi.val);var e=Utils.getItemConfig(t);e&&r.getInstance().openTipsSource(!0,e)}.bind(this),1),this.addGlobalEvent(EventId.ADD_GOODS,function(t,e){t==o.Bag_Code.BACKPACK&&this.createArtifactList()},this),this.addGlobalEvent(EventId.MODIFY_GOODS_NUM,function(t,e){t==o.Bag_Code.BACKPACK&&this.createArtifactList()},this)},openRootWnd:function(t){this.artifact_type=t.artifact_type,null==t.artifact_type&&(this.artifact_type=1),this.partner_id=t.partner_id||0,this.select_vo=t.select_vo,this.createArtifactList()},createArtifactList:function(){var t=r.getInstance().getModel().getAllBackPackArray(o.item_tab_type.SPECIAL),e=Utils.deepCopy(t),i=[],s=1;for(var n in this.select_id=0,this.select_vo&&null!=this.select_vo.id&&(this.select_id=this.select_vo.id||0),e){(_=e[n])&&_.config&&_.config.type==o.item_type.ARTIFACTCHIPS&&this.select_id!=_.id&&(this.artifact_type,i[s]=_,s+=1)}this.showEmptyIcon(!1),i&&null!=Utils.next(i)||this.showEmptyIcon(!0);var a=this.ctrl.getModel().getHeroById(this.partner_id);if(this.is_cloth=!1,a&&null!=Utils.next(a)){var l=a.artifact_list||{};for(var n in l){var _;(_=l[n])&&_.id&&null!=_.artifact_pos&&_.artifact_pos==this.artifact_type&&(this.is_cloth=!0)}}var h=function(t){t&&null!=Utils.next(t)&&(this.partner_id&&0!=this.partner_id?this.ctrl.sender11030(this.partner_id,this.artifact_type,t.id,1):gcore.GlobalEvent.fire(c.Artifact_Select_Event,t),this.ctrl.openArtifactListWindow(!1))}.bind(this);i.sort(function(t,e){return t.enchant!=e.enchant?e.enchant-t.enchant:t.config&&e.config?e.config.quality-t.config.quality:-1}),this.order_scrollview.setData(i,h,this.partner_id)},showEmptyIcon:function(t){if(this.empty_con||0!=t){if(!this.empty_con){var e=cc.size(200,200);this.empty_con=new cc.Node,this.empty_con.setContentSize(e),this.empty_con.setAnchorPoint(cc.v2(.5,.5)),this.empty_con.setPosition(cc.v2(0,0)),this.main_panel.addChild(this.empty_con);var i=s.getBigBg("bigbg_3");this.empty_bg=Utils.createImage(this.empty_con,null,0,0,cc.v2(.5,.5),!1),this.loadRes(i,function(t){this.empty_bg.spriteFrame=t}.bind(this)),this.empty_label=Utils.createLabel(26,new cc.Color(104,69,42,255),null,0,-100,"",this.empty_con,0,cc.v2(.5,.5))}var n=Utils.TI18N("\u80cc\u5305\u4e2d\u6682\u65e0\u8be5\u7c7b\u578b\u7b26\u6587");this.empty_label.string=n,this.empty_con.active=t}},closeCallBack:function(){this.ctrl.openArtifactListWindow(!1),this.order_scrollview&&(this.order_scrollview.deleteMe(),this.order_scrollview=null),this.empty_con&&(this.empty_con.destroy(),this.empty_label.destroy(),this.empty_bg.destroy(),this.empty_con=null,this.empty_bg=null,this.empty_label=null)}});cc._RF.pop()},{artifact_list_item:"artifact_list_item",backpack_const:"backpack_const",backpack_controller:"backpack_controller",common_scrollview:"common_scrollview",hero_controller:"hero_controller",hero_event:"hero_event",pathtool:"pathtool"}],artifact_recast_window:[function(t,e,i){"use strict";cc._RF.push(e,"453bevXkS9JU5e46XxoT9+j","artifact_recast_window");var s=t("pathtool"),n=t("hero_controller"),a=t("hero_event"),o=t("backpack_controller"),l=t("partner_calculate"),r=t("skill_item"),c=t("partner_const");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("hero","artifact_recast_panel"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Big},initConfig:function(){this.ctrl=n.getInstance(),this.model=this.ctrl.getModel(),this.is_can_save=!1,this.need_list={},this.base_list_left={},this.base_list_right={},this.skill_list_left={},this.skill_list_right={}},openCallBack:function(){this.background=this.seekChild("background"),this.main_container=this.seekChild("main_container");var t=this.seekChild(this.main_container,"container");this.left_bg_nd=this.seekChild(t,"Image_7"),this.right_bg_nd=this.seekChild(t,"Image_9"),this.name_lb=this.seekChild(t,"name_txt",cc.Label),this.pos_item=this.seekChild("pos_item");var e=this.seekChild(t,"cost_icon_1",cc.Sprite),i=this.seekChild(t,"cost_icon_2",cc.Sprite);this.cost_icon=[e,i];var s=this.seekChild(t,"cost_txt_1",cc.Label),n=this.seekChild(t,"cost_txt_2",cc.Label);s.string="",n.string="",this.cost_txt=[s,n],this.close_btn=this.seekChild("close_btn"),this.save_btn=this.seekChild("save_btn"),this.reset_btn=this.seekChild("reset_btn"),this.cancel_btn=this.seekChild("cancel_btn"),this.explain_btn=this.seekChild("explain_btn"),this.item_node=ItemsPool.getInstance().getItem("backpack_item"),this.item_node.initConfig(!1,1,!1,!1),this.item_node.show(),this.item_node.setParent(this.pos_item)},registerEvent:function(){Utils.onTouchEnd(this.close_btn,function(){this.ctrl.openArtifactRecastWindow(!1)}.bind(this),2),Utils.onTouchEnd(this.reset_btn,function(){this.data&&this.data.id&&this.ctrl.sender11033(this.partner_id,this.data.id,{})}.bind(this),1),Utils.onTouchEnd(this.save_btn,function(){this.data&&this.data.id&&this.ctrl.sender11034(this.partner_id,this.data.id,1)}.bind(this),1),Utils.onTouchEnd(this.cancel_btn,function(){this.data&&this.data.id&&this.ctrl.sender11033(this.partner_id,this.data.id,{})}.bind(this),1),this.explain_btn.on(cc.Node.EventType.TOUCH_END,function(e){Utils.playButtonSound(1);var i=e.touch.getLocation(),s=StringUtil.parse(Config.partner_artifact_data.data_artifact_const.recast_rule.desc);t("tips_controller").getInstance().showCommonTips(s,i)}),this.addGlobalEvent(a.Artifact_Recast_Event,function(){if(this.data&&0!=this.data.id)if(this.partner_id&&0!=this.partner_id){var t=this.model.getPartnerArtifactList(this.partner_id);for(var e in t){var i=t[e];if(i.id==this.data.id){this.setData(i,this.partner_id);break}}}else{var s=o.getInstance().getModel().getBackPackItemById(this.data.id);this.setData(s,this.partner_id)}},this),this.addGlobalEvent(a.Artifact_Save_Event,function(){if(this.data&&0!=this.data.id)if(this.partner_id&&0!=this.partner_id){var t=this.model.getPartnerArtifactList(this.partner_id);for(var e in t){var i=t[e];if(i.id==this.data.id){this.setData(i,this.partner_id);break}}}else{var s=o.getInstance().getModel().getBackPackItemById(this.data.id);this.setData(s,this.partner_id)}},this)},openRootWnd:function(t){this.setData(t.data,t.partner_id)},setData:function(t,e){this.data=t||{},this.item_config=t.config,this.partner_id=e||0,this.item_node.setData(t),this.name_lb.string=this.item_config.name,this.is_can_save=!1,this.data.extra_attr&&null!=Utils.next(this.data.extra_attr)&&(this.is_can_save=!0),this.setBaseAttrInfo(),this.setSkillInfo(),this.updateBtnShow(),this.updateCostInfo()},setBaseAttrInfo:function(){var t=this;if(this.data&&this.data.attr&&this.item_config){var e=2,i=Config.partner_artifact_data.data_artifact_data[this.item_config.id];for(var n in i&&(e=i.attr_num),this.data.attr){if(n>e)break;var a=(d=this.data.attr[n]).attr_id,o=Config.attr_data.data_id_to_key[a],r=d.attr_val/1e3;if(null!=(c=Config.attr_data.data_key_to_name[o]))(function(){t.base_list_left[n]||(t.base_list_left[n]=Utils.createRichLabel(24,new cc.Color(104,69,42,255),cc.v2(0,.5),cc.v2(-91,28),30,380,t.left_bg_nd),t.base_list_left[n].horizontalAlign=cc.macro.TextAlignment.LEFT);var e=t.base_list_left[n];e.node.y=-70-35*n,_=s.getAttrIconByStr(o),1==l.isShowPerByStr(o)&&(r=r/10+"%"),h=cc.js.formatStr("<img src='%s' /> <color=#68452a> %s\uff1a</c><color=#68452a>%s</c>",_,c,r),e.string=h,t.loadRes(s.getUIIconPath("common",_),function(t){e.spriteFrame=t}.bind(t))})()}if(this.is_can_save)for(var n in this.data.extra_attr){var c,_,h;a=(d=this.data.extra_attr[n]).attr_id,o=Config.attr_data.data_id_to_key[a],r=d.attr_val/1e3;if(null!=(c=Config.attr_data.data_key_to_name[o]))(function(){t.base_list_right[n]||(t.base_list_right[n]=Utils.createRichLabel(24,new cc.Color(104,69,42,255),cc.v2(0,.5),cc.v2(-91,28),30,380,t.right_bg_nd),t.base_list_right[n].horizontalAlign=cc.macro.TextAlignment.LEFT);var e=t.base_list_right[n];e.node.x=-91,e.node.y=-70-35*n,_=s.getAttrIconByStr(o),1==l.isShowPerByStr(o)&&(r=r/10+"%"),h=cc.js.formatStr("<img src='%s' /> <color=#68452a> %s\uff1a</c><color=#68452a>%s</c>",_,c,r),e.string=h,t.loadRes(s.getUIIconPath("common",_),function(t){e.spriteFrame=t}.bind(t))})()}else for(var n in this.data.attr){if(n>c)break;var d=this.data.attr[n];this.base_list_right[n]||(this.base_list_right[n]=Utils.createRichLabel(24,new cc.Color(104,69,42,255),cc.v2(0,.5),cc.v2(-183,28),30,380,this.right_bg_nd),this.base_list_right[n].horizontalAlign=cc.macro.TextAlignment.LEFT);var u=this.base_list_right[n];u.node.x=-51,u.node.y=-70-35*n,u.string=Utils.TI18N("\u968f\u673a\u5c5e\u6027")}}},setSkillInfo:function(){if(null!=this.data&&null!=this.data.extra){var t=0,e=Config.partner_artifact_data.data_artifact_data[this.item_config.id];e&&(t=e.skill_num);var i=1,s=[];for(var n in this.data.extra.sort(Utils.tableLowerSorter(["extra_k"])),this.skill_list_left)this.setSkillItemVisible(!1,this.skill_list_left[n]);for(var a in this.data.extra){if((_=this.data.extra[a])&&_.extra_k&&1==_.extra_k||2==_.extra_k||8==_.extra_k)if(s.length<=t)if(s.push(_.extra_v),d=gdata("skill_data","data_get_skill",[_.extra_v])){if(!this.skill_list_left[i]){var o=this.createSkillItem(this.left_bg_nd,i);this.skill_list_left[i]=o}var l=this.skill_list_left[i];this.setSkillItemVisible(!0,l),l.skill.setData(d.bid),l.name.string=d.name,l.desc.string=d.des,l.random_icon.node.active=!1,l.random_des.node.active=!1,u=(u=c.SkillColor[d.level])||new cc.Color(104,69,42,255),l.name.node.color=u,i+=1}}this.cur_skills=s;var r=[];for(var a in this.data.extra){var _;((_=this.data.extra[a])&&null!=_.extra_k&&3==_.extra_k||4==_.extra_k||9==_.extra_k)&&r.push(_.extra_v)}this.recast_skills=r;var h=t;for(var n in null!=Utils.next(r)&&(h=r.length),h>t&&(h=t),this.skill_list_right)this.setSkillItemVisible(!1,this.skill_list_right[n]);for(a=0;a<h;a++){if(!this.skill_list_right[a]){o=this.createSkillItem(this.right_bg_nd,a+1);this.skill_list_right[a]=o}var d,u,m=r[a],f=this.skill_list_right[a];if(this.setSkillItemVisible(!0,f),f.name.node.active=!0,f.desc.node.active=!0,f.random_icon.node.active=!1,f.random_des.node.active=!1,d=gdata("skill_data","data_get_skill",[m]))f.skill.setData(d.bid),f.name.string=d.name,f.desc.string=d.des,u=(u=c.SkillColor[d.level])||new cc.Color(104,69,42,255),f.name.node.color=u;else f.skill.setData(),f.name.node.active=!1,f.desc.node.active=!1,f.random_icon.node.active=!0,f.random_des.node.active=!0}}},createSkillItem:function(t,e){var i={},n=new r;n.setLeveStatus(!1),n.setScale(.8),n.setParent(t);var a=-237-130*(e-1);n.setPosition(cc.v2(-91,a));var o=Utils.createLabel(22,new cc.Color(254,238,186,255),null,-37,a+15,"",t,1,cc.v2(0,0)),l=Utils.createRichLabel(20,new cc.Color(104,69,42,255),cc.v2(0,1),cc.v2(-37,a+20),26,180,t);l.horizontalAlign=cc.macro.TextAlignment.LEFT;var c=s.getUIIconPath("artifact","artifact_1003"),_=Utils.createImage(t,null,-92,a,cc.v2(.5,.5),null,2);this.loadRes(c,function(t){_.spriteFrame=t}.bind(this));var h=Utils.createLabel(24,new cc.Color(104,69,42,255),null,-37,a,Utils.TI18N("\u968f\u673a\u6280\u80fd"),t,1,cc.v2(0,.5));return i.skill=n,i.name=o,i.desc=l,i.random_icon=_,i.random_des=h,i},setSkillItemVisible:function(t,e){null!=e&&(e.skill.setVisible(t),e.desc.node.active=t,e.name.node.active=t,e.random_icon.node.active=t,e.random_des.node.active=t)},updateBtnShow:function(){this.reset_btn.active=!this.is_can_save,this.save_btn.active=this.is_can_save,this.cancel_btn.active=this.is_can_save},updateCostInfo:function(){var t=this;if(this.data&&this.data.attr&&this.item_config){var e=Config.partner_artifact_data.data_artifact_data[this.item_config.id];if(e&&e.ref_expend)for(var i=function(){var i=t.cost_icon[n],c=t.cost_txt[n],_=e.ref_expend[n];_?(a=_[0],l=_[1],Utils.getItemConfig(a)&&(t.loadRes(s.getItemRes(a),function(t){i.spriteFrame=t}.bind(t)),r=o.getInstance().getModel().getItemNumByBid(a),c.string=Utils.getMoneyString(r)+"/"+Utils.getMoneyString(l),c.node.color=r>=l?new cc.Color(255,246,228,255):new cc.Color(200,20,20,255))):_.string=""},n=0;n<2;n++){var a,l,r;i()}}},closeCallBack:function(){if(this.item_node&&(this.item_node.deleteMe(),this.item_node=null),this.skill_list_left){for(var t in this.skill_list_left){(e=this.skill_list_left[t])&&(e.skill.deleteMe(),e.skill=null,e.desc.node.destroy(),e.desc=null,e.name.node.destroy(),e.name=null,e.random_des.node.destroy(),e.random_des=null,e.random_icon.node.destroy(),e.random_icon=null,e=null)}this.skill_list_left=null}if(this.skill_list_right){for(var t in this.skill_list_right){(e=this.skill_list_right[t])&&(e.skill.deleteMe(),e.skill=null,e.desc.node.destroy(),e.desc=null,e.name.node.destroy(),e.name=null,e.random_des.node.destroy(),e.random_des=null,e.random_icon.node.destroy(),e.random_icon=null,e=null)}this.skill_list_right=null}if(this.base_list_left){for(var t in this.base_list_left){(e=this.base_list_left[t])&&(e.node.destroy(),e=null)}this.base_list_left=null}if(this.base_list_right){for(var t in this.base_list_right){var e;(e=this.base_list_right[t])&&(e.node.destroy(),e=null)}this.base_list_right=null}this.ctrl.openArtifactRecastWindow(!1)}});cc._RF.pop()},{backpack_controller:"backpack_controller",hero_controller:"hero_controller",hero_event:"hero_event",partner_calculate:"partner_calculate",partner_const:"partner_const",pathtool:"pathtool",skill_item:"skill_item",tips_controller:"tips_controller"}],artifact_skill_item:[function(t,e,i){"use strict";cc._RF.push(e,"95efaask9BMIp8WgpS6vOwz","artifact_skill_item");var s=t("pathtool");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("forgehouse","artifact_skill_item")},initConfig:function(){},initPanel:function(){this.container=this.seekChild("container"),this.skill_name=this.seekChild("skill_name",cc.Label)},registerEvent:function(){},setData:function(t){this.data=t,this.root_wnd&&this.onShow()},onShow:function(e){if(null!=this.data){if(this.skill_name.string=this.data.name,!this.skill_item){var i=t("skill_item");this.skill_item=new i,this.skill_item.setPosition(cc.v2(60,90)),this.skill_item.setLeveStatus(!1),this.skill_item.setShowTips(!0),this.skill_item.setParent(this.container)}this.skill_item.setData(this.data.bid)}},onHide:function(){},onDelete:function(){this.skill_item&&(this.skill_item.deleteMe(),this.skill_item=null)}});cc._RF.pop()},{pathtool:"pathtool",skill_item:"skill_item"}],artifact_skill_window:[function(t,e,i){"use strict";cc._RF.push(e,"572a1ZLe2VFIrdWJZ0Q2cLR","artifact_skill_window");var s=t("pathtool"),n=t("artifact_skill_item"),a=t("hero_controller"),o=t("common_scrollview");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("forgehouse","artifact_skill_window"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Big,this.show_type=arguments[0]},initConfig:function(){this.tab_list={},this.ctrl=a.getInstance()},openCallBack:function(){this.background=this.seekChild("background"),this.background.scale=FIT_SCALE,this.main_container=this.seekChild("main_container"),this.explain_btn=this.seekChild("explain_btn"),this.close_btn=this.seekChild("close_btn");var t=this.seekChild("tab_container");2==this.show_type&&(this.explain_btn.active=!1);for(var e=1;e<=3;e++){var i={},s=this.seekChild(t,"tab_btn_"+e);if(s){var a=this.seekChild(t,"title_"+e,cc.Label),l=s.getComponent(cc.Button);i.tab_btn=s,i.btn=l,i.title_lb=a,i.index=e,this.tab_list[e]=i}}var r=this.seekChild(this.main_container,"skill_panel"),c=r.getContentSize(),_={item_class:n,start_x:0,space_x:33,start_y:0,space_y:12,item_width:119,item_height:149,row:0,col:4,need_dynamic:!0};this.item_scrollview=new o,this.item_scrollview.createScroll(r,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,c,_,cc.v2(.5,.5))},registerEvent:function(){var e=this;Utils.onTouchEnd(this.close_btn,function(){this.ctrl.openArtifactSkillWindow(!1)}.bind(this),2),Utils.onTouchEnd(this.background,function(){this.ctrl.openArtifactSkillWindow(!1)}.bind(this),2),this.explain_btn.on(cc.Node.EventType.TOUCH_END,function(e){Utils.playButtonSound(1);var i=e.touch.getLocation();t("tips_controller").getInstance().showCommonTips(Config.partner_artifact_data.data_artifact_const.recastskill_rule.desc,i)});var i=function(){var t=e.tab_list[s];t.tab_btn.on(cc.Node.EventType.TOUCH_END,function(){Utils.playButtonSound(1),this.changeSelectedTab(t.index)},e)};for(var s in this.tab_list)i()},changeSelectedTab:function(t){if(!this.tab_object||this.tab_object.index!=t){this.tab_object&&(this.tab_object.btn.interactable=!1,this.tab_object.title_lb.node.color=new cc.Color(207,181,147)),this.tab_object=this.tab_list[t],this.tab_object&&(this.tab_object.btn.interactable=!0,this.tab_object.title_lb.node.color=new cc.Color(254,237,214));var e=Config.partner_artifact_data.data_artifact_skill[t]||{},i=[];for(var s in e){var n=gdata("skill_data","data_get_skill",[e[s]]);n&&i.push(n)}this.item_scrollview.setData(i)}},openRootWnd:function(){this.changeSelectedTab(1)},closeCallBack:function(){this.item_scrollview&&(this.item_scrollview.deleteMe(),this.item_scrollview=null),this.ctrl.openArtifactSkillWindow(!1)}});cc._RF.pop()},{artifact_skill_item:"artifact_skill_item",common_scrollview:"common_scrollview",hero_controller:"hero_controller",pathtool:"pathtool",tips_controller:"tips_controller"}],artifact_tips_window:[function(t,e,i){"use strict";function s(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}cc._RF.push(e,"ad5f7CHz+lIQJWeirGQBT37","artifact_tips_window");var n=t("pathtool"),a=t("hero_controller"),o=t("partner_const"),l=t("scene_const"),r=t("partner_calculate"),c=t("skill_item");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=n.getPrefabPath("hero","artifact_tips"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Mini},initConfig:function(){this.ctrl=a.getInstance(),this.base_list={},this.skill_list={},this.tab_list={}},openCallBack:function(){var t;this.background=this.seekChild("background"),this.main_panel=this.seekChild("main_panel"),this.container=this.seekChild("container"),this.close_btn=this.seekChild(this.container,"close_btn"),this.container_init_size=this.container.getContentSize(),this.base_panel=this.seekChild("base_panel"),this.base_panel_sp=this.seekChild("base_panel",cc.Sprite),this.equip_item=ItemsPool.getInstance().getItem("backpack_item"),this.equip_item.initConfig(!0,1,!1,!1),this.equip_item.setParent(this.base_panel),this.equip_item.show(),this.equip_item.setPosition(-135,-69),this.name_lb=this.seekChild(this.base_panel,"name",cc.Label),this.equip_type_lb=this.seekChild(this.base_panel,"equip_type",cc.Label),this.power_label_cr=this.seekChild(this.base_panel,"power_label").getComponent("CusRichText"),this.baseattr_panel=this.seekChild("baseattr_panel"),this.attr_text_rt=this.seekChild(this.baseattr_panel,"attr_text",cc.RichText),this.skill_panel_1=this.seekChild(this.container,"skill_panel_1"),this.skill_panel_2=this.seekChild(this.container,"skill_panel_2"),this.skill_panel_height=this.skill_panel_2.getContentSize().height,this.skill_panel_3=this.seekChild(this.container,"skill_panel_3"),this.tab_panel=this.seekChild(this.container,"tab_panel"),this.tab_panel_height=this.tab_panel.getContentSize().height;for(var e=(s(t={},1,Utils.TI18N("\u5408\u6210")),s(t,2,Utils.TI18N("\u91cd\u94f8")),s(t,3,Utils.TI18N("\u5206\u89e3")),s(t,4,Utils.TI18N("\u7a7f\u6234")),t),i=1;i<=4;i++){var n=this.seekChild(this.tab_panel,"tab_btn_"+i);if(n){this.tab_list[i]=n;var a=this.seekChild(n,"Label",cc.Label);n.label=a,n.label.string=e[i],n.index=i}}},registerEvent:function(){var t=this;Utils.onTouchEnd(this.background,function(){this.ctrl.openArtifactTipsWindow(!1)}.bind(this),2),Utils.onTouchEnd(this.close_btn,function(){this.ctrl.openArtifactTipsWindow(!1)}.bind(this),2);var e=function(){var e=t.tab_list[i];e.on(cc.Node.EventType.TOUCH_END,function(){this.clickBtn(e.index),Utils.playButtonSound(1)},t)};for(var i in this.tab_list)e()},clickBtn:function(e){if(e=e||1,this.ctrl.openArtifactTipsWindow(!1),e==o.Artifact_Type.Source)this.data&&this.data.config&&t("backpack_controller").getInstance().openTipsSource(!0,this.data.config);else if(e==o.Artifact_Type.Cloth){var i=t("mainui_const");t("mainui_controller").getInstance().changeMainUIStatus(i.btn_index.partner)}else if(e==o.Artifact_Type.Compose){if(null==(s=Config.city_data.data_base[l.CenterSceneBuild.mall]))return;t("mainui_controller").getInstance().checkIsOpenByActivate(s.activate)&&t("forgehouse_controller").getInstance().openForgeHouseView(!0,2)}else if(e==o.Artifact_Type.Recast)this.ctrl.openArtifactRecastWindow(!0,this.data,this.partner_id);else if(e==o.Artifact_Type.Getoff)this.data&&this.data.id&&this.ctrl.sender11030(this.partner_id,this.artifact_pos,this.data.id,0);else if(e==o.Artifact_Type.Replace)this.ctrl.openArtifactListWindow(!0,this.artifact_pos,this.partner_id);else if(e==o.Artifact_Type.Resolve){var s;if(this.data&&this.data.config&&null!=this.data.config.id&&null!=this.data.enchant)if((s=Config.partner_artifact_data.data_artifact_resolve[this.data.config.id])&&null!=s[0]){var a=s[0][0],r=s[0][1],c=cc.js.formatStr(Utils.TI18N("\u5206\u89e3\u6b64\u7b26\u6587\u53ef\u4ee5\u83b7\u5f97<img src='%s' />%s\uff0c\u662f\u5426\u7ee7\u7eed\uff1f"),a,r),_=n.getItemRes(a);t("commonalert").show(c,Utils.TI18N("\u786e\u5b9a"),function(){this.ctrl.sender11035(this.data.id)}.bind(this),Utils.TI18N("\u53d6\u6d88"),null,2,null,{resArr:[_]})}else message(Utils.TI18N("\u65e0\u8be5\u7b26\u6587\u914d\u7f6e\u6570\u636e"))}},openRootWnd:function(t){if(null!=t){this.open_type=t.open_type,this.data=t.data||{},this.item_config=t.data.config,this.partner_id=t.partner_id||0,null==t.pos?this.artifact_pos=1:this.artifact_pos=t.pos;var e=this.container_init_size.height,i=0;if(this.data&&this.data.extra){var s=0;for(var n in this.data.extra){var a=this.data.extra[n];1!=a.extra_k&&2!=a.extra_k&&8!=a.extra_k||(s+=1)}i=s}i<1&&(this.skill_panel_1.active=!1,e-=this.skill_panel_height),i<2&&(this.skill_panel_2.active=!1,e-=this.skill_panel_height),i<3&&(this.skill_panel_3.active=!1,e-=this.skill_panel_height),this.open_type==o.ArtifactTips.partner?(this.tab_list[3].label.string=Utils.TI18N("\u5378\u4e0b"),this.tab_list[3].index=o.Artifact_Type.Getoff,this.tab_list[4].label.string=Utils.TI18N("\u66ff\u6362"),this.tab_list[4].index=o.Artifact_Type.Replace):this.open_type==o.ArtifactTips.normal&&(e-=this.tab_panel_height,this.tab_panel.active=!1),e!=this.container_init_size.height&&this.container.setContentSize(cc.size(this.container_init_size.width,e)),this.score_val=0,this.setBaseInfo(),this.setBaseAttrInfo(),this.setSkillInfo(),this.power_label_cr.setNum(this.score_val)}},setBaseInfo:function(){if(null!=this.data&&null!=this.item_config){var e=this.data;this.equip_item.setData(e.config);var i=0;this.item_config.quality>=0&&this.item_config.quality<=5&&(i=this.item_config.quality);var s=n.getUIIconPath("tips","tips_"+i);this.loadRes(s,function(t){this.base_panel_sp.spriteFrame=t}.bind(this));var a=t("backpack_const").getEquipTipsColor(i);this.name_lb.node.color=a,this.name_lb.string=this.item_config.name,this.equip_type_lb.string=Utils.TI18N("\u7c7b\u578b\uff1a")+this.item_config.type_desc}},setBaseAttrInfo:function(){var t=this;if(this.data&&this.data.attr&&this.item_config){var e=Config.partner_artifact_data.data_artifact_data[this.item_config.id],i=2;e&&(i=e.attr_num);var s=Config.partner_artifact_data.data_artifact_attr_score[this.item_config.id],a=1;for(var o in this.data.attr){var l=this.data.attr[o];if(a>i)break;var c,_,h=l.attr_id,d=Config.attr_data.data_id_to_key[h],u=l.attr_val/1e3,m=Config.attr_data.data_key_to_name[d];if(m)(function(){t.base_list[a]||(t.base_list[a]=Utils.createRichLabel(22,new cc.Color(193,183,171,255),cc.v2(0,.5),cc.v2(20,28),30,380,t.baseattr_panel));var e=t.base_list[a];e.horizontalAlign=cc.macro.TextAlignment.LEFT,e.node.x=30+200*o,c=n.getAttrIconByStr(d),1==r.isShowPerByStr(d)&&(u=u/10+"%"),_=cc.js.formatStr("<img src='%s' /> <color=#c1b7ab> %s\uff1a</c><color=#ffeedd>%s</c>",c,m,u),e.string=_,t.loadRes(n.getUIIconPath("common",c),function(t){e.spriteFrame=t}.bind(t)),a+=1})();s&&(this.score_val=this.score_val+s[d]||0)}}},setSkillInfo:function(){if(null!=this.data&&null!=this.data.extra){var t=1,e=Config.partner_artifact_data.data_artifact_const;for(var i in this.data.extra){var s=this.data.extra[i];if(s&&s.extra_k&&(1==s.extra_k||2==s.extra_k||8==s.extra_k)){var n=gdata("skill_data","data_get_skill",[s.extra_v]);if(n){if(!this.skill_list[t]){var a=this.createSkillItem(t,this["skill_panel_"+t]);this.skill_list[t]=a}var o=this.skill_list[t];o.skill.setData(n.bid),o.name.string=n.name,o.desc.string=n.des;var l=n.level||1;e["skill_score_"+l]&&null!=e["skill_score_"+l].val&&(this.score_val=this.score_val+e["skill_score_"+l].val),t+=1}}}}},createSkillItem:function(t,e){var i={},s=new c;s.setLeveStatus(!1),s.setScale(.8),s.setParent(e),s.setShowTips(!0);var n=Utils.createLabel(24,new cc.Color(254,238,186,255),null,-71,-64,"",e,1,cc.v2(0,0)),a=Utils.createRichLabel(22,new cc.Color(255,238,221,255),cc.v2(0,1),cc.v2(-71,88),26,260,e);return a.horizontalAlign=cc.macro.TextAlignment.LEFT,1==Number(t)?(s.setPosition(cc.v2(-141,-98)),a.node.y=-70):(s.setPosition(cc.v2(-141,-68)),a.node.y=-40,n.node.y=-39),i.skill=s,i.name=n,i.desc=a,i},closeCallBack:function(){if(this.equip_item&&(this.equip_item.deleteMe(),this.equip_item=null),this.skill_list){for(var t in this.skill_list){(i=this.skill_list[t])&&(i.skill&&i.skill.deleteMe&&(i.skill.deleteMe(),i.skill=null),i.name&&(i.name.node.destroy(),i.name=null),i.desc&&(i.desc.node.destroy(),i.desc=null),i=null)}this.skill_list=null}if(this.base_list){for(var e in this.base_list){var i;(i=this.base_list[e])&&(i instanceof cc.Node?(i.destroy(),i=null):(i.node.destroy(),i=null))}this.base_list=null}}});cc._RF.pop()},{backpack_const:"backpack_const",backpack_controller:"backpack_controller",commonalert:"commonalert",forgehouse_controller:"forgehouse_controller",hero_controller:"hero_controller",mainui_const:"mainui_const",mainui_controller:"mainui_controller",partner_calculate:"partner_calculate",partner_const:"partner_const",pathtool:"pathtool",scene_const:"scene_const",skill_item:"skill_item"}],awy_sdk:[function(t,e,i){"use strict";cc._RF.push(e,"e98b6ZH7XJDL4Es52XG9rl/","awy_sdk"),window.H_H=0,cc._RF.pop()},{}],backpack_batchuse_window:[function(t,e,i){"use strict";cc._RF.push(e,"7559clcpgVKtJy66gBOyogW","backpack_batchuse_window");var s=t("pathtool"),n=t("role_controller"),a=t("backpack_const");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("backpack","batchuse_panel_view"),this.viewTag=SCENE_TAG.msg,this.win_type=WinType.Mini,this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){this.role_vo=n.getInstance().getRoleVo(),this.cur_selected_sum=0,this.select_goods=null},openCallBack:function(){this.background=this.root_wnd.getChildByName("background"),this.main_container=this.root_wnd.getChildByName("main_container"),this.close_btn=this.main_container.getChildByName("close_btn"),this.item=ItemsPool.getInstance().getItem("backpack_item"),this.item.initConfig(!0,1,!1),this.item.setParent(this.main_container),this.item.show(),this.item.setPosition(-200,140),this.use_btn=this.main_container.getChildByName("use_btn"),this.use_btn_lab=this.use_btn.getChildByName("Label").getComponent(cc.Label),this.use_btn_lab.string=Utils.TI18N("\u4f7f\u7528"),this.handle_container=this.main_container.getChildByName("handle_container"),this.handle_container_cy=0,this.container=this.handle_container.getChildByName("container"),this.container_y=this.container.y,this.sub_btn=this.container.getChildByName("sub_btn"),this.add_btn=this.container.getChildByName("add_btn"),this.max_btn=this.container.getChildByName("max_btn"),this.slider=this.container.getChildByName("slider").getComponent(cc.Slider),this.progress=this.container.getChildByName("ProgressBar").getComponent(cc.ProgressBar),this.value=this.container.getChildByName("value").getComponent(cc.Label),this.use_title=this.container.getChildByName("title").getComponent(cc.Label),this.use_title.string=Utils.TI18N("\u4f7f\u7528\u6570\u91cf\uff1a"),this.extend_container=this.handle_container.getChildByName("extend_container"),this.use_item_title=this.extend_container.getChildByName("use_item_title").getComponent(cc.Label),this.use_item_title.string="",this.use_effect=this.extend_container.getChildByName("use_effect").getComponent(cc.Label),this.title_label=this.main_container.getChildByName("title_label").getComponent(cc.Label),this.title_label.string=Utils.TI18N("\u6279\u91cf\u4f7f\u7528"),this.item_name=this.main_container.getChildByName("item_name").getComponent(cc.Label),this.item_own=this.main_container.getChildByName("item_own").getComponent(cc.Label)},registerEvent:function(){Utils.onTouchEnd(this.close_btn,function(){this.ctrl.openBatchUseItemView(!1)}.bind(this),2),Utils.onTouchEnd(this.use_btn,function(){if(null!=this.item_vo&&null!=this.item_vo.config)if(this.cur_selected_sum=Math.min(this.cur_selected_sum,this.item_vo.quantity),0!=this.cur_selected_sum)if(this.type==a.ItemConsumeType.use)this.ctrl.sender10515(this.item_vo.id,this.cur_selected_sum,this.select_goods);else{if(this.select_goods&&this.select_goods.type&&1==this.select_goods.type)return void this.ctrl.openBatchUseItemView(!1);this.ctrl.sender10522(a.Bag_Code.BACKPACK,[{id:this.item_vo.id,bid:this.item_vo.base_id,num:this.cur_selected_sum}])}else message(Utils.TI18N("\u5f53\u524d\u6570\u91cf\u4e0d\u80fd\u4e3a0"))}.bind(this),1),this.slider.node.on("slide",function(){this.setCurUseItemInfoByPercent(this.slider.progress),this.progress.progress=this.slider.progress},this),Utils.onTouchEnd(this.sub_btn,function(){null!=this.item_vo&&(0!=this.slider.progress&&0!=this.cur_selected_sum&&(this.cur_selected_sum=this.cur_selected_sum-1,this.setCurUseItemInfoByNum(this.cur_selected_sum)))}.bind(this),1),Utils.onTouchEnd(this.add_btn,function(){null!=this.item_vo&&(100!=this.slider.progress&&(this.cur_selected_sum>=this.item_vo.quantity||(this.cur_selected_sum=this.cur_selected_sum+1,this.setCurUseItemInfoByNum(this.cur_selected_sum))))}.bind(this),1),Utils.onTouchEnd(this.max_btn,function(){null!=this.item_vo&&(100!=this.slider.progress&&(this.cur_selected_sum>=this.item_vo.quantity||(this.cur_selected_sum=this.item_vo.quantity,this.setCurUseItemInfoByNum(this.cur_selected_sum))))}.bind(this),1)},openRootWnd:function(t){var e=t[0],i=t[1],s=t[2];this.type=i||a.ItemConsumeType.use,this.item_vo=e,this.select_goods=s,null!=this.item_vo&&null!=this.item_vo.config?(this.type==a.ItemConsumeType.use?(this.title_label.string=Utils.TI18N("\u6279\u91cf\u4f7f\u7528"),this.use_title.string=Utils.TI18N("\u4f7f\u7528\u6570\u91cf\uff1a"),this.use_btn_lab.string=Utils.TI18N("\u4f7f\u7528"),this.updateItem()):this.type==a.ItemConsumeType.resolve?(this.title_label.string=Utils.TI18N("\u6279\u91cf\u5206\u89e3"),this.use_title.string=Utils.TI18N("\u5206\u89e3\u6570\u91cf\uff1a"),this.use_btn_lab.string=Utils.TI18N("\u5206\u89e3"),this.updateCellItem()):(this.title_label.string=Utils.TI18N("\u7269\u54c1\u51fa\u552e"),this.use_title.string=Utils.TI18N("\u51fa\u552e\u6570\u91cf\uff1a"),this.use_btn_lab.string=Utils.TI18N("\u51fa\u552e"),this.updateCellItem()),this.setUseInfo(100)):this.ctrl.openBatchUseItemView(!1)},updateCellItem:function(){if(null!=this.item_vo&&null!=this.item_vo.config){this.item.setData(this.item_vo.config),this.item_name.string=this.item_vo.config.name,this.item_own.string=cc.js.formatStr(Utils.TI18N("\u62e5\u6709 %s \u4e2a"),this.item_vo.quantity),this.cur_selected_sum=this.item_vo.quantity,this.value.string=this.item_vo.quantity,this.slider.progress=1,this.progress.progress=this.slider.progress;var t=this.item_vo.config.value;if(null!=t&&null!=Utils.next(t)){if(this.value_config=t[0],null==this.value_config||null==this.value_config[0]||"number"!=typeof this.value_config[0])return;var e=this.value_config[0];if(null==Utils.getItemConfig(e))return;this.value_config[0]==gdata("item_data","data_assets_label2id","coin")?this.role_vo.coin:this.value_config[0]==gdata("item_data","data_assets_label2id","hero_soul")&&this.role_vo.hero_soul,this.setCurUseItemInfoByPercent(1)}this.select_goods&&this.select_goods.type&&1==this.select_goods.type&&(this.value_config=this.select_goods.value_list||{},this.setCurUseItemInfoByPercent(1))}},updateItem:function(){if(null!=this.item_vo&&null!=this.item_vo.config)if(this.item.setData(this.item_vo.config),this.item_name.string=this.item_vo.config.name,this.item_own.string=cc.js.formatStr(Utils.TI18N("\u62e5\u6709 %s \u4e2a"),this.item_vo.quantity),this.cur_selected_sum=this.item_vo.quantity,this.value.string=this.item_vo.quantity,this.slider.progress=1,this.progress.progress=this.slider.progress,1==this.isAssetsItem(this.item_vo.config)){if(this.container.y=this.container_y,this.extend_container.active=!0,this.item_vo.config.effect&&null!=Utils.next(this.item_vo.config.effect)){var t=this.item_vo.config.effect[0];if(null!=t&&null!=this.role_vo){t.effect_type==a.item_effect_type.GOLD?this.role_vo.coin:t.effect_type==a.item_effect_type.COIN?this.role_vo.coin:t.effect_type==a.item_effect_type.PARTNER_EXP&&this.role_vo.partner_exp_all}}this.setCurUseItemInfoByPercent(1)}else this.container.y=this.handle_container_cy,this.extend_container.active=!1},setCurUseItemInfoByPercent:function(t){null!=this.item_vo&&(this.cur_selected_sum=Math.max(1,Math.floor(t*this.item_vo.quantity)),this.setUseInfo(this.cur_selected_sum))},setCurUseItemInfoByNum:function(t){if(null!=this.item_vo){this.cur_selected_sum=Math.max(1,t);var e=Math.max(1,this.item_vo.quantity-1),i=(this.cur_selected_sum-1)/e;this.slider.progress=i,this.progress.progress=this.slider.progress,this.setUseInfo(this.cur_selected_sum)}},setUseInfo:function(t){if(t=Math.min(this.item_vo.quantity,t),this.value.string=t,this.type==a.ItemConsumeType.sell&&null!=this.value_config){var e=this.value_config[1]||0;if(null==(i=this.value_config[0]))return;if(null==(s=Utils.getItemConfig(i)))return;this.use_item_title.string=cc.js.formatStr(Utils.TI18N("\u51fa\u552e\u540e\u53ef\u83b7\u5f97%s\uff1a"),s.name),this.use_effect.string=e*t,this.use_effect.node.x=this.use_item_title.node.getContentSize().width+this.use_item_title.node.x}else if(this.type==a.ItemConsumeType.resolve&&null!=this.value_config){var i,s;e=this.value_config[1]||0;if(null==(i=this.value_config[0]))return;if(null==(s=Utils.getItemConfig(i)))return;this.use_item_title.string=cc.js.formatStr(Utils.TI18N("\u5206\u89e3\u540e\u53ef\u83b7\u5f97%s\uff1a"),s.name),this.use_effect.string=e*t,this.use_effect.node.x=this.use_item_title.node.getContentSize().width+this.use_item_title.node.x}else{if(null==this.item_vo||null==this.item_vo.config||null==this.item_vo.config.effect||null==Utils.next(this.item_vo.config.effect))return;if(0==this.isAssetsItem(this.item_vo.config))return;var n=this.item_vo.config.effect[0];null!=n&&(this.use_item_title.string=cc.js.formatStr(Utils.TI18N("\u4f7f\u7528\u540e\u53ef\u83b7\u5f97%s\uff1a"),Config.item_data.data_item_effect_type[n.effect_type]),this.use_effect.string=n.val*t,this.use_effect.node.x=this.use_item_title.node.getContentSize().width+this.use_item_title.node.x)}},isAssetsItem:function(t){if(null==t)return!1;if(null==t.effect||null==Utils.next(t.effect))return!1;var e=!1;for(var i in t.effect){var s=t.effect[i];if(s.effect_type==a.item_effect_type.GOLD||s.effect_type==a.item_effect_type.COIN||s.effect_type==a.item_effect_type.PARTNER_EXP){e=!0;break}}return e},closeCallBack:function(){this.item&&this.item.deleteMe(),this.item=null,this.ctrl.openBatchUseItemView(!1)}});cc._RF.pop()},{backpack_const:"backpack_const",pathtool:"pathtool",role_controller:"role_controller"}],backpack_comp_tips_window:[function(t,e,i){"use strict";cc._RF.push(e,"68c13+FaaNOM4OuMcTbSfAk","backpack_comp_tips_window");var s=t("pathtool"),n=t("backpack_controller");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("tips","backpack_comp_tips"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Tips,this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){},openCallBack:function(){this.background=this.root_wnd.getChildByName("background"),this.main_panel=this.root_wnd.getChildByName("main_panel"),this.text_name=this.main_panel.getChildByName("text_name").getComponent(cc.Label),this.get_path=this.main_panel.getChildByName("get_path"),this.get_path.active=!1,this.get_path.getChildByName("Text_2").getComponent(cc.Label).string=Utils.TI18N("\u83b7\u53d6\u9014\u5f84"),this.goto_btn=this.get_path.getChildByName("goto"),this.text_desc=this.main_panel.getChildByName("text_desc").getComponent(cc.Label),this.com_btn=this.main_panel.getChildByName("com_btn"),this.com_btn.active=!1,this.info_btn=this.main_panel.getChildByName("info_btn"),this.info_btn.active=!1,this.goods_item=ItemsPool.getInstance().getItem("backpack_item"),this.goods_item.initConfig(!0,1,!1),this.goods_item.setPosition(-this.main_panel.width/2+113,258-this.main_panel.height/2),this.goods_item.setParent(this.main_panel),this.goods_item.show()},registerEvent:function(){Utils.onTouchEnd(this.background,function(){this.ctrl.showBackPackCompTips(!1)}.bind(this),2),Utils.onTouchEnd(this.goto_btn,function(){this.item_config&&(t("backpack_controller").getInstance().openTipsSource(!0,this.item_config.id),this.ctrl.showBackPackCompTips(!1))}.bind(this),1)},openRootWnd:function(t){if(t){var e=Utils.getItemConfig(t),i=1;if(Config.partner_data.data_get_compound_info[e.id])1==Config.partner_data.data_get_compound_info[e.id].is_random?(i=2,this.get_path.active=!1):this.get_path.active=!0;else n.getInstance().getModel().getHallowsCompData(e.id)&&(this.get_path.active=!0);this.item_config=e,this.showBtn(i),this.setBaseInfo()}},showBtn:function(e){var i=0;e>1&&(i=120),this.com_btn.active=!0,this.com_btn.x=i,Utils.onTouchEnd(this.com_btn,function(){var e,i=n.getInstance().getModel().getBackPackItemNumByBid(this.item_config.id),s=1,a=!1;if(Config.partner_data.data_get_compound_info[this.item_config.id]){e=this.item_config.id;var o=Config.partner_data.data_get_compound_info[this.item_config.id].num;s=Math.floor(i/o),a=!0}else{var l=n.getInstance().getModel().getHallowsCompData(this.item_config.id);e=l.bid,s=Math.floor(i/l.num)}s>=2?1==a?t("tips_controller").getInstance().showCompChooseTips(!0,this.item_config.id):n.getInstance().sender10523(e,1):0!=s?1==a?n.getInstance().sender11008(this.item_config.id,1):n.getInstance().sender10523(e,1):message(Utils.TI18N("\u6570\u91cf\u4e0d\u8db3"))}.bind(this),1),2==e&&(this.info_btn.active=!0,this.info_btn.x=120-this.main_panel.getContentSize().width/2,Utils.onTouchEnd(this.info_btn,function(){this.item_config.effect&&this.item_config.effect[0].val&&this.item_config.eqm_jie&&(this.ctrl.showBackPackCompTips(!1),t("hero_controller").getInstance().openHeroInfoWindowByBidStar(this.item_config.effect[0].val,this.item_config.eqm_jie))}.bind(this),1))},setBaseInfo:function(){null!=this.item_config&&(this.goods_item.setData(this.item_config.id),this.text_name.string=this.item_config.name,this.text_desc.string=this.item_config.use_desc)},closeCallBack:function(){this.goods_item&&this.goods_item.deleteMe(),this.goods_item=null;var e=t("guide_event");gcore.GlobalEvent.fire(e.CloseTaskEffect),this.ctrl.showBackPackCompTips(!1)}});cc._RF.pop()},{backpack_controller:"backpack_controller",guide_event:"guide_event",hero_controller:"hero_controller",pathtool:"pathtool",tips_controller:"tips_controller"}],backpack_const:[function(t,e,i){"use strict";var s;function n(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}cc._RF.push(e,"db1e5MGeN1HQqhX41nowxKA","backpack_const");var a={Bag_Code:{BACKPACK:1,STORAGE:2,EQUIPS:3},item_tab_type:{OTHERS:0,EQUIPS:1,PROPS:2,HERO:3,SPECIAL:4,HOLYEQUIPMENT:5},quality:{white:0,green:1,blue:2,purple:3,orange:4,red:5},item_type:{NORMAL:0,WEAPON:1,SHOE:2,CLOTHES:3,HAT:4,ASSET:7,MATERIALS:9,ARTIFACTCHIPS:10,GOD_EARRING:23,GOD_RING:24,GOD_NECKLACE:25,GOD_BANGLE:26,GIFT:100,FREE_GIFT:101,PARTNER_DEBRIS:102,STAR_SOUL:105,WEEK_CARD:27,HERO_SKIN:28},item_use_type:{NO_DIRECT_USE:0,CONSUM:1,NO_CONSUM:2,EQUIP:3,BATCH_USE:4},tips_btn_type:{source:1,goods_use:2,boss_source:3,drama_new_source:4,drama_source:5,hero_source:6,skill_source:7,form_source:8,call_source:9,artifact_source:10,redbag:11,head:12,chenghao:13,stone_upgrade:14,partner_character:15,arena_source:16,low_treasure:17,high_treasure:18,seerpalace_summon:19,seerpalace_change:20,tanwei:20,sell:21,sell2:22,fenjie:30,hecheng:31,hecheng2:32,upgrade_star:33,halidom:34,heaven_book:35,item_sell:37},ItemConsumeType:{use:1,sell:2,resolve:3,special:4},checkIsEquip:function(t){return t==this.item_type.WEAPON||t==this.item_type.SHOE||t==this.item_type.CLOTHES||t==this.item_type.HAT},checkIsArtifact:function(t){return t==a.item_type.ARTIFACTCHIPS},quality_color:function(t){return t==this.quality.green?gdata("color_data","data_color16",178):t==this.quality.blue?gdata("color_data","data_color16",203):t==this.quality.purple?gdata("color_data","data_color16",185):t==this.quality.orange?gdata("color_data","data_color16",184):t==this.quality.red?gdata("color_data","data_color16",206):gdata("color_data","data_color16",1)},getAttrValue:function(t,e){if(null==t||""==t||null==e||0==e)return 0;var i=gdata("attr_data","data_type",t);return null==i||1==i?e:.1*e+"%"},getEquipTipsColor:function(t){return(t=t||0)==this.quality.red?new cc.Color(255,156,151,255):t==this.quality.orange?new cc.Color(255,237,139,255):t==this.quality.purple?new cc.Color(212,174,255,255):t==this.quality.blue?new cc.Color(152,251,255,255):t==this.quality.green?new cc.Color(139,255,142,255):new cc.Color(217,217,217,255)}};a.tips_btn_title=(n(s={},a.tips_btn_type.source,"\u6765\u6e90"),n(s,a.tips_btn_type.goods_use,"\u4f7f\u7528"),n(s,a.tips_btn_type.boss_source,"\u4f7f\u7528"),n(s,a.tips_btn_type.drama_new_source,"\u4f7f\u7528"),n(s,a.tips_btn_type.drama_source,"\u4f7f\u7528"),n(s,a.tips_btn_type.hero_source,"\u4f7f\u7528"),n(s,a.tips_btn_type.skill_source,"\u4f7f\u7528"),n(s,a.tips_btn_type.form_source,"\u4f7f\u7528"),n(s,a.tips_btn_type.call_source,"\u4f7f\u7528"),n(s,a.tips_btn_type.artifact_source,"\u91cd\u94f8"),n(s,a.tips_btn_type.redbag,"\u4f7f\u7528"),n(s,a.tips_btn_type.head,"\u4f7f\u7528"),n(s,a.tips_btn_type.chenghao,"\u4f7f\u7528"),n(s,a.tips_btn_type.stone_upgrade,"\u4f7f\u7528"),n(s,a.tips_btn_type.partner_character,"\u4f7f\u7528"),n(s,a.tips_btn_type.arena_source,"\u4f7f\u7528"),n(s,a.tips_btn_type.low_treasure,"\u4f7f\u7528"),n(s,a.tips_btn_type.high_treasure,"\u4f7f\u7528"),n(s,a.tips_btn_type.tanwei,"\u6446\u644a"),n(s,a.tips_btn_type.sell,"\u51fa\u552e"),n(s,a.tips_btn_type.sell2,"\u51fa\u552e"),n(s,a.tips_btn_type.fenjie,"\u5206\u89e3"),n(s,a.tips_btn_type.hecheng,"\u5408\u6210"),n(s,a.tips_btn_type.hecheng2,"\u5408\u6210"),n(s,a.tips_btn_type.upgrade_star,"\u4f7f\u7528"),n(s,a.tips_btn_type.seerpalace_summon,"\u4f7f\u7528"),n(s,a.tips_btn_type.seerpalace_change,"\u4f7f\u7528"),n(s,a.tips_btn_type.halidom,"\u4f7f\u7528"),n(s,a.tips_btn_type.item_sell,"\u51fa\u552e"),s),a.item_effect_type={GOLD:1,COIN:2,EXP:3,PARTNER_EXP:4,PARTNER_DEBRIS:5,BUFF:6,PARTNER:7,GIFT:8},a.getWhiteQualityColorStr=function(t){return(t=t||0)==a.quality.red?Config.color_data.data_color16[206]:t==a.quality.orange?Config.color_data.data_color16[184]:t==a.quality.purple?Config.color_data.data_color16[185]:t==a.quality.blue?Config.color_data.data_color16[203]:t==a.quality.green?Config.color_data.data_color16[178]:Config.color_data.data_color16[274]},a.checkoutIsWeekCard=function(t){return!!t&&t==a.item_type.WEEK_CARD},a.checkIsHeroSkin=function(t){return!!t&&t==a.item_type.HERO_SKIN},e.exports=a,cc._RF.pop()},{}],backpack_controller:[function(t,e,i){"use strict";cc._RF.push(e,"454feBZaSJINIbY0IysJHCJ","backpack_controller");var s=t("backpack_const"),n=t("mainui_controller"),a=t("mainui_const"),o=t("backpack_event"),l=t("jump_controller"),r=t("tips_controller"),c=t("guide_controller"),_=cc.Class({extends:BaseController,ctor:function(){},initConfig:function(){var e=t("backpack_model");this.model=new e,this.model.initConfig()},getModel:function(){return this.model},registerEvents:function(){null==this.login_event_success&&(this.login_event_success=gcore.GlobalEvent.bind(EventId.EVT_ROLE_CREATE_SUCCESS,function(){this.requestInitProto()}.bind(this))),null==this.re_link_game&&(this.re_link_game=gcore.GlobalEvent.bind(EventId.EVT_RE_LINK_GAME,function(){t("guide_controller").getInstance().isInGuide()||this.openMainWindow(!1)}.bind(this)))},registerProtocals:function(){this.RegisterProtocal(10500,this.on10500),this.RegisterProtocal(10501,this.on10501),this.RegisterProtocal(10510,this.on10510),this.RegisterProtocal(10511,this.on10511),this.RegisterProtocal(10512,this.on10512),this.RegisterProtocal(10515,this.handle10515),this.RegisterProtocal(10522,this.handle10522),this.RegisterProtocal(10523,this.handle10523),this.RegisterProtocal(11008,this.handle11008)},requestInitProto:function(){},sender10500:function(){this.SendProtocal(10500,{})},sender10501:function(){this.SendProtocal(10501,{})},on10500:function(t){t.bag_code=s.Bag_Code.BACKPACK,this.model.initItemList(t)},on10501:function(t){t.bag_code=s.Bag_Code.EQUIPS,this.model.initItemList(t)},on10510:function(t){cc.log("\u589e\u52a0\u4e00\u4e2a\u7269\u54c1",t),this.model.updateBagItemsNum(t)},on10511:function(t){cc.log("\u5220\u9664\u4e00\u4e2a\u7269\u54c1",t),this.model.deleteBagItems(t)},on10512:function(t){this.model.updateBagItemsNum(t,!0)},sender10522:function(t,e){var i={};i.storage=t,i.args=e,this.SendProtocal(10522,i)},handle10522:function(t){message(t.msg),this.batch_use&&this.openBatchUseItemView(!1),this.sell_window&&this.openSellWindow(!1),this.closeGiftSelectPanel(),gcore.GlobalEvent.fire(o.Sell_Goods_Success)},sender10515:function(t,e,i){var s={};s.id=t,s.quantity=e,s.args=i||{},this.SendProtocal(10515,s)},handle10515:function(t){message(t.msg),1==t.flag&&(this.openBatchUseItemView(!1),this.closeGiftSelectPanel())},sender10523:function(t,e){var i={};i.id=t,i.num=e,this.SendProtocal(10523,i)},handle10523:function(t){message(t.msg),1==t.flag&&(gcore.GlobalEvent.fire(o.Compose_Goods_Success),r.getInstance().showBackPackCompTips(!1))},sender11008:function(t,e){var i={};i.bid=t,i.num=e,this.SendProtocal(11008,i)},handle11008:function(t){if(gcore.GlobalEvent.fire(o.Compose_BackPack_Success),message(t.msg),r.getInstance().showBackPackCompTips(!1),r.getInstance().showCompChooseTips(!1),1==t.result){var e=[];for(var i in t.partners){var s=t.partners[i],l=Config.partner_data.data_partner_base[s.partner_bid];e[parseInt(i)]={},e[parseInt(i)].bid=s.partner_bid,e[parseInt(i)].star=l.init_star,e[parseInt(i)].camp_type=l.camp_type,e[parseInt(i)].show_type=a.item_exhibition_type.partner_type}n.getInstance().openGetItemView(!0,e,0)}},openMainWindow:function(t,e){t?(null==this.backpack_win&&(this.backpack_win=Utils.createClass("backpack_window")),this.backpack_win.open(e)):this.backpack_win&&(this.backpack_win.close(),this.backpack_win=null)},openTipsSource:function(e,i,s,n){if(e){if(c.getInstance().isInGuide())return;if("number"==typeof i&&(i=Utils.getItemConfig(i)),null==i)return;if(!this.tips_source){var a=t("tips_source_window");this.tips_source=new a(this)}var o={};o.data=i,o.extend_data=s,o.item_list=n,this.tips_source.open(o)}else this.tips_source&&(this.tips_source.close(),this.tips_source=null)},openItemSellPanel:function(t,e,i){if(0==t)null!=this.item_sell_panel&&(this.item_sell_panel.close(),this.item_sell_panel=null);else{i=i||s.Bag_Code.BACKPACK;null==this.item_sell_panel&&(this.item_sell_panel=Utils.createClass("item_sell_panel_window",this)),0==this.item_sell_panel.isOpen()&&this.item_sell_panel.open([e,i])}},openBatchUseItemView:function(t,e,i,s){if(0==t)null!=this.batch_use&&(this.batch_use.close(),this.batch_use=null);else{if(null==e||null==e.config)return;null==this.batch_use&&(this.batch_use=Utils.createClass("backpack_batchuse_window",this)),this.batch_use&&0==this.batch_use.isOpen()&&this.batch_use.open([e,i,s])}},openSellWindow:function(t,e,i){if(0==t)null!=this.sell_window&&(this.sell_window.close(),this.sell_window=null);else{if(e=e||s.Bag_Code.BACKPACK,null==i||null==Utils.next(i))return;null==this.sell_window&&(this.sell_window=Utils.createClass("backpack_sell_window",this)),0==this.sell_window.isOpen()&&this.sell_window.open(e,i)}},openGiftSelectPanel:function(t){null==this.gift_panel&&(this.gift_panel=Utils.createClass("gift_select_window",this)),this.gift_panel&&0==this.gift_panel.isOpen()&&this.gift_panel.open(t)},closeGiftSelectPanel:function(){null!=this.gift_panel&&(this.gift_panel.close(),this.gift_panel=null)},gotoItemSources:function(e,i,n,a){if(null!=e&&null!=i)if("evt_partner_call"==e)l.getInstance().jumpViewByEvtData([1]);else if("evt_mall_buy"==e)i[0]&&l.getInstance().jumpViewByEvtData([15,i[0],n]);else if("evt_vip"==e)l.getInstance().jumpViewByEvtData([7,VIPTABCONST.VIP,i[0]]);else if("evt_boss"==e);else if("evt_world_boss"==e);else if("evt_tower"==e)l.getInstance().jumpViewByEvtData([12]);else if("evt_divination"==e);else if("evt_dun_chapter"==e)l.getInstance().jumpViewByEvtData([5]);else if("evt_gold_market"==e);else if("evt_silver_market"==e);else if("evt_arena"==e)l.getInstance().jumpViewByEvtData([3]);else if("evt_arena_box"==e)l.getInstance().jumpViewByEvtData([3]);else if("evt_bag_eqm"==e)l.getInstance().jumpViewByEvtData([8,s.item_tab_type.EQUIPS]);else if("evt_bag_partner"==e)l.getInstance().jumpViewByEvtData([8,s.item_tab_type.HERO]);else if("evt_dun_stone"==e)l.getInstance().jumpViewByEvtData([17]);else if("evt_bag_star_life"==e)l.getInstance().jumpViewByEvtData([8,s.item_tab_type.SPECIAL]);else if("evt_friend"==e)l.getInstance().jumpViewByEvtData([4]);else if("evt_league"==e)l.getInstance().jumpViewByEvtData([14]);else if("evt_league_dungeon"==e)l.getInstance().jumpViewByEvtData([31]);else if("evt_league_donate"==e)l.getInstance().jumpViewByEvtData([13]);else if("evt_league_sail"==e)l.getInstance().jumpViewByEvtData([18]);else if("evt_league_skill"==e)l.getInstance().jumpViewByEvtData([32]);else if("evt_league_shop"==e){var o=t("mall_const");l.getInstance().jumpViewByEvtData([15,o.MallType.UnionShop])}else if("evt_league_redpacket"==e)l.getInstance().jumpViewByEvtData([33]);else if("evt_league_war"==e)l.getInstance().jumpViewByEvtData([21]);else if("evt_god_world"==e)l.getInstance().jumpViewByEvtData([34]);else if("evt_league_help"==e);else if("evt_exchange"==e)l.getInstance().jumpViewByEvtData([35]);else if("evt_arena_champion"==e)l.getInstance().jumpViewByEvtData([36]);else if("evt_endless"==e)l.getInstance().jumpViewByEvtData([43]);else if("evt_partner_power"==e);else if("evt_hero"==e);else if("evt_pet"==e){var r=t("mainui_controller"),c=t("battle_const");r.getInstance().requestOpenBattleRelevanceWindow(c.Fight_Type.Escort)}else if("evt_shengqi"==e)l.getInstance().jumpViewByEvtData([20]);else if("evt_xingming"==e)l.getInstance().jumpViewByEvtData([12]);else if("evt_primus"==e)l.getInstance().jumpViewByEvtData([27]);else if("evt_skyladder"==e)l.getInstance().jumpViewByEvtData([29]);else if("evt_skyshop"==e)l.getInstance().jumpViewByEvtData([37]);else if("evt_change"==e)l.getInstance().jumpViewByEvtData([7]);else if("evt_yueke"==e);else if("evt_invest"==e)l.getInstance().jumpViewByEvtData([38]);else if("evt_growfund"==e)l.getInstance().jumpViewByEvtData([39]);else if("evt_partner"==e)l.getInstance().jumpViewByEvtData([19]);else if("evt_partner_gemstone"==e);else if("evt_lucky_treasure"==e||"evt_treasure"==e)l.getInstance().jumpViewByEvtData([40]);else if("evt_recruit_high"==e){var _=t("seerpalace_const");l.getInstance().jumpViewByEvtData([24,_.Tab_Index.Summon])}else if("evt_hero_conversion"==e){_=t("seerpalace_const");l.getInstance().jumpViewByEvtData([24,_.Tab_Index.Change])}else if("evt_partner_synthesis"==e)l.getInstance().jumpViewByEvtData([23]);else if("evt_partner_decompose"==e)l.getInstance().jumpViewByEvtData([22]);else if("evt_partner_eqm_synthesis"==e)l.getInstance().jumpViewByEvtData([26]);else if("evt_expedition"==e)l.getInstance().jumpViewByEvtData([25]);else if("evt_grocery_store"==e)l.getInstance().jumpViewByEvtData([6]);else if("evt_daily_quest"==e)l.getInstance().jumpViewByEvtData([41]);else if("evt_achievement"==e){var h=t("task_const");l.getInstance().jumpViewByEvtData([41,h.type.feat])}else if("evt_rune_synthesis"==e){var d=t("forgehouse_const");l.getInstance().jumpViewByEvtData([26,d.Tab_Index.Artifact])}else if("evt_skillshop"==e){o=t("mall_const");l.getInstance().jumpViewByEvtData([15,o.MallType.SkillShop])}else if("evt_eliteshop"==e){o=t("mall_const");l.getInstance().jumpViewByEvtData([15,o.MallType.EliteShop])}else"evt_elitematch"==e?l.getInstance().jumpViewByEvtData([28]):"evt_element_temple"==e?l.getInstance().jumpViewByEvtData([42]):message("\u6682\u65e0\u8df3\u8f6c\uff0c\u6216\u8005\u8fd8\u6ca1\u6dfb\u52a0\uff01")},getBackpackRoot:function(){if(this.backpack_win)return this.backpack_win.root_wnd}});e.exports=_,cc._RF.pop()},{backpack_const:"backpack_const",backpack_event:"backpack_event",backpack_model:"backpack_model",battle_const:"battle_const",forgehouse_const:"forgehouse_const",guide_controller:"guide_controller",jump_controller:"jump_controller",mainui_const:"mainui_const",mainui_controller:"mainui_controller",mall_const:"mall_const",seerpalace_const:"seerpalace_const",task_const:"task_const",tips_controller:"tips_controller",tips_source_window:"tips_source_window"}],backpack_event:[function(t,e,i){"use strict";cc._RF.push(e,"5acddhG0tNLuKoRGXzmGN9X","backpack_event"),e.exports={GET_ALL_DATA:"GET_ALL_DATA",ADD_GOODS:"ADD_GOODS",MODIFY_GOODS_NUM:"MODIFY_GOODS_NUM",DELETE_GOODS:"DELETE_GOODS",Sell_Goods_Success:"Sell_Goods_Success",Compose_Goods_Success:"Compose_Goods_Success",Compose_BackPack_Success:"Compose_BackPack_Success"},cc._RF.pop()},{}],backpack_item:[function(t,e,i){"use strict";cc._RF.push(e,"c1792XCGydEfreAmtsIWmra","backpack_item");var s=t("pathtool"),n=t("goods_vo"),a=(s=t("pathtool"),t("backpack_const"));cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("backpack","goods_item"),this.scale=1,this.is_other=!1,this.effect=!0,this.is_show_tips=!0,this.item_config=null,this.item_num=0,this.load_item_icon={},this.before_over_set=!1,this.star_list=[],this.show_check_box=!1,arguments&&arguments.length>0&&(this.is_other=arguments[0]||!1,this.scale=arguments[1]||1,this.effect=arguments[2]||!1,this.is_show_tips=arguments[3]||!1,this.is_show_name=arguments[4]||!1,this.before_over_set=!0),this.isUnEnabled=!1,this.isShowBiaoQian=!1,this.biaoQianStr="",this.name_color=null,this.name_size=18,this.isSetEffect=!1,this.isCache=!0,this.isShowOrderWarLock=!1,this.is_show_get_select=!1},initPanel:function(){if(this.main_container=this.root_wnd.getChildByName("main_container"),this.block_event=this.root_wnd.getComponent(cc.BlockInputEvents),this.item=this.main_container.getChildByName("icon"),this.item_icon=this.main_container.getChildByName("icon").getComponent(cc.Sprite),this.quality_bg=this.main_container.getChildByName("background").getComponent(cc.Sprite),this.num_bg=this.main_container.getChildByName("num_bg"),this.num_background=this.num_bg.getChildByName("background"),this.num_bg_size=this.num_background.getContentSize(),this.num=this.num_bg.getChildByName("num"),this.num_label=this.num.getComponent(cc.Label),this.select=this.main_container.getChildByName("select"),this.star_node=this.main_container.getChildByName("star_node"),this.star=this.star_node.getChildByName("star"),this.chip=this.main_container.getChildByName("chip"),this.red_tips=this.main_container.getChildByName("red_tips"),this.progress_node=this.main_container.getChildByName("progress"),this.progress=this.progress_node.getComponent(cc.ProgressBar),this.progress_label=this.progress_node.getChildByName("label").getComponent(cc.Label),this.camp=this.main_container.getChildByName("camp"),this.camp_sprite=this.camp.getComponent(cc.Sprite),this.extend_tag=this.main_container.getChildByName("extend_tag"),this.extend_desc=this.main_container.getChildByName("extend_desc").getComponent(cc.Label),this.play_effect=this.main_container.getChildByName("play_effect").getComponent(sp.Skeleton),this.mark=this.main_container.getChildByName("mark"),this.extend_label=this.seekChild(this.main_container,"extend_label",cc.Label),this.before_over_set&&(this.initSomeSet(),this.before_over_set=!1),this.showItemEffect_cache&&(this.showItemEffect.apply(this,this.showItemEffect_cache),this.showItemEffect_cache=null),this.extend_cache&&(this.setExtendTag.apply(this,this.extend_cache),this.extend_cache=null),this.set_num_bg_cache){var t=this.set_num_bg_cache;this.setNumBgPos(t.pos,t.ar,t.pos1,t.ar1)}null!=this.bg_status&&this.setIsShowBackground(this.bg_status),null!=this.add_btn_bool&&this.showAddIcon(this.add_btn_bool),null!=this.head_icon&&this.setItemIcon(this.head_icon),this.setItemIconUnEnabled(this.isUnEnabled)},registerEvent:function(){},init:function(){this.setPosition(0,0),this.setAnchorPoint(.5,.5),this.scale=1,this.item_res_path=null,this.callback=null,this.actionCallback=null,this.data=null,this.name_color=null,this.name_size=18,this.extend_label&&(this.extend_label.node.y=-71,this.extend_label.string=""),this.empty_icon_path=null,this.initConfig(!1,!1,null,!1,!1),this.progress_node&&(this.progress_node.active=!1),this.setRedStatus(!1),this.setExtendTag(!1),this.showItemEffect(!1),this.setDefaultTip(!1,!1,!1,!1),this.setMaskVisible(!1),this.setItemIconUnEnabled(!1),this.showBiaoQian(!1),this.is_comp_num=null,this.holidHeroExpeditTag(!1),this.showAddIcon(!1),this.setIsShowBackground(!0),this.setReceivedIcon(!1),this.cur_visible=!1,this.set_need_num_cache&&(this.setNeedNum(0,0,null,!1),this.set_need_num_cache=null),this.setDoubleIcon(!1),this.isSummonNumber=null,this.showOrderWarLock(!1),this.IsGetStatus(!1),this.showWeekCardTag(!1),this.num_label&&(this.num_label.string="",this.num_label.node.active=!0),this.num_bg&&(this.num_bg.active=!1,this.num_bg.setPosition(51.8,-41),this.num_bg.setAnchorPoint(1,.5)),this.num_background&&(this.num_background.setPosition(0,0),this.num_background.setAnchorPoint(1,.5),this.num_background.setContentSize(cc.size(30,22))),this.num&&(this.num.setPosition(-2.5,-.1),this.num.setAnchorPoint(1,.5)),this.setSelected(!1)},initConfig:function(t,e,i,s,n){this.is_other=t||!1,this.scale=e||1,this.effect=null==i||i,this.is_show_tips=s||!1,this.is_show_name=n||!1,this.root_wnd?this.initSomeSet():this.before_over_set=!0},initSomeSet:function(){null!=this.root_wnd&&(this.root_wnd.scale=this.scale,null!=this.cache_markselect_status&&(this.setMaskVisible(this.cache_markselect_status),this.cache_markselect_status=null))},onShow:function(){this.root_wnd&&!this.click_event&&(this.root_wnd.on(cc.Node.EventType.TOUCH_END,this.onClickRootWnd,this),this.root_wnd.on(cc.Node.EventType.TOUCH_START,this.onClickRootWnd,this),this.root_wnd.on(cc.Node.EventType.TOUCH_CANCEL,this.onClickRootWnd,this),this.click_event=!0,this.block_event&&(this.block_event.enabled=!0)),this.updateData()},onClickRootWnd:function(e){if(e.type===cc.Node.EventType.TOUCH_START&&this.effect&&(this.root_wnd.scale=.9*(this.scale||1)),e.type===cc.Node.EventType.TOUCH_CANCEL&&this.effect&&(this.root_wnd.scale=this.scale||1),e.type===cc.Node.EventType.TOUCH_END)if(this.effect&&(this.root_wnd.scale=this.scale||1),this.callback)this.callback.apply(null,[this]);else{if(this.is_show_tips&&this.item_config){var i,s=t("tips_controller");if(a.checkIsEquip(this.item_config.type))s.getInstance().showEquipTips(this.item_config);else if(this.data.config?i=this.data.config:this.data.bid?i=Utils.getItemConfig(this.data.bid):this.data&&(i=this.data),i)if(a.checkoutIsWeekCard(i.type))s.getInstance().showWeekCardTips(!0,this.item_config);else if(a.checkIsHeroSkin(i.type)){t("hero_controller").getInstance().openHeroSkinTipsPanel(!0,this.item_config)}else{if(1==this.is_show_source&&i.source&&Utils.next(i.source))t("backpack_controller").getInstance().openTipsSource(!0,i);else this.is_tips_source?s.getInstance().showGoodsTips(i,!0,this.is_tips_source):s.getInstance().showGoodsTips(i);this.source_callback&&this.source_callback()}return}this.actionCallback&&this.actionCallback.apply(null,[this])}},onHide:function(){},setExtendData:function(t){this.initConfig(t.is_other,t.scale,t.effect,t.is_show_tips),this.is_show_chip_loading=t.is_show_chip_loading||!1,null!=t.showCheckBox&&(this.show_check_box=t.showCheckBox),null!=t.checkBoxClickCallBack&&(this.click_check_callback=t.checkBoxClickCallBack),t.adjustCheckBoxPos&&(this.check_box_pos=t.adjustCheckBoxPos),null!=t.is_comp_num&&(this.is_comp_num=t.is_comp_num),t.is_hide_effect&&(this.is_hide_effect=t.is_hide_effect),null!=t.is_camptype&&(this.is_camptype=t.is_camptype),null!=t.isSummonNumber&&(this.isSummonNumber=t.isSummonNumber)},setExtendTag:function(t,e,i){this.extend_tag?t?(this.extend_tag.active=!0,this.extend_desc.node.active=!0,this.extend_desc.string=e):(this.extend_tag.active=!1,this.extend_desc.node.active=!1):this.extend_cache=[t,e,i]},setSelfEffect:function(t){if(!this.isSetEffect)if(1==!this.is_hide_effect)if(t&&t.is_effect&&1==t.is_effect){var e=PlayerAction.action_2;t.quality>=4&&(e=PlayerAction.action_1),this.showItemEffect(!0,156,e,!0)}else this.showItemEffect(!1);else this.showItemEffect(!1)},showItemEffect:function(t,e,i,s,n){if(!this.play_effect)return this.isSetEffect=!0,void(this.showItemEffect_cache=arguments);var a=Config.effect_data.data_effect_info[e];if(t&&a){this.play_effect.node.active=!0,i=i||PlayerAction.action_1;var o=cc.js.formatStr("spine/%s/action.atlas",a);this.loadRes(o,function(t){this.play_effect.skeletonData=t,this.play_effect.setAnimation(0,i,s)}.bind(this))}else this.play_effect.node.active=!1;null!=n&&(this.play_effect.node.scale=n)},addCallBack:function(t){this.callback=t},addActionCallBack:function(t){this.actionCallback=t},setData:function(t,e){this.data=t,this.is_hide_effect=e||!1,this.root_wnd&&(this.root_wnd.scale=this.scale,this.updateData())},setExtendLabel:function(t,e,i){if(e&&(this.name_color=e),i&&i>0&&(this.name_size=i),this.root_wnd){if(t=t||"",this.extend_label.string=t,e){var s=this.extend_label.node.color;"number"==typeof e?s.fromHEX(Config.color_data.data_color16[e]):s.fromHEX(e),this.extend_label.node.color=s}i&&i>0&&(this.extend_label.fontSize=this.name_size,this.extend_label.lineHeight=this.name_size+2)}},updateData:function(){if(null!=this.tmp_index&&this.root_wnd&&(this.root_wnd.name="backpack_item_"+(this.tmp_index+1)),null==this.data)return this.empty_icon_path&&this.setItemIcon(),void this.suspendAllActions();this.item_config=null;var t=0;this.data instanceof n||"GoodsVo"==this.data.type_vo?(this.item_config=this.data.config,t=this.data.quantity,"24802"==this.item_config.id&&(this.main_container.name="item_"+this.item_config.id)):"number"==typeof this.data?this.item_config=Utils.getItemConfig(this.data):this.data instanceof Object&&(null!=this.data.bid&&null!=this.data.num?(this.item_config=Utils.getItemConfig(this.data.bid),t=this.data.num):1==this.data.undata||(this.data.id?this.item_config=Utils.getItemConfig(this.data.id):this.item_config=this.data)),this.setQualityBG(),this.setItemNum(t),this.setItemIcon(),this.setItemChip(),this.setItemStar(),this.setCompNumber(),this.setItemCamp(),this.setSelfEffect(this.item_config),this.expedit_cahe&&this.holidHeroExpeditTag(this.expedit_cahe.status,this.expedit_cahe.desc),this.is_show_name?this.setExtendLabel(this.item_config.name,this.name_color,this.name_size):this.setExtendLabel(),null!=this.data.showSellStatus&&this.setCheckBoxStatus(this.data.showSellStatus.status,this.data.showSellStatus.select),this.isShowBiaoQian&&this.biaoQianStr&&this.showBiaoQian(this.isShowBiaoQian,this.biaoQianStr),this.cache_red_status?(this.setRedStatus(this.cache_red_status),this.cache_red_status=null):this.setRedStatus(!1),null!=this.receivedStatus&&this.setReceivedIcon(this.receivedStatus),null!=this.isSummonNumber&&this.setSummonNumber(),1==this.isShowOrderWarLock&&this.showOrderWarLock(!0),this.IsGetStatus(this.is_show_get_select),this.data&&this.data.bid&&this.setWeekCardData(this.data.bid)},setWeekCardData:function(t){var e=Utils.getItemConfig(t);e&&e.tips_btn?50==this.checkIsWeekCard(e.tips_btn)&&this.showWeekCardTag(!0):this.showWeekCardTag(!1)},setQualityBG:function(t){var e=0;null!=t?e=t:this.item_config&&(e=this.item_config.quality);var i=s.getItemQualityBG(e);if(this.bg_quality!=i){this.bg_quality=i;var n=s.getCommonIcomPath(this.bg_quality);LoaderManager.getInstance().loadRes(n,function(t){this.root_wnd&&this.root_wnd.isValid&&(this.quality_bg.spriteFrame=t)}.bind(this))}},setItemNum:function(t){if(this.is_comp_num)this.num_bg.active=!1;else{if(this.num_bg.active=!1,this.item_num=Utils.getMoneyString(t),null==t||t<=1)this.num_bg.active=!1;else{this.num_bg.active=!0,this.num_label.string=this.item_num;var e=this.num.width;this.num_background.width=e+10}if(this.set_need_num_cache){var i=this.set_need_num_cache;this.setNeedNum(i.need_num,i.num,i.color,i.force)}else this.num_label._forceUpdateRenderData(),this.updateNumBGSize()}},setItemIcon:function(t){if(null!=this.item)if(t&&(this.empty_icon_path=t),null!=this.item_config||this.empty_icon_path){this.item.active=!0;var e=null;e=this.item_config?s.getItemRes(this.item_config.icon):this.empty_icon_path,t&&(e=t),this.item_res_path!=e&&(this.item_res_path=e,this.loadRes(e,function(t,e){this.item_res_path==t&&(this.item_icon.spriteFrame=e)}.bind(this,e)))}else this.item.active=!1;else this.head_icon=t},setItemChip:function(){null==this.item_config||this.item_config.type!=a.item_type.PARTNER_DEBRIS?this.chip.active=!1:this.chip.active=!0},setItemStar:function(){for(var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=0;e<this.star_list.length;e++){this.star_list[e].active=!1}if(null!=this.item_config){var i=0;if(1==t&&(this.checkIsEquip(this.item_config.type)?i=this.item_config.eqm_star:this.item_config.type==a.item_type.PARTNER_DEBRIS?i=this.item_config.eqm_jie:this.item_config.type==a.item_type.ARTIFACTCHIPS&&this.data instanceof n&&(i=this.data.enchant)),i>0)for(var s=12*(1-i)*.5,o=0;o<i;o++){null==this.star_list[o]&&(this.star_list[o]=cc.instantiate(this.star),this.star_list[o].y=this.star.y,this.star_node.addChild(this.star_list[o]));var l=this.star_list[o];l.active=!0,l.x=s+12*o}}},setCompNumber:function(){if(this.is_show_chip_loading&&null!=this.item_config&&null!=this.data&&this.data instanceof n&&this.item_config.type==a.item_type.PARTNER_DEBRIS){var t=gdata("partner_data","data_get_compound_info",this.item_config.id);if(null==t)this.progress_node.active=!1;else{var e=this.data.quantity,i=t.num,s=Math.min(1,Math.max(e/i));this.progress.progress=s,this.progress_label.string=e+"/"+i,this.progress_node.active=!0,s<1?this.setRedStatus(!1):this.setRedStatus(!0)}}else this.progress_node.active=!1},setItemCamp:function(){if(this.item_config&&3==this.item_config.sub_type&&!this.is_camptype&&0!=this.item_config.lev){this.camp.active=!0;var t=this.item_config.lev,e=s.getHeroCampRes(t);if(this.camp_path==e)return;this.camp_path=e;var i=s.getCommonIcomPath(e);LoaderManager.getInstance().loadRes(i,function(t){this.camp_sprite.spriteFrame=t}.bind(this))}else this.camp.active=!1},checkIsEquip:function(t){return t==a.item_type.WEAPON||t==a.item_type.SHOE||t==a.item_type.CLOTHES||t==a.item_type.HAT},setMaskVisible:function(t){this.root_wnd?this.mark.active=t:this.cache_markselect_status=t},setRedStatus:function(t){this.red_tips?this.red_tips.active=!!t:this.cache_red_status=!!t},getItemConfig:function(){return this.item_config},getItemData:function(){return this.data},setItemIconUnEnabled:function(t){if(this.isUnEnabled=t,this.item_icon&&this.item_icon.setMaterial(0,t?cc.Material.getBuiltinMaterial("2d-gray-sprite"):cc.Material.getBuiltinMaterial("2d-sprite")),this.quality_bg&&this.quality_bg.setMaterial(0,t?cc.Material.getBuiltinMaterial("2d-gray-sprite"):cc.Material.getBuiltinMaterial("2d-sprite")),this.extend_tag&&this.extend_tag.active&&this.extend_tag.getComponent(cc.Sprite).setMaterial(0,t?cc.Material.getBuiltinMaterial("2d-gray-sprite"):cc.Material.getBuiltinMaterial("2d-sprite")),this.star_list)for(var e in this.star_list)this.star_list[e].getComponent(cc.Sprite).setMaterial(0,t?cc.Material.getBuiltinMaterial("2d-gray-sprite"):cc.Material.getBuiltinMaterial("2d-sprite"));this.play_effect&&this.play_effect.node&&(this.play_effect.node.color=t?new cc.Color(115,115,115,255):new cc.Color(255,255,255,255))},showBiaoQian:function(t,e){if(this.isShowBiaoQian=t,this.biaoQianStr=e,null!=this.root_wnd){if(!this.qian_icon&&t){var i=s.getCommonIcomPath("common_90015");this.qian_icon=Utils.createImage(this.main_container,null,-23,27,cc.v2(.5,.5),null,10),this.loadRes(i,function(t){this.qian_icon.spriteFrame=t}.bind(this)),this.qian_label=Utils.createLabel(20,new cc.Color(255,255,255,255),new cc.Color(10,15,15,255),5,-5,"",this.qian_icon.node,2,cc.v2(.5,0)),this.qian_label.node.angle=45}this.qian_icon&&(this.qian_icon.node.active=t),this.qian_label&&(e=e||"",this.qian_label.string=e)}},setNeedNum:function(t,e,i,s){if(null==this.set_need_num_cache&&(this.set_need_num_cache={},this.set_need_num_cache.need_num=t,this.set_need_num_cache.num=e,this.set_need_num_cache.color=i,this.set_need_num_cache.force=s),null!=this.root_wnd){var n=!1;((t=t||0)>0||1==s)&&(n=!0);var a=t;null!=e&&(i=t>e?new cc.Color(255,71,71,255):new cc.Color(255,255,255,255),a=(e=Utils.getMoneyString(e))+"/"+(t=Utils.getMoneyString(t))),this.num_label.string=a,this.num_label.node.color=i,this.num_label.node.active=n,this.num_bg.active=n,this.num_label._forceUpdateRenderData(),this.updateNumBGSize()}},updateNumBGSize:function(){var t=this.num.getContentSize().width;t<30&&(t=21),this.num_background.setContentSize(cc.size(t+12,this.num_bg_size.height+2))},holidHeroExpeditTag:function(t,e){if(t&&(this.expedit_cahe={},this.expedit_cahe.status=t,this.expedit_cahe.desc=e),this.root_wnd)if(0==t)this.expedit_cahe=null,this.heroExpeditTag&&(this.heroExpeditTag.node.active=t);else{if(null==this.heroExpeditTag){this.heroExpeditTag=Utils.createImage(this.main_container,null,30,29,cc.v2(.5,.5));var i=s.getCommonIcomPath("common_90081");this.loadRes(i,function(t){this.heroExpeditTag.spriteFrame=t}.bind(this)),this.heroExpeditTag_desc=Utils.createLabel(16,new cc.Color(255,255,255,255),new cc.Color(175,35,58,255),10,12.5,"",this.heroExpeditTag.node,2,cc.v2(.5,.5)),this.heroExpeditTag_desc.node.setRotation(45)}this.heroExpeditTag.node.action=t,this.heroExpeditTag_desc.string=e}},setNumBgPos:function(t,e,i,s){null==this.set_num_bg_cache&&(this.set_num_bg_cache={},this.set_num_bg_cache.pos=t,this.set_num_bg_cache.ar=e,this.set_num_bg_cache.pos1=i,this.set_num_bg_cache.ar1=s),null!=this.root_wnd&&(t&&this.num_bg.setPosition(t.x,t.y),e&&this.num_bg.setAnchorPoint(e),s&&(this.num.setAnchorPoint(s),this.num_background.setAnchorPoint(s)),i&&(this.num_background.setPosition(i.x,i.y),this.num.setPosition(i.x,i.y)))},suspendAllActions:function(){this.setCheckBoxStatus(!1,!1),this.setRedStatus(!1),this.setItemStar(!1),this.setQualityBG(0),this.showWeekCardTag(!1),this.num_bg&&(this.num_bg.active=!1),this.item&&(this.item.active=!1),this.chip&&(this.chip.active=!1),this.camp&&(this.camp.active=!1),this.progress_node&&(this.progress_node.active=!1),this.showItemEffect(!1),this.data=null},setDefaultTip:function(t,e,i,s){this.is_show_tips=null==t||t,this.is_show_source=e||!1,this.source_callback=i,this.is_tips_source=s||!1},showAddIcon:function(t){if(0!=t||this.add_btn_sp)if(null!=this.main_container){if(!this.add_btn_sp){this.add_btn_sp=Utils.createImage(this.main_container,null,0,0,cc.v2(.5,.5)),this.loadRes(s.getCommonIcomPath("common_90026"),function(t){this.add_btn_sp&&(this.add_btn_sp.spriteFrame=t)}.bind(this));var e=this.add_btn_sp.node.addComponent(cc.Button);e.transition=cc.Button.Transition.SCALE,this.callback&&e.node.on(cc.Node.EventType.TOUCH_END,function(){this.callback()},this)}this.add_btn_sp.node.active=t}else this.add_btn_bool=t},setIsShowBackground:function(t){this.bg_status=t,this.quality_bg&&(this.quality_bg.node.active=t)},setEmptyIconPath:function(t){this.empty_icon_path=t},getData:function(){return this.data},setCheckBoxStatus:function(e,i){if(0!=this.show_check_box){if(0==e)null!=this.check_box&&this.check_box.setVisible(!1);else if(null==this.check_box){var s=t("toggle_item");this.check_box=new s,this.check_box_pos?this.check_box.setPosition(this.check_box_pos):this.check_box.setPosition(cc.v2(25,25)),this.check_box.setParent(this.main_container),this.check_box.setVisible(!0),this.check_box.setData(this.data.showSellStatus),this.check_box.addClickCallBack(function(t){null!=this.data&&null!=this.data.id&&this.data.showSellStatus&&(this.data.setGoodsAttr("showSellStatus",{status:!0,select:t}),this.click_check_callback&&this.click_check_callback(t,this))}.bind(this))}else this.check_box.setVisible(!0),this.check_box.setData(this.data.showSellStatus);null==i&&(i=!1),this.check_box&&this.check_box.setSelected(i)}},setReceivedIcon:function(t){if(this.receivedStatus=t,this.root_wnd)if(t){if(null==this.received_icon){this.received_icon=Utils.createImage(this.root_wnd,null,0,0,cc.v2(.5,.5));var e=s.getCommonIcomPath("common_1000");this.loadRes(e,function(t){this.received_icon.spriteFrame=t}.bind(this))}this.setItemIconUnEnabled(!0),this.received_icon.node.active=!0}else this.received_icon&&(this.received_icon.node.active=!1),this.setItemIconUnEnabled(!1)},setDoubleIcon:function(t){t?(null==this.double_icon&&(this.double_icon=Utils.createImage(this.main_container,null,-28,27.5),this.loadRes(s.getUIIconPath("common","txt_cn_common_90008"),function(t){this.double_icon.spriteFrame=t}.bind(this))),this.double_icon.node.active=!0):this.double_icon&&(this.double_icon.node.active=!1)},setSummonNumber:function(){this.root_wnd&&(this.extend_label.string=Number(this.data.probability).toFixed(3)+"%",this.extend_label.fontSize=22,this.extend_label.lineHeight=30,this.extend_label.node.y=-65)},showOrderWarLock:function(t){this.isShowOrderWarLock=t,(0!=t||this.order_war_lock)&&this.root_wnd&&(this.order_war_lock||(this.order_war_lock=Utils.createImage(this.root_wnd,s.getUIIconPath("common","common_90009"),-53,38,cc.v2(.5,.5),!1)),this.order_war_lock.node.active=t)},IsGetStatus:function(t){if(this.is_show_get_select=t,(0!=t||this.is_get_select)&&this.root_wnd){if(!this.is_get_select)this.is_get_select=new cc.Node,this.is_get_select.setContentSize(cc.size(120,120)),this.is_get_select.setAnchorPoint(.5,.5),this.is_get_select.setPosition(0,0),this.root_wnd.addChild(this.is_get_select),Utils.createImage(this.is_get_select,s.getUIIconPath("common","common_1074"),0,0,cc.v2(.5,.5),!1,null,!0).node.setContentSize(cc.size(120,120)),Utils.createImage(this.is_get_select,s.getUIIconPath("common","common_1043"),0,0,cc.v2(.5,.5),!1);this.is_get_select.active=t}},checkIsWeekCard:function(t){var e=0;if(t)for(var i=0;i<t.length;++i){var s=t[i];if(50==s){e=s;break}}return e},showWeekCardTag:function(t){if(1==t){var e=s.getUIIconPath("tips","txt_cn_tips_1");this.use_week_card||(this.use_week_card=Utils.createImage(this.main_container,e,-27,40,cc.v2(.5,.5))),this.use_week_card.node.active=!0}else this.use_week_card&&(this.use_week_card.node.destroy(),this.use_week_card=null)},setSelected:function(t){this.select&&(this.select.active=t)},onDelete:function(){this.heroExpeditTag&&(this.heroExpeditTag.node.destroy(),this.heroExpeditTag=null),this.add_btn_sp&&(this.add_btn_sp.node.destroy(),this.add_btn_sp=null),this.heroExpeditTag_desc&&(this.heroExpeditTag_desc.node.destroy(),this.heroExpeditTag_desc=null),this.check_box&&(this.check_box.deleteMe(),this.check_box=null),this.item_num="",this.isSetEffect=!1,this.item_icon&&(this.item_icon.spriteFrame=null),this.data=null,this.root_wnd&&this.click_event&&(this.root_wnd.off(cc.Node.EventType.TOUCH_END,this.onClickRootWnd,this),this.root_wnd.off(cc.Node.EventType.TOUCH_START,this.onClickRootWnd,this),this.root_wnd.off(cc.Node.EventType.TOUCH_CANCEL,this.onClickRootWnd,this),this.block_event&&(this.block_event.enabled=!1),this.click_event=!1),ItemsPool.getInstance().cacheItem(this)}});cc._RF.pop()},{backpack_const:"backpack_const",backpack_controller:"backpack_controller",goods_vo:"goods_vo",hero_controller:"hero_controller",pathtool:"pathtool",tips_controller:"tips_controller",toggle_item:"toggle_item"}],backpack_model:[function(t,e,i){"use strict";cc._RF.push(e,"8f945muht9P9q6gp3WKcUDC","backpack_model");var s=t("backpack_const"),n=cc.Class({extends:BaseClass,ctor:function(){},properties:{},initConfig:function(){this.item_list={},this.hallows_comp_list={},this.equip_score_list={}},initItemList:function(e){for(var i=t("goods_vo"),n={},a=0;a<e.item_list.length;a++){var o=e.item_list[a],l=new i;l.initAttrData(o),n[o.id]=l,this.updateEquipScoreList(e.bag_code,l)}var r=e.bag_code;this.item_list[r]=n,r==s.Bag_Code.EQUIPS||this.is_init_hero_chip_redpoint||(this.is_init_hero_chip_redpoint=!0,this.getHeroChipRedPoint()),this.setHallowsCompData(),gcore.GlobalEvent.fire(EventId.GET_ALL_DATA,r)},getHeroChipRedPoint:function(){for(var e=this.getAllBackPackArray(s.item_tab_type.HERO),i=!1,n=0;n<e.length;++n){var a=e[n];if(i=this.checkHeroChipRedPoint(a))break}var o=t("mainui_controller"),l=t("mainui_const");o.getInstance().setBtnRedPoint(l.btn_index.backpack,i)},checkHeroChipRedPoint:function(t){if(-1!=t.quality&&t.base_id){var e=Config.partner_data.data_get_compound_info;if(e[t.base_id]&&t.quantity>=e[t.base_id].num)return!0;if(this.hallows_comp_list&&this.hallows_comp_list[t.base_id]&&t.quantity>=this.hallows_comp_list[t.base_id].num)return!0}return!1},updateBagItemsNum:function(e,i){for(var n=t("goods_vo"),a={},o=null,l=0;l<e.item_list.length;l++){var r=e.item_list[l];null==this.item_list[r.storage]&&(this.item_list[r.storage]={});var c=this.item_list[r.storage][r.id];null==c&&(c=new n,this.item_list[r.storage][r.id]=c);var _=null,h=Utils.getItemConfig(r.base_id);if(h.sub_type==s.item_tab_type.HERO&&(_=this.checkHeroChipRedPoint(c)),c.initAttrData(r),null==o&&(o=r.storage),a[r.id]=c,o==s.Bag_Code.EQUIPS&&c&&c.config){var d=c.config.type||1;this.equip_score_list[d]||(this.equip_score_list[d]={}),this.equip_score_list[d][c.id]=c}if(!_&&h.sub_type==s.item_tab_type.HERO&&this.checkHeroChipRedPoint(c)){var u=t("mainui_controller"),m=t("mainui_const");u.getInstance().setBtnRedPoint(m.btn_index.backpack,!0)}}o=o||s.Bag_Code.BACKPACK,i?gcore.GlobalEvent.fire(EventId.MODIFY_GOODS_NUM,o,a):gcore.GlobalEvent.fire(EventId.ADD_GOODS,o,a)},deleteBagItems:function(t){for(var e={},i=null,n=0;n<t.item_list.length;n++){var a=t.item_list[n];if(this.item_list[a.storage]){var o=this.item_list[a.storage][a.id];if(null==i&&(i=a.storage),i==s.Bag_Code.EQUIPS){if(o&&o.config){var l=o.config.type||1;this.equip_score_list[l]||(this.equip_score_list[l]={}),this.equip_score_list[l][o.id]=null}}else if(i==s.Bag_Code.BACKPACK){if(o&&o.config)(l=o.config.type||1)==s.item_type.ARTIFACTCHIPS&&(this.equip_score_list[l]||(this.equip_score_list[l]={}),this.equip_score_list[l][o.id]=null)}o&&(e[a.id]=o,this.item_list[a.storage][a.id]=null)}}i=i||s.Bag_Code.BACKPACK,gcore.GlobalEvent.fire(EventId.DELETE_GOODS,i,e)},getAllBackPackArray:function(t){t=t||s.item_tab_type.EQUIPS;var e=s.Bag_Code.BACKPACK;t==s.item_tab_type.EQUIPS&&(e=s.Bag_Code.EQUIPS);var i=this.item_list[e],n=[];for(var a in i){var o=i[a];o&&o.config&&o.config.sub_type==t&&n.push(o)}return n.length>0&&n.sort(Utils.tableUpperSorter(["quality","sort","base_id"])),n},getBagItemList:function(t){return this.item_list[t]||{}},getItemNumByBid:function(e){var i=gdata("item_data","data_assets_id2label",e);if(i){var s=t("role_controller").getInstance().getRoleVo();return s[i]?s[i]:0}return this.getBackPackItemNumByBid(e)},getPackItemNumByBid:function(t,e){null==t&&(t=s.Bag_Code.BACKPACK);var i=0,n=this.getBagItemList(t);for(var a in n){var o=n[a];o&&o.config&&o.config.id==e&&(i+=o.quantity)}return i},getBackPackItemNumByBid:function(t){return this.getPackItemNumByBid(s.Bag_Code.BACKPACK,t)},getItemListForShare:function(t){var e=t||s.Bag_Code.BACKPACK,i=this.item_list[e],n=[];if(i)for(var a in i)i[a]&&i[a].config&&1===i[a].config.can_share&&n.push(i[a]);return n},getBackPackItemById:function(t){return this.getBagItemById(s.Bag_Code.BACKPACK,t)},getBagItemById:function(t,e){var i=this.getBagItemList(t);if(null!=i&&null!=i[e])return i[e]},getBackPackItemListByType:function(t){var e=[],i=this.getBagItemList(s.Bag_Code.BACKPACK);for(var n in i){var a=i[n];a&&a.config&&a.config.type==t&&e.push(a)}return e},getBackPackItemIdListByBid:function(t){var e=[],i=this.getBagItemList(s.Bag_Code.BACKPACK);for(var n in i){var a=i[n];a&&a.config&&a.config.id==t&&e.push(a.id)}return e},setHallowsCompData:function(){if(null==Utils.next(this.hallows_comp_list)){var t=Config.item_product_data.data_product_data;for(var e in t){var i=t[e];this.hallows_comp_list[i.need_items[0][0]]={bid:i.bid,num:i.need_items[0][1]}}}},getHallowsCompData:function(t){if(!this.hallows_comp_list&&null==Utils.next(this.hallows_comp_list))return this.hallows_comp_list[t]||{}},getAllEquipListByType:function(t){return this.equip_score_list[t]||[]},updateEquipScoreList:function(t,e){if(e&&e.config){var i=e.config.type||1;t==s.Bag_Code.EQUIPS?(this.equip_score_list[i]||(this.equip_score_list[i]={}),this.equip_score_list[i][e.id]=e):t==s.Bag_Code.BACKPACK&&i==s.item_type.ARTIFACTCHIPS&&(this.equip_score_list[i]||(this.equip_score_list[i]={}),this.equip_score_list[i][e.id]=e)}}});e.exports=n,cc._RF.pop()},{backpack_const:"backpack_const",goods_vo:"goods_vo",mainui_const:"mainui_const",mainui_controller:"mainui_controller",role_controller:"role_controller"}],backpack_sell_window:[function(t,e,i){"use strict";cc._RF.push(e,"9095fKXR8FCVLm8dnTW5vou","backpack_sell_window");var s=t("pathtool"),n=t("backpack_const");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("backpack","backpack_sell_window"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Mini,this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){this.item_list=[],this.wait_sell_list=[]},openCallBack:function(){this.background=this.root_wnd.getChildByName("background"),this.container=this.root_wnd.getChildByName("container"),this.total_width=this.container.getContentSize().width,this.cell_resoult=this.container.getChildByName("cell_resoult"),this.cell_resoult.active=!1;var t=cc.instantiate(this.cell_resoult);this.container.addChild(t),this.cancel_btn=this.container.getChildByName("cancel_btn"),this.confirm_btn=this.container.getChildByName("confirm_btn"),this.cancel_btn.getChildByName("label").getComponent(cc.Label).string=Utils.TI18N("\u53d6\u6d88"),this.cell_label=this.confirm_btn.getChildByName("label"),this.win_title=this.container.getChildByName("win_title").getComponent(cc.Label),this.sell_desc=this.container.getChildByName("sell_desc").getComponent(cc.Label),this.sell_title=this.container.getChildByName("sell_title").getComponent(cc.Label)},registerEvent:function(){Utils.onTouchEnd(this.cancel_btn,function(){this.ctrl.openSellWindow(!1)}.bind(this),1),Utils.onTouchEnd(this.background,function(){this.ctrl.openSellWindow(!1)}.bind(this),2),Utils.onTouchEnd(this.confirm_btn,function(){Utils.next(this.wait_sell_list)&&this.bag_code&&this.ctrl.sender10522(this.bag_code,this.wait_sell_list)}.bind(this),1)},openRootWnd:function(t){var e=t[0];this.bag_code=e,this.wait_sell_list=[];var i=[],s=t[1];for(var a in s){var o=s[a];if(null!=o.id&&null!=o.config&&o.config.value&&Utils.next(o.config.value)){for(var l in this.wait_sell_list.push({id:o.id,bid:o.base_id,num:o.quantity}),o.config.value){i[(c=o.config.value[l])[0]]==nil&&(i[c[0]]={id:c[0],num:0}),i[c[0]].num=i[c[0]].num+c[1]*o.quantity}if(this.bag_code==n.Bag_Code.EQUIPS){if(0!=o.enchant){var r=gdata("partner_eqm_data","data_partner_eqm",Utils.getNorKey(o.config.type,o.enchant));if(null!=r&&null!=r.sell&&null!=Utils.next(r.sell))for(var l in r.sell){var c;null==i[(c=r.sell[l])[0]]&&(i[c[0]]={id:c[0],num:0}),i[c[0]].num=i[c[0]].num+c[1]*o.quantity}}var _=0,h=0;for(var l in o.gemstones){var u=Utils.getNorKey(o.config.type,d.lev),m=Config.partner_gemstone_data.data_upgrade[u];m&&Utils.next(m.add)&&(_=m.add[0][0],h+=m.add[0][1])}h>0&&(null==i[_]&&(i[_]={id:_,num:0}),i[_].num=i[_].num+h)}}}this.showSellItemValue(i);var f="";e==n.Bag_Code.BACKPACK?f=Utils.TI18N("\u5206\u89e3"):e==n.Bag_Code.EQUIPS&&(f=Utils.TI18N("\u7194\u70bc")),this.win_title.string=f,this.cell_label.string=f,this.sell_desc.string=cc.js.formatStr(Utils.TI18N("%s\u540e\u7269\u54c1\u5c06\u4e0d\u53ef\u627e\u56de"),f),this.sell_title.string=cc.js.formatStr(Utils.TI18N("%s\u540e\u5c06\u83b7\u5f97\u4e0b\u5217\u7269\u54c1\uff1a"),f)},showSellItemValue:function(t){if(null!=t&&this.cell_resoult){var e=0,i=null,n=[],a=0,o=this.cell_resoult.y,l=this.cell_resoult.getContentSize().width,r=this.cell_resoult.getContentSize().height;for(var c in t){var _=t[c],h=Utils.getItemConfig(_.id);null!=h&&(e+=1,(i=cc.instantiate(this.cell_resoult)).active=!0,this.container.addChild(i),i.img=i.getChildByName("item_img").getComponent(cc.Sprite),this.loadRes(s.getItemRes(h.icon),function(t){i.img.spriteFrame=t}.bind(this)),i.value=i.getChildByName("value").getComponent(cc.Label),i.value.string=Math.floor(_.num),n.push(i),e<4&&(a+=i.getContentSize().width))}var d=Math.floor((n.length-1)/3)+1,u=.5*(this.total_width-18*(n.length-1)-a),m=o+(d-1)*r;for(var c in d>=2&&(m-=10),n){var f=u+(c-1)%3*(l+18),p=m-Math.floor((c-1)/3)*(r+10);item.setPosition(f,p)}}},closeCallBack:function(){this.ctrl.openSellWindow(!1)}});cc._RF.pop()},{backpack_const:"backpack_const",pathtool:"pathtool"}],backpack_tips:[function(t,e,i){"use strict";cc._RF.push(e,"c647bBeNapBd5w/+6QcPHj2","backpack_tips");var s=t("pathtool"),n=t("tips_const"),a=t("goods_vo"),o=t("backpack_const"),l=t("string_util"),r=t("backpack_controller");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("tips","backpack_tips"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Tips},initConfig:function(){this.tips_controller=t("tips_controller").getInstance(),this.btn_list={}},openCallBack:function(){this.background=this.seekChild("background"),this.container=this.seekChild("container"),this.container_init_height=this.container.height,this.close_btn=this.seekChild("close_btn"),this.base_panel=this.seekChild(this.container,"base_panel"),this.goods_item=ItemsPool.getInstance().getItem("backpack_item"),this.goods_item.setParent(this.base_panel),this.goods_item.initConfig(!1,1,!1,!1),this.goods_item.setPosition(-134,-68),this.goods_item.show(),this.name=this.seekChild(this.base_panel,"name"),this.equip_type=this.seekChild(this.base_panel,"equip_type",cc.Label),this.extend_desc=this.seekChild(this.base_panel,"extend_desc",cc.RichText),this.usedesc_panel=this.seekChild(this.container,"usedesc_panel"),this.use_desc=this.seekChild(this.usedesc_panel,"desc",cc.Label),this.usedesc_panel_height=this.usedesc_panel.height,this.desc_panel=this.seekChild(this.container,"desc_panel"),this.desc_panel_height=this.desc_panel.height,this.scroll_view=this.seekChild(this.desc_panel,"content"),this.desc_label=this.seekChild(this.scroll_view,"desc_label"),this.tab_panel=this.seekChild(this.container,"tab_panel"),this.tab_panel_height=this.tab_panel.height;for(var t=0;t<3;t++){var e=this.seekChild(this.tab_panel,"tab_btn_"+(t+1));if(e){var i={};i.btn=e,i.label=e.getChildByName("Label").getComponent(cc.Label),this.btn_list[t+1]=i}}},registerEvent:function(){this.background.on(cc.Node.EventType.TOUCH_END,function(t){this.tips_controller.closeTIpsByType(n.type.GOODS)}.bind(this)),this.close_btn.on(cc.Node.EventType.TOUCH_END,function(t){this.tips_controller.closeTIpsByType(n.type.GOODS)}.bind(this))},openRootWnd:function(t){var e=(t=t||{}).data,i=t.show;this.is_special_source=t.is_special_source,this.item_config=null,this.item_config="number"==typeof e?Utils.getItemConfig(e):e instanceof a?e.config:e,null!=this.item_config?(this.data=e,this.goods_item.setData(this.item_config),this.resetLayout(i)):this.tips_controller.closeTIpsByType(n.type.GOODS)},resetLayout:function(t){t=t||!1;var e=this.container_init_height;t||(this.tab_panel.active=!1,e-=this.tab_panel_height);var i=!0;null!=this.item_config.use_desc&&""!=this.item_config.use_desc||(i=!1,this.usedesc_panel.active=!1,e-=this.usedesc_panel_height),this.container_init_height!=e&&(this.container.height=e,i?(this.usedesc_panel.y=this.base_panel.y-this.base_panel.height,this.desc_panel.y=this.usedesc_panel.y-this.usedesc_panel.height):this.desc_panel.y=this.base_panel.y-this.base_panel.height),t&&this.updateBtnList(),this.setBaseInfo()},updateBtnList:function(){if(null!=this.item_config){this.item_config.type;for(var t in this.btn_list){(r=this.btn_list[t]).btn&&(r.btn.active=!1)}var e=[];this.is_special_source?1==this.is_special_source?e.push(o.tips_btn_type.source):2==this.is_special_source&&e.push(o.tips_btn_type.heaven_book):e=this.item_config.tips_btn||[];var i=e.length;if(1==i){var s=this.btn_list[1],n=this.btn_list[3];s.btn.x=n.btn.x}else if(2==i){s=this.btn_list[1];var a=this.btn_list[2];s.btn.x=-110,a.btn.x=110}for(var l=0;l<e.length;l++){if(l>2)return;var r;if((r=this.btn_list[l+1])&&r.btn){var c=e[l],_=o.tips_btn_title[c]||"";r.btn.active=!0,r.label.string=Utils.TI18N(_),r.btn.on(cc.Node.EventType.TOUCH_END,function(t,e){this.gotoSources(t)}.bind(this,c))}}}},gotoSources:function(e){if(this.item_config)if(this.tips_controller.closeTIpsByType(n.type.GOODS),e==o.tips_btn_type.source)this.item_config.source.length>0?r.getInstance().openTipsSource(!0,this.data):message(Utils.TI18N("\u6682\u65f6\u6ca1\u6709\u6765\u6e90"));else if(e==o.tips_btn_type.sell)if(this.data.quantity<=1);else{if(!this.sell_vo)return;r.getInstance().openBatchUseItemView(!0,this.data,o.ItemConsumeType.sell,{type:1,value_list:this.sell_vo})}else if(e==o.tips_btn_type.goods_use){var i=this.item_config.use_type||1;if(this.data&&this.data.id&&i==o.item_use_type.BATCH_USE){var s=this.data.quantity||0;this.item_config.type==o.item_type.FREE_GIFT?r.getInstance().openGiftSelectPanel(this.data):1==s?r.getInstance().sender10515(this.data.id||0,s):r.getInstance().openBatchUseItemView(!0,this.data)}}else if(e==o.tips_btn_type.boss_source);else if(e==o.tips_btn_type.drama_new_source){var a=t("mainui_controller"),l=t("mainui_const");a.getInstance().changeMainUIStatus(l.btn_index.drama_scene)}else if(e==o.tips_btn_type.drama_source){a=t("mainui_controller"),l=t("mainui_const");a.getInstance().changeMainUIStatus(l.btn_index.drama_scene)}else if(e==o.tips_btn_type.hero_source){a=t("mainui_controller"),l=t("mainui_const");a.getInstance().changeMainUIStatus(l.btn_index.partner)}else if(e==o.tips_btn_type.skill_source){t("hero_controller").getInstance().openHeroBagWindow(!0)}else if(e==o.tips_btn_type.form_source){a=t("mainui_controller"),l=t("mainui_const");a.getInstance().changeMainUIStatus(l.btn_index.partner)}else if(e==o.tips_btn_type.call_source){t("partnersummon_controller").getInstance().openPartnerSummonWindow(!0)}else if(e==o.tips_btn_type.artifact_source);else if(e==o.tips_btn_type.seerpalace_summon){var c=t("seerpalace_controller"),_=t("seerpalace_const");c.getInstance().openSeerpalaceMainWindow(!0,_.Tab_Index.Summon)}else if(e==o.tips_btn_type.seerpalace_change){c=t("seerpalace_controller"),_=t("seerpalace_const");c.getInstance().openSeerpalaceMainWindow(!0,_.Tab_Index.Change)}else if(e==o.tips_btn_type.hecheng2);else if(e==o.tips_btn_type.fenjie){[].push({id:this.data.id,bid:this.data.base_id,num:this.data.quantity}),r.getInstance().openBatchUseItemView(!0,this.data,o.ItemConsumeType.resolve)}else if(e==o.tips_btn_type.redbag){var h=t("role_controller").getInstance().getRoleVo();if(h&&0!=h.gid&&""!=h.gsrid){var d=1;this.data&&this.data.config&&this.data.config.client_effect&&null!=Utils.next(this.data.config.client_effect||{})&&this.data.config.client_effect[0]&&(d=this.data.config.client_effect[0]),t("redbag_controller").getInstance().openMainView(!0,d)}else message(Utils.TI18N("\u672a\u52a0\u5165\u516c\u4f1a\u4e0d\u80fd\u53d1\u7ea2\u5305\u54e6\uff01"))}else if(e==o.tips_btn_type.head){t("role_controller").getInstance().openRoleDecorateView(!0,2)}else if(e==o.tips_btn_type.chenghao){t("role_controller").getInstance().openRoleDecorateView(!0,4)}else if(e==o.tips_btn_type.partner_character){if(this.data.config){var u={};u.id=this.data.config.id,t("role_controller").getInstance().openRoleDecorateView(!0,3,u)}}else if(e==o.tips_btn_type.arena_source){t("arena_controller").getInstance().requestOpenArenaLoopMathWindow(!0)}else if(e==o.tips_btn_type.stone_upgrade);else if(e==o.tips_btn_type.upgrade_star);else if(e==o.tips_btn_type.low_treasure){t("action_controller").getInstance().openLuckyTreasureWin(!0)}else if(e==o.tips_btn_type.high_treasure){t("action_controller").getInstance().openLuckyTreasureWin(!0,2)}else e==o.tips_btn_type.halidom||e==o.tips_btn_type.item_sell&&r.getInstance().openItemSellPanel(!0,this.data,o.Bag_Code.BACKPACK)},setBaseInfo:function(){if(null!=this.item_config){this.extend_desc.string="";var t=o.quality_color(this.item_config.quality),e=this.name.color;e.fromHEX(t),this.name.color=e,this.name.getComponent(cc.Label).string=this.item_config.name,this.equip_type.string=Utils.TI18N("\u7c7b\u578b:")+this.item_config.type_desc,this.use_desc.string=this.item_config.use_desc||"",this.item_config.desc?this.desc_label.getComponent(cc.RichText).string="<color=#a1978b>"+l.parse(this.item_config.desc)+"</c>":this.desc_label.getComponent(cc.RichText).string="",this.scroll_view.height=this.desc_label.height}},closeCallBack:function(){this.goods_item&&this.goods_item.deleteMe(),this.goods_item=null,this.tips_controller.closeTIpsByType(n.type.GOODS)}});cc._RF.pop()},{action_controller:"action_controller",arena_controller:"arena_controller",backpack_const:"backpack_const",backpack_controller:"backpack_controller",goods_vo:"goods_vo",hero_controller:"hero_controller",mainui_const:"mainui_const",mainui_controller:"mainui_controller",partnersummon_controller:"partnersummon_controller",pathtool:"pathtool",redbag_controller:"redbag_controller",role_controller:"role_controller",seerpalace_const:"seerpalace_const",seerpalace_controller:"seerpalace_controller",string_util:"string_util",tips_const:"tips_const",tips_controller:"tips_controller"}],backpack_window:[function(t,e,i){"use strict";cc._RF.push(e,"5b39cJSdOdAzKauqpdNdx1I","backpack_window");var s=t("pathtool"),n=t("backpack_controller"),a=t("backpack_const"),o=t("common_scrollview"),l=t("tips_const"),r=t("backpack_event"),c=t("guide_controller");cc.Class({extends:BaseView,ctor:function(){this.rleasePrefab=!1,this.prefabPath=s.getPrefabPath("backpack","backpack_window"),this.viewTag=SCENE_TAG.ui,this.win_type=WinType.Full},initConfig:function(){this.panel_list={},this.tab_list={},this.min_size=30,this.col_size=5,this.normal_color=new cc.Color(211,180,155,255),this.normal_outlinecolor=new cc.Color(64,34,21,255),this.select_color=new cc.Color(255,255,255,255),this.select_outlinecolor=new cc.Color(109,53,7,255)},openCallBack:function(){var t=[Utils.TI18N("\u88c5\u5907"),Utils.TI18N("\u9053\u5177"),Utils.TI18N("\u788e\u7247"),Utils.TI18N("\u7279\u6b8a")];this.mainContainer=this.root_wnd.getChildByName("main_container"),this.title_effect=this.mainContainer.getChildByName("title_img").getComponent(sp.Skeleton);var e=s.getSpinePath(s.getEffectRes(640),"action");this.loadRes(e,function(t){this.title_effect.skeletonData=t,this.title_effect.setAnimation(0,PlayerAction.stand,!0)}.bind(this)),this.background=this.seekChild("background"),this.background.scale=FIT_SCALE;for(var i=this.seekChild("tab_container"),n=0;n<4;n++){var a={},l=n+1;a.btn=i.getChildByName("tab_btn_"+l),a.normal=a.btn.getChildByName("normal"),a.select=a.btn.getChildByName("select"),a.red_point=a.btn.getChildByName("red_point"),a.title=a.btn.getChildByName("label"),a.title_label=a.title.getComponent(cc.Label),a.title_outline=a.title.getComponent(cc.LabelOutline),a.title_label.string=t[n],a.index=l,this.tab_list[l]=a}var r=this.seekChild("container"),_=cc.size(620,600);this.item_scrollview=new o,this.item_scrollview.createScroll(r,cc.v2(0,-30),ScrollViewDir.vertical,ScrollViewStartPos.top,_,{item_class:"backpack_item",start_x:0,space_x:4,start_y:0,space_y:10,item_width:120,item_height:120,row:5,col:5,once_num:5,need_dynamic:!0},cc.v2(.5,.5)),c.getInstance().isInGuide()&&this.item_scrollview.setClickEnabled(!1)},registerEvent:function(){var t=this,e=function(){var e=t.tab_list[i];e.btn&&e.btn.on(cc.Node.EventType.TOUCH_END,function(t){this.changeTabView(e.index)}.bind(t))};for(var i in this.tab_list)e();this.addGlobalEvent(EventId.ADD_GOODS,function(t,e){this.updateBackPack(t,e)}.bind(this)),this.addGlobalEvent(EventId.DELETE_GOODS,function(t,e){this.updateBackPack(t,e)}.bind(this)),this.addGlobalEvent(EventId.MODIFY_GOODS_NUM,function(t,e){this.updateBackPack(t,e),3==this.cur_index&&this.isCompRedPoint()}.bind(this)),this.addGlobalEvent(r.Compose_BackPack_Success,function(){this.isCompRedPoint(),this.setPanelData()}.bind(this))},openRootWnd:function(t){var e=t||a.item_tab_type.EQUIPS;this.changeTabView(e),this.isCompRedPoint()},isCompRedPoint:function(){for(var t=n.getInstance().getModel().getAllBackPackArray(3),e=!1,i=Config.partner_data.data_get_compound_info,s=0;s<t.length;++s){var a=t[s];if(-1!=a.quality&&a.base_id&&i[a.base_id]&&a.quantity>=i[a.base_id].num){e=!0;break}}this.tab_list[3].red_point.active=e},changeTabView:function(t){this.cur_index!=t&&(this.cur_tab&&(this.cur_tab.select.active=!1,this.cur_tab.title.color=this.normal_color,this.cur_tab.title_outline.color=this.normal_outlinecolor),this.cur_index=t,this.cur_tab=this.tab_list[t],this.cur_tab&&(this.cur_tab.select.active=!0,this.cur_tab.title.color=this.select_color,this.cur_tab.title_outline.color=this.select_outlinecolor),this.setPanelData())},setPanelData:function(){if(null!=this.cur_index){this.cur_index==a.item_tab_type.HERO?this.item_scrollview.setSpaceY(30,!0):this.item_scrollview.setSpaceY(10);var e=n.getInstance().getModel().getAllBackPackArray(this.cur_index),i=e.length;this.min_size=i,this.min_size<30?this.min_size=30:this.min_size%this.col_size!=0&&(this.min_size=this.min_size+this.col_size-this.min_size%this.col_size);var s=this.min_size-i;if(s>0)for(var o=0;o<s;o++)e.push({sort:-1,quality:-1,undata:!0});var l=function(t){this.selectedItem(t)}.bind(this),r=null;if(this.cur_index==a.item_tab_type.EQUIPS)r=Utils.tableUpperSorter(["quality","sort"]);else if(this.cur_index==a.item_tab_type.PROPS)r=Utils.tableUpperSorter(["quality","sort","base_id"]);else if(this.cur_index==a.item_tab_type.SPECIAL)r=function(t,e){return t.quality>e.quality?-1:1};else if(this.cur_index==a.item_tab_type.HERO){var c=function(t){var e=!1;return-1!=t.quality&&t.base_id&&Config.partner_data.data_get_compound_info[t.base_id]&&t.quantity>=Config.partner_data.data_get_compound_info[t.base_id].num&&(e=!0),e};r=function(t,e){return c(t)&&!c(e)?-1:!c(t)&&c(e)?1:-1!=t.quality&&t.base_id&&-1!=e.quality&&e.base_id?t.quality==e.quality?t.base_id<e.base_id?-1:1:t.quality>e.quality?-1:1:-1!=t.quality&&t.base_id&&-1==e.quality?-1:(-1==t.quality&&-1!=e.quality&&e.base_id,1)};var _=t("mainui_controller"),h=t("mainui_const");_.getInstance().setBtnRedPoint(h.btn_index.backpack,!1)}else r=Utils.tableUpperSorter(["sort","quality"]);e.sort(r);var d={is_other:!1,scale:1,effect:!1,is_show_tips:!1,is_show_chip_loading:!0};3==this.cur_index?d.is_comp_num=!0:d.is_comp_num=!1,this.item_scrollview.setData(e,l,d)}},selectedItem:function(e){if(null!=e){var i=e.getItemData();if(null!=i){var s=e.getItemConfig();if(null!=s){var n=t("tips_controller");if(a.checkIsEquip(s.type))n.getInstance().showEquipTips(i,l.eqmTips.backpack);else if(s.type==a.item_type.ARTIFACTCHIPS){var o=t("partner_const");t("hero_controller").getInstance().openArtifactTipsWindow(!0,i,o.ArtifactTips.backpack)}else if(s.sub_type==a.item_tab_type.HERO)n.getInstance().showBackPackCompTips(!0,i.base_id);else if(a.checkIsHeroSkin(s.type)){var r=t("hero_controller");o=t("partner_const");r.getInstance().openHeroSkinTipsPanel(!0,i,o.EqmTips.backpack)}else n.getInstance().showGoodsTips(i,!0)}}}},updateBackPack:function(t,e){if(null!=this.cur_index){if(this.cur_index==a.item_tab_type.EQUIPS){if(t!=a.Bag_Code.EQUIPS)return}else if(t==a.Bag_Code.EQUIPS)return;if(null!=e&&0!=Object.keys(e).length){var i=!1;for(var s in e){if(e[s].sub_type==this.cur_index){i=!0;break}}i&&this.setPanelData()}}},closeCallBack:function(){n.getInstance().openMainWindow(!1),this.item_scrollview&&this.item_scrollview.DeleteMe(),this.item_scrollview=null}});cc._RF.pop()},{backpack_const:"backpack_const",backpack_controller:"backpack_controller",backpack_event:"backpack_event",common_scrollview:"common_scrollview",guide_controller:"guide_controller",hero_controller:"hero_controller",mainui_const:"mainui_const",mainui_controller:"mainui_controller",partner_const:"partner_const",pathtool:"pathtool",tips_const:"tips_const",tips_controller:"tips_controller"}],base64:[function(t,e,i){(function(s){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}cc._RF.push(e,"d21e7/Qk5VPWpWP0BPoM4d3","base64"),function(t,s){"object"===(void 0===i?"undefined":n(i))&&void 0!==e?e.exports=s(t):"function"==typeof define&&define.amd?define(s):s(t)}("undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==s?s:void 0,function(i){var s,n=i.Base64;if(void 0!==e&&e.exports)try{s=t("buffer").Buffer}catch(t){s=void 0}var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=function(t){for(var e={},i=0,s=t.length;i<s;i++)e[t.charAt(i)]=i;return e}(a),l=String.fromCharCode,r=function(t){if(t.length<2)return(e=t.charCodeAt(0))<128?t:e<2048?l(192|e>>>6)+l(128|63&e):l(224|e>>>12&15)+l(128|e>>>6&63)+l(128|63&e);var e=65536+1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320);return l(240|e>>>18&7)+l(128|e>>>12&63)+l(128|e>>>6&63)+l(128|63&e)},c=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,_=function(t){return t.replace(c,r)},h=function(t){var e=[0,2,1][t.length%3],i=t.charCodeAt(0)<<16|(t.length>1?t.charCodeAt(1):0)<<8|(t.length>2?t.charCodeAt(2):0);return[a.charAt(i>>>18),a.charAt(i>>>12&63),e>=2?"=":a.charAt(i>>>6&63),e>=1?"=":a.charAt(63&i)].join("")},d=i.btoa?function(t){return i.btoa(t)}:function(t){return t.replace(/[\s\S]{1,3}/g,h)},u=s?s.from&&Uint8Array&&s.from!==Uint8Array.from?function(t){return(t.constructor===s.constructor?t:s.from(t)).toString("base64")}:function(t){return(t.constructor===s.constructor?t:new s(t)).toString("base64")}:function(t){return d(_(t))},m=function(t,e){return e?u(String(t)).replace(/[+\/]/g,function(t){return"+"==t?"-":"_"}).replace(/=/g,""):u(String(t))},f=new RegExp(["[\xc0-\xdf][\x80-\xbf]","[\xe0-\xef][\x80-\xbf]{2}","[\xf0-\xf7][\x80-\xbf]{3}"].join("|"),"g"),p=function(t){switch(t.length){case 4:var e=((7&t.charCodeAt(0))<<18|(63&t.charCodeAt(1))<<12|(63&t.charCodeAt(2))<<6|63&t.charCodeAt(3))-65536;return l(55296+(e>>>10))+l(56320+(1023&e));case 3:return l((15&t.charCodeAt(0))<<12|(63&t.charCodeAt(1))<<6|63&t.charCodeAt(2));default:return l((31&t.charCodeAt(0))<<6|63&t.charCodeAt(1))}},g=function(t){return t.replace(f,p)},v=function(t){var e=t.length,i=e%4,s=(e>0?o[t.charAt(0)]<<18:0)|(e>1?o[t.charAt(1)]<<12:0)|(e>2?o[t.charAt(2)]<<6:0)|(e>3?o[t.charAt(3)]:0),n=[l(s>>>16),l(s>>>8&255),l(255&s)];return n.length-=[0,0,2,1][i],n.join("")},b=i.atob?function(t){return i.atob(t)}:function(t){return t.replace(/[\s\S]{1,4}/g,v)},w=s?s.from&&Uint8Array&&s.from!==Uint8Array.from?function(t){return(t.constructor===s.constructor?t:s.from(t,"base64")).toString()}:function(t){return(t.constructor===s.constructor?t:new s(t,"base64")).toString()}:function(t){return g(b(t))},y=function(t){return w(String(t).replace(/[-_]/g,function(t){return"-"==t?"+":"/"}).replace(/[^A-Za-z0-9\+\/]/g,""))};if(i.Base64={VERSION:"2.4.8",atob:b,btoa:d,fromBase64:y,toBase64:m,utob:_,encode:m,encodeURI:function(t){return m(t,!0)},btou:g,decode:y,noConflict:function(){var t=i.Base64;return i.Base64=n,t},__buffer__:s},"function"==typeof Object.defineProperty){var C=function(t){return{value:t,enumerable:!1,writable:!0,configurable:!0}};i.Base64.extendString=function(){Object.defineProperty(String.prototype,"fromBase64",C(function(){return y(this)})),Object.defineProperty(String.prototype,"toBase64",C(function(t){return m(this,t)})),Object.defineProperty(String.prototype,"toBase64URI",C(function(){return m(this,!0)}))}}return i.Meteor&&(Base64=i.Base64),void 0!==e&&e.exports?e.exports.Base64=i.Base64:"function"==typeof define&&define.amd&&define([],function(){return i.Base64}),{Base64:i.Base64}}),cc._RF.pop()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{buffer:2}],baseclass:[function(t,e,i){"use strict";cc._RF.push(e,"4f6c4y8381MNY0OCXy50VeX","baseclass"),window.BaseClass=cc.Class({ctor:function(){}}),cc._RF.pop()},{}],basecontroller:[function(t,e,i){"use strict";cc._RF.push(e,"22b707itTxINYKWjn3CpP90","basecontroller"),window.BaseController=cc.Class({extends:BaseClass,ctor:function(){if(this.constructor.instance)throw new Error("\u4e0d\u80fd\u91cd\u590d\u5b9e\u4f8b\u5316\u4e00\u4e2a\u5355\u4f8b");this.constructor.instance=this,this.initConfig&&this.initConfig(),this.registerEvents&&this.registerEvents(),this.registerProtocals&&this.registerProtocals()},statics:{instance:null},RegisterProtocal:function(t,e){gcore.SmartSocket.bindCmd(t,e.bind(this))},SendProtocal:function(t,e){t?(e=e||{},gcore.SmartSocket.send(t,e)):Log.error("\u53d1\u9001\u5931\u8d25\uff0c\u9519\u8bef\u7684\u534f\u8bae\u53f7")}}),BaseController.getInstance=function(){return this.instance||new this,this.instance},cc._RF.pop()},{}],basepanel:[function(t,e,i){"use strict";cc._RF.push(e,"fbdb9UbFnJAFp1QhzS6W3lv","basepanel");var s=t("loadermanager"),n=t("viewclass");window.BasePanel=cc.Class({extends:n,ctor:function(){this.scale=1,this.x=0,this.y=0,this.initConfig(),this.root_wnd=null},wating:!1,prefabPath:"",loading:!1,fastShowThenHide:!1,isFirstOpen:!1,setParent:function(t){this._super(t),this.isInLoading=!1,this.fastShowThenHide=!1,this.isFirstOpen=!0,this.base_view_event_list={},this.res_list={},this.visible=!0,this.root_wnd&&t instanceof cc.Node&&(this.root_wnd.parent=t)},initConfig:function(){},initPanel:function(){},registerEvent:function(){},onShow:function(){},onHide:function(){},onDelete:function(){},onLoadPanel:function(){var t=this;this.waiting_timer||!this.wating||window.hide_loading||(this.waiting_timer=gcore.Timer.set(function(){this.is_wating=!0,game.updateWaitingStatus(WaitingStaus.LOADING)}.bind(this),1500,1)),s.getInstance().loadRes(this.prefabPath,function(e){t.waiting_timer&&(gcore.Timer.del(t.waiting_timer),t.waiting_timer=null),t.is_wating&&(game.updateWaitingStatus(),t.is_wating=!1),!t.delete&&t.parent._children&&(t.root_wnd=e,t.root_wnd.parent=t.parent,t.root_wnd.scale=t.scale,t.zIndex&&t.setZIndex(t.zIndex),t.visible||t.setVisible(!1),t.zIndex&&t.zIndex>=0&&(t.root_wnd.zIndex=t.zIndex),null!=t.cache_x&&null!=t.cache_y&&(t.root_wnd.setPosition(t.cache_x,t.cache_y),t.cache_x=null,t.cache_y=null),null!=t.cache_ap_y&&null!=t.cache_ap_x&&(t.root_wnd.setAnchorPoint(t.cache_ap_x,t.cache_ap_y),t.cache_ap_x=null,t.cache_ap_y=null),1==t.isFirstOpen&&(t.isFirstOpen=!1,t.initPanel(),t.registerEvent()),t.isInLoading=!1,1==t.fastShowThenHide?(t.fastShowThenHide=!1,t.setVisible(!1)):t.onShow(t.open_params),t.root_wnd&&t.root_wnd.getComponent(cc.Widget)&&(t.roow_wdg=t.root_wnd.getComponent(cc.Widget)),t.root_wnd_cb&&t.root_wnd_cb(t.root_wnd))})},show:function(t){1!=this.isInLoading&&(this.open_params=t,null==this.root_wnd?(this.isInLoading=!0,this.onLoadPanel()):(this.isInLoading=!1,this.root_wnd.active&&this.setVisible(!0),this.onShow(t)))},hide:function(){this.root_wnd?(this.setVisible(!1),this.onHide()):this.fastShowThenHide=!0},setVisible:function(t,e){this.visible=t,this.root_wnd&&(t?(this.roow_wdg&&(this.roow_wdg.alignMode=cc.Widget.AlignMode.ON_WINDOW_RESIZE),this.setPosition(this.x,this.y),this.cur_visible=!1):this.cur_visible||(this.roow_wdg&&(this.roow_wdg.alignMode=cc.Widget.AlignMode.ONCE),e==ScrollViewDir.vertical?this.root_wnd.x-=2*cc.winSize.width:e==ScrollViewDir.horizontal?(this.root_wnd.x-=2*cc.winSize.height,this.root_wnd.y-=2*cc.winSize.height):this.root_wnd.x-=2*cc.winSize.width,this.cur_visible=!0),this.onVisible&&this.onVisible(t))},setActive:function(t){this.visible=t,this.root_wnd&&(t?this.setPosition(this.x,this.y):this.root_wnd.x-=2*cc.winSize.width)},isOpen:function(){return!(!this.root_wnd||this.cur_visible)},setPosVisible:function(){this.root_wnd&&(this.root_wnd.x-=1e3)},getVisible:function(){return this.visible},setScale:function(t){this.scale=t,this.root_wnd&&(this.root_wnd.scale=t)},setZIndex:function(t){this.zIndex=t,this.root_wnd&&(this.root_wnd.zIndex=t)},deleteMe:function(){this.delete=!0,this.onDelete(),this._super()},setPosition:function(t,e){null!=t&&null!=e&&(this.x=t,this.y=e,this.root_wnd?this.root_wnd.setPosition(t,e):(this.cache_x=t,this.cache_y=e))},setAnchorPoint:function(t,e){this.ap_x=t,this.ap_y=e,this.root_wnd?this.root_wnd.setAnchorPoint(.5,.5):(this.cache_ap_x=t,this.cache_ap_y=e)},getPositionX:function(){return this.x},getPositionY:function(){return this.y},getRootWnd:function(t){this.root_wnd_cb=t,this.root_wnd&&this.root_wnd_cb(this.root_wnd)}}),cc._RF.pop()},{loadermanager:"loadermanager",viewclass:"viewclass"}],baserole:[function(t,e,i){"use strict";cc._RF.push(e,"1e370LPZpZI56omBMKNFvi0","baserole");var s=t("pathtool"),n=cc.Class({extends:BaseClass,ctor:function(){this.loadFinish=!1},is_load_finish:!1,action_data:null,anima_path:null,effect_path:null,statics:{type:{hero:1,unit:2}},setParent:function(t){this.parent=t,this.node=new cc.Node(""),this.node.setAnchorPoint(.5,.5),this.spine=this.node.addComponent(sp.Skeleton);var e=new cc.Node("");this.effect_sk=e.addComponent(sp.Skeleton),this.parent.addChild(this.node),this.node.addChild(e)},setData:function(t,e,i,a,o,l){var r=null,c=null;o=o||1,this.node.scale=o;var _=(l=l||{}).scale||1;if(this.effect_sk.node.scale=_,t==n.type.role){if(b=Config.looks_data.data_data[e]){var h=Utils.getNorKey(b.partner_id,b.star),d=gdata("partner_data","data_partner_star",h);if(i=i||PlayerAction.show,r=cc.js.formatStr("spine/%s/%s.atlas",b.ico_id,b.ico_id),d&&""!=d.show_effect)if(d.show_effect){c="spine/"+d.show_effect+"/"+d.show_effect+".atlas";var u=b.skin_id;0==u&&null!=l.skin_id&&(u=l.skin_id);var m=Config.partner_skin_data.data_skin_info[u];m&&null!=m.res_id&&""!=m.res_id&&(r="spine/"+m.res_id+"/"+m.res_id+".atlas"),m&&""!=m.show_effect&&(c="spine/"+m.show_effect+"/"+m.show_effect+".atlas")}else this.effect_sk&&(this.effect_sk.setToSetupPose(),this.effect_sk.clearTracks())}}else if(t==n.type.partner){var f=e.bid+"_"+e.star,p=gdata("partner_data","data_partner_star",f);r="spine/"+p.res_id+"/"+p.res_id+".atlas";gdata("partner_data","data_partner_base",e.bid);var g=l.skin_id,v=Config.partner_skin_data.data_skin_info[g];v&&null!=v.res_id&&""!=v.res_id&&(r="spine/"+v.res_id+"/"+v.res_id+".atlas"),p.show_effect?(c="spine/"+p.show_effect+"/action.atlas",v&&""!=v.show_effect&&(c="spine/"+v.show_effect+"/action.atlas")):this.effect_sk&&(this.effect_sk.setToSetupPose(),this.effect_sk.clearTracks())}else if(t==n.type.unit){var b=Utils.getUnitConfig(e);s.specialBSModel(Number(e))&&(i=PlayerAction.battle_stand),null!=b&&(r=cc.js.formatStr("spine/%s/%s.atlas",b.body_id,b.body_id))}else if(t==n.type.skin&&"number"==typeof e){var w=e,y=Config.partner_skin_data.data_skin_info[w];y&&null!=y.res_id&&""!=y.res_id&&(r="spine/"+y.res_id+"/"+y.res_id+".atlas"),y&&""!=y.show_effect&&(c="spine/"+y.show_effect+"/action.atlas")}r&&(this.anima_path&&this.anima_path!=r&&(this.spine.enabled=!1,LoaderManager.getInstance().releaseRes(this.anima_path)),this.effect_path&&this.effect_path!=c&&(this.effect_sk.enabled=!1,LoaderManager.getInstance().releaseRes(this.effect_path)),Log.info("anima_path====>>>",r),LoaderManager.getInstance().loadRes(r,function(t){this.spine.enabled=!0,this.spine.skeletonData=t,this.is_load_finish=!0,this.setAnimationAct(i,a)}.bind(this)),c&&LoaderManager.getInstance().loadRes(c,function(t){this.effect_sk.enabled=!0,this.effect_sk.skeletonData=t,this.effect_sk.setAnimation(0,"action",!0)}.bind(this)),this.effect_path=c,this.anima_path=r)},setAnimation:function(t,e){t=t||PlayerAction.show,null==e&&(e=!0),this.is_load_finish?this.setAnimationAct(t,e):this.action_data={action_name:t,loop:e}},setAnimationAct:function(t,e){this.spine.skeletonData&&this.spine.setAnimation(0,t,e)},setPosition:function(t,e){this.node&&this.node.setPosition(t,e)},showShadowUI:function(t){if(t)if(null==this.shadow){var e=new cc.Node;this.sript_path=s.getUIIconPath("common","common_90095"),LoaderManager.getInstance().loadRes(this.sript_path,function(t){e&&e.isValid&&(e.addComponent(cc.Sprite).spriteFrame=t)}.bind(this)),this.node.addChild(e,-2),e.setPosition(0,-210),this.shadow=e}else this.shadow.active=!0;else this.shadow&&(this.shadow.active=!1)},deleteMe:function(){this.anima_path&&LoaderManager.getInstance().releaseRes(this.anima_path),this.effect_path&&LoaderManager.getInstance().releaseRes(this.effect_path),this.sript_path&&LoaderManager.getInstance().releaseRes(this.sript_path),this.node.destroy()}});n.type={role:0,partner:1,unit:2,skin:3},e.exports=n,cc._RF.pop()},{pathtool:"pathtool"}],baseview:[function(t,e,i){"use strict";cc._RF.push(e,"84f60JmoNFGgILvSODq68no","baseview");var s=t("loadermanager"),n=t("viewclass");window.BaseView=cc.Class({extends:n,ctor:function(){this.viewTag=SCENE_TAG.win,this.win_type=WinType.Big,this.wating=!0,this.is_close=!1,this.close_is_map=!1,this.prefabPath="",this.root_wnd=null,this.base_view_event_list={},this.is_battle_hide=!0,this.is_loading=!1,this.is_before_battle=!1,this.initConfig()},statics:{winMap:[]},open:function(e){if(this.open_params=e,this.root_wnd){this.openRootWnd(e),0==this.active_status&&this.setVisible(!0);var i=t("guide_event");i&&gcore.GlobalEvent.fire(i.OpenTaskEffect,this.root_wnd)}else{var n=this;if(this.is_loading)return;this.is_loading=!0,this.waiting_timer||!this.wating||window.hide_loading||(this.waiting_timer=gcore.Timer.set(function(){this.is_wating=!0,game.updateWaitingStatus(WaitingStaus.LOADING)}.bind(this),1500,1)),s.getInstance().loadRes(this.prefabPath,function(e){if(this.waiting_timer&&(gcore.Timer.del(this.waiting_timer),this.waiting_timer=null),this.is_wating&&(game.updateWaitingStatus(),this.is_wating=!1),!this.is_close){this.is_loading=!1,this.root_wnd=e,this.root_wnd.setPosition(.5*-SCREEN_WIDTH,.5*-SCREEN_HEIGHT),ViewManager.getInstance().addToSceneNode(this.root_wnd,this.viewTag),n.fastShowThenHide&&(n.fastShowThenHide=!1,n.setVisible(!1)),this.openCallBack(),this.registerEvent(),n.openRootWnd(n.open_params),this.openCacheView(),this.root_wnd_cb&&this.root_wnd_cb(this.root_wnd);var i=t("guide_event");i&&gcore.GlobalEvent.fire(i.OpenTaskEffect,this.root_wnd)}}.bind(this))}},close:function(t){this.is_close||(t&&t instanceof Object&&(this.close_is_map=t.close_win||!1),this.closeCacheView(),this.is_close=!0,this.closeCallBack(),this.deleteMe())},deleteMe:function(){this._super()},checkWinType:function(t){return t==WinType.Mini||t==WinType.Tips},openCacheView:function(){if("prefab/chat/chat_window.prefab"!=this.prefabPath){BaseView.winMap.push(this);var e=BaseView.winMap;if(e>1){var i=e-2,s=BaseView.winMap[i];s&&this.checkWinType(s.win_type)&&this.win_type!=WinType.Mini&&(BaseView.winMap.splice(i,1),s.top_win=null,s.next_win=null,s.close&&s.close());var n=BaseView.winMap.length-2;n&&1==n.active_status&&(this.top_win=n,n.next_win=this,this.checkWinType(this.win_type)||this.top_win.setVisible(!1))}if(this.win_type==WinType.Full)t("mainscene_controller").getInstance().handleSceneStatus(!1),t("battle_controller").getInstance().handleBattleSceneStatus(!1),t("mainui_controller").getInstance().openMainUI(!1)}},closeCacheView:function(){for(var e=BaseView.winMap,i=0;i<e.length;i++){if(e[i]==this){this.top_win&&!this.close_is_map&&(0==this.is_battle_hide||null!=this.next_win&&this.next_win.win_type==WinType.Full||this.top_win.setVisible(!0),this.top_win.next_win=null,this.next_win&&(this.top_win.next_win=this.next_win,this.next_win.top_win=this.top_win)),BaseView.winMap.splice(i,1);break}}if(0==BaseView.winMap.length||!this.isFullWinExist()){var s=t("battle_controller").getInstance();if(s.hadBattleScene())s.handleBattleSceneStatus(!0);else if(t("mainui_controller").getInstance().getMainUIIndex()!=t("mainui_const").btn_index.drama_scene)t("mainscene_controller").getInstance().handleSceneStatus(!0)}},isFullWinExist:function(){for(var t=BaseView.winMap,e=0;e<t.length;e++){var i=t[e];if(i.win_type==WinType.Full&&0==i.is_before_battle)return!0}return!1},setVisible:function(t){this.active_status!=t&&(this.active_status=t,this.root_wnd?this.root_wnd.active=t:this.fastShowThenHide=t)},getVisible:function(t){return this.active_status},getRootWnd:function(t){this.root_wnd_cb=t,this.root_wnd&&this.root_wnd_cb(this.root_wnd)},initConfig:function(){},openRootWnd:function(){},registerEvent:function(){},openCallBack:function(){},closeCallBack:function(){}}),cc._RF.pop()},{battle_controller:"battle_controller",guide_event:"guide_event",loadermanager:"loadermanager",mainscene_controller:"mainscene_controller",mainui_const:"mainui_const",mainui_controller:"mainui_controller",viewclass:"viewclass"}],battle_buff_data:[function(t,e,i){"use strict";cc._RF.push(e,"6ee79G6qVNPBLhPKCMM6jCI","battle_buff_data");var s=cc.Class({extends:BaseClass,properties:{target:0,buff_bid:0,remain_round:0,end_round:0,action_type:0,change_type:0,change_value:0,is_dead:0,id:0},updateData:function(t){for(var e in t)this.setBaseDataByKey(e,t[e])},setBaseDataByKey:function(t,e){this[t]!=e&&(this[t]=e)}});e.exports=s,cc._RF.pop()},{}],battle_buff_info_item_panel:[function(t,e,i){"use strict";cc._RF.push(e,"d7a7bRpTxFIrbOoakTyczPl","battle_buff_info_item_panel");var s=t("pathtool"),n=t("battle_controller"),a=t("hero_vo"),o=1,l=2;cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("battle","battle_buff_info_item"),this.role_dir=arguments[0]||o,this.ctrl=n.getInstance()},initConfig:function(){this.buff_list_item=[]},initPanel:function(){this.size=this.root_wnd.getContentSize();var t=this.root_wnd.getChildByName("container");this.container=t,this.touch_layout=t.getChildByName("touch_layout"),this.arrow_sp=t.getChildByName("Sprite_1"),this.hero_head=ItemsPool.getInstance().getItem("hero_exhibition_item"),this.hero_head.setExtendData({scale:.7,can_click:!0}),this.hero_head.addCallBack(this._onClickHeroCallBack.bind(this)),this.hero_head.setParent(t),this.hero_head.show(),this.role_dir==o?(this.hero_head.setPosition(50,this.size.height/2),this.touch_layout.setPosition(cc.v2(this.size.width,0)),this.arrow_sp.setPosition(cc.v2(282,15)),this.arrow_sp.scaleX=1):(this.hero_head.setPosition(this.size.width-50,this.size.height/2),this.touch_layout.setPosition(this.size.width-84-18,0),this.arrow_sp.setPosition(cc.v2(18,15)),this.arrow_sp.scaleX=-1)},registerEvent:function(){this.touch_layout.on("touchend",function(){this.buff_list_data&&null!=Utils.next(this.buff_list_data)&&this.ctrl.openBattleBuffListView(!0,this.buff_list_data,this.data.group,this.data.object_bid)},this)},onShow:function(t){this.data&&this.setData(this.data)},onHide:function(){},onDelete:function(){this.hero_head&&(this.hero_head.deleteMe(),this.hero_head=null)},setData:function(t){var e=this;if(this.data=t||{},this.root_wnd){var i=t.role_data,n=new a;if(Config.partner_data.data_partner_base[i.object_bid])n.bid=i.object_bid,n.star=i.star;else{var o=function(t){return gdata("unit_data","data_unit1",t)||gdata("unit_data","data_unit2",t)||gdata("unit_data","data_unit3",t)}(t.role_data.object_bid);if(o){if(n.bid=Number(o.head_icon),o.star&&o.star>0)n.star=o.star;else{var r=Config.partner_data.data_partner_base[n.bid];r&&(n.star=r.init_star)}n.master_head_id=n.bid}}n.camp_type=i.camp_type,n.lev=i.lev,n.use_skin=i.fashion,this.hero_head.setData(n),i.hp>0?this.hero_head.showStrTips(!1):this.hero_head.showStrTips(!0,Utils.TI18N("\u5df2\u9635\u4ea1"));var c={},_={};for(var h in this.data.buff_list){var d=this.data.buff_list[h];if(null!=d){var u=d.config,m=d.buff,f=u.icon;null!=f&&0!=f&&(i.hp>0||null!=u.clean_when_dead&&"false"==u.clean_when_dead)&&(null==c[f]&&(c[f]={res_id:f,num:0,name:u.name,remain_round:m.remain_round,desc:u.desc,buff_infos:[]}),0==c[f].num||u.join_type&&3!=u.join_type?(c[f].num=c[f].num+1,c[f].buff_infos.push({buff_id:u.bid,remain_round:m.remain_round}),u.group&&(_[u.group]=!0)):u.join_type&&3==u.join_type&&u.group&&!_[u.group]&&(_[u.group]=!0,c[f].num=c[f].num+1,c[f].buff_infos.push({buff_id:u.bid,remain_round:m.remain_round})))}}for(var p in this.buff_list_data=[],c){var g=c[p];this.buff_list_data.push(g)}this.buff_list_data.sort(function(t,e){return t.res_id-e.res_id}),this.ctrl.updateBattleBuffListView(this.buff_list_data,i.group,i.object_bid);for(var v=0;v<this.buff_list_item.length;++v){var b=this.buff_list_item[v];b.icon&&(b.icon.node.active=!1)}var w=110;this.role_dir==l&&(w=this.size.width-w);for(var y=cc.size(33,32),C=0;C<this.buff_list_data.length;++C){var k=this.buff_list_data[C],S=C+1;S<=8&&function(){var t=e.buff_list_item[C];null==t&&(t=e.createBuffItem(),e.buff_list_item[C]=t),t.icon.node.active=!0,t.label.string=k.num;var i=Math.ceil(S/4),n=S%4;0==n&&(n=4);var a=w+(n-1)*(y.width+5)+y.width/2;e.role_dir==l&&(a=w-(n-1)*(y.width+5)-y.width/2);var o=85-(i-1)*(y.height+5)-y.height/2;t.icon.node.setPosition(cc.v2(a,o));var r=k.res_id,c=s.getBigBuffRes(r);t.path!=c&&(t.path=c,e.loadRes(c,function(e){t.icon.spriteFrame=e}.bind(e)))}()}}},_onClickHeroCallBack:function(){if(this.data&&this.data.role_data&&0!=this.data.role_data.owner_id&&""!=this.data.role_data.owner_srv_id&&this.data.role_data.object_id){var e=t("role_controller").getInstance().getRoleVo(),i=t("hero_controller");if(e.rid==this.data.role_data.owner_id&&e.srv_id==this.data.role_data.owner_srv_id){var s=i.getInstance().getModel().getHeroById(this.data.role_data.object_id);s&&null!=Utils.next(s)?i.getInstance().openHeroTipsPanel(!0,s):message(Utils.TI18N("\u8be5\u82f1\u96c4\u6765\u81ea\u5f02\u57df\uff0c\u65e0\u6cd5\u67e5\u770b"))}else{t("look_controller").getInstance().sender11061(this.data.role_data.owner_id,this.data.role_data.owner_srv_id,this.data.role_data.object_id)}}else message(Utils.TI18N("\u8be5\u82f1\u96c4\u6765\u81ea\u5f02\u57df\uff0c\u65e0\u6cd5\u67e5\u770b"))},createBuffItem:function(){var t={},e=Utils.createImage(this.container,null,0,0,cc.v2(.5,.5)),i=new cc.Node;i.setAnchorPoint(cc.v2(1,0)),i.setPosition(15,-15);var s=i.addComponent(cc.Label);e.node.addChild(i),s.fontSize=14,s.lineHeight=18,s.horizontalAlign=cc.macro.TextAlignment.CENTER,s.verticalAlign=cc.macro.TextAlignment.CENTER,i.color=new cc.Color(255,255,255,255);var n=i.addComponent(cc.LabelOutline);return n.color=new cc.Color(0,0,0),n.width=1,t.icon=e,t.label=s,t.path="",t}});cc._RF.pop()},{battle_controller:"battle_controller",hero_controller:"hero_controller",hero_vo:"hero_vo",look_controller:"look_controller",pathtool:"pathtool",role_controller:"role_controller"}],battle_buff_info_window:[function(t,e,i){"use strict";cc._RF.push(e,"53053D2DRNLOr9jUGYxWOaL","battle_buff_info_window");var s=t("pathtool"),n=t("battle_controller"),a=t("battle_const"),o=t("battle_buff_info_item_panel"),l=t("battle_event"),r=1,c=2;cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("battle","battle_buff_info_view"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Mini,this.ctrl=n.getInstance(),this.model=this.ctrl.getModel()},initConfig:function(){this.left_item_list=[],this.right_item_list=[]},openCallBack:function(){this.background=this.root_wnd.getChildByName("background");var t=this.root_wnd.getChildByName("container");this.left_name_label=t.getChildByName("left_name_label").getComponent(cc.Label),this.right_name_label=t.getChildByName("right_name_label").getComponent(cc.Label),this.left_role_panel=t.getChildByName("left_role_panel"),this.right_role_panel=t.getChildByName("right_role_panel"),this.close_btn=t.getChildByName("close_btn"),this.close_btn.getChildByName("label").getComponent(cc.Label).string=Utils.TI18N("\u786e  \u5b9a")},registerEvent:function(){this.close_btn.on("click",this._onClickCloseBtn,this),this.background.on("touchend",this._onClickCloseBtn,this),this.addGlobalEvent(l.UPDATE_ROUND_NUM,function(){this.setData()}.bind(this))},openRootWnd:function(t){this.left_name=t.left_name||"",this.right_name=t.right_name||"",this.setData(!0)},closeCallBack:function(){if(this.left_item_list){for(var t=0;t<this.left_item_list.length;++t)this.left_item_list[t]&&(this.left_item_list[t].deleteMe(),this.left_item_list[t]=null);this.left_item_list=null}if(this.right_item_list){for(var e=0;e<this.right_item_list.length;++e)this.right_item_list[e]&&(this.right_item_list[e].deleteMe(),this.right_item_list[e]=null);this.right_item_list=null}this.ctrl.openBattleBuffInfoView(!1)},setData:function(t){var e=this,i=this.ctrl.getModel().getAllObject();if(i&&null!=Utils.next(i)){var s=[],n=[];for(var l in i){var _=i[l];_.role_data.object_type!=a.BattleObjectType.Pet&&_.role_data.object_type!=a.BattleObjectType.Unit||(1==_.group?s.push(_):2==_.group&&n.push(_))}var h=this.left_role_panel.getContentSize().height;this.left_name_label.string=this.left_name;for(var d=0;d<this.left_item_list.length;++d){this.left_item_list[d].setVisible(!1)}for(var u=function(i){var n=s[i];if(t)Utils.delayRun(e.left_role_panel,4*i/40,function(){var t=this.left_item_list[i];null==t&&(t=new o(r),this.left_item_list[i]=t,t.setParent(this.left_role_panel)),t.setVisible(!0);var e=cc.size(300,100);t.setPosition(0,h-(i+1)*e.height),t.setData(n),t.show()}.bind(e));else{var a=e.left_item_list[i];null==a&&(a=new o(r),e.left_item_list[i]=a,a.setParent(e.left_role_panel)),a.setVisible(!0);var l=cc.size(300,100);a.setPosition(0,h-(i+1)*l.height),a.setData(n),a.show()}},m=0;m<s.length;++m)u(m);this.right_name_label.string=this.right_name;for(var f=0;f<this.right_item_list.length;++f){this.right_item_list[f].setVisible(!1)}for(var p=function(i){var s=n[i];if(t)Utils.delayRun(e.right_role_panel,4*i/40,function(){var t=this.right_item_list[i];null==t&&(t=new o(c),this.right_item_list[i]=t,t.setParent(this.right_role_panel)),t.setVisible(!0);var e=cc.size(300,100);t.setPosition(0,h-(i+1)*e.height),t.setData(s),t.show()}.bind(e));else{var a=e.right_item_list[i];null==a&&(a=new o(c),e.right_item_list[i]=a,a.setParent(e.right_role_panel)),a.setVisible(!0);var l=cc.size(300,100);a.setPosition(0,h-(i+1)*l.height),a.setData(s),a.show()}},g=0;g<n.length;++g)p(g)}},_onClickCloseBtn:function(){Utils.playButtonSound(2),this.ctrl.openBattleBuffInfoView(!1)}});cc._RF.pop()},{battle_buff_info_item_panel:"battle_buff_info_item_panel",battle_const:"battle_const",battle_controller:"battle_controller",battle_event:"battle_event",pathtool:"pathtool"}],battle_buff_list_item_panel:[function(t,e,i){"use strict";cc._RF.push(e,"2f900NXs99HvYIqU3B0itOg","battle_buff_list_item_panel");var s=t("pathtool");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("battle","battle_buff_list_item")},initConfig:function(){},initPanel:function(){this.container=this.root_wnd.getChildByName("container"),this.line=this.container.getChildByName("line"),this.buff_icon=this.container.getChildByName("buff_icon").getComponent(cc.Sprite),this.name_label=this.container.getChildByName("name_label").getComponent(cc.Label),this.round_label=this.container.getChildByName("round_label").getComponent(cc.Label),this.buff_desc_lb=this.container.getChildByName("buff_desc").getComponent(cc.Label)},registerEvent:function(){},onShow:function(t){this.data&&this.setData(this.data)},onHide:function(){},onDelete:function(){},setData:function(t){var e=this;if(e.data=t||{},this.root_wnd){var i=s.getBigBuffRes(t.res_id);i&&this.loadRes(i,function(t){e.buff_icon.spriteFrame=t});var n="\u3010"+(t.name||"")+"\u3011*"+(t.num||1);e.name_label.string=n,!t.remain_round||t.remain_round>30?e.round_label.node.active=!1:(e.round_label.node.active=!0,e.round_label.string=cc.js.formatStr(Utils.TI18N("%d\u56de\u5408\u540e\u5931\u6548"),t.remain_round)),e.buff_desc_lb.string=t.desc||"",t.index?e.line.active=!0:e.line.active=!1}}});cc._RF.pop()},{pathtool:"pathtool"}],battle_buff_list_window:[function(t,e,i){"use strict";cc._RF.push(e,"a2035TdcTVKa4RXJFaqo7Op","battle_buff_list_window");var s=t("pathtool"),n=t("common_scrollview"),a=t("battle_buff_list_item_panel"),o=t("battle_controller");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("battle","battle_buff_list_view"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Mini,this.ctrl=o.getInstance()},initConfig:function(){},openCallBack:function(){this.background=this.root_wnd.getChildByName("background"),this.container=this.root_wnd.getChildByName("container"),this.arrow_sp=this.container.getChildByName("Sprite_2"),this.arrow_sp.active=!1;var t=this.container.getChildByName("list_panel"),e=t.getContentSize(),i={item_class:a,start_x:0,space_x:0,start_y:0,space_y:0,item_width:566,item_height:154,row:0,col:1,need_dynamic:!0};this.buff_scrollview=new n,this.buff_scrollview.createScroll(t,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,e,i)},registerEvent:function(){this.background.on("touchend",function(){Utils.playButtonSound(2),this.ctrl.openBattleBuffListView(!1)},this)},openRootWnd:function(t){this.group=t.group,this.partner_bid=t.partner_bid,this.setData(t.data)},setData:function(t){this.data=t||[];for(var e={},i=0;i<this.data.length;++i)for(var s=this.data[i],n=0;n<s.buff_infos.length;++n){var a=s.buff_infos[n],o=a.buff_id,l=a.remain_round||s.remain_round,r=Config.skill_data.data_get_buff[o];r&&(null==e[o]&&(e[o]={res_id:s.res_id,num:0,name:r.name,remain_round:l,desc:r.desc,buff_id:o}),e[o].num=e[o].num+1)}var c=[];for(var _ in e){var h=Utils.deepCopy(e[_]);c.push(h)}c.sort(function(t,e){return t.res_id==e.res_id?t.buff_id-e.buff_id:t.res_id-e.res_id});for(var d=0;d<c.length;++d)c[d].index=d;this.arrow_sp.active=c.length>=5,this.buff_scrollview.setData(c)},checkIsChosedBuffList:function(t,e){return this.group==t&&this.partner_bid==e},closeCallBack:function(){this.buff_scrollview&&(this.buff_scrollview.deleteMe(),this.buff_scrollview=null),this.ctrl.openBattleBuffListView(!1)}});cc._RF.pop()},{battle_buff_list_item_panel:"battle_buff_list_item_panel",battle_controller:"battle_controller",common_scrollview:"common_scrollview",pathtool:"pathtool"}],battle_button_list_panel:[function(t,e,i){"use strict";cc._RF.push(e,"910a2iOTPJFQ5g9kofzLjjJ","battle_button_list_panel");var s=t("pathtool"),n=t("battle_drama_event"),a=t("timetool"),o=t("mainui_event"),l=t("voyage_event"),r=t("hallows_event"),c=t("hallows_controller"),_=t("onlinegift_controller"),h=t("onlinegift_event"),d=t("role_controller"),u=t("guide_event"),m=t("vip_event"),f=t("vip_controller"),p=t("guide_controller");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("battle","battle_button_list")},initConfig:function(){this.rleasePrefab=!1,this.resources_action=null,this.is_onshow=!1,this.drama_controller=t("battle_drama_controller").getInstance(),this.drama_model=this.drama_controller.getModel(),this.skeletonData=null,this.drop_item_list={},this.reward_layout_list={},this.battle_controller=t("battle_controller").getInstance(),this.battle_model=this.battle_controller.getModel(),this.challenge_condition={status:0,lev:0},this.role_vo=d.getInstance().getRoleVo(),this.battle_drama_model=t("battle_drama_controller").getInstance().getModel(),this.fly_item_pools=new cc.NodePool,this.auto_id=0,this.fly_item_list={},this.cur_hallows_id=0,this.cur_chapter_id=null,this.hallow_spine_path="",this.left_btn_list={},this.white_color=new cc.Color(255,255,255,255),this.gray_color=new cc.Color(125,125,125,255),this.red_color=new cc.Color(79,22,0,255),this.yellow_color=new cc.Color(255,238,181,255),this.guildsign_open=!1},initPanel:function(){this.bottom_container=this.seekChild("bottom_container"),this.left_top=this.seekChild(this.bottom_container,"left_top"),this.right_top=this.seekChild(this.bottom_container,"right_top"),this.scrollview_content=this.seekChild("content"),this.collect_container=this.seekChild(this.bottom_container,"collect_container"),this.resources_model=this.seekChild(this.collect_container,"resources_model"),this.progress=this.seekChild(this.collect_container,"progress",cc.ProgressBar),this.time_label=this.seekChild(this.collect_container,"time_label",cc.Label),this.skeleton=this.seekChild(this.collect_container,"spine",sp.Skeleton),this.challenge_boss_btn=this.seekChild("guildsign_battle_boss_btn"),this.notice_label=this.seekChild(this.challenge_boss_btn,"notice_label",cc.Label),this.challenge_item=this.seekChild(this.challenge_boss_btn,"challenge_item"),this.challenge_btn_effect=this.seekChild(this.challenge_boss_btn,"effect",sp.Skeleton),this.challenge_btn_effect_1=this.seekChild(this.challenge_item,"effect_1",sp.Skeleton),this.next_battle_time=this.seekChild("next_battle_time"),this.next_label=this.seekChild(this.next_battle_time,"label",cc.Label),this.guidesign_battle_quick_btn=this.seekChild("guidesign_battle_quick_btn"),this.quick_btn_tips=this.seekChild(this.guidesign_battle_quick_btn,"tips"),this.guildsign_img_sp=this.seekChild(this.guidesign_battle_quick_btn,"Image_1",cc.Sprite),this.guildsign_icon_sp=this.seekChild(this.guidesign_battle_quick_btn,"Sprite_3",cc.Sprite),this.guildsign_lb=this.seekChild(this.guidesign_battle_quick_btn,"label",cc.Label),this.guildsign_lo=this.seekChild(this.guidesign_battle_quick_btn,"label",cc.LabelOutline),this.battle_drama_model.getDramaData().max_dun_id<Config.dungeon_data.data_drama_const.fast_combat_first.val?(this.guildsign_img_sp.setMaterial(0,cc.Material.getBuiltinMaterial("2d-gray-sprite")),this.guildsign_icon_sp.setMaterial(0,cc.Material.getBuiltinMaterial("2d-gray-sprite")),this.guildsign_lb.node.color=this.white_color,this.guildsign_lo.color=this.gray_color):this.guildsign_open=!0,this.hero_btn=this.seekChild("hero_btn"),this.detail_btn=this.seekChild("detail_btn"),this.drama_reward_layout=this.seekChild("reward_layout");for(var t=0;t<4;t++){var e=this.seekChild(this.drama_reward_layout,"layout_"+t);e&&(this.reward_layout_list[t]={layout:e,icon:this.seekChild(e,"icon",cc.Sprite),label:this.seekChild(e,"label",cc.Label),path:null})}if(this.top_container=this.seekChild("top_container"),window.isMobile||(this.top_container.getComponent(cc.Widget).enabled=!1),this.hallownode=this.seekChild(this.top_container,"hallownode"),this.hallownode.name="hallows_stage",this.hallowspine=this.seekChild(this.hallownode,"spinenode",sp.Skeleton),this.hallowstips=this.seekChild(this.hallownode,"tips"),this.hallowprogress=this.seekChild(this.hallownode,"progress",cc.ProgressBar),this.haolowvalue=this.seekChild(this.hallownode,"nodename",cc.Label),this.receivenode=this.seekChild(this.top_container,"receivenode"),this.receivename=this.seekChild(this.receivenode,"nodename",cc.Label),this.receiveitem=Utils.createClass("backpack_item"),this.receiveitem.setParent(this.receivenode),this.receiveitem.setPosition(0,10),this.receiveitem.initConfig(!0,.55,!0,!0),this.receiveitem.show(),this.ranknode=this.seekChild(this.top_container,"ranknode"),this.left_btn_list[3]=this.ranknode,this.passnode=this.seekChild(this.top_container,"passnode"),this.left_btn_list[2]=this.passnode,this.passtips=this.seekChild(this.passnode,"tips"),this.videonode=this.seekChild(this.top_container,"videonode"),this.left_btn_list[1]=this.videonode,this.tasknode=this.seekChild(this.top_container,"tasknode"),this.left_btn_list[0]=this.tasknode,this.tasktips=this.seekChild(this.tasknode,"tips"),this.qingbao=this.seekChild(this.top_container,"qingbao"),this.qingbaoprogress=this.seekChild(this.qingbao,"progress",cc.Sprite),this.qingbaotips=this.seekChild(this.qingbao,"tips"),this.qingbaovalue=this.seekChild(this.qingbao,"value",cc.Label),this.minimap=this.seekChild(this.top_container,"minimap"),this.minimap_mark=this.seekChild(this.minimap,"mark"),this.minimap_img=this.seekChild(this.minimap_mark,"map",cc.Sprite),this.miniicon=this.seekChild(this.minimap_mark,"icon"),this.mapname=this.seekChild(this.minimap,"mapname",cc.Label),this.init_rank_x=this.ranknode.x,this.init_task_x=this.tasknode.x,("WX_SDK"==window.PLATFORM_TYPR||"SH_SDK"==window.PLATFORM_TYPR||"QQ_SDK"==PLATFORM_TYPR)&&window.WX_FIT){var i=this.root_wnd.height*window.WX_FIT;this.top_container.getComponent(cc.Widget).top+=i}this.updateTopBtnPos(),this.rectHandleEffect(!0)},registerEvent:function(){Utils.onTouchEnd(this.minimap,function(){t("battle_drama_controller").getInstance().openBattleDramaMapWindows(!0)}.bind(this),1),Utils.onTouchEnd(this.challenge_boss_btn,function(){this.touchChallengeBoss()}.bind(this),1),Utils.onTouchEnd(this.detail_btn,function(){t("battle_drama_controller").getInstance().openDramDropWindows(!0)}.bind(this),1),Utils.onTouchEnd(this.resources_model,function(){this.touchResourceBox()}.bind(this),1),Utils.onTouchEnd(this.ranknode,function(){t("rank_controller").getInstance().openMainView(!0)}.bind(this),1),Utils.onTouchEnd(this.guidesign_battle_quick_btn,function(){this.guildsign_open&&this.drama_controller.openDramBattleQuickView(!0),1==this.quick_battle_status&&(this.drama_model.setOpenQuickBattleStatus(!0),this.drama_model.checkRedPoint(),this.quick_btn_tips.active=!1)}.bind(this),1),Utils.onTouchEnd(this.tasknode,function(){t("task_controller").getInstance().openTaskMainWindow(!0)}.bind(this),1),Utils.onTouchEnd(this.passnode,function(){this.drama_controller.openDramaRewardWindow(!0)}.bind(this),1),Utils.onTouchEnd(this.qingbao,function(){var e=Config.shipping_data.data_const.guild_lev;e&&this.role_vo&&e.val<=this.role_vo.lev?t("voyage_controller").getInstance().openVoyageMainWindow(!0):message(e.desc)}.bind(this),1),Utils.onTouchEnd(this.hero_btn,function(){t("stronger_controller").getInstance().openMainWin(!0)}.bind(this),1),Utils.onTouchEnd(this.videonode,function(){this.drama_controller.openDramaPassVedioWindow(!0)}.bind(this),1),Utils.onTouchEnd(this.hallownode,function(){t("jump_controller").getInstance().jumpViewByEvtData([20])}.bind(this),1),this.addGlobalEvent(n.UpdateHookAccumulateTime,function(t){this.updateResourceCollect()}.bind(this)),this.addGlobalEvent(n.BattleDrama_Update_Max_Id,function(t){this.updateDramaDropInfo(),this.updateChallengeBossStatus(),0==this.guildsign_open&&t>=Config.dungeon_data.data_drama_const.fast_combat_first.val&&(this.guildsign_open=!0,this.guildsign_img_sp.setMaterial(0,cc.Material.getBuiltinMaterial("2d-sprite")),this.guildsign_icon_sp.setMaterial(0,cc.Material.getBuiltinMaterial("2d-sprite")),this.guildsign_lb.node.color=this.yellow_color,this.guildsign_lo.color=this.red_color)}.bind(this)),this.addGlobalEvent(n.BattleDrama_Update_Cool_Time,function(){this.updateChallengeBossStatus()}.bind(this)),this.addGlobalEvent(n.BattleDrama_Update_Dun_Id,function(){this.updateMiniMapInfo()}.bind(this)),this.addGlobalEvent(n.BattleDrama_Drama_Buff_View,function(){this.updateBattleBuff()}.bind(this)),this.addGlobalEvent(l.UpdateVoyageRedEvent,function(){this.checkVoyageRedStatus()}.bind(this)),this.addGlobalEvent(n.BattleDrama_Drama_Reward_Data,function(t){this.updatePassRewardRedPoint()}.bind(this)),this.addGlobalEvent(r.UpdateHallowsTaskEvent,function(){this.updateHallowSpine()}.bind(this)),this.addGlobalEvent(r.HallowsActivityEvent,function(){this.updateHallowSpine()}.bind(this)),this.addGlobalEvent(r.HallowsRedStatus,function(){this.updateHallowsRedStatus()}.bind(this)),this.addGlobalEvent(n.BattleDrama_Update_Data,function(t){this.cur_chapter_id!=t.chapter_id&&this.drama_model.initDungeonList(t.mode,t.chapter_id),this.updateMiniMapInfo(),this.checkQuickRed()}.bind(this)),this.addGlobalEvent(n.BattleDrama_Top_Update_Data,function(){this.updateMiniMapInfo(),this.checkQuickRed()}.bind(this)),this.addGlobalEvent(n.BattleDrama_Quick_Battle_Data,function(t){null!=t&&this.quick_btn_tips&&(0==t.fast_combat_first&&this.quick_battle_status?this.quick_btn_tips.active=!0:this.quick_btn_tips.active=!1,this.checkQuickRed())}.bind(this)),this.addGlobalEvent(o.UPDATE_FUNCTION_STATUS,function(t,e){e&&(3==t?this.updateTaskInfo():5==t&&this.updateRankInfo())}.bind(this)),null==this.role_update_event&&this.role_vo&&(this.role_update_event=this.role_vo.bind(EventId.UPDATE_ROLE_ATTRIBUTE,function(t,e){"energy"==t?this.updateQingBaoInfo():"lev"==t&&this.updateRoleLevInfo()}.bind(this))),null==this.update_online_get_event&&(this.update_online_get_event=gcore.GlobalEvent.bind(h.Get_Data,function(t){this.removeOnlineSprite(t),this.receiveChangeData()}.bind(this))),this.addGlobalEvent(m.GIVE_VIP_UPDATE,function(){this.updateGiveVip()}.bind(this)),this.addGlobalEvent(u.CloseTaskEffect,function(){this.updateBtnLayerStatus(1!=this.challenge_condition.status)},this),this.addGlobalEvent(u.CloseButtonListPanelEffect,function(){this.deleteLastTimeHandle()},this),this.addGlobalEvent(u.NewPlayerGuideClose,function(){this.updateBtnLayerStatus(1!=this.challenge_condition.status)},this)},isCreateOnlineGift:function(){var t=!1,e=_.getInstance().getModel().getOnlineGiftData();if(e)for(var i=0;i<e.length;++i){if(e[i].time==Config.misc_data.data_get_time_items[Config.misc_data.data_get_time_items_length].time){t=!0;break}}return t},removeOnlineSprite:function(t){if(t&&t.list){0==(null==Utils.next(t.list)||!(t.list.length>=Config.misc_data.data_get_time_items_length))?this.clearOnlineInfo():this.onlineCreate()}},clearOnlineInfo:function(){this.receivenode.active=!1,this.update_online_get_event&&(gcore.GlobalEvent.unbind(this.update_online_get_event),this.update_online_get_event=null),this.time_tichet&&(gcore.Timer.del(this.time_tichet),this.time_tichet=null)},onlineCreate:function(){this.receivenode.active=!0,this.receiveitem.addCallBack(function(){_.getInstance().openOnlineGiftView(!0)})},updateOnlineGiftInfo:function(){_.getInstance().send10926()},receiveChangeData:function(){var t=_.getInstance().getModel().getOnlineGiftData(),e=0,i=Config.misc_data.data_get_time_items,s=Config.misc_data.data_get_time_items_length;if(t)for(var n in i){var a=i[n];t[0]&&t[0].time>=a.time&&(e=n)}(e=Number(e)+1)>=s&&(e=s);var o=_.getInstance().getModel().getOnlineTime();if(this.receiveitem)if(this.receiveitem.setData({bid:i[e].items[0][0],num:i[e].items[0][1]}),this.receiveitem.showItemEffect(!0,165,PlayerAction.action,!0,1.2),o>=i[e].time)this.receivenode.active&&(this.time_tichet&&(gcore.Timer.del(this.time_tichet),this.time_tichet=null),this.receivename.string=Utils.TI18N("\u53ef\u9886\u53d6"));else{this.receiveitem.showItemEffect(!1,165,PlayerAction.action,!0);var l=i[e].time-o;this.time_tichet&&(gcore.Timer.del(this.time_tichet),this.time_tichet=null),this.setLessTime(l)}},setLessTime:function(t){t>0?(this.setTimeFormatString(t),null==this.time_tichet&&(this.time_tichet=gcore.Timer.set(function(){(t-=1)<0?(gcore.Timer.del(this.time_tichet),this.time_tichet=null):this.setTimeFormatString(t)}.bind(this),1e3,-1))):this.setTimeFormatString(t)},setTimeFormatString:function(t){this.receivename.string=t>0?a.getTimeFormat(t):""},changeBattleStatus:function(t){this.is_real_combat=t,this.left_top.active=this.is_real_combat,this.right_top.active=this.is_real_combat,this.collect_container.active=!this.is_real_combat,1==t?(this.clearBuffCoolTimer(),this.battle_buff_icon&&(this.battle_buff_icon.active=!1),this.clearVipTimer(),this.vip_icon&&(this.vip_icon.active=!1),this.hallownode.active=!1,this.updateBtnLayerStatus(!1)):(this.updateBattleBuff(),this.updateHallowSpine(),this.updateGiveVip(),this.updateChallengeBossStatus(),this.updateBtnLayerStatus(1!=this.challenge_condition.status))},onShow:function(t){this.is_real_combat=t,this.left_top.active=this.is_real_combat,this.right_top.active=this.is_real_combat,this.collect_container.active=!this.is_real_combat,this.is_onshow=!0,this.updateResourceCollect(),this.updateDramaDropInfo(),this.updateMiniMapInfo(),this.updateChallengeBossStatus(),this.updateOnlineGiftInfo(),this.checkVoyageRedStatus(),this.updatePassRewardRedPoint(),this.updateTaskInfo(),this.updateRankInfo(),this.updateQingBaoInfo(),0==this.is_real_combat&&(this.updateBattleBuff(),this.updateHallowSpine(),this.updateGiveVip()),this.checkQuickRed(),this.lastTimeGoToHandleEffect()},onHide:function(){for(var t in this.is_onshow=!1,this.fly_item_list){var e=this.fly_item_list[t];e&&e.node&&(e.node.stopAllActions(),this.fly_item_pools.put(e.node))}this.fly_item_list={},this.clearCoolTimer(),this.clearBuffCoolTimer(),this.clearVipTimer(),this.deleteLastTimeHandle(),window.TASK_TIPS=!1},updateResourceCollect:function(){if(0!=this.is_onshow){var t=Config.dungeon_data.data_drama_const.hangup_revenue,e=Config.dungeon_data.data_drama_const.hangup_revenue_small,i=Config.dungeon_data.data_drama_const.hangup_revenue_big;if(t&&e&&i){var s=this.drama_model.getHookAccumulateInfo();if(s){var n=s.hook_time||1,o=PlayerAction.action;o=n>=i.val?PlayerAction.action_5:n>=e.val?PlayerAction.action_3:n>=t.val?PlayerAction.action_1:PlayerAction.action,this.resources_action!=o&&(this.resources_action=o,this.changeCollectAction());var l=Config.dungeon_data.data_drama_const.profit_time_max;l&&(this.progress.progress=n/l.val),this.time_label.string=a.getTimeFormatIII(n)}}}},changeCollectAction:function(){if(null==this.skeletonData){var t=s.getSpinePath("E31324");this.loadRes(t,function(t){this.skeleton.skeletonData=t,this.skeletonData=t,this.changeCollectAction()}.bind(this))}else this.resources_action&&this.skeleton.setAnimation(0,this.resources_action,!0)},touchResourceBox:function(){if(this.skeletonData)if(null!=this.resources_action&&this.resources_action!=PlayerAction.action){if(1!=this.is_in_collect){this.is_in_collect=!0;var e=function(){var t=PlayerAction.action_2;this.resources_action==PlayerAction.action_3?t=PlayerAction.action_4:this.resources_action==PlayerAction.action_5&&(t=PlayerAction.action_6),this.skeleton.setToSetupPose(),this.skeleton.setAnimation(0,t,!1),Utils.delayRun(this.collect_container,1.5,function(){this.is_in_collect=!1,this.drama_controller.requestGetHookTimeAwards()}.bind(this))}.bind(this),i=this.drama_model.getHookAccumulateInfo(),s=this.role_vo.energy,n=this.role_vo.energy_max,a=0;if(i&&i.list)for(var o=0;o<i.list.length;o++){var l=i.list[o];if(l.bid==Config.item_data.data_assets_label2id.energy){a=l.num;break}}if(s+a>n){var r=function(){e()}.bind(this),c=function(){this.is_in_collect=!1}.bind(this),_=t("commonalert"),h=cc.js.formatStr(Utils.TI18N("\u5f53\u524d\u5df2\u6709%d/%d\u8fdc\u822a\u60c5\u62a5\uff0c\u9886\u53d6\u540e\u8d85\u51fa\u4e0a\u9650\u90e8\u5206\u5c06\u635f\u5931\uff0c\u662f\u5426\u786e\u8ba4\u9886\u53d6\uff1f"),s,n);_.show(h,Utils.TI18N("\u786e\u5b9a"),r,Utils.TI18N("\u53d6\u6d88"),c,null,c)}else e()}}else message(Utils.TI18N("\u9700\u8981\u7d2f\u79ef\u4e00\u5b9a\u6536\u76ca\u624d\u53ef\u4ee5\u9886\u53d6\u5662!"))},updateDramaDropInfo:function(){if(this.is_onshow){var t=this.drama_model.getDramaData();if(t&&this.cur_drama_max_id!=t.max_dun_id){this.cur_drama_max_id=t.max_dun_id,0==this.cur_drama_max_id&&(this.cur_drama_max_id=10010);var e=Config.dungeon_data.data_drama_dungeon_info[this.cur_drama_max_id];if(e){var i=e.hook_show_items,s=120*i.length*.75+10*(i.length-1),n=Math.max(this.scrollview_content.width,s);this.scrollview_content.width=n;for(var a=0;a<i.length;a++){var o=i[a],l=this.createDramaDropItem(a,.75,10,50);l&&l.setData({bid:o[0],num:o[1]})}this.updatePerHookInfo(e)}}}},updateMiniMapInfo:function(){var t=this.drama_model.getDramaData();if(t&&this.cur_drama_dun_id!=t.dun_id){this.cur_drama_dun_id=t.dun_id;var e=Config.dungeon_data.data_drama_dungeon_info[t.dun_id];if(e){this.mapname.string=e.name,this.cur_chapter_id=t.chapter_id;var i=Config.dungeon_data.data_drama_world_info[t.mode];if(i&&i[t.chapter_id]){var n=i[t.chapter_id].map_id;if(this.minimap_id!=n){this.minimap_id=n;var a=s.getBattleSceneRes(cc.js.formatStr("%s/blayer/small_map",n),!0);this.loadRes(a,function(t,e){t.spriteFrame=e,this.updateMiniIconPosition()}.bind(this,this.minimap_img))}else this.updateMiniIconPosition()}}}},updateMiniIconPosition:function(){if(this.minimap_img){var t=this.drama_model.getDramaData();if(t){var e=Config.dungeon_data.data_drama_dungeon_info[t.dun_id];if(e&&e.pos){var i=this.minimap_img.node.width,s=this.minimap_img.node.height,n=this.minimap_mark.width,a=this.minimap_mark.height,o=e.pos[0]*i/1024,l=e.pos[1]*s/1024;this.miniicon.x=o,this.miniicon.y=l,l=.5*a-l,(o=.5*n-o)>0?o=0:o<n-i&&(o=n-i),l>0?l=0:l<a-s&&(l=a-s),this.minimap_img.node.x=o,this.minimap_img.node.y=l}}}},updatePerHookInfo:function(t){if(t){var e=t.per_hook_items;for(var i in this.reward_layout_list){(a=this.reward_layout_list[i])&&a.layout&&(a.layout.active=!1)}for(var n=0;n<e.length;n++){var a,o=e[n];if((a=this.reward_layout_list[n])&&a.layout&&o){var l=o[0],r=o[1],c=Utils.getItemConfig(l);if(c){a.layout.active=!0;var _=s.getItemRes(c.icon);a.path!=_&&(a.path=_,this.loadRes(_,function(t,e){t.spriteFrame=e}.bind(this,a.icon))),a.label.string=r+"/m"}}}}},updateChallengeBossStatus:function(){if(this.is_onshow){var t=this.drama_model.getDramaData();if(t){var e=Utils.getNorKey(t.cool_time,t.status);if(this.drama_cur_status!=e){this.drama_cur_status=e;var i=t.max_dun_id||10010,s=Config.dungeon_data.data_drama_dungeon_info[i];if(s){if(this.challenge_cool_time=0,this.challenge_condition.status=0,this.challenge_condition.lev=0,this.clearCoolTimer(),!s||0==s.next_id)return this.challenge_boss_btn.active=!1,void(this.next_battle_time.active=!1);if(2==t.status&&0==t.cool_time){this.challenge_boss_btn.active=!0,this.next_battle_time.active=!1,this.challenge_condition.status=2;var n=Config.dungeon_data.data_drama_dungeon_info[t.dun_id];n&&(n.lev_limit<=this.role_vo.lev?(this.notice_label.string="",this.challenge_item.active=!0):(this.notice_label.string=cc.js.formatStr(Utils.TI18N("%s\u7ea7\u53ef\u6311\u6218"),n.lev_limit),this.challenge_item.active=!1,this.challenge_condition.lev=n.lev_limit))}else 1==t.status&&0!=t.cool_time?(this.challenge_condition.status=1,this.challenge_boss_btn.active=!1,this.next_battle_time.active=!0,this.challenge_cool_time=t.cool_time,this.next_label.string=a.getMinSecTime(this.challenge_cool_time-gcore.SmartSocket.getTime()),this.startCoolTimer()):3==t.status&&(this.challenge_condition.status=3,this.challenge_boss_btn.active=!0,this.next_battle_time.active=!1,this.challenge_item.active=!1,this.notice_label.string=Utils.TI18N("\u524d\u5f80\u4e0b\u4e00\u7ae0"));this.updateBtnLayerStatus(1!=this.challenge_condition.status)}}}}},updateRoleLevInfo:function(){this.challenge_condition&&0==this.challenge_condition.lev||this.role_vo&&this.role_vo.lev>=this.challenge_condition.lev&&(this.challenge_condition.lev=0,this.challenge_item.active=!0,this.notice_label.string="")},startCoolTimer:function(){null==this.time_ticker&&(this.time_ticker=gcore.Timer.set(function(){this.countDownCoolTimer()}.bind(this),1e3,-1))},clearCoolTimer:function(){this.time_ticker&&(gcore.Timer.del(this.time_ticker),this.time_ticker=null)},countDownCoolTimer:function(){var t=this.challenge_cool_time-gcore.SmartSocket.getTime();t<0&&(t=0,this.clearCoolTimer()),this.next_label.string=a.getMinSecTime(t)},createDramaDropItem:function(t,e,i,s){var n=this.drop_item_list[t];if(null==n){var a=s+t*(120*e+i);(n=ItemsPool.getInstance().getItem("backpack_item")).setParent(this.scrollview_content),n.initConfig(null,e,!1,!0),n.setPosition(a,0),n.show(),this.drop_item_list[t]=n}return n},onDelete:function(){if(this.drop_item_list){for(var t in this.drop_item_list){var e=this.drop_item_list[t];e&&e.deleteMe()}this.drop_item_list=null}this.clearCoolTimer(),this.clearBuffCoolTimer(),this.clearVipTimer(),this.handleEffect(!1),this.role_vo&&this.role_update_event&&(this.role_vo.unbind(this.role_update_event),this.role_update_event=null,this.role_vo=null),this.task_vo&&this.update_task_event&&(this.task_vo.unbind(this.update_task_event),this.update_task_event=null,this.task_vo=null),this.receiveitem&&(this.receiveitem.deleteMe(),this.receiveitem=null),this.update_online_get_event&&(gcore.GlobalEvent.unbind(this.update_online_get_event),this.update_online_get_event=null),this.time_tichet&&(gcore.Timer.del(this.time_tichet),this.time_tichet=null),this.left_btn_list={}},touchChallengeBoss:function(){if(this.deleteLastTimeHandle(),1!=this.battle_model.isInRealBattle()){if(3==this.challenge_condition.status)this.drama_controller.send13002();else if(2==this.challenge_condition.status)if(0!=this.challenge_condition.lev)message(Utils.TI18N("\u7b49\u7ea7\u4e0d\u8db3"));else{var e=t("hero_controller"),i=Config.dungeon_data.data_drama_const.boss_no_windows.val,s=this.drama_model.getDramaData();if(s.dun_id>=i[0]&&s.dun_id<=i[1])t("battle_drama_controller").getInstance().send13003(0);else e.getInstance().openFormGoFightPanel(!0)}}else message(Utils.TI18N("\u5f53\u524d\u6b63\u5728\u6218\u6597\u4e2d"))},updateRankTaskPos:function(){this.task_vo&&(this.tasknode.active=!0),this.rank_vo&&(this.ranknode.active=!0),this.updateTopBtnPos()},updateTopBtnPos:function(){if(null!=this.left_btn_list&&null!=Utils.next(this.left_btn_list)){var t=[];for(var e in this.left_btn_list){1==(s=this.left_btn_list[e]).active&&t.push({index:e,node:s})}for(var i in t.sort(function(t,e){return t.index-e.index}),t){var s;(s=t[i]).node&&(s.node.x=-250-94*i,s.node.y=-45)}}},updateTaskInfo:function(){if(!this.task_vo){null==this.mainui_controller&&(this.mainui_controller=t("mainui_controller").getInstance());var e=this.mainui_controller.getFucntionIconVoById(3);e&&(this.task_vo=e,this.updateRankTaskPos(),this.updateTaskRedTips(),null==this.update_task_event&&(this.update_task_event=this.task_vo.bind("FunctionIconVo.UPDATE_SELF_EVENT",function(t){"tips_status"==t&&this.updateTaskRedTips()}.bind(this))))}},updateTaskRedTips:function(){if(null!=this.task_vo){var t=this.task_vo.getTipsStatus();this.tasktips.active=t}},updateRankInfo:function(){if(!this.rank_vo){null==this.mainui_controller&&(this.mainui_controller=t("mainui_controller").getInstance());var e=this.mainui_controller.getFucntionIconVoById(5);e&&(this.rank_vo=e,this.updateRankTaskPos())}},updateHallowSpine:function(){var t=c.getInstance().getModel(),e=c.getInstance().checkIsOpen();if(0==this.is_real_combat&&e&&!t.checkIsHaveAllHallows()){this.hallownode.active=!0;var i=t.getCurActivityHallowsId();if(this.cur_hallows_id!=i){this.cur_hallows_id=i,this.hallowspine&&(this.hallowspine.setToSetupPose(),this.hallowspine.clearTracks());var n=Config.hallows_data.data_base[i];if(n){var a=s.getSpinePath(n.effect);this.hallow_spine_path!=a&&(this.hallow_spine_path=a,this.loadRes(a,function(t,e){t.skeletonData=e,t.setAnimation(0,PlayerAction.action_2,!0)}.bind(this,this.hallowspine)))}}var o=t.getHallowsTaskList(this.cur_hallows_id);if(o){var l=o.length,r=0;for(var _ in o)2==o[_].finish&&(r+=1);var h=r/l;this.hallowprogress.progress=h,this.haolowvalue.string=r+"/"+l}this.updateHallowsRedStatus()}else this.hallownode.active=!1},updateHallowsRedStatus:function(){var e=t("hallows_const"),i=c.getInstance().getModel().checkRedIsShowByRedType(e.Red_Index.task_award);this.hallowstips.active=i},updateQingBaoInfo:function(){if(this.role_vo){var t=this.role_vo.energy,e=this.role_vo.energy_max;this.qingbaovalue.string=t;var i=Math.min(1,Math.max(t/e));this.qingbaoprogress.fillRange=i}},checkVoyageRedStatus:function(){var e=t("voyage_controller").getInstance().getModel().checkVoyageRedStatus();this.qingbaotips.active=e},updatePassRewardRedPoint:function(){var t=this.battle_drama_model.getDramaRewardRedPointInfo();this.passtips.active=t},updateBattleBuff:function(){var t=this.drama_model.getBuffData();if(null==t||0==t.buff_list.length)return this.battle_buff_icon&&(this.battle_buff_icon.active=!1),this.clearBuffCoolTimer(),void this.updateBuffAndVipPos();var e=t.buff_list[0],i=Config.buff_data.data_get_buff_data[e.bid];if(null!=i){if(null==this.battle_buff_icon){this.battle_buff_icon=this.seekChild("battle_buff_icon"),this.battle_icon=this.seekChild(this.battle_buff_icon,"icon",cc.Sprite),this.battle_num_label=this.seekChild(this.battle_buff_icon,"num_label",cc.Label),this.battle_desc_label=this.seekChild(this.battle_buff_icon,"desc_label",cc.Label);var n=s.getBuffRes(i.icon);this.loadRes(n,function(t,e){t.spriteFrame=e}.bind(this,this.battle_icon))}this.battle_buff_icon.active=!0,this.battle_desc_label.string=i.des,this.battle_buff_time=e.end_time-gcore.SmartSocket.getTime(),this.countDownBuffCoolTimer(),this.startBuffCoolTimer(),this.updateBuffAndVipPos()}},clearBuffCoolTimer:function(){this.icon_time_ticker&&(gcore.Timer.del(this.icon_time_ticker),this.icon_time_ticker=null)},startBuffCoolTimer:function(){null==this.icon_time_ticker&&(this.icon_time_ticker=gcore.Timer.set(function(){this.countDownBuffCoolTimer()}.bind(this),1e3,-1))},countDownBuffCoolTimer:function(){if(null==this.battle_buff_time||0==this.battle_buff_time)return this.clearBuffCoolTimer(),void(this.battle_buff_icon&&(this.battle_buff_icon.active=!1));this.battle_buff_time-=1,this.battle_num_label.string=a.getTimeMs(this.battle_buff_time)},updateGiveVip:function(){var t=f.getInstance().getModel().getGiveVipInfo();if(null==t||1==t.state)return this.vip_icon&&(this.vip_icon.active=!1,this.handleEffect(!1)),this.clearBuffCoolTimer(),void this.updateBuffAndVipPos();null==this.vip_icon&&(this.vip_icon=this.seekChild("vip_icon"),this.vip_icon_img=this.seekChild(this.vip_icon,"icon",sp.Skeleton),this.vip_time_bg=this.seekChild(this.vip_icon,"Panel_1"),this.vip_time_label=this.seekChild(this.vip_icon,"num_label",cc.Label),this.vip_desc_label=this.seekChild(this.vip_icon,"desc_label",cc.Label),this.vip_tips=this.seekChild(this.vip_icon,"tips"),Utils.onTouchEnd(this.vip_icon,function(){f.getInstance().openVipAwardWindow(!0)}.bind(this),1),this.handleEffect(!0)),this.vip_icon.active=!0,this.vip_desc_label.string=Utils.TI18N("vip\u514d\u8d39\u9001"),this.vip_icon_time=t.time-gcore.SmartSocket.getTime(),this.countDownVipTimer(),this.startVipTimer(),this.updateBuffAndVipPos()},countDownVipTimer:function(){if(null==this.vip_icon_time||this.vip_icon_time<=0){this.clearVipTimer();var t=f.getInstance().getModel().getGiveVipInfo();return null!=t&&1!=t.state||this.vip_icon&&(this.vip_icon.active=!1,this.handleEffect(!1)),this.vip_time_bg.active=!1,this.vip_time_label.string="",f.getInstance().getModel().setGiveVipStatus(),void(this.vip_tips.active=f.getInstance().getModel().getGiveVipStatus())}this.vip_icon_time-=1,this.vip_time_label.string=a.getTimeMs(this.vip_icon_time,!0),this.vip_time_bg.active=!0},startVipTimer:function(){null==this.vip_time_ticker&&(this.vip_time_ticker=gcore.Timer.set(function(){this.countDownVipTimer()}.bind(this),1e3,-1))},clearVipTimer:function(){this.vip_time_ticker&&(gcore.Timer.del(this.vip_time_ticker),this.vip_time_ticker=null)},handleEffect:function(t){if(0==t)this.vip_icon_img&&(this.vip_icon_img.setToSetupPose(),this.vip_icon_img.clearTracks());else if(this.vip_icon_img){var e=s.getSpinePath("E31328","action");this.loadRes(e,function(t){this.vip_icon_img.skeletonData=t,this.vip_icon_img.setAnimation(0,PlayerAction.action,!0)}.bind(this))}},updateBuffAndVipPos:function(){this.battle_buff_icon&&1==this.battle_buff_icon.active?this.vip_icon&&1==this.vip_icon.active&&(this.vip_icon.y=-441):this.vip_icon&&1==this.vip_icon.active&&(this.vip_icon.y=-348)},playResourceCollect:function(t,e,i){if(1!=this.is_real_combat)for(var n=this.bottom_container.convertToNodeSpaceAR(cc.v2(t,e)),a=cc.v2(this.collect_container.x+.5*this.collect_container.width,this.collect_container.y+.5*this.collect_container.height),o=Utils.randomNum(10,11),l=0;l<o;l++){var r=(1-Utils.randomNum(0,2))*Utils.randomNum(0,40)+n.x,c=(1-Utils.randomNum(0,2))*Utils.randomNum(0,40)+n.y,_=Utils.randomNum(0,3),h=null;this.fly_item_pools.size()>0?h=this.fly_item_pools.get():((h=new cc.Node).setAnchorPoint(.5,.5),h.addComponent(cc.Sprite)),h.setPosition(r,c),h.scale=1,this.bottom_container.addChild(h);var d=s.getUIIconPath("battledrama","battledrama_resource_"+(_+1));this.loadRes(d,function(t,e){t.spriteFrame=e}.bind(this,h.getComponent(cc.Sprite))),this.auto_id+=1,this.fly_item_list[this.auto_id]={node:h,id:_},this.flyEnergyToWealth(h,_,a,r,c,l,this.auto_id)}},flyEnergyToWealth:function(t,e,i,s,n,a,o){var l=[],r=cc.v2(s,n);l.push(r);var c=cc.v2(i.x,i.y),_=r.add(c).mul(.5),h=-30,d=10;a%2==0&&(d=Utils.randomNum(100,150),h=30);var u=cc.v2(_.x+h,_.y+d);l.push(u),l.push(c);var m=cc.delayTime(.02*a),f=cc.bezierTo(1,l),p=cc.callFunc(function(){this.fly_item_pools.put(t),delete this.fly_item_list[o]}.bind(this)),g=cc.sequence(f,p),v=cc.scaleTo(1,.2);t.runAction(cc.sequence(m,cc.spawn(v,g)))},createReceiveIcon:function(t){var e=new cc.Node;e.setContentSize(76,76),e.addComponent(cc.Button);var i=(new cc.Node).addComponent(cc.Sprite);this.container.addChild(i.node),i.type=cc.Sprite.Type.SLICED,i.sizeMode=cc.Sprite.SizeMode.CUSTOM,this.loadRes(s.getUIIconPath("battledrama","battledrama_1014"),function(t){i.spriteFrame=t}),t=t||"";var n=Utils.createLabel(18,new cc.Color(0,255,0,255),new cc.Color(0,0,0,255),36,-53,t,e,2,cc.v2(.5,.5));return e.bg=i,e.label=n,e},checkQuickRed:function(){var e=this.drama_model.getDramaData();if(null!=e&&this.quick_btn_tips){var i=Config.dungeon_data.data_drama_const.fast_combat_first.val,s=!1;if(e.max_dun_id>=i&&(s=!0),this.quick_battle_status!=s&&(this.quick_battle_status=s),0==this.drama_model.getOpenQuickBattleStatus()){var n=this.drama_model.getQuickData(),a=t("backpack_controller").getInstance().getModel().getBackPackItemNumByBid(Config.dungeon_data.data_drama_const.quick_swap_item.val);1==s&&(n&&0==n.fast_combat_num||a>0)&&(this.quick_btn_tips.active=!0)}else this.quick_btn_tips.active=!1}},lastTimeGoToHandleEffect:function(){null==this.last_time_handle&&(this.last_time_handle=gcore.Timer.set(function(){if(0!=this.is_onshow){var t=this.battle_model.getFightStatus(),e=p.getInstance().isInGuide();cc.log("\u91cd\u590d\u68c0\u6d4b\u4e2d",t,e,TASK_TIPS),t||0==this.is_onshow||window.TASK_TIPS||1==e?this.deleteLastTimeHandle():this.challenge_condition&&2!=this.challenge_condition.status||this.effect_status||this.role_vo&&(this.role_vo.lev>=this.challenge_condition.lev||0==this.challenge_condition.lev)&&(cc.log("\u663e\u793a\u7279\u6548",this.effect_status),this.figureHandleEffect(!0))}}.bind(this),3e3,-1))},deleteLastTimeHandle:function(){this.last_time_handle&&(gcore.Timer.del(this.last_time_handle),this.last_time_handle=null,this.figureHandleEffect(!1),cc.log("\u6e05\u695a\u7279\u6548",this.effect_status))},figureHandleEffect:function(t){if(0==t)this.challenge_btn_effect&&(this.challenge_btn_effect.setToSetupPose(),this.challenge_btn_effect.clearTracks()),this.effect_status=!1;else if(this.challenge_btn_effect){this.effect_status=!0;var e=s.getEffectRes(240),i=s.getSpinePath(e);this.loadRes(i,function(t){this.challenge_btn_effect.skeletonData=t,this.challenge_btn_effect.setAnimation(0,PlayerAction.action_1,!0)}.bind(this))}},rectHandleEffect:function(t){if(0==t)this.challenge_btn_effect_1&&(this.challenge_btn_effect_1.setToSetupPose(),this.challenge_btn_effect_1.clearTracks()),this.effect_status=!1;else if(this.challenge_btn_effect_1){var e=s.getEffectRes(107),i=s.getSpinePath(e);this.loadRes(i,function(t){this.challenge_btn_effect_1.skeletonData=t,this.challenge_btn_effect_1.setAnimation(0,PlayerAction.action,!0)}.bind(this))}},updateBtnLayerStatus:function(t){this.lastTimeGoToHandleEffect();var e=this.battle_model.getFightStatus();this.challenge_btn_effect_1.node.active=t&&!e}});cc._RF.pop()},{backpack_controller:"backpack_controller",battle_controller:"battle_controller",battle_drama_controller:"battle_drama_controller",battle_drama_event:"battle_drama_event",commonalert:"commonalert",guide_controller:"guide_controller",guide_event:"guide_event",hallows_const:"hallows_const",hallows_controller:"hallows_controller",hallows_event:"hallows_event",hero_controller:"hero_controller",jump_controller:"jump_controller",mainui_controller:"mainui_controller",mainui_event:"mainui_event",onlinegift_controller:"onlinegift_controller",onlinegift_event:"onlinegift_event",pathtool:"pathtool",rank_controller:"rank_controller",role_controller:"role_controller",stronger_controller:"stronger_controller",task_controller:"task_controller",timetool:"timetool",vip_controller:"vip_controller",vip_event:"vip_event",voyage_controller:"voyage_controller",voyage_event:"voyage_event"}],battle_camp_Item:[function(t,e,i){"use strict";cc._RF.push(e,"fb18cEp1A1EEL9mbkrC8yHD","battle_camp_Item");var s=t("pathtool"),n=t("partner_calculate");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("battle","battle_camp_item")},initConfig:function(){this.camp_icons=[],this.attr_label={}},initPanel:function(){var t=this.root_wnd.getChildByName("main_container");this.cur_bg=t.getChildByName("cur_bg"),this.cur_bg.active=!1,this.form_icon=t.getChildByName("form_icon"),this.btn=this.form_icon.getComponent(cc.Button),this.name_lb=t.getChildByName("name").getComponent(cc.Label),this.sp_activate=t.getChildByName("sp_activate"),this.sp_activate.active=!1,this.attr_label=t.getChildByName("attr_label").getComponent(cc.RichText),this.line=t.getChildByName("line"),this.data&&this.setData(this.data)},registerEvent:function(){},onShow:function(t){},onHide:function(){},setData:function(t){if(this.data=t,cc.log(t),t&&this.root_wnd){var e=this;1==t.is_activate?(e.cur_bg.active=!0,this.btn.interactable=!0,this.btn.enableAutoGrayEffect=!1,this.sp_activate.active=!0):(e.cur_bg.active=!1,this.btn.interactable=!1,this.btn.enableAutoGrayEffect=!0,this.sp_activate.active=!1);var i=s.getUIIconPath("campicon","campicon_"+t.icon);this.loadRes(i,function(t){e.form_icon.getComponent(cc.Sprite).spriteFrame=t}.bind(this)),this.name_lb.string=t.name,this.line.active=t.index!=Config.combat_halo_data.data_halo_show_length-1;var a="",o=0;for(var l in t.attr_data){t.attr_data[l].is_activate&&(o=l)}var r=Utils.getArrLen(t.attr_data),c=0;for(var _ in t.attr_data){for(var h=t.attr_data[_],d=h.desc,u=0;u<h.attrs.length;++u){var m=h.attrs[u],f=m[0],p=m[1]/1e3,g=Config.attr_data.data_key_to_name[f];if(g)1==n.isShowPerByStr(f)&&(p=1e3*p*100/1e3+"%"),d+=_==o?cc.js.formatStr("    %s<color=#68c74b>+%s</color>",g,p):cc.js.formatStr("    %s+%s",g,p)}d=_==o?cc.js.formatStr("<color=#e0bf98>%s</color>",d):cc.js.formatStr("<color=#695b50>%s</color>",d),r!=++c?a=a+d+"\n":a+=d}this.attr_label.string=a}},onDelete:function(){}});cc._RF.pop()},{partner_calculate:"partner_calculate",pathtool:"pathtool"}],battle_camp_window:[function(t,e,i){"use strict";cc._RF.push(e,"9f32f8mi0xM7p1LxrXy34aU","battle_camp_window");var s=t("pathtool"),n=t("common_scrollview"),a=t("battle_camp_Item"),o=t("battle_controller"),l=t("battle_event");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("battle","battle_camp_view"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Full,this.ctrl=o.getInstance()},initConfig:function(){},openCallBack:function(){this.background=this.root_wnd.getChildByName("background");var t=this.root_wnd.getChildByName("main_container");t.getChildByName("title_label_1").getComponent(cc.Label).string=Utils.TI18N("\u79cd\u65cf\u514b\u5236"),t.getChildByName("title_label_2").getComponent(cc.Label).string=Utils.TI18N("\u79cd\u65cf\u514b\u5236\u6548\u679c:"),t.getChildByName("attr_label_1").getComponent(cc.Label).string=Utils.TI18N("\u4f24\u5bb3+25%"),t.getChildByName("attr_label_2").getComponent(cc.Label).string=Utils.TI18N("\u547d\u4e2d+20%"),this.background.scale=FIT_SCALE;var e=t.getChildByName("list_panel"),i=cc.size(e.width,e.height),s={item_class:a,start_x:0,space_x:0,start_y:0,space_y:5,item_width:603,item_height:143,row:0,col:1,need_dynamic:!0};this.camp_scrollview=new n,this.camp_scrollview.createScroll(e,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,i,s)},registerEvent:function(){this.background.on("touchend",function(){Utils.playButtonSound(2),this.ctrl.openBattleCampView(!1)},this),this.addGlobalEvent(l.EXIT_FIGHT,function(){this.ctrl.openBattleCampView(!1)}.bind(this))},openRootWnd:function(t){this.form_id_list=t||[],this.form_pos_info={};for(var e=0;e<this.form_id_list.length;++e){var i=this.form_id_list[e],s=Config.combat_halo_data.data_halo[i];if(s)for(var n=0;n<s.pos_info.length;++n){var a=s.pos_info[n],o=a[0],l=a[1];this.form_pos_info[o]?this.form_pos_info[o]=this.form_pos_info[o]+l:this.form_pos_info[o]=l}}this.refreshCampList()},refreshCampList:function(){var t=Config.combat_halo_data.data_halo_show;if(t){var e=[];for(var i in t){var s=t[i],n=Utils.deepCopy(s),a={};for(var o in a.id=i,a.is_activate=!1,n){var l=n[o];l.is_activate=this.checkIsActivateCamp(l.pos_info),l.is_activate&&(a.is_activate=!0),a.name||(a.name=l.name),a.icon||(a.icon=l.icon)}a.attr_data=n,e.push(a)}e.sort(function(t,e){return t.is_activate&&!e.is_activate?-1:!t.is_activate&&e.is_activate?1:t.id-e.id});for(var r=0;r<e.length;++r)e[r].index=r;this.camp_scrollview.setData(e)}},checkIsActivateCamp:function(t){var e=!1;if(t&&null!=Utils.next(t)){e=!0;for(var i=0;i<t.length;++i){var s=t[i],n=s[0],a=s[1],o=0;for(var l in this.form_pos_info){var r=this.form_pos_info[l];if(l==n){o=r;break}}if(a>o){e=!1;break}}}return e},closeCallBack:function(){this.camp_scrollview&&(this.camp_scrollview.deleteMe(),this.camp_scrollview=null),this.ctrl.openBattleCampView(!1)}});cc._RF.pop()},{battle_camp_Item:"battle_camp_Item",battle_controller:"battle_controller",battle_event:"battle_event",common_scrollview:"common_scrollview",pathtool:"pathtool"}],battle_const:[function(t,e,i){"use strict";var s;function n(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}cc._RF.push(e,"da627tjxzpNZL4bM5lpxwlz","battle_const");var a={Fight_Type:{Nil:0,Default:1,Arena:2,Darma:3,SingleBoss:4,WorldBoss:5,Adventrue:6,StarTower:7,PK:8,GuildDun:9,Champion:10,Endless:11,LimitBoss:12,Escort:13,DungeonStone:14,Godbattle:15,GuildWar:16,PrimusWar:17,LadderWar:18,ExpeditFight:21,EliteMatchWar:23,EliteKingMatchWar:24,ElementWar:25,HeroTestWar:26,HeavenWar:27,CrossArenaWar:28,LimitExercise:29,AdventrueMine:30},Unit_Type:{Role:1,Hero:2,Monster:3,Hallows:4},Group_Type:{Friend:1,Enemgy:2},Battle_Type_Conf:{TYPE_ENEMY:-1,TYPE_ROLE:1,BATTLE_EXIT:1},Skill_Type:{ACTIVE_SKILL:"active_skill",PASSIVE_SKILL:"passive_skill",EQM_PASSIVE_SKILL:"eqm_passive_skill"},Effect_Play_Type:{ROLE:1,SCENE:2,ROLE_SCENE:3,ENEMY_SCENE:4,TARGET:5},Battle_In_Type:{Nil:0,UnReal:1,Real:2},ShareType:{SharePk:1,SharePlunder:2,ShareLadder:3},JumpType:{Summon:1,HeroBag:2,Forge:3,Hallows:4},getUIFightByFightType:function(e){var i=t("mainui_const");switch(e){case this.Fight_Type.Darma:case this.Fight_Type.Nil:return i.ui_fight_type.drama_scene;case this.Fight_Type.StarTower:return i.ui_fight_type.star_tower;case this.Fight_Type.GuildDun:return i.ui_fight_type.guild_dun;case this.Fight_Type.Arena:return i.ui_fight_type.arena;case this.Fight_Type.LimitBoss:return i.ui_fight_type.limit_boss;case this.Fight_Type.GuildWar:return i.ui_fight_type.guildwar;case this.Fight_Type.PrimusWar:return i.ui_fight_type.primusWar;case this.Fight_Type.LadderWar:return i.ui_fight_type.ladderwar;case this.Fight_Type.Endless:return i.ui_fight_type.endless;case this.Fight_Type.ExpeditFight:return i.ui_fight_type.expedit_fight;case this.Fight_Type.DungeonStone:case this.Fight_Type.ElementWar:case this.Fight_Type.HeavenWar:return i.ui_fight_type.dungeon_stone;case this.Fight_Type.Adventrue:return i.ui_fight_type.sky_scene;default:return i.ui_fight_type.drama_scene}},isNoRequest:function(t){return t==this.Fight_Type.Default||t==this.Fight_Type.PK||t==this.Fight_Type.HeroTestWar},isPvP:function(t){return t==this.Fight_Type.Arena||t==this.Fight_Type.Escort},isNeedName:function(t){return t==this.Fight_Type.PK},isNeedSpecStart:function(t){return t==a.Fight_Type.Arena||t==a.Fight_Type.Champion||t==a.Fight_Type.PK||t==a.Fight_Type.LadderWar},canDoBattle:function(e){var i=this.getUIFightByFightType(e),s=t("mainui_controller"),n=t("battle_controller");return s.getInstance().getUIFightType()==i||this.isNoRequest(e)||n.getInstance().getWatchReplayStatus()},BattleGroupTypeConf:{TYPE_GROUP_ENEMY:2,TYPE_GROUP_ROLE:1},BattleObjectType:{Role:1,Pet:2,Unit:3,Hallows:4},Old_Halo_Id_Change:(s={},n(s,1,[1]),n(s,2,[2]),n(s,3,[3]),n(s,4,[4]),n(s,5,[5]),n(s,6,[21]),n(s,7,[6]),n(s,8,[6]),n(s,9,[7]),n(s,10,[7]),n(s,11,[8]),n(s,12,[8]),n(s,13,[11,18]),n(s,14,[13,17]),n(s,15,[12,16]),n(s,16,[14,20]),n(s,17,[15,19]),s)};e.exports=a,cc._RF.pop()},{battle_controller:"battle_controller",mainui_const:"mainui_const",mainui_controller:"mainui_controller"}],battle_controller:[function(t,e,i){"use strict";cc._RF.push(e,"62167uC4DxBcKgCTRWlKWsl","battle_controller");var s=t("battle_event"),n=t("battle_const"),a=t("mainui_controller"),o=t("levupgrade_controller"),l=t("mainui_event"),r=cc.Class({extends:BaseController,ctor:function(){},initConfig:function(){this.model=Utils.createClass("battle_model"),this.hook_model=Utils.createClass("battle_hook_model"),this.model.initConfig(),this.hook_model.initConfig(),this.is_watch_replay=!1,this.is_unlock_chapter=!1,this.is_normal_battle=!1,this.finish_result_view_list={},this.finish_fail_view_list={},this.cache_list=[]},getModel:function(){return this.model},getHookModel:function(){return this.hook_model},registerEvents:function(){null==this.loading_enter_scene&&(this.loading_enter_scene=gcore.GlobalEvent.bind(l.LOADING_ENTER_SCENE,function(){this.showCachePanel()}.bind(this)))},registerProtocals:function(){this.RegisterProtocal(20027,this.scInitFightStart),this.RegisterProtocal(20002,this.scRoundFightStart),this.RegisterProtocal(20004,this.scRoundFightOn),this.RegisterProtocal(20006,this.scFightEnd),this.RegisterProtocal(20008,this.scFightExit),this.RegisterProtocal(20009,this.scSkipFirstTeam),this.RegisterProtocal(20013,this.scReBattleFight),this.RegisterProtocal(20014,this.scBattlePk),this.RegisterProtocal(20015,this.scBattlePkRe),this.RegisterProtocal(20016,this.scBattlePkTwice),this.RegisterProtocal(20020,this.scRoundNextFight),this.RegisterProtocal(20022,this.scFightSpeed),this.RegisterProtocal(20029,this.scRecordBattle),this.RegisterProtocal(20033,this.handle20033),this.RegisterProtocal(20034,this.handle20034),this.RegisterProtocal(20036,this.handle20036),this.RegisterProtocal(20060,this.handle20060),this.RegisterProtocal(20061,this.handle20061),this.RegisterProtocal(20062,this.handle20062)},isInFight:function(){return this.model.getFightStatus()},hadBattleScene:function(){return null!=this.model.getBattleScene()},handleBattleSceneStatus:function(t){this.model.handleBattleSceneStatus(t)},send20060:function(t){cc.log("\u8bf7\u6c42\u5207\u51fa\u6218\u6597");var e={combat_type:t};this.SendProtocal(20060,e)},handle20060:function(t){0==t.combat_type&&this.clearBattleScene(),gcore.GlobalEvent.fire(s.COMBAT_TYPE_BACK,t.combat_type,t.type)},scFightEnd:function(e){cc.log("\u6218\u6597\u7ed3\u7b97\u7684,\u4e5f\u6709\u53ef\u80fd\u4e0d\u9700\u8981\u51fa\u7ed3\u7b97\u9762\u677f---",e);var i=!1;if(e.combat_type>1e3&&(e.combat_type=e.combat_type-1e3,i=!0),e.combat_type==n.Fight_Type.Endless){var s=t("prompt_controller"),a=t("prompt_type_const");s.getInstance().getModel().removePromptDataByTpye(a.Endless_trail)}this.model.showWin(e,i)},clearBattleScene:function(){this.model.clearBattleScene()},requestCutOutBattle:function(){var e=t("battle_const");this.send20060(e.Fight_Type.Nil)},scInitFightStart:function(e){t("battle_const").canDoBattle(e.combat_type)&&(this.model.updateCurBattleData(e,!0),this.prepareLoaderBattleScene(e.combat_type,2))},scReBattleFight:function(e){t("battle_const").canDoBattle(e.combat_type)&&(this.model.updateCurBattleData(e,!1),this.prepareLoaderBattleScene(e.combat_type,2))},scRoundFightStart:function(t){Log.info("\u56de\u5408\u5f00\u59cb\u64ad\u62a5"),this.model.playRoundStart(t)},scRoundFightOn:function(t){Log.info("\u56de\u5408\u64ad\u62a5"),this.model.playRoundIn(t)},csSkillPlayEnd:function(){Log.info("20004 \u64ad\u62a5\u5b8c\u6210"),this.SendProtocal(20005,{})},csRoundFightEnd:function(){Log.info("20002 \u64ad\u62a5\u5b8c\u6210"),this.SendProtocal(20019,{})},csReadyFightStart:function(){Log.info("\u6218\u6597\u521d\u59cb\u5316\u5b8c\u6210,\u901a\u77e5\u670d\u52a1\u7aef\u53ef\u4ee5\u5f00\u59cb\u64ad\u62a5\u4e86"),this.SendProtocal(20001,{})},send20062:function(){this.SendProtocal(20062,{})},handle20062:function(t){message(t.msg)},handle20061:function(t){cc.log("\u5047\u6218\u6597\u6570\u636e"),cc.log(t),this.hook_model.updateUnrealBattleData(t),this.prepareLoaderBattleScene(t.combat_type,1)},csRecordBattle:function(t){var e={};e.replay_id=t,this.SendProtocal(20029,e)},scRecordBattle:function(t){message(t.msg),1==t.code&&this.setWatchReplayStatus(!0)},handle20033:function(t){null==t.combat_type&&(t.combat_type=n.Fight_Type.PK),null==t.show_panel_type&&(t.show_panel_type=1),this.model.showWin(t)},on20034:function(t,e,i,s){var n={};n.replay_id=t,n.channel=e,n.target_name=i,n.share_type=s,this.SendProtocal(20034,n)},handle20034:function(t){message(t.msg)},prepareLoaderBattleScene:function(t,e){this.model.createBattleScene(e,t),2==e&&gcore.GlobalEvent.fire(EventId.ENTER_FIGHT,t,e)},scRoundNextFight:function(t){t&&this.model.upDateNextMon(t)},update:function(t){this.model.mapMovescheduleUpdate()},changeMoveMapStatus:function(t){this.model.changeMoveMapStatus()},sender_20036:function(t,e){var i={replay_id:t,replay_srv_id:e};this.SendProtocal(20036,i)},handle20036:function(t){1==t.code&&this.setWatchReplayStatus(!0)},csFightExit:function(){this.SendProtocal(20008,{})},scFightExit:function(t){message(t.msg)},csSkipFirstTeam:function(){this.SendProtocal(20009,{})},scSkipFirstTeam:function(t){message(t.msg)},getWatchReplayStatus:function(){return this.is_watch_replay},setWatchReplayStatus:function(t){this.is_watch_replay=t},getIsClickStatus:function(){var t=this.model.getCombatType();return this.getWatchReplayStatus()||t==n.Fight_Type.PK||t==n.Fight_Type.HeroTestWar},setUnlockChapterStatus:function(t){this.is_unlock_chapter=t},getUnlockChapterStatus:function(){return this.is_unlock_chapter},showCachePanel:function(){if(!(null==this.cache_list||this.cache_list.length<=0)){for(var t in this.cache_list)this.cache_list[t].function&&this.cache_list[t].function();this.cache_list=[]}},openFinishView:function(e,i,s){if(1==e){if(1==IS_LOADING)return void this.cache_list.push({function:function(t,e,i){this.openFinishView(t,e,i)}.bind(this,e,i,s)});if(this.finish_result_view_list[i]&&(this.finish_result_view_list[i].close(),this.finish_result_view_list[i]=null),!this.is_unlock_chapter)if(i==n.Fight_Type.StarTower)t("startower_controller").getInstance().openResultWindow(!0,s);else if(i==n.Fight_Type.Arena){t("arena_controller").getInstance().openLoopResultWindow(!0,s)}else if(i==n.Fight_Type.Darma&&s&&1==s.result){o.getInstance().waitForOpenLevUpgrade(!0);var a=t("battle_mvp_window");this.finish_result_view_list[i]=new a(s),this.finish_result_view_list[i].open()}else if(i==n.Fight_Type.GuildDun)t("guildboss_controller").getInstance().openGuildbossResultWindow(!0,s);else if(i==n.Fight_Type.PK)this.finish_result_view_list[i]=Utils.createClass("battle_pk_result_window"),this.finish_result_view_list[i].open(s);else if(!this.finish_result_view_list[i])if(1==s.result){o.getInstance().waitForOpenLevUpgrade(!0);var l=t("battle_result_window");this.finish_result_view_list[i]=new l(s.result,i),this.finish_result_view_list[i].open({data:s,fight_type:i})}else cc.log("\u6253\u5f00\u5931\u8d25\u754c\u9762"),this.openFailFinishView(!0,i,s.result,s)}else this.finish_result_view_list[i]&&(this.finish_result_view_list[i].close(),this.finish_result_view_list[i]=null)},getFinishView:function(t){if(this.finish_result_view_list)return this.finish_result_view_list[t]},openBattleHarmInfoView:function(t,e){1==t?(null==this.harm_info_view&&(this.harm_info_view=Utils.createClass("battle_harm_info_window")),this.harm_info_view.open(e)):this.harm_info_view&&(this.harm_info_view.close(),this.harm_info_view=null)},openFailFinishView:function(e,i,s,l){if(1==e){if(this.is_unlock_chapter)a.getInstance().checkIsInDramaUIFight()&&this.battle_controller.send20060(n.Fight_Type.Darma);else if(!this.finish_fail_view_list[i]){o.getInstance().waitForOpenLevUpgrade(!0);var r=new(t("battle_fail_window"))(i,s,l);r&&r.open(),this.finish_fail_view_list[i]=r}}else this.finish_fail_view_list[i]&&(this.finish_fail_view_list[i].close(),this.finish_fail_view_list[i]=null)},getIsSameBattleType:function(t){return t==this.model.getCombatType()},openBattleCampView:function(e,i){if(1==e){if(!this.battle_camp_view){var s=t("battle_camp_window");this.battle_camp_view=new s}0==this.battle_camp_view.isOpen()&&this.battle_camp_view.open(i)}else this.battle_camp_view&&(this.battle_camp_view.close(),this.battle_camp_view=null)},setIsNormaBattle:function(t){this.is_normal_battle=t},getIsNoramalBattle:function(){return this.is_normal_battle},csFightSpeed:function(t){var e={};e.speed=t,this.SendProtocal(20022,e)},scFightSpeed:function(t){message(t.msg)},getCtrlBattleScene:function(t){t(this.model.getBattleScene())},getDramaFightUI:function(t){if(t)t(this.model.getDramaFightUI());else if(this.model)return this.model.getDramaFightUI()},csBattlePk:function(t,e,i){var s={};s.target_id=t,s.target_srv_id=e,s.is_province=i,this.SendProtocal(20014,s)},scBattlePk:function(e){message(e.msg),t("chat_controller").getInstance().closeChatPanel(!1),t("friend_controller").getInstance().openFriendCheckPanel(!1)},confirmBattlePk:function(t){},csBattlePkRe:function(t,e){var i={};i.target_id=e.target_id,i.target_srv_id=e.target_srv_id,i.is_agree=t?1:0,this.SendProtocal(20015,i)},scBattlePkRe:function(t){message(t.msg)},scBattlePkTwice:function(e){if(e&&!this.isInFight()){var i=function(){this.csBattlePkTwiceConfirm(!0,{target_srv_id:e.target_srv_id,target_id:e.target_id})}.bind(this),s=function(){this.csBattlePkTwiceConfirm(!1,{target_srv_id:e.target_srv_id,target_id:e.target_id})}.bind(this),n=cc.js.formatStr(Utils.TI18N("\u73a9\u5bb6<color=#0x249015>%s</color>\u540c\u610f\u4e86\u4f60\u7684\u5207\u78cb\u8bf7\u6c42,\u70b9\u51fb\u201d\u7acb\u5373\u5207\u78cb\u201c\u7acb\u5373\u8fdb\u5165\u5207\u78cb\u6218\u6597\uff1f"),e.target_name||"");t("commonalert").show(n,Utils.TI18N("\u7acb\u5373\u5207\u78cb"),i,Utils.TI18N("\u53d6\u6d88"),s)}},csBattlePkTwiceConfirm:function(t,e){var i={};i.target_id=e.target_id,i.target_srv_id=e.target_srv_id,i.is_agree=t?1:0,this.SendProtocal(20016,i)},openBattleBuffInfoView:function(e,i,s){if(1==e){if(null==this.buff_info_view){var n=t("battle_buff_info_window");this.buff_info_view=new n}0==this.buff_info_view.isOpen()&&this.buff_info_view.open({left_name:i,right_name:s})}else this.buff_info_view&&(this.buff_info_view.close(),this.buff_info_view=null)},updateBattleBuffListView:function(t,e,i){this.buff_list_view&&this.buff_list_view.checkIsChosedBuffList(e,i)&&this.buff_list_view.setData(t)},openBattleBuffListView:function(e,i,s,n){if(1==e){if(null==this.buff_list_view){var a=t("battle_buff_list_window");this.buff_list_view=new a}0==this.buff_list_view.isOpen()&&this.buff_list_view.open({data:i,group:s,partner_bid:n})}else this.buff_list_view&&(this.buff_list_view.close(),this.buff_list_view=null)}});e.exports=r,cc._RF.pop()},{arena_controller:"arena_controller",battle_buff_info_window:"battle_buff_info_window",battle_buff_list_window:"battle_buff_list_window",battle_camp_window:"battle_camp_window",battle_const:"battle_const",battle_event:"battle_event",battle_fail_window:"battle_fail_window",battle_mvp_window:"battle_mvp_window",battle_result_window:"battle_result_window",chat_controller:"chat_controller",commonalert:"commonalert",friend_controller:"friend_controller",guildboss_controller:"guildboss_controller",levupgrade_controller:"levupgrade_controller",mainui_controller:"mainui_controller",mainui_event:"mainui_event",prompt_controller:"prompt_controller",prompt_type_const:"prompt_type_const",startower_controller:"startower_controller"}],battle_data:[function(t,e,i){"use strict";cc._RF.push(e,"ce9eapVbdhKR6CjQwid529Q","battle_data");var s=t("battle_role_data"),n=t("battle_buff_data"),a=cc.Class({extends:BaseClass,ctor:function(){this.fight_object_list={},this.buff_play_list={},this.halo_list={},this.formation={}},properties:{fight_object_list:null,buff_play_list:null,halo_list:null,formation:null,combat_type:0,current_wave:0,total_wave:0,action_count:0,target_role_name:"",actor_role_name:"",flag:0,extra_args:[],is_active:!1},updateData:function(t){this.combat_type=t.combat_type,this.current_wave=t.current_wave,this.total_wave=t.total_wave,this.target_role_name=t.target_role_name,this.actor_role_name=t.actor_role_name,this.flag=t.flag?t.flag:0,t.extra_args&&(this.extra_args=t.extra_args),t.action_count&&(this.action_count=t.action_count),this.updateObjectData(t.objects),this.updateBuffData(t.buffs),this.updateHaloData(t.halo_list),this.updateFormationData(t.formation),this.is_active=!0},updateObjectData:function(t){if(null!=t)for(var e=0;e<t.length;e++){var i=t[e];null==this.fight_object_list[i.pos]&&(this.fight_object_list[i.pos]=new s),this.fight_object_list[i.pos].updateData(i)}},updateBuffData:function(t){if(null!=t)for(var e=0;e<t.length;e++){var i=t[e];null==this.buff_play_list[i.target]&&(this.buff_play_list[i.target]={}),null==this.buff_play_list[i.target][i.id]&&(this.buff_play_list[i.target][i.id]=new n),this.buff_play_list[i.target][i.id].updateData(i)}},updateHaloData:function(t){if(null!=t)for(var e=0;e<t.length;e++){var i=t[e];null==this.halo_list[i.group]&&(this.halo_list[i.group]={group:0,type:0}),this.halo_list[i.group].group=i.group,this.halo_list[i.group].type=i.type}},updateFormationData:function(t){if(null!=t)for(var e=0;e<t.length;e++){var i=t[e];null==this.formation[i.group]&&(this.formation[i.group]={formation_type:0,formation_lev:0}),this.formation[i.group].formation_type=i.formation_type,this.formation[i.group].formation_lev=i.formation_lev}},setActive:function(t){0==t&&(this.buff_play_list={},this.is_active=!1)}});e.exports=a,cc._RF.pop()},{battle_buff_data:"battle_buff_data",battle_role_data:"battle_role_data"}],battle_drama_boos_info_window:[function(t,e,i){"use strict";cc._RF.push(e,"92c68tkJkZJiI9wWLH6/kQa","battle_drama_boos_info_window");var s=t("pathtool"),n=t("battle_drama_event"),a=t("backpack_controller"),o=t("baserole");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("battledrama","battle_darma_boos_info_windows"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Mini,this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){this.swap_status=0,this.item_list=[]},openCallBack:function(){this.panel_bg=this.root_wnd.getChildByName("Panel_bg"),this.background=this.panel_bg.getChildByName("background"),this.background.scale=FIT_SCALE,this.main_container=this.root_wnd.getChildByName("root"),this.close_btn=this.main_container.getChildByName("close_btn"),this.ack_button=this.main_container.getChildByName("ack_button"),this.window_title_label=this.main_container.getChildByName("window_title_label").getComponent(cc.Label),this.window_title_label.string=Utils.TI18N("\u5173\u5361\u4fe1\u606f"),this.dungeon_name=this.main_container.getChildByName("dungeon_name").getComponent(cc.Label),this.boss_name_desc=this.main_container.getChildByName("boss_name_desc"),this.boss_name_desc.string=Utils.TI18N("BOSS:"),this.boss_name=this.main_container.getChildByName("boss_name").getComponent(cc.Label),this.diffcult_label_desc=this.main_container.getChildByName("diffcult_label_desc").getComponent(cc.Label),this.diffcult_label_desc.string=Utils.TI18N("\u6218\u6597\u529b:"),this.diffcult_label=this.main_container.getChildByName("diffcult_label").getComponent(cc.Label),this.item_container=this.main_container.getChildByName("item_container"),this.title_label=this.item_container.getChildByName("title_label").getComponent(cc.Label),this.title_label.string=Utils.TI18N("\u53ef\u80fd\u6389\u843d"),this.item_scroolview=this.item_container.getChildByName("item_scroolview"),this.scroolview_content=this.item_scroolview.getChildByName("content"),this.role_bg=this.main_container.getChildByName("role_bg").getComponent(cc.Sprite),this.loadRes(s.getBigBg("bigbg_5"),function(t){this.role_bg.spriteFrame=t}.bind(this)),this.swap_label=Utils.createRichLabel(24,new cc.Color(202,114,36,255),cc.v2(0,.5),cc.v2(70,370),30,1e3),this.main_container.addChild(this.swap_label.node),this.swap_label.node.active=!1,this.swap_num_label=Utils.createRichLabel(26,new cc.Color(202,114,36,255),cc.v2(0,.5),cc.v2(410,685),40,1e3),this.main_container.addChild(this.swap_num_label.node),this.swap_num_label.node.active=!1,this.free_swap_label=Utils.createRichLabel(26,new cc.Color(202,114,36,255),cc.v2(0,.5),cc.v2(485,330),40,1e3),this.free_swap_label.string=Utils.TI18N("\u672c\u6b21\u626b\u8361\u514d\u8d39"),this.main_container.addChild(this.free_swap_label.node),this.free_swap_label.node.active=!1,this.updateData()},updateData:function(){if(this.dungeon_data){this.dungeon_name.string=this.dungeon_data.info_data.name;var t=Utils.getUnitConfig(this.dungeon_data.info_data.unit_id),e=this.model.getCurDunInfoByID(this.dungeon_data.info_data.id)||this.dungeon_data.v_data,i=e.status;t&&(this.boss_name.string=t.name),this.diffcult_label.string=this.dungeon_data.info_data.power;var s=cc.js.formatStr(Utils.TI18N("<color=#764519>\u626b\u8361\u6b21\u6570: </color><color=#249003>%s</color>/%s"),e.auto_num,Config.dungeon_data.data_drama_const.swap_time.val);e.auto_num>=Config.dungeon_data.data_drama_const.swap_time.val&&(s=string.format(TI18N("<color=#764519>\u626b\u8361\u6b21\u6570: </color><<color=#249003>%s/%s</color>"),e.auto_num,Config.dungeon_data.data_drama_const.swap_time.val)),this.swap_num_label.string=s,this.updateItemReward(this.dungeon_data.info_data.show_items),this.updateRole(this.dungeon_data.info_data.unit_id);var n=this.model.getDramaData(),a=Config.dungeon_data.data_drama_const.swap_time.val-n.auto_num;n&&a<=0||(this.updateBtnStatus(i),this.updateFreeData())}},updateFreeData:function(){var t=Config.dungeon_data.data_drama_const.free_swap.val,e=this.model.getDramaData();this.is_free=e.auto_num-t<0},updateBtnStatus:function(t){3==t?this.swap_status=2:(this.swap_status=0,2==t&&(this.swap_status=1))},updateRole:function(t){this.spine_model||""==t||(this.spine_model=new o,this.spine_model.setParent(this.role_bg.node),this.spine_model.setPosition(0,this.role_bg.node.getContentSize().height/2+30),this.spine_model.setData(o.type.unit,t,PlayerAction.show,!0,.8))},updateItemReward:function(t){if(t){var e=null,i=120*t.length+10*t.length,s=Math.max(this.scroolview_content.getContentSize().width,i);for(var n in this.scroolview_content.setContentSize(cc.size(s,this.scroolview_content.getContentSize().height)),t)if(this.item_list[n]||((e=ItemsPool.getInstance().getItem("backpack_item")).setParent(this.scroolview_content),e.setAnchorPoint(.5,.5),e.show(),this.item_list[n]=e),e=this.item_list[n]){e.setPosition(60+130*n,this.item_scroolview.getContentSize().height/2);var a={bid:t[n][0],num:t[n][1]};e.setData(a),e.setDefaultTip()}}},registerEvent:function(){Utils.onTouchEnd(this.background,function(){this.ctrl.openDramBossInfoView(!1)}.bind(this),2),Utils.onTouchEnd(this.close_btn,function(){this.ctrl.openDramBossInfoView(!1)}.bind(this),2),this.addGlobalEvent(n.BattleDrama_Boss_Update_Data,function(t){if(t){var e=cc.js.formatStr("<color=#764519>\u626b\u8361\u6b21\u6570: </color><color=#289b14>%s</color>/%s",t.auto_num,Config.dungeon_data.data_drama_const.swap_time.val);t.auto_num>=Config.dungeon_data.data_drama_const.swap_time.val&&(e=cc.js.formatStr(Utils.TI18N("<color=#764519>\u626b\u8361\u6b21\u6570: </color> <color=#249003>%s</color><color=#249003>/%s</color>"),t.auto_num,Config.dungeon_data.data_drama_const.swap_time.val)),this.swap_num_label.string=e}}.bind(this)),this.addGlobalEvent(n.BattleDrama_Update_Data,function(t){this.updateData()}.bind(this)),this.addGlobalEvent(n.BattleDrama_Quick_Battle_Data,function(t){this.updateFreeData()}.bind(this))},checkSwapAlert:function(){var e=a.getInstance().getModel().getBackPackItemNumByBid(Config.dungeon_data.data_drama_const.swap_item.val);if(this.is_free)this.ctrl.send13005(this.dungeon_data.info_data.id,1);else if(e<=0){var i=this.model.getDramaData(),n=Math.min(i.auto_num+1,Config.DungeonData.data_swap_data.length),o=Config.dungeon_data.data_swap_data[n].loss,l=cc.js.formatStr(Utils.TI18N("\u626b\u8361\u5238\u4e0d\u8db3,\u662f\u5426\u4f7f\u7528<img src=%s visible=true scale=0.5 /><color=#289b14 fontsize= 26>%s</color>\u626b\u8361\u5173\u5361?"),s.getItemRes(o[0][0]),o[0][1]),r=function(){this.dungeon_data&&this.dungeon_data.info_data&&this.ctrl.send13005(this.dungeon_data.info_data.id,1)}.bind(this);t("commonalert").show(l,Utils.TI18N("\u786e\u5b9a"),r,Utils.TI18N("\u53d6\u6d88"))}else this.ctrl.openDramSwapView(!0,this.dungeon_data.info_data.id)},openRootWnd:function(t){this.dungeon_data=t,this.updateData()},closeCallBack:function(){this.spine_model&&(this.spine_model.deleteMe(),this.spine_model=null),this.ctrl.openDramBossInfoView(!1)}});cc._RF.pop()},{backpack_controller:"backpack_controller",baserole:"baserole",battle_drama_event:"battle_drama_event",commonalert:"commonalert",pathtool:"pathtool"}],battle_drama_controller:[function(t,e,i){"use strict";cc._RF.push(e,"e8d7c26Iv5NxrbZP2BWe7mN","battle_drama_controller");var s=t("battle_event"),n=t("battle_const"),a=t("story_event"),o=t("levupgrade_controller"),l=t("mainui_event"),r=cc.Class({extends:BaseController,properties:{role_vo:null},ctor:function(){},initConfig:function(){var e=t("battle_drama_model");this.model=new e,this.model.initConfig(),this.cache_list=[]},getModel:function(){return this.model},registerEvents:function(){this.create_role_event=gcore.GlobalEvent.bind(EventId.EVT_ROLE_CREATE_SUCCESS,function(){gcore.GlobalEvent.unbind(this.create_role_event),this.create_role_event=null;var e=t("role_controller");this.role_vo=e.getInstance().getRoleVo()}.bind(this)),this.battle_exit_event=gcore.GlobalEvent.bind(s.CLOSE_RESULT_VIEW,function(t){t==n.Fight_Type.Darma?this.handleUnlock():gcore.GlobalEvent.fire(a.BATTLE_RESULT_OVER)}.bind(this)),null==this.loading_enter_scene&&(this.loading_enter_scene=gcore.GlobalEvent.bind(l.LOADING_ENTER_SCENE,function(){this.showCachePanel()}.bind(this)))},registerProtocals:function(){this.RegisterProtocal(13e3,this.on13000),this.RegisterProtocal(13001,this.on13001),this.RegisterProtocal(13002,this.on13002),this.RegisterProtocal(13003,this.on13003),this.RegisterProtocal(13004,this.on13004),this.RegisterProtocal(13006,this.on13006),this.RegisterProtocal(13007,this.on13007),this.RegisterProtocal(13008,this.on13008),this.RegisterProtocal(13009,this.on13009),this.RegisterProtocal(13010,this.on13010),this.RegisterProtocal(13011,this.on13011),this.RegisterProtocal(13015,this.on13015),this.RegisterProtocal(13017,this.on13017),this.RegisterProtocal(13019,this.on13019),this.RegisterProtocal(13018,this.on13018),this.RegisterProtocal(13016,this.on13016),this.RegisterProtocal(13020,this.handle13020),this.RegisterProtocal(13039,this.on13039),this.RegisterProtocal(13040,this.on13040)},requestInitProto:function(){},send13000:function(){this.SendProtocal(13e3,{})},on13000:function(t){t&&this.role_vo&&this.model.setDramaData(t)},on13001:function(t){this.model.updateDramaData(t)},on13006:function(t){this.model.setQuickData(t)},on13008:function(t){this.model.setDramaReward(t)},on13011:function(t){this.model.setBuffData(t)},on13017:function(t){this.model.updateHookAccumulateTime(t)},on13016:function(e){e&&t("battle_controller").getInstance().openFinishView(!0,t("battle_const").Fight_Type.Darma,e)},requestGetHookTimeAwards:function(){this.SendProtocal(13018,{})},on13018:function(t){message(t.msg)},on13019:function(e){if(!this.commonalert)if(1!=IS_LOADING){var i=t("mainui_controller"),s=t("mainui_const"),n=i.getInstance().getMainUIIndex(),a=Utils.TI18N("\u60a8\u7684\u6302\u673a\u6536\u76ca\u5373\u5c06\u8fbe\u5230\u4e0a\u9650\uff0c\u8bf7\u524d\u5f80\u51fa\u51fb\u754c\u9762\u9886\u53d6"),o=Utils.TI18N("\u524d\u5f80");n==s.btn_index.drama_scene&&(o=Utils.TI18N("\u786e\u5b9a"),a=Utils.TI18N("\u60a8\u7684\u6302\u673a\u6536\u76ca\u5373\u5c06\u8fbe\u5230\u4e0a\u9650\uff0c\u8bf7\u70b9\u51fb\u6536\u76ca\u5b9d\u7bb1\u9886\u53d6"));var l=t("commonalert"),r=function(){n!=s.btn_index.drama_scene&&i.getInstance().changeMainUIStatus(s.btn_index.drama_scene),this.commonalert=null}.bind(this);this.commonalert=l.show(a,o,r,Utils.TI18N("\u53d6\u6d88"),function(){this.commonalert=null},null,null,{view_tag:SCENE_TAG.reconnect})}else this.cache_list.push({function:function(t){this.on13019(t)}.bind(this,e)})},on13007:function(t){this.openDramHookRewardView(!0,t)},openDramHookRewardView:function(t,e){t?(o.getInstance().waitForOpenLevUpgrade(!0),null==this.battle_drama_hook_reward_view&&(this.battle_drama_hook_reward_view=Utils.createClass("battle_drama_hook_reward_window")),this.battle_drama_hook_reward_view.open(e)):this.battle_drama_hook_reward_view&&(this.battle_drama_hook_reward_view.close(),this.battle_drama_hook_reward_view=null)},openDramBattleQuickView:function(t){t?(o.getInstance().waitForOpenLevUpgrade(!0),this.battle_drama_quick_win||(this.battle_drama_quick_win=Utils.createClass("battle_drama_quick_window")),this.battle_drama_quick_win.open()):this.battle_drama_quick_win&&(this.battle_drama_quick_win.close(),this.battle_drama_quick_win=null)},openDramaRewardWindow:function(t){t?(this.battle_drama_reward_view||(this.battle_drama_reward_view=Utils.createClass("battle_drama_reward_window")),this.battle_drama_reward_view.open()):this.battle_drama_reward_view&&(this.battle_drama_reward_view.close(),this.battle_drama_reward_view=null)},openDramaPassVedioWindow:function(t){t?(this.battle_drama_vedio_view||(this.battle_drama_vedio_view=Utils.createClass("battle_drama_pass_vedio_window")),this.battle_drama_vedio_view.open()):this.battle_drama_vedio_view&&(this.battle_drama_vedio_view.close(),this.battle_drama_vedio_view=null)},openDramDropWindows:function(t,e){t?(this.battle_drama_drop_tips_view||(this.battle_drama_drop_tips_view=Utils.createClass("battle_drama_drop_window")),this.battle_drama_drop_tips_view.open(e)):this.battle_drama_drop_tips_view&&(this.battle_drama_drop_tips_view.close(),this.battle_drama_drop_tips_view=null)},openBattleDramaMapWindows:function(t,e){1==t?(null==this.battle_drama_map_view&&(this.battle_drama_map_view=Utils.createClass("battle_drama_map_window",this)),this.battle_drama_map_view&&0==this.battle_drama_map_view.isOpen()&&this.battle_drama_map_view.open(e)):this.battle_drama_map_view&&(this.battle_drama_map_view.close(),this.battle_drama_map_view=null)},openDramBossInfoView:function(t,e){0==t?null!=this.battle_drama_boss_info&&(this.battle_drama_boss_info.close(),this.battle_drama_boss_info=null):(null==this.battle_drama_boss_info&&(this.battle_drama_boss_info=Utils.createClass("battle_drama_boos_info_window",this)),this.battle_drama_boss_info&&0==this.battle_drama_boss_info.isOpen()&&this.battle_drama_boss_info.open(e))},send13002:function(){this.SendProtocal(13002,{})},on13002:function(t){message(t.msg)},on13010:function(t){this.handleUnlockChapter(t)},handleUnlockChapter:function(e){Config.dungeon_data.data_drama_dungeon_info[e.dun_id]&&(0==Config.dungeon_data.data_drama_dungeon_info[e.dun_id].next_id&&(e.is_last_chapter=!0));(e.is_last_chapter=!1,e)&&t("worldmap_controller").getInstance().openWorldMapMainWindow(!0,e)},send13003:function(){this.SendProtocal(13003,{is_auto:0})},on13003:function(t){message(t.msg)},send13004:function(){this.SendProtocal(13004,{})},on13004:function(t){message(t.msg)},send13009:function(t){var e={};e.id=t,this.SendProtocal(13009,e)},on13009:function(t){message(t.msg),1==t.code&&this.model.updateDramaReward(t.id)},send13015:function(t){var e={};e.dun_id=t,this.SendProtocal(13015,e)},on13015:function(e){if(e&&e.dungeon_replay_log){var i=t("battle_drama_event");gcore.GlobalEvent.fire(i.UpdatePassVedioDataEvent,e.dungeon_replay_log)}},send13020:function(){this.SendProtocal(13020,{})},handle13020:function(e){if(e.val){var i=t("battle_drama_event");gcore.GlobalEvent.fire(i.UpdateDramaProgressDataEvent,e.val)}},getDramaBattlePassRewardRoot:function(){if(this.battle_drama_reward_view)return this.battle_drama_reward_view.root_wnd},getDramaBattleHookRewardRoot:function(){if(this.battle_drama_hook_reward_view)return this.battle_drama_hook_reward_view.root_wnd},getDramBattleQuickRoot:function(){if(this.battle_drama_quick_win)return this.battle_drama_quick_win.root_wnd},handleUnlock:function(){var t=this.model.getDramaData();if(t){this.model.getPreStatus(t.max_dun_id);gcore.GlobalEvent.fire(a.BATTLE_RESULT_OVER)}},openBattleDramaUnlockWindow:function(){if(0==value)null!=this.battle_drama_unlock_view&&(this.battle_drama_unlock_view.close(),this.battle_drama_unlock_view=null);else{if(null==this.battle_drama_unlock_view){var e=t("battle_drama_unlock_window");this.battle_drama_unlock_view=new e}this.battle_drama_unlock_view&&0==this.battle_drama_unlock_view.isOpen()&&this.battle_drama_unlock_view.open(data)}},openBattleDramaUnlockChapterView:function(e,i){if(0==e)null!=this.battle_drama_unlock_chapter_view&&(this.battle_drama_unlock_chapter_view.close(),this.battle_drama_unlock_chapter_view=null);else{if(null==this.battle_drama_unlock_chapter_view){var s=t("battle_drama_unlock_chapter_window");this.battle_drama_unlock_chapter_view=new s}this.battle_drama_unlock_chapter_view&&0==this.battle_drama_unlock_chapter_view.isOpen()&&this.battle_drama_unlock_chapter_view.open(i)}},showCachePanel:function(){if(!(null==this.cache_list||this.cache_list.length<=0)){for(var t in this.cache_list)this.cache_list[t].function&&this.cache_list[t].function();this.cache_list=[]}},send13039:function(){this.SendProtocal(13039,{})},on13039:function(t){},send13040:function(){this.SendProtocal(13040,{})},on13040:function(t){this.model.setFirstFresh(1!=t.flag)}});e.exports=r,cc._RF.pop()},{battle_const:"battle_const",battle_controller:"battle_controller",battle_drama_event:"battle_drama_event",battle_drama_model:"battle_drama_model",battle_drama_unlock_chapter_window:"battle_drama_unlock_chapter_window",battle_drama_unlock_window:"battle_drama_unlock_window",battle_event:"battle_event",commonalert:"commonalert",levupgrade_controller:"levupgrade_controller",mainui_const:"mainui_const",mainui_controller:"mainui_controller",mainui_event:"mainui_event",role_controller:"role_controller",story_event:"story_event",worldmap_controller:"worldmap_controller"}],battle_drama_drop_boss_item:[function(t,e,i){"use strict";cc._RF.push(e,"44f12VPB5JGTqZovIgJgLoX","battle_drama_drop_boss_item");var s=t("pathtool"),n=t("battle_drama_controller"),a=t("string_util"),o=t("battle_drama_drop_sec_boss_item"),l=cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("battledrama","battle_drama_drop_boss_item")},initConfig:function(){this.size=cc.size(602,57),this.item_list={},this.is_lock=!0,this.ctrl=n.getInstance(),this.model=this.ctrl.getModel(),this.drama_data=this.model.getDramaData()},initPanel:function(){this.container=this.seekChild("root"),this.name_label_lb=this.seekChild("name_label",cc.Label),this.arrow_nd=this.seekChild("arrow"),this.lock_panel_nd=this.container.getChildByName("lock_panel"),this.lock_panel_nd.active=!1,this.unlock_label_lb=this.seekChild(this.lock_panel_nd,"unlock_label",cc.Label),this.msg_panel=this.seekChild("layout"),null!=this.is_show&&this.showMessagePanel(this.is_show)},registerEvent:function(){Utils.onTouchEnd(this.root_wnd,function(){this.callback&&(0==this.is_lock?this.callback(this):message(Utils.TI18N("\u901a\u5173\u672c\u7ae0\u540e\u5f00\u542f")))}.bind(this),2)},setData:function(t){this.data=t,this.root_wnd&&this.onShow()},onShow:function(){if(null!=this.data){var t=this.data;if(this.chapter_id=t.chapter_id,this.drama_data){var e=this.model.getOpenSumChapter(this.drama_data.mode);t.chapter_id<=e?(this.is_lock=!1,this.lock_panel_nd.active=!1,this.arrow_nd.active=!0):(this.lock_panel_nd.active=!0,this.arrow_nd.active=!1)}this.name_label_lb.string=Utils.TI18N("\u7b2c")+a.numToChinese(t.chapter_id)+Utils.TI18N("\u7ae0 ")+t.name}},addCallBack:function(t){this.callback=t},getIsShow:function(){return this.is_show},setSelect:function(t){},showMessagePanel:function(t){this.is_show=t,null!=this.root_wnd&&(t?(this.createMessagePanel(),this.arrow_nd.scale=1):this.arrow_nd.scale=-1,this.msg_panel&&(this.msg_panel.active=t))},createMessagePanel:function(){var t=[],e=[],i=Config.dungeon_data.data_drama_boss_show_reward;if(i){var s=this.drama_data.max_dun_id;if(null!=this.chapter_id&&i[this.chapter_id]){var n=i[this.chapter_id],a=this.model.getHasCurChapterPassListBossNum(this.drama_data.mode,this.chapter_id),l=0;if(n)for(var r in n)t.push(n[r]);if(t.sort(Utils.tableLowerSorter(["dungeon_id"])),t)for(var r in t){var c=t[r];(c.dungeon_id<=s||l<a)&&e.push(c),l+=1}}}if(e&&null!=Utils.next(e)){var _=e.length;for(var r in this.msg_panel.setContentSize(585,_*o.HEIGHT),e)this.delayRun(e[r],r)}},delayRun:function(t,e){var i;(e=Number(e),this.item_list[e])||((i=new o).setAnchorPoint(0,1),this.item_list[e]=i,i.setParent(this.msg_panel),i.show());(i=this.item_list[e])&&i.setBossData(t)},updateItemList:function(){if(this.item_list&&null!=Utils.next(this.item_list||{}))for(var t in this.item_list){var e=this.item_list[t];e&&e.updateBtnStatus()}},getMsgPanleSize:function(){return this.msg_panel?this.msg_panel.getContentSize():cc.size(0,0)},onHide:function(){},onDelete:function(){if(this.item_list)for(var t in this.item_list)this.item_list[t]}});l.WIDTH=602,l.HEIGHT=57,cc._RF.pop()},{battle_drama_controller:"battle_drama_controller",battle_drama_drop_sec_boss_item:"battle_drama_drop_sec_boss_item",pathtool:"pathtool",string_util:"string_util"}],battle_drama_drop_sec_boss_item:[function(t,e,i){"use strict";cc._RF.push(e,"f91216p/zRBg53KEauh4usD","battle_drama_drop_sec_boss_item");var s=t("pathtool"),n=t("common_scrollview"),a=cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("battledrama","battle_drama_drop_sec_item")},initConfig:function(){},initPanel:function(){this.container=this.seekChild("root"),this.name_lb=this.seekChild("name_label",cc.Label),this.scroll_con_nd=this.seekChild(this.container,"item_scrollview");var t=this.scroll_con_nd.getContentSize(),e={item_class:"backpack_item",start_x:0,space_x:0,start_y:0,space_y:0,item_width:.8*BackPackItem.Width,item_height:.8*BackPackItem.Height,row:1,col:0,scale:.8};this.item_scrollview=new n,this.item_scrollview.createScroll(this.scroll_con_nd,cc.v2(0,0),ScrollViewDir.horizontal,ScrollViewStartPos.top,t,e,cc.v2(.5,.5))},registerEvent:function(){},setBossData:function(t){this.data=t,this.root_wnd&&this.onShow()},setData:function(t,e){this.is_single=e||!1,this.data=t,this.root_wnd&&this.onShow()},onShow:function(){if(null!=this.data)if(null!=this.is_single)1==this.is_single?(this.name_lb.string=Utils.TI18N("\u5f53\u524d\u5173\u5361"),this.updateItem(this.data)):(this.name_lb.string=this.data.name,this.updateItem(this.data.items));else{var t=gdata("dungeon_data","data_drama_dungeon_info",[this.data.dungeon_id]);t&&(this.name_lb.string=t.name),this.updateItem(this.data.items)}},updateItem:function(t){if(null!=t){var e=[];for(var i in t){var s=t[i],n={};n.bid=s[0],n.num=s[1],e.push(n)}this.item_scrollview.setData(e),this.item_scrollview.addEndCallBack(function(){var t=this.item_scrollview.getItemList();for(var e in t)t[e]&&t[e].setDefaultTip()}.bind(this))}},onHide:function(){},onDelete:function(){this.item_scrollview&&(this.item_scrollview.deleteMe(),this.item_scrollview=null)}});a.WIDTH=600,a.HEIGHT=168,cc._RF.pop()},{common_scrollview:"common_scrollview",pathtool:"pathtool"}],battle_drama_drop_tips_panel:[function(t,e,i){"use strict";cc._RF.push(e,"f062aPwM4pDG6wkV0tedQsh","battle_drama_drop_tips_panel");var s=t("pathtool"),n=t("battle_drama_controller"),a=t("battle_drama_drop_sec_boss_item"),o=t("common_scrollview");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("battledrama","battle_drama_drop_view"),this.ctrl=n.getInstance(),this.model=this.ctrl.getModel(),this.drama_data=this.model.getDramaData(),this.max_dun_id=arguments[0]||this.drama_data.max_dun_id},initConfig:function(){this.item_list={}},initPanel:function(){this.main_container=this.seekChild("root"),this.scroll_nd=this.seekChild("scroll_nd"),this.empty_bg_nd=this.seekChild("empty_bg"),this.empty_bg_nd.active=!0;var t=this.scroll_nd.getContentSize(),e={item_class:a,start_x:0,space_x:0,start_y:0,space_y:0,item_width:a.WIDTH,item_height:a.HEIGHT,row:1,col:1,need_dynamic:!0};if(this.scroll_view=new o,this.scroll_view.createScroll(this.scroll_nd,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,t,e,cc.v2(.5,.5)),this.max_dun_id&&gdata("dungeon_data","data_drama_dungeon_info",[this.max_dun_id])){var i=gdata("dungeon_data","data_drama_dungeon_info",[this.max_dun_id]);this.updateItemReward(i.hook_show_items)}},registerEvent:function(){},onShow:function(t){},updateItemReward:function(t){if(null!=t){this.empty_bg_nd.active=!1,this.cur_item=new a,this.cur_item.show(),this.cur_item.setData(t,!0),this.cur_item.setPosition(0,230),this.cur_item.setParent(this.main_container);var e=this.model.getDramaData();if(e){var i=this.model.getShowDescRewad(e.max_dun_id);i&&null!=Utils.next(i||{})&&this.scroll_view.setData(i)}}},setVisibleStatus:function(t){t=t||!1,this.setVisible(t)},onHide:function(){},onDelete:function(){this.scroll_view&&(this.scroll_view.deleteMe(),this.scroll_view=null),this.cur_item&&(this.cur_item.deleteMe(),this.cur_item=null)}});cc._RF.pop()},{battle_drama_controller:"battle_drama_controller",battle_drama_drop_sec_boss_item:"battle_drama_drop_sec_boss_item",common_scrollview:"common_scrollview",pathtool:"pathtool"}],battle_drama_drop_window:[function(t,e,i){"use strict";cc._RF.push(e,"62c54450bpCUp5AkxxVEn/6","battle_drama_drop_window");var s=t("pathtool"),n=t("battle_drama_controller");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("battledrama","battle_drama_drop_windows"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Big},initConfig:function(){this.panel_list={},this.tab_list={},this.tab_array=[{label:Utils.TI18N("Boss\u6389\u843d"),index:1},{label:Utils.TI18N("\u6302\u673a\u6389\u843d"),index:2}],this.cur_tab=null,this.cur_index=null,this.ctrl=n.getInstance()},openCallBack:function(){this.background=this.seekChild("background"),this.background.scale=FIT_SCALE,this.main_container=this.seekChild("root"),this.close_btn=this.seekChild(this.main_container,"close_btn"),this.image_3_nd=this.seekChild(this.main_container,"Image_3"),this.tableContainer=this.seekChild(this.main_container,"tab_container");for(var t=null,e=null,i=null,s=1;s<=this.tab_array.length;s++)(t=this.tableContainer.getChildByName(cc.js.formatStr("tab_btn_%s",s))).select_bg=t.getChildByName("select_bg"),t.select_bg.active=!1,t.unselect_bg=t.getChildByName("unselect_bg"),t.label=t.getChildByName("title").getComponent(cc.Label),t.label.node.color=new cc.Color(207,181,147,255),e=this.tab_array[s-1].index,i=this.tab_array[s-1].label,t.type=e,t.label.string=i,this.tab_list[e]=t},registerEvent:function(){Utils.onTouchEnd(this.background,function(){this.ctrl.openDramDropWindows(!1)}.bind(this),2),Utils.onTouchEnd(this.close_btn,function(){this.ctrl.openDramDropWindows(!1)}.bind(this),2),Utils.onTouchEnd(this.world_btn,function(){}.bind(this),2);var t=function(t){Utils.onTouchEnd(t,function(){null!=t.type&&this.changeTabView(t.type)}.bind(this),1)}.bind(this);if(this.tab_list)for(var e in this.tab_list){t(this.tab_list[e])}},openRootWnd:function(t,e){this.max_dun_id=t,e=e||1,this.changeTabView(e)},changeTabView:function(e){if(!this.cur_index||this.cur_index!=e){null!=this.cur_tab&&(this.cur_tab.label&&(this.cur_tab.label.node.color=new cc.Color(207,181,147,255)),this.cur_tab.select_bg.active=!1),this.cur_tab=this.tab_list[e],null!=this.cur_tab&&(this.cur_tab.label&&(this.cur_tab.label.node.color=new cc.Color(255,237,214,255)),this.cur_tab.select_bg.active=!0),null!=this.cur_panel&&(this.cur_panel.setVisibleStatus(!1),this.cur_panel=null);var i=this.panel_list[e];if(null==i){if(1==e)i=new(t("battle_drama_drop_boss_tips_panel"))(this.max_dun_id);else if(2==e){i=new(t("battle_drama_drop_tips_panel"))(this.max_dun_id)}this.panel_list[e]=i,null!=i&&(i.setParent(this.image_3_nd),i.show())}null!=i&&(i.setVisibleStatus(!0),this.cur_panel=i,this.cur_index=e)}},closeCallBack:function(){if(this.panel_list){for(var t in this.panel_list)this.panel_list[t]&&(this.panel_list[t].deleteMe(),this.panel_list[t]=null);this.panel_list=null}this.ctrl.openDramDropWindows(!1)}});cc._RF.pop()},{battle_drama_controller:"battle_drama_controller",battle_drama_drop_boss_tips_panel:void 0,battle_drama_drop_tips_panel:"battle_drama_drop_tips_panel",pathtool:"pathtool"}],battle_drama_event:[function(t,e,i){"use strict";var s;function n(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}cc._RF.push(e,"4db18pMGZFH1LnrSDd0ty0u","battle_drama_event"),e.exports=(n(s={BattleDrama_Update_Data:"BattleDrama_Update_Data",BattleDrama_Boss_Update_Data:"BattleDrama_Boss_Update_Data",BattleDrama_Quick_Battle_Data:"BattleDrama_Quick_Battle_Data",BattleDrama_Top_Update_Data:"BattleDrama_Top_Update_Data",BattleDrama_Drama_Reward_Data:"BattleDrama_Drama_Reward_Data",BattleDrama_Update_Max_Id:"BattleDrama_Update_Max_Id",BattleDrama_Drama_Next_Dungeon:"BattleDrama_Drama_Next_Dungeon",BattleDrama_Drama_Unlock_View:"BattleDrama_Drama_Unlock_View",BattleDrama_Drama_Buff_View:"BattleDrama_Drama_Buff_View",UpdatePartnerRedStatus:"UpdatePartnerRedStatus",BattleDrama_Update_Dun_Id:"BattleDrama_Update_Dun_Id",UpdateHookAccumulateTime:"UpdateHookAccumulateTime",UpdatePassVedioDataEvent:"UpdatePassVedioDataEvent",UpdateDramaProgressDataEvent:"UpdateDramaProgressDataEvent",BattleDrama_Update_Cool_Time:"BattleDrama_Update_Cool_Time"},"BattleDrama_Update_Dun_Id","BattleDrama_Update_Dun_Id"),n(s,"BattleDramaConst",{Normal:1,Diffcult:2}),s),cc._RF.pop()},{}],battle_drama_hook_reward_list_panel:[function(t,e,i){"use strict";cc._RF.push(e,"b297eT2K5FO8YoG2gt9zEgm","battle_drama_hook_reward_list_panel");cc.Class({extends:BaseClass,ctor:function(){this.x=0,this.y=0},setParent:function(t){this.parent=t,this.is_show_name=!1},registerEvent:function(){},show:function(t){},setData:function(t){null==this.backpack_item&&(this.backpack_item=Utils.createClass("backpack_item"),this.backpack_item.setParent(this.parent),this.backpack_item.initConfig(!0,1,!1,!0,this.is_show_name),this.backpack_item.show(),this.backpack_item.setPosition(this.x,this.y)),this.backpack_item.setData(t)},addCallBack:function(t){},setPosition:function(t,e){this.x=t,this.y=e,this.backpack_item&&this.backpack_item.setPosition(t,e)},setExtendData:function(t){t&&(this.is_show_name=t.is_show_name||!1)},suspendAllActions:function(){},setVisible:function(t){this.backpack_item.setVisible(t)},hide:function(){},deleteMe:function(){this.backpack_item&&this.backpack_item.deleteMe(),this.backpack_item=null}});cc._RF.pop()},{}],battle_drama_hook_reward_window:[function(t,e,i){"use strict";cc._RF.push(e,"975fcwudqpIbr0Nz7Eww19A","battle_drama_hook_reward_window");var s=t("pathtool"),n=t("timetool"),a=t("battle_drama_hook_reward_list_panel");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("battledrama","battle_drama_hook_reward_windows"),this.viewTag=SCENE_TAG.dialogue},initConfig:function(){this.controller=t("battle_drama_controller").getInstance(),this.role_vo=t("role_controller").getInstance().getRoleVo()},openCallBack:function(){this.background=this.seekChild("background"),this.background.scale=FIT_SCALE,this.guidesign_rewards_quick_btn=this.seekChild("guidesign_rewards_quick_btn"),this.vip_notice_label=this.seekChild(this.guidesign_rewards_quick_btn,"label",cc.Label),this.vip_notice_label.string=Utils.TI18N("\u83b7\u5f97\u6765\u81eavip\u3001\u79f0\u53f7\u7684\u6536\u76ca\u52a0\u6210"),this.progress_container=this.seekChild("progress_container"),this.progress=this.seekChild(this.progress_container,"progress",cc.ProgressBar),this.progress_bar=this.seekChild(this.progress_container,"progress_bar"),this.progress_width=this.progress_container.width,this.skeleton=this.seekChild("title_container",sp.Skeleton),this.level=this.seekChild("level",cc.Label),this.progress_val=this.seekChild("progress_val",cc.Label),this.time_value=this.seekChild("time_value",cc.Label),this.time_title=this.seekChild("time_title",cc.Label),this.list_view=this.seekChild("list_view");var t=this.seekChild("main_container");this.player_head=Utils.createClass("playerhead"),this.player_head.setParent(t),this.player_head.setHeadRes(this.role_vo.face_id),this.player_head.setPosition(-178,142),this.player_head.show()},registerEvent:function(){Utils.onTouchEnd(this.background,function(){this.controller.openDramHookRewardView(!1)}.bind(this),2),Utils.onTouchEnd(this.guidesign_rewards_quick_btn,function(){this.controller.openDramHookRewardView(!1)}.bind(this),2)},openRootWnd:function(t){Utils.playButtonSound("c_get"),t&&(this.result_type=t.type,1==this.result_type?this.time_title.string=Utils.TI18N("\u6302\u673a\u6536\u76ca:"):2==this.result_type&&(this.time_title.string=Utils.TI18N("\u5feb\u901f\u4f5c\u6218:")),this.handleEffect(),this.setBaseInfo(t),this.createItemList(t.items),0==t.vip_buff?this.vip_notice_label.string=Utils.TI18N("vip\u53ef\u83b7\u989d\u5916\u6536\u76ca\u52a0\u6210"):t.honor_buff?this.vip_notice_label.string=Utils.TI18N("\u83b7\u5f97\u6765\u81eavip\u3001\u79f0\u53f7\u7684\u6536\u76ca\u52a0\u6210"):this.vip_notice_label.string=Utils.TI18N("\u83b7\u5f97\u6765\u81eavip\u7684\u6536\u76ca\u52a0\u6210"))},handleEffect:function(){var t=s.getSpinePath("E51024"),e=PlayerAction.action_1;2==this.result_type&&(e=PlayerAction.action_2),this.loadRes(t,function(t,e){this.skeleton.skeletonData=e,this.skeleton.setAnimation(0,t,!1)}.bind(this,e))},setBaseInfo:function(t){if(t){this.level.string="LV."+t.new_lev,this.time_value.string=n.getTimeFormat(t.time);var e=t.old_lev,i=t.old_exp,s=Config.role_data.data_role_attr[e],a=t.new_lev,o=t.new_exp,l=Config.role_data.data_role_attr[a];s&&l&&(this.progress_val.string=o+"/"+l.exp_max,this.old_exp_progress=i/s.exp_max,this.progress.progress=this.old_exp_progress,this.progress_bar.x=this.old_exp_progress*this.progress_width+5,this.old_role_lev=e,this.old_role_exp=i,this.new_role_lev=a,this.new_role_exp=o,this.old_config=s,this.new_config=l,this.baseCurMaxExp=this.old_config.exp_max,this.basePercent=this.old_exp_progress,this.maxPercent=this.new_role_exp/this.baseCurMaxExp,this.old_role_lev!=this.new_role_lev&&(this.maxPercent=1),this.startUpdate(this.new_role_exp/this.baseCurMaxExp*1e3/10,this.showProgressEffect.bind(this),10))}},showProgressEffect:function(t){this.basePercent=this.basePercent+.01,this.basePercent>this.maxPercent?this.old_role_lev==this.new_role_lev?(this.baseCurMaxExp=this.new_config.exp_max,this.basePercent=this.new_role_exp/this.baseCurMaxExp,this.progress.progress=this.basePercent,this.progress_bar.x=this.basePercent*this.progress_width+5,this.progress_val.string=this.new_role_exp+"/"+this.baseCurMaxExp,this.stopUpdate()):(this.old_role_lev+=1,this.basePercent=0,this.maxPercent=1,this.baseCurMaxExp=Config.role_data.data_role_attr[this.old_role_lev].exp_max,this.old_role_lev==this.new_role_lev&&(this.maxPercent=this.new_role_exp/this.new_config.exp_max)):(this.progress.progress=this.basePercent,this.progress_bar.x=this.basePercent*this.progress_width+5,this.progress_val.string=this.new_role_exp+"/"+this.baseCurMaxExp)},createItemList:function(t){if(null==this.item_scrollview){var e=cc.size(this.list_view.width,this.list_view.height),i={item_class:a,start_x:94,space_x:20,start_y:0,space_y:0,item_width:120,item_height:180,row:4,col:4,need_dynamic:!0};this.item_scrollview=Utils.createClass("common_scrollview"),this.item_scrollview.createScroll(this.list_view,null,null,null,e,i,cc.v2(.5,.5))}this.item_scrollview.setData(t,null,{is_show_name:!0})},closeCallBack:function(){if(this.stopUpdate(),this.item_scrollview&&this.item_scrollview.DeleteMe(),this.item_scrollview=null,this.player_head&&this.player_head.deleteMe(),this.player_head=null,this.result_type&&1==this.result_type){var e=t("battle_event");gcore.GlobalEvent.fire(e.CLOSE_RESULT_VIEW)}this.controller.openDramHookRewardView(!1)}});cc._RF.pop()},{battle_drama_controller:"battle_drama_controller",battle_drama_hook_reward_list_panel:"battle_drama_hook_reward_list_panel",battle_event:"battle_event",pathtool:"pathtool",role_controller:"role_controller",timetool:"timetool"}],battle_drama_main_point_item:[function(t,e,i){"use strict";cc._RF.push(e,"6b04c15zmZNv4O9N6JUfO8m","battle_drama_main_point_item");var s=t("battle_drama_controller");cc.Class({extends:BaseClass,ctor:function(){this.ctrl=s.getInstance(),this.model=this.ctrl.getModel(),this.initConfig(),this.initUi()},initConfig:function(){this.is_big_point=!1},initUi:function(){this.size=cc.size(50,50),this.root_wnd=new cc.Node("point_item"),this.root_wnd.setAnchorPoint(.5,.5),this.root_wnd.setContentSize(this.size),this.button=this.root_wnd.addComponent(cc.Button),this.normal_img=this.root_wnd.addComponent(cc.Sprite),LoaderManager.getInstance().loadRes(PathTool.getUIIconPath("battle","battle_normal_point"),function(t){this.normal_img.spriteFrame=t}.bind(this)),this.setRootVisible(!1),this.registerEvent()},registerEvent:function(){Utils.onTouchEnd(this.root_wnd,function(){1==this.is_big_point&&this.data&&this.ctrl.openDramBossInfoView(!0,this.data)}.bind(this),1)},setData:function(t){t&&(this.data=t,this.is_big_point=t.info_data.is_big,this.dun_id=t.info_data.id,this.chapter_id=t.info_data.chapter_id,this.next_id=t.info_data.next_id,this.v_data=t.v_data,this.updateStatus(this.v_data.status,this.is_big_point))},setPosition:function(t,e){this.root_wnd&&this.root_wnd.setPosition(t,e)},updateStatus:function(t,e){this.setRootVisible(!1),this.normal_img&&(1==t||2==t||3==t?(this.setRootVisible(!0),3==t&&1==e?(LoaderManager.getInstance().loadRes(PathTool.getUIIconPath("battle","battle_drama_has_ack"),function(t){this.normal_img.spriteFrame=t}.bind(this)),this.button&&(this.button.transition=cc.Button.Transition.SCALE,this.button.duration=.1,this.button.zoomScale=.9)):(1==e&&LoaderManager.getInstance().loadRes(PathTool.getUIIconPath("battle","battle_drama_no_ack"),function(t){this.normal_img.spriteFrame=t}.bind(this)),this.button&&(this.button.transition=cc.Button.Transition.NONE))):1==e&&(LoaderManager.getInstance().loadRes(PathTool.getUIIconPath("battle","battle_drama_no_ack"),function(t){this.normal_img.spriteFrame=t}.bind(this)),this.button&&(this.button.transition=cc.Button.Transition.NONE)))},setRootVisible:function(t){this.root_wnd&&(this.root_wnd.active=t)},getPositionX:function(){return this.root_wnd?this.root_wnd.x:0},clearInfo:function(){this.root_wnd&&(this.root_wnd.stopAllActions(),this.root_wnd.removeFromParent())},DeleteMe:function(){this.root_wnd&&(this.root_wnd.stopAllActions(),this.root_wnd.removeFromParent(),this.root_wnd.removeAllChildren())}});cc._RF.pop()},{battle_drama_controller:"battle_drama_controller"}],battle_drama_map_window:[function(t,e,i){"use strict";cc._RF.push(e,"fe2c40l05tGiJkMi1UQh/Ql","battle_drama_map_window");var s=t("pathtool"),n=t("battle_drama_event"),a=t("battle_const"),o=t("mainui_controller"),l=t("battle_event"),r=t("battle_drama_main_point_item"),c=t("baserole"),_=t("role_controller");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("battledrama","battle_drama_map_windows"),this.viewTag=SCENE_TAG.ui,this.win_type=WinType.Big,this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){},openCallBack:function(){this.background=this.root_wnd.getChildByName("backgroundGroup"),this.graphics=this.background.getComponent(cc.Graphics),this.background.scale=FIT_SCALE;var t=this.root_wnd.getChildByName("main_container");this.main_container=t,this.map_layout=t.getChildByName("map_layout"),this.pos_label=t.getChildByName("pos_label").getComponent(cc.Label),this.close_btn=t.getChildByName("close_btn"),this.btn_world=t.getChildByName("btn_world");for(var e=Math.floor(SCREEN_WIDTH/50/2),i=Math.floor(SCREEN_HEIGHT/50/2),s=1;s<=i;s++){var n=cc.v2(-this.background.width/2,50*s*2-this.background.height/2),a=cc.v2(SCREEN_WIDTH-this.background.width/2,50*s*2-this.background.height/2);this.graphics.moveTo(n.x,n.y),this.graphics.lineTo(a.x,a.y)}for(s=1;s<=e;s++){n=cc.v2(50*s*2-this.background.width/2,-this.background.height/2),a=cc.v2(50*s*2-this.background.width/2,SCREEN_HEIGHT-this.background.height/2);this.graphics.moveTo(n.x,n.y),this.graphics.lineTo(a.x,a.y)}this.graphics.stroke()},registerEvent:function(){Utils.onTouchEnd(this.close_btn,function(){this._onClickCloseBtn()}.bind(this),2),Utils.onTouchEnd(this.btn_world,function(){this._onClickWorldBtn()}.bind(this),1),this.map_layout.on(cc.Node.EventType.TOUCH_START,function(t){return this.map_layout.stopAllActions(),!0},this),this.map_layout.on(cc.Node.EventType.TOUCH_MOVE,function(t){var e=t.getTouches();this.last_point=e[0].getDelta(),this.moveMapLayer(this.last_point.x,this.last_point.y)},this),this.map_layout.on(cc.Node.EventType.TOUCH_END,function(t){if(this.last_point){var e=this.map_layout.x+this.last_point.x+15;this.last_point.x<0&&(e=this.map_layout.x+this.last_point.x-15);var i=this.checkMapLayerPoint(e);this.map_layout.stopAllActions(),this.map_layout.runAction(cc.moveTo(.4,i))}},this),this.addGlobalEvent(n.BattleDrama_Update_Data,function(t){t.chapter_id!=this.chapter_id?this.root_wnd&&(this.drama_data=this.model.getDramaData(),this.chapter_id=this.drama_data.chapter_id,this.updateMapImage(),this.updateMapPoint(),this.updateBaseInfo()):this.root_wnd&&this.updateMapPointStatus()}.bind(this)),this.addGlobalEvent(l.MOVE_DRAMA_EVENT,function(t){t==a.Fight_Type.Darma&&this.drama_data&&o.getInstance().checkIsInDramaUIFight()&&(this.is_move_start=!0,this.moveMapTag(!0),this.ctrl.send13020())}.bind(this)),this.addGlobalEvent(n.UpdateDramaProgressDataEvent,function(t){var e=t/1e3+"%";this.progress_label.string=cc.js.formatStr(Utils.TI18N("\u5df2\u8d85\u8fc7<color=5df660>%s</color>\u7684\u73a9\u5bb6\u8fdb\u5ea6"),e)}.bind(this))},moveMapLayer:function(t,e){t=this.map_layout.x+t,e=this.map_layout.y+e;var i=this.checkMapLayerPoint(t,e);this.map_layout.setPosition(i.x,i.y)},checkMapLayerPoint:function(t,e){var i=this.map_layout.getContentSize();return t>0?t=0:t<SCREEN_WIDTH-i.width&&(t=SCREEN_WIDTH-i.width),cc.v2(t,0)},_onClickCloseBtn:function(){this.ctrl.openBattleDramaMapWindows(!1)},_onClickWorldBtn:function(){t("worldmap_controller").getInstance().openWorldMapMainWindow(!0)},openRootWnd:function(t){this.drama_data=this.model.getDramaData(),this.drama_data&&null!=Utils.next(this.drama_data)&&(this.chapter_id=t||this.drama_data.chapter_id,this.updateMapImage(),this.updateMapPoint(),this.updateBaseInfo(),this.ctrl.send13020())},updateBaseInfo:function(){if(this.drama_data){var t=gdata("dungeon_data","data_drama_dungeon_info",this.drama_data.dun_id);t&&(this.pos_label.string=cc.js.formatStr(Utils.TI18N("\u5f53\u524d\u5173\u5361:%s"),t.name))}},updateMapImage:function(){var t=Config.dungeon_data.data_drama_world_info[this.drama_data.mode];if(t&&t[this.chapter_id]){var e=t[this.chapter_id].map_id,i=s.getBattleSceneRes(cc.js.formatStr("%s/blayer/big_map",e),!1);this.map_bg||(this.map_bg=Utils.createImage(this.map_layout,null,0,130,cc.v2(0,0)),this.map_bg.type=cc.Sprite.Type.SIMPLE,this.map_bg.sizeMode=cc.Sprite.SizeMode.CUSTOM,this.map_bg.node.setContentSize(cc.size(1024,1024))),this.loadRes(i,function(t){this.map_bg.spriteFrame=t;var e=this.map_bg.node.getContentSize();this.map_layout.setContentSize(cc.size(e.width,1280))}.bind(this))}},updateMapPoint:function(){if(this.main_point_list&&null!=Utils.next(this.main_point_list||[]))for(var t in this.main_point_list)this.main_point_list[t]&&(this.main_point_list[t].clearInfo(),this.main_point_list[t].DeleteMe());this.main_point_list=[];var e=this.model.getInitDungeonList();if(e){var i=null,s=0;for(var t in e){var n=e[t];n.v_data=this.model.getCurDunInfoByID(n.info_data.id);var a=!1;n.v_data.status>0?a=!0:s<=0&&(s=1,a=!0),a&&Utils.delayRun(this.main_container,4*t/40,function(t){this.main_point_list[t.info_data.id]||(i=new r,this.main_point_list[t.info_data.id]=i,this.map_layout&&this.map_layout.addChild(i.root_wnd,98)),(i=this.main_point_list[t.info_data.id])&&(i.setPosition(t.info_data.pos[0],t.info_data.pos[1]+130),i.setData(t))}.bind(this,n))}}this.cur_tag_container||(this.cur_tag_container=new cc.Node,this.cur_tag_container.setContentSize(cc.size(50,50)),this.cur_tag_container.setAnchorPoint(cc.v2(.5,.5)),this.map_layout.addChild(this.cur_tag_container,99),this.createRole(PlayerAction.battle_stand)),this.updateMapPointStatus()},createRole:function(t){if(this.spine_model&&(this.spine_model.deleteMe(),this.spine_model=null),!this.spine_model){this.cur_action_name=t;var e="110401";e=_.getInstance().getRoleVo().look_id||e,this.spine_model=new c,this.spine_model.setParent(this.cur_tag_container),this.spine_model.setData(c.type.role,e,t,!0,.7),this.spine_model.node&&(this.spine_model.node.scaleX=.7*this.getDir(),this.spine_model.node.setPosition(this.cur_tag_container.getContentSize().width/2,-15));var i=this.spine_model.node.getBoundingBox().height||90;if(!this.cur_effect){var n=new cc.Node;n.setContentSize(cc.size(25,130)),n.setAnchorPoint(.5,.5),n.setPosition(25,i),this.cur_tag_container.addChild(n),this.cur_effect=n.addComponent(sp.Skeleton);var a=s.getSpinePath(Config.effect_data.data_effect_info[105],"action");this.loadRes(a,function(t){this.cur_effect.skeletonData=t,this.cur_effect.setAnimation(0,PlayerAction.action,!0)}.bind(this))}this.progress_bg||(this.progress_bg=Utils.createImage(this.cur_tag_container,null,this.cur_tag_container.getContentSize().width/2,-35,cc.v2(.5,.5)),this.progress_bg.node.scaleX=9.4,this.loadRes(s.getUIIconPath("battledrama","battledrama_1012"),function(t){this.progress_bg.spriteFrame=t}.bind(this))),this.progress_label||(this.progress_label=Utils.createRichLabel(16,new cc.Color(255,255,255,255),cc.v2(.5,.5),cc.v2(this.cur_tag_container.getContentSize().width/2,-35),30),this.cur_tag_container.addChild(this.progress_label.node),this.progress_label.string=Utils.TI18N("\u5df2\u8d85\u8fc7<color=5df660>?</color>\u7684\u73a9\u5bb6\u8fdb\u5ea6"))}},getDir:function(){var t=1,e=this.main_point_list[this.drama_data.dun_id];if(e){var i=this.main_point_list[this.drama_data.max_dun_id],s=e.getPositionX(),n=0;i&&(n=i.getPositionX()),t=s>n?1:-1}return t},updateMapPointStatus:function(){if(this.drama_data=this.model.getDramaData(),this.drama_data){var t=this.model.getCurDunInfoByID(this.drama_data.dun_id),e=gdata("dungeon_data","data_drama_dungeon_info",this.drama_data.dun_id);if(e){if(this.main_point_list&&this.main_point_list[this.drama_data.dun_id]){var i=this.main_point_list[this.drama_data.dun_id],s=e.is_big;i.updateStatus(t.status,s)}this.is_move_start||(this.moveMapTag(),this.is_move_start=!0)}}},moveMapTag:function(t){if(this.drama_data){var e=gdata("dungeon_data","data_drama_dungeon_info",this.drama_data.dun_id);if(e){var i=e.pos;i&&(t?this.cur_tag_container.runAction(cc.sequence(cc.delayTime(.1),cc.spawn(cc.callFunc(function(){this.createRole(PlayerAction.run)}.bind(this)),cc.moveTo(.5,cc.v2(i[0]-25,i[1]+140))),cc.callFunc(function(){this.createRole(PlayerAction.battle_stand)}.bind(this)))):this.cur_tag_container.setPosition(i[0]-25,i[1]+140))}}},closeCallBack:function(){if(this.main_point_list)for(var t in this.main_point_list)this.main_point_list[t]&&this.main_point_list[t].DeleteMe();this.spine_model&&(this.spine_model.deleteMe(),this.spine_model=null),this.cur_effect&&(this.cur_effect.setToSetupPose(),this.cur_effect.clearTracks(),this.cur_effect=null),this.ctrl.openBattleDramaMapWindows(!1)}});cc._RF.pop()},{baserole:"baserole",battle_const:"battle_const",battle_drama_event:"battle_drama_event",battle_drama_main_point_item:"battle_drama_main_point_item",battle_event:"battle_event",mainui_controller:"mainui_controller",pathtool:"pathtool",role_controller:"role_controller",worldmap_controller:"worldmap_controller"}],battle_drama_model:[function(t,e,i){"use strict";cc._RF.push(e,"836a5j+rGNDq4dZciAzepvK","battle_drama_model");var s=t("battle_drama_event"),n=t("mainui_controller"),a=t("mainui_const");cc.Class({extends:BaseClass,properties:{drama_data:{default:{}},last_dun_id:null,quick_battle_data:{default:{}},dic_drama_rewrad_ids:{default:{}},mode_list:{default:{}},cur_dun_list:{default:{}},init_dungeon_list:{default:{}},drama_res:{default:{}}},ctor:function(){},initConfig:function(){this.had_update_reward=!1,this.is_open_quick_battle_view=!1},preloadDramaScene:function(t){var e=10003,i=this.getDramaData();i&&i.mode&&i.chapter_id&&(e=Config.dungeon_data.data_drama_world_info[i.mode][i.chapter_id].map_id);var s=PathTool.getBattleDrameBg(e);LoaderManager.getInstance().loadRes(s.f,function(t,e){this.drama_res.f_res={},this.drama_res.f_res.path=t,this.drama_res.f_res.res=e}.bind(this,s.f)),LoaderManager.getInstance().loadRes(s.s,function(t,e){this.drama_res.s_res={},this.drama_res.s_res.path=t,this.drama_res.s_res.res=e}.bind(this,s.s))},getDramaScene:function(t,e,i){var s=PathTool.getBattleDrameBg(t);e?this.drama_res.f_res&&this.drama_res.f_res.path==s.f?i(this.drama_res.f_res.res):LoaderManager.getInstance().loadRes(s.f,function(t,e){this.drama_res.f_res&&LoaderManager.getInstance().releaseRes(this.drama_res.f_res.path),this.drama_res.f_res={},this.drama_res.f_res.path=t,this.drama_res.f_res.res=e,i&&i(e)}.bind(this,s.f)):this.drama_res.s_res&&this.drama_res.s_res.path==s.s?i(this.drama_res.s_res.res):LoaderManager.getInstance().loadRes(s.s,function(t,e){this.drama_res.s_res&&LoaderManager.getInstance().releaseRes(this.drama_res.s_res.path),this.drama_res.s_res={},this.drama_res.s_res.path=t,this.drama_res.s_res.res=e,i&&i(e)}.bind(this,s.s))},setDramaData:function(t){var e=!1;this.drama_data&&this.drama_data.max_dun_id===t.max_dun_id||(e=!0),(!this.last_dun_id||this.last_dun_id<t.max_dun_id)&&(this.last_dun_id=t.max_dun_id||this.drama_data.max_dun_id),this.drama_data.mode=t.mode,this.drama_data.chapter_id=t.chapter_id,this.drama_data.dun_id=t.dun_id,this.drama_data.status=t.status,this.drama_data.cool_time=t.cool_time,this.drama_data.max_dun_id=t.max_dun_id,this.drama_data.auto_num=t.auto_num,this.drama_data.auto_num_max=t.auto_num_max,this.drama_data.is_first=t.is_first,this.drama_data.last_dun_id=this.last_dun_id,t.mode_list&&(this.mode_list=t.mode_list),e&&gcore.GlobalEvent.fire(s.BattleDrama_Update_Max_Id,this.drama_data.max_dun_id),gcore.GlobalEvent.fire(s.BattleDrama_Top_Update_Data,t),this.initDungeonList(this.drama_data.mode,this.drama_data.chapter_id)},updateDramaData:function(t){if(this.drama_data){var e=!1;this.drama_data.max_dun_id!=t.max_dun_id&&(e=!0);var i=!1;this.drama_data.cool_time!=t.cool_time&&this.drama_data.status!=t.status&&(i=!0);var n=!1;this.drama_data.dun_id!=t.dun_id&&(n=!0),(null==this.drama_data.max_dun_id||this.drama_data.max_dun_id<t.max_dun_id)&&(this.last_dun_id=this.drama_data.max_dun_id||t.max_dun_id),this.drama_data.dun_id!=t.dun_id&&gcore.GlobalEvent.fire(s.BattleDrama_Update_Dun_Id,t.dun_id),this.drama_data.mode=t.mode,this.drama_data.chapter_id=t.chapter_id,this.drama_data.dun_id=t.dun_id,this.drama_data.status=t.status,this.drama_data.cool_time=t.cool_time,this.drama_data.max_dun_id=t.max_dun_id,this.drama_data.is_first=t.is_first,this.drama_data.last_dun_id=this.last_dun_id,this.updateModeListInfo(t),this.cur_dun_list&&null!=Utils.next(this.cur_dun_list||{})&&this.cur_dun_list[t.dun_id]&&(this.cur_dun_list[t.dun_id].status=t.status,3==this.cur_dun_list[t.dun_id].status&&(this.cur_dun_list[t.dun_id].is_has=!0),gcore.GlobalEvent.fire(s.BattleDrama_Update_Data,t)),e?gcore.GlobalEvent.fire(s.BattleDrama_Update_Max_Id,this.drama_data.max_dun_id):i&&gcore.GlobalEvent.fire(s.BattleDrama_Update_Cool_Time),n&&gcore.GlobalEvent.fire(s.BattleDrama_Update_Dun_Id)}},updateHookAccumulateTime:function(t){this.hook_accumulate_data=t,gcore.GlobalEvent.fire(s.UpdateHookAccumulateTime,t)},getHookAccumulateInfo:function(){return this.hook_accumulate_data},getDramaData:function(){return this.drama_data},setQuickData:function(t){this.quick_battle_data=t,this.checkRedPoint(),gcore.GlobalEvent.fire(s.BattleDrama_Quick_Battle_Data,t)},getQuickData:function(){return this.quick_battle_data},setDramaReward:function(t){if(this.checkRedPoint(),gcore.GlobalEvent.fire(s.BattleDrama_Drama_Reward_Data,t),1!=this.had_update_reward&&(this.had_update_reward=!0,t&&t.list&&0!=t.list.length)){this.dic_drama_rewrad_ids={};for(var e=0;e<t.list.length;e++){var i=t.list[e];this.dic_drama_rewrad_ids[i.id]=!0}}},getDramaRewardRedPointInfo:function(){var t=this.getDramaData();if(this.dic_drama_rewrad_ids&&t&&t.max_dun_id){var e=Config.dungeon_data.data_drama_reward;if(e)for(var i in e){var s=e[i];if(t.max_dun_id>=s.limit_id&&!this.dic_drama_rewrad_ids[s.id])return!0}}return!1},updateDramaReward:function(t){this.dic_drama_rewrad_ids[t]=!0,gcore.GlobalEvent.fire(s.BattleDrama_Drama_Reward_Data,t)},getDramaRewardPassList:function(){return this.dic_drama_rewrad_ids},getOpenSumChapter:function(t){if(this.mode_list){var e=this.mode_list[t-1].chapter_list,i=0;if(e)for(var s in e)i+=1;return i}},checkRedPoint:function(){var t=this.getDramaRewardRedPointInfo();n.getInstance().setBtnRedPoint(a.btn_index.drama_scene,t)},getBossShowData:function(){var t=[],e=this.getOpenSumChapter(this.drama_data.mode);if(Config.dungeon_data.data_drama_world_info){var i=Config.dungeon_data.data_drama_world_info[this.drama_data.mode],s=Config.dungeon_data.data_drama_boss_show_reward;for(var n in i){s[n]&&i[n].chapter_id<=e+1&&t.push(i[n])}}return t},getCurDunInfoByID:function(t){if(this.cur_dun_list)return this.cur_dun_list[t]},getInitDungeonList:function(){if(this.init_dungeon_list&&null!=Utils.next(this.init_dungeon_list||[]))return this.init_dungeon_list},initDungeonList:function(t,e){if(Config.dungeon_data.data_drama_info){var i=Config.dungeon_data.data_drama_info[t][e];if(i){var s=[];for(var n in i)s.push(i[n]);for(var n in s.sort(function(t,e){return t.id-e.id}),s){var a=gdata("dungeon_data","data_drama_dungeon_info",s[n].id);this.init_dungeon_list[n]={info_data:a},this.cur_dun_list[s[n].id]={dun_id:s[n].id,status:0,cool_time:0,auto_num:0,is_has:!1}}}this.updateHadModeListInfo(t,e)}},updateHadModeListInfo:function(t,e){if(this.mode_list&&null!=Utils.next(this.mode_list||{})){var i=this.getChapterListByID(t,e);if(i){var s=i.dun_list;if(s)for(var n in s){var a=this.cur_dun_list[s[n].dun_id];a&&(a.dun_id=s[n].dun_id,a.status=s[n].status,a.cool_time=s[n].cool_time,a.auto_num=s[n].auto_num,a.is_has=!0)}}}},updateModeListInfo:function(t){if(this.mode_list&&null!=Utils.next(this.mode_list||{})){var e=this.getChapterListByID(t.mode,t.chapter_id);if(e){var i=e.dun_list;if(i){var s=!0;1==t.status&&(s=!1);var n=!1;for(var a in i)t.dun_id==i[a].dun_id&&(n=!0,i[a].dun_id=t.dun_id,i[a].cool_time=t.cool_time,i[a].status=t.status,i[a].is_has=s);n||i.push({dun_id:t.dun_id,status:t.status,cool_time:t.cool_time,auto_num:0,is_has:s})}}}},getChapterListByID:function(t,e){if(this.mode_list&&null!=Utils.next(this.mode_list||{})){var i=this.mode_list[t-1].chapter_list,s=null;if(i){for(var n in i)if(i[n].chapter_id==e){s=i[n];break}return s}}},getHasCurChapterPassListBossNum:function(t,e){if(this.mode_list&&null!=Utils.next(this.mode_list||{})){var i=this.getChapterListByID(t,e),s=1;if(i){var n=i.dun_list;if(n)for(var a in n){var o=gdata("dungeon_data","data_drama_dungeon_info",[n[a].dun_id]);3==n[a].status&&o&&1==o.is_big&&(s+=1)}}return s}},getShowDescRewad:function(t){var e=[],i=1,s=Config.dungeon_data.data_drama_show_reward;if(s){for(var n in s){var a=s[n];t<a.id&&i<=3&&(i+=1,e.push(a))}e.sort(Utils.tableLowerSorter(["id"]))}return e},getHasPassChapterMaxDunId:function(t,e){if(this.mode_list&&Utils.next(this.mode_list||{})){var i=this.getChapterListByID(t,e),s=0;if(i){var n=i.dun_list;for(var a in n)n[a].dun_id>s&&(s=n[a].dun_id)}return s}},getCurMaxChapterId:function(t){if(this.mode_list&&null!=Utils.next(this.mode_list||{})){var e=this.mode_list[t-1].chapter_list,i=1;if(e)for(var s in e)1==e[s].status&&i<=e[s].chapter_id&&(i=e[s].chapter_id);return i}},getChapterLength:function(t,e){if(null==this.chapter_list&&(this.chapter_list={}),null==this.chapter_list[Utils.getNorKey(t,e)]){var i=0;if(null!=Config.dungeon_data.data_drama_info[t]){var s=Config.dungeon_data.data_drama_info[t][e];null!=s&&(i=Object.keys(s).length)}this.chapter_list[Utils.getNorKey(t,e)]=i}return this.chapter_list[Utils.getNorKey(t,e)]},getHasCurChapterPassListNum:function(t,e){if(this.mode_list&&null!=Utils.next(this.mode_list||{})){var i=this.getChapterListByID(t,e),s=0;if(i){var n=i.dun_list;for(var a in n)3==n[a].status&&(s+=1)}return s}},getPreStatus:function(t){if(Config.dungeon_data.data_drama_pre_fun){var e,i=JSON.parse(cc.sys.localStorage.getItem("drama_data"));for(var s in cc.log(Config.dungeon_data.data_drama_pre_fun,i),Config.dungeon_data.data_drama_pre_fun){var n=Config.dungeon_data.data_drama_pre_fun[s];if(n.limit_id==t&&!i[t]){!0,e=n;break}}return e}},setBuffData:function(t){this.buff_data=t,gcore.GlobalEvent.fire(s.BattleDrama_Drama_Buff_View)},getBuffData:function(){return this.buff_data},setOpenQuickBattleStatus:function(t){this.is_open_quick_battle_view=t},getOpenQuickBattleStatus:function(){return this.is_open_quick_battle_view},setFirstFresh:function(t){this.is_first_fresh=t},getFirstFresh:function(){return this.is_first_fresh||!1}});cc._RF.pop()},{battle_drama_event:"battle_drama_event",mainui_const:"mainui_const",mainui_controller:"mainui_controller"}],battle_drama_pass_vedio_item_panel:[function(t,e,i){"use strict";cc._RF.push(e,"9069aLUvYREhYvdhCvJniwf","battle_drama_pass_vedio_item_panel");var s=t("pathtool");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("battledrama","battle_drama_vedio_item")},initConfig:function(){this.controller=t("battle_controller").getInstance()},initPanel:function(){this.container=this.seekChild("container"),this.type_label=this.seekChild("type_label",cc.Label),this.name_label=this.seekChild("name_label",cc.Label),this.desc_label=this.seekChild("desc_label",cc.Label),this.empty_label=this.seekChild("empty_label"),this.check_btn=this.seekChild("check_btn"),this.check_btn_label=this.seekChild(this.check_btn,"Label",cc.Label),this.player_head=Utils.createClass("playerhead"),this.player_head.setParent(this.container),this.player_head.setPosition(-205,0),this.player_head.show()},registerEvent:function(){Utils.onTouchEnd(this.check_btn,function(){this.data&&this.data.repaly_id&&this.data.sid&&this.controller.sender_20036(this.data.repaly_id,this.data.sid)}.bind(this),1)},setData:function(t){this.data=t,this.root_wnd&&this.updateData()},updateData:function(){var e=this.data;if(e){var i="";1==e.type?(this.type_label.string=Utils.TI18N("\u6700\u5feb"),i=Utils.TI18N("\u901a\u5173\u65f6\u95f4:")):2==e.type?(this.type_label.string=Utils.TI18N("\u6700\u4f4e"),i=Utils.TI18N("\u6700\u4f4e\u6218\u529b:")):(this.type_label.string=Utils.TI18N("\u6700\u8fd1"),i=Utils.TI18N("\u901a\u5173\u65f6\u95f4:")),null==e.rid?(this.player_head.hide(),this.empty_label.active=!0,this.name_label.string="",this.desc_label.string="",this.check_btn.active=!1):(this.player_head.show(),this.player_head.setHeadRes(e.face_id),this.empty_label.active=!1,this.name_label.string=e.name,this.check_btn.active=!0,1==e.type||3==e.type?this.desc_label.string=i+t("timetool").getTimeFormat(this.data.time):this.desc_label.string=i+e.power)}},onShow:function(t){this.updateData()},onHide:function(){},onDelete:function(){this.player_head&&(this.player_head.deleteMe(),this.player_head=null)}});cc._RF.pop()},{battle_controller:"battle_controller",pathtool:"pathtool",timetool:"timetool"}],battle_drama_pass_vedio_window:[function(t,e,i){"use strict";cc._RF.push(e,"78bd5OXNgxOM58XdTcw4jR2","battle_drama_pass_vedio_window");var s=t("pathtool"),n=t("battle_drama_event"),a=t("battle_drama_pass_vedio_item_panel");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("battledrama","battle_drama_vedio_view"),this.viewTag=SCENE_TAG.dialogue},initConfig:function(){this.controller=t("battle_drama_controller").getInstance()},openCallBack:function(){this.background=this.seekChild("background"),this.background.scale=FIT_SCALE,this.close_btn=this.seekChild("close_btn"),this.list_panel=this.seekChild("item_container");var t=cc.size(this.list_panel.width,this.list_panel.height),e={item_class:a,start_x:0,space_x:0,start_y:0,space_y:5,item_width:600,item_height:136,row:1,col:1,once_num:1};this.item_scrollview=Utils.createClass("common_scrollview"),this.item_scrollview.createScroll(this.list_panel,cc.v2(0,-2),ScrollViewDir.vertical,ScrollViewStartPos.top,t,e,cc.v2(.5,.5))},registerEvent:function(){Utils.onTouchEnd(this.background,function(){this.controller.openDramaPassVedioWindow(!1)}.bind(this),2),Utils.onTouchEnd(this.close_btn,function(){this.controller.openDramaPassVedioWindow(!1)}.bind(this),2),this.addGlobalEvent(n.UpdatePassVedioDataEvent,function(t){this.setData(t)}.bind(this))},openRootWnd:function(t){var e=this.controller.getModel().getDramaData();e&&this.controller.send13015(e.dun_id)},setData:function(t){for(var e=function(e){if(t)for(var i=0;i<t.length;i++){var s=t[i];if(s&&s.type==e)return s}return null}.bind(this),i=[],s=0;s<3;s++){var n=e(s+1);n||((n={}).type=s+1),i.push(n)}this.item_scrollview.setData(i)},closeCallBack:function(){this.item_scrollview&&(this.item_scrollview.deleteMe(),this.item_scrollview=null),this.controller.openDramaPassVedioWindow(!1)}});cc._RF.pop()},{battle_drama_controller:"battle_drama_controller",battle_drama_event:"battle_drama_event",battle_drama_pass_vedio_item_panel:"battle_drama_pass_vedio_item_panel",pathtool:"pathtool"}],battle_drama_quick_window:[function(t,e,i){"use strict";cc._RF.push(e,"35ed1HluztInpFApZT8H++S","battle_drama_quick_window");var s=t("pathtool"),n=t("battle_drama_hook_reward_list_panel"),a=t("battle_drama_event"),o=t("battle_event"),l=t("role_controller");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("battledrama","battle_drama_quick_battle_windows"),this.viewTag=SCENE_TAG.dialogue},initConfig:function(){this.controller=t("battle_drama_controller").getInstance(),this.drama_model=this.controller.getModel(),this.quick_battle_status=0,this.privilege_status=t("role_controller").getInstance().getModel().checkPrivilegeStatus(1)},openCallBack:function(){this.background=this.seekChild("background"),this.list_view=this.seekChild("list_view"),this.close_btn=this.seekChild("close_btn"),this.desc=this.seekChild("desc",cc.RichText),this.explain_btn=this.seekChild("explain_btn"),this.background.scale=FIT_SCALE,this.source_btn=this.seekChild("source_btn"),this.source_label=this.seekChild(this.source_btn,"label",cc.Label),this.source_icon=this.seekChild(this.source_btn,"icon"),this.source_icon_frame=this.source_icon.getComponent(cc.Sprite),this.notice_label=this.seekChild("notice_label",cc.RichText),this.btn_buy_quick=this.seekChild("btn_buy_quick"),this.btn_buy_quick.active=!1;var t=cc.size(this.list_view.width,this.list_view.height),e={item_class:n,start_x:22,space_x:30,start_y:10,space_y:10,item_width:120,item_height:120,row:1,col:4,need_dynamic:!0};this.item_scrollview=Utils.createClass("common_scrollview"),this.item_scrollview.createScroll(this.list_view,null,null,null,t,e)},registerEvent:function(){Utils.onTouchEnd(this.background,function(){this.controller.openDramBattleQuickView(!1)}.bind(this),2),Utils.onTouchEnd(this.close_btn,function(){this.controller.openDramBattleQuickView(!1)}.bind(this),2),Utils.onTouchEnd(this.btn_buy_quick,function(){t("vip_controller").getInstance().openVipMainWindow(!0,VIPTABCONST.PRIVILEGE),this.controller.openDramBattleQuickView(!1)}.bind(this),2),this.explain_btn.on(cc.Node.EventType.TOUCH_END,function(e){Utils.playButtonSound(1);var i=e.touch.getLocation(),s=StringUtil.parse(Config.dungeon_data.data_drama_const.game_rule.desc);t("tips_controller").getInstance().showCommonTips(s,i)}),Utils.onTouchEnd(this.source_btn,function(){if(0==this.quick_battle_status||1==this.quick_battle_status)this.send13004();else if(2==this.quick_battle_status&&0!=this.quick_battle_cost){if(this.drama_model.getFirstFresh()&&0==this.privilege_status){this.controller.send13039();var e=t("commonalert"),i=Utils.TI18N("\u8d2d\u4e70\u5feb\u901f\u4f5c\u6218\u7279\u6743\u53ef\u589e\u52a0\u6bcf\u65e5\u5feb\u901f\u4f5c\u6218\u6b21\u6570\uff08\u5305\u542b2\u6b21\u514d\u8d39\u6b21\u6570\uff09\uff0c\u662f\u5426\u524d\u5f80\u8d2d\u4e70\uff1f"),n=function(){t("vip_controller").getInstance().openVipMainWindow(!0,VIPTABCONST.PRIVILEGE),this.controller.openDramBattleQuickView(!1)}.bind(this),a=function(){var e=t("commonalert"),i=cc.js.formatStr("\u672c\u6b21\u5feb\u901f\u4f5c\u6218\u82b1\u8d39<img src='%s' scale=0.3 />x%s",Config.item_data.data_assets_label2id.gold,this.quick_battle_cost),n=s.getItemRes(Config.item_data.data_assets_label2id.gold),a=function(){this.send13004()}.bind(this);e.show(i,Utils.TI18N("\u786e\u8ba4"),a,Utils.TI18N("\u53d6\u6d88"),null,2,null,{resArr:[n]})}.bind(this);return void e.show(i,Utils.TI18N("\u786e\u8ba4"),n,Utils.TI18N("\u53d6\u6d88"),a,2,null)}e=t("commonalert"),i=cc.js.formatStr("\u672c\u6b21\u5feb\u901f\u4f5c\u6218\u82b1\u8d39<img src='%s' scale=0.3 />x%s",Config.item_data.data_assets_label2id.gold,this.quick_battle_cost);var o=s.getItemRes(Config.item_data.data_assets_label2id.gold);n=function(){this.send13004()}.bind(this);e.show(i,Utils.TI18N("\u786e\u8ba4"),n,Utils.TI18N("\u53d6\u6d88"),null,2,null,{resArr:[o]})}else if(3==this.quick_battle_status)if(1==this.privilege_status)this.send13004();else{e=t("commonalert"),i=Utils.TI18N("\u8d2d\u4e70\u5feb\u901f\u4f5c\u6218\u7279\u6743\u53ef\u589e\u52a0\u6bcf\u65e5\u5feb\u901f\u4f5c\u6218\u6b21\u6570\uff08\u5305\u542b2\u6b21\u514d\u8d39\u6b21\u6570\uff09\uff0c\u662f\u5426\u524d\u5f80\u8d2d\u4e70\uff1f"),n=function(){t("vip_controller").getInstance().openVipMainWindow(!0,VIPTABCONST.PRIVILEGE),this.controller.openDramBattleQuickView(!1)}.bind(this);e.show(i,Utils.TI18N("\u786e\u8ba4"),n,Utils.TI18N("\u53d6\u6d88"),null,2,null)}else this.send13004()}.bind(this),1),this.addGlobalEvent(a.BattleDrama_Quick_Battle_Data,function(t){this.updateData()}.bind(this))},openRootWnd:function(t){this.updateData(),this.updateShowItems(),this.updateShowDesc()},send13004:function(){var e=l.getInstance().getRoleVo();if(e){var i=e.energy,s=e.energy_max,n=0,a=this.drama_model.hook_max_time||120,o=this.drama_model.getDramaData()||{},r=gdata("dungeon_data","data_drama_dungeon_info",[o.dun_id]);if(r&&r.per_hook_items)for(var c in r.per_hook_items){var _=r.per_hook_items[c];_[0]==Config.item_data.data_assets_label2id.energy&&(n=_[1]*a*1)}if(i+n>s){var h=function(){this.controller.send13004()}.bind(this),d=cc.js.formatStr("\u6ce8\u610f:\u5f53\u524d\u62e5\u6709<color=#249003>%s/%s</c>\u8fdc\u822a\u60c5\u62a5,\u5feb\u901f\u4f5c\u6218\u540e,\u8fdc\u822a\u60c5\u62a5\u6ea2\u51fa\u90e8\u5206\u5c06\u4f1a\u635f\u5931,\u662f\u5426\u7ee7\u7eed\uff1f",i,s);t("commonalert").show(d,Utils.TI18N("\u786e\u8ba4"),h,Utils.TI18N("\u53d6\u6d88"),null,2,null)}else this.controller.send13004()}},updateData:function(){var t=this.drama_model.getQuickData();if(t)if(this.quick_battle_status=0,this.quick_battle_cost=0,this.source_label.node.x=0,t.fast_combat_free_num>0)this.source_label.string=Utils.TI18N("\u5feb\u901f\u4f5c\u6218"),this.source_icon.active=!1,this.notice_label.string=Utils.TI18N("\u672c\u6b21\u514d\u8d39");else{var e=t.fast_combat_max-t.fast_combat_num,i=Config.privilege_data.data_fast_combat_cost_length-t.fast_combat_p_num;i>0&&this.privilege_status?this.notice_label.string=cc.js.formatStr("%s<color=#249003>%s+%s</color>%s",Utils.TI18N("\u4eca\u65e5\u5269\u4f59:"),e,i,Utils.TI18N("\u6b21")):this.notice_label.string=cc.js.formatStr("%s<color=#249003>%s</color>%s",Utils.TI18N("\u4eca\u65e5\u5269\u4f59:"),e,Utils.TI18N("\u6b21"));var n=Config.dungeon_data.data_drama_quick_cost[t.fast_combat_num+1],a=0;if(n)a=n.cost,this.quick_battle_status=2;else if(this.privilege_status){var o=Config.privilege_data.data_fast_combat_cost[t.fast_combat_p_num+1];o&&(a=o.cost,this.quick_battle_status=2),this.notice_label.string=cc.js.formatStr("%s<color=#249003>%s+%s</color>%s",Utils.TI18N("\u4eca\u65e5\u5269\u4f59:"),e,i,Utils.TI18N("\u6b21"))}if(this.quick_battle_cost=a,0==a)this.quick_battle_status=3,this.source_icon.active=!1,this.privilege_status?this.source_label.string=Utils.TI18N("\u5feb\u901f\u4f5c\u6218"):this.source_label.string=Utils.TI18N("\u63d0\u5347\u514d\u8d39\u6b21\u6570");else{if(this.source_icon.active=!0,!this.source_icon_status){this.source_icon_status=!0;var l=s.getItemRes(3);this.loadRes(l,function(t,e){t.spriteFrame=e}.bind(this,this.source_icon_frame))}this.source_label.node.x=16,this.source_label.string=a+Utils.TI18N("\u5feb\u901f\u6218\u6597")}}},updateShowDesc:function(){var t=Utils.TI18N("\u5feb\u901f\u4f5c\u6218\u53ef\u83b7\u5f97<color=#249003>120</color>\u5206\u949f\u6302\u673a\u6536\u76ca\u3002\n\u6fc0\u6d3b\u5feb\u901f\u4f5c\u6218\u7279\u6743:\u6bcf\u5929\u514d\u8d39<color=#249003>3</color>\u6b21\uff0c\u989d\u5916\u8d2d\u4e70<color=#249003>11</color>\u6b21");1==this.privilege_status?(t+=Utils.TI18N("<color=#249003>(\u7279\u6743\u5df2\u6fc0\u6d3b)</color>"),this.btn_buy_quick.active=!1):(t+=Utils.TI18N("<color=#c92606>(\u7279\u6743\u672a\u6fc0\u6d3b)</color>"),this.btn_buy_quick.active=!0),this.desc.string=t},updateShowItems:function(){var t=this.drama_model.getDramaData();if(t){var e=Config.dungeon_data.data_drama_dungeon_info[t.max_dun_id];if(e){for(var i=[],s=0;s<e.quick_show_items.length;s++){var n=e.quick_show_items[s];i.push({bid:n[0],num:n[1]})}this.item_scrollview.setData(i)}}},closeCallBack:function(){this.item_scrollview&&this.item_scrollview.DeleteMe(),this.item_scrollview=null,this.controller.openDramBattleQuickView(!1),gcore.GlobalEvent.fire(o.CLOSE_RESULT_VIEW)}});cc._RF.pop()},{battle_drama_controller:"battle_drama_controller",battle_drama_event:"battle_drama_event",battle_drama_hook_reward_list_panel:"battle_drama_hook_reward_list_panel",battle_event:"battle_event",commonalert:"commonalert",pathtool:"pathtool",role_controller:"role_controller",tips_controller:"tips_controller",vip_controller:"vip_controller"}],battle_drama_reward_item_panel:[function(t,e,i){"use strict";cc._RF.push(e,"9bc9fCAHndJDINv3P+GaRXJ","battle_drama_reward_item_panel");var s=t("pathtool");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("battledrama","battle_drama_reward_item"),this.controller=t("battle_drama_controller").getInstance()},initConfig:function(){this.drop_item_list={}},initPanel:function(){this.comfirm_btn=this.seekChild("comfirm_btn"),this.goto_btn=this.seekChild("goto_btn"),this.img_received=this.seekChild("img_received"),this.name_label=this.seekChild("name_label",cc.Label),this.container=this.seekChild("content")},registerEvent:function(){Utils.onTouchEnd(this.comfirm_btn,function(){this.data&&this.controller.send13009(this.data.id)}.bind(this),1),Utils.onTouchEnd(this.goto_btn,function(){this.controller.openDramaRewardWindow(!1)}.bind(this),1)},onShow:function(t){this.updateData()},setData:function(t){this.data=t,this.root_wnd&&this.updateData()},updateData:function(){var t=this.data;if(t){var e=t.config_data,i=cc.js.formatStr(Utils.TI18N("\u901a\u5173%s\u5173(%s\u5173/%s\u5173)"),t.target_dun,t.cur_dun,t.target_dun);1==this.data.id&&(this.comfirm_btn.ui_tag=e.limit_id),this.comfirm_btn.name="comfirm_btn_"+(this.tmp_index+1),this.name_label.string=i,3==t.sort_index?(this.goto_btn.active=!1,this.comfirm_btn.active=!1,this.img_received.active=!0):2==t.sort_index?(this.goto_btn.active=!0,this.comfirm_btn.active=!1,this.img_received.active=!1):(this.goto_btn.active=!1,this.comfirm_btn.active=!0,this.img_received.active=!1),this.updateDramaDropInfo(e.items)}},onHide:function(){},updateDramaDropInfo:function(t){if(null!=this.container&&null!=t){for(var e in this.drop_item_list){(s=this.drop_item_list[e])&&s.setVisible(!1)}for(var i=0;i<t.length;i++){var s,n=t[i];(s=this.createDramaDropItem(i,.75,10,50))&&(s.setData({bid:n[0],num:n[1]}),s.setVisible(!0))}}},createDramaDropItem:function(t,e,i,s){var n=this.drop_item_list[t];if(null==n){var a=s+t*(120*e+i);(n=ItemsPool.getInstance().getItem("backpack_item")).setParent(this.container),n.initConfig(null,e,!1,!0),n.setPosition(a,0),n.show(),this.drop_item_list[t]=n}return n},onDelete:function(){if(this.drop_item_list){for(var t in this.drop_item_list){var e=this.drop_item_list[t];e&&e.deleteMe()}this.drop_item_list=null}}});cc._RF.pop()},{battle_drama_controller:"battle_drama_controller",pathtool:"pathtool"}],battle_drama_reward_window:[function(t,e,i){"use strict";cc._RF.push(e,"ad3b3JljUlIHYDK7PfwUk38","battle_drama_reward_window");var s=t("pathtool"),n=t("battle_drama_reward_item_panel"),a=t("common_scrollview"),o=t("battle_drama_event");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("battledrama","battle_drama_reward_window"),this.viewTag=SCENE_TAG.dialogue},initConfig:function(){this.controller=t("battle_drama_controller").getInstance(),this.model=this.controller.getModel(),this.config_list={}},openCallBack:function(){this.root_wnd.name="battle_drama_reward_window",this.background=this.seekChild("background"),this.close_btn=this.seekChild("close_btn"),this.win_title=this.seekChild("win_title",cc.Label),this.win_title.string=Utils.TI18N("\u901a\u5173\u5956\u52b1"),this.list_panel=this.seekChild("list_panel"),this.background.scale=FIT_SCALE;var t=this.seekChild("panel_bg",cc.Sprite);this.loadRes(s.getBigBg("bigbg_61"),function(e){t.spriteFrame=e}.bind(this)),this.panel_bg=this.seekChild("panel_bg",cc.Sprite),this.loadRes(s.getBigBg("bigbg_61"),function(t){this.panel_bg.spriteFrame=t}.bind(this));var e=cc.size(this.list_panel.width,this.list_panel.height),i={item_class:n,start_x:4,space_x:0,start_y:0,space_y:4,item_width:600,item_height:168,row:1,col:1,once_num:1,need_dynamic:!0};this.item_scrollview=new a,this.item_scrollview.createScroll(this.list_panel,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,e,i,cc.v2(.5,.5))},registerEvent:function(){Utils.onTouchEnd(this.background,function(){this.controller.openDramaRewardWindow(!1)}.bind(this),2),Utils.onTouchEnd(this.close_btn,function(){this.controller.openDramaRewardWindow(!1)}.bind(this),2),this.addGlobalEvent(o.BattleDrama_Drama_Reward_Data,function(t){this.updateShowInfoList(t)}.bind(this))},openRootWnd:function(t){this.updateShowInfoList()},initConfigRewardList:function(){if(!this.rewards_list){this.rewards_list=[];var t=0,e=this.model.getDramaRewardPassList(),i=this.model.getDramaData();if(i){var s=i.max_dun_id,n=Config.dungeon_data.data_drama_dungeon_info[s];for(var a in n&&(t=n.floor||0),Config.dungeon_data.data_drama_reward){var o=Config.dungeon_data.data_drama_reward[a];if(o){var l=Config.dungeon_data.data_drama_dungeon_info[o.limit_id];if(l){var r={config_data:o,id:o.id,is_received:e[o.id]||!1,cur_dun:t,sort_index:0,target_dun:l.floor};this.rewards_list.push(r),s>=o.limit_id?1==r.is_received?r.sort_index=3:r.sort_index=1:r.sort_index=2,this.config_list[o.id]=r}}}}}},updateShowInfoList:function(t){if(null==t)this.initConfigRewardList();else{var e=this.config_list[t];e&&(e.is_received=!0,e.sort_index=3)}this.rewards_list&&(this.rewards_list.sort(Utils.tableLowerSorter(["sort_index","id"])),this.item_scrollview.setData(this.rewards_list))},closeCallBack:function(){this.item_scrollview&&(this.item_scrollview.deleteMe(),this.item_scrollview=null),this.rewards_list=null,this.config_list=null;var e=t("guide_event");gcore.GlobalEvent.fire(e.CloseTaskEffect),this.controller.openDramaRewardWindow(!1)}});cc._RF.pop()},{battle_drama_controller:"battle_drama_controller",battle_drama_event:"battle_drama_event",battle_drama_reward_item_panel:"battle_drama_reward_item_panel",common_scrollview:"common_scrollview",guide_event:"guide_event",pathtool:"pathtool"}],battle_drama_unlock_chapter_window:[function(t,e,i){"use strict";cc._RF.push(e,"8367e5LJP1FIrRtWlwgZWWe","battle_drama_unlock_chapter_window");var s=t("pathtool"),n=t("battle_drama_controller"),a=t("battle_drama_event");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("battledrama","battle_drama_unlock_view"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Mini,this.ctrl=n.getInstance()},initConfig:function(){this.is_can_close=!1},openCallBack:function(){this.background=this.root_wnd.getChildByName("background"),this.background.scale=FIT_SCALE,this.main_panel=this.root_wnd.getChildByName("main_container"),this.title_panel=this.main_panel.getChildByName("title_panel"),this.title_sp=this.title_panel.getChildByName("title_sp"),this.icon=this.main_panel.getChildByName("icon"),this.time_label=this.seekChild(this.main_panel,"time_label",cc.Label),this.time_label.string=Utils.TI18N("8\u79d2\u540e\u5173\u95ed"),this.star_name=this.seekChild(this.main_panel,"star_name",cc.Label),this.play_effect_sk=this.seekChild(this.main_panel,"play_effect",sp.Skeleton),this.handleEffect()},registerEvent:function(){this.background.on("touchend",function(){1==this.is_can_close&&(this.ctrl.openBattleDramaUnlockChapterView(!1),Utils.playButtonSound(2))},this)},openRootWnd:function(t){this.updateDesc(t)},updateDesc:function(t){var e=this;e.config=t,t&&(this.loadRes(s.getUIIconPath("bigbg/battledrama","txt_cn_battledrama_unlock_title"),function(t){e.title_sp.getComponent(cc.Sprite).spriteFrame=t}.bind(this)),this.loadRes(s.getUIIconPath("bigbg/battledrama","battledrama_unlock_icon"),function(t){e.icon.getComponent(cc.Sprite).spriteFrame=t}.bind(this)),e.star_name.string=t.name),this.root_wnd.runAction(cc.sequence(cc.delayTime(1),cc.callFunc(function(){e.is_can_close=!0},this))),this.updateTimer()},updateTimer:function(){var t=8;null==this.time_tichet&&(this.time_tichet=gcore.Timer.set(function(){t--,this.time_label.string=t+"\u79d2\u540e\u5173\u95ed",t<=0&&(gcore.Timer.del(this.time_tichet),this.time_tichet=null,this.ctrl.openBattleDramaUnlockChapterView(!1))}.bind(this),1e3,-1))},handleEffect:function(){if(this.play_effect_sk){var t=s.getSpinePath("E51003","action");this.loadRes(t,function(t){this.play_effect_sk.skeletonData=t,this.play_effect_sk.setAnimation(0,"action",!0)}.bind(this))}},closeCallBack:function(){gcore.GlobalEvent.fire(a.BattleDrama_Drama_Unlock_View,this.config),this.play_effect_sk.skeletonData=null,this.time_tichet&&(gcore.Timer.del(this.time_tichet),this.time_tichet=null),this.ctrl.openBattleDramaUnlockChapterView(!1)}});cc._RF.pop()},{battle_drama_controller:"battle_drama_controller",battle_drama_event:"battle_drama_event",pathtool:"pathtool"}],battle_drama_unlock_window:[function(t,e,i){"use strict";cc._RF.push(e,"c86e730BeZBOr3Mnbw4h8/g","battle_drama_unlock_window");var s=t("pathtool"),n=t("battle_drama_controller");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("battledrama","battleunlock"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Mini,this.ctrl=n.getInstance()},initConfig:function(){},openCallBack:function(){this.background=this.root_wnd.getChildByName("background"),this.main_panel=this.root_wnd.getChildByName("main_container"),this.ok_btn=this.main_panel.getChildByName("ok_btn"),this.ok_btn.getChildByName("Label").getComponent(cc.Label).string="\u77e5\u9053\u4e86",this.time_label=this.main_panel.getChildByName("tip"),this.head_icon=this.main_panel.getChildByName("head_icon"),this.star_name=this.main_panel.getChildByName("star_name"),this.star_desc=this.main_panel.getChildByName("star_desc"),this.play_effect=this.title_container.getChildByName("action").getComponent(sp.Skeleton),this.handleEffect(!0)},registerEvent:function(){this.ok_btn.on("click",function(){Utils.playButtonSound(2),1==this.is_can_close&&this.ctrl.openBattleDramaUnlockWindow(!1)},this)},openRootWnd:function(t){this.updateDesc(t)},handleEffect:function(){if(this.play_effect){var t=s.getSpinePath(s.getEffectRes(145),"action");this.loadRes(t,function(t){this.play_effect.skeletonData=t,this.play_effect.setAnimation(0,"action",!0)}.bind(this))}},updateDesc:function(t){var e=this;if(t){var i=s.getUIIconPath("bigbg/battledrama",t.unlock_icon);e.res_id_2!=i&&(e.res_id_2=i,this.loadRes(e.res_id_2,function(t){e.head_icon.getComponent(cc.Sprite).spriteFrame=t}.bind(this))),e.star_name.getComponent(cc.Label).string=t.unlock_name,e.star_desc.getComponent(cc.Label).string=t.unlock_desc}e.is_can_close=!0,e.updateTimer()},updateTimer:function(){var t=10,e=this;null==e.time_ticket&&(e.time_ticket=gcore.Timer.set(function(){t-=1;var i=Map.ceil(t),s=i+"\u79d2\u540e\u5173\u95ed";e.time_label&&(e.time_label.getComponent(cc.Label).string=s),i<=0&&(gcore.Timer.del(e.time_ticket),e.time_ticket=null)}.bind(this),1e3,-1))},closeCallBack:function(){this.play_effect&&(this.play_effect.skeletonData=null),this.time_ticket&&(gcore.Timer.del(this.time_ticket),this.time_ticket=null)}});cc._RF.pop()},{battle_drama_controller:"battle_drama_controller",pathtool:"pathtool"}],battle_effect:[function(t,e,i){"use strict";cc._RF.push(e,"d438f2lEQNFq5Fa074aWZ5t","battle_effect");var s=t("battle_role_pool"),n=(t("loadermanager"),t("pathtool")),a=t("battle_res_pool");cc.Class({extends:BaseClass,properties:{skelon_cache:{default:{}}},ctor:function(){this.initConfig()},initConfig:function(){this.effect=null,this.skelon_cache={},this.effect_active=!0,this.action_call_list={},this.model=t("battle_controller").getInstance().getModel()},createEffect:function(t,e,i,n){this.parent=t,this.scene_pos=e,this.reverse=i||1,this.res_id=n;var a=s.getInstance().getEffectPools(),o=null;a.size()>0?((o=a.get()).active=!0,this.createEffectWnd(o)):this.createEffectWnd()},createEffectWnd:function(t){if(null==t&&((t=new cc.Node).setAnchorPoint(.5,.5),t.addComponent(sp.Skeleton)),this.effect=t,this.effect.scaleX=this.reverse,this.effect.angle=0,this.parent&&this.parent.addChild(this.effect),this.skeleton=this.effect.getComponent(sp.Skeleton),this.effect.setPosition(this.scene_pos.x,this.scene_pos.y),this.skeleton_time_scale)this.skeleton.timeScale=this.skeleton_time_scale,this.skeleton_time_scale=null;else{var e=this.model.getTimeScale();this.skeleton.timeScale=e}this.resetInitStatus(),this.registerEvent()},resetScenePos:function(t){this.scene_pos=t,this.effect&&this.effect.setPosition(this.scene_pos.x,this.scene_pos.y)},resetReverse:function(t){this.reverse=t,this.effect&&(this.effect.scaleX=this.reverse)},registerEvent:function(){this.skeleton.setCompleteListener(function(t,e){var i=t.animation?t.animation.name:"";this.over_func&&(this.over_func(i),this.over_func=null,this.event_func=null,this.play_action_name="")}.bind(this)),this.skeleton.setEventListener(function(t,e){this.event_func&&this.event_func(e.data.name)}.bind(this))},setAnimationActionFunc:function(t,e){this.event_func=t,this.over_func=e},playActionOnce:function(t,e,i){e=e||"action",null==i&&(i=!0),this.effect_play_key=Utils.getNorKey(this.res_id,t);var s=Utils.getNorKey(this.res_id,e);if(this.play_action_res!=s){this.play_action_res=s;var o=n.getSpinePath(this.res_id,e);this.skelon_cache[o]?(this.play_action_name=t,this.skeleton.skeletonData=this.skelon_cache[o],this.skeleton.setAnimation(0,t,i)):a.getInstance().getRes(o,function(e){this.play_action_name=t,this.skeleton.skeletonData=e,this.skeleton.setAnimation(0,t,i),this.skelon_cache[o]||(this.skelon_cache[o]=e)}.bind(this))}else this.play_action_name!=t&&(this.play_action_name=t,this.skeleton.setAnimation(0,t,i))},getEffectKey:function(){return this.effect_play_key||""},setLocalZOrder:function(t){this.effect&&(this.effect.zIndex=t)},runAction:function(t){this.effect&&(this.effect.stopAllActions(),this.effect.runAction(t))},setActiveEffect:function(t){this.effect_active!=t&&(this.effect_active=t,this.effect&&(this.effect.active=t))},resetInitStatus:function(){this.skeleton&&(this.skeleton.setToSetupPose(),this.skeleton.clearTracks())},setRotation:function(t){this.effect&&(this.effect.angle=-t)},setTimeScale:function(t){if(null==this.skeleton||null==this.skeleton.skeletonData)this.skeleton_time_scale=t;else{if(this.skeleton_timeScale==t)return;this.skeleton_timeScale=t,this.skeleton.timeScale=t}},deleEffect:function(){for(var t in this.effect.stopAllActions(),this.skeleton.skeletonData=null,this.skelon_cache)a.getInstance().delRes(t);this.skelon_cache={},s.getInstance().pushBackEffect(this.effect)}});cc._RF.pop()},{battle_controller:"battle_controller",battle_res_pool:"battle_res_pool",battle_role_pool:"battle_role_pool",loadermanager:"loadermanager",pathtool:"pathtool"}],battle_event:[function(t,e,i){"use strict";cc._RF.push(e,"b1ee5Y0GaRL9ZuOmty+rohI","battle_event"),e.exports={COMBAT_TYPE_BACK:"COMBAT_TYPE_BACK",MOVE_DRAMA_EVENT:"MOVE_DRAMA_EVENT",CLOSE_RESULT_VIEW:"CLOSE_RESULT_VIEW",UPDATE_ROUND_NUM:"UPDATE_ROUND_NUM",EXIT_FIGHT:"SceneEvent.EXIT_FIGHT"},cc._RF.pop()},{}],battle_fail_window:[function(t,e,i){"use strict";cc._RF.push(e,"0cf8dcyU05AfbuGwMPgWoCW","battle_fail_window");var s=t("pathtool"),n=t("role_controller"),a=t("battle_controller"),o=t("battle_drama_controller"),l=t("battle_const"),r=t("battle_event");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("battle","battle_fail_view"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Mini,this.is_full_screen=!1,this.fight_type=arguments[0],this.result=arguments[1],this.data=arguments[2]},initConfig:function(){this.role_vo=n.getInstance().getRoleVo(),this.ctrl=a.getInstance(),this.model=this.ctrl.getModel(),this.drama_ctrl=o.getInstance(),this.jump_ctrl=t("jump_controller").getInstance(),this.is_running=!1,this.effect_list={},this.x=100},openCallBack:function(){this.source_container=this.seekChild("container"),this.title_container=this.seekChild("title_container"),this.title_width=this.title_container.getContentSize().width,this.title_height=this.title_container.getContentSize().height,this.btn=this.seekChild(this.source_container,"btn"),this.special_sk=this.seekChild("title_container",sp.Skeleton),this.background=this.root_wnd.getChildByName("background"),this.background.scale=FIT_SCALE;var t=function(){this.createButton(),this.is_running=!1}.bind(this);this.source_container.runAction(cc.sequence(cc.fadeIn(0,2),cc.callFunc(t))),this.comfirm_btn=this.seekChild("comfirm_btn"),this.help_btn=this.seekChild("help_btn"),this.time_label_rt=this.seekChild("time_label",cc.RichText),this.harm_btn=this.seekChild("harm_btn"),this.data&&this.data.hurt_statistics?this.harm_btn.active=!0:this.harm_btn.active=!1,this.handleEffect(!0)},registerEvent:function(){Utils.onTouchEnd(this.comfirm_btn,function(){this.ctrl.openFailFinishView(!1,this.fight_type)}.bind(this),1),Utils.onTouchEnd(this.harm_btn,function(){this.data&&null!=Utils.next(this.data)&&this.ctrl.openBattleHarmInfoView(!0,this.data)}.bind(this),1),Utils.onTouchEnd(this.help_btn,function(){this.ctrl.openFailFinishView(!1,this.fight_type),this.jump_ctrl.jumpViewByEvtData([16])}.bind(this),1)},createButton:function(){var t=[],e=this.drama_ctrl.getModel().getDramaData();if((r=Config.battle_act_data.data_get_fail_data)&&e){var i=e.max_dun_id;for(var n in r){var a=r[n];a.open_dungeon<=i&&t.push(a)}}null==this.items_list&&(this.items_list={}),this.clearItems();var o=Math.min(4,t.length),l=function(t,e){t.on(cc.Node.EventType.TOUCH_END,function(){this.openPanelByConfig(e),this.ctrl.openFailFinishView(!1,this.fight_type)},this)}.bind(this);for(n=0;n<o;n++){var r;if(r=t[n]){var c={};c.btn=this.seekChild("btn_"+r.val_key),c.img=c.btn.getComponent(cc.Sprite),c.label=this.seekChild(c.btn,"label",cc.Label),this.loadRes(s.getUIIconPath("battlefail",r.icon),function(t){c.img.spriteFrame=t}.bind(this)),c.label.string=r.icon_name,this.items_list[n]=c}var _=this.items_list[n].btn,h=this.items_list[n].label;_&&(_.active=!0,l(_,r)),h&&(h.string=r.icon_name)}this.updateTimer()},updateTimer:function(){var t=5,e=function(){t-=1;var e=Math.ceil(t),i=e+Utils.TI18N("\u79d2\u540e\u5173\u95ed");this.time_label_rt&&(this.time_label_rt.string=i),e<=0&&(gcore.Timer.del("fail_result_timer"),this.ctrl.openFailFinishView(!1,this.fight_type))}.bind(this);gcore.Timer.set(e,1e3,-1,"fail_result_timer")},handleEffect:function(t){if(0==t)this.special_sk&&(this.special_sk.setToSetupPose(),this.special_sk.clearTracks(),this.special_sk.node.active=!1);else if(this.special_sk){this.special_sk.node.active=!0;var e=cc.js.formatStr("spine/%s/action.atlas",s.getEffectRes(104));this.loadRes(e,function(t){this.special_sk.skeletonData=t,this.special_sk.setAnimation(1,PlayerAction.action,!1)}.bind(this))}},clearItems:function(){if(this.items_list)for(var t in this.items_list){var e=this.items_list[t];e.btn&&(e.btn.active=!1)}},openPanelByConfig:function(t){t.val_key==l.JumpType.Summon?this.jump_ctrl.jumpViewByEvtData([1]):t.val_key==l.JumpType.HeroBag?this.jump_ctrl.jumpViewByEvtData([19]):t.val_key==l.JumpType.Forge?this.jump_ctrl.jumpViewByEvtData([26]):t.val_key==l.JumpType.Hallows&&this.jump_ctrl.jumpViewByEvtData([20])},openRootWnd:function(t){},closeCallBack:function(){if(gcore.Timer.del("fail_result_timer"),this.handleEffect(!1),this.model.getBattleScene()&&this.ctrl.getIsSameBattleType(this.fight_type)){var t={combat_type:this.fight_type,result:this.result};this.model.result(t,null)}this.ctrl.openFailFinishView(!1,this.fight_type),gcore.GlobalEvent.fire(r.CLOSE_RESULT_VIEW,this.fight_type)}});cc._RF.pop()},{battle_const:"battle_const",battle_controller:"battle_controller",battle_drama_controller:"battle_drama_controller",battle_event:"battle_event",jump_controller:"jump_controller",pathtool:"pathtool",role_controller:"role_controller"}],battle_form_panel:[function(t,e,i){"use strict";cc._RF.push(e,"a3bcfwLWNVDC47bREKmNAmJ","battle_form_panel");var s=t("pathtool"),n=t("battle_const"),a=t("battle_event");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("battle","battle_form_view")},initConfig:function(){this.rleasePrefab=!1,this.controller=t("battle_controller").getInstance(),this.model=this.controller.getModel(),this.arena_notice_num=0},initPanel:function(){this.form_container=this.seekChild("form_container");var t=this.seekChild(this.form_container,"left_btn"),e=this.seekChild(this.form_container,"right_btn");this.buff_btn=this.seekChild(this.form_container,"buff_btn"),this.round_label=this.seekChild(this.form_container,"round_label",cc.Label),this.left_icon=this.seekChild(t,"icon",cc.Sprite),this.right_icon=this.seekChild(e,"icon",cc.Sprite),this.left_camp_btn=this.seekChild(this.form_container,"left_camp_btn"),this.right_camp_btn=this.seekChild(this.form_container,"right_camp_btn"),this.left_name_label=this.seekChild(this.form_container,"left_name_label",cc.Label),this.right_name_label=this.seekChild(this.form_container,"right_name_label",cc.Label),this.form_container_Widget=this.form_container.getComponent(cc.Widget),this.left_camp_sprite=this.left_camp_btn.getComponent(cc.Sprite),this.right_camp_sprite=this.right_camp_btn.getComponent(cc.Sprite),this.speed_btn=this.seekChild("speed_btn"),this.speed_btn_label=this.seekChild(this.speed_btn,"Label",cc.Label),this.guilddun_node=this.seekChild("guilddun_node"),this.showskill_node=this.seekChild("showskill_node"),this.skill_spine=this.seekChild(this.showskill_node,"spine",sp.Skeleton),this.skill_head_img=this.seekChild(this.showskill_node,"head",cc.Sprite),this.skill_name=this.seekChild(this.showskill_node,"skill_name",cc.Label),this.pass_btn=this.seekChild("pass_btn"),this.exit_btn=this.seekChild("exit_btn"),this.left_camp_top_nd=this.left_camp_btn.getChildByName("top_sp"),this.left_camp_top_num=this.left_camp_top_nd.getChildByName("top_num_txt").getComponent(cc.Label),this.left_camp_bottom_nd=this.left_camp_btn.getChildByName("bottom_sp"),this.left_camp_bottom_num=this.left_camp_bottom_nd.getChildByName("bottom_num_txt").getComponent(cc.Label),this.left_effect_nd=this.left_camp_btn.getChildByName("left_effect_nd"),this.right_camp_top_nd=this.right_camp_btn.getChildByName("top_sp"),this.right_camp_top_num=this.right_camp_top_nd.getChildByName("top_num_txt").getComponent(cc.Label),this.right_camp_bottom_nd=this.right_camp_btn.getChildByName("bottom_sp"),this.right_camp_bottom_num=this.right_camp_bottom_nd.getChildByName("bottom_num_txt").getComponent(cc.Label),this.right_effect_nd=this.right_camp_btn.getChildByName("right_effect_nd")},registerEvent:function(){Utils.onTouchEnd(this.speed_btn,function(){this.model.checkIsCanChangeBattleSpeed()&&this.model.changeSpeed()}.bind(this),1),Utils.onTouchEnd(this.pass_btn,function(){0==this.arena_notice_num?this.controller.send20062():message(cc.js.formatStr(Utils.TI18N("\u672c\u8d5b\u5b63\u6311\u6218%s\u6b21\u4e4b\u540e\u53ef\u8df3\u8fc7"),this.arena_notice_num))}.bind(this),1),Utils.onTouchEnd(this.left_camp_btn,function(){this.controller.openBattleCampView(!0,this.left_halo_id)}.bind(this),1),Utils.onTouchEnd(this.right_camp_btn,function(){this.controller.openBattleCampView(!0,this.right_halo_id)}.bind(this),1),Utils.onTouchEnd(this.exit_btn,function(){this.controller.csFightExit()}.bind(this),1),this.buff_btn.on("click",function(){var t=this.model.getCurBattleData(),e=t.actor_role_name,i=t.target_role_name;this.controller.getModel().getGroup()!=n.BattleGroupTypeConf.TYPE_GROUP_ENEMY||this.controller.getWatchReplayStatus()||(e=data.target_role_name,i=data.actor_role_name),this.controller.openBattleBuffInfoView(!0,e,i)},this)},setSpeed:function(t){null==t&&(t=1),this.speed_btn_label.string="X"+t,2==t?this.model.setBattleTimeScale(!1):this.model.setBattleTimeScale(!0)},onShow:function(t){t==n.Fight_Type.Darma?(this.form_container_Widget.bottom=408,this.exit_btn.setPosition(595,900)):(this.form_container_Widget.bottom=160,this.exit_btn.setPosition(646,1150)),this.form_container_Widget.updateAlignment(),this.update_round_num&&(this.updateRound(this.update_round_num),this.update_round_num=null),this.initExtendShowStatus(),0==this.controller.getWatchReplayStatus()?t==n.Fight_Type.GuildDun?this.addGuildBossUI(0):t==n.Fight_Type.PK||t==n.Fight_Type.HeroTestWar?this.addExitBtnUI():t==n.Fight_Type.LimitExercise&&this.addLimitExerciseBossFightUI():this.addExitBtnUI(),this.updatePassBtnStatus(t),this.updateBaseInfo();var e=this.model.getSpeed();this.setSpeed(e)},initExtendShowStatus:function(){this.exit_btn.active=!1,this.guilddun_node.active=!1,this.guilddun_getlabel=null,this.star_panel&&(this.star_panel.active=!1)},updateRound:function(t){if(null==this.round_label)this.update_round_num=t;else{var e=this.model.getCombatType();if(null==e||e==n.Fight_Type.Nil)return;var i=Config.combat_type_data.data_fight_list[e];if(!i)return;var s=i.max_action_count;this.round_label.string=cc.js.formatStr(Utils.TI18N("\u7b2c%s/%s\u56de\u5408"),t,s),gcore.GlobalEvent.fire(a.UPDATE_ROUND_NUM)}},updateBaseInfo:function(){if(this.root_wnd){var t=this.model.getCurBattleData();if(t)t.formation&&this.updateFormIcon(t.formation),t.halo_list&&this.updateHaloIcon(t.halo_list),1==this.model.isFriend(n.Group_Type.Friend)?(this.left_name_label.string=t.actor_role_name,this.right_name_label.string=t.target_role_name):(this.left_name_label.string=t.target_role_name,this.right_name_label.string=t.actor_role_name),this.buff_btn.opacity=0,this.buff_btn.runAction(cc.fadeIn(.7))}},updateFormIcon:function(t){if(!(null==t||Object.keys(t).length<2)){var e=null,i=null;if(this.model.isFriend(n.Group_Type.Friend)?(e=t[1],i=t[2]):(e=t[2],i=t[1]),e&&this.left_form_type!=e.formation_type){this.left_form_type=e.formation_type;var a=s.getBattleFormIcon(this.left_form_type);this.loadRes(a,function(t,e){t.spriteFrame=e}.bind(this,this.left_icon))}if(i&&this.right_form_type!=i.formation_type){this.right_form_type=i.formation_type;a=s.getBattleFormIcon(this.right_form_type);this.loadRes(a,function(t,e){t.spriteFrame=e}.bind(this,this.right_icon))}}},updateHaloIcon:function(e){if(!(null==e||Object.keys(e).length<2)){this.left_camp_top_nd.active=!1,this.right_camp_bottom_nd.active=!1;var i=null,a=null;for(var o in e){var l=e[o];1==l.group?i=l.type:2==l.group&&(a=l.type)}var r=[],c=[];if(i<100)r=n.Old_Halo_Id_Change[i]||[];else{var _=Math.floor(i/100),h=i%100;_>0&&r.push(_),h>0&&r.push(h)}if(a<100)c=n.Old_Halo_Id_Change[a]||[];else{var d=Math.floor(a/100),u=a%100;d>0&&c.push(d),u>0&&c.push(u)}var m=t("battle_controller");if(this.left_camp_btn){var f=s.getUIIconPath("campicon","campicon_1000"),p=m.getInstance().getModel().getCampIconConfigByIds(r);if(this.left_halo_id=r,p&&p.icon){f=s.getUIIconPath("campicon","campicon_"+p.icon),this.updateHaloEffect(this.left_effect_nd,!0);var g=p.nums,v=g[0],b=g[1];null!=v&&v>0?(this.left_camp_top_num.string=v,this.left_camp_top_nd.active=!0):this.left_camp_top_nd.active=!1,null!=b&&b>0?(this.left_camp_bottom_num.string=b,this.left_camp_bottom_nd.active=!0):this.left_camp_bottom_nd.active=!1}else this.left_camp_top_nd.active=!1,this.left_camp_bottom_nd.active=!1,this.updateHaloEffect(this.left_effect_nd,!1);this.left_camp_res!=f&&(this.left_camp_res=f,this.loadRes(f,function(t){this.left_camp_sprite.spriteFrame=t}.bind(this)))}if(this.right_camp_btn){f=s.getUIIconPath("campicon","campicon_1000");var w=m.getInstance().getModel().getCampIconConfigByIds(c);if(this.right_halo_id=c,w&&w.icon){this.updateHaloEffect(this.right_effect_nd,!0),f=s.getUIIconPath("campicon","campicon_"+w.icon);var y=w.nums,C=y[0],k=y[1];null!=C&&C>0?(this.right_camp_top_num.string=C,this.right_camp_top_nd.active=!0):this.right_camp_top_nd.active=!1,null!=k&&k>0?(this.right_camp_bottom_num.string=k,this.right_camp_bottom_nd.active=!0):this.right_camp_bottom_nd.active=!1}else this.updateHaloEffect(this.right_effect_nd,!1),this.right_camp_bottom_nd.active=!1,this.right_camp_top_nd.active=!1;this.right_camp_res!=f&&(this.right_camp_res=f,this.loadRes(f,function(t,e){t.spriteFrame=e}.bind(this,this.right_camp_sprite)))}}},updateHaloEffect:function(t,e){if(e){t.scale=.8,t.active=!0;var i=s.getUIIconPath("common","common_1101");this.loadRes(i,function(e){t.getComponent(cc.Sprite).spriteFrame=e}.bind(this));var n=cc.fadeIn(.6),a=cc.fadeOut(.6),o=cc.sequence(n,a),l=cc.repeatForever(o);t.runAction(l)}else t.active=!1,t.stopAllActions()},addGuildBossUI:function(t){null==this.guilddun_getlabel&&(this.guilddun_node.active=!0,this.guilddun_getlabel=this.seekChild(this.guilddun_node,"get_label",cc.Label)),this.guilddun_getlabel.string=t},getStarPanelUI:function(t){if(this.root_wnd)if(this.star_panel){this.star_panel.active=!0;for(var e={},i={},n=1;n<4;++n){var a=this.star_panel.getChildByName("container").getChildByName("star_"+n);a&&(a.active=!1,e[n]=a);var o=this.star_panel.getChildByName("container").getChildByName("star_desc_"+n).getComponent(cc.Label);o&&(o.string="",i[n]=o)}t(i,e)}else this.loadRes(s.getPrefabPath("battle","battle_star_panel"),function(e){this.star_panel=e,this.root_wnd.addChild(e);for(var i={},s={},n=1;n<4;++n){var a=this.star_panel.getChildByName("container").getChildByName("star_"+n);a&&(a.active=!1,i[n]=a);var o=this.star_panel.getChildByName("container").getChildByName("star_desc_"+n).getComponent(cc.Label);o&&(o.string="",s[n]=o)}t(s,i)}.bind(this))},addLimitExerciseBossFightUI:function(){var t=function(t,e){if(t&&e){for(var i=1;i<4;++i){var s=this.star_panel.getChildByName("container").getChildByName("gary_star_"+i);s&&(s.active=!1)}var n=this.model.getCurBattleData().extra_args;if(n[0]&&n[1]&&n[2]&&n[3]){var a=n[0].param||1,o=n[1].param||1,l=n[2].param||1,r=n[3].param||1,c=Config.holiday_boss_new_data.data_change_boss_list;if(c[a]&&c[a][o]&&c[a][o][l]&&c[a][o][l][r]){var _=c[a][o][l][r];if(_)for(var h=1;h<=3;++h)t[h]&&(t[h].node.x=-187,1==h?t[h].string=Utils.TI18N("\u5173\u5361\u6548\u679c:"):_.add_skill_decs[h-2]&&(t[h].string=_.add_skill_decs[h-2]))}}}}.bind(this);this.getStarPanelUI(t)},addExitBtnUI:function(){this.exit_btn.active=!0},updatePassBtnStatus:function(e){if(this.arena_notice_num=0,null==e||this.controller.getWatchReplayStatus())this.pass_btn.active=!1;else{var i=Config.combat_type_data.data_fight_list[e];if(null!=i&&"true"==i.is_skip){if(e==n.Fight_Type.Arena){var s=t("arena_controller").getInstance().getModel().getHadCombatNum(),a=Config.arena_data.data_const.arena_skip_count;if(null==a)return void(this.pass_btn.active=!1);s<a.val&&(this.arena_notice_num=a.val)}this.pass_btn.active=!0}else this.pass_btn.active=!1}},showActiveSkillName:function(t,e){if(null!=t&&null!=t.skill_data){var i=t.getRoleData();if(null!=i)if(t.temp_skill_bid!=t.attacker_info.skill_bid){t.temp_skill_bid=t.attacker_info.skill_bid;var a=PlayerAction.action_1;1==t.is_friend&&(a=PlayerAction.action_2),this.skill_name.string=t.skill_data.name;var o=i.object_type,l=i.object_bid,r=i.face_id;if(0==i.face_id&&(r=i.object_bid),o==n.Unit_Type.Monster){var c=Utils.getUnitConfig(l);c&&(r=c.head_icon)}var _=s.getHeadRes(r);this.skill_head_path!=_&&(this.skill_head_path=_,this.loadRes(_,function(t,e){t.spriteFrame=e}.bind(this,this.skill_head_img))),this.skill_head_img.node.stopAllActions(),this.skill_name.node.stopAllActions(),this.showskill_node.active=!0,this.skill_head_img.node.x=-121,this.skill_name.node.x=190,this.skill_head_img.node.opacity=0,this.skill_name.node.opacity=0;var h=function(){var t=cc.callFunc(function(){e&&e()}.bind(this)),i=cc.moveTo(.08,-62,0),s=cc.fadeIn(.1),n=cc.delayTime(.3),a=cc.delayTime(.5),o=cc.callFunc(function(){this.showskill_node.active=!1}.bind(this));this.skill_head_img.node.runAction(cc.sequence(cc.spawn(i,s),n,t,a,o));var l=cc.moveTo(.08,34,0),r=cc.fadeIn(.1);this.skill_name.node.runAction(cc.spawn(l,r))}.bind(this);if(null!=this.skill_spine.skeletonData)this.skill_spine.setAnimation(0,a,!1),h();else{var d=s.getSpinePath("E31321");this.loadRes(d,function(t,e){t.skeletonData=e,t.setAnimation(0,a,!1),h()}.bind(this,this.skill_spine))}}else e&&e();else e&&e()}else e&&e()},onHide:function(){t("chat_controller").getInstance().closeChatPanel(),gcore.GlobalEvent.fire(a.EXIT_FIGHT)},onDelete:function(){}});cc._RF.pop()},{arena_controller:"arena_controller",battle_const:"battle_const",battle_controller:"battle_controller",battle_event:"battle_event",chat_controller:"chat_controller",pathtool:"pathtool"}],battle_harm_info_item:[function(t,e,i){"use strict";cc._RF.push(e,"f85f8nFT2BFjb0z+Gb4RmRR","battle_harm_info_item");var s=t("pathtool"),n=t("hero_vo"),a=1,o=1;cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("battle","battle_harm_info_item"),this.role_dir=arguments[0]||o,this.vedio_id=arguments[1]||0},initConfig:function(){this.size=cc.size(300,99)},initPanel:function(){var t=this.seekChild("container");this.progress_bg_nd=this.seekChild(t,"progress_bg"),this.progress_pb=this.seekChild(this.progress_bg_nd,"progress",cc.ProgressBar),this.progress_pb.progress=0,this.progress_value_lb=this.seekChild(this.progress_bg_nd,"progress_value",cc.Label),this.progress_value_lb.string=0,this.image_mvp_nd=this.seekChild(t,"image_mvp"),this.image_mvp_nd.active=!1,this.hero_head=ItemsPool.getInstance().getItem("hero_exhibition_item"),this.hero_head.setRootScale(.7),this.hero_head.addCallBack(this._onClickHeroCallBack.bind(this)),this.hero_head.setParent(t),this.hero_head.show(),this.role_dir==o?(this.hero_head.setPosition(50,this.size.height/2),this.image_mvp_nd.setPosition(cc.v2(270,72)),this.progress_bg_nd.setPosition(cc.v2(100,40)),this.progress_value_lb.node.setAnchorPoint(cc.v2(0,.5)),this.progress_value_lb.node.x=0,this.progress_pb.node.x=0,this.progress_pb.node.scale=1):(this.hero_head.setPosition(this.size.width-50,this.size.height/2),this.image_mvp_nd.setPosition(cc.v2(this.size.width-254,72)),this.progress_bg_nd.setPosition(cc.v2(this.size.width-184-100,40)),this.progress_value_lb.node.setAnchorPoint(cc.v2(1,.5)),this.progress_value_lb.node.x=184,this.progress_pb.node.x=184,this.progress_pb.node.scale=-1)},registerEvent:function(){},_onClickHeroCallBack:function(){if(null!=this.data&&null!=this.data.id&&null!=this.vedio_id&&0!=this.vedio_id)t("vedio_controller").getInstance().requestVedioHeroData(this.vedio_id,this.data.id,this.role_dir);else if(this.data&&this.data.rid&&0!=this.data.rid&&this.data.srvid&&""!=this.data.srvid&&this.data.id){var e=t("role_controller").getInstance().getRoleVo();if(e.rid==this.data.rid&&e.srv_id==this.data.srvid){var i=t("hero_controller").getInstance(),s=i.getModel().getHeroById(this.data.id);i.openHeroTipsPanel(!0,s)}else t("look_controller").getInstance().sender11061(this.data.rid,this.data.srvid,this.data.id)}else message(Utils.TI18N("\u8be5\u82f1\u96c4\u6765\u81ea\u5f02\u57df\uff0c\u65e0\u6cd5\u67e5\u770b"))},setData:function(t,e,i){this.data=t,this.max_harm_val=e,this.max_cure_val=i,this.root_wnd&&this.onShow()},onShow:function(){if(null!=this.data){var t=this.data,e=new n;if(Config.partner_data.data_partner_base[t.bid])e.bid=t.bid,e.star=t.star;else{var i=Utils.getUnitConfig(t.bid);if(i)if(e.bid=Number(i.head_icon),i.star&&i.star>0)e.star=i.star;else{var s=Config.partner_data.data_partner_base[e.bid];s&&(e.star=s.init_star)}}if(e.camp_type=t.camp_type,e.lev=t.lev,t.ext_data)for(var a in t.ext_data){var o=t.ext_data[a];5==o.key&&(e.use_skin=o.val)}this.hero_head.setData(e),this.updateHarmType()}},updateHarmType:function(t){this.data&&(this.harm_type=t||a,this.total_val=0,this.cur_val=0,this.harm_type==a?(this.image_mvp_nd.active=this.data.dps>0&&this.data.dps==this.max_harm_val,this.total_val=this.max_harm_val,this.cur_val=this.data.dps):(this.image_mvp_nd.active=this.data.cure>0&&this.data.cure==this.max_cure_val,this.total_val=this.max_cure_val,this.cur_val=this.data.cure),this.temp_add=this.cur_val/50,this.temp_harm_val=0,this.progress_pb.progress=0,this.progress_value_lb.string=this.cur_val,this.openProgressTimer(!0))},openProgressTimer:function(t){1==t?null==this.progress_timer&&(this.progress_timer=gcore.Timer.set(function(){this.temp_harm_val=this.temp_harm_val+this.temp_add,0==this.total_val?this.progress_pb.progress=0:this.temp_harm_val<this.cur_val?this.progress_pb.progress=this.temp_harm_val/this.total_val:(this.progress_pb.progress=this.cur_val/this.total_val,gcore.Timer.del(this.progress_timer),this.progress_timer=null)}.bind(this),1,-1)):null!=this.progress_timer&&(gcore.Timer.del(this.progress_timer),this.progress_timer=null)},onHide:function(){},onDelete:function(){this.hero_head&&(this.hero_head.deleteMe(),this.hero_head=null),this.openProgressTimer(!1)}});cc._RF.pop()},{hero_controller:"hero_controller",hero_vo:"hero_vo",look_controller:"look_controller",pathtool:"pathtool",role_controller:"role_controller",vedio_controller:"vedio_controller"}],battle_harm_info_window:[function(t,e,i){"use strict";cc._RF.push(e,"07d8aPCdyhJ7Zsh6xdKYJ6l","battle_harm_info_window");var s=t("pathtool"),n=t("battle_controller"),a=t("role_controller"),o=t("battle_harm_info_item"),l=1,r=2;cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("battle","battle_harm_info_view"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Mini},initConfig:function(){this.ctrl=n.getInstance(),this.tab_list={},this.left_role_list={},this.right_role_list={}},openCallBack:function(){this.background=this.seekChild("background"),this.background.scale=FIT_SCALE;var t=this.seekChild("container");this.left_name_lb=this.seekChild(t,"left_name_label",cc.Label),this.right_name_lb=this.seekChild(t,"right_name_label",cc.Label),this.left_role_panel_nd=this.seekChild(t,"left_role_panel"),this.right_role_panel_nd=this.seekChild(t,"right_role_panel"),this.close_btn=this.seekChild(t,"close_btn");for(var e=this.seekChild(t,"tab_container"),i=1;i<=2;i++){var s={},n=e.getChildByName("tab_btn_"+i);if(n){var a=n.getChildByName("title").getComponent(cc.Label);s.tab_btn=n,s.label=a,s.index=i,this.tab_list[i]=s,1==i?(a.string=Utils.TI18N("\u4f24\u5bb3\u91cf"),this.tab_object=s):2==i&&(a.string=Utils.TI18N("\u6cbb\u7597\u91cf"))}}},registerEvent:function(){Utils.onTouchEnd(this.close_btn,function(){this.ctrl.openBattleHarmInfoView(!1)}.bind(this),2),Utils.onTouchEnd(this.background,function(){this.ctrl.openBattleHarmInfoView(!1)}.bind(this),2);var t=function(t){t.tab_btn.on("click",function(){this.changeSelectedTab(t.index),Utils.playButtonSound(1)},this)}.bind(this);for(var e in this.tab_list){var i=this.tab_list[e];i.tab_btn&&t(i)}},openRootWnd:function(t){this.setData(t)},setData:function(t){if(t&&t.hurt_statistics){this.data=t;var e=a.getInstance().getRoleVo(),i=t.atk_name||e.name;this.left_name_lb.string=i,this.right_name_lb.string=t.target_role_name||t.def_name||"";var s={},n={};for(var c in t.hurt_statistics){1==(m=t.hurt_statistics[c]).type?s=m.partner_hurts:2==m.type&&(n=m.partner_hurts)}var _=0,h=0;for(var c in s){(m=s[c]).dps>_&&(_=m.dps),m.cure>h&&(h=m.cure)}var d=0,u=0;for(var c in n){var m;(m=n[c]).dps>d&&(d=m.dps),m.cure>u&&(u=m.cure)}for(var c in this.right_role_list)this.right_role_list[c].setVisible(!1);for(var c in this.left_role_list)this.left_role_list[c].setVisible(!1);var f=this.left_role_panel_nd.getContentSize().height,p=function(e,i){Utils.delayRun(this.left_role_panel_nd,4*i/60,function(){var s=this.left_role_list[i];null==s&&(s=new o(l,t.vedio_id),this.left_role_list[i]=s,s.setParent(this.left_role_panel_nd),s.show()),s.setVisible(!0),s.setPosition(0,f-99*i-99),s.setData(e,_,h)}.bind(this))}.bind(this);for(var g in s)p(s[g],g);var v=function(e,i){Utils.delayRun(this.right_role_panel_nd,4*i/60,function(){var s=this.right_role_list[i];null==s&&(s=new o(r,t.vedio_id),this.right_role_list[i]=s,s.setParent(this.right_role_panel_nd),s.show()),s.setVisible(!0),s.setPosition(0,f-99*i-99),s.setData(e,d,u)}.bind(this))}.bind(this);for(var g in n)v(n[g],g)}},changeSelectedTab:function(t){if(!this.tab_object||this.tab_object.index!=t){for(var e in this.tab_object&&(this.tab_object.tab_btn.getComponent(cc.Button).interactable=!0,this.tab_object.label.node.color=new cc.Color(245,224,185,255)),this.tab_object=this.tab_list[t],this.tab_object&&(this.tab_object.tab_btn.getComponent(cc.Button).interactable=!1,this.tab_object.label.node.color=new cc.Color(105,55,5,255)),this.left_role_list)this.left_role_list[e].updateHarmType(t);for(var e in this.right_role_list)this.right_role_list[e].updateHarmType(t)}},closeCallBack:function(){for(var t in this.ctrl.openBattleHarmInfoView(!1),this.left_role_list)this.left_role_list[t]&&(this.left_role_list[t].deleteMe(),this.left_role_list[t]=null);for(var t in this.right_role_list)this.right_role_list[t]&&(this.right_role_list[t].deleteMe(),this.right_role_list[t]=null)}});cc._RF.pop()},{battle_controller:"battle_controller",battle_harm_info_item:"battle_harm_info_item",pathtool:"pathtool",role_controller:"role_controller"}],battle_hook_model:[function(t,e,i){"use strict";cc._RF.push(e,"5ed83YCCWJFE6dExfhdam/J","battle_hook_model");var s=["hit_effect_list","area_effect_list","act_effect_list","bact_effect_list","trc_effect_list"],n=t("battle_res_pool");cc.Class({ctor:function(){},initConfig:function(){this.unreal_battle_data=null,this.battle_controller=t("battle_controller").getInstance(),this.battle_model=this.battle_controller.getModel(),this.skill_act=t("skill_act"),this.resetInitData()},updateUnrealBattleData:function(t){this.unreal_battle_data=t},getUnrealBattleData:function(){return this.unreal_battle_data},deleteUnrealBattleData:function(){this.unreal_battle_data=null},resetInitData:function(){this.all_object={},this.group=0,this.act_playing=!1,this.one=null,this.ready_wait=0,this.round_data={},this.order_list=[],this.skill_plays_order_list=[],this.round_data_temp={},this.sum=0,this.actor_sum=0,this.actor_play_sum=0,this.our_num=0,this.is_real_battle_ready=!1,this.res_num=0,this.res_list={},this.a_object_num=1,this.actor_plays_list={}},prepareStarBattle:function(t){this.start_cb=t,this.resetInitData();var e=BattleLoop.init(this.unreal_battle_data);this.startBattle(e)},startBattle:function(t){this.createBattleRole(t),this.battle_controller.setIsNormaBattle(!0)},getBattleScene:function(){return this.battle_model.getBattleScene()},createBattleRole:function(t){if(cc.log("\u521b\u5efa\u5047\u6218\u6597\u7684\u89d2\u8272"),cc.log(t),t&&t.objects&&t.target_list&&this.getBattleScene()){this.ready_wait=0,this.sum=0,this.our_num=Object.keys(t.objects).length,this.role_finish=0;for(var e in t.objects){var i=t.objects[e];this.group=i.group,0,this.createRole(i,null,function(){this.start_cb&&(this.start_cb(),this.start_cb=null),this.role_finish+=1,this.role_finish}.bind(this))}for(var e in t.target_list){var s=t.target_list[e];this.createRole(s)}}},createRole:function(e,i,s){if(this.getBattleScene()&&null!=e){var n=this.getBattleScene().getBattleRoleLayer();if(null!=n){this.ready_wait+=1,null==i&&(i=!1);var a=new(t("battle_role"))(i);a.createRole(n,e,!1,!1,!1,s),this.all_object[e.pos]=a}}},getSkillPlayData:function(t){if(this.actor_plays_list[t])return this.actor_plays_list[t]},updateActorPlaysList:function(t){t&&(null==this.actor_plays_list[t.actor]&&(this.actor_plays_list[t.actor]=[]),this.actor_plays_list[t.actor].push(t))},handleSkillPlayData:function(t,e){this.preloadBattleRes(t,function(t){e?e(function(t){cc.log("\u5f00\u59cb\u6280\u80fd\u64ad\u62a5"),this.skill_plays_order_list=[],this.act_playing=!1,t&&this.playSkillPlayData(t)}.bind(this,t)):(this.skill_plays_order_list=[],this.act_playing=!1,t&&this.playSkillPlayData(t))}.bind(this,t))},playSkillPlayData:function(t){if(t){for(var e=0;e<t.skill_plays.length;e++)for(var i=t.skill_plays[e],s=0;s<i.effect_play.length;s++){var n=i.effect_play[s];null==this.round_data_temp[n.order]&&(this.round_data_temp[n.order]=[],this.skill_plays_order_list.push({skill_order:n.order})),n.skill_bid=i.skill_bid,n.index=s,n.skill_order=i.order,n.talk_content=i.talk_content,n.talk_pos=i.talk_pos,this.round_data_temp[n.order].push(n)}this.skill_plays_order_list.sort(function(t,e){return t.skill_order-e.skill_order}),this.analyseTempRoundData()}},analyseTempRoundData:function(){if(this.order_list=[],this.round_data={},Object.keys(this.round_data_temp).length>0){for(var t=0;t<this.skill_plays_order_list.length;t++)for(var e=this.skill_plays_order_list[t],i=this.round_data_temp[e.skill_order],s=0;s<i.length;s++){var n=i[s];null==this.round_data[n.order]&&(this.round_data[n.order]={},this.order_list.push({order:n.order,target:n.target})),null==this.round_data[n.order][n.actor]&&(this.round_data[n.order][n.actor]={order:n.order,actor:n.actor,target:n.target,skill_bid:n.skill_bid,index:n.index,talk_content:n.talk_content,talk_pos:n.talk_pos,target_list:[]}),this.round_data[n.order][n.actor].target_list.push(n)}this.order_list.sort(function(t,e){return t.order-e.order}),this.round_data_temp={}}this.round()},round:function(){if(this.round_data_temp={},this.actor_sum=0,this.actor_play_sum=0,this.next_round=null,this.cur_round=null,0==this.order_list.length)this.is_real_battle_ready||(this.act_playing=!1);else{var t=this.order_list.shift(),e=this.round_data[t.order];if(this.order_list.length>0){var i=this.order_list[0].order,s=this.round_data[i];for(var n in s)if(null==this.next_round){this.next_round=s[n];break}}for(var n in e){var a=e[n];if(null==this.cur_round&&(this.cur_round=a),a.target_list.length>0){var o=this.getBattleRoleByPos(a.actor);o?(this.actor_sum=this.actor_sum+1,this.initOrder(o,a)):this.round()}else this.round()}}},initOrder:function(t,e){e.target_list.sort(function(t,e){return t.index-e.index});var i=e.target_list[0].target;i>GIRD_POS_OFFSET&&(i-=GIRD_POS_OFFSET);var s=Pos_To_Col[i-1];if(t.col=s,t.is_round=!1,t.attacker_info=e,t.skill_data=gdata("skill_data","data_get_skill",e.skill_bid),t.target_pos=t.grid_pos,t.play_order_index=e.target_list[0].effect_bid,this.battle_model.calcTargetPos(t,this.all_object),null!=t.play_order_index&&0!=t.play_order_index){var n=gdata("skill_data","data_get_effect",t.play_order_index);n&&(t.play_order=Utils.deepCopy(n.action_list),t.shake_id=n.shake_id,t.effect_type=n.effect_type,t.play_stand=n.play_stand,t.anime_res=n.anime_res,t.split_hurt=n.split_hurt,t.hit_action=n.hit_action,t.effect_desc=n.effect_desc,t.is_must_die=n.is_must_die,t.anime_user_atk=n.anime_user_atk,t.attack_sound=n.attack_sound,t.ready_sound=n.ready_sound,t.shout_trick=n.shout_trick,t.hit_sound=n.hit_sound,t.hit_effect_list=Utils.deepCopy(this.battle_model.getCurEffectList(n.hit_effect_list)),t.area_effect_list=Utils.deepCopy(this.battle_model.getCurEffectList(n.area_effect_list)),t.act_effect_list=Utils.deepCopy(this.battle_model.getCurEffectList(n.act_effect_list)),t.bact_effect_list=Utils.deepCopy(this.battle_model.getCurEffectList(n.bact_effect_list)),t.trc_effect_list=Utils.deepCopy(this.battle_model.getCurEffectList(n.trc_effect_list))),t.area_effect_list.length>0?(t.attacker_info.is_calc=!1,t.in_area_effect=!0,t.area_hit_num=1,t.area_hit_time=0):t.in_area_effect=!1;var a=function(){this.playOrder(t)}.bind(this);this.talk(t,a),this.act_playing=!0}else this.round()},playOrder:function(t){if(null!=t&&null!=t.play_order_index&&0!=t.play_order_index)if(t.wait_act=0,null==t.play_order||0==t.play_order.length)this.actor_play_sum+=1,this.resetAttackerStandStatus(t),t.is_die||t.resetZOrder(),t.is_round||this.actor_play_sum>=this.actor_sum&&this.round();else{var e=t.play_order.shift(),i=this.battle_model.singleAct(e,t);i&&t.runAction(i)}},talk:function(t,e){var i=t.attacker_info.talk_content||"";t.attacker_info.talk_pos;e&&e()},playEnd:function(t){if(this.getBattleScene())for(var e in BattleLoop.playEnd(t),this.delBattleRoleByPos(t),this.all_object){var i=this.all_object[e];if(i){t=i.pos;if(this.actor_plays_list[t]){this.actor_plays_list[t].shift();var s=this.actor_plays_list[t][0];s&&this.handleSkillPlayData(s)}}}},updateNextRoundData:function(){if(this.getBattleScene()){var t=[],e=BattleLoop.nextTarget();if(e){this.getMoveTime(e.actor,e.effect_bid),t.push(e);for(var i=0;i<t.length;i++){var s=t[i],n=[s.pos-GIRD_POS_OFFSET-1];2==s.group&&this.createRole(s,this.checkColObjet(n))}}}},checkColObjet:function(t){if(!this.getBattleScene())return!1;var e=!1;for(var i in this.all_object){var s=this.all_object[i];if(s&&2==s.group)Pos_To_Col[s.pos-GIRD_POS_OFFSET-1]==t&&(e=!0)}return e},getMoveTime:function(t,e){var i=200,s=gdata("skill_data","data_get_effect",e);if(s){var n=this.getBattleRoleByPos(t);if(n){var a=n.spine_name,o=s.anime_res,l=PlayerAction.action_1,r=null,c=Config.battle_act_data.data_info[a];(r=c&&c[o]&&c[o][l]?c[o][l]:Config.battle_act_data.data_info[0].action1.action1)&&(i=r.move_delay_time+r.move_time),this.setAckMoveTime(1e3*i/60)}}},setAckMoveTime:function(t){this.move_time=t},getFinalMoveTime:function(){return this.move_time||200},getBattleRoleByPos:function(t){if(this.all_object[t])return this.all_object[t]},delBattleRoleByPos:function(t){var e=this.getBattleRoleByPos(t);e&&e.deleteRole(),this.all_object[t]=null},clearRealRole:function(){if(this.battle_controller.setIsNormaBattle(!1),0!=Object.keys(this.all_object).length){for(var t in this.all_object){gcore.Timer.del("attackerActTimeout"+t);var e=this.all_object[t];e&&e.deleteRole()}this.all_object={}}},resetAttackerStandStatus:function(t){null!=this.getBattleScene()&&null!=t&&this.skill_act.setAnimation(t,PlayerAction.run,!0)},playMagic:function(t,e,i){if(this.getBattleScene()&&t&&e&&e.target){var s=this.getBattleRoleByPos(e.target);if(s){var n=Math.floor(e.hurt),a=0;e.hp<=0&&(a=1),s.is_hurt_play||(s.is_hurt_play=!0,this.battle_model.playHurtEffect(t,s),t.pos!=s.pos&&n<0&&t.group!=s.group&&"no-hurt"!=t.hit_action&&this.skill_act.hurt(t,s,t.hit_action,!1)),this.battle_model.updateTargetHp(t,s,n,a,1,e)}}},getEffectRes:function(){},preloadBattleRes:function(t,e){cc.log("\u5f00\u59cb\u52a0\u8f7d\u5047\u6218\u6597\u8d44\u6e90");var i={};for(var a in t.skill_plays){var o=t.skill_plays[a];for(var l in o.effect_play){var r=o.effect_play[l],c=gdata("skill_data","data_get_effect",r.effect_bid),_=this.all_object[r.actor],h=this.all_object[r.target];if(r.effect_bid)if(c=gdata("skill_data","data_get_effect",r.effect_bid)){if(c.anime_res&&_){var d=_.getResPath(c.anime_res);d&&(i[d]=!0)}if(c.hit_action&&h){var u=h.getResPath(c.hit_action);"no-hurt"!=c.hit_action&&u&&(i[u]=!0)}for(var m in s){var f=this.getCurEffectList(c[s[m]]);for(var l in f){var p=f[l];if(p.res_up){var g=PlayerAction.action;i["spine/"+p.res_up+"/"+g]=!0}if(p.res_down){g=PlayerAction.action;i["spine/"+p.res_down+"/"+g]=!0}}}}}}var v=0,b=0;for(var w in i){v++;var y=w+".atlas";n.getInstance().preLoadRes(y,function(t){++b==v&&(cc.log("\u5047\u6218\u6597\u8d44\u6e90\u52a0\u8f7d\u5b8c\u6210"),e&&e())}.bind(this))}},getCurEffectList:function(t){for(var e=[],i=0;i<t.length;i++){var s=t[i],n=Config.skill_data.data_get_effect_data[s];e.push(n)}return e}});cc._RF.pop()},{battle_controller:"battle_controller",battle_res_pool:"battle_res_pool",battle_role:"battle_role",skill_act:"skill_act"}],battle_loop:[function(t,e,i){"use strict";cc._RF.push(e,"5a5b5z2plxG9L+PaGlrhlMS","battle_loop"),window.BattleLoop={init:function(t){this.next_target_type_pos=1,this.next_target_type_kill=2,this.talk_cd=0,this.col_info=[0,1,2,3,1,2,3,1,2,3],this.col_pos_info=[[],[1,4,7],[2,5,8],[3,6,9]],this.idx=0,this.data=t,this.a_objects={},this.target_objects={},this.randWaveTargets(),this.b_formation_type=t.b_formation_type||1,this.now_num=0,this.max_num=Math.min(t.partner_list.length,3),this.needPlays={},this.last_pos=0,this.last_time=0,this.a_col={},this.target_play={},this.cd_time=1,t.partner_list.length<2&&(this.cd_time=2);var e=Config.dungeon_data.data_drama_dungeon_info[t.dun_bid.toString()];this.talk_list=e.talk_ids;var i={objects:{},target_list:{}};i.comabt_type=t.combat_type;for(var s=0;s<t.partner_list.length;s++){var n=t.partner_list[s];n.playing=0;var a=s+1;this.a_objects[a]=n,i.objects[a]={pos:n.pos,object_bid:n.bid,bid:n.bid,star:n.star,object_type:2,group:1,hp:n.hp,hp_max:n.hp,skill_list:[],fashion:n.use_skin};var o=this.col_info[n.pos];this.a_col[o]=this.a_col[o]||{rnum:0,enum:0},this.a_col[o].rnum+=1,this.a_col[o][n.pos]=a;for(var l=0;l<n.skill_list.length;l++){var r=n.skill_list[l];i.objects[a].skill_list.push(r.sid)}}return i.target_list[0]=this.nextTarget(),i},nextTarget:function(){var t=gcore.SmartSocket.getTime();if(!(this.now_num>=this.max_num||this.now_num>0&&t-this.last_time<this.cd_time)){for(var e=[],i=[],s=0,n=0,a=1;a<10;a++)s=a+GIRD_POS_OFFSET,n=this.col_info[a],null==this.target_objects[s]&&null!=this.a_col[n]&&this.last_pos!=s&&this.a_col[n].rnum>this.a_col[n].enum&&(e.push(s),this.col_info[this.last_pos-GIRD_POS_OFFSET]!=n&&i.push(s));if(i.length>0&&(e=i),e.length>0){s=this.rand_item(e),n=this.col_info[s-GIRD_POS_OFFSET],this.a_col[n].enum=this.a_col[n].enum+1;var o=this.rand_item(this.b_objects);this.target_objects[s]=o,this.needPlays[s]=1,this.last_pos=s,this.last_time=t,this.now_num+=1;var l=this.init_play(s);return this.target_play[s]=l,{pos:s,object_bid:o.bid,bid:o.bid,star:o.star,object_type:3,group:2,hp:o.hp,hp_max:o.hp,skill_list:[],actor:l.actor,effect_bid:l.effect_bid}}}},init_play:function(t){if(null!=t){var e=this.target_objects[t];if(null!=e&&this.needPlays[t]){var i=this.selectActor(t);this.needPlays[t]=i;var s=this.a_objects[i];s.playing=s.playing+1;for(var n=this.rand_item_by_key(s.skill_list,"rand"),a={skill_plays:[],actor:s.pos,target:t,skill_bid:n.sid},o=1,l=this.rand_talk(),r=l&&l.talk_pos?l.talk_pos:0,c=l&&l.talk_content?l.talk_content:"",_={order:1,bid:s.bid,actor:s.pos,target:t,skill_bid:n.sid,effect_play:[],talk_pos:r,talk_content:c},h=e.hp,d=0;d<n.effect_list.length;d++){var u=n.effect_list[d];a.effect_bid=u.eid;var m=Utils.randomNum(u.min_hurt,u.max_hurt),f=0;Utils.randomNum(0,1e3)<s.crit&&(m=Math.ceil(1.5*m),f=1);var p=m;d!=n.effect_list.length-1&&(p=Math.ceil(Math.min(m,h)/n.effect_list.length)),h=Math.max(h-p);var g={order:o,actor:s.pos,target:t,effect_bid:u.eid,hp:h,hurt:-m,is_crit:f};_.effect_play.push(g),o+=1}return a.skill_plays.push(_),a}}},play:function(t){var e=this.target_play[t];return this.target_play[t]=null,e},selectActor:function(t){for(var e=t-GIRD_POS_OFFSET,i=this.col_info[e],s=this.col_pos_info[i],n=this.a_col[i],a=0,o=0,l=0;l<s.length;l++){if((a=n[s[l]])&&(o=o||a,0==this.a_objects[a].playing))return a}return o},playEnd:function(t){var e=this.needPlays[t];e&&(this.a_objects[e].playing-=1);this.needPlays[t]=null,this.target_objects[t]=null,this.now_num-=1;var i=this.col_info[t-GIRD_POS_OFFSET];this.a_col[i]&&(this.a_col[i].enum-=1)},rand_talk:function(){if(this.talk_cd=this.talk_cd-1,!(this.talk_cd>0)){var t=this.rand_item_by_key2(this.talk_list,1,1e4);if(t&&t[0]){this.talk_cd=5;var e=this.rand_item(this.a_objects),i=t[0]||1,s=Config.dungeon_data.data_drama_talk[i.toString()];return{talk_pos:e.pos,talk_content:s.talk}}}},randWaveTargets:function(){this.idx%10==0&&(this.b_objects=this.rand_item(this.data.wave_list).unit_list),this.idx+=1},rand_item:function(t){if(t instanceof Array){var e=t.length;return t[Utils.randomNum(1,e)-1]}var i=[];for(var s in t)i.push(s);var n=i.length;return t[i[Utils.randomNum(1,n)-1]]},rand_item_by_key:function(t,e){for(var i=0,s=0;s<t.length;s++){i+=t[s][e]}return this.rand_item_by_key2(t,e,i)},rand_item_by_key2:function(t,e,i){for(var s=Utils.randomNum(1,i),n=0;n<t.length;n++){var a=t[n];if(s>=(i-=a[e]))return a}}},cc._RF.pop()},{}],battle_model:[function(t,e,i){"use strict";cc._RF.push(e,"046a3v0XBJHTaPPjX3IPd0Q","battle_model");var s=t("battle_data"),n=t("battle_const"),a=t("loadermanager"),o=t("battle_res_pool"),l=["hit_effect_list","area_effect_list","act_effect_list","bact_effect_list","trc_effect_list"],r=cc.Class({ctor:function(){},properties:{init_fight_status:!1},initConfig:function(){this.battle_controller=t("battle_controller").getInstance(),this.hook_model=this.battle_controller.getHookModel(),this.skill_act=t("skill_act"),this.battle_pools=t("battle_role_pool").getInstance(),this.battle_dmg_cache_list={},this.battle_effect_list={},this.battle_effect_pool={},this.role_time_scale=1.1,this.battle_speed=1,this.button_list_panel_time=0,this.form_panel_time=0,this.is_clear=!0,this.resetInitData()},resetInitData:function(){this.my_group=0,this.init_fight_status=!1,this.alive_num=0,this.create_over_num=0,this.skill_plays_order_list=[],this.round_data_temp={},this.order_list=[],this.round_data={},this.cur_round_data={},this.actor_sum=0,this.actor_play_sum=0,this.act_playing=!1,this.is_play_round_start=!1,this.cur_round=null,this.next_round=null,this.battle_data=null,this.combat_type=n.Fight_Type.Nil,this.real_role_list={},this.cur_fight_type=0,this.buffs={},this.hallows_list={},this.scene_buff_effect_list={}},addBattleEfffect:function(e,i,s,n,a){var o=t("battle_effect"),l=null,r=Utils.getNorKey(n,a);return null!=this.battle_effect_pool[r]&&this.battle_effect_pool[r].length>0&&(l=this.battle_effect_pool[r].shift()),null==l?(l=new o).createEffect(e,i,s,n):(l.resetScenePos(i),l.resetReverse(s),l.setTimeScale(this.role_time_scale),l.setActiveEffect(!0)),null==this.battle_effect_list[r]&&(this.battle_effect_list[r]=[]),this.battle_effect_list[r].push(l),l},delBattleEffect:function(t){var e=t.getEffectKey();if("_"!=e){null==this.battle_effect_pool[e]&&(this.battle_effect_pool[e]=[]);for(var i=this.battle_effect_list[e],s=0;s<i.length;s++){if(i[s]==t){i.splice(s,1),t.setActiveEffect(!1),this.battle_effect_pool[e].push(t);break}}}},getDmgFontCacheObject:function(t,e){var i=PathTool.getPlistPath("num","type"+t),s=this.battle_dmg_cache_list[i];null==s?a.getInstance().loadRes(i,function(t){this.battle_dmg_cache_list[i]=t,e(t)}.bind(this)):e(s)},releaseDmgFont:function(){for(var t in this.battle_dmg_cache_list)a.getInstance().releaseRes(t);this.battle_dmg_cache_list={}},getNormalFont:function(){var t=this.battle_pools.getFontPools(),e=null;if(t.size()>0)e=t.get();else{(e=new cc.Node).setAnchorPoint(.5,.5),e.width=176,e.height=44;var i=new cc.Node;i.addComponent(cc.Sprite),e.addChild(i);var s=new cc.Node,n=s.addComponent(cc.Label);n.lineHeight=20,n.fontSize=20,s.addComponent(cc.LabelOutline),s.name="font_label",e.addChild(s);var o=PathTool.getUIIconPath("battle","battle_buff_name_bg");a.getInstance().loadRes(o,function(t,e){t.getComponent(cc.Sprite).spriteFrame=e}.bind(this,i))}return e},pushBackBattleFont:function(t){this.battle_pools.pushBackFont(t)},updateCurBattleData:function(e,i){this.deleteCurBattleData(),this.init_fight_status=i,null==this.battle_data&&(this.battle_data=new s),this.battle_data.updateData(e),this.saveSpeed(e.play_speed);for(var a=0;a<e.hallows_list.length;a++){var o=e.hallows_list[a];this.hallows_list[o.group]=o}var l=t("role_controller").getInstance().getRoleVo();for(var r in this.battle_data.fight_object_list){var c=this.battle_data.fight_object_list[r];if(Utils.getNorKey(c.owner_id,c.owner_srv_id)==Utils.getNorKey(l.rid,l.srv_id)&&0==this.my_group&&(this.my_group=c.group),c.hp>0&&(this.alive_num+=1),c.object_type==n.Unit_Type.Hallows){var _=this.hallows_list[c.group];_.pos=c.pos,c.hallows_val=_.val,c.hallows_max=_.max}}0==this.my_group&&(this.my_group=1)},addReadySum:function(){this.create_over_num+=1,this.create_over_num>=this.alive_num&&this.battle_controller.csReadyFightStart()},getAllObject:function(){return this.real_role_list},handleBattleSceneStatus:function(t){this.battle_scene&&this.battle_scene.changeVisible(t)},getFightStatus:function(){return this.is_real_combat},getBattleScene:function(){return this.battle_scene},isInRealBattle:function(){return this.is_real_combat},createBattleScene:function(e,i){this.combat_type==i&&this.cur_fight_type==e&&1!=e||(this.clearRealRole(),this.hook_model.clearRealRole()),this.combat_type=i,this.cur_fight_type=e,this.is_real_combat=e==n.Battle_In_Type.Real,null==this.battle_scene&&(this.battle_scene=Utils.createClass("battle_scene")),this.battle_scene.updateBattleScene(this.is_real_combat);var s=i==n.Fight_Type.Darma;this.openDramaFightUI(s),this.openFormViewUI(this.is_real_combat,i),this.battle_controller.setIsNormaBattle(this.is_real_combat),t("mainscene_controller").getInstance().handleSceneStatus(!1),this.is_clear=!1},openDramaFightUI:function(t){if(this.show_fight_ui_status!=t||this.fight_ui_combat!=this.is_real_combat){if(this.show_fight_ui_status=t,this.fight_ui_combat=this.is_real_combat,t){if(null==this.drama_fight_ui){this.drama_fight_ui=Utils.createClass("battle_button_list_panel");var e=ViewManager.getInstance().getSceneNode(SCENE_TAG.ui);this.drama_fight_ui.setParent(e),this.drama_fight_ui.show(this.is_real_combat),this.drama_fight_ui.setZIndex(-2)}else 0==this.drama_fight_ui.is_onshow?this.drama_fight_ui.show(this.is_real_combat):this.drama_fight_ui.changeBattleStatus(this.is_real_combat);this.button_list_panel_time=0}else this.drama_fight_ui&&(this.drama_fight_ui.hide(),this.button_list_panel_time=gcore.SmartSocket.getTime());this.battle_controller.setIsNormaBattle(this.is_real_combat),this.startCountDownToDelete()}},openFormViewUI:function(t,e){if(t){if(this.form_fight_ui)this.form_fight_ui.show(e);else{this.form_fight_ui=Utils.createClass("battle_form_panel");var i=ViewManager.getInstance().getSceneNode(SCENE_TAG.ui);this.form_fight_ui.setAnchorPoint(0,0),this.form_fight_ui.setPosition(.5*-i.width,.5*-i.height),this.form_fight_ui.setParent(i),this.form_fight_ui.show(e),this.form_fight_ui.setZIndex(-1)}this.form_panel_time=0}else this.form_fight_ui&&(this.form_fight_ui.hide(),this.form_panel_time=gcore.SmartSocket.getTime());this.startCountDownToDelete()},startCountDownToDelete:function(){0==this.form_panel_time&&0==this.button_list_panel_time?this.close_panel_timer&&(gcore.Timer.del(this.close_panel_timer),this.close_panel_timer=null):null==this.close_panel_timer&&(this.close_panel_timer=gcore.Timer.set(function(){this.waitDeletePanel()}.bind(this),1e3,-1))},waitDeletePanel:function(){if(0==this.form_panel_time&&0==this.button_list_panel_time)this.startCountDownToDelete();else{if(0!=this.button_list_panel_time)gcore.SmartSocket.getTime()-this.button_list_panel_time>100&&(this.drama_fight_ui&&(this.drama_fight_ui.deleteMe(),this.drama_fight_ui=null),this.button_list_panel_time=0);if(0!=this.form_panel_time)gcore.SmartSocket.getTime()-this.form_panel_time>100&&(this.form_fight_ui&&(this.form_fight_ui.deleteMe(),this.form_fight_ui=null),this.form_panel_time=0)}},getDramaFightUI:function(){return this.drama_fight_ui?this.drama_fight_ui.root_wnd:null},clearBattleScene:function(){if(this.battle_scene&&!this.is_clear){var t=this.getAllBattleRoleList();for(var e in t)gcore.Timer.del("attackerActTimeout"+e);this.combat_type=n.Fight_Type.Nil,this.cur_fight_type=n.Battle_In_Type.Nil,this.is_real_combat=!1,this.clearRealRole(),this.hook_model.clearRealRole(),this.battle_scene.deleteMe(),this.battle_scene=null,this.openDramaFightUI(!1),this.openFormViewUI(!1),this.cleanAllBattleEffect(),this.deleteCurBattleData(),Utils.playMusic(AUDIO_TYPE.SCENE,"s_002",!0),this.is_clear=!0}},cleanAllBattleEffect:function(){for(var t in this.battle_effect_list)for(var e=this.battle_effect_list[t],i=0;i<e.length;i++){e[i].deleEffect()}for(var t in this.battle_effect_list={},this.battle_effect_pool){e=this.battle_effect_pool[t];for(var s=0;s<e.length;s++){e[s].deleEffect()}}this.battle_effect_pool={}},mapMovescheduleUpdate:function(){this.battle_scene&&this.battle_scene.mapMovescheduleUpdate()},changeMoveMapStatus:function(t){this.battle_scene&&this.battle_scene.changeMoveMapStatus(t)},needPlayEnterAction:function(){return this.init_fight_status},isFriend:function(t){return t==this.my_group},getCurBattleData:function(){return this.battle_data},getCombatType:function(){return this.combat_type},deleteCurBattleData:function(){this.resetInitData()},checkIsCanChangeBattleSpeed:function(){if(null==this.battle_data)return!1;var e=1;1==this.battle_speed&&(e=2);var i=Config.combat_type_data.data_combat_speed[e];if(null==i)return!1;var s=t("role_controller").getInstance().getRoleVo();if(null==s)return!1;if(i.limit_lev>s.lev&&i.limit_vip_lev>s.vip_lev){var n=cc.js.formatStr(Utils.TI18N("\u7b49\u7ea7\u8fbe\u5230%s\u7ea7\u6216VIP%s\u5f00\u542f"),i.limit_lev,i.limit_vip_lev);return message(n),!1}var a=Config.combat_type_data.data_fight_list[this.battle_data.combat_type];return null!=a&&(1!=a.is_pvp||(message(cc.js.formatStr(Utils.TI18N("%s\u4e0d\u80fd\u66f4\u6539\u901f\u5ea6"),a.desc)),!1))},changeSpeed:function(){1==this.battle_speed?(this.saveSpeed(2),this.battle_controller.csFightSpeed(2)):(this.saveSpeed(1),this.battle_controller.csFightSpeed(1))},getTimeScale:function(){var t=1;return 1==this.isInRealBattle()&&(t=this.role_time_scale),t},setBattleTimeScale:function(t){if(this.battle_time_status!=t){this.battle_time_status=t;var e=null;(e=1==t?Config.battle_act_data.data_get_act_data.base_speed_scale:Config.battle_act_data.data_get_act_data.speed_scale)&&(this.role_time_scale=.01*e.val),this.setRoleTimeScale()}},setRoleTimeScale:function(){if(this.real_role_list)for(var t in this.real_role_list){var e=this.real_role_list[t];e&&e.setTimeScale(this.role_time_scale)}if(this.battle_effect_list)for(var t in this.battle_effect_list)for(var i=this.battle_effect_list[t],s=0;s<i.length;s++){var n=i[s];n&&n.setTimeScale(this.role_time_scale)}},saveSpeed:function(t){this.battle_speed!=t&&(this.battle_speed=t,this.form_fight_ui&&this.form_fight_ui.setSpeed(t))},getSpeed:function(){return this.battle_speed},actStart:function(t){1==this.checkoutIsRightFight(t)&&(t.wait_act+=1,gcore.Timer.del("attackerActTimeout"+t.pos),gcore.Timer.set(function(){this.actTimeout(t)}.bind(this),3e3,1,"attackerActTimeout"+t.pos))},actFinish:function(t){1==this.checkoutIsRightFight(t)&&t.wait_act>0&&(t.wait_act-=1,t.wait_act<=0&&(t.is_real?(this.playOrder(t),gcore.Timer.del("attackerActTimeout"+t.pos)):this.hook_model.playOrder(t)))},checkoutIsRightFight:function(t){if(1==t.is_real){if(this.battle_data&&this.cur_round_data&&this.battle_data.combat_type==this.cur_round_data.combat_type)return!0}else{var e=this.hook_model.getUnrealBattleData();if(e&&e.combat_type==n.Fight_Type.Darma)return!0}return!1},actTimeout:function(t){null!=t&&(t.wait_act=1,this.actFinish(t))},playRoundStart:function(t){if(null!=this.getBattleScene()&&null!=this.battle_data&&this.battle_data.combat_type==t.combat_type){if(this.is_play_round_start=!0,this.dealRoundBuff(t.round_buff),t&&t.hallows_list)for(var e=0;e<t.hallows_list.length;e++){var i=t.hallows_list[e];if(i){var s=this.hallows_list[i.group];if(s&&s.pos)(c=this.real_role_list[s.pos])&&c.setHallowsRound(i.val)}}if(t&&t.all_alive){for(var a={},o=0;o<t.all_alive.length;o++){var l=t.all_alive[o];l&&(a[l.pos]=!0)}for(var r in this.real_role_list){var c;if(!a[r])(c=this.real_role_list[r])&&!c.is_die&&c.role_data&&c.role_data.object_type!=n.Unit_Type.Hallows&&c.doDied()}}null==t||0==t.skill_plays.length?(this.battle_controller.csRoundFightEnd(),this.handlePlayRoundStart(t)):this.addRoundData(t),this.form_fight_ui&&this.form_fight_ui.updateRound(t.action_count)}},playRoundIn:function(t){this.is_play_round_start=!1,t.round_buff&&t.round_buff.length>0?this.act_after_buff_list=t.round_buff:this.act_after_buff_list=null,this.addRoundData(t)},setBuffsList:function(t){this.buffs=t},upDateNextMon:function(t){if(null!=this.real_role_list&&null!=t){for(var e in this.real_role_list){(n=this.real_role_list[e])&&1==n.is_die&&(n.deleteRole(),this.real_role_list[e]=null)}if(this.setBuffsList(t.buffs),this.getBattleScene())for(var i=0;i<t.objects.length;i++){var s=t.objects[i],n=this.real_role_list[s.pos];this.isFriend(s.group)&&n?n.updataNextBattleRole(s):this.createRole(s,!0,null,!0)}this.battle_data&&(this.battle_data.updateData(t),this.form_fight_ui&&this.form_fight_ui.updateBaseInfo())}},handlePlayRoundStart:function(t){null!=this.battle_data&&this.battle_data.combat_type==t.combat_type&&null!=this.battle_scene&&this.resetBattleRoleBaseInfo()},dealRoundBuff:function(t,e){if(null!=t&&0!=t.length)for(var i=0;i<t.length;i++){var s=t[i],n=this.real_role_list[s.target],a=Config.skill_data.data_get_buff[s.buff_bid];n&&a&&this.playRoundBuff(n,s,e)}},addRoundData:function(t){if(null!=this.getBattleScene()&&null!=this.battle_data&&this.battle_data.combat_type==t.combat_type){this.form_fight_ui&&t.action_count&&this.form_fight_ui.updateRound(t.action_count),this.cur_round=null,this.next_round=null,this.cur_round_data=t,this.skill_plays_order_list=[],this.round_data_temp={},this.form_fight_ui&&this.form_fight_ui.updateRound(t.action_count);for(var e=0;e<t.skill_plays.length;e++)for(var i=t.skill_plays[e],s=0;s<i.effect_play.length;s++){var n=i.effect_play[s];null==this.round_data_temp[i.order]&&(this.round_data_temp[i.order]=[],this.skill_plays_order_list.push({skill_order:i.order,priority:1e3*i.order+e})),n.skill_bid=n.skill_bid_of_effect,n.talk_pos=i.talk_pos,n.talk_content=i.talk_content,n.index=s,n.skill_order=i.order,n.priority=1e4*n.order+100*e+s,this.round_data_temp[i.order].push(n)}this.skill_plays_order_list.sort(function(t,e){return t.priority-e.priority}),this.preloadBattleRes(t,function(){this.analyseTempRoundData()}.bind(this))}},analyseTempRoundData:function(){if(this.order_list=[],this.round_data={},Object.keys(this.round_data_temp).length>0){for(var t=0;t<this.skill_plays_order_list.length;t++)for(var e=this.skill_plays_order_list[t],i=this.round_data_temp[e.skill_order],s=0;s<i.length;s++){var n=i[s];null==this.round_data[n.order]&&(this.round_data[n.order]={},this.order_list.push({order:n.order,priority:n.priority})),null==this.round_data[n.order][n.actor]&&(this.round_data[n.order][n.actor]={order:n.order,actor:n.actor,skill_bid:n.skill_bid,talk_content:n.talk_content,talk_pos:n.talk_pos,index:n.index,target_list:[]}),this.round_data[n.order][n.actor].target_list.push(n)}this.order_list.sort(function(t,e){return t.priority-e.priority}),this.round_data_temp={}}this.round()},round:function(){if(!(this.round_num&&this.round_num>0)){if(this.round_num=0,this.actor_sum=0,this.actor_play_sum=0,this.cur_round=null,this.next_round=null,this.battle_scene){var t=this.getAllBattleRoleList();for(var e in t){var i=t[e];i&&(i.dmg_index=0,i.dmg_aid_y_offset=0,i.is_hurt_play=!1,i.is_big_play=!1)}}if(0==this.order_list.length){if(this.cancleBlackScreen(),this.act_after_buff_list&&this.act_after_buff_list.length>0&&(this.dealRoundBuff(this.act_after_buff_list),this.act_after_buff_list=null),this.real_role_list)for(var e in this.real_role_list){var s=this.real_role_list[e];s&&(s.temp_skill_bid=0)}1==this.is_play_round_start?this.battle_controller.csRoundFightEnd():this.battle_controller.csSkillPlayEnd()}else{var n=this.order_list.shift(),a=this.round_data[n.order];if(this.order_list.length>0){var o=this.order_list[0].order,l=this.round_data[o];for(var r in l)if(null==this.next_round){this.next_round=l[r];break}}for(var r in this.round_num=Object.keys(a).length,a){this.round_num-=1;var c=a[r];if(null==this.cur_round&&(this.cur_round=c),c.target_list.length>0){var _=this.getBattleRoleByPos(c.actor);_?(this.actor_sum=this.actor_sum+1,this.initOrder(_,c)):this.round()}else this.round()}}}},playRoundBuff:function(t,e,i,s){null!=t&&null!=e&&(this.addBuff(i,t,e),1==e.change_type&&this.battleRoleHPChange(t,e.change_value,e.is_dead,s,!0))},battleRoleHPChange:function(t,e,i,s,n,a){null!=t&&(t.updateHP(e,i,!0,0),this.mutiHurtNum(t,e,s,n,a))},initOrder:function(t,e){e.target_list.sort(function(t,e){return t.priority-e.priority}),this.cur_round&&this.last_round_actor&&this.cur_round.actor==this.last_round_actor||(t.resetZOrder(),t.targe_zorder=9999);var i=e.target_list[0].target;i>GIRD_POS_OFFSET&&(i-=GIRD_POS_OFFSET);var s=Pos_To_Col[i-1],a=this.getBattleRoleByPos(i);if(a&&(a.resetZOrder(),t.targe_zorder=a.getLocalZOrder()),t.col=s,t.is_round=!1,t.attacker_info=e,t.skill_data=gdata("skill_data","data_get_skill",e.skill_bid),t.target_pos=t.grid_pos,t.play_order_index=e.target_list[0].effect_bid,this.calcTargetPos(t),null==t.play_order_index||0==t.play_order_index){this.actor_play_sum+=1;var o=e.target_list[0];return o&&(o.sub_effect_play_list&&o.sub_effect_play_list.length>0&&this.handleSubEffectPlaylist(o,t),this.dealRoundBuff(o.buff_list,t)),void this.round()}var l=gdata("skill_data","data_get_effect",t.play_order_index);l&&(t.play_order=Utils.deepCopy(l.action_list),t.shake_id=l.shake_id,t.effect_type=l.effect_type,t.play_stand=l.play_stand,t.anime_res=l.anime_res,t.split_hurt=l.split_hurt,t.hit_action=l.hit_action,t.effect_desc=l.effect_desc,t.is_must_die=l.is_must_die,t.anime_user_atk=l.anime_user_atk,t.attack_sound=l.attack_sound,t.ready_sound=l.ready_sound,t.shout_trick=l.shout_trick,t.hit_sound=l.hit_sound,t.hit_effect_list=Utils.deepCopy(this.getCurEffectList(l.hit_effect_list)),t.area_effect_list=Utils.deepCopy(this.getCurEffectList(l.area_effect_list)),t.act_effect_list=Utils.deepCopy(this.getCurEffectList(l.act_effect_list)),t.bact_effect_list=Utils.deepCopy(this.getCurEffectList(l.bact_effect_list)),t.trc_effect_list=Utils.deepCopy(this.getCurEffectList(l.trc_effect_list))),t.area_effect_list.length>0?(t.attacker_info.is_calc=!1,t.in_area_effect=!0,t.area_hit_num=1,t.area_hit_time=0):t.in_area_effect=!1;var r=function(){this.playOrder(t)}.bind(this),c=function(){var e=t.skill_data.type;e==n.Skill_Type.PASSIVE_SKILL&&1==t.skill_data.passive_skill_show?this.playFontMessage(t,t.skill_data.name,null,null,null,null,null,function(){r()}.bind(this)):e==n.Skill_Type.ACTIVE_SKILL?this.form_fight_ui&&this.form_fight_ui.showActiveSkillName(t,function(){r()}):r()}.bind(this);null==t.skill_data?this.talk(t,r):this.talk(t,c),this.act_playing=!0},calcTargetPos:function(t,e){if(null!=t&&null!=t.attacker_info){for(var i=t.attacker_info.target_list,s=null,n=0;n<i.length;n++){var a=i[n];if((s=e?e[a.target]:this.getBattleRoleByPos(a.target))&&s.obj_type!=t.obj_type)break}s&&(t.target_pos=s.grid_pos,t.target_pos_base=s.grid_pos,t.target_name=s.role_data.object_name)}},getCurEffectList:function(t){for(var e=[],i=0;i<t.length;i++){var s=t[i],n=Config.skill_data.data_get_effect_data[s];e.push(n)}return e},talk:function(t,e){var i=t.attacker_info.talk_content||"";t.attacker_info.talk_pos;e&&e()},singleAct:function(t,e){if(t instanceof Array)return this.mutiAct(t,e);var i=Utils.deepCopy(Config.skill_data.data_get_act_data[t]);if(i){var s=i.act_args,n=s[0];if(null==n||null==this[n])return;if(this[n]instanceof Function){var a=s[1]||[];return a.unshift(e),this[n].apply(this,a)}Log.info("\u52a8\u4f5c\u9519\u8bef,\u52a8\u4f5cBID:"+t)}},mutiAct:function(t,e){for(var i=[],s=0;s<t.length;s++){var n=t[s],a=this.singleAct(n,e);i.push(a)}return 1==i.length?i[0]:cc.spawn.apply(null,i)},callfun:function(t,e){var i="",s=null;if(e instanceof Array?(i=e[0],s=e[1]||[]):i=e,""!=i)if(this[i]instanceof Function)null==s&&(s=[]),s.unshift(t),this[i].apply(this,s);else if("number"==typeof i){var n=this.singleAct(i,t);t.runAction(n)}},attack:function(t,e,i,s,n){if(t&&t.anime_user_atk){e=e||0,n=1==n;var a=function(){this.callfun(t,s)}.bind(this),o=function(){this.callfun(t,i)}.bind(this);return this.skill_act.attack(t,e,t.anime_user_atk,o,a,n,null,t.anime_res)}},flyItem:function(t,e,i,s,n,a){if(0!=this.checkIsInBattle(t)){var o=t.trc_effect_list;if(null==o||0==o.length)return Log.info("\u64ad\u653e\u8fdc\u7a0b\u653b\u51fb\u6548\u679c\u5931\u8d25,\u4e0d\u5b58\u5728\u8fdc\u7a0b\u7684\u6548\u679c,\u6548\u679cid\u4e3a:  "+t.play_order_index),void this.actStart(t);var l=o[0],r=t.is_friend,c=l.res_up;1==r&&""!=l.spec_res_up&&(c=l.spec_res_up);var _=.001*l.scale,h=l.x_fix*t.obj_type,d=0==l.y_fix?50:l.y_fix,u=t.anime_user_atk||PlayerAction.action_2,m=function(){if(t.attacker_info.target_list.length<=1){var s=this.center_pos(t,d);return this.item(t,e,c,i,n,a,s,_,l.bid,h,d)}this.playSelfEffect();for(var o=[],r=t.attacker_info.target_list,u=0;u<r.length;u++){var m=r[u],f=this.getBattleRoleByPos(m.target);if(f){s={x:f.scene_pos.x,y:f.scene_pos.y+d};if(f.group!=t.group){var p=this.getItem(t,e,c,i,"hurtOne",a,s,_,l.bid,h,d);o.push(p)}}}cc.callFunc(function(){if(t.attacker_info.last_effect)for(var e=0;e<t.attacker_info.last_effect.length;e++){var i=t.attacker_info.last_effect[e];t.is_real?this.playMagic(t,i):this.hook_model.playMagic(t,i)}}.bind(this));if(o.length>0){var g=this.skill_act.normalStart(t),v=this.skill_act.normalFinish(t),b=cc.sequence(g,cc.spawn.apply(null,o),v);t.runAction(b)}}.bind(this);return this.skill_act.attack(t,e,u,null,null,!1,m,t.anime_res)}},fadeOut:function(t,e,i){return i=i||10,this.skill_act.fadeOut(t,e,i)},fadeIn:function(t,e,i){return i=i||1,this.skill_act.fadeIn(t,e,i)},playSelfEffect:function(t){if(null!=t&&null!=t.attacker_info&&null!=t.attacker_info.target_list){for(var e=[],i=null,s=0;s<t.attacker_info.target_list.length;s++){var n=t.attacker_info.target_list[s];(i=this.getBattleRoleByPos(n.target))&&t.group==i.group&&e.push(n)}t.attacker_info.effect_play=e,t.attacker_info.last_effect=e}},resetAttackerStandStatus:function(t){if(null!=this.battle_scene&&null!=t){var e=0;this.next_round&&(e=this.next_round.actor),this.cur_round&&(this.last_round_actor=this.cur_round.actor),(0==e||this.cur_round&&this.cur_round.actor!=e)&&(this.skill_act.setAnimation(t,PlayerAction.battle_stand,!0),this.cancleBlackScreen(),t.resetZOrder())}},item:function(t,e,i,s,n,a,o,l,r,c,_){if(null!=t&&null!=this.battle_scene){a=(a||0)*t.model_height*.01,s=s||10;var h=function(){this.callfun(t,n)}.bind(this);t.is_real?t.runAction(this.skill_act.flyItem(t,e,i,s,h,a,o,l,r,c,_)):h()}},getItem:function(t,e,i,s,n,a,o,l,r,c,_){a=a||60,s=s||10;var h=function(){this.callfun(t,n)}.bind(this);return this.skill_act.flyItem(t,e,i,s,h,a,o,l,r,c,_)},playOrder:function(t){if(null!=t&&(!t.wait_act||0==t.wait_act)&&null!=t.play_order_index&&0!=t.play_order_index)if(t.wait_act=0,null==t.play_order||0==t.play_order.length)this.actor_play_sum+=1,t.is_die||this.resetAttackerStandStatus(t),t.is_round||(this.act_playing=!1,this.actor_play_sum>=this.actor_sum&&this.round());else{var e=t.play_order.shift(),i=this.singleAct(e,t);i&&t.runAction(i)}},batchPlayHurt:function(t){if(null!=t&&null!=t.attacker_info&&null!=t.attacker_info.target_list){var e=t.attacker_info.target_list;if(0!=e.length)for(var i=!1,s=0;s<e.length;s++){var n=e[s];if(t.is_real){var a=!1;n.hp_changed&&n.hp_changed<0&&0==i&&(i=!0,a=!0),this.playMagic(t,n,a)}else this.hook_model.playMagic(t,n,a)}}},playFontMessage:function(t,e,i,s,n,a,o,l){if(0!=this.checkIsInBattle(t)){null==i&&(i=this.battle_scene.getBattleEffectLayer(1)),s=s||0,n=n||0;var r=t.scene_pos.x+s,c=t.scene_pos.y+n+t.model_height/2;null==a&&(a=217),null==o&&(o=218);var _=this.getNormalFont();_.setPosition(r,c);var h=_.getChildByName("font_label"),d=Config.color_data.data_color16[a],u=h.color;u.fromHEX(d),h.color=u;var m=Config.color_data.data_color16[o],f=h.getComponent(cc.LabelOutline),p=f.color;p.fromHEX(m),f.color=p,h.getComponent(cc.Label).string=e,i.addChild(_),null==t.buff_show_index&&(t.buff_show_index=0),t.buff_show_index=t.buff_show_index+1;var g=cc.show(),v=cc.delayTime(.3*t.buff_show_index),b=cc.callFunc(function(){t.buff_show_index-=1}.bind(this)),w=cc.scaleTo(.4,1.2),y=cc.moveBy(.4,0,50),C=cc.fadeIn(.4),k=cc.scaleTo(.6,.9),S=cc.fadeOut(.6),T=cc.moveBy(.6,0,25),I=cc.hide();_.runAction(cc.sequence(g,v,b,cc.spawn(w,y,C),cc.spawn(k,S,T),I,cc.callFunc(function(){l&&l(),this.pushBackBattleFont(_)}.bind(this))))}},playMagic:function(t,e,i){if(null!=this.battle_scene&&null!=e.target&&null!=t&&!(null!=e.play_num&&e.play_num<=0)){null==e.play_num&&t.split_hurt&&(e.play_num=t.split_hurt||1,e.play_num>1&&(e.avg_hp_changed=Math.ceil(e.hp_changed/e.play_num))),e.play_num=e.play_num||1,e.play_num-=1;var s=1,n=this.getBattleRoleByPos(e.target);if(n){if(0==e.is_hit||1==e.is_blind){s=0;var a=Utils.TI18N("\u95ea\u8eb2");1==e.is_blind&&(a=Utils.TI18N("\u672a\u547d\u4e2d")),0==e.is_dead&&this.playFontMessage(n,a,null,null,null,227,228)}var o=e.avg_hp_changed||e.hp_changed||0,l=Math.floor(o);1==e.is_crit&&(s=2);var r=e.is_dead;e.play_num>0&&(r=0),e.summon_list.length>0&&this.addRoleList(e.summon_list,t),e.sub_effect_play_list.length>0&&this.handleSubEffectPlaylist(e,t),this.handleExtendDungeon(e),0!=e.aid_actor&&this.handleAidActor(e,t,s,n),this.playBattleRoleHurt(t,n,l,i),""!=t.effect_desc&&0!=e.is_hit&&e.play_num<=0&&this.showbuffName(n,t.effect_desc,229,230,t.play_order_index),this.updateTargetHp(t,n,l,r,s,e),e.play_num<=0&&e.buff_list.length>0&&this.handleBufflist(t,e.buff_list,1)}}},playBattleRoleHurt:function(t,e,i,s){null!=t&&null!=e&&1!=e.is_hurt_play&&(e.is_hurt_play=!0,e.is_big_play||(e.is_big_play=!0,this.playHurtEffect(t,e)),t.pos!=e.pos&&i<0&&t.group!=e.group&&"no-hurt"!=t.hit_action&&this.skill_act.hurt(t,e,t.hit_action,s))},updateTargetHp:function(t,e,i,s,n,a){null!=e&&null!=t&&0!=i&&(n=n||1,this.mutiHurtNum(e,i,n,!1,a.camp_restrain),e.updateHP(i,s,!1,t.is_must_die))},mutiHurtNum:function(t,e,i,s,n){0!=this.checkIsInBattle(t)&&0!=e&&0!=t.is_real&&(null==t.dmg_index&&(t.dmg_index=0),t.dmg_index+=1,this.skill_act.playDmgMessage(t,e,i,s,n))},handleBufflist:function(t,e,i){if(0!=this.checkIsInBattle(t))for(var s=0;s<e.length;s++){var n=e[s],a=this.getBattleRoleByPos(n.target);a&&this.playRoundBuff(a,n,t,i)}},addBuff:function(t,e,i){if(null!=e&&null!=i){var s=Config.skill_data.data_get_buff[i.buff_bid];null!=s&&(1==s.is_passive&&this.playBuffEffect(t,e,i,s),4!=i.action_type&&(2==i.action_type?this.removeBuff(e,i,s):1!=s.is_passive&&3211!=s.group||1!=i.action_type&&3!=i.action_type||(3211!=s.group&&(s.buff_spine&&""!=s.buff_data&&e.changeSpine(!0,s.buff_spine,PlayerAction.battle_stand),3703==s.group&&e.setOpacity(!0,155)),1==i.action_type&&0!=i.remain_round&&e.updateBuffList(i,s))))}},removeBuff:function(t,e,i){if(null!=this.getBattleScene()&&null!=t&&(null!=e&&null!=i&&1==t.hadBuff(e.id))){t.removeBuffList(e.id),3703==i.group&&t.setOpacity(!1),i.buff_spine&&""!=i.buff_spine&&t.changeSpine(!1);var s=Config.skill_data.data_get_effect_data[i.res];s&&s.play_type==n.Effect_Play_Type.ROLE_SCENE&&this.removeSceneBuffEffect(t.group,s.bid),s&&this.removeBattleSpineEffect(t,s)}},addSceneBuffEffect:function(t,e,i,s){if(null!=t&&null!=e&&null!=i&&null!=s){var n=Utils.getNorKey(t,e);null==this.scene_buff_effect_list[n]&&(this.scene_buff_effect_list[n]={}),this.scene_buff_effect_list[n][i]&&this.delBattleEffect(this.scene_buff_effect_list[n][i]),this.scene_buff_effect_list[n][i]=s}},removeSceneBuffEffect:function(t,e){if(null==t||null==e){if(this.scene_buff_effect_list){for(var i in this.scene_buff_effect_list)for(var s in this.scene_buff_effect_list[i]){var n=this.scene_buff_effect_list[i][s];this.delBattleEffect(this.scene_buff_effect_list[i][n])}this.scene_buff_effect_list={}}}else{i=Utils.getNorKey(t,e);var a=this.scene_buff_effect_list[i];if(a)for(var i in a)this.delBattleEffect(a[i]);this.scene_buff_effect_list[i]=null}},removeBattleSpineEffect:function(t,e){if(null!=t&&null!=e){var i=PlayerAction.action;""!=e.up_action_name&&(i=e.up_action_name),t.delBattleEffect(e.res_up,i),i=PlayerAction.action,""!=e.down_action_name&&(i=e.down_action_name),t.delBattleEffect(e.res_down,i)}},playBuffEffect:function(t,e,i,s){if(null!=i&&null!=s){var a=null,o=null;if(""!=s.client_desc&&(1!=i.action_type&&4!=i.action_type||(1==s.positive_or_negative?(a=221,o=222):2==s.positive_or_negative?(a=223,o=224):3==s.positive_or_negative&&(a=225,o=226),this.showbuffName(e,s.client_desc,a,o,i.buff_bid))),null!=t){var l;if(!e.hadBuff(i.id)&&1==i.action_type&&0!=s.res)if(l=Config.skill_data.data_get_effect_data[s.res])if(l.play_type==n.Effect_Play_Type.ROLE_SCENE){var r=Utils.getNorKey(e.group,s.res);null!=this.scene_buff_effect_list[r]&&0!=Utils.next(this.scene_buff_effect_list[r])||this.effectArea(t,[l.res_up,l.res_down],0,null,l.play_type,l.x_fix,l.y_fix,s.res,l.is_col_effect,!1)}else this.effectSpineUser(t,1==s.is_release,l.x_fix*e.obj_type,l.y_fix,[l.res_up,l.res_down],e,1,null,s.bid,s.res);if(3==i.action_type&&0!=s.efftive_effect)(l=Config.skill_data.data_get_effect_data[s.efftive_effect])&&this.effectSpineUser(t,!0,l.x_fix*e.obj_type,l.y_fix,[l.res_up,l.res_down],e,1,null,s.bid,s.res)}}},showbuffName:function(t,e,i,s,n){if(null!=t&&null!=n&&!t.tips_list[n]){t.addTips(n);var a=function(){t.removeTips(n)}.bind(this);this.playFontMessage(t,e,null,null,null,i,s,a)}},addRoleList:function(t,e){null!=t&&t.length},handleSubEffectPlaylist:function(t,e){if(null!=t&&null!=t.sub_effect_play_list&&0!=t.sub_effect_play_list.length)for(var i=0;i<t.sub_effect_play_list.length;i++){var s=t.sub_effect_play_list[i],n=this.real_role_list[s.sub_target];if(n){if(this.battleRoleHPChange(n,s.sub_hp_changed,!1,1,!0),s.extra_effect&&s.extra_effect.length>0)for(var a=0;a<s.extra_effect.length;a++){var o=s.extra_effect[a];2==o.extra_key&&this.skill_act.playBuffAbsorbHurt(n,o.extra_param)}var l=gdata("skill_data","data_get_effect",s.sub_effect_id);l&&""!=l.effect_desc&&0!=s.sub_is_hit&&this.showbuffName(n,l.effect_desc,229,230,s.sub_effect_id);var r=gdata("skill_data","data_get_skill",s.sub_skill_id);r&&1==r.passive_skill_show&&this.showbuffName(n,r.name,217,218,s.sub_skill_id),0==s.sub_is_hit&&0==t.is_dead&&this.showbuffName(n,Utils.TI18N("\u8eb2\u95ea"),227,228,s.sub_effect_id)}}},handleExtendDungeon:function(t){null!=this.battle_data&&this.battle_data.combat_type==n.Fight_Type.GuildDun&&this.form_fight_ui&&this.form_fight_ui.addGuildBossUI(t.total_hurt)},handleAidActor:function(t,e,i,s){if(null!=t&&0!=t.aid_actor){var n=this.real_role_list[t.aid_actor];if(n){var a=t.actor_hp_changed,o=s.scene_pos,l=s.model_width*s.obj_type,r=t.camp_restrain;n.setLocalZOrder(s.getLocalZOrder()+1),n.setScenePos(cc.v2(o.x+l,o.y)),this.actStart(e),this.skill_act.aid_hurt(e,n,"hurt"),this.battleRoleHPChange(n,a,t.actor_is_dead,i,!1,r),this.playHurtEffect(e,n)}}},playHurtEffect:function(t,e){if(null!=this.battle_scene&&null!=t&&null!=t.hit_effect_list&&0!=t.hit_effect_list.length)for(var i=t.hit_effect_list,s=0;s<i.length;s++){var n=i[s];this.effectSpineUser(t,!0,n.x_fix*t.obj_type,n.y_fix,[n.res_up,n.res_down],e,.001*n.scale,null,n.bid)}},attackReady:function(t){if(null!=t&&null!=t.bact_effect_list&&0!=t.bact_effect_list.length){t.ready_sound&&""!=t.ready_sound&&1==t.is_real&&Utils.playEffectSound(AUDIO_TYPE.BATTLE,t.ready_sound);for(var e=t.bact_effect_list,i=0;i<e.length;i++){var s=e[i];s&&s.play_type==n.Effect_Play_Type.ROLE&&(""==s.res_up&&""==s.res_down||this.effectSpineUser(t,!0,s.x_fix*t.obj_type,s.y_fix,[s.res_up,s.res_down],t,.001*s.scale,null,s.bid))}}},effectSpineUser:function(t,e,i,s,a,o,l,r,c,_){_&&0!=_&&(c=_);var h=n.Battle_Type_Conf.TYPE_ROLE;t&&(h=t.obj_type),this.skill_act.effectSpineUser(t,e,i,s,a,o,l,r,c,h)},areaHurt:function(t){var e=function(){if(this.battle_scene){var e=this.getAllBattleRoleList();for(var i in e){var s=e[i];s&&(s.is_hurt_play=!1,s.is_big_play=!1)}}this.batchPlayHurt(t)}.bind(this);this.playSceneAreaEffect(t,e)},playSceneAreaEffect:function(t,e){if(null!=t&&null!=t.play_order_index&&null!=t.area_effect_list&&0!=t.area_effect_list.length)for(var i=t.area_effect_list,s=0;s<i.length;s++){var n=i[s];!n||""==n.res_down&&""==n.res_up||this.effectArea(t,[n.res_up,n.res_down],0,e,n.play_type,n.x_fix,n.y_fix,n.bid,n.is_col_effect)}},effectArea:function(t,e,i,s,a,o,l,r,c,_){i=i||0;var h=t.obj_type,d=t.is_friend,u=null;if(1==c){var m=(d?[{x:34,y:17},{x:34,y:23},{x:34,y:29}]:[{x:44,y:17},{x:44,y:23},{x:44,y:29}])[t.col];if(m){var f=this.skill_act.gridPosToScreenPos(m);u={x:f.x+o,y:f.y+l}}}else a==n.Effect_Play_Type.SCENE?u={x:.5*SCREEN_WIDTH,y:.5*SCREEN_HEIGHT}:a==n.Effect_Play_Type.ROLE_SCENE||a==n.Effect_Play_Type.ENEMY_SCENE?(o=t.obj_type*o,u=d?a==n.Effect_Play_Type.ROLE_SCENE?{x:22*SCREEN_WIDTH/100+o,y:1*SCREEN_HEIGHT/4+l}:{x:78*SCREEN_WIDTH/100+o,y:1*SCREEN_HEIGHT/4+l}:a==n.Effect_Play_Type.ENEMY_SCENE?{x:22*SCREEN_WIDTH/100+o,y:1*SCREEN_HEIGHT/4+l}:{x:78*SCREEN_WIDTH/100+o,y:1*SCREEN_HEIGHT/4+l}):u=this.center_pos(t);u&&(u.y=u.y+i,this.skill_act.effectArea(t,e,h,_,u,s,r))},center_pos:function(t,e){e=e||0;var i={x:0,y:0};if(this.battle_scene&&t&&t.attacker_info&&t.attacker_info.target_list&&t.attacker_info.target_list.length>0)for(var s=t.attacker_info.target_list,n=0;n<s.length;n++){var a=s[n],o=this.getBattleRoleByPos(a.target);if(o&&o.scene_pos){i.x=o.scene_pos.x,i.y=o.scene_pos.y+o.model_height*e*.01;break}}return i},actHurt:function(t,e){if(null!=t&&null!=t.attacker_info&&null!=t.attacker_info.target_list)for(var i=!1,s=0;s<t.attacker_info.target_list.length;s++){var n=t.attacker_info.target_list[s],a=!1;n.hp_changed&&n.hp_changed<0&&0==i&&(i=!0,a=!0),this.playMagic2(t,n,e,a)}},playMagic2:function(t,e,i,s){if(null!=t&&null!=e){var n=this.real_role_list[e.target];null!=n&&(1==i?n.is_big_play||(n.is_big_play=!0,this.playHurtEffect(t,n)):t.pos!=n.pos&&t.group!=n.group&&this.skill_act.hurt(t,n,PlayerAction.hurt,s))}},attackPoint:function(t){if(t&&""!=t.attack_sound&&1==t.is_real&&Utils.playEffectSound(AUDIO_TYPE.BATTLE,t.attack_sound),null!=t.act_effect_list&&0!=t.act_effect_list.length)for(var e=t.is_friend,i=t.act_effect_list,s=0;s<i.length;s++){var n=i[s],a=n.res_up;""!=n.spec_res_up&&1==e&&(a=n.spec_res_up),""==a&&""==n.res_down||this.effectSpineUser(t,!0,n.x_fix*t.obj_type,n.y_fix,[a,n.res_down],t,.001*n.scale,null,n.bid)}},hurt:function(t,e){if(null!=this.battle_scene&&null!=t&&0==t.area_effect_list.length){var i=t.in_area_effect?t.area_hit_num||1:t.hit_num,s=t.split_hurt||1;if(1==i||s>1);else{var n=e||this.getAllBattleRoleList();for(var a in n){var o=n[a];o&&(o.is_hurt_play=!1,o.is_big_play=!1)}}this.batchPlayHurt(t)}},hurtOne:function(t){0!=this.checkIsInBattle(t)&&(t.attacker_info.target_list.length>0&&(t.is_real?this.playMagic(t,t.attacker_info.target_list[0]):this.hook_model.playMagic(t,t.attacker_info.target_list[0])))},hideUI:function(t,e){if(t)return this.skill_act.hideUI(t,e)},noActAttack:function(t,e,i,s,n){if(this.getBattleScene()&&t){var a=function(){this.callfun(t,s)}.bind(this),o=function(){this.callfun(t,i)}.bind(this);return this.skill_act.noActAttack(t,e,o,a,n)}},showUI:function(t,e){if(t)return this.skill_act.showUI(t,e)},getBuffTag:function(t){if(null==t||null==t.buff_list||null==t.buff_list.length)return!1;for(var e=t.buff_list,i=0;i<e.length;i++){var s=e[i],n=Config.skill_data.data_get_buff[s.bid];if(n&&3108==n.group)return!0}return!1},moveBack:function(t,e,i,s,n,a,o,l,r,c){if(this.getBattleScene()&&t){var _=t.scene_pos,h=this.skill_act.move(t,_,e,i);t.runAction(h)}},moveToArea:function(t,e){if(this.getBattleScene()&&t&&e){var i=e.move_model_x*this.skill_act.gridSizeX(),s=e.move_model_y*this.skill_act.gridSizeY(),n={x:32*SCREEN_WIDTH/64+i*t.obj_type,y:11*SCREEN_HEIGHT/36+s},a=this.skill_act.move(t,n,e.move_delay_time,e.move_time);t.runAction(a)}},moveTo:function(t,e,i,s,n,a,o,l,r,c,_,h){if(this.getBattleScene()&&t){i=i||30,null==s&&(s=0),null==n&&(n=0);var d=1==_?-1:1,u=null,m=t.scene_pos;if(1==h){var f=(t.is_friend?[{x:34,y:17},{x:34,y:23},{x:34,y:29}]:[{x:44,y:17},{x:44,y:23},{x:44,y:29}])[t.col];if(f){var p=this.skill_act.gridPosToScreenPos(f);u={x:p.x+s,y:p.y+n}}}else u=s>0?{x:m.x+s*t.obj_type*d,y:m.y+n}:1==_&&t.target_pos_base?this.skill_act.gridPosToScreenPos({x:t.target_pos_base.x+s*t.obj_type*d,y:t.target_pos_base.y+n*t.obj_type*d}):this.skill_act.gridPosToScreenPos({x:t.target_pos.x+s*t.obj_type*d,y:t.target_pos.y+n});if(null!=r&&0!=r)return this.skill_act.move(t,u,e,i);var g=this.skill_act.move(t,u,e,i);t.runAction(g)}},checkIsInBattle:function(t){return null!=this.battle_scene&&null!=t},createRoleList:function(){var t=this.battle_data,e=this.needPlayEnterAction();for(var i in t.fight_object_list){var s=t.fight_object_list[i];this.createRole(s,e,!0,!0)}},createRole:function(t,e,i,s){if(null!=this.battle_scene&&null!=t&&0!=t.hp){var n=this.battle_scene.getBattleRoleLayer();if(null!=n&&null==this.real_role_list[t.pos]){var a=Utils.createClass("battle_role");a.createRole(n,t,e,i,s),this.real_role_list[t.pos]=a}}},resetBattleRoleBaseInfo:function(){for(var t in this.real_role_list){var e=this.real_role_list[t];e&&e.resetBaseInfo()}},clearRealRole:function(){if(0!=Object.keys(this.real_role_list).length){for(var t in this.real_role_list){gcore.Timer.del("attackerActTimeout"+t);var e=this.real_role_list[t];e&&(e.deleteRole(),e=null)}this.real_role_list={}}},getAllBattleRoleList:function(){return this.real_role_list},getBattleRoleByPos:function(t){if(this.real_role_list[t])return this.real_role_list[t]},blackScreen:function(t){},blackScreen2:function(t){},blackScreen3:function(t,e,i,s){null==i&&(i=15);var n=function(){this.battle_scene&&this.battle_scene.setBlack(!0,s),this.is_black=!0}.bind(this),a=function(){}.bind(this);return this.skill_act.blackScreen(t,e,i,n,a)},cancleBlackScreen:function(){this.is_black=!1,this.battle_scene&&this.battle_scene.setBlack(!1)},playShakeScreen:function(t){null!=t&&0!=t&&this.battle_scene&&this.battle_scene.shakeScreen(t)},hide:function(t){},show:function(t){},shadow:function(t){},getMainUICtrl:function(){return null==this.mainui_ctrl&&(this.mainui_ctrl=t("mainui_controller").getInstance()),this.mainui_ctrl},showWin:function(t,e){null!=t.show_panel_type&&null!=t.combat_type&&(1==t.show_panel_type?(t.combat_type==this.combat_type&&this.battle_controller.getWatchReplayStatus(),this.setBattleTimeScale(!0),this.showWinView(t)):t.combat_type==this.combat_type&&(1==e?this.clearView():(this.clearBattleScene(),gcore.GlobalEvent.fire(EventId.EXIT_FIGHT,t.combat_type))))},showWinView:function(t){null!=t&&this.battle_controller.openFinishView(!0,t.combat_type,t)},result:function(t,e){null!=t&&2==this.cur_fight_type&&this.combat_type==t.combat_type&&this.clearView()},clearView:function(){this.setBattleTimeScale(!0),1==this.battle_controller.getWatchReplayStatus()&&this.battle_controller.setWatchReplayStatus(!1),gcore.GlobalEvent.fire(EventId.EXIT_FIGHT,this.combat_type);var e=t("mainui_controller");this.combat_type==n.Fight_Type.Darma?e.getInstance().checkIsInDramaUIFight()&&this.battle_controller.send20060(n.Fight_Type.Darma):(1==this.battle_controller.getWatchReplayStatus()||this.combat_type==n.Fight_Type.PK||this.combat_type==n.Fight_Type.HeroTestWar)&&e.getInstance().checkIsInDramaUIFight()?this.battle_controller.send20060(n.Fight_Type.Darma):this.clearBattleScene()},playResourceCollect:function(t,e,i){this.drama_fight_ui&&this.drama_fight_ui.playResourceCollect(t,e,i)},getGroup:function(){return this.my_group},getCampIconConfigByIds:function(t){if(t&&null!=Utils.next(t)){if(1==t.length){var e=t[0];return Config.combat_halo_data.data_halo_icon[e]}var i=100*Math.min(t[0],t[1])+Math.max(t[0],t[1]);return Config.combat_halo_data.data_halo_icon[i]}},getEffectRes:function(t){},preloadBattleRes:function(t,e){var i={};for(var s in t.skill_plays){var n=t.skill_plays[s];for(var a in n.effect_play){var r=n.effect_play[a];if(r.effect_bid){var c=gdata("skill_data","data_get_effect",r.effect_bid);if(c){var _=this.real_role_list[r.actor],h=this.real_role_list[r.target];if(c.anime_res&&_){var d=_.getResPath(c.anime_res);d&&(i[d]=!0)}if(c.hit_action&&h&&"no-hurt"!=c.hit_action){var u=h.getResPath(c.hit_action);u&&(i[u]=!0)}for(var m in l){var f=Utils.deepCopy(this.getCurEffectList(c[l[m]]));for(var a in f){var p=f[a];if(p.res_up){var g=PlayerAction.action;i["spine/"+p.res_up+"/"+g]=!0}if(p.res_down){g=PlayerAction.action;i["spine/"+p.res_down+"/"+g]=!0}}}}}}}var v=0,b=0;for(var w in i)v++;for(var w in i){var y=w+".atlas";o.getInstance().preLoadRes(y,function(t,i){++b==v&&e&&e()}.bind(this,y))}0==v&&e&&e()}});e.exports=r,cc._RF.pop()},{battle_const:"battle_const",battle_controller:"battle_controller",battle_data:"battle_data",battle_effect:"battle_effect",battle_res_pool:"battle_res_pool",battle_role_pool:"battle_role_pool",loadermanager:"loadermanager",mainscene_controller:"mainscene_controller",mainui_controller:"mainui_controller",role_controller:"role_controller",skill_act:"skill_act"}],battle_mvp_window:[function(t,e,i){"use strict";cc._RF.push(e,"4df38kJPb9CAIn5r/BxCTI3","battle_mvp_window");var s=t("pathtool"),n=t("battle_const"),a=t("playerhead"),o=t("role_controller"),l=t("battle_controller"),r=t("battle_event"),c=t("common_scrollview"),_=t("battle_drama_hook_reward_list_panel");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("battle","battle_mvp_view"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Mini,this.data=arguments[0];var t=this.data;this.result=t.result,this.reward_list=t.item_rewards||{},this.fight_type=t.combat_type||n.Fight_Type.Darma,this.partner_bid=t.partner_bid||0,this.partner_hurt=t.partner_hurt||0,this.partner_total_hurt=t.partner_total_hurt||0,this.role_exp=t.exp||0,this.role_lv=t.lev||1,this.role_nowlv=t.new_lev||1,this.role_nowexp=t.new_exp||0,this.use_skin=t.use_skin||0},initConfig:function(){this.ani_isover=!1,this.item_list={},this.role_vo=o.getInstance().getRoleVo(),this.ctrl=l.getInstance(),this.model=this.ctrl.getModel()},openCallBack:function(){this.main_container=this.seekChild("container"),this.main_container.zIndex=1,this.containerSize=this.main_container.getContentSize(),this.background=this.root_wnd.getChildByName("background"),this.background.scale=FIT_SCALE,this.auto_combat_num_lb=this.seekChild(this.main_container,"auto_combat_num",cc.Label),this.auto_combat_num_lb.node.active=!1,this.seekChild("pic_mvp").zIndex=1,this.time_label_rt=this.seekChild(this.main_container,"time_label",cc.RichText),this.time_label_rt.string=Utils.TI18N("5\u79d2\u540e\u5173\u95ed"),this.time_label_rt.node.active=!1,this.comfirm_btn=this.seekChild(this.main_container,"comfirm_btn"),this.harm_btn=this.seekChild(this.main_container,"harm_btn"),this.data&&null!=Utils.next(this.data)?this.harm_btn.active=!0:this.harm_btn.active=!1,this.special_sk=this.seekChild(this.main_container,"play_effect",sp.Skeleton),this.progress_bg_nd=this.seekChild(this.main_container,"sprite_3"),this.sprite_4_nd=this.seekChild(this.main_container,"sprite_4"),this.progress_pb=this.seekChild(this.main_container,"sprite_3",cc.ProgressBar),this.progress_pb.progress=0,this.proTxt_lb=this.seekChild(this.main_container,"proTxt",cc.Label),this.progress_bg_nd.active=!1,Utils.delayRun(this.root_wnd,.3,function(){this.showProgressEffect()}.bind(this));var t=this.seekChild(this.main_container,"sprite_2");this.head_icon=new a,this.head_icon.setParent(t),this.head_icon.show(),this.head_icon.setScale(.8),this.head_icon.setPosition(0,0),this.head_icon.setHeadRes(this.role_vo.face_id),this.roleLvTxt_lb=this.seekChild(this.main_container,"roleLvTxt",cc.Label),this.roleLvTxt_lb.string=cc.js.formatStr("Lv.%d",this.role_nowlv);var e=Config.partner_data.data_partner_base[this.partner_bid],i=Config.partner_skin_data.data_skin_info[this.use_skin];this.mvp_con_nd=this.seekChild("mvp_con");var n=this.seekChild(this.mvp_con_nd,"pic_bg");if(this.bust_icon_sp=this.seekChild("bustIcon",cc.Sprite),n.zIndex=1,this.roleNameTxt_lb=this.seekChild(n,"roleNameTxt",cc.Label),e){this.roleNameTxt_lb.string=e.name;var o=null;o=i?i.bustid:e.bustid;var l=s.getPartnerBustRes(o);this.loadRes(l,function(t){this.bust_icon_sp.spriteFrame=t}.bind(this))}var r=this.seekChild(n,"hurtTxt",cc.Label),h=cc.js.formatStr("%s",Math.floor(this.partner_hurt/this.partner_total_hurt*100))+"%";r.string=cc.js.formatStr("%d(%s)",Math.ceil(Number(this.partner_hurt)),h),this.handleEffect(!0),this.scroll_con_nd=this.seekChild(this.main_container,"scroll_con");var d=this.scroll_con_nd.getContentSize(),u={item_class:_,start_x:94,space_x:20,start_y:0,space_y:0,item_width:120,item_height:180,row:1,col:4,need_dynamic:!0};this.scroll_view=new c,this.scroll_view.createScroll(this.scroll_con_nd,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,d,u,cc.v2(.5,.5)),this.rewardViewUI()},registerEvent:function(){Utils.onTouchEnd(this.comfirm_btn,function(){this.ani_isover&&this.ctrl.openFinishView(!1,this.fight_type)}.bind(this),1),Utils.onTouchEnd(this.harm_btn,function(){this.data&&null!=Utils.next(this.data)&&this.ctrl.openBattleHarmInfoView(!0,this.data)}.bind(this),1)},showProgressEffect:function(){var t=Config.role_data.data_role_attr[this.role_lv].exp_max,e=this.role_exp/t,i=this.role_nowexp/t;this.role_lv!=this.role_nowlv&&(i=1),this.data.auto_num&&this.data.auto_num>0&&(this.auto_combat_num_lb.node.active=!0,this.auto_combat_num_lb.string=cc.js.formatStr(Utils.TI18N("\u5df2\u8fde\u7eed\u901a\u8fc7\u5173\u5361\u6570\uff1a%s"),this.data.auto_num)),this.progress_pb.progress=e,this.proTxt_lb.string=cc.js.formatStr("%d/%d",Number(this.role_exp),Number(t)),this.progress_bg_nd.active=!0;var n=function(){if((e+=.01)>i)if(this.role_lv==this.role_nowlv)t=Config.role_data.data_role_attr[this.role_nowlv].exp_max,e=this.role_nowexp/t,this.progress_pb.progress=e,this.proTxt_lb.string=cc.js.formatStr("%d/%d",this.role_nowexp,Number(t)),gcore.Timer.del("mvp_progress_timer");else{if(null==this.progressEffect){this.progressEffect=this.seekChild(this.sprite_4_nd,"effect",sp.Skeleton);var n=cc.js.formatStr("spine/%s/action.atlas",s.getEffectRes(275));this.loadRes(n,function(t){this.progressEffect.skeletonData=t,this.progressEffect.setAnimation(0,PlayerAction.action,!1)}.bind(this))}else this.progressEffect.setAnimation(0,PlayerAction.action,!1);this.role_lv=this.role_lv+1,e=0,i=1,t=Config.role_data.data_role_attr[this.role_lv].exp_max,this.role_lv==this.role_nowlv&&(i=this.role_nowexp/Config.role_data.data_role_attr[this.role_nowlv].exp_max)}else this.progress_pb.progress=e,this.proTxt_lb.string=cc.js.formatStr("%d/%d",Math.ceil(t*e),Number(t))}.bind(this);gcore.Timer.set(n,10,-1,"mvp_progress_timer")},handleEffect:function(t){if(0==t)this.special_sk&&(this.special_sk.setToSetupPose(),this.special_sk.clearTracks(),this.special_sk.node.active=!1),this.progressEffect&&(this.progressEffect.setToSetupPose(),this.progressEffect.clearTracks(),this.progressEffect.node.active=!1);else if(this.special_sk){this.special_sk.node.active=!0;var e=cc.js.formatStr("spine/%s/action.atlas",s.getEffectRes(274));this.loadRes(e,function(t){this.special_sk.skeletonData=t,this.special_sk.setAnimation(1,PlayerAction.action_1,!1)}.bind(this))}},rewardViewUI:function(){this.reward_list&&(this.scroll_view.setData(this.reward_list,null,{is_show_name:!0}),Utils.delayRun(this.main_container,.5,function(){this.ani_isover=!0,this.updateTimer()}.bind(this)))},updateTimer:function(){this.time_label_rt.node.active=!0,this.comfirm_btn.active=!0;var t=5,e=function(){t-=1;var e=Math.ceil(t),i=e+Utils.TI18N("\u79d2\u540e\u5173\u95ed");this.time_label_rt&&(this.time_label_rt.string=i),e<=0&&(gcore.Timer.del("mvp_close_timer"),this.ctrl.openFinishView(!1,this.fight_type))}.bind(this);gcore.Timer.set(e,1e3,-1,"mvp_close_timer")},openRootWnd:function(){},closeCallBack:function(){this.root_wnd.stopAllActions(),this.main_container.stopAllActions(),gcore.Timer.del("mvp_close_timer"),gcore.Timer.del("mvp_progress_timer"),t("hero_controller").getInstance().openEquipTips(!1),t("tips_controller").getInstance().closeAllTips(),this.fight_type==n.Fight_Type.Darma&&gcore.GlobalEvent.fire(r.MOVE_DRAMA_EVENT,this.fight_type),this.handleEffect(!1),this.model.getBattleScene()&&this.ctrl.getIsSameBattleType(this.fight_type)&&this.model.result(this.data,null),this.scroll_view&&(this.scroll_view.deleteMe(),this.scroll_view=null),this.ctrl.openFinishView(!1,this.fight_type),gcore.Timer.set(function(){gcore.GlobalEvent.fire(r.CLOSE_RESULT_VIEW,this.fight_type)}.bind(this),200,1)}});cc._RF.pop()},{battle_const:"battle_const",battle_controller:"battle_controller",battle_drama_hook_reward_list_panel:"battle_drama_hook_reward_list_panel",battle_event:"battle_event",common_scrollview:"common_scrollview",hero_controller:"hero_controller",pathtool:"pathtool",playerhead:"playerhead",role_controller:"role_controller",tips_controller:"tips_controller"}],battle_pk_result_window:[function(t,e,i){"use strict";cc._RF.push(e,"3befaOXQQVBrIJviA2smGiw","battle_pk_result_window");var s=t("pathtool"),n=t("battle_controller"),a=t("role_controller"),o=t("chat_const"),l=t("battle_const");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("battle","battle_pk_result_view"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Tips,this.ctrl=n.getInstance()},initConfig:function(){},openCallBack:function(){Utils.playMusic(AUDIO_TYPE.BATTLE,"b_win"),this.background=this.root_wnd.getChildByName("background"),this.background.scale=FIT_SCALE,this.source_container=this.root_wnd.getChildByName("container"),this.title_container=this.source_container.getChildByName("title_container"),this.title_width=this.title_container.getContentSize().width,this.title_height=this.title_container.getContentSize().height,this.world_btn=this.source_container.getChildByName("world_btn"),this.guild_btn=this.source_container.getChildByName("guild_btn"),this.record_btn=this.source_container.getChildByName("record_btn"),this.play_effect=this.title_container.getChildByName("action").getComponent(sp.Skeleton),this.harm_btn=this.source_container.getChildByName("harm_btn"),this.harm_btn.active=!1},_onClickHarmBtn:function(){Utils.playButtonSound(1),this.data&&null!=Utils.next(this.data)&&this.ctrl.openBattleHarmInfoView(!0,this.data)},registerEvent:function(){var t=this;t.background.on("touchend",function(){Utils.playButtonSound(2),this.ctrl.openFinishView(!1,t.fight_type)},this),t.world_btn.on("click",function(){Utils.playButtonSound(1),t.data&&(t._is_cross?this.ctrl.on20034(t.data.replay_id,o.Channel.Cross,t.data.def_name,l.ShareType.SharePk):this.ctrl.on20034(t.data.replay_id,o.Channel.World,t.data.def_name,l.ShareType.SharePk)),this.ctrl.openFinishView(!1,t.fight_type)},this),t.guild_btn.on("click",function(){Utils.playButtonSound(1);var e=a.getInstance().getRoleVo();e&&0!=e.gid&&""!=e.gsrv_id?this.ctrl.on20034(t.data.replay_id,o.Channel.Gang,t.data.def_name,l.ShareType.SharePk):message("\u6682\u65e0\u516c\u4f1a")},this),t.record_btn.on("click",function(){Utils.playButtonSound(1),this.ctrl.openFinishView(!1,t.fight_type),t.data&&this.ctrl.csRecordBattle(t.data.replay_id)},this),this.harm_btn.on("click",this._onClickHarmBtn,this)},openRootWnd:function(t){this.setData(t),this.fight_type=t.combat_type},setData:function(t){t&&(this.data=t||{},this.handleEffect(!0),this.harm_btn.active=!0,this._is_cross=!1,t.is_province&&1==t.is_province&&(this._is_cross=!0,this.world_btn.getChildByName("Label").getComponent(cc.Label).string="\u90bb\u670d\u5206\u4eab"))},handleEffect:function(){var t,e;this.play_effect&&(1==this.data.result?(t=s.getEffectRes(103),this.play_effect.node.setPosition(0,this.title_height/2),e="action2"):(t=s.getEffectRes(104),this.play_effect.node.setPosition(0,this.title_height/2+40),e="action"),this.loadRes(s.getSpinePath(t,"action"),function(t){this.play_effect.skeletonData=t,this.play_effect.setAnimation(0,e,!1)}.bind(this)))},closeCallBack:function(){if(this.play_effect.skeletonData=null,this.ctrl.getModel().getBattleScene()&&this.ctrl.getIsSameBattleType(this.fight_type)){var t={combat_type:this.fight_type,result:this.result};this.ctrl.getModel().result(t,this.is_leave_self)}this.ctrl.openFinishView(!1,this.fight_type)}});cc._RF.pop()},{battle_const:"battle_const",battle_controller:"battle_controller",chat_const:"chat_const",pathtool:"pathtool",role_controller:"role_controller"}],battle_res_pool:[function(t,e,i){"use strict";cc._RF.push(e,"2ce03npZLpOF7g2NUPT++6l","battle_res_pool");var s=function(){this._loaddingRes={},this._finishRes={},this._rescounter={},this._delres={},this.mainloop_timer=gcore.Timer.set(function(){this.update(10)}.bind(this),1e4,-1),this._test_load={},this._test_del={}},n=s.prototype;n.preLoadRes=function(t,e){this.getRes(t,e,!0)},n.getRes=function(t,e,i){if(t&&e){if(this._delres[t]&&delete this._delres[t],this._finishRes[t])return e(this._finishRes[t]),void(i||(this._rescounter[t]||(this._rescounter[t]=0),this._rescounter[t]++));var s={};s.callback=e,s.is_pre=i,this._loaddingRes[t]&&this._loaddingRes[t].length>0?this._loaddingRes[t].push(s):(this._loaddingRes[t]=[],this._loaddingRes[t].push(s),LoaderManager.getInstance().loadRes(t,function(t,e){for(var i in this._finishRes[t]=e,this._loaddingRes[t]){var s=this._loaddingRes[t][i];s.callback&&s.callback(e),s.is_pre?(!this._rescounter[t]||this._rescounter[t]<=0)&&this.delRes(t):(this._rescounter[t]||(this._rescounter[t]=0),this._rescounter[t]++,this._delres[t]&&delete this._delres[t])}this._loaddingRes[t]=[]}.bind(this,t)))}},n.delRes=function(t){this._rescounter[t]&&this._rescounter[t]>0&&(this._rescounter[t]--,this._rescounter[t]<=0&&(this._delres[t]||(this._delres[t]=300),delete this._rescounter[t]))},n.update=function(t){for(var e in this._delres)this._delres[e]-=t,this._delres[e]<0&&(LoaderManager.getInstance().releaseRes(e),delete this._delres[e])},s.getInstance=function(){return s.instance||(s.instance=new s),s.instance},e.exports=s,cc._RF.pop()},{}],battle_result_window:[function(t,e,i){"use strict";cc._RF.push(e,"2b0b8TWOGVK0Is/Vu+yHGPS","battle_result_window");var s=t("pathtool"),n=t("battle_event"),a=t("battle_const");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("battle","battle_result_view"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Mini,this.result=arguments[0],this.fight_type=arguments[1]},initConfig:function(){this.ctrl=t("battle_controller").getInstance(),this.item_list={},this.model=this.ctrl.getModel()},openCallBack:function(){this.background=this.seekChild("background"),this.background.scale=FIT_SCALE,this.source_container=this.seekChild("container"),this.title_container=this.seekChild("title_container"),this.title_width=this.title_container.getContentSize().width,this.title_height=this.title_container.getContentSize().height,this.handleEffect(!0),this.time_lb=this.seekChild("time_lb",cc.Label),this.comfirm_btn=this.seekChild("comfirm_btn"),this.harm_btn=this.seekChild("harm_btn"),this.harm_btn.active=!1,this.scroll_view=this.seekChild("scroll_view"),this.scroll_content_nd=this.seekChild(this.scroll_view,"content")},registerEvent:function(){Utils.onTouchEnd(this.harm_btn,function(){this.data&&null!=Utils.next(this.data)&&this.ctrl.openBattleHarmInfoView(!0,this.data)}.bind(this),1),Utils.onTouchEnd(this.comfirm_btn,function(){this.ctrl.openFinishView(!1,this.fight_type)}.bind(this),1)},openRootWnd:function(t){this.setData(t.data,t.fight_type)},setData:function(t,e){t&&(this.data=t||{},this.fight_type=e,this.reward_list=this.data.item_rewards,this.result=this.data.result,this.is_guide=this.data.is_guide,this.rewardViewUI(),this.data&&this.data.hurt_statistics?this.harm_btn.active=!0:this.harm_btn.active=!1)},handleEffect:function(t){if(0==t)this.play_effect&&(this.play_effect.setToSetupPose(),this.play_effect.clearTracks());else if(null==this.play_effect){this.play_effect=this.title_container.getComponent(sp.Skeleton);var e=cc.js.formatStr("spine/%s/action.atlas",s.getEffectRes(103));this.loadRes(e,function(t){this.play_effect.skeletonData=t,this.play_effect.setAnimation(1,PlayerAction.action_2,!1)}.bind(this))}},rewardViewUI:function(){var t=this.reward_list.length;this.row=Math.ceil(t/4),this.space=30;var e=this.space+(this.space+119)*this.row;this.max_height=Math.max(e,210),this.scroll_content_nd.setContentSize(720,this.max_height),t>=4&&(t=4);var i=119*t+(t-1)*this.space;for(var s in this.start_x=.5*(720-i),1==this.row?this.start_y=.5*this.max_height:this.start_y=this.max_height-this.space-59.5,this.reward_list){var n=this.reward_list[s];if(null!=n.bid&&null!=n.num){var a=ItemsPool.getInstance().getItem("backpack_item");a.initConfig(!1,1,!1,!0,!0),a.setData({bid:n.bid,num:n.num});var o=this.start_x+59.5+s%4*(119+this.space),l=this.start_y-Math.floor(s/4)*(119+this.space);cc.log(o,l),a.setPosition(o,l),a.show(),a.setParent(this.scroll_content_nd),this.item_list[s]=a}}this.ItemAciton()},ItemAciton:function(){Utils.delayRun(this.source_container,.5,function(){this.updateTimer()}.bind(this))},updateTimer:function(){var t=5,e=function(){t-=1;var e=Math.ceil(t),i=e+Utils.TI18N("\u79d2\u540e\u5173\u95ed");this.time_lb&&(this.time_lb.string=i),e<=0&&(gcore.Timer.del("result_timer"),this.ctrl.openFinishView(!1,this.fight_type))}.bind(this);gcore.Timer.set(e,1e3,-1,"result_timer")},closeCallBack:function(){if(this.root_wnd.stopAllActions(),this.source_container.stopAllActions(),gcore.Timer.del("result_timer"),t("hero_controller").getInstance().openEquipTips(!1),t("tips_controller").getInstance().closeAllTips(),this.handleEffect(!1),this.model.getBattleScene()&&this.ctrl.getIsSameBattleType(this.fight_type)&&this.model.result(this.data,null),this.fight_type==a.Fight_Type.Darma&&gcore.GlobalEvent.fire(n.MOVE_DRAMA_EVENT,this.fight_type),this.item_list){for(var e in this.item_list){var i=this.item_list[e];i&&(i.deleteMe(),i=null)}this.item_list=null}this.ctrl.openFinishView(!1,this.fight_type),gcore.GlobalEvent.fire(n.CLOSE_RESULT_VIEW,this.fight_type)}});cc._RF.pop()},{battle_const:"battle_const",battle_controller:"battle_controller",battle_event:"battle_event",hero_controller:"hero_controller",pathtool:"pathtool",tips_controller:"tips_controller"}],battle_role_data:[function(t,e,i){"use strict";cc._RF.push(e,"a5bd97doiNHsJwkvRUCpdt9","battle_role_data");var s=cc.Class({extends:BaseClass,properties:{pos:0,group:0,owner_id:0,owner_srv_id:"",object_type:0,object_id:0,object_bid:0,object_name:"",is_awake:0,star:0,camp_type:0,sex:0,career:0,lev:0,hp:0,hp_max:0,face_id:0,round:0,skills:[],extra_data:[],hallows_val:0,hallows_max:0},updateData:function(t){for(var e in t)this.setBaseDataByKey(e,t[e])},setBaseDataByKey:function(t,e){this[t]!=e&&(this[t]=e)}});e.exports=s,cc._RF.pop()},{}],battle_role_pool:[function(t,e,i){"use strict";cc._RF.push(e,"a1aa6boItVC84F8MhXqHGe7","battle_role_pool");var s=cc.Class({extends:BaseClass,statics:{instance:null},initConfig:function(){this.realPools=new cc.NodePool,this.effectPools=new cc.NodePool,this.fontPools=new cc.NodePool,this.buffpools=new cc.NodePool,this.dmgPoolsList={}},getRealPools:function(){return this.realPools},pushBackRole:function(t){this.realPools.put(t)},getEffectPools:function(){return this.effectPools},pushBackEffect:function(t){this.effectPools.put(t)},getFontPools:function(){return this.fontPools},pushBackFont:function(t){this.fontPools.put(t)},getBuffPools:function(){return this.buffpools},pushBackBuffPools:function(t){this.buffpools.put(t)},getDmgPools:function(t){var e=this.dmgPoolsList[t];return null==e&&(e=new cc.NodePool,this.dmgPoolsList[t]=e),e},pushBackDmgPools:function(t,e){var i=this.dmgPoolsList[t];null==i&&(i=new cc.NodePool,this.dmgPoolsList[t]=i),i.put(e)}});s.getInstance=function(){return s.instance||(s.instance=new s,s.instance.initConfig()),s.instance},e.exports=s,cc._RF.pop()},{}],battle_role:[function(t,e,i){"use strict";cc._RF.push(e,"02f16IcbypK9beOp9b1Xx4L","battle_role");var s=t("battle_role_pool"),n=t("battle_res_pool"),a=t("loadermanager"),o=t("pathtool"),l=t("battle_const"),r=t("battle_effect");cc.Class({extends:BaseClass,properties:{skelon_cache:{default:{}}},ctor:function(){arguments&&arguments.length>0?this.is_next_offset=arguments[0]:this.is_next_offset=!1,this.initConfig()},initConfig:function(){this.role=null,this.parent=null,this.prefabPath=o.getPrefabPath("battle","battle_real_role"),this.role_data=null,this.top_off_y=45,this.is_real=!1,this.play_enter=!1,this.talk_back=!1,this.grid_pos=null,this.scene_pos=null,this.is_friend=!1,this.obj_type=0,this.model_height=120,this.model_width=60,this.pos=0,this.group=0,this.spine_name="",this.play_action_name="",this.is_round=!1,this.effect_list={},this.hp_show_status=!0,this.is_die=!1,this.role_cur_zorder=0,this.in_hurt_act=!1,this.need_play_die=!1;var e=t("battle_controller");this.model=e.getInstance().getModel(),this.hook_model=e.getInstance().getHookModel(),this.skill_act=t("skill_act"),this.wait_action_name=null,this.wait_res_name=null,this.wait_is_loop=null,this.tips_list={},this.buff_list={},this.buff_list_data={},this.buff_list_item={},this.action_call_list={},this.wait_add_effect_list={},this.resources_list={},this.dmg_index=0},createRole:function(t,e,i,n,o,l){this.parent=t,this.role_data=e,this.play_enter=!1,this.finish_cb=l,o||(this.play_enter=!1),this.talk_back=n||!1,this.is_real=o||!1,this.pos=e.pos,this.group=e.group;var r=s.getInstance().getRealPools(),c=null;r.size()>0?(c=r.get(),this.createRootWnd(c)):a.getInstance().loadRes(this.prefabPath,function(t){c=t,this.createRootWnd(c)}.bind(this))},resetInitStatus:function(){this.skeleton&&(this.skeleton.setToSetupPose(),this.skeleton.clearTracks())},createRootWnd:function(t){if(!!(this.parent&&this.parent.isValid&&t&&t.isValid)){if(this.role=t,this.parent&&this.parent.addChild(this.role),this.role_node=this.role.getChildByName("role_node"),this.container=this.role_node.getChildByName("container"),this.top_container=this.role_node.getChildByName("top_container"),this.shadow=this.role_node.getChildByName("shadow"),this.progress=this.top_container.getChildByName("hp").getComponent(cc.ProgressBar),this.level=this.top_container.getChildByName("level").getComponent(cc.Label),this.camp=this.top_container.getChildByName("camp").getComponent(cc.Sprite),this.buff_container=this.top_container.getChildByName("buff_container"),this.hallow_node=this.role.getChildByName("hallow_node"),this.round_progress=this.hallow_node.getChildByName("progress").getComponent(cc.ProgressBar),this.role_data.object_type==l.Unit_Type.Hallows?(this.spine=this.hallow_node.getChildByName("spine"),this.skeleton=this.spine.getComponent(sp.Skeleton),this.role_node.active=!1,this.hallow_node.active=!0,this.setHallowsRound(this.role_data.hallows_val,this.role_data.hallows_max)):(this.spine=this.container.getChildByName("spine"),this.skeleton=this.spine.getComponent(sp.Skeleton),this.effect=this.container.getChildByName("effect"),this.hallow_node.active=!1,this.role_node.active=!0,this.is_real?this.level.string=this.role_data.lev:this.role.active=!1),this.spine_zorder=this.spine.zIndex,this.skeleton_time_scale)this.skeleton.timeScale=this.skeleton_time_scale,this.setEffectScale(this.skeleton_time_scale),this.skeleton_time_scale=null;else{var e=this.model.getTimeScale();this.skeleton.timeScale=e,this.setEffectScale(e)}this.registerEvent(),this.resetInitStatus(),this.setGridPos(),this.instantModelRole(),this.setHP(0),this.checkEffectNeedAdd()}},setEffectScale:function(t){this.effect_skeleton},registerEvent:function(){this.skeleton.setCompleteListener(function(t,e){var i=t.animation?t.animation.name:"",s=this.action_call_list[i];s&&s.over&&(s.over(i),this.action_call_list[i]=null)}.bind(this)),this.skeleton.setEventListener(function(t,e){var i=t.animation?t.animation.name:"",s=this.action_call_list[i];s&&s.event&&s.event(e.data.name)}.bind(this))},setGridPos:function(){var t=!1;null!=this.role_data&&null!=this.role&&(t=1==this.is_real?this.model.isFriend(this.role_data.group):1==this.role_data.group,this.obj_type=t?l.Battle_Type_Conf.TYPE_ROLE:l.Battle_Type_Conf.TYPE_ENEMY,this.is_friend=t,0==this.is_friend?this.spine.scaleX=-1:this.spine.scaleX=1,this.grid_pos=this.skill_act.newPos2Gird(this.role_data.pos,t,this.role_data.group,this.is_real),this.scene_pos=this.skill_act.gridPosToScreenPos(this.grid_pos),this.role.setPosition(this.scene_pos),this.resetZOrder())},setScenePos:function(t){this.role.setPosition(t)},reverse:function(t){t=t||-1,this.rev_value!=t&&(this.rev_value=t,this.spine&&(this.spine.scaleX=t))},instantModelRole:function(){if(null!=this.role_data){var t=0,e="",i="",s=0;if(this.role_data.object_type==l.Unit_Type.Hero){var n=Utils.getNorKey(this.role_data.object_bid,this.role_data.star);(o=gdata("partner_data","data_partner_star",n))&&(e=o.res_id,i=o.fight_effect);var a=Config.partner_data.data_partner_base[this.role_data.object_bid];a&&(t=a.camp_type)}else if(this.role_data.object_type==l.Unit_Type.Hallows){(o=Config.hallows_data.data_base[this.role_data.object_bid])&&(e=o.c_res_id)}else{var o;(o=Utils.getUnitConfig(this.role_data.object_bid))&&(e=o.body_id,t=o.camp_type,i=o.fight_effect)}if(s=1==this.is_real?this.getBattleRoleExtendData(5):this.role_data.fashion,this.role_data.face_id=this.role_data.object_bid,0!=s){var r=Config.partner_skin_data.data_skin_info[s];r&&(e=r.res_id,this.role_data.face_id=r.head_id,""!=r.fight_effect&&""!=i&&(i=r.fight_effect))}if(""!=e){this.spine_name=e,this.is_real&&this.role_data.object_type!=l.Unit_Type.Hallows&&this.setCampIcon(t),""!=i&&this.createEncircleEffect(i);var c=Config.skill_data.data_get_model_data[e];c&&(this.model_height=c.model_height),this.top_container.y=this.model_height+this.top_off_y,this.play_enter?this.showEnterAction():this.is_real?this.doStand(function(){this.role.active=!0,this.setActive(!0)}.bind(this)):this.doRun(function(){this.is_real||(this.role.active=!0,this.finish_cb&&this.finish_cb()),this.setActive(!0),this.role_data.group==l.Group_Type.Enemgy&&this.playUnrealEnterAction()}.bind(this))}}},getBattleRoleExtendData:function(t){if(null==this.role_data)return 0;for(var e=0;e<this.role_data.extra_data.length;e++){var i=this.role_data.extra_data[e];if(i.extra_key==t)return i.extra_value}return 0},setHallowsRound:function(t,e){if(null!=this.role_data&&this.role_data.object_type==l.Unit_Type.Hallows)if(0==t||null==t)this.round_progress.progress=0;else{0!=e&&null!=e||(e=3);var i=Math.min(1,Math.max(t/e));this.round_progress.progress=i}},showEnterAction:function(){if(this.role_data&&this.role_data.object_type==l.Unit_Type.Hallows)this.doStand();else{var t=this.scene_pos.x,e=.25*SCREEN_WIDTH,i=null;1==this.is_friend?(t-=e,i=cc.moveTo(.5,this.scene_pos.x,this.scene_pos.y)):(t+=e,i=cc.moveTo(.5,this.scene_pos.x,this.scene_pos.y)),this.doRun(),this.role.x=t,this.role.runAction(cc.sequence(i,cc.callFunc(function(){this.doStand()}.bind(this))))}},setCampIcon:function(t){var e=o.getBattleCampIconByType(t);this.loadRes(e,function(t,e){t.spriteFrame=e}.bind(this),this.camp)},playUnrealEnterAction:function(){if(null!=this.role){this.clearNextActTimer(),this.clearNextCallTimer();var t=1.1*SCREEN_WIDTH;this.is_next_offset&&(t=1.2*SCREEN_WIDTH),this.role.x=t;var e=function(){}.bind(this);null==this.next_call_mon_timer&&(this.next_call_mon_timer=gcore.Timer.set(function(){e()}.bind(this),280,1));var i=BattleLoop.play(this.pos);if(i){cc.log("\u5f00\u59cb\u51c6\u5907\u5047\u6218\u6597");var s=this.hook_model.getSkillPlayData(i.actor);null!=s&&0!=s.length||this.hook_model.handleSkillPlayData(i,function(e){cc.log("\u5f00\u59cb\u8fdb\u884c\u5047\u6218\u65970");var i=1590-this.hook_model.getFinalMoveTime();this.next_ack_mon_timer||(this.next_ack_mon_timer=gcore.Timer.set(function(){cc.log("\u51c6\u5907\u653b\u51fb1"),e&&e(),this.clearNextActTimer()}.bind(this),i,1));var s=this.skill_act.gridPosToScreenPos(NormalPosGridRight[0]).x-t;this.role.stopAllActions();var n=cc.moveBy(2,s,0);this.is_real||this.role_data.group!=l.Group_Type.Enemgy||this.role.runAction(n)}.bind(this)),this.hook_model.updateActorPlaysList(i)}}},clearNextActTimer:function(){this.next_ack_mon_timer&&(gcore.Timer.del(this.next_ack_mon_timer),this.next_ack_mon_timer=null)},clearNextCallTimer:function(){this.next_call_mon_timer&&(gcore.Timer.del(this.next_call_mon_timer),this.next_call_mon_timer=null)},doRun:function(t){this.playActionOnce(PlayerAction.run,null,null,null,t)},doStand:function(t){this.playActionOnce(PlayerAction.battle_stand,null,null,null,t),1==this.talk_back&&(this.talk_back=!1,this.model.addReadySum())},setAnimationActionFunc:function(t,e,i){null!=i&&(null==this.action_call_list[i]&&(this.action_call_list[i]={over:null,event:null}),this.action_call_list[i].over=e,this.action_call_list[i].event=t)},playActionOnce:function(t,e,i,s,a){if(e=e||t,null==i&&(i=!0),this.play_action_res!=e){this.play_action_res=e;var l=o.getSpinePath(this.spine_name,e);cc.log("skeleton_path===",l),cc.log("action_name===",t),this.skelon_cache[l]?(this.play_action_name=t,this.skeleton.skeletonData=this.skelon_cache[l],this.skeleton.setToSetupPose(),this.skeleton.setAnimation(0,t,i),a&&a()):n.getInstance().getRes(l,function(e,s){this.play_action_name=t,this.skeleton.skeletonData=s,this.skeleton.setAnimation(0,t,i),this.skelon_cache[l]||(this.skelon_cache[l]=s),e&&e()}.bind(this,a))}else this.play_action_name!=t&&(this.play_action_name=t,this.skeleton.setToSetupPose(),this.skeleton.setAnimation(0,t,i))},resetBaseInfo:function(){this.playActionOnce(PlayerAction.battle_stand),this.role.setPosition(this.scene_pos),this.resetZOrder(),this.reverse(this.obj_type)},resetZOrder:function(){if(null!=this.role_data&&null!=this.role)if(this.role_base_zorder)this.role_cur_zorder!=this.role_base_zorder&&(this.role_cur_zorder=this.role_base_zorder,this.role.zIndex=this.role_base_zorder);else{var t=0,e=this.role_data.group-1,i=this.role_data.pos-1;t=this.role_data.group==l.Group_Type.Enemgy?BattleRoleZorder[e][i-GIRD_POS_OFFSET]:BattleRoleZorder[e][i],this.role_base_zorder=t,this.role_cur_zorder=t,this.role.zIndex=t}},setLocalZOrder:function(t){this.role_cur_zorder!=t&&(this.role_cur_zorder=t,this.role&&(this.role.zIndex=t))},getLocalZOrder:function(){return this.role_cur_zorder||0},runAction:function(t){this.role&&t&&this.role.runAction(t)},addBattleEfffect:function(t,e,i,s,n,a){if(null==this.container)return null==this.wait_add_effect_list[i]&&(this.wait_add_effect_list[i]={}),void(null==this.wait_add_effect_list[i][s]&&(this.wait_add_effect_list[i][s]={fix:t,fiy:e,effect_id:i,action_name:s,index:n}));null==a&&(a=this.obj_type),null==this.effect_list[i]&&(this.effect_list[i]={}),null==this.effect_list[i][s]&&(this.effect_list[i][s]={num:1,object:null});var o=this.effect_list[i][s];null==o.object?(o.object=new r,o.object.createEffect(this.container,cc.v2(t,e),a,i)):(o.num+=1,o.num>0&&o.object.setActiveEffect(!0));var l=this.spine_zorder+1;return 1==n&&(l=this.spine_zorder-1),o.object.setLocalZOrder(l),o},checkEffectNeedAdd:function(){for(var t in this.wait_add_effect_list)for(var e in this.wait_add_effect_list[t]){var i=this.wait_add_effect_list[t][e];i&&i.effect_id&&this.addBattleEfffect(i.fix,i.fiy,i.effect_id,i.action_name,i.index)}this.wait_add_effect_list={}},delBattleEffect:function(t,e,i){if(this.wait_add_effect_list[t]&&null!=this.wait_add_effect_list[t][e]&&(this.wait_add_effect_list[t][e]=null),null!=this.effect_list[t]){var s=this.effect_list[t][e];null!=s&&(s.num-=1,s.num<=0&&s.object.setActiveEffect(!1))}},showHpRoot:function(t){0!=this.is_real&&this.hp_show_status!=t&&(this.hp_show_status=t,this.top_container&&(this.top_container.active=t))},updateHP:function(t,e,i,s){null!=this.role_data&&null!=this.top_container&&(this.role_data&&this.role_data.object_type==l.Unit_Type.Hallows||(this.setHP(t),null==i&&(i=!1),1==e&&0==s?0==this.is_die&&this.died():1==this.is_die&&0==i&&this.relive()))},relive:function(){if(0!=this.is_die){this.is_die=!1,this.resetBaseInfo(),this.showHpRoot(!0),this.setActive(!0);var t=this.role_data.hp,e=Math.min(1,Math.max(t/this.role_data.hp_max));this.progress.progress=e}},doDied:function(){1!=this.is_die&&(this.is_die=!0,this.showHpRoot(!1),this.setActive(!1),this.clearAllEffect())},died:function(){if(1!=this.in_hurt_act){if(null!=this.role&&1!=this.is_die){this.is_die=!0;var t=cc.blink(.25,2),e=cc.fadeOut(.25),i=cc.callFunc(function(){this.showHpRoot(!1),this.is_act_die=!0,this.setActive(!1),0==this.is_real&&(this.assetJumpTo(),this.hook_model.playEnd(this.pos),this.hook_model.updateNextRoundData())}.bind(this)),s=cc.sequence(cc.delayTime(.25),t,e,i);this.runAction(s),this.clearAllEffect(!1),this.removeBuffItemRes(),this.removeBuffList()}}else this.need_play_die=!0},setActive:function(t){1==this.is_real?this.top_container.active=t:this.top_container.active=!1,this.role.opacity=255,this.shadow.active=t,this.skeleton.markForRender(t),this.effect&&(this.effect.active=t)},checkIsDied:function(){1==this.need_play_die?(this.need_play_die=!1,this.died()):this.doStand()},setHP:function(t){if(null!=this.role_data){var e=0;e=t<=0?Math.max(0,t+this.role_data.hp):Math.min(this.role_data.hp_max,t+this.role_data.hp),this.role_data.hp=e;var i=Math.min(1,Math.max(e/this.role_data.hp_max));this.progress.progress=i}},updataNextBattleRole:function(t){if(this.role_data)if(this.role_data.updateData(t),this.clearAllEffect(!1),this.role_data.hp<=0)this.died();else{var e=Math.min(1,Math.max(this.role_data.hp/this.role_data.hp_max));this.progress.progress=e}},changeSpine:function(t,e,i){},assetJumpTo:function(){var t=this.role.convertToWorldSpaceAR(cc.v2(0,0));this.model.playResourceCollect(t.x,t.y+.5*this.model_height,this.pos)},setOpacity:function(t,e){},updateBuffList:function(t,e){if(null!=t&&null!=e){this.buff_list[t.id]=null,this.buff_list[t.id]={buff:t,config:e,res_id:e.icon};var i={},s=e.icon;if(0!=s){var n=this.buff_list_data[s];null==n&&(n={res_id:s,num:0,list:[]},this.buff_list_data[s]=n),0==n.num||e.join_type&&3!=e.join_type?(n.num+=1,e.group&&(i[e.group]=!0)):e.join_type&&3==e.join_type&&e.group&&!i[e.group]&&(i[e.group]=!0,n.num+=1),n.list.push(t.id);var a=[];for(var l in this.buff_list_data){(_=this.buff_list_data[l])&&a.push(_)}if(a.length>0){a.sort(Utils.tableLowerSorter(["res_id"]));for(var r=Math.min(3,a.length),c=0;c<r;c++){var _=a[c],h=this.buff_list_item[_.res_id];null==h&&(h=this.createBuffItem(),this.buff_list_item[_.res_id]=h),h.label.string=_.num,h.node.x=22*c;var d=o.getBuffRes(_.res_id);h.path!=d&&(h.path=d,this.loadRes(d,function(t,e){t.spriteFrame=e}.bind(this),h.icon))}}}}},removeBuffList:function(t){if(null==t){for(var e in this.buff_list={},this.buff_list_data={},this.buff_list_item){(i=this.buff_list_item[e])&&i.node&&s.getInstance().pushBackBuffPools(i.node)}this.buff_list_item={}}else{var i,n=this.buff_list[t];if(n)if(i=this.buff_list_item[n.res_id]){var a=this.buff_list_data[n.res_id];if(a){a.num-=1;for(var o=0;o<a.list.length;o++){if(a.list[o]==t){a.list.splice(o,1);break}}a.num<=0?(i.icon.spriteFrame=null,s.getInstance().pushBackBuffPools(i.node),this.buff_list_item[n.res_id]=null,this.buff_list_data[n.res_id]=null,this.resetBuffPostion()):i.label.string=a.num}}this.buff_list[t]=null}},removeBuffItemRes:function(){for(var t in this.buff_list_item){var e=this.buff_list_item[t];e&&e.icon&&(e.icon.spriteFrame=null)}},createEncircleEffect:function(t){if(this.encircle_effect!=t){null==this.effect_skeleton&&(this.effect_skeleton=this.effect.addComponent(sp.Skeleton)),this.encircle_effect=t;var e=o.getSpinePath(t);this.loadRes(e,function(t,e){t.skeletonData=e,t.setAnimation(0,PlayerAction.action,!0),t.enabled=!0}.bind(this),this.effect_skeleton)}},createBuffItem:function(){var t=s.getInstance().getBuffPools(),e={node:null,label:null,icon:null,path:""},i=null,n=null,a=null;if(t.size()>0)n=(i=t.get()).getChildByName("font_label").getComponent(cc.Label),a=i.getChildByName("icon_sprite").getComponent(cc.Sprite);else{(i=new cc.Node).setAnchorPoint(0,.5),i.width=20,i.height=20;var o=new cc.Node;o.setAnchorPoint(0,.5),o.name="icon_sprite",i.addChild(o),a=o.addComponent(cc.Sprite);var l=new cc.Node;l.color=new cc.Color(cc.Color.WHITE),l.setAnchorPoint(1,.5),l.x=20,l.y=-3,l.name="font_label",i.addChild(l),(n=l.addComponent(cc.Label)).lineHeight=14,n.fontSize=14,n.horizontalAlign=cc.macro.TextAlignment.RIGHT,l.addComponent(cc.LabelOutline).color=new cc.Color(cc.Color.BLACK)}return this.buff_container.addChild(i),e.node=i,e.label=n,e.icon=a,e},resetBuffPostion:function(){if(this.buff_list_item){var t=[];for(var e in this.buff_list_item)this.buff_list_item[e]&&t.push({res_id:e,object:this.buff_list_item[e]});if(t.length>0){t.sort(Utils.tableLowerSorter(["res_id"]));for(var i=0;i<t.length;i++){var s=t[i];s&&s.object&&s.object.node&&(s.object.node.x=22*i)}}}},hadBuff:function(t){return this.buff_list&&null!=this.buff_list[t]},getRoleData:function(){return this.role_data},addTips:function(t){this.tips_list[t]=!0},removeTips:function(t){this.tips_list[t]=!1},loadRes:function(t,e,i){if(null!=t&&""!=t&&null!=e){var s=this.resources_list[t];s?e(i,s):a.getInstance().loadRes(t,function(i,s){null==this.resources_list[t]&&(this.resources_list[t]=s),e(i,s)}.bind(this,i))}},setTimeScale:function(t){if(null==this.skeleton||null==this.skeleton.skeletonData)this.skeleton_time_scale=t;else{if(this.skeleton_timeScale==t)return;for(var e in this.skeleton_timeScale=t,this.skeleton.timeScale=t,this.setEffectScale(t),this.effect_list){var i=this.effect_list[e];for(var s in i){var n=i[s];n&&n.object&&n.object.setTimeScale(t)}}}},showTalkBubble:function(t){},clearAllEffect:function(t){for(var e in this.effect_list){var i=this.effect_list[e];for(var s in i){var n=i[s];n&&n.object&&n.object.deleEffect()}}1==t?(this.effect_list=null,this.wait_add_effect_list=null):(this.effect_list={},this.wait_add_effect_list={})},deleteRole:function(){for(var t in this.role&&this.role.stopAllActions(),this.clearAllEffect(!0),this.clearNextActTimer(),this.clearNextCallTimer(),this.removeBuffItemRes(),this.effect_skeleton&&(this.effect_skeleton.enabled=!1),this.camp&&(this.camp.spriteFrame=null),this.action_call_list={},this.tips_list={},this.skelon_cache)n.getInstance().delRes(t);for(var e in this.resources_list)a.getInstance().releaseRes(e);this.skelon_cache={},this.removeBuffList(),s.getInstance().pushBackRole(this.role)},getResPath:function(t){return"spine/"+this.spine_name+"/"+this.spine_name}});cc._RF.pop()},{battle_const:"battle_const",battle_controller:"battle_controller",battle_effect:"battle_effect",battle_res_pool:"battle_res_pool",battle_role_pool:"battle_role_pool",loadermanager:"loadermanager",pathtool:"pathtool",skill_act:"skill_act"}],battle_scene:[function(t,e,i){"use strict";cc._RF.push(e,"fae59zxS/NOQYmCXYS0lKcJ","battle_scene");var s=t("battle_const"),n=t("loadermanager"),a=t("pathtool"),o=t("adventure_controller");cc.Class({extends:BaseClass,ctor:function(){this.initConfig(),this.createRootWnd(),this.registerEvent()},initConfig:function(){this.battle_controller=t("battle_controller").getInstance(),this.battle_model=this.battle_controller.getModel(),this.battle_hook_model=this.battle_controller.getHookModel(),this.battle_drama_model=t("battle_drama_controller").getInstance().getModel(),this.main_size=cc.size(SCREEN_WIDTH,SCREEN_HEIGHT),this.flayer_init_y=716,this.map_init_y=260,this.slayer_init_y=0,this.battle_res_id=0,this.need_run_map=!0,this.f_speed=.4,this.bg_speed=2,this.combat_type=s.Fight_Type.Nil,this.real_role_list={},this.resources_list={}},setVisible:function(t){this.root&&(this.root.active=t)},changeVisible:function(t){this.root&&(this.root.x=t?0:1e4)},createRootWnd:function(){this.root=new cc.Node("base_root"),this.root.setAnchorPoint(.5,.5),this.root.setContentSize(this.main_size),this.root.setPosition(0,0),ViewManager.getInstance().addToSceneNode(this.root,SCENE_TAG.battle);var t=cc.size(SCREEN_WIDTH*FIT_SCALE,SCREEN_HEIGHT);this.main_layer=new cc.Node,this.main_layer.setContentSize(t),this.main_layer.setAnchorPoint(.5,.5),this.main_layer.setPosition(0,0),this.root.addChild(this.main_layer),this.map_fLayer=new cc.Node,this.map_fLayer.y=.5*-t.height+this.flayer_init_y,this.map_fLayer.x=.5*-t.width,this.map_fLayer.setAnchorPoint(0,0),this.map_fLayer.scale=FIT_SCALE,this.main_layer.addChild(this.map_fLayer,BATTLE_VIEW_BLACK_LAYER_Z0),this.map_sLayer=new cc.Node,this.map_sLayer.setName("map_sLayer"),this.map_sLayer.setAnchorPoint(0,0),this.map_sLayer.setPosition(.5*-t.width,.5*-t.height*FIT_SCALE),this.map_sLayer.scale=FIT_SCALE,this.main_layer.addChild(this.map_sLayer,BATTLE_VIEW_BLACK_LAYER_Z0+1),this.map_oLayer=new cc.Node,this.map_oLayer.setName("map_oLayer"),this.map_oLayer.setAnchorPoint(0,0),this.map_oLayer.setPosition(.5*-t.width,.5*-t.height*FIT_SCALE),this.map_oLayer.scale=1.43*FIT_SCALE,this.main_layer.addChild(this.map_oLayer,BATTLE_VIEW_BLACK_LAYER_Z0+1),this.battle_layer=new cc.Node,this.battle_layer.setName("battle_layer"),this.battle_layer.setAnchorPoint(0,0),this.battle_layer.setPosition(.5*-SCREEN_WIDTH,.5*-SCREEN_HEIGHT),this.main_layer.addChild(this.battle_layer,BATTLE_VIEW_BLACK_LAYER_Z0+1),this.effect_layer_1=new cc.Node,this.effect_layer_1.y=this.map_init_y,this.effect_layer_1.setAnchorPoint(0,0),this.battle_layer.addChild(this.effect_layer_1,BATTLE_VIEW_ROLE_LAYER_Z+1),this.effect_layer_2=new cc.Node,this.effect_layer_2.y=this.map_init_y,this.effect_layer_2.setAnchorPoint(0,0),this.battle_layer.addChild(this.effect_layer_2,BATTLE_VIEW_ROLE_LAYER_Z-1),this.role_layer=new cc.Node,this.role_layer.y=this.map_init_y,this.role_layer.setAnchorPoint(0,0),this.battle_layer.addChild(this.role_layer,BATTLE_VIEW_ROLE_LAYER_Z)},registerEvent:function(){},updateBattleScene:function(t){(this.is_real_fight=t,this.changeBattleScene(t),1==t)?(1==this.battle_model.needPlayEnterAction()?this.floorTips():this.battle_model.createRoleList(),this.update_drama_battle=!1,this.init_drama_finish=!1,this.battle_res_id=null):(this.update_drama_battle=!0,this.init_drama_finish&&this.battle_hook_model.prepareStarBattle(this.initDramaFinish.bind(this)))},floorTips:function(){var t=this.battle_model.getCurBattleData();if(null!=t){var e=Config.combat_type_data.data_fight_list[t.combat_type];if(e)if(s.isNeedSpecStart(t.combat_type))this.showSpecStart();else{var i=e.start_effect;if(t.combat_type==s.Fight_Type.Darma){var n=this.battle_drama_model.getDramaData();if(n&&n.dun_id){var a=Config.dungeon_data.data_drama_dungeon_info[n.dun_id];a&&1!=a.is_big&&(i="E51147")}}Utils.playEffectOnce(i,.5*this.main_size.width,770-this.map_init_y,this.effect_layer_1,function(){this.battle_model.createRoleList()}.bind(this),PlayerAction.action,1)}else this.battle_model.createRoleList()}},showSpecStart:function(){if(!this.specail_enter&&1!=this.is_play_enter){this.is_play_enter=!0;var t=a.getPrefabPath("battle","battle_pk_enter_node");this.loadRes(t,function(t){t&&this.playSpecialEnterAction(t)}.bind(this))}},playSpecialEnterAction:function(t){this.specail_enter=t,this.specail_enter.x=.5*SCREEN_WIDTH,this.specail_enter.y=.5*SCREEN_HEIGHT,ViewManager.getInstance().addToSceneNode(this.specail_enter,SCENE_TAG.win);var e=this.specail_enter.getChildByName("center_spine").getComponent(sp.Skeleton);this.specail_enter.getChildByName("background").scale=FIT_SCALE;var i=this.specail_enter.getChildByName("left_bg"),n=i.getChildByName("spine").getComponent(sp.Skeleton),o=(u=i.getChildByName("form_container")).getChildByName("icon").getComponent(cc.Sprite),l=i.getChildByName("role_name").getComponent(cc.Label),r=this.specail_enter.getChildByName("right_bg"),c=r.getChildByName("spine").getComponent(sp.Skeleton),_=(m=r.getChildByName("form_container")).getChildByName("icon").getComponent(cc.Sprite),h=r.getChildByName("role_name").getComponent(cc.Label);i.runAction(cc.sequence(cc.moveTo(.4,-100,100),cc.callFunc(function(){this.showLeftEffect(e,n,c)}.bind(this)),cc.delayTime(2),cc.callFunc(function(){this.specail_enter&&(this.specail_enter.destroy(),this.specail_enter=null),this.battle_model.createRoleList()}.bind(this)))),r.runAction(cc.sequence(cc.moveTo(.4,100,-100),cc.callFunc(function(){}.bind(this))));var d=this.battle_model.getCurBattleData();if(d){var u=null,m=null;if(1==this.battle_model.isFriend(s.Group_Type.Friend)?(l.string=d.actor_role_name,h.string=d.target_role_name,u=d.formation[1],m=d.formation[2]):(l.string=d.target_role_name,h.string=d.actor_role_name,u=d.formation[2],m=d.formation[1]),u){var f=a.getBattleFormIcon(u.formation_type);this.loadRes(f,function(t){o.spriteFrame=t}.bind(this))}if(m){f=a.getBattleFormIcon(m.formation_type);this.loadRes(f,function(t){_.spriteFrame=t}.bind(this))}}},showLeftEffect:function(t,e,i){if(null!=t&&null!=e){var s=a.getSpinePath("E51141");this.loadRes(s,function(s){t.skeletonData=s,e.skeletonData=s,i.skeletonData=s,t.setAnimation(0,PlayerAction.action_2,!0),e.setAnimation(0,PlayerAction.action_1,!1),i.setAnimation(0,PlayerAction.action_1,!1)}.bind(this))}},curBattleResId:function(t){var e=10001;if(t==s.Fight_Type.Darma){var i=this.battle_drama_model.getDramaData();if(i&&i.mode&&i.chapter_id)e=Config.dungeon_data.data_drama_world_info[i.mode][i.chapter_id].map_id}else{var n=Config.battle_bg_data.data_info[t];if(null==n&&(n=Config.battle_bg_data.data_info[s.Fight_Type.Default]),e=null==n?10001:n.bid,t==s.Fight_Type.Adventrue){var a=o.getInstance().getModel().getAdventureBaseData();if(a){var l=Config.adventure_data.data_battle_res[a.id];l&&l.battle_res_id&&(e=l.battle_res_id)}}}return e},changeBattleScene:function(t){var e=this.battle_model.getCurBattleData(),i=this.battle_hook_model.getUnrealBattleData();if(null!=e||null!=i){var n=s.Fight_Type.Nil;n=1==t?e.combat_type:s.Fight_Type.Darma,this.combat_type=n,this.need_run_map=!t;var a=this.curBattleResId(n);this.loaderBattleScene(a);var o=null;if(this.combat_type==s.Fight_Type.Darma){var l=Config.battle_bg_data.data_info2[this.combat_type];l&&l[a]&&(o=l[a])}else o=Config.battle_bg_data.data_info[this.combat_type];o&&""!=o.bg_music&&Utils.playMusic(AUDIO_TYPE.BATTLE,o.bg_music,!0)}},loaderBattleScene:function(t){if(0!=t&&this.battle_res_id!=t)if(this.battle_res_id=t,this.combat_type==s.Fight_Type.Darma){a.getBattleDrameBg(t);t&&this.createDramaScene(t)}else this.createSingleScene(t)},createDramaScene:function(t){var e=!1,i=!1,s=a.getBattleDrameBg(t);n.getInstance().loadRes(s.s,function(t){this.root&&0==this.root.isValid||(t&&(null==this.drama_s_bg&&(this.drama_s_bg=new cc.Node,this.drama_s_bg.scale=1.43,this.drama_s_bg.setAnchorPoint(0,0),this.drama_s_bg.setPosition(0,this.slayer_init_y),this.map_sLayer.addChild(this.drama_s_bg,BATTLE_VIEW_BACK_LAYER_Z),this.drama_s_bg_frame=this.drama_s_bg.addComponent(cc.Sprite),this.drama_s_bg_2=cc.instantiate(this.drama_s_bg),this.drama_s_bg_frame_2=this.drama_s_bg_2.getComponent(cc.Sprite),this.map_sLayer.addChild(this.drama_s_bg_2,BATTLE_VIEW_BACK_LAYER_Z)),this.drama_s_bg_frame.spriteFrame=t,this.drama_s_bg_frame_2.spriteFrame=t,null==this.drama_s_bg_width&&(this.drama_s_bg_width=1.43*this.drama_s_bg.getContentSize().width,this.drama_s_bg_2.setPosition(this.drama_s_bg.x+this.drama_s_bg_width,this.slayer_init_y))),e=!0,i&&this.update_drama_battle&&!this.init_drama_finish&&this.battle_hook_model.prepareStarBattle(this.initDramaFinish.bind(this)))}.bind(this)),n.getInstance().loadRes(s.f,function(t){if(t){if(this.root&&0==this.root.isValid)return;null==this.drama_f_bg&&(this.drama_f_bg=new cc.Node,this.drama_f_bg.setAnchorPoint(0,0),this.drama_f_bg.scale=1.43,this.map_fLayer.addChild(this.drama_f_bg,BATTLE_VIEW_BACK_LAYER_Z),this.drama_f_bg_frame=this.drama_f_bg.addComponent(cc.Sprite),this.drama_f_bg_2=cc.instantiate(this.drama_f_bg),this.drama_f_bg_frame_2=this.drama_f_bg_2.getComponent(cc.Sprite),this.map_fLayer.addChild(this.drama_f_bg_2,BATTLE_VIEW_BACK_LAYER_Z)),this.drama_f_bg_frame.spriteFrame=t,this.drama_f_bg_frame_2.spriteFrame=t,null==this.drama_f_bg_width&&(this.drama_f_bg_width=1.43*this.drama_f_bg.getContentSize().width,this.drama_f_bg_2.x=this.drama_f_bg.x+this.drama_f_bg_width),i=!0,e&&this.update_drama_battle&&!this.init_drama_finish&&this.battle_hook_model.prepareStarBattle(this.initDramaFinish.bind(this))}}.bind(this))},initDramaFinish:function(){this.init_drama_finish=!0},createSingleScene:function(t){null==this.map_sLayer_frame&&(this.map_sLayer_frame=this.map_oLayer.addComponent(cc.Sprite));var e=a.getBattleSingleBg(t);this.loadRes(e,function(t){this.map_sLayer_frame.spriteFrame=t}.bind(this))},mapMovescheduleUpdate:function(){this.need_run_map&&this.init_drama_finish&&this.moveMap()},changeMoveMapStatus:function(t){this.combat_type==s.Fight_Type.Darma&&(this.need_run_map=t)},moveMap:function(){null!=this.drama_s_bg&&null!=this.drama_f_bg&&(this.drama_s_bg.x=this.drama_s_bg.x-this.bg_speed,this.drama_s_bg_2.x=this.drama_s_bg_2.x-this.bg_speed,this.drama_f_bg.x=this.drama_f_bg.x-this.f_speed,this.drama_f_bg_2.x=this.drama_f_bg_2.x-this.f_speed,this.changeBgPosition(this.drama_s_bg,this.drama_s_bg_2,this.drama_s_bg_width),this.changeBgPosition(this.drama_s_bg_2,this.drama_s_bg,this.drama_s_bg_width),this.changeBgPosition(this.drama_f_bg,this.drama_f_bg_2,this.drama_f_bg_width),this.changeBgPosition(this.drama_f_bg_2,this.drama_f_bg,this.drama_f_bg_width))},changeBgPosition:function(t,e,i){null!=t&&null!=e&&t.x<=-i&&(t.x=e.x+i)},updateRound:function(t){},showPassiveSkillName:function(t,e){e&&e()},getBattleEffectLayer:function(t){return 1==t?this.effect_layer_1:this.effect_layer_2},getBattleRoleLayer:function(){return this.role_layer},loadRes:function(t,e){null!=t&&""!=t&&null!=e&&n.getInstance().loadRes(t,function(i){null==this.resources_list[t]&&(this.resources_list[t]=t),e(i)}.bind(this))},deleteMe:function(){for(var t in this.black_layer&&this.black_layer.stopAllActions(),this.specail_enter&&(this.specail_enter.destroy(),this.specail_enter=null),this.resources_list)n.getInstance().releaseRes(t);this.root.destroy()},setBlack:function(t,e){if(t){if(1==this.black_on_show)return;if(this.black_on_show=!0,this.black_layer)this.black_layer.active=!0;else{this.black_layer=new cc.Node,this.black_layer.setAnchorPoint(0,0),this.black_layer.setContentSize(this.main_size.width+200,this.main_size.height+200),this.black_layer.setPosition(-100,-100),this.black_layer.scale=FIT_SCALE,this.battle_layer.addChild(this.black_layer,1);var i=this.black_layer.addComponent(cc.Graphics);i.clear(),i.fillColor=cc.color(0,0,0,168),i.rect(0,0,this.main_size.width+200,this.main_size.height+200),i.fill()}this.black_layer.opacity=0,this.black_layer.runAction(cc.fadeIn(.2))}else this.black_layer&&(this.black_layer.stopAllActions(),this.black_layer.active=!1,this.black_on_show=!1)},shakeScreen:function(t){var e=this;if(!this.is_shake&&null!=t){var i=Config.skill_data.data_get_shake_data[t];if(null!=i){this.is_shake=!0,this.main_layer.stopAllActions(),this.main_layer.setPosition(0,0);for(var s=function(){this.is_shake=!1,this.main_layer.setPosition(0,0)}.bind(this),n=[0,3,6,4,7,8,5,2,1],a=i.shake_strength,o=.001*i.shake_rate,l=i.shake_time,r=[[-.7,.7],[0,1],[.7,.7],[-1,0],[0,0],[1,0],[-.7,-.7],[0,-1],[.7,-.7]],c=function(t){var e=.25*a*r[n[t]][0],i=.25*-a*r[n[t]][1];this.main_layer.setPosition(e,i)}.bind(this),_=null,h=0;h<l;h++){for(var d=function(t){m=cc.delayTime(o),_=null==_?cc.sequence(cc.callFunc(function(){c(t)}.bind(e)),m):cc.sequence(_,cc.callFunc(function(){c(t)}.bind(e),m))},u=0;u<n.length;u++){var m;d(u)}a-=3}_&&(_=cc.sequence(_,cc.callFunc(s)),this.main_layer.runAction(_))}}}});cc._RF.pop()},{adventure_controller:"adventure_controller",battle_const:"battle_const",battle_controller:"battle_controller",battle_drama_controller:"battle_drama_controller",loadermanager:"loadermanager",pathtool:"pathtool"}],bind_phone_panel:[function(t,e,i){"use strict";cc._RF.push(e,"18d1aokvrRCn4kG1MXDJ+5/","bind_phone_panel");var s=t("pathtool"),n=t("welfare_const"),a=t("welfare_event");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("welfare","bind_phone_panel")},initConfig:function(){this.ctrl=t("welfare_controller").getInstance(),this.bind_phone_status=0,this.item_list=[]},initPanel:function(){this.ok_btn=this.seekChild("ok_btn"),this.ok_btn_lb=this.seekChild(this.ok_btn,"label",cc.Label),this.item_container=this.seekChild("item_container"),this.bg_sp=this.seekChild("bg",cc.Sprite),this.loadRes(s.getBigBg("welfare/txt_cn_bind_phone"),function(t){this.bg_sp.spriteFrame=t}.bind(this))},registerEvent:function(){Utils.onTouchEnd(this.ok_btn,function(){0==this.bind_phone_status?"SH_RH"==PLATFORM_TYPR&&1==SH_RH_IS_SHOW_BINDPHONE&&"shmix"==PLATFORM_NAME?SDK.bindphone({apiType:"askShow"}):this.ctrl.openCertifyBindPhoneWindow(!0):1==this.bind_phone_status&&message(Utils.TI18N("\u5956\u52b1\u5df2\u53d1\u9001"))}.bind(this),1),this.addGlobalEvent(a.UpdateBindPhoneStatus,function(){this.updateBindPhoneStatus()},this)},onShow:function(t){this.updateBindPhoneStatus(),this.setItemList(),this.ctrl.setWelfareStatus(n.WelfareIcon.bindphone,!1)},updateBindPhoneStatus:function(){var t=this.ctrl.getBindPhoneData();null!=t&&this.bind_phone_status!=t.code&&(this.bind_phone_status=t.code,0==t.code?this.ok_btn_lb.string=Utils.TI18N("\u524d\u5f80\u7ed1\u5b9a"):1==t.code&&(this.ok_btn_lb.string=Utils.TI18N("\u5df2\u53d1\u9001")))},setItemList:function(){var t=this.ctrl.getBindPhoneData();if(null!=t&&null!=t.items){var e=0;for(var i in t.items){var s=t.items[i];if(!this.item_list[i]){var n=ItemsPool.getInstance().getItem("backpack_item");n.initConfig(!1,1,!1,!0),n.show(),n.setParent(this.item_container),n.setData({bid:s.bid,num:s.num}),n.setPosition(134*e+60,0),this.item_list[i]=n,e+=1}}}},setVisibleStatus:function(t){this.setVisible(t)},onHide:function(){},onDelete:function(){if(this.item_list){for(var t in this.item_list)this.item_list[t].deleteMe(),this.item_list[t]=null;this.item_list=null}}});cc._RF.pop()},{pathtool:"pathtool",welfare_const:"welfare_const",welfare_controller:"welfare_controller",welfare_event:"welfare_event"}],browse_window:[function(t,e,i){"use strict";cc._RF.push(e,"f3a80RKaP5Nq6vgd+1xDoTh","browse_window");var s=t("pathtool");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("heroexpedit","browse_reward_panel"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Tips,this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){this.reward_list=[]},openCallBack:function(){this.background=this.root_wnd.getChildByName("background"),this.background.scale=FIT_SCALE;var t=this.root_wnd.getChildByName("main_container");t.getChildByName("Image_33").getChildByName("Text_32").getComponent(cc.Label).string=Utils.TI18N("\u5956\u52b1\u9884\u89c8"),this.btn_con=t.getChildByName("btn_con"),this.btn_con.getChildByName("Text_33").getComponent(cc.Label).string=Utils.TI18N("\u786e\u8ba4"),this.good_con=t.getChildByName("good_con")},registerEvent:function(){Utils.onTouchEnd(this.background,function(){this.ctrl.openBrowsePanelView(!1)}.bind(this),2),Utils.onTouchEnd(this.btn_con,function(){this.ctrl.openBrowsePanelView(!1)}.bind(this),1)},openRootWnd:function(t){if(t){var e=null;if(t.rewards&&(e=t.rewards),e){var i=e.length,s=[];s=2==i?[166,423]:[166,296,423];for(var n=0;n<i;n++)this.reward_list[n]||(this.reward_list[n]=ItemsPool.getInstance().getItem("backpack_item"),this.reward_list[n].setParent(this.good_con),this.reward_list[n].initConfig(),this.reward_list[n].show()),this.reward_list[n]&&(this.reward_list[n].setPosition(s[n],79),25==e[n].bid&&1==t.is_holiday?this.reward_list[n].holidHeroExpeditTag(!0,"\u9650\u65f6\u63d0\u5347"):this.reward_list[n].holidHeroExpeditTag(!1),this.reward_list[n].setDefaultTip(),this.reward_list[n].setData({bid:e[n].bid,num:e[n].num}))}}},closeCallBack:function(){for(var t in this.reward_list)this.reward_list[t].deleteMe(),this.reward_list[t]=null;this.reward_list=null,this.ctrl.openBrowsePanelView(!1)}});cc._RF.pop()},{pathtool:"pathtool"}],bug_panel:[function(t,e,i){"use strict";cc._RF.push(e,"ddd4a7HhINF5aY2Sto5AiLt","bug_panel");var s=t("pathtool"),n=(t("loadermanager"),t("role_controller"),cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("notice","bug_panel"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Mini},openCallBack:function(){this.backpanel=this.root_wnd.getChildByName("backpanel"),this.main_panel=this.root_wnd.getChildByName("main_panel"),this.close_btn=this.main_panel.getChildByName("close_btn"),this.ok_btn=this.main_panel.getChildByName("ok_btn"),this.tab_container=this.main_panel.getChildByName("tab_container"),this.btn_list=[];for(var t=0;t<2;t++){var e=this.tab_container.getChildByName("tab_btn_"+(t+1));e.label=e.getChildByName("title"),e.label.color=new cc.Color(207,181,147,255),e.buttom=e.getComponent(cc.Button),this.btn_list[t]=e,e.index=t}this.changeIndex(0),this.title_input=this.main_panel.getChildByName("title_input").getComponent(cc.EditBox),this.content_input=this.main_panel.getChildByName("content_input").getComponent(cc.EditBox),this.desc=this.main_panel.getChildByName("desc").getComponent(cc.RichText),this.desc.string=cc.js.formatStr(Utils.TI18N("<color=#593429>\u4eb2\u7231\u7684\u5192\u9669\u8005\u5927\u4eba\uff1a<br/>\u6b22\u8fce\u60a8\u8fdb\u9a7b\u300a%s\u300b\u7684\u5192\u9669\u4e16\u754c\uff0c\u5982\u60a8\u5728\u6e38\u620f\u4e2d\u53d1\u73b0BUG\u6216\u6709\u4ec0\u4e48\u5efa\u8bae\uff0c\u8bf7\u60a8\u586b\u5199\u7559\u8a00\u5e76\u63d0\u4ea4\uff0c\u6211\u4eec\u4f1a\u8ba4\u771f\u5bf9\u5f85\u4f60\u4eec\u7684\u5efa\u8bae~\u5982\u6709\u7d27\u6025\u95ee\u9898\uff0c\u8bf7\u70b9\u51fb\u3010\u6d6e\u6807\u3011\u2192\u3010\u5ba2\u670d\u3011\u8fdb\u884c\u53cd\u9988\uff0c\u6211\u4eec\u4f1a\u7b2c\u4e00\u65f6\u95f4\u7ed9\u4f60\u56de\u590d\uff01</color>"),GAME_NAME)},registerEvent:function(){var e=this,i=t("notice_controller");this.backpanel.on(cc.Node.EventType.TOUCH_END,function(t){i.getInstance().openBugPanel(!1)},this),this.close_btn.on(cc.Node.EventType.TOUCH_END,function(t){i.getInstance().openBugPanel(!1)},this),this.ok_btn.on(cc.Node.EventType.TOUCH_END,function(t){""!=this.title_input.string?""!=this.content_input.string?(i.getInstance().sender10810(this.index+2,this.title_input.string,this.content_input.string),this.title_input.string="",this.content_input.string=""):message(Utils.TI18N("\u8bf7\u8f93\u5165\u5185\u5bb9")):message(Utils.TI18N("\u8bf7\u8f93\u5165\u6807\u9898"))},this);for(var s=function(t){e.btn_list[t].on(cc.Node.EventType.TOUCH_END,function(e){this.changeIndex(t)},e)},n=0;n<2;n++){s(n)}},changeIndex:function(t){this.index!=t&&((t<0||t>1)&&(t=0),this.index=t,this.cur_tab&&(this.cur_tab.buttom.interactable=!0,this.cur_tab.label.color=new cc.Color(207,181,147,255)),this.cur_tab=this.btn_list[t],this.cur_tab&&(this.cur_tab.buttom.interactable=!1,this.cur_tab.label.color=new cc.Color(255,237,214,255)))},openRootWnd:function(){},closeCallBack:function(){this.role_update_evt&&this.roleVo.unbind(this.role_update_evt)}}));e.exports=n,cc._RF.pop()},{loadermanager:"loadermanager",notice_controller:"notice_controller",pathtool:"pathtool",role_controller:"role_controller"}],build_item:[function(t,e,i){"use strict";cc._RF.push(e,"4087cw7cgRHz4WRkcpMHcJf","build_item");var s=t("scene_const"),n=t("pathtool"),a=cc.Class({extends:BaseClass,properties:{data:null,build_is_lock:null,can_click:!1,isBuild:!1,config:null,build_type:null,root_wnd:cc.Node,iconSP:cc.Sprite,red_state:null,red_nd:cc.Node},ctor:function(){this.data=arguments[0],this.type=arguments[1],this.createRootWind(),this.type==s.BuildItemType.build?(this.build_type=this.data.config.type,cc.log("build item:"+this.data.config),this.isBuild=this.build_type==s.BuildItemType.build,this.config=this.data.config,this.createIcon()):this.type==s.BuildItemType.effect?this.createEffect():this.type==s.BuildItemType.npc&&this.createNPC()},createRootWind:function(){this.con_size=cc.v2(83,80);var t="";this.type==s.BuildItemType.build&&(t="guidesign_build_"+this.data.config.bid),this.root_wnd=new cc.Node(t),this.root_wnd.setContentSize(83,80),this.root_wnd.setAnchorPoint(.5,0);var e="number"==typeof this.data.x?this.data.x:this.data.config.x,i="number"==typeof this.data.y?this.data.y:this.data.config.y;this.root_wnd.setPosition(e,i)},createIcon:function(){var t=new cc.Node;t.setAnchorPoint(.5,0),this.iconSP=t.addComponent(cc.Sprite),this.root_wnd.addChild(t),this.button=this.root_wnd.addComponent(cc.Button),this.button.interactable=!0,this.button.transition=cc.Button.Transition.SCALE,this.button.duration=.1,this.button.zoomScale=.9,this.isBuild&&this.createBuild(),this.red_nd=new cc.Node,this.red_nd.position=cc.v2(.3*this.root_wnd.width,.8*this.root_wnd.height),this.root_wnd.addChild(this.red_nd),this.red_sp=this.red_nd.addComponent(cc.Sprite);var e=n.getUIIconPath("centerscene","scene_0");LoaderManager.getInstance().loadRes(e,function(t){this.red_sp.spriteFrame=t}.bind(this)),this.red_nd.active=!1,this.setTipStatus()},registerEvent:function(){this.data&&this.isBuild&&(this.root_wnd.on(cc.Node.EventType.TOUCH_END,function(t){t.touch;var e=t.touch.getStartLocation(),i=t.touch.getLocation();Math.sqrt(Math.pow(e.x-i.x,2)+Math.pow(e.y-i.y,2))<40&&this.clickBbuildItem()}.bind(this)),this.build_vo_update=this.data.bind(this.data.Update_self_event,function(t){"lock_status"==t?this.setLockStatus():"tips_status"==t?this.setTipStatus():"fight_status"==t&&this.fightStatus()}.bind(this)))},createBuild:function(){var t="ui_res/centerscene/"+("scene_"+this.config.res)+".png";LoaderManager.getInstance().loadRes(t,function(e){cc.log("\u52a0\u8f7d\u56fe\u6807\u8d44\u6e90\uff1a"+t),this.iconSP.spriteFrame=e}.bind(this)),this.setLockStatus(),this.registerEvent()},createEffect:function(){var t=new cc.Node("");t.position=cc.v2(0,.5*this.con_size.y),this.root_wnd.addChild(t),this.spine=t.addComponent(sp.Skeleton),this.spinePath=n.getSpinePath(this.data.res,"action"),LoaderManager.getInstance().loadRes(this.spinePath,function(t){this.spine.skeletonData=t,this.spine.setAnimation(0,"action",!0)}.bind(this))},createNPC:function(){var t=new cc.Node("");t.setContentSize(cc.v2(90,90)),t.position=cc.v2(0,.5*this.con_size.y),102!==this.data.bid&&152!==this.data.bid&&t.on(cc.Node.EventType.TOUCH_END,this.onTouchNpc.bind(this),this),t.test_res=this.data,this.root_wnd.addChild(t),this.spine=t.addComponent(sp.Skeleton),this.spinePath=n.getSpinePath(this.data.res,"action"),this.spine.setEndListener(this.animaComplete.bind(this)),LoaderManager.getInstance().loadRes(this.spinePath,function(t){this.spine.skeletonData=t,this.spine.setAnimation(0,"action1",!0)}.bind(this))},onTouchNpc:function(t){},animaComplete:function(t,e){},setLockStatus:function(){null!==this.build_is_lock&&this.build_is_lock===this.data.is_lock||(this.build_is_lock=this.data.is_lock,this.data.is_lock?this.iconSP.setMaterial(0,cc.Material.getBuiltinMaterial("gray-sprite")):this.iconSP.setMaterial(0,cc.Material.getBuiltinMaterial("2d-sprite")))},clickBbuildItem:function(){this.data&&(this.data.is_lock?message(this.data.desc):(this.data.group_id,t("mainscene_controller").getInstance().openBuild(this.data.config.bid)))},setRedPoint:function(){if(!this.data.is_lock&&this.data)this.data.getTipsStatus()},setTipStatus:function(){if(!this.data.is_lock&&this.data){var t=this.data.getTipsStatus();this.red_nd.active=t}else this.red_nd.active=!1},deleteMe:function(){(this.type=s.BuildItemType.effect)&&(this.root_wnd.destroy(),LoaderManager.getInstance().releaseRes(this.spinePath))},fightStatus:function(){this.data.getFightStatus()?this.fight_nd?this.fight_nd.active=!0:this.initFightEffent():this.fight_nd&&(this.fight_nd.active=!1)},initFightEffent:function(){var t=this.fight_nd=new cc.Node;t.y=this.root_wnd.height,this.root_wnd.addChild(t),this.fight_effect=t.addComponent(sp.Skeleton);var e=n.getEffectRes(186),i=n.getSpinePath(e);LoaderManager.getInstance().loadRes(i,function(t){this.fight_effect.skeletonData=t,this.fight_effect.setAnimation(0,"action",!0)}.bind(this))}});e.exports=a,cc._RF.pop()},{mainscene_controller:"mainscene_controller",pathtool:"pathtool",scene_const:"scene_const"}],build_vo:[function(t,e,i){"use strict";function s(t){"@babel/helpers - typeof";return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}cc._RF.push(e,"ed980xTXUBBbIyIzuUQCRMO","build_vo");var n=cc.Class({extends:gcore.BaseEvent,properties:{config:{default:{}},is_loack:!1,activare:[],tips_list:{default:{}},tips_status:!1,desc:"",in_fight:!1,fight_status_list:{default:{}},group_id:0},ctor:function(){this.config=arguments[0],this.is_lock=arguments[1],this.activate=arguments[2],this.desc=arguments[3]},setLockStatus:function(t){this.is_lock!==t&&(this.is_lock=t,this.fire(this.Update_self_event,"lock_status"))},getTipsStatus:function(){for(var t in this.tips_list)if(1==this.tips_list[t])return!0;return this.tips_status},setTipsStatus:function(t){var e=!1;if(null==t&&(t=!this.tips_status),t instanceof Array)for(var i in t){var n=t[i];null!=n.bid&&this.tips_list[n.bid]!=n.status&&(e=!0,this.tips_list[n.bid]=n.status)}else"object"==s(t)?null!=t.bid&&this.tips_list[t.bid]!=t.status&&(e=!0,this.tips_list[t.bid]=t.status):this.tips_status!==t&&(e=!0,this.tips_status=t);1==e&&this.fire(this.Update_self_event,"tips_status")},setFightStatus:function(t){if(t){var e=!1;for(var i in this.fight_status_list)this.fight_status_list[i]&&(e=!0);var s=!1;for(var i in t)t[i]&&(s=!0);e!=s&&(this.fight_status_list=t,this.fire(this.Update_self_event,"fight_status"))}},getFightStatus:function(){for(var t in this.fight_status_list)if(this.fight_status_list[t])return!0;return!1}});n.prototype.Update_self_event="Update_self_event",e.exports=n,cc._RF.pop()},{}],buy_lev_window:[function(t,e,i){"use strict";cc._RF.push(e,"7205e9IBV1JYYdq7HVNc6Zh","buy_lev_window");var s=t("pathtool"),n=t("common_scrollview");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("orderaction","buy_lev_window"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Mini,this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){this.cur_buy_lev=1,this.touch_max_btn=null},openCallBack:function(){this.root_wnd.getChildByName("background").scale=FIT_SCALE;var t=this.root_wnd.getChildByName("main_container");t.getChildByName("title_con").getChildByName("title_label").getComponent(cc.Label).string=Utils.TI18N("\u8d2d\u4e70\u7b49\u7ea7"),this.btn_buy=t.getChildByName("btn_buy"),this.btn_buy.getChildByName("Text_1").getComponent(cc.Label).string=Utils.TI18N("\u8d2d   \u4e70");var e=t.getChildByName("info_con");this.slider=e.getChildByName("slider"),this.plus_btn=e.getChildByName("plus_btn"),this.min_btn=e.getChildByName("min_btn"),this.max_btn=e.getChildByName("max_btn"),this.buy_price=e.getChildByName("buy_price").getComponent(cc.Label),this.buy_price.string="",this.Sprite_1=e.getChildByName("Sprite_1").getComponent(cc.Sprite),this.loadRes(s.getItemRes("3"),function(t){this.Sprite_1.spriteFrame=t}.bind(this)),this.cur_period=this.model.getCurPeriod(),this.cur_lev=this.model.getCurLev(),this.cur_max_lev=0,Config.holiday_war_order_data.data_lev_reward_list[this.cur_period]&&(this.cur_max_lev=Object.keys(Config.holiday_war_order_data.data_lev_reward_list[this.cur_period]).length),this.buy_editbox=t.getChildByName("editbox").getComponent(cc.EditBox);var i=function(){this.buy_editbox.placeholder="",this.buy_editbox.string=""}.bind(this),a=function(){var t=this.buy_editbox.string;if(""!=t){var e=parseInt(t);null!=e&&(e<=0&&(e=1),e>=this.cur_max_lev-this.cur_lev&&(e=this.cur_max_lev-this.cur_lev),this.buy_editbox.string=e.toString(),this.cur_buy_lev=e+this.cur_lev,this.cur_buy_lev>=this.cur_max_lev&&(this.cur_buy_lev=this.cur_max_lev),this.cur_buy_lev<=this.cur_lev&&(this.cur_buy_lev=this.cur_lev+1),this.buyDescript(this.cur_buy_lev))}}.bind(this);this.buy_editbox.node.on("editing-did-began",i,this),this.buy_editbox.node.on("editing-did-ended",a,this),this.buy_editbox.node.on("editing-did-return",a,this),this.reward_desc=Utils.createRichLabel(22,new cc.Color(100,50,35,255),cc.v2(.5,.5),cc.v2(0,240),24,400),t.addChild(this.reward_desc.node),this.lev_desc=Utils.createRichLabel(26,new cc.Color(100,50,35,255),cc.v2(0,.5),cc.v2(-230,-60),28,400),this.lev_desc.horizontalAlign=cc.macro.TextAlignment.LEFT,t.addChild(this.lev_desc.node);var o=t.getChildByName("goods"),l=o.getContentSize();this.item_scrollview=new n,this.item_scrollview.createScroll(o,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,l,{item_class:"backpack_item",start_x:32,space_x:20,start_y:0,space_y:0,item_width:120,item_height:120,row:1,col:4}),this.cur_buy_lev=this.cur_lev+1,this.setEditBoxText(this.cur_buy_lev),this.buyDescript(this.cur_buy_lev),this.ticketInitShow(this.cur_buy_lev),this.btn_close=t.getChildByName("btn_close")},registerEvent:function(){Utils.onTouchEnd(this.btn_close,function(){this.ctrl.openBuyLevView(!1)}.bind(this),2),Utils.onTouchEnd(this.plus_btn,function(){this.addBuy()}.bind(this),1),Utils.onTouchEnd(this.min_btn,function(){this.minusBuy()}.bind(this),1),Utils.onTouchEnd(this.max_btn,function(){this.maxBuy()}.bind(this),1),Utils.onTouchEnd(this.btn_buy,function(){var t=this.cur_buy_lev-this.cur_lev;this.ctrl.send25307(t)}.bind(this),1)},setEditBoxText:function(t){this.buy_editbox&&(t-=this.cur_lev,this.buy_editbox.string=t.toString())},addBuy:function(){if(this.cur_buy_lev=this.cur_buy_lev+1,Config.holiday_war_order_data.data_lev_reward_list[this.cur_period]&&(this.touch_max_btn=null,this.cur_buy_lev>this.cur_max_lev))return this.cur_buy_lev=this.cur_max_lev,void message(Utils.TI18N("\u5df2\u7ecf\u5230\u8fbe\u6700\u5927\u7b49\u7ea7\u4e86~~~"));this.setEditBoxText(this.cur_buy_lev),this.buyDescript(this.cur_buy_lev)},minusBuy:function(){if(this.cur_buy_lev=this.cur_buy_lev-1,this.setEditBoxText(this.cur_buy_lev),this.touch_max_btn=null,this.cur_buy_lev<=this.cur_lev)return this.cur_buy_lev=this.cur_lev,message(Utils.TI18N("\u5df2\u7ecf\u662f\u8d2d\u4e70\u6700\u5c0f\u7b49\u7ea7\u4e86~~~")),void this.setEditBoxText(this.cur_buy_lev+1);this.cur_buy_lev<=0&&(this.cur_buy_lev=0),this.buyDescript(this.cur_buy_lev)},maxBuy:function(){this.touch_max_btn||Config.holiday_war_order_data.data_lev_reward_list[this.cur_period]&&(this.cur_buy_lev=this.cur_max_lev,this.setEditBoxText(this.cur_buy_lev),this.touch_max_btn=!0,this.buyDescript(this.cur_max_lev))},buyDescript:function(t){var e=t;if(Config.holiday_war_order_data.data_lev_reward_list[this.cur_period]){this.clearTicket(),null==this.buy_lev_ticket&&(this.buy_lev_ticket=gcore.Timer.set(function(){this.ticketInitShow(e)}.bind(this),300)),t-=this.cur_lev;var i=cc.js.formatStr(Utils.TI18N("\u8d2d\u4e70 <color=#249003>%d</color> \u7ea7\uff0c\u5347\u81f3 <color=#249003>%d</color> \u7ea7"),t,this.cur_buy_lev);this.lev_desc.string=i;var s=1e3*t;this.buy_price.string=.6*s}},ticketInitShow:function(t){if(t){var e=this.addTicket(t),i=e[0],s=e[1],n=cc.js.formatStr(Utils.TI18N("\u5347\u81f3 <color=#249003>%d</color> \u7ea7\uff0c\u53ef\u7acb\u5373\u89e3\u9501 <color=#249003>%d</color> \u4ef6\u5956\u52b1"),t,s);this.reward_desc&&(this.reward_desc.string=n),this.item_scrollview&&(this.item_scrollview.setData(i),this.item_scrollview.addEndCallBack(function(){var t=this.item_scrollview.getItemList();for(var e in t)t[e].setDefaultTip()}.bind(this)))}},clearTicket:function(){null!=this.buy_lev_ticket&&(gcore.Timer.del(this.buy_lev_ticket),this.buy_lev_ticket=null)},addTicket:function(t){this.clearTicket();for(var e=[],i={},s=0,n=this.cur_lev+1;n<=t;n++)if(Config.holiday_war_order_data.data_lev_reward_list[this.cur_period][n]&&Config.holiday_war_order_data.data_lev_reward_list[this.cur_period][n].reward){var a=Config.holiday_war_order_data.data_lev_reward_list[this.cur_period][n].item_num||0;for(var o in s+=a,Config.holiday_war_order_data.data_lev_reward_list[this.cur_period][n].reward){i[(l=Config.holiday_war_order_data.data_lev_reward_list[this.cur_period][n].reward[o])[0]]?i[l[0]]=i[l[0]]+l[1]:i[l[0]]=l[1]}for(var o in Config.holiday_war_order_data.data_lev_reward_list[this.cur_period][n].rmb_reward){var l;i[(l=Config.holiday_war_order_data.data_lev_reward_list[this.cur_period][n].rmb_reward[o])[0]]?i[l[0]]=i[l[0]]+l[1]:i[l[0]]=l[1]}}var r=Config.holiday_war_order_data.data_price_list;for(var c in i){var _=0;r[c]&&(_=r[c].sort||0),e.push({bid:c,num:i[c],sort:_})}return e.sort(function(t,e){return t.sort-e.sort}),[e,s]},openRootWnd:function(t){},closeCallBack:function(){this.item_scrollview&&(this.item_scrollview.deleteMe(),this.item_scrollview=null),this.ctrl.openBuyLevView(!1)}});cc._RF.pop()},{common_scrollview:"common_scrollview",pathtool:"pathtool"}],certify_bind_phone_window:[function(t,e,i){"use strict";cc._RF.push(e,"ed818DIUtNLyp4vzBncAyQd","certify_bind_phone_window");var s=t("pathtool"),n=t("welfare_event");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("welfare","certify_bind_phone_window"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Big},initConfig:function(){this.ctrl=t("welfare_controller").getInstance()},openCallBack:function(){this.background=this.seekChild("background"),this.background.scale=FIT_SCALE,this.ok_btn=this.seekChild("ok_btn"),this.send_btn=this.seekChild("send_btn",cc.Button),this.send_btn_label=this.seekChild(this.send_btn.node,"label",cc.Label),this.phone_box=this.seekChild("phone_box",cc.EditBox),this.certify_box=this.seekChild("certify_box",cc.EditBox)},registerEvent:function(){Utils.onTouchEnd(this.background,function(){this.ctrl.openCertifyBindPhoneWindow(!1)}.bind(this),2),Utils.onTouchEnd(this.ok_btn,function(){this.sendBindPhone(),Utils.playButtonSound(1)}.bind(this),1),this.send_btn.node.on("click",function(){this.requestCertifyNumber(),Utils.playButtonSound(1)},this),this.addGlobalEvent(n.UpdateBindPhoneStatus,function(t){this.updateBindStatus(t)},this)},openRootWnd:function(t){},requestCertifyNumber:function(){var t=this.phone_box.string;""!=t&&11==t.length?this.ctrl.requestBindPhone(t,""):message(Utils.TI18N("\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u624b\u673a\u53f7\u7801!"))},updateBindStatus:function(t){t&&2==t.status&&(this.count_down_time=60,this.send_btn_label.node.color=new cc.Color(255,255,255,255),Utils.setGreyButton(this.send_btn,!0),this.clearEneTime(),this.countDownEndTime(),this.timeticket=gcore.Timer.set(function(){this.countDownEndTime()}.bind(this),1e3,-1))},countDownEndTime:function(){if(this.count_down_time=this.count_down_time-1,0==this.count_down_time)return this.send_btn_label.string=Utils.TI18N("\u53d1\u9001\u9a8c\u8bc1\u7801"),this.send_btn_label.node.color=new cc.Color(113,40,4,255),Utils.setGreyButton(this.send_btn,!1),void this.clearEneTime();this.send_btn_label.string=Utils.TI18N("\u53d1\u9001\u4e2d..")+this.count_down_time},clearEneTime:function(){this.timeticket&&(gcore.Timer.del(this.timeticket),this.timeticket=null)},sendBindPhone:function(){var t=this.phone_box.string;if(""!=t&&11==t.length){var e=this.certify_box.string;""==e&&message(Utils.TI18N("\u9a8c\u8bc1\u7801\u4e0d\u80fd\u4e3a\u7a7a!")),this.ctrl.requestBindPhone(t,e)}else message(Utils.TI18N("\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u624b\u673a\u53f7\u7801!"))},closeCallBack:function(){this.clearEneTime(),this.ctrl.openCertifyBindPhoneWindow(!1)}});cc._RF.pop()},{pathtool:"pathtool",welfare_controller:"welfare_controller",welfare_event:"welfare_event"}],charge_item:[function(t,e,i){"use strict";cc._RF.push(e,"ba1f3Rd+mxBKbCDqZ7N7cCb","charge_item");var s=t("pathtool");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("vip","charge_item")},initConfig:function(){},initPanel:function(){this.main_container=this.seekChild("main_container"),this.price_container=this.seekChild("price_container"),this.coin_sp=this.seekChild(this.price_container,"coin",cc.Sprite),this.price_lb=this.seekChild(this.price_container,"price",cc.Label),this.icon_sp=this.seekChild(this.main_container,"icon",cc.Sprite),this.loadRes(s.getItemRes(3),function(t){this.coin_sp.spriteFrame=t}.bind(this)),this.charge_price_lb=this.seekChild("charge_price",cc.Label),this.extra_bg_nd=this.seekChild("extra_bg"),this.extra_bg_nd.active=!1,this.extra_desc_lb=this.seekChild(this.extra_bg_nd,"give",cc.Label),this.extra_rt=this.seekChild("extra_label",cc.RichText),this.confirm_bg_nd=this.seekChild("confirm_bg"),this.confirm_bg_nd.active=!1,this.confirm_tips_nd=this.seekChild("confirm_tips"),this.confirm_tips_nd.active=!1,this.first_bg_nd=this.seekChild("first_bg"),this.first_bg_nd.active=!1,this.first_lb=this.seekChild(this.first_bg_nd,"first_label",cc.Label)},registerEvent:function(){this.root_wnd.on(cc.Node.EventType.TOUCH_END,function(){this.callback&&this.callback(this),this.confirm_tips_nd.active?(SDK.pay(this.data.need_rmb/100,null,this.data.id,this.data.name,null,null,null),this.confirm_tips_nd.active=!1,this.confirm_bg_nd.active=!1):(this.confirm_tips_nd.active=!0,this.confirm_bg_nd.active=!0)},this)},setData:function(t){this.data=t,this.root_wnd&&this.onShow()},onShow:function(){if(null!=this.data){var t=this.data;if(this.charge_price_lb.string=t.need_rmb/100,this.price_lb.string=t.get_gold,1==t.is_first?this.first_bg_nd.active=!0:this.first_bg_nd.active=!1,t.add_gold>0){this.extra_bg_nd.active=!0,this.extra_desc_lb.string=Utils.TI18N("\u8d60");var e=s.getItemRes(Utils.getItemConfig(4).icon);this.extra_rt.string=cc.js.formatStr(Utils.TI18N("<img src='%s' scale=0.3 /><outline width=2 color=#5b2c06>%s</outline>"),Utils.getItemConfig(4).icon,t.add_gold),this.loadRes(e,function(t){this.extra_rt.spriteFrame=t}.bind(this))}else if(1==t.id||2==t.id){this.coin_sp.node.active=!1,this.price_lb.string=t.name,this.extra_bg_nd.active=!0,this.extra_desc_lb.string=Utils.TI18N("\u5373\u5f97");e=s.getItemRes(Utils.getItemConfig(Config.item_data.data_assets_label2id.gold).icon);this.extra_rt.string=cc.js.formatStr(TI18N("<img src='%s' scale=0.3 /><outline width=2 color=#5b2c06>%s</outline>"),Utils.getItemConfig(Config.item_data.data_assets_label2id.gold).icon,t.get_gold),this.loadRes(e,function(t){this.extra_rt.spriteFrame=t}.bind(this)),this.icon_sp.node.scale=.8,this.updateYuekaInfoData(t)}this.loadRes(s.getUIIconPath("vip","vip_icon"+t.pic),function(t){this.icon_sp.spriteFrame=t}.bind(this))}},updateYuekaInfoData:function(t){},getData:function(){return this.data},setSelect:function(t){this.confirm_tips_nd.active=t,this.confirm_bg_nd.active=t},addCallBack:function(t){this.callback=t},onHide:function(){},onDelete:function(){}});cc._RF.pop()},{pathtool:"pathtool"}],charge_panel:[function(t,e,i){"use strict";cc._RF.push(e,"2840dPTRbpJMKc5P2sS6la1","charge_panel");var s=t("pathtool"),n=t("charge_item"),a=t("vip_event");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("vip","charge_panel")},initConfig:function(){this.ctrl=t("vip_controller").getInstance(),this.role_vo=t("role_controller").getInstance().getRoleVo(),this.item_list={}},initPanel:function(){this.scroll_con=this.seekChild("scrollCon"),this.scroll_sv=this.seekChild("scrollCon",cc.ScrollView),this.content_nd=this.seekChild(this.scroll_con,"con")},registerEvent:function(){this.addGlobalEvent(a.UPDATE_CHARGE_LIST,function(t){for(var e in t){var i=t[e];Config.charge_data.data_charge_data[i.id]&&(i.sort=Config.charge_data.data_charge_data[i.id].sort)}t.sort(Utils.tableUpperSorter(["sort"])),this.createItemList(t)},this)},onShow:function(){this.ctrl.sender16700(),this.ctrl.sender21005(),t("welfare_controller").getInstance().sender16705()},createItemList:function(t){var e=this;if(null!=t){var i=Math.max(this.content_nd.getContentSize().height,235*Math.ceil(t.length/3)+20);this.content_nd.setContentSize(660,i),t.sort(Utils.tableLowerSorter(["get_gold"])),this.scroll_sv.scrollToTop(0);var s=function(s){var a=t[s];Utils.delayRun(e.content_nd,.05*(Number(s)+1),function(){if(null==this.item_list[s]){var t=new n,e=Number(s);t.setPosition(e%3*219-325,i/2-235*Math.ceil((e+1)/3)),t.show(),t.addCallBack(function(t){null!=this.select_item&&this.select_item.getData().id!=t.getData().id&&this.select_item.setSelect(!1),this.select_item=t}.bind(this)),t.setParent(this.content_nd),this.item_list[s]=t}this.item_list[s].setData(a)}.bind(e))};for(var a in t)s(a)}},setVisibleStatus:function(t){this.setVisible(t)},onHide:function(){},onDelete:function(){if(this.item_list){for(var t in this.item_list)this.item_list[t].deleteMe(),this.item_list[t]=null;this.item_list=null}}});cc._RF.pop()},{charge_item:"charge_item",pathtool:"pathtool",role_controller:"role_controller",vip_controller:"vip_controller",vip_event:"vip_event",welfare_controller:"welfare_controller"}],chat_const:[function(t,e,i){"use strict";var s,n,a;function o(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}cc._RF.push(e,"e3f06Exn6FD8J9PzRLf4h4+","chat_const");var l={TYPE_WORD:0,TYPE_VOICE:1,TYPE_TASK:2,TYPE_HERO:3,TYPE_PACK:4,ChannelTag:(s={},o(s,1,"Province"),o(s,2,"Cross"),o(s,3,"World"),o(s,4,"Gang"),o(s,5,"Friend"),o(s,6,"System"),s),ChatTimeIndex:(n={},o(n,2048,"cooldown_same_province"),o(n,1024,"cooldown_cross_service"),o(n,1,"cooldown_world"),o(n,4,"cooldown_guild"),n),Channel:{Province:2048,Cross:1024,World:1,Gang:4,Friend:7,System:16,NoticeTop:32,System1:64,SystemTop:128},ChannelLimit:{Province:40,Cross:40,World:40,Gang:30,Friend:80,System:50},Link:{Item_Show:49,Guild_Join:6,Guild_mem_red:7,Guild_show_red:8,BargainHelp:15,BigworldBoss:16,BigworldBossPos:17,OtherRole:18,Watch_Ladder:51,Open_Ladder:52,Open_Vedio_info:57}};l.ainNameColor=(o(a={},l.Channel.Province,"#24ecf3"),o(a,l.Channel.Cross,"#24ecf3"),o(a,l.Channel.World,"#24ecf3"),o(a,l.Channel.Gang,"#24ecf3"),o(a,l.Channel.Friend,"#24ecf3"),o(a,l.Channel.System,"#24ecf3"),a),e.exports=l,cc._RF.pop()},{}],chat_controller:[function(t,e,i){"use strict";cc._RF.push(e,"bfba6w+qEdKqbSx0rq3BbHq","chat_controller");var s=t("chat_const"),n=cc.Class({extends:BaseController,ctor:function(){var e=t("chat_model");this.model=new e(this),this.model.initConfig(),this.chat_time={}},registerEvents:function(){this.init_role_event=gcore.GlobalEvent.bind(EventId.EVT_ROLE_CREATE_SUCCESS,function(){gcore.GlobalEvent.unbind(this.init_role_event),this.model.initPrivatreTargets()}.bind(this))},openChatPanel:function(e,i,n){var a={};if(!this.chat_window){var o=t("chat_window");this.chat_window=new o}a.channel=i,"friend"==i&&(this.model.addPrivateTarget(n),a.channel=s.Channel.Friend,a.friend_data=n),this.chat_window.getVisible()?this.chat_window.open(a):this.chat_window.setVisible(!0,a)},closeChatPanel:function(){if(this.chat_window){var e=t("prompt_controller"),i=t("prompt_type_const");e.getInstance().getModel().removePromptDataByTpye(i.Private_chat),e.getInstance().getModel().removePromptDataByTpye(i.At_notice),this.chat_window.setVisible(!1),t("mainui_controller").getInstance().showChatBtn(!0)}},initData:function(){},getModel:function(){return this.model},initConfig:function(){var e=t("chat_model");this.model=new e,this.model.initConfig(),this.is_first=!0,this.pro_12766=!0,this.stack_id=0},registerProtocals:function(){this.RegisterProtocal(12720,this.handle12720),this.RegisterProtocal(12721,this.handle12721),this.RegisterProtocal(12722,this.handle12722),this.RegisterProtocal(12725,this.handle12725),this.RegisterProtocal(12726,this.handle12726),this.RegisterProtocal(12741,this.handle12741),this.RegisterProtocal(12743,this.handle12743),this.RegisterProtocal(12799,this.handle12799),this.RegisterProtocal(12761,this.handle12761),this.RegisterProtocal(12762,this.handle12762),this.RegisterProtocal(12763,this.handle12763),this.RegisterProtocal(12766,this.handle12766),this.RegisterProtocal(12771,this.handle12771),this.RegisterProtocal(12767,this.handle12767),this.RegisterProtocal(12768,this.handle12768)},isChatOpen:function(){return!!this.chat_window&&this.chat_window.getVisible()},sendVoidMsg:function(t,e,i){e==s.Channel.Friend?this.sender12720():this.sender12762()},sendMessage:function(t,e,i,n,a,o){cc.log("chat__________",e,t,i,n,a),t==s.Channel.Friend?this.sender12720(n,a,e,i,o):this.sender12762(t,e,i)},sender12720:function(t,e,i,s,n){var a={};if(a.to_srv_id=t,a.to_rid=e,a.msg=i,a.len=s,this.SendProtocal(12720,a),"AIWEIYOU_PID"==window.CHANNEL){var o;o=(e=String(e)).split("_")[1],sdk.chatMonitor({to_srv_id:t,to_rid:o,type:1,name:n,msg:i})}},handle12720:function(t){cc.log("\u79c1\u804a\u5931\u8d25"),cc.log(t),0==t.code&&message(t.msg)},handle12721:function(t){cc.log("\u79c1\u804a\u6d88\u606f"),cc.log(t),t&&this.model.addPrivateMsg(t)},handle12722:function(t){if(cc.log("\u79bb\u7ebf\u79c1\u804a\u6d88\u606f"),cc.log(t),t&&t.offline_list.length>0)for(var e=null,i=0;i<t.offline_list.length;i++)if((e=t.offline_list[i]).msg_list&&e.msg_list)for(var s=0;s<e.msg_list.length;s++){var n=Utils.deepCopy(e);delete n.msg_list,n.msg=e.msg_list[s].msg,n.len=e.msg_list[s].len,n.tick=e.msg_list[s].tick,n.offline=!0,n.flag=2,this.model.addOutlinePrivateMsg(n)}},sender12723:function(t,e){if(null!==t&&null!==e){var i={};i.rid=e,i.srv_id=t,this.SendProtocal(12723,i)}},handle12725:function(t){},handle12726:function(t){},handle12741:function(t){message(t.msg)},handle12743:function(t){message(t.msg);var e={len:0};e.channel=s.Channel.System,e.role_list={},e.msg=t.msg,this.handle12761(e,!0)},handle12799:function(t){},handle12761:function(t){t&&(this.pro_12766&&!this.is_first&&(this.pro_12766=!1),this.is_first=!1,this.model.addNormalChatMsg(t.channel,t),this.handle12761__(t))},handle12761__:function(t){var e=t.channel;if(e==s.Channel.System||e==s.Channel.NoticeTop||e==s.Channel.System1||e==s.Channel.SystemTop){var i=t.msg;i=StringUtil.parseStr(i).string,GlobalMessageMgr.getInstance().showMoveHorizontal(i,new cc.Color(255,255,255))}},sender12762:function(t,e,i){if(t&&e&&i){var n={};if(n.channel=t,n.msg=e,n.len=i,this.canSend(t))this.SendProtocal(12762,n),this.saveChatTime(t);else{var a=gcore.SmartSocket.getTime(),o=this.chat_time["sec_"+t],l=s.ChatTimeIndex[t],r=SayConfig[l];if(r){var c=r.val+o-a;c=c||1,message(Utils.TI18N("\u8ddd\u79bb\u4e0b\u6b21\u53d1\u8a00\u8fd8\u5269\u4e0b"+c+"\u79d2"))}}}},canSend:function(t){if(!this.chat_time["sec_"+t])return!0;var e=this.chat_time["sec_"+t],i=gcore.SmartSocket.getTime(),n=s.ChatTimeIndex[t],a=SayConfig[n];return!!(a&&a.val+e<i)},saveChatTime:function(t){var e=gcore.SmartSocket.getTime(),i="sec_"+t;this.chat_time[i]=e},handle12762:function(t){cc.log("\u53d1\u9001\u901a\u7528\u804a\u5929\u7ed3\u679c"),cc.log(t),0==t.code&&message(t.msg)},handle12763:function(t){},handle12766:function(t){if(this.pro_12766){for(var e in this.pro_12766=!1,t.msg_list)this.handle12761(t.msg_list[e]);this.pro_12766=!0}},handle12771:function(t){},handle12767:function(t){this.model.setAtData(t),this.chat_window&&this.chat_window.showAtNotice(!0,t)},sender12768:function(t,e,i,s){var n={};n.rid=t,n.srv_id=e,n.channel=i,n.msg=s,this.SendProtocal(12768,n)},handle12768:function(t){},getUniqueId:function(){return null==this.stack_id&&(this.stack_id=0),this.stack_id=this.stack_id+1,this.stack_id},openFriendInfo:function(e){t("friend_controller").getInstance().openFriendCheckPanel(!0,e)},getChatInput:function(){if(this.chat_window&&this.chat_window.chat_input_panel)return this.chat_window.chat_input_panel},chatAtPeople:function(t,e){var i=this.getChatInput();i&&i.setInputText("@"+t+" ",e)},getId:function(t,e,i,s,n){for(var a=this.model.getChannelMsgs(t),o=1,l=0,r=a.length;l<r;l++)if(a[l].role_list&&a[l].role_list[0]){var c=a[l].role_list[0];e==c.srv_id&&i==c.rid&&s==c.name&&n==a[l].msg&&(o=a[l].id)}return o}});e.exports=n,cc._RF.pop()},{chat_const:"chat_const",chat_model:"chat_model",chat_window:"chat_window",friend_controller:"friend_controller",mainui_controller:"mainui_controller",prompt_controller:"prompt_controller",prompt_type_const:"prompt_type_const"}],chat_event:[function(t,e,i){"use strict";cc._RF.push(e,"1f45b6KTn9FPJp7tIQhA7zT","chat_event"),e.exports={AdjustMainChatZorder:"ChatEvent.AdjustMainChatZorder",UpdatePrivateCoseList:"ChatEvent.UpdatePrivateCoseList",UpdatePrivateChatRed:"ChatEvent.UpdatePrivateChatRed",EndCallBack:"ChatEvent.EndCallBack",AdjustMainChatBtnPos:"ChatEvent.AdjustMainChatBtnPos",MassageUpdate:"ChatEvent.MassageUpdate",MassageDelete:"ChatEvent.MassageDelete",PrivateMassageUpdate:"ChatEvent.PrivateMassageUpdate",PrivateMassageDelete:"ChatEvent.PrivateMassageDelete",CHAT_SELECT_ITEM:"ChatEvent.CHAT_SELECT_ITEM"},cc._RF.pop()},{}],chat_friend:[function(t,e,i){"use strict";cc._RF.push(e,"615e39yOiJIQY27u6DmUAVT","chat_friend");var s=t("commonalert");cc.Class({extends:BaseView,properties:{friend_vo:null,parent:null,select_cb:null,delete_cb:null,index:"",is_select:!1,head_path:null},ctor:function(){this.friend_vo=arguments[0],this.parent=arguments[1],this.is_select=arguments[2],this.index=this.friend_vo.srv_id+this.friend_vo.rid,this.initRootWind()},initRootWind:function(){var t=PathTool.getPrefabPath("chat","chat_friend");LoaderManager.getInstance().loadRes(t,function(t){this.root_wnd=t,this.parent.addChild(this.root_wnd),this.initWidget()}.bind(this))},initWidget:function(){this.head_sp=this.seekChild("head_icon",cc.Sprite),this.level_lb=this.seekChild("level",cc.Label),this.close_nd=this.seekChild("close_btn"),this.bg_nd=this.seekChild("bg_nd"),this.name_lb=this.seekChild("name",cc.Label),this.mask_bg_nd=this.seekChild("mask_bg"),this.is_select?this.mask_bg_nd.active=!1:this.mask_bg_nd.active=!0,this.close_nd.on(cc.Node.EventType.TOUCH_END,this.deleteItem.bind(this)),this.bg_nd.on(cc.Node.EventType.TOUCH_END,this.selectItem.bind(this)),this.updateWidget()},updateWidget:function(){this.head_path=PathTool.getHeadRes(this.friend_vo.face_id),LoaderManager.getInstance().loadRes(this.head_path,function(t){this.head_sp.spriteFrame=t}.bind(this)),this.level_lb.string=this.friend_vo.lev||"",this.name_lb.string=this.friend_vo.name||""},setSelectCallback:function(t){this.select_cb=t},setDeleteCallBack:function(t){this.delete_cb=t},selectItem:function(){this.select_cb&&this.select_cb(this.index,this.friend_vo)},cancelSelcet:function(){this.mask_bg_nd.active=!0},setSelectStatus:function(){this.mask_bg_nd.active=!1},deleteItem:function(){var t=Utils.TI18N("\u786e\u5b9a\u8981\u5220\u9664\u8be5\u597d\u53cb\u7684\u6240\u6709\u804a\u5929\u8bb0\u5f55\u5417\uff1f"),e=function(){this.delete_cb&&this.delete_cb(this.index,this.friend_vo),this.root_wnd.destroy()}.bind(this);s.show(t,Utils.TI18N("\u786e\u8ba4"),e,Utils.TI18N("\u53d6\u6d88"),null,2,null)}});cc._RF.pop()},{commonalert:"commonalert"}],chat_help:[function(t,e,i){"use strict";cc._RF.push(e,"b8dad4p7HVK56rHB0f6D8ny","chat_help");var s=t("chat_const"),n=t("chat_item_controller"),a=t("battle_controller"),o=t("mainui_controller"),l=t("mainui_const"),r=cc.Class({ctor:function(){this.chat_item_ctrl=n.getInstance()},onChatTouched:function(e,i,n){if(e&&i){var r=i.split("|");if(e==s.Link.Item_Show){var c=r[1],_=r[2]||0;this.chat_item_ctrl.sender10536(_,c)}else if(e==s.Link.Guild_Join)t("guild_controller").getInstance().requestJoinGuild(Number(r[1]),r[2],1);else if(e==s.Link.Open_Vedio_info){var h=r[1]||0,d=r[2]||"",u=r[3]||0,m=n.channel||s.Channel.World;t("vedio_controller").getInstance().send19908(h,d,u,m)}else if(5==e||e==s.Link.Watch_Ladder){if(1==a.getInstance().isInFight())return void message(Utils.TI18N("\u6b63\u5728\u6218\u6597\u4e2d\u6216\u8005\u89c2\u770b\u5f55\u50cf\u4e2d\uff0c\u65e0\u6cd5\u89c2\u770b\u5f55\u50cf"));var f=function(t,e){t[1]&&(a.getInstance().isInFight()||a.getInstance().getWatchReplayStatus()?message(Utils.TI18N("\u6b63\u5728\u6218\u6597\u4e2d\u6216\u8005\u89c2\u770b\u5f55\u50cf\u4e2d\uff0c\u65e0\u6cd5\u89c2\u770b\u5f55\u50cf")):e==s.Link.Watch_Ladder?a.getInstance().csRecordBattle(parseInt(t[2]),t[1]):a.getInstance().csRecordBattle(parseInt(t[1])))}.bind(this,r,e),p=Utils.TI18N("\u662f\u5426\u524d\u5f80\u67e5\u770b\u8be5\u5f55\u50cf"),g=Utils.TI18N("\u786e\u5b9a"),v=Utils.TI18N("\u53d6\u6d88");t("commonalert").show(p,g,f,v)}else if(29==e){var b=parseInt(r[2])||0,w=t("look_controller");n&&n.role_list&&n.role_list[0]&&w.getInstance().sender11062(b,n.role_list[0].srv_id)}else if(35==e){(I=t("chat_controller")).getInstance().closeChatPanel();var y=parseInt(r[1])||0;t("welfare_controller").getInstance().openMainWindow(!0,y)}else if(36==e){if((I=t("chat_controller")).getInstance().closeChatPanel(),1==t("welfare_controller").getInstance().getModel().getYuekaStatus());else t("vip_controller").getInstance().openVipMainWindow(!0)}else if(37==e){if((I=t("chat_controller")).getInstance().closeChatPanel(),1==o.getInstance().checkMainFunctionOpenStatus(l.icon.first_charge,l.function_type.other,!1)){var C=o.getInstance().getFunctionIconById(l.icon.first_charge),k=o.getInstance().getFunctionIconById(l.icon.first_charge_new1);if(C||k)t("newfirstcharge_controller").getInstance().openNewFirstChargeView(!0);else t("vip_controller").getInstance().openVipMainWindow(!0)}}else if(54==e){var S=t("action_controller"),T=t("action_const"),I=t("chat_controller");S.getInstance().openActionMainPanel(!0,null,T.ActionRankCommonType.time_summon),I.getInstance().closeChatPanel()}else if(66==e){S=t("action_controller"),T=t("action_const"),I=t("chat_controller");S.getInstance().openActionMainPanel(!0,null,T.ActionRankCommonType.elite_summon),I.getInstance().closeChatPanel()}else if(42==e){(I=t("chat_controller")).getInstance().closeChatPanel();var E=t("mainscene_controller"),B=t("scene_const"),x=E.getInstance().getBuildVo(B.CenterSceneBuild.arena);if(x&&x.is_lock)return void message(x.desc);o.getInstance().changeMainUIStatus(l.btn_index.main_scene,l.sub_type.arena_call)}}}});r.getInstance=function(){return r.instance||(r.instance=new r),r.instance},cc._RF.pop()},{action_const:"action_const",action_controller:"action_controller",battle_controller:"battle_controller",chat_const:"chat_const",chat_controller:"chat_controller",chat_item_controller:"chat_item_controller",commonalert:"commonalert",guild_controller:"guild_controller",look_controller:"look_controller",mainscene_controller:"mainscene_controller",mainui_const:"mainui_const",mainui_controller:"mainui_controller",newfirstcharge_controller:"newfirstcharge_controller",scene_const:"scene_const",vedio_controller:"vedio_controller",vip_controller:"vip_controller",welfare_controller:"welfare_controller"}],chat_input_list:[function(t,e,i){"use strict";cc._RF.push(e,"3ffd4NULitGMp+Gigbq6EtI","chat_input_list");var s=t("pathtool"),n=t("backpack_const"),a=t("chat_item_controller"),o={1:{source:"face_item",width:60,height:60,col:8},2:{source:"goods_item",width:100,height:100,col:5},3:{source:"equip_item",width:100,height:100,col:5}};cc.Class({extends:BasePanel,ctor:function(){this.ctrl=arguments[0],this.prefabPath=s.getPrefabPath("chat","chat_input_list"),this.chat_item_ctrl=a.getInstance()},initConfig:function(){this.cur_tab=null,this.item_lists={}},initPanel:function(){this.container_nd=this.seekChild("container");this.tab_bnts={};for(var t=1;t<=3;t++){var e=this.tab_bnts[t]={},i=this.seekChild("tab_btn_"+t);i.tab_tag=t,e.select_nd=i.getChildByName("select"),i.on(cc.Node.EventType.TOUCH_END,this.onClickTabBtns,this)}},registerEvent:function(){},onShow:function(t){this.selectTab(1)},onHide:function(){},onDelete:function(){},setSelectCB:function(t){this.select_cb=t},onClickTabBtns:function(t){t&&this.cur_tab!==t.target.tab_tag&&this.selectTab(t.target.tab_tag)},selectTab:function(t){this.cur_tab&&(this.tab_bnts[this.cur_tab].select_nd.active=!1),this.tab_bnts[t].select_nd.active=!0,this.updateCurPanel(t),this.cur_tab=t},updateCurPanel:function(t){this.cur_tab&&this.item_lists[this.cur_tab]&&this.item_lists[this.cur_tab].setRootVisible(!1),t&&this.item_lists[t]?this.item_lists[t].setRootVisible(!0):this.createItemList(t)},createItemList:function(e){var i=o[e],s=t("common_scrollview"),n=t(i.source),a=cc.size(this.container_nd.width,this.container_nd.height),l={item_class:n,start_x:0,space_x:0,start_y:0,space_y:0,item_width:i.width,item_height:i.height,col:i.col,once_num:1,need_dynamic:!0};this.item_lists[e]=new s,this.item_lists[e].createScroll(this.container_nd,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,a,l,cc.v2(.5,.5));var r=[],c=null;if(1===e){var _=Config.face_data.data_biaoqing;for(var h in _)r.push(_[h]);c=this.selectFaceCB.bind(this)}else if(2===e){r=t("backpack_controller").getInstance().getModel().getItemListForShare(),c=this.selectItemCB.bind(this)}else if(3===e){var d=t("hero_controller").getInstance().getModel().getHeroList();for(var u in d){var m=d[u];for(var f in m.eqm_list)m.partner_data=m,r.push({item_data:m.eqm_list[f],hero_info:m})}c=this.selectEquipCB.bind(this)}this.item_lists[e].setData(r,c)},selectFaceCB:function(t){t&&this.select_cb&&this.select_cb(t)},selectItemCB:function(t){t&&t.config&&this.chat_item_ctrl.send10535(1,t.id,0,1)},selectEquipCB:function(t){var e=t.item_data,i=t.hero_info;e&&e.config&&(n.checkIsEquip(e.config.type)?this.chat_item_ctrl.send10535(4,e.id,i.partner_id,2):n.checkIsArtifact(e.config.type)&&this.chat_item_ctrl.send10535(2,e.id,i.partner_id,2))}});cc._RF.pop()},{backpack_const:"backpack_const",backpack_controller:"backpack_controller",chat_item_controller:"chat_item_controller",common_scrollview:"common_scrollview",hero_controller:"hero_controller",pathtool:"pathtool"}],chat_input:[function(t,e,i){"use strict";cc._RF.push(e,"ea923y+uqlHmL0q5Enx7xlT","chat_input");var s=t("chat_event"),n=t("role_controller"),a=t("chat_item_controller"),o=t("chat_const"),l=cc.Class({extends:BasePanel,properties:{root_wnd:cc.Node,is_keyboard:!0,send_cb:null,visible:!0},ctor:function(){this.prefabPath=PathTool.getPrefabPath("chat","chat_input"),this.chat_item_ctrl=a.getInstance(),this.ctrl=t("chat_controller").getInstance()},initConfig:function(){this.item_code_list={},this.item_desc_list={},this.select_face=[]},initPanel:function(){var t=this.seekChild("change_btn"),e=this.seekChild("send_btn");this.chat_sound_nd=this.seekChild("chat_sound_icon"),this.chat_keybord_nd=this.seekChild("chat_keybord_icon"),this.keyboard_nd=this.seekChild("keybord"),this.sound_nd=this.seekChild("song_btn"),this.input_ed=this.seekChild("editbox",cc.EditBox),this.placholder_label=this.seekChild("PLACEHOLDER_LABEL",cc.Label),this.face_btn=this.seekChild("face_btn"),t.on(cc.Node.EventType.TOUCH_END,this.didClickChangeBtn,this),e.on(cc.Node.EventType.TOUCH_END,this.didClickSendBtn,this),this.face_btn.on(cc.Node.EventType.TOUCH_END,this.onClickFaceBtn,this)},registerEvent:function(){this.addGlobalEvent(s.CHAT_SELECT_ITEM,function(t){this.onEditTextAddItem(t)}.bind(this))},onShow:function(t){},onHide:function(){},onDelete:function(){this.chat_input_list&&this.chat_input_list.deleteMe()},setSendCallback:function(t){this.send_cb=t},didClickChangeBtn:function(t){this.is_keyboard?(this.is_keyboard=!1,this.chat_keybord_nd.active=!0,this.sound_nd.active=!0,this.chat_sound_nd.active=!1,this.keyboard_nd.active=!1):(this.is_keyboard=!0,this.chat_keybord_nd.active=!1,this.sound_nd.active=!1,this.chat_sound_nd.active=!0,this.keyboard_nd.active=!0)},repleaceAtPeopleText:function(t,e){var i=t.search(/@/),s=t.search(/ /);t.length;if(-1!=i&&-1!=s){var n=t.substring(i,s),a=cc.js.formatStr("<on click='handler' param='atpeople srvid=%s'><u>%s</u></on>",e,n+" ");t=t.replace(n,a)}return t},setChannel:function(t){this.channel=t},didClickSendBtn:function(){var t=this.getInputText();if(t){var e=t[0]||"",i=t[1]||"";if(e.length>0&&this.send_cb){var s=this.chat_item_ctrl.relapceFaceIconTag(e);for(var n in this.item_code_list){var a=this.item_code_list[n];s=s.replace(new RegExp(a.key,"i"),a.desc)}this.channel!=o.Channel.World&&this.channel!=o.Channel.Cross&&this.channel!=o.Channel.Province&&this.channel!=o.Channel.Gang||(s=this.repleaceAtPeopleText(s,i)),this.ctrl.canSend(this.channel)&&(this.input_ed.string=""),this.send_cb(s),this.chat_input_list&&this.chat_input_list.setVisible(!1)}}},onClickFaceBtn:function(e){if(this.chat_input_list)this.chat_input_list.isOpen()?this.chat_input_list.setVisible(!1):this.chat_input_list.setVisible(!0);else{var i=t("chat_input_list"),s=this.chat_input_list=new i;s.setParent(this.root_wnd),s.setSelectCB(this.onEditTextAddFace.bind(this)),s.show()}},onEditTextAddFace:function(t){t&&(this.select_face.length<5?(this.select_face.push(t),this.input_ed.string+=t):message(Utils.TI18N("\u53d1\u8a00\u4e2d\u4e0d\u80fd\u8d85\u8fc75\u4e2a\u8868\u60c5")))},onEditTextAddItem:function(t){if(t){var e=this.input_ed.string;""==e&&(this.item_code_list={},this.item_desc_list={});var i=t.base_id,s=t.share_id,a=t.count,o=n.getInstance().getRoleVo(),l=Utils.getItemConfig(i),r=t.code;if(l){var c=cc.js.formatStr("{%s,%s}",s,l.name),_=this.chat_item_ctrl.buildItemMsg(i,o.srv_id,s,a);if(this.item_code_list[r]){var h=this.item_code_list[r],d=h.key;h.desc;e=e.replace(d,c)}else e+=c;this.item_code_list[r]={key:c,desc:_},this.input_ed.string=e}}},setPlacholderLabel:function(t){this.placholder_label&&t&&(this.placholder_label.string=t)},getInputText:function(){return[this.input_ed.string,this.extend]},setInputText:function(t,e){this.extend=e,this.input_ed&&(t||(t=""),this.input_ed.string=t)}});e.exports=l,cc._RF.pop()},{chat_const:"chat_const",chat_controller:"chat_controller",chat_event:"chat_event",chat_input_list:"chat_input_list",chat_item_controller:"chat_item_controller",role_controller:"role_controller"}],chat_item_controller:[function(t,e,i){"use strict";cc._RF.push(e,"5cfb3xdItxGKKjOd3kfE5/Q","chat_item_controller");var s=t("chat_const"),n=t("chat_event"),a=t("backpack_const"),o=t("goods_vo"),l=t("hero_controller"),r=(t("tips_controller"),t("partner_const"));cc.Class({extends:BaseController,ctor:function(){},registerProtocals:function(){this.RegisterProtocal(12418,this.handle12418.bind(this)),this.RegisterProtocal(12419,this.handle12419.bind(this)),this.RegisterProtocal(11221,this.handle11221.bind(this)),this.RegisterProtocal(11222,this.handle11222.bind(this)),this.RegisterProtocal(10535,this.handle10535.bind(this)),this.RegisterProtocal(10536,this.handle10536.bind(this))},buildItemMsg:function(t,e,i,n){var o=Utils.getItemConfig(t);n=n||0;var l=o.name;if(n>1&&(l=l+"x"+n),o)return cc.js.formatStr("<color=%s><on click='handler' param='%s|%s|%s'>[%s]</on></color>",a.quality_color(o.quality),s.Link.Item_Show,e,i,l)},relapceFaceIconTag:function(t){for(var e=/(#)\d+/g,i=null;null!=(i=e.exec(t));){var s=i[0].slice(1,i[0].length),n=Config.face_data.data_biaoqing[s],a="";n&&(a=cc.js.formatStr("<img src='emoji' emoji='%s'/>",n.name)),t=t.replace(new RegExp(i[0],"i"),a)}return t},analyzeMessage:function(t){for(var e=/(src=)/g;null!=e.exec(t);)t+="**";return t},getImages:function(t){var e=[],i=t.match(/src='(\S*)'/g);for(var s in i){var n=i[s].match(/src='(\S*)'/);"emoji"!==n[1]&&e.push(n[1])}return e},getEmojis:function(t){var e=[],i=t.match(/emoji='(\S*)'/g);for(var s in i){var n=i[s].match(/emoji='(\S*)'/);e.push(n[1])}return e},handle12418:function(t){},handle12419:function(t){},handle11221:function(t){},handle11222:function(t){},send10535:function(t,e,i,s){var n={};n.type=t,n.id=e,n.partner_id=i,n.code=s,this.SendProtocal(10535,n)},handle10535:function(t){1==t.flag?gcore.GlobalEvent.fire(n.CHAT_SELECT_ITEM,t):message(t.msg)},sender10536:function(t,e){if(t){var i={};i.srv_id=e,i.id=t,this.SendProtocal(10536,i)}},handle10536:function(e){if(e){var i=new o;if(i.setBaseId(e.base_id),i.initAttrData(e),!i.config)return void message(Utils.TI18N("\u6570\u636e\u5f02\u5e38"));if(a.checkIsEquip(i.config.type))l.getInstance().openEquipTips(!0,i,r.EqmTips.other);else if(a.checkIsArtifact(i.config.type))l.getInstance().openArtifactTipsWindow(!0,i,r.ArtifactTips.normal);else{t("tips_controller").getInstance().showGoodsTips(i.config)}}}});cc._RF.pop()},{backpack_const:"backpack_const",chat_const:"chat_const",chat_event:"chat_event",goods_vo:"goods_vo",hero_controller:"hero_controller",partner_const:"partner_const",tips_controller:"tips_controller"}],chat_item:[function(t,e,i){"use strict";cc._RF.push(e,"0c5beN4BwhJVbiEQYzIsQu+","chat_item");var s=t("pathtool"),n=(t("goods_vo"),s=t("pathtool"),t("backpack_const"),t("chat_const")),a=t("chat_item_controller"),o=t("chat_help"),l=t("chat_controller");cc.Class({extends:BaseView,properties:{content:null,msg_index:0,data:null,height:100,update_cb:null,pos_y:0,is_mine:!1,head_margin:63,name_margin:120,msg_bg_pos:220,msg_rt_pos:200,channel:null,init_ing:!1,have_nd:!0,head_sp:null,sp_res:null,is_loading:!1},ctor:function(){this.content=arguments[0],this.data=arguments[1],this.height=arguments[2],this.pos_y=arguments[3],this.channel=arguments[4];var e,i=t("role_controller"),o=this.role_vo=i.getInstance().getRoleVo();if(this.channel===n.Channel.Friend)1!==this.data.flag&&11!==this.data.flag&&this.data.flag?(this.face_id=this.data.face_id,this.r_name=this.data.name):(this.is_mine=!0,this.face_id=o.face_id,this.r_name=o.name);else if(this.channel===n.Channel.System);else if(this.data&&this.data.role_list&&this.data.role_list[0]){var l=this.data.role_list[0];l.rid===o.rid&&l.srv_id===o.srv_id&&(this.is_mine=!0),this.face_id=this.data.role_list[0].face_id,this.r_name=this.data.role_list[0].name}e=0==this.data.len?StringUtil.parseStr(this.data.msg,"handler").string:this.data.msg,this.msg=e,this.head_path=s.getHeadRes(this.face_id),this.chat_item_ctrl=a.getInstance(),this.updateInterval=1,this.updateTimer=0,this.totalCount=0},initRootWind:function(){if(!this.init_ing)if(this.root_wnd=this.content.getChatItemNd(),this.root_wnd)this.have_nd=!0,this.root_wnd.active=!0,this.initWidget();else{var t=s.getPrefabPath("chat","chat_item");LoaderManager.getInstance().loadRes(t,function(t){this.init_ing=!1;var e=t;this.content&&this.content.msgs_content&&(e.parent=this.content.msgs_content,this.have_nd?(this.root_wnd=e,this.initWidget()):(e.active=!1,this.content.chat_items_cache.push(e)))}.bind(this)),this.init_ing=!0}},initWidget:function(){this.common_msg_nd=this.seekChild("common_msg"),this.notice_msg_nd=this.seekChild("notice"),this.head_nd=this.seekChild("head_bg"),this.name_nd=this.seekChild("name_nd"),this.head_kuang_sp=this.seekChild("head_kuang",cc.Sprite),this.sex_nd=this.seekChild("sex"),this.sex_sp=this.seekChild("sex",cc.Sprite),this.msg_root_nd=this.seekChild("msg_root"),this.message_bg_nd=this.seekChild("msg_bg"),this.head_sp=this.seekChild("head_sp",cc.Sprite),this.name_lb=this.seekChild("name_nd",cc.Label),this.message_rt=this.seekChild("msg_rt",cc.RichText),this.message_nd=this.seekChild("msg_rt"),this.notice_msg_rt=this.seekChild("notice_msg",cc.RichText),this.head_wd=this.head_nd.getComponent(cc.Widget),this.name_wd=this.name_nd.getComponent(cc.Widget),this.message_wd=this.message_nd.getComponent(cc.Widget),this.root_wnd.height=100,this.message_nd.height=24,this.message_bg_nd.height=36,this.message_rt.addTouchHandler("handler",this.onClickItem.bind(this)),this.notice_msg_rt.addTouchHandler("handler",this.onClickItem.bind(this)),this.data&&(this.updateWidget(),this.register())},register:function(){this.head_kuang_sp.node.on(cc.Node.EventType.TOUCH_START,this.upBtnStart,this),this.head_kuang_sp.node.on(cc.Node.EventType.TOUCH_CANCEL,this.upBtnEnd,this),this.head_kuang_sp.node.on(cc.Node.EventType.TOUCH_END,this.upBtnEnd,this)},upBtnStart:function(){this.stopUpdate(),this.startUpdate()},upBtnEnd:function(){if(this.stopUpdate(),this.totalCount<this.updateInterval)this.touchHead();else{if(null==this.data||null==this.data.role_list||null==this.data.role_list[0]||null==this.role_vo)return this.totalCount=0,void(this.updateTimer=0);if(this.data.role_list[0].rid==this.role_vo.rid&&this.data.role_list[0].srv_id==this.role_vo.srv_id)return this.totalCount=0,void(this.updateTimer=0);var t=l.getInstance().getChatInput();t&&t.setInputText("@"+this.data.role_list[0].name+" ")}this.totalCount=0,this.updateTimer=0},update:function(t){if(0==this.head_kuang_sp.node.active)return this.totalCount=0,this.updateTimer=0,void this.stopUpdate();if(this.updateTimer+=t,this.totalCount+=t,this.updateTimer>=this.updateInterval){if(this.updateTimer=0,null==this.data||null==this.data.role_list||null==this.data.role_list[0]||null==this.role_vo)return void this.stopUpdate();if(this.data.role_list[0].rid==this.role_vo.rid&&this.data.role_list[0].srv_id==this.role_vo.srv_id)return void this.stopUpdate();var e=l.getInstance().getChatInput();e&&e.setInputText("@"+this.data.role_list[0].name+" ")}},touchHead:function(){var t,e,i;this.channel!==n.Channel.Friend&&(this.data&&this.data.role_list&&this.data.role_list[0]&&(t=this.data.role_list[0].rid,e=this.data.role_list[0].srv_id,i=this.data.role_list[0].name),t!=this.role_vo.rid&&(Utils.playButtonSound(1),l.getInstance().openFriendInfo({srv_id:e,rid:t,channel:this.channel,name:i})))},onShow:function(){},updateData:function(t,e,i){this.data=t,this.pos_y=i},updateWidget:function(){if(this.channel==n.Channel.System)return this.common_msg_nd.active=!1,this.notice_msg_nd.active=!0,this.root_wnd.y=-this.pos_y,this.notice_msg_rt.string=this.msg,this.notice_msg_nd.width=640,this.notice_msg_nd.height=this.notice_msg_rt.node.height+20,void(this.root_wnd.height=this.notice_msg_nd.height+20);this.notice_msg_nd.active=!1;var t=cc.delayTime(.1),e=cc.callFunc(function(){this.common_msg_nd.active=!0},this),i=cc.sequence(t,e);this.root_wnd.runAction(i),this.is_mine?(this.head_wd.isAlignLeft=!1,this.head_wd.isAlignRight=!0,this.head_wd.right=this.head_margin,this.name_wd.isAlignLeft=!1,this.name_wd.isAlignRight=!0,this.name_wd.right=this.name_margin,this.message_bg_nd.anchorX=1,this.message_nd.anchorX=1,this.message_nd.x=this.msg_rt_pos-5,this.message_bg_nd.scaleX=-1):(this.head_wd.isAlignLeft=!0,this.head_wd.isAlignRight=!1,this.head_wd.left=this.head_margin,this.name_wd.isAlignLeft=!0,this.name_wd.isAlignRight=!1,this.name_wd.left=this.name_margin,this.message_bg_nd.anchorX=0,this.message_nd.anchorX=0,this.message_bg_nd.x=-this.msg_bg_pos,this.message_nd.x=-this.msg_rt_pos,this.message_bg_nd.scaleX=1);var a=this.chat_item_ctrl.getEmojis(this.msg);for(var o in a){var l=s.getSpinePath(a[o]);this.loadRes(l,function(t,e){this.message_rt.addEmojiAtlas(e,t),this.message_bg_nd.height=this.message_nd.height+12,this.message_bg_nd.width=this.message_nd.width+30,this.is_mine&&(this.message_bg_nd.x=this.msg_bg_pos-this.message_bg_nd.width)}.bind(this,a[o]))}var r=this.chat_item_ctrl.getImages(this.msg);for(var c in r){var _=s.getItemRes(r[c]);this.loadRes(_,function(t){this.message_rt.spriteFrame=t,this.message_bg_nd.height=this.message_nd.height+12,this.message_bg_nd.width=this.message_nd.width+30,this.is_mine&&(this.message_bg_nd.x=this.msg_bg_pos-this.message_bg_nd.width)}.bind(this))}this.message_rt.maxWidth=0,this.message_rt.string=this.msg,this.root_wnd.y=-this.pos_y,this.message_nd.width>=400?this.message_rt.maxWidth=400:this.message_rt.maxWidth=0,this.message_bg_nd.height=this.message_nd.height+12,this.message_bg_nd.width=this.message_nd.width+30,this.is_mine&&(this.message_bg_nd.x=this.msg_bg_pos-this.message_bg_nd.width),this.root_wnd.height+=this.message_nd.height,this.sp_res?this.head_sp.spriteFrame=this.sp_res:this.is_loading||(this.is_loading=!0,this.loadRes(this.head_path,function(t){this.sp_res=t,this.head_sp.spriteFrame=this.sp_res,this.is_loading=!1}.bind(this)));var h=this.data;this.channel===n.Channel.Friend?h=this.data:this.data&&this.data.role_list&&this.data.role_list[0]&&(h=this.data.role_list[0]),this.loadFrameRes(h.head_bid);var d=this.r_name;if(this.channel==n.Channel.Cross||this.channel==n.Channel.Province&&(d=this.is_mine?cc.js.formatStr("%s    %s",h.city,this.r_name):cc.js.formatStr("%s    %s",this.r_name,h.city)),this.name_lb.string=d,2!==h.sex&&"number"==typeof h.sex){this.sex_nd.active=!0;var u=s.getUIIconPath("common","common_sex"+h.sex);this.loadRes(u,function(t){this.sex_sp.spriteFrame=t}.bind(this))}else this.sex_nd.active=!1;0===h.is_show_vip&&h.vip_lev>0&&(this.channel,n.Channel.Province)},loadFrameRes:function(t,e){if(null==e&&(e=100/117),"number"==typeof t){var i=Config.avatar_data.data_avatar[t];if(!i)return;var n=s.getHeadcircle(i.res_id);this.loadRes(n,function(t){this.head_kuang_sp.spriteFrame=t}.bind(this)),this.head_kuang_sp.node.scale=e,this.head_kuang_sp.node.y=1e3==t?0:5}else null==t&&(t=s.getCommonIcomPath("common_1031"),e=1),this.loadRes(t,function(t){this.head_kuang_sp.spriteFrame=t}.bind(this)),this.head_kuang_sp.node.scale=e,this.head_kuang_sp.node.y=0},onHide:function(){},onDelete:function(){this.stopUpdate()},updateContent:function(t){if(t)return this.root_wnd&&(this.head_kuang_sp&&this.head_kuang_sp.node&&(this.head_kuang_sp.node.off(cc.Node.EventType.TOUCH_START,this.upBtnStart,this),this.head_kuang_sp.node.off(cc.Node.EventType.TOUCH_CANCEL,this.upBtnEnd,this),this.head_kuang_sp.node.off(cc.Node.EventType.TOUCH_END,this.upBtnEnd,this)),this.root_wnd.active=!1,this.content.chat_items_cache.push(this.root_wnd),this.root_wnd=null),void(this.have_nd=!1);var e=this.content.getContentPos();this.pos_y<e+800&&this.pos_y>e-300?(this.have_nd=!0,this.root_wnd?this.root_wnd.y=-this.pos_y:this.initRootWind()):(this.root_wnd&&(this.head_kuang_sp&&this.head_kuang_sp.node&&(this.head_kuang_sp.node.off(cc.Node.EventType.TOUCH_START,this.upBtnStart,this),this.head_kuang_sp.node.off(cc.Node.EventType.TOUCH_CANCEL,this.upBtnEnd,this),this.head_kuang_sp.node.off(cc.Node.EventType.TOUCH_END,this.upBtnEnd,this)),this.root_wnd.active=!1,this.content.chat_items_cache.push(this.root_wnd),this.root_wnd=null),this.have_nd=!1)},onClickFrom:function(t,e){},onClickItem:function(t,e){var i=e.split("|"),s=i[0];i[1],i[2];o.getInstance().onChatTouched(s,e,this.data)},getId:function(){return this.data?this.data.id:null}});cc._RF.pop()},{backpack_const:"backpack_const",chat_const:"chat_const",chat_controller:"chat_controller",chat_help:"chat_help",chat_item_controller:"chat_item_controller",goods_vo:"goods_vo",pathtool:"pathtool",role_controller:"role_controller"}],chat_model:[function(t,e,i){"use strict";cc._RF.push(e,"0203cfpv4xJJ4a1YIssdxDX","chat_model");var s=t("chat_const"),n=t("chat_event"),a=t("role_controller");cc.Class({extends:BaseClass,properties:{stack_list:{default:{}},stack_limit:{default:{}},outline_msgs:{default:{}},private_targets:null,role_vo:null},ctor:function(){this.ctrl=arguments[0]},initConfig:function(){for(var t in this.unread_msgs={},s.Channel)this.unread_msgs[s.Channel[t]]=0;for(var e in s.Channel)this.stack_list[e]=[]},initChatMsg:function(){},addPrivateTarget:function(t){if(t){for(var e in this.private_targets||this.initPrivatreTargets(),this.private_targets)if(this.private_targets[e]&&this.private_targets[e].srv_id===t.srv_id&&this.private_targets[e].rid===t.rid)return;this.private_targets.push(t);var i=a.getInstance().getRoleVo();cc.sys.localStorage.setItem("rec_private"+i.srv_id+i.rid,JSON.stringify(this.private_targets))}},deltePrivateTarget:function(t){var e=a.getInstance().getRoleVo();cc.sys.localStorage.removeItem("rec_private"+e.srv_id+e.rid);var i=t.srv_id+t.rid;cc.sys.localStorage.removeItem(e.srv_id+e.rid+i);for(var s in this.private_targets){var n=this.private_targets[s];i==n.srv_id+n.rid&&this.private_targets.splice(s,1)}delete this.stack_list[i]},getPrivateTarget:function(t){if(t)for(var e in this.private_targets)if(this.private_targets[e].rid==t)return this.private_targets[e]},getPrivateTargets:function(){return this.private_targets||this.initPrivatreTargets(),cc.log(this.private_targets),this.private_targets},initPrivatreTargets:function(){if(!this.private_targets){var t=a.getInstance().getRoleVo(),e=cc.sys.localStorage.getItem("rec_private"+t.srv_id+t.rid);this.private_targets=e?JSON.parse(e):[]}},initPrivateMsg:function(t){if(t){var e=a.getInstance().getRoleVo(),i=JSON.parse(cc.sys.localStorage.getItem(e.srv_id+e.rid+t));this.stack_list[t]=i||[]}},addNormalChatMsg:function(t,e){if(t&&e){48==t&&(t=s.Channel.System,e.channel=t);var i=this.getChannelIndex(t);if(i){var a=!0;if(this.stack_list[i].length>s.ChannelLimit[i]){var o=this.stack_list[i].shift();gcore.GlobalEvent.fire(n.MassageDelete,o),this.unread_msgs[t]>=s.ChannelLimit[i]&&(a=!1)}e.id=this.ctrl.getUniqueId(),this.stack_list[i].push(e),1!==e.flag&&a&&this.addUnreadNum(t),gcore.GlobalEvent.fire(n.MassageUpdate,e)}}},addOutlinePrivateMsg:function(t){var e=t.srv_id+t.rid;this.outline_msgs[e]||(this.outline_msgs[e]=[]),this.outline_msgs[e].push(t),this.addUnreadNum(s.Channel.Friend)},addPrivateMsg:function(e,i){if(e)if(e instanceof Array)for(var o in e)this.addPrivateMsg(e[o]);else{var l=!1;for(var r in this.private_targets)if(this.private_targets[r].rid==e.rid){l=!0;break}if(!l){var c=t("friend_controller").getInstance().getModel().getFriendInfo(e.srv_id,e.rid);c&&this.addPrivateTarget(c)}var _=e.srv_id+e.rid;if(this.stack_list[_]||this.initPrivateMsg(_),this.stack_list[_].length>s.ChannelLimit.Friend){e=this.stack_list[_].shift();(h={}).msg_data=e,h.channel=s.Channel.Friend,gcore.GlobalEvent.fire(n.PrivateMassageDelete,h)}var h={};e.id=this.ctrl.getUniqueId(),h.msg_data=e,h.channel=s.Channel.Friend,this.stack_list[_].push(e);var d=a.getInstance().getRoleVo();cc.sys.localStorage.setItem(d.srv_id+d.rid+_,JSON.stringify(this.stack_list[_])),1===e.flag||i||this.addUnreadNum(s.Channel.Friend),gcore.GlobalEvent.fire(n.PrivateMassageUpdate,h)}},getPrivateMsgs:function(t,e){var i=t+e;if(this.stack_list[i]||this.initPrivateMsg(i),this.outline_msgs[i]&&this.outline_msgs[i].length>0){for(;this.outline_msgs[i].length>0;){var s=this.outline_msgs[i].shift();this.addPrivateMsg(s,!0)}this.ctrl.sender12723(t,e)}var n=function(t,e){return t.tick-e.tick};return cc.log(this.stack_list[i].sort(n)),this.stack_list[i].sort(n)},getChannelIndex:function(t){var e;for(var i in s.Channel)s.Channel[i]==t&&(e=i);return e},getChannelMsgs:function(t){var e=this.getChannelIndex(t);return this.stack_list[e]?this.stack_list[e]:{}},cleanUnredNum:function(t){this.unread_msgs[t]>0&&(this.unread_msgs[t]=0,gcore.GlobalEvent.fire(EventId.CHAT_NEWMSG_FLAG))},addUnreadNum:function(t,e){e=e||1,this.unread_msgs[t]+=e,gcore.GlobalEvent.fire(EventId.CHAT_NEWMSG_FLAG)},getUnreadNum:function(t){if(t)return this.unread_msgs[t];var e=0,i=a.getInstance().getRoleVo();for(var s in this.unread_msgs)1024==s&&i&&i.lev<50||4==s&&i&&!i.gid||(e+=this.unread_msgs[s]);return e},saveTalkTime:function(t,e){},setAtData:function(t){this.at_data=t},getAtData:function(){return this.at_data}});cc._RF.pop()},{chat_const:"chat_const",chat_event:"chat_event",friend_controller:"friend_controller",role_controller:"role_controller"}],chat_window:[function(t,e,i){"use strict";cc._RF.push(e,"2a3200cqCNP0qW8Gqo7Gtmb","chat_window");var s=t("chat_const"),n=t("chat_event"),a=t("chat_item"),o=t("chat_item_controller");cc.Class({extends:BaseView,properties:{role_vo:null,channel:null,last_channel:null,prefabPath:null,chat_taps:{default:{}},cut_tap:null,msgs_content:cc.Node,chat_items:{default:{}},chat_items_cache:[],is_update:!1,update_index:0,chat_msgs:{default:{}},content_info:{default:{}},channel_tg:{default:{}},channel_red:{default:{}},private_targets:null,chat_friends:{default:{}},cur_friend:null,cur_friend_tap:null,chat_items_index:"",scroll_dis:0},ctor:function(){this.prefabPath=t("pathtool").getPrefabPath("chat","chat_window"),this.viewTag=SCENE_TAG.top;var e=t("role_controller");this.role_vo=e.getInstance().getRoleVo(),this.ctrl=t("chat_controller").getInstance(),this.model=this.ctrl.getModel(),this.timer||(this.timer=gcore.Timer.set(function(){this.mainLoop()}.bind(this),100,-1)),this.chat_item_ctrl=o.getInstance()},openCallBack:function(){this.msg_nd=this.seekChild("msg_rt"),this.msg_rt=this.seekChild("msg_rt",cc.RichText),this.mask_node=this.seekChild("masknd"),this.mask_node.scale=FIT_SCALE;var e=this.mask_node.addComponent(cc.Graphics);e.clear(),e.fillColor=cc.color(0,0,0,128),e.rect(.5*-this.root_wnd.width,.5*-this.root_wnd.height,this.root_wnd.width,this.root_wnd.height),e.fill(),this.contern_bg_nd=this.seekChild("contern_bg"),this.scrollview_nd=this.seekChild("scrollview_mgs"),this.scrollview_mgs_sc=this.seekChild("scrollview_mgs",cc.ScrollView),this.msgs_content=this.seekChild("content_msgs"),this.scrollview_nd.on("scrolling",this.contentScrolling.bind(this)),this.empty_tips_nd=this.seekChild("empty_tips"),this.empty_desc_lb=this.seekChild("empty_desc",cc.Label),this.private_add_bg_nd=this.seekChild("private_add_bg"),this.private_add_nd=this.seekChild("private_add"),this.private_nd=this.seekChild("friends_sv"),this.private_contend=this.seekChild("friends_content"),this.private_add_nd.on(cc.Node.EventType.TOUCH_END,this.onClickAddPriBtn,this);for(var i=1;i<=6;i++){var s=this.seekChild("toggle"+i);s.tag_1=i,s.on("toggle",this.checkToggle,this),s.on(cc.Node.EventType.TOUCH_END,this.didClickTap,this);var n=this.seekChild("chat_tap_"+i);this.chat_taps["chat_tap_"+i]=n;var a=s.getComponent(cc.Toggle);this.channel_tg[i]=a;var o=s.getChildByName("red"),l=o.getChildByName("red_num").getComponent(cc.Label);this.channel_red[i]={red:o,num:l}}this.notice_node=this.seekChild("notice_node"),this.notice_node.active=!1,this.notice_lab=this.seekChild("notice_label",cc.Label),this.notice_lab.string=Utils.TI18N("\u8be5\u9891\u9053\u4e0b\u65e0\u6cd5\u53d1\u8a00"),this.at_notice_node=this.seekChild("at_notice"),this.at_close=this.at_notice_node.getChildByName("at_close");var r=t("chat_input"),c=this.chat_input_panel=new r(this.ctrl);c.setParent(this.root_wnd),c.setSendCallback(this.didiClickSendMsg.bind(this)),c.show(),this.seekChild("close_btn").on(cc.Node.EventType.TOUCH_END,function(){this.ctrl.closeChatPanel()}.bind(this)),this.mask_node.on(cc.Node.EventType.TOUCH_END,function(){this.ctrl.closeChatPanel()}.bind(this))},registerEvent:function(){var e=t("role_event");this.role_update_event=this.role_vo.bind(e.ROLE_EVENT_ATTR_UPDATE,function(t,e){"lev"!=t&&"gid"!=t||this.updateWidget()}.bind(this)),this.addGlobalEvent(n.MassageUpdate,function(t){this.addMsgs(t,t.channel)}.bind(this)),this.addGlobalEvent(n.MassageDelete,function(t){this.deleteMsgs(t)}.bind(this)),this.addGlobalEvent(n.PrivateMassageUpdate,function(t){this.addMsgs(t.msg_data,t.channel)}.bind(this)),this.addGlobalEvent(n.PrivateMassageDelete,function(t){this.deleteMsgs(t.msg_data,t.channel)}.bind(this)),this.addGlobalEvent(EventId.CHAT_NEWMSG_FLAG,function(){this.setAllRedStatus()},this)},openRootWnd:function(t){var e=s.Channel.World;t&&t.channel&&(e=t.channel);var i=this.getChannelTag(e);e==s.Channel.Friend&&(this.cur_friend=t.friend_data),this.changeChannel(i),this.updateWidget(),this.setAllRedStatus()},closeCallBack:function(){this.role_vo&&this.role_update_event&&(this.role_vo.unbind(this.role_update_event),this.role_update_event=null,this.role_vo=null),this.chat_input_panel&&this.chat_input_panel.deleteMe(),this.timer&&gcore.Timer.del(this.timer),this.ctrl.closeChatPanel()},updateWidget:function(){for(var t in s.ChannelTag){var e=this.checkBtnIsOpen(t);this.setChannelStatus(t,e)}},checkBtnIsOpen:function(t){if(2==t){if(this.role_vo.lev<50)return!1}else if(4==t&&!this.role_vo.gid)return!1;return!0},setChannelStatus:function(t,e){var i=this.chat_taps["chat_tap_"+t].color;e?(i.fromHEX("#FFFFFF"),this.channel_tg[t].interactable=!0):(i.fromHEX("#F5E0B9"),this.channel_tg[t].interactable=!1)},getChannelTag:function(t){var e=null,i=null;for(var n in s.Channel)s.Channel[n]===t&&(i=n);if(i)for(var a in s.ChannelTag)s.ChannelTag[a]==i&&(e=a);return e},didiClickSendMsg:function(t){t.length>0&&(this.channel===s.Channel.Friend?this.cur_friend&&this.ctrl.sendMessage(this.channel,t,2,this.cur_friend.srv_id,this.cur_friend.rid,this.cur_friend.name):this.ctrl.sendMessage(this.channel,t,2))},checkToggle:function(t){var e=t.node.tag_1;e!=this.cur_select&&this.changeChannel(e)},didClickTap:function(t){2==t.target.tag_1&&this.role_vo.lev<50&&message(Utils.TI18N(Lang.CHAT_CROSS_DES)),4!=t.target.tag_1||this.role_vo.gid||message(Utils.TI18N(Lang.CHAT_Gang_DES)),this.setRedStatus(t.target.tag_1)},changeChannel:function(t){this.setRedStatus(t);var e=s.ChannelTag[t];if(this.last_chat_index=this.chat_items_index,this.channel=s.Channel[e],this.chat_input_panel.setVisible(!0),this.channel==s.Channel.Event||this.channel==s.Channel.System)this.chat_input_panel.setVisible(!1),this.notice_node.active=!0;else if(this.channel==s.Channel.Province){var i=Config.misc_data.data_const.province_level;!i||this.role_vo.lev<i.val?(this.chat_input_panel.setVisible(!1),this.notice_node.active=!1):(this.chat_input_panel.setVisible(!0),this.notice_node.active=!1)}else this.notice_node.active=!1;if(1===t&&(this.role_vo&&this.role_vo.lev<35?(this.empty_tips_nd.active=!0,this.empty_desc_lb.string=Utils.TI18N("\u89d2\u827235\u7ea7\u53ef\u89c1\u8be5\u9891\u9053\u804a\u5929\u5185\u5bb9"),this.chat_input_panel.setVisible(!1)):(this.empty_tips_nd.active=!1,this.chat_input_panel.setVisible(!0))),this.cut_tap){var n=this.chat_taps["chat_tap_"+this.cut_tap].color;n.fromHEX(Config.color_data.data_color16[141]),this.chat_taps["chat_tap_"+this.cut_tap].color=n}this.channel_tg[t].isChecked=!0,this.channel_tg[t].check();var a=this.chat_taps["chat_tap_"+t].color;if(a.fromHEX(Config.color_data.data_color16[254]),this.chat_taps["chat_tap_"+t].color=a,this.cut_tap=t,this.updageChannelSizeInfo(),this.chat_items_index=this.channel,this.channel==s.Channel.Friend){if(!this.private_targets){this.private_targets=[];var o=this.model.getPrivateTargets();if(o.length>0){this.cur_friend||(this.cur_friend=o[0]);for(var l=0;l<o.length;l++)this.addPrivateTap(o[l])}}this.cur_friend?(this.chat_items_index=this.cur_friend.srv_id+this.cur_friend.rid,this.private_add_bg_nd.active=!1):this.private_add_bg_nd.active=!0}else this.private_add_bg_nd.active&&(this.private_add_bg_nd.active=!1);this.model.cleanUnredNum(this.channel),this.updateMsgsContent();var r=Utils.TI18N("\u8bf7\u8f93\u5165\u4fe1\u606f");if(1==t||2==t||3==t||4==t){var c=this.model.getAtData();c&&Utils.next(c)&&this.showAtNotice(!0,c),r=Utils.TI18N("\u8bf7\u8f93\u5165\u4fe1\u606f,\u957f\u6309\u5934\u50cf\u53ef\u5feb\u6377@\u4eba")}this.chat_input_panel.setPlacholderLabel(r),this.chat_input_panel.setChannel(this.channel)},updageChannelSizeInfo:function(t){if(this.chat_items_index){this.content_info[this.chat_items_index]||(this.content_info[this.chat_items_index]={});var e=this.msgs_content.y,i=this.msgs_content.height;t&&(e=0,i=0),this.content_info[this.chat_items_index].c_pos=e,this.content_info[this.chat_items_index].c_height=i}},mainLoop:function(){this.is_update&&(this.chat_items[this.chat_items_index]&&this.update_index<this.chat_items[this.chat_items_index].length?(this.chat_items[this.chat_items_index][this.update_index].updateContent(),this.update_index++):(this.update_index=0,this.is_update=!1))},addMsgs:function(t,e){if(t){var i=e=e||t.channel;if(e===s.Channel.Friend&&(i=t.srv_id+t.rid),this.chat_items[i]){this.addMsgItem(t,e);i==this.chat_items_index&&this.msgs_content.height>this.scrollview_nd.height&&this.scrollview_mgs_sc.scrollToPercentVertical(0,.1,!0)}else i==this.chat_items_index&&this.getVisible()&&this.initItems(e,i);this.setRedStatus(e),e===this.channel&&this.getVisible()&&this.model.cleanUnredNum(e)}},deleteMsgs:function(t,e){if(t){e=e||t.channel;var i=t.channel;if(e===s.Channel.Friend&&(i=t.srv_id+t.rid),this.chat_msgs&&this.chat_msgs[i])this.chat_msgs[i].shift();if(this.chat_items&&this.chat_items[i]){var n=this.chat_items[i].shift();for(var a in n.updateContent(!0),this.content_info[i]&&(this.content_info[i].c_height-=n.height,this.content_info[i].c_pos-=n.height),this.chat_items[i])this.chat_items[i][a].pos_y-=n.height;(i=this.chat_items_index)&&(this.msgs_content.y-=n.height,this.updateMsgsContent())}this.setRedStatus(e)}},updateMsgsContent:function(){this.chat_items_index&&!this.chat_items[this.chat_items_index]&&(this.updageChannelSizeInfo(!0),this.initItems(this.channel,this.chat_items_index));var t=0,e=0;this.chat_items_index&&this.content_info[this.chat_items_index]&&(t=this.content_info[this.chat_items_index].c_pos,e=this.content_info[this.chat_items_index].c_height),this.channel==s.Channel.Friend?this.contern_bg_nd.height=730:this.contern_bg_nd.height=860,this.msgs_content.y=t,this.msgs_content.height=e,this.cleanConten(),this.updageItems()},addMsgItem:function(t,e){var i=e=e||t.channel,n=100;e===s.Channel.Friend&&(i=t.srv_id+t.rid);if(this.content_info[i]){e===s.Channel.System&&(n=30,10);var o=this.chat_item_ctrl.analyzeMessage(t.msg);this.msg_rt.string=o;var l=this.msg_nd.height+n,r=0;this.content_info[i]&&(r=this.content_info[i].c_height);var c=new a(this,t,l,r,e);return this.content_info[i].c_height+=l,this.chat_msgs[i].push(t),this.chat_items[i].push(c),i==this.chat_items_index&&(this.msgs_content.height+=l+10,this.chat_items[this.chat_items_index].length>0?this.empty_tips_nd.active=!1:(1!==this.cut_tap||this.role_vo&&this.role_vo.lev>35)&&(this.empty_tips_nd.active=!0,this.empty_desc_lb.string=Utils.TI18N("\u6682\u65f6\u6ca1\u6709\u4eba\u8bf4\u8bdd")),c.updateContent()),c}},cleanConten:function(){if(this.last_chat_index)for(var t in this.update_index=0,this.chat_items[this.last_chat_index])this.chat_items[this.last_chat_index][t].updateContent(!0)},contentScrolling:function(t){0==this.scroll_dis?this.scroll_dis=t.content.y:Math.abs(Math.abs(t.content.y)-Math.abs(this.scroll_dis))>40&&(this.updageItems(),this.scroll_dis=0)},initItems:function(t,e){if(t){this.msgs_content.height=0,this.msgs_content.y=0;var i=e||t,n=[];this.chat_msgs[i]=[],this.chat_items[i]=[],t==s.Channel.Friend&&e?this.cur_friend&&(n=this.model.getPrivateMsgs(this.cur_friend.srv_id,this.cur_friend.rid),this.ctrl.sender12723(this.cur_friend.srv_id,this.cur_friend.rid)):n=this.model.getChannelMsgs(t);for(var a=0;a<n.length;a++)this.addMsgItem(n[a],t);this.msgs_content.height>this.scrollview_nd.height&&this.scrollview_mgs_sc.scrollToBottom(.1),this.is_update=!0,this.update_index=0}},updageItems:function(){if(this.chat_items_index&&this.chat_items[this.chat_items_index]){for(var t in this.chat_items[this.chat_items_index])this.chat_items[this.chat_items_index][t].updateContent();this.chat_items[this.chat_items_index].length>0?this.empty_tips_nd.active=!1:(1!==this.cut_tap||this.role_vo&&this.role_vo.lev>35)&&(this.empty_tips_nd.active=!0,this.empty_desc_lb.string=Utils.TI18N("\u6682\u65f6\u6ca1\u6709\u4eba\u8bf4\u8bdd"))}},getChatItemNd:function(){if(this.chat_items_cache.length>0)return this.chat_items_cache.shift()},cacheChatItemNd:function(t){this.chat_items_cache.push(t)},getContentPos:function(){return this.msgs_content.y},addPrivateTap:function(e){for(var i=0;i<this.private_targets.length;i++)if(this.private_targets[i].srv_id===e.srv_id&&this.private_targets[i].rid===e.rid)return;var s=t("chat_friend"),n=!1;this.cur_friend&&this.cur_friend.srv_id===e.srv_id&&this.cur_friend.rid==e.rid&&(n=!0);var a=new s(e,this.private_contend,n);a.setSelectCallback(this.selectPrivate.bind(this)),a.setDeleteCallBack(this.deletePrivate.bind(this)),this.private_targets.push(e),this.chat_friends[e.srv_id+e.rid]=a,n&&(this.cur_friend_tap=a)},selectPrivate:function(t,e){t&&e&&t!==this.chat_items_index&&(this.updageChannelSizeInfo(),this.cur_friend_tap&&this.cur_friend_tap.cancelSelcet(),this.cur_friend_tap=this.chat_friends[e.srv_id+e.rid],this.cur_friend_tap.setSelectStatus(),this.cur_friend=e,this.last_chat_index=this.chat_items_index,this.chat_items_index=t,this.updateMsgsContent())},deletePrivate:function(t,e){if(t&&e){for(var i in this.private_targets)this.private_targets[i].rid===e.rid&&this.private_targets.splice(i,1);if(this.private_targets.length>0){var s=this.private_targets[0];t=s.srv_id+s.rid;this.selectPrivate(t,s),this.private_add_bg_nd.active=!1}else this.last_chat_index=e.srv_id+e.rid,this.chat_items_index=null,this.updateMsgsContent(),this.cur_friend=null,this.last_chat_index=null,this.private_add_bg_nd.active=!0;delete this.chat_friends[e.srv_id+e.rid],this.model.deltePrivateTarget(e)}},onClickAddPriBtn:function(){this.ctrl.closeChatPanel(),t("friend_controller").getInstance().openFriendWindow(!0)},setRedStatus:function(t){if(null!=t&&null!=this.channel_red&&null!=this.channel_red[t]&&!(2==t&&this.role_vo&&this.role_vo.lev<50||4==t&&this.role_vo&&!this.role_vo.gid)){var e=this.channel_red[t],i=this.model.getUnreadNum(s.Channel[s.ChannelTag[t]]);i>0?(e.red.active=!0,e.num.string=i):e.red.active=!1}},setAllRedStatus:function(){for(var t=1;t<=6;t++)this.setRedStatus(t)},showAtNotice:function(t,e){if(null!=this.root_wnd){this.at_close.targetOff(this);var i=function(){this.at_notice_node.active=!1,this.model.setAtData({}),e&&Utils.next(e)&&this.ctrl.sender12768(e.rid,e.srv_id,e.channel,e.msg)}.bind(this);Utils.onTouchEnd(this.at_close,function(){i()}.bind(this),1);var s=null;if(e&&null!=Utils.next(e)){var n=this.ctrl.getId(this.channel,e.srv_id,e.rid,e.name,e.msg),a=this.chat_items[this.channel];if(a){for(var o=!1,l=0,r=a.length;l<r;l++)if(a[l].getId()==n){s=a[l],this.at_notice_node.active=t,o=!0;break}0==o&&(this.at_notice_node.active=!1)}else this.at_notice_node.active=!1}else this.at_notice_node.active=!1;Utils.onTouchEnd(this.at_notice_node,function(t){if(t){var e=(this.msgs_content.height-t.pos_y-t.height)/this.msgs_content.height;e>1&&(e=1),this.scrollview_mgs_sc.scrollToPercentVertical(e,.1,!0),i()}}.bind(this,s),1)}},setVisible:function(t,e){if(this.active_status!=t)if(this.active_status=t,this.root_wnd?this.root_wnd.active=t:this.fastShowThenHide=t,1==t)this.openRootWnd(e);else if(this.chat_friends){for(var i in this.chat_friends){var s=this.chat_friends[i];s&&s.deleteMe&&(s.deleteMe(),s=null)}this.chat_friends={},this.private_targets=null}}});cc._RF.pop()},{chat_const:"chat_const",chat_controller:"chat_controller",chat_event:"chat_event",chat_friend:"chat_friend",chat_input:"chat_input",chat_item:"chat_item",chat_item_controller:"chat_item_controller",friend_controller:"friend_controller",pathtool:"pathtool",role_controller:"role_controller",role_event:"role_event"}],cli_log:[function(t,e,i){"use strict";cc._RF.push(e,"269e49DJp9NJa8HiulckyVD","cli_log");var s=!0;s=s&&null!=LOG_URL,window.cli_log={log_to_web:function(t,e){},getSignValue:function(t){},log_to_idfa_web:function(t){},log_url_encode:function(t){},log_get_device_info:function(){},log_flag:function(t,e){},log_activate_device:function(){},log_flash:function(){},log_advice:function(){},log_loading_start:function(){},log_loading_end:function(){},log_reg_account:function(t){},log_select_server:function(t){},log_create_role:function(t){},log_enter_city:function(t){},log_get_def_srv:function(t){}},cc._RF.pop()},{"md5.min":"md5.min"}],collect_panel:[function(t,e,i){"use strict";cc._RF.push(e,"d2940cZ54tG06gpzkmWRYBh","collect_panel");var s=t("pathtool"),n=t("welfare_event");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("welfare","collect_panel")},initConfig:function(){this.ctrl=t("welfare_controller").getInstance(),this.item_list={},this.is_can_get=!1},initPanel:function(){if(this.main_container=this.seekChild("main_container"),this.item_container=this.seekChild(this.main_container,"item_container"),this.bg_sp_2=this.seekChild(this.main_container,"bg_2",cc.Sprite),this.loadRes(s.getBigBg("welfare/txt_cn_shwx_collect","jpg"),function(t){this.bg_sp_2.spriteFrame=t}.bind(this)),this.desc=this.seekChild(this.main_container,"txt_2",cc.Label),this.desc.string=Utils.TI18N("1.\u70b9\u51fb\u201c\u53f3\u4e0a\u89d2\u4e09\u4e2a\u70b9\u201d \u2022\u2022\u2022\n2.\u70b9\u51fb\u201c\u6dfb\u52a0\u5230\u6211\u7684\u5c0f\u7a0b\u5e8f\u201d\n3.\u70b9\u51fb\u201c\u5173\u95ed\u5706\u5708\u201d \u2299\n4.\u70b9\u51fb\u6211\u7684\u5c0f\u7a0b\u5e8f\u201c\u5251\u9b42\u4e4b\u5149\u201d\u5f00\u542f\u6e38\u620f\uff0c\u9886\u53d6\u5956\u52b1"),this.go_btn=this.seekChild(this.main_container,"go_btn"),this.go_btn_lb=this.seekChild(this.go_btn,"label",cc.Label),this.go_btn_lb.string=Utils.TI18N("\u6536\u85cf\u9886\u597d\u793c"),this.go_btn_lo=this.seekChild(this.go_btn,"label",cc.LabelOutline),this.go_btn_btn=this.seekChild(this.main_container,"go_btn",cc.Button),1==this.ctrl.getModel().getCollectAwardStatus()&&(this.go_btn_lb.string=Utils.TI18N("\u5df2\u9886\u53d6"),this.go_btn_lo.enabled=!1,Utils.setGreyButton(this.go_btn_btn)),window.wx){var t=wx.getLaunchOptionsSync();(1==wx.getStorageSync("is_open_scene")||t&&t.scene&&(1001==t.scene||1089==t.scene||1103==t.scene||1104==t.scene))&&(this.is_can_get=!0,wx.setStorageSync("is_open_scene",1))}},registerEvent:function(){this.go_btn.on("click",function(){Utils.playButtonSound(1),"SH_SDK"==PLATFORM_TYPR&&this.clickGoBtnBySHWX()}.bind(this)),this.addGlobalEvent(n.Update_get_SHWX_collect_award_status,function(t){2==t?this.go_btn_lb.string=Utils.TI18N("\u6536\u85cf\u9886\u597d\u793c"):1==t&&(this.go_btn_lb.string=Utils.TI18N("\u5df2\u9886\u53d6"),this.go_btn_lo.enabled=!1,Utils.setGreyButton(this.go_btn_btn))}.bind(this)),this.addGlobalEvent(n.Update_SHWX_show_scene_val,function(t){1!=this.ctrl.getModel().getCollectAwardStatus()&&1!=this.is_can_get&&(window.wx&&(1==wx.getStorageSync("is_open_scene")||t&&(1001==t||1089==t||1103==t||1104==t))&&(this.is_can_get=!0,wx.setStorageSync("is_open_scene",1)))}.bind(this))},clickGoBtnBySHWX:function(){1==this.is_can_get?0==this.ctrl.getModel().getCollectAwardStatus()&&this.ctrl.send16696():message(Utils.TI18N("\u8bf7\u5148\u6536\u85cf\u5230\u6211\u7684\u5c0f\u7a0b\u5e8f"))},onShow:function(t){this.setItemList()},setItemList:function(){if("SH_SDK"==PLATFORM_TYPR){var t=this.ctrl.getModel().getCollectAward();if(null==t)return;var e=0;for(var i in t){var s=t[i];if(!this.item_list[i]){var n=ItemsPool.getInstance().getItem("backpack_item");n.initConfig(!1,.7,!1,!0),n.show(),n.setParent(this.item_container),n.setData({bid:s.bid,num:s.num}),n.setPosition(110*e-110,80),this.item_list[i]=n,e+=1}}}},onHide:function(){},onDelete:function(){if(this.is_shate=!1,this.item_list){for(var t in this.item_list)this.item_list[t].deleteMe(),this.item_list[t]=null;this.item_list=null}}});cc._RF.pop()},{pathtool:"pathtool",welfare_controller:"welfare_controller",welfare_event:"welfare_event"}],common_explain_window:[function(t,e,i){"use strict";cc._RF.push(e,"30b0bjFY85GjrR9Du6UKr6X","common_explain_window");var s=t("pathtool"),n=cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("common","common_explain_view"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Mini,this.ctrl=arguments[0]},initConfig:function(){this.max_height=0,this.cache_list=[],this.title_str=Utils.TI18N("\u89c4\u5219"),this.color_1=new cc.Color(104,69,42,255)},openCallBack:function(){this.background=this.root_wnd.getChildByName("background"),this.background.scale=FIT_SCALE,this.container=this.root_wnd.getChildByName("container"),this.close_btn=this.container.getChildByName("close_btn"),this.scroll_view=this.container.getChildByName("scroll_view"),this.scroll_content=this.scroll_view.getChildByName("content"),this.scroll_view_compend=this.scroll_view.getComponent(cc.ScrollView),this.scroll_width=this.scroll_view.getContentSize().width,this.scroll_height=this.scroll_view.getContentSize().height,this.win_title=this.container.getChildByName("win_title").getComponent(cc.Label),this.win_title.string=this.title_str},registerEvent:function(){Utils.onTouchEnd(this.background,function(){this.ctrl.openCommonExplainView(!1)}.bind(this),2),Utils.onTouchEnd(this.close_btn,function(){this.ctrl.openCommonExplainView(!1)}.bind(this),2)},openRootWnd:function(t){t&&t.length>=2&&(this.title_str=t[1],this.setDataList(t[0]))},setDataList:function(t){for(var e in this.render_list=t,this.render_list)gcore.Timer.set(function(t){this.createList(t)}.bind(this,this.render_list[e]),e/60,1,"render_list"+e)},createList:function(t){var e=this.createTitleContent(t);this.scroll_content.addChild(e.container),this.cache_list.push(e.container),this.max_height=this.max_height+e.height+30;var i=Math.max(this.max_height,this.scroll_height);this.scroll_content.setContentSize(cc.size(this.scroll_width,i));var s=0;for(var n in this.cache_list)this.cache_list[n].setPosition(8,i-s),s=s+this.cache_list[n].getContentSize().height+30;this.scroll_view_compend.scrollToTop(0)},createTitleContent:function(t){if(null!=t){var e=new cc.Node;e.setAnchorPoint(cc.v2(0,1));var i=0;if(" "==t.title||""==t.title){(o=Utils.createRichLabel(24,this.color_1,cc.v2(0,1),cc.v2(0,0),30,605)).horizontalAlign=cc.macro.TextAlignment.LEFT,o.string=Utils.splitDataStr(t.desc),e.addChild(o.node);var n=this.scroll_width-8;i=o.node.getContentSize().height,e.node.setContentSize(cc.size(n,i)),o.node.y=i-8}else{var a=Utils.createImage(e,null,0,0,cc.v2(0,1),!0,0,!0);a.type=cc.Sprite.Type.SLICED,a.sizeMode=cc.Sprite.SizeMode.CUSTOM,a.node.setContentSize(cc.size(617,44));var o;Utils.createLabel(26,this.color_1,null,5,.5*-a.node.height,t.title,a.node,0,cc.v2(0,.5));this.loadRes(s.getCommonIcomPath("common_90025"),function(t){a.spriteFrame=t}.bind(this)),(o=Utils.createRichLabel(24,this.color_1,cc.v2(0,1),cc.v2(0,0),30,605)).horizontalAlign=cc.macro.TextAlignment.LEFT,o.string=Utils.splitDataStr(t.desc),e.addChild(o.node);n=this.scroll_width-8;i=a.node.height+o.node.height,e.setContentSize(cc.size(n,i)),a.node.y=0,o.node.y=a.node.y-a.node.height-8}return{container:e,height:i}}},closeCallBack:function(){if(this.render_list)for(var t in this.render_list)gcore.Timer.del("render_list"+t);this.cache_list=null,this.title_str=null,this.max_height=null,this.ctrl.openCommonExplainView(!1)}});e.exports=n,cc._RF.pop()},{pathtool:"pathtool"}],common_scrollview_single:[function(t,e,i){"use strict";cc._RF.push(e,"214a9FAXt5FTpkEEnLj0wMq","common_scrollview_single");cc.Class({extends:BaseClass,ctor:function(){this.initConfig()},initConfig:function(){this.parent=null,this.prefabPath=PathTool.getPrefabPath("common","common_scroll_view"),this.pos=cc.v2(0,0),this.dir=ScrollViewDir.vertical,this.start_pos=ScrollViewStartPos.top,this.size=cc.size(100,100),this.ap=cc.v2(0,0),this.cellList=[],this.cacheList={},this.activeCellIdx={},this.selectCellIndex=1,this.handler={},this.time_show_index=0,this.is_first_init=!0,this.cacheMaxSize=1},createScroll:function(t,e,i,s,n,a,o){this.parent=t,this.pos=e||cc.v2(0,0),this.dir=i||ScrollViewDir.vertical,this.start_pos=s||ScrollViewStartPos.top,this.size=n||cc.size(100,100),this.ap=o||cc.v2(0,0),this.analysisSetting(a),LoaderManager.getInstance().loadRes(this.prefabPath,function(t){var e=t;this.createRootWnd(e)}.bind(this))},analysisSetting:function(t){this.setting=t||{},this.start_x=this.setting.start_x||0,this.space_x=this.setting.space_x||0,this.start_y=this.setting.start_y||0,this.space_y=this.setting.space_y||0,this.item_width=this.setting.item_width||115,this.item_height=this.setting.item_height||115,this.row=this.setting.row||5,this.col=this.setting.col||5,this.delay=this.setting.delay||4,this.once_num=this.setting.once_num||1,this.need_dynamic=this.setting.need_dynamic||!0,this.dir==ScrollViewDir.horizontal&&(this.row=1),this.calculationMaxSum()},calculationMaxSum:function(){var t;t=this.dir==ScrollViewDir.horizontal?(Math.ceil(this.size.width/(this.item_width+this.space_x))+1)*this.row:(Math.ceil(this.size.height/(this.item_height+this.space_y))+1)*this.col,this.cacheMaxSize=t},createRootWnd:function(t){this.root_wnd=t,this.scroll_view=t.getChildByName("ScrollView"),this.scroll_view_mask=this.scroll_view.getChildByName("view"),this.scroll_view_con=this.scroll_view_mask.getChildByName("content"),this.root_wnd.setContentSize(this.size),this.root_wnd.setAnchorPoint(this.ap.x,this.ap.y),this.root_wnd.setPosition(this.pos),this.scroll_view.setContentSize(this.size),this.scroll_view_mask.setContentSize(this.size),this.scroll_view_con.setContentSize(this.size),this.scroll_view_compend=this.scroll_view.getComponent(cc.ScrollView),this.dir==ScrollViewDir.vertical?this.scroll_view_compend.vertical=!0:this.scroll_view_compend.horizontal=!0,this.container=this.scroll_view_con,this.parent&&this.parent.addChild(t),this.setInnerContainer(),this.registerEvent(),this.reloadData(this.select_index,this.setting)},registerEvent:function(){1==this.need_dynamic&&this.scroll_view_compend.node.on("scrolling",this.checkRectIntersectsRect,this)},addScrollToBottomCallBack:function(t){this.scrollToBottom_callback=t},registerScriptHandlerSingle:function(t,e){this.handler[e]=t},numberOfCells:function(){if(this.handler[ScrollViewFuncType.NumberOfCells])return this.handler[ScrollViewFuncType.NumberOfCells]()},updateCellByIndex:function(t,e){this.handler[ScrollViewFuncType.UpdateCellByIndex]&&this.handler[ScrollViewFuncType.UpdateCellByIndex](t,e)},createNewCell:function(){if(this.handler[ScrollViewFuncType.CreateNewCell])return this.handler[ScrollViewFuncType.CreateNewCell](this.item_width,this.item_height)},onCellTouched:function(t,e){this.handler[ScrollViewFuncType.OnCellTouched]&&this.handler[ScrollViewFuncType.OnCellTouched](t,e)},setClickEnabled:function(t){},setSwallowTouches:function(t){},checkRectIntersectsRect:function(){this.dir==ScrollViewDir.vertical?this.checkOverShowByVertical():this.checkOverShowByHorizontal()},checkOverShowByVertical:function(){if(null!=this.cellList){var t=this.cellList.length;if(0!=t){for(var e=-this.container.y,i=this.size.height+e,s=Math.ceil(t/this.col),n=0,a=0;a<s;a++){var o=a*this.col;if(n=a,(c=this.cellList[o])&&c.y-.5*this.item_height<=i)break}var l=s;if(e>0)for(var r=n;r<s;r++){var c;o=r*this.col;if((c=this.cellList[o])&&c.y+.5*this.item_height<e){l=r-1;break}}for(var _=this.numberOfCells(),h=0;h<s;h++)if(h>=n&&h<=l)for(var d=0;d<this.col;d++){o=h*this.col+d;this.activeCellIdx[o]||o<=_&&(this.updateCellAtIndex(o),this.activeCellIdx[o]=!0)}else for(var u=0;u<this.col;u++){(o=h*this.col+u)<=_&&(this.activeCellIdx[o]=!1)}}}},checkOverShowByVerticalBottom:function(){if(null!=this.cellList){var t=this.cellList.length;if(0!=t){for(var e=-this.container.y,i=this.size.height+e,s=Math.ceil(t/this.col),n=s,a=s-1;a>=0;a--){var o=a*this.col;if(n=a,(c=this.cellList[o])&&c.y-.5*this.item_height<=i)break}var l=0;if(e>0)for(var r=n-1;r>=0;r--){var c;o=r*this.col;if((c=this.cellList[o])&&c.y+.5*this.item_height<e){l=r+1;break}}for(var _=this.numberOfCells(),h=0;h<s;h++)if(h<=n&&h>=l)for(var d=0;d<this.col;d++){o=h*this.col+d;this.activeCellIdx[o]||o<=_&&(this.updateCellAtIndex(o),this.activeCellIdx[o]=!0)}else for(var u=0;u<this.col;u++){(o=h*this.col+u)<=_&&(this.activeCellIdx[o]=!1)}}}},checkOverShowByHorizontal:function(){if(null!=this.cellList){var t=this.cellList.length;if(0!=t){var e=-this.container.x,i=e+this.size.width,s=0;if(e>0)for(var n=0;n<t;n++){if(s=n,(l=this.cellList[n])&&l.x+.5*this.item_width>=e)break}for(var a=t,o=s;o<t;o++){var l;if((l=this.cellList[o])&&l.x-.5*this.item_width>i){a=o;break}}for(var r=this.numberOfCells(),c=0;c<t;c++)c>=s&&c<=a?this.activeCellIdx[c]||c<=r&&(this.updateCellAtIndex(c),this.activeCellIdx[c]=!0):c<=r&&(this.activeCellIdx[c]=!1)}}},updateMove:function(t){},jumpToMove:function(t,e,i){},checkPosition:function(){},getCurContainerPosY:function(){},getCurContainerPosX:function(){},setInnerContainer:function(){var t=this.numberOfCells(),e=this.size.width,i=this.size.height,s=0;this.dir==ScrollViewDir.horizontal?e=(s=Math.ceil(t/this.row))*this.item_width+2*this.start_x+(s-1)*this.space_x:i=(s=Math.ceil(t/this.col))*this.item_height+2*this.start_y+(s-1)*this.space_y,e=Math.max(e,this.size.width),i=Math.max(i,this.size.height),this.container_size=cc.size(e,i),this.scroll_view_con&&this.scroll_view_con.setContentSize(this.container_size),this.scroll_view_compend&&(this.scroll_view_compend.stopAutoScroll(),this.start_pos==ScrollViewStartPos.top?this.scroll_view_compend.scrollToTop(0):this.start_pos==ScrollViewStartPos.bottom&&this.scroll_view_compend.scrollToBottom(0))},resetCurrentItems:function(){for(var t in this.activeCellIdx)1==this.activeCellIdx[t]&&this.updateCellAtIndex(t)},resetItemByIndex:function(t){1==this.activeCellIdx[t]&&this.updateCellAtIndex(t)},getActiveCellList:function(){var t=[];for(var e in this.activeCellIdx)1==this.activeCellIdx[e]&&this.cellList[e]&&this.cellList[e].cell&&t.push(this.cellList[e].cell);return t},getCellByIndex:function(t){if(this.cellList[t]&&this.cellList[t].cell)return this.cellList[t].cell},getCellXYByIndex:function(t){},reloadData:function(t,e){if(null==this.root_wnd)return this.select_index=t,void(this.setting=e);for(var i in e&&this.analysisSetting(e),this.cellList=[],this.activeCellIdx={},this.cacheList){this.cacheList[i].setPosition(-1e4,0)}this.setInnerContainer();var s=this.numberOfCells();if(0!=s){for(var n=0;n<s;n++){var a=null;n<=this.time_show_index&&(a=this.getCacheCellByIndex(n));var o=this.cellList.length,l=this.getCellPosition(o),r={cell:a,x:l.x,y:l.y};this.cellList.push(r)}if(this.is_first_init?this.startTimeTicket():this.time_show_index<=s&&this.startTimeTicket(),null==t)for(var c=0,_=s<(c=this.dir==ScrollViewDir.horizontal?this.cacheMaxSize-this.row:this.cacheMaxSize-this.col)?s:c,h=0;h<_;h++)h<this.time_show_index&&this.updateCellAtIndex(h),this.activeCellIdx[h]=!0;else this.selectCellByIndex(t)}},selectCellByIndex:function(t){var e=0;e=this.dir==ScrollViewDir.horizontal?this.cacheMaxSize-this.row:this.cacheMaxSize-this.col;var i=this.numberOfCells();if(i<e)for(var s=0;s<i;s++)s<this.time_show_index&&this.updateCellAtIndex(s),this.activeCellIdx[s]=!0;else if(this.dir==ScrollViewDir.horizontal){var n=0;n=0==t?0:-(this.cellList[t].x-.5*(this.item_width+this.space_x));var a=-(this.container_size.width-this.size.width);n<a&&(n=a);var o=Math.floor(Math.abs(n)/this.item_width);this.time_show_index<o&&(this.time_show_index=o),this.container.x=n,this.checkOverShowByHorizontal()}else{var l=0;(l=0==t?this.start_y+this.cellList[t].y+.5*this.item_height-this.size.height:this.cellList[t].y+.5*(this.item_height+this.space_y)-this.size.height)<0&&(l=0);o=(Math.floor((this.container_size.height-(l+this.size.height))/this.item_height)+1-1)*this.col;this.time_show_index<o&&(this.time_show_index=o),this.container.y=-l,this.checkOverShowByVertical()}if(t>=0&&t<this.numberOfCells()){var r=this.getCacheCellByIndex(t);r.index=t,this.cellList[t].cell=r,this.onCellTouched(r,t)}},startTimeTicket:function(){if(null==this.time_tichet){if(0==this.cellList.length)return;var t=this.once_num||1,e=function(){if(null!=this.container){var e=this.time_show_index+t,i=this.time_show_index,s=this.cellList.length;this.time_show_index=this.time_show_index+t;for(var n=i;n<e&&!(n>s);n++){var a=this.cellList[n];a&&null==a.cell&&(a.cell=this.getCacheCellByIndex(n)),this.activeCellIdx[n]&&this.updateCellAtIndex(n)}this.time_show_index>=s&&(this.clearTimeTicket(),this.is_first_init=!1)}}.bind(this);this.time_tichet=gcore.Timer.set(function(){e()}.bind(this),this.delay/60,-1)}},clearTimeTicket:function(){this.time_tichet&&(gcore.Timer.del(this.time_tichet),this.time_tichet=null)},getCellPosition:function(t){var e=0,i=0;return this.dir==ScrollViewDir.horizontal?(e=this.start_x+.5*this.item_width+(this.item_width+this.space_x)*Math.floor(t/this.row),i=this.container_size.height-(this.start_y+.5*this.item_height+t%this.row*(this.item_height+this.space_y))):this.start_pos==ScrollViewStartPos.top?(e=this.start_x+.5*this.item_width+(this.item_width+this.space_x)*(t%this.col),i=this.container_size.height-(this.start_y+.5*this.item_height+Math.floor(t/this.col)*(this.item_height+this.space_y))):(e=this.start_x+.5*this.item_width+(this.item_width+this.space_x)*(t%this.col),i=this.start_y+.5*this.item_height+Math.floor(t/this.col)*(this.item_height+this.space_y)),{x:e,y:i}},getCacheCellByIndex:function(t){var e=t%this.cacheMaxSize;if(null==this.cacheList[e]){var i=this.createNewCell();return i&&(i.setPosition(-1e4,0),this.cacheList[e]=i,i.setParent(this.container)),i}return this.cacheList[e]},updateCellAtIndex:function(t){if(!(t>this.time_show_index)&&null!=this.cellList[t]){var e=this.cellList[t];null==e.cell&&(e.cell=this.getCacheCellByIndex(t)),e.cell.setPosition(e.x,e.y),this.updateCellByIndex(e.cell,t)}},getMaxSize:function(){return this.container_size},getContainer:function(){return this.container},deleteMe:function(){this.DeleteMe()},setVisible:function(t){this.root_wnd&&null!=t&&(this.root_wnd.active=t)},DeleteMe:function(){for(var t in this.clearTimeTicket(),this.cacheList){var e=this.cacheList[t];e&&e.deleteMe&&e.deleteMe(),e=null}this.cellList=null,this.cacheList=null,this.activeCellIdx=null,this.root_wnd.destroy(),this.root_wnd=null,LoaderManager.getInstance().releasePrefab(this.prefabPath)}});cc._RF.pop()},{}],common_scrollview:[function(t,e,i){"use strict";cc._RF.push(e,"33e04WhYdJMibSyfyrdHE6F","common_scrollview");var s=t("loadermanager"),n=t("pathtool");cc.Class({extends:BaseClass,ctor:function(){this.initConfig()},initConfig:function(){this.parent=null,this.prefabPath=n.getPrefabPath("common","common_scroll_view"),this.pos=cc.v2(0,0),this.dir=ScrollViewDir.vertical,this.start_pos=ScrollViewStartPos.top,this.size=cc.size(100,100),this.ap=cc.v2(0,0),this.cache_item_list=[],this.cache_item_pool=[],this.item_click_callback=null,this.extend=null,this.cur_item_class=null,this.is_radian=!1,this.is_scrolling=!1,this.cur_min_index=0,this.bounceEnabled=!0,this.clickEnabled=!0},createScroll:function(t,e,i,n,a,o,l){this.parent=t,this.pos=e||cc.v2(0,0),this.dir=i||ScrollViewDir.vertical,this.start_pos=n||ScrollViewStartPos.top,this.size=a||cc.size(100,100),this.ap=l||cc.v2(0,0),this.analysisSetting(o),s.getInstance().loadRes(this.prefabPath,function(t){(null==this.parent||this.parent&&this.parent.isValid)&&(this.root_wnd=t,this.createRootWnd(this.root_wnd))}.bind(this))},createRootWnd:function(t){null!=this.root_wnd&&(this.root_wnd=t,this.scroll_view=t.getChildByName("ScrollView"),this.scroll_view_mask=this.scroll_view.getChildByName("view"),this.container=this.scroll_view_mask.getChildByName("content"),this.mask=this.scroll_view.getChildByName("mask"),this.root_wnd.setContentSize(this.size),this.root_wnd.setAnchorPoint(this.ap.x,this.ap.y),this.root_wnd.setPosition(this.pos),this.scroll_view.setContentSize(this.size),this.scroll_view_mask.setContentSize(this.size),this.container.setContentSize(this.size),this.scroll_view_compend=this.scroll_view.getComponent(cc.ScrollView),this.dir==ScrollViewDir.vertical?this.scroll_view_compend.vertical=!0:this.scroll_view_compend.horizontal=!0,null!=this.scroll_state&&this.setScrollState(this.scroll_state),this.parent&&this.parent.addChild(t),this.setBounceEnabled(this.bounceEnabled),this.setClickEnabled(this.clickEnabled),this.setInnerContainer(),this.registerEvent())},registerEvent:function(){1==this.need_dynamic&&this.dir==ScrollViewDir.vertical&&this.scroll_view_compend.node.on("scrolling",this.checkRectIntersectsRect,this)},checkRectIntersectsRect:function(t){0!=this.need_dynamic&&this.dir==ScrollViewDir.vertical&&this.checkOverShowByVertical()},checkOverShowByVertical:function(){if(null!=this.cur_item_class&&null!=this.data_list&&null!=Utils.next(this.data_list)){var t=this.cache_item_list,e=this.cache_item_pool;if(null!=t){var i=this.container.y;null==this.last_pos_y&&(this.last_pos_y=i);for(var s=Math.abs(i),n=t.length-1;n>=0;n--){var a=t[n];null==a.y&&Log.error(a);var o=a.y,l=!1;i>0?o>this.size.height-i+this.item_height&&(l=!0):o<s-this.item_height?l=!0:o>s+this.size.height+this.item_height&&(l=!0),1==l&&(a&&null!=a.suspendAllActions&&(a.suspendAllActions(),a.cur_visible=!1,a.setVisible(!1,this.dir)),e.push(a),t.splice(n,1))}this.supplementItemList(t,this.last_pos_y,i),this.last_pos_y=i}}},supplementItemList:function(t,e,i){if(null!=t&&0!=t.length){var s=t.length;if(s<this.max_sum){for(var n=t[0].tmp_index,a=t[0].tmp_index,o=0;o<t.length;o++){var l=t[o];n>=l.tmp_index&&(n=Number(l.tmp_index)),a<=l.tmp_index&&(a=Number(l.tmp_index))}if(i>e)for(var r=0;r<this.max_sum-s;r++)this.createList(this.data_list[a+r+1]);else for(var c=0;c<this.max_sum-s;c++)n-c>0&&this.createList(this.data_list[n-c-1])}}},setSwallowTouches:function(t){this.scroll_view.setSwallowTouches(t)},setBounceEnabled:function(t){this.bounceEnabled=t,this.scroll_view_compend&&(this.scroll_view_compend.elastic=t)},setClickEnabled:function(t){this.clickEnabled=t,this.scroll_view_compend&&(t?(this.scroll_view_compend.node.on(cc.Node.EventType.TOUCH_START,this.scroll_view_compend._onTouchBegan,this.scroll_view_compend,!0),this.scroll_view_compend.node.on(cc.Node.EventType.TOUCH_MOVE,this.scroll_view_compend._onTouchMoved,this.scroll_view_compend,!0),this.scroll_view_compend.node.on(cc.Node.EventType.TOUCH_END,this.scroll_view_compend._onTouchEnded,this.scroll_view_compend,!0),this.scroll_view_compend.node.on(cc.Node.EventType.TOUCH_CANCEL,this.scroll_view_compend._onTouchCancelled,this.scroll_view_compend,!0)):(this.scroll_view_compend.node.off(cc.Node.EventType.TOUCH_START,this.scroll_view_compend._onTouchBegan,this.scroll_view_compend,!0),this.scroll_view_compend.node.off(cc.Node.EventType.TOUCH_MOVE,this.scroll_view_compend._onTouchMoved,this.scroll_view_compend,!0),this.scroll_view_compend.node.off(cc.Node.EventType.TOUCH_END,this.scroll_view_compend._onTouchEnded,this.scroll_view_compend,!0),this.scroll_view_compend.node.off(cc.Node.EventType.TOUCH_CANCEL,this.scroll_view_compend._onTouchCancelled,this.scroll_view_compend,!0)))},updateMove:function(t){var e=this.checkPosition(t.x,t.y),i=cc.moveTo(.1,e.x,e.y).easing(cc.easeBackOut());this.container.runAction(i)},jumpToMove:function(t,e,i){var s=this.checkPosition(t.x,t.y);e=null==e?1:e;var n=cc.moveTo(e,cc.v2(s.x,s.y));this.container.runAction(cc.sequence(n,cc.callFunc(function(){i&&i()})))},jumpToMove_2:function(t,e,i){var s=this.checkPosition(t.x,t.y);e=null==e?1:e;var n=cc.moveTo(e,cc.v2(s.x,s.y));this.container.runAction(cc.sequence(n,cc.callFunc(function(){i&&i()})))},getCurContainerPosY:function(){if(this.container)return this.container.y},getCurContainerPosX:function(){if(this.container)return this.container.x},checkPosition:function(t,e){if(null==this.root_wnd)return cc.v2(0,0);var i=this.container.x,s=this.container.y;return this.dir==ScrollViewDir.horizontal?i+=t:this.dir==ScrollViewDir.vertical&&(s+=e),i>0?i=0:i<this.size.width-this.container_size.width&&(i=this.size.width-this.container_size.width),s>0?s=0:s<this.size.height-this.container_size.height&&(s=this.size.height-this.container_size.height),cc.v2(i,s)},setInnerContainer:function(){var t=0;this.data_list&&(t=this.data_list.length);var e=this.size.width,i=this.size.height,s=0;this.dir==ScrollViewDir.horizontal?e=(s=Math.ceil(t/this.row))*this.item_width+2*this.start_x+(s-1)*this.space_x:(s=Math.ceil(t/this.col),i=this.is_change?s*this.item_height+2*this.start_y+s*this.space_y:s*this.item_height+2*this.start_y+(s-1)*this.space_y),e=Math.max(e,this.size.width),i=Math.max(i,this.size.height),this.container_size=cc.size(e,i),this.container&&this.container.setContentSize(this.container_size.width,this.container_size.height+this.bottom),this.scroll_view_compend&&(this.scroll_view_compend.stopAutoScroll(),this.dir==ScrollViewDir.vertical?this.start_pos==ScrollViewStartPos.top?this.scroll_view_compend.scrollToTop(0):this.start_pos==ScrollViewStartPos.bottom&&this.scroll_view_compend.scrollToBottom(0):this.dir==ScrollViewDir.horizontal&&(this.start_pos==ScrollViewStartPos.top?this.scroll_view_compend.scrollToLeft(0):this.start_pos==ScrollViewStartPos.bottom&&this.scroll_view_compend.scrollToRight(0)))},setData:function(t,e,i){if(this.clearCacheList(),null!=t&&null!=Utils.next(t)){for(var s=[],n=0;n<t.length;n++){var a=t[n];s.push({data:a,index:n})}this.item_click_callback=e,this.data_list=s,this.extend=i,this.cur_item_class=this.item_class,this.setInnerContainer();var o=0,l=this.once_num||1,r=this.data_list.length;if(1==this.need_dynamic&&(r=this.max_sum-1),this.cur_item_class&&this.cache_item_pool.length>0)for(var c=0;c<r;c++){var _=this.data_list[c];null!=_&&this.createList(_),c==r-1&&this.end_callBack&&this.end_callBack()}else null==this.time_ticket&&null!=Utils.next(this.data_list||{})&&(this.time_ticket=gcore.Timer.set(function(){if(this.container)if(null==this.data_list)this.end_callBack&&this.end_callBack(),this.clearTimeTicket();else{for(var t=o;t<o+l;t++){var e=this.data_list[t];null!=e&&this.createList(e)}(o+=l)>r&&(this.end_callBack&&this.end_callBack(),this.clearTimeTicket())}}.bind(this),10*this.delay,-1))}},updateItemData:function(t,e){var i={data:e,index:t};this.data_list[t]=i;var s=this.getItem(t);s&&s.setData(e)},setStartX:function(t){this.start_x=t},setSpaceY:function(t,e){this.space_y=t,this.is_change=e},clearTimeTicket:function(){null!=this.time_ticket&&(gcore.Timer.del(this.time_ticket),this.time_ticket=null)},resetSize:function(t,e){null!=t&&(t.width==this.size.width&&t.height==this.size.height||(this.size=t,this.root_wnd&&this.root_wnd.setContentSize(t),this.scroll_view&&this.scroll_view.setContentSize(t),this.scroll_view_mask&&this.scroll_view_mask.setContentSize(t),this.root_wnd&&e&&this.root_wnd.setPosition(e),this.calculationMaxSum()))},clearCacheList:function(){this.clearTimeTicket();for(var t=0;t<this.cache_item_list.length;t++){var e=this.cache_item_list[t];e&&e.suspendAllActions&&e.suspendAllActions(),this.cache_item_pool.push(e)}for(var i=0;i<this.cache_item_pool.length;i++){var s=this.cache_item_pool[i];s&&s.setVisible&&(s.cur_visible=!1,s.setVisible(!1,this.dir))}this.cache_item_list=[]},addEndCallBack:function(t){this.end_callBack=t},createList:function(t){if(null!=t&&null!=t.data&&null!=t.index&&null!=this.cur_item_class){var e=null;0==this.cache_item_pool.length?((e="string"==typeof this.item_class?ItemsPool.getInstance().getItem(this.item_class):new this.item_class(this.item_obj)).setParent(this.container),e.show&&e.show(),e.setScale&&e.setScale(this.scale),this.isZIndex&&(1==this.isZIndex?e.setZIndex&&e.setZIndex(t.index):2==this.isZIndex&&e.setZIndex&&this.data_list&&e.setZIndex(this.data_list.length-t.index))):(e=this.cache_item_pool.shift()).setVisible?e.setVisible(!0,this.dir):Log.error("\u6ca1\u6709\u8bbe\u7f6e\u663e\u793a\u63a5\u53e3\u554a!!!"),e.tmp_index=t.index,this.cache_item_list.push(e),null!=this.extend&&e.setExtendData&&e.setExtendData(this.extend),this.setItemPosition(e,t.index),null!=this.item_click_callback&&e.addCallBack&&e.addCallBack(this.item_click_callback),e.setData(t.data,this.is_hide_effect),this.cur_min_index=t.index}},setItemPosition:function(t,e){var i=Number(e),s={x:.5,y:.5},n=0,a=0;this.dir==ScrollViewDir.horizontal?(n=this.start_x+this.item_width*s.x+(this.item_width+this.space_x)*Math.floor(i/this.row),a=this.container_size.height-(this.start_y+this.item_height*(1-s.y)+i%this.row*(this.item_height+this.space_y))):this.start_pos==ScrollViewStartPos.top?(n=this.start_x+this.item_width*s.x+(this.item_width+this.space_x)*(i%this.col),a=this.container_size.height-(this.start_y+this.item_height*(1-s.y)+Math.floor(i/this.col)*(this.item_height+this.space_y))):(n=this.start_x+this.item_width*s.x+(this.item_width+this.space_x)*(i%this.col),a=this.start_y+this.item_height*s.y+Math.floor(i/this.col)*(this.item_height+this.space_y)),t.setPosition(n,a+this.bottom)},resetCurrentItems:function(){for(var t=0;t<this.cache_item_list.length;t++)if(this.cache_item_list[t]&&this.cache_item_list[t].setData){var e=this.data_list[this.cache_item_list[t].tmp_index];this.cache_item_list[t].setData(e.data)}},getItemList:function(){for(var t=[],e=0;e<this.cache_item_list.length;e++){var i=this.cache_item_list[e];t.push(i)}return t},getItem:function(t){for(var e in this.cache_item_list){var i=this.cache_item_list[e];if(i.tmp_index==t)return i}return null},setRootVisible:function(t){this.root_wnd&&(this.root_wnd.active=t)},resetAddPosition:function(t,e){if(null!=t&&null!=Utils.next(t)){null!=e&&t.sort(e);for(var i=[],s=0;s<t.length;s++){var n=t[s];i.push({data:n,index:s})}if(this.data_list=i,null!=this.cache_item_list&&null!=Utils.next(this.cache_item_list))for(var a=0;a<this.cache_item_list.length;a++){var o=this.cache_item_list[a],l=i[o.tmp_index];l&&o.setData&&l.data?(o.setData(l.data),o.setVisible(!0,this.dir),o.tmp_index=l.index):(o.cur_visible=!1,o.setVisible(!1,this.dir),this.cache_item_pool.push(o),this.cache_item_list.splice(a,1))}}},resetPosition:function(t,e){if(null!=this.data_list&&null!=Utils.next(this.data_list)){null!=t&&this.data_list.sort(t);for(var i=0;i<this.data_list.length;i++){this.data_list[i].index=i}if(null!=this.cache_item_list&&null!=Utils.next(this.cache_item_list))for(var s=0;s<this.cache_item_list.length;s++){var n=this.cache_item_list[s];if(n.tmp_index){var a=this.data_list[n.tmp_index];a&&n.setData&&a.data&&(n.setData(a.data),n.setVisible(!0,this.dir),n.tmp_index=a.index)}}}},analysisSetting:function(t){this.setting=t||{},this.item_class=this.setting.item_class,this.start_x=this.setting.start_x||0,this.space_x=this.setting.space_x||3,this.start_y=this.setting.start_y||0,this.space_y=this.setting.space_y||3,this.item_width=this.setting.item_width||115,this.item_height=this.setting.item_height||115,this.is_radian=this.setting.is_radian||!1,this.row=this.setting.row||5,this.col=this.setting.col||5,this.delay=this.setting.delay||1,this.once_num=this.setting.once_num||1,this.scale=this.setting.scale||1,this.need_dynamic=this.setting.need_dynamic||!1,this.is_hide_effect=this.setting.is_hide_effect||!1,this.item_obj=this.setting.item_obj,this.bottom=this.setting.bottom||0,this.calculationMaxSum()},calculationMaxSum:function(){var t;t=this.dir==ScrollViewDir.horizontal?(Math.ceil(this.size.width/(this.item_width+this.space_x))+1)*this.row:(Math.ceil(this.size.height/(this.item_height+this.space_y))+1)*this.col,this.max_sum=t},getMaxSize:function(){return this.container_size},getContainer:function(){return this.container},deleteMe:function(){this.DeleteMe()},setScrollState:function(t){this.scroll_view_compend?t?this.dir==ScrollViewDir.vertical?this.scroll_view_compend.vertical=!0:this.scroll_view_compend.horizontal=!0:(this.scroll_view_compend.vertical=!1,this.scroll_view_compend.horizontal=!1):this.scroll_state=t},setVisible:function(t){this.root_wnd&&null!=t&&(this.root_wnd.active=t)},setItemZIndexByType:function(t){this.isZIndex=t},DeleteMe:function(){this.clearTimeTicket(),this.setClickEnabled(!1);for(var t=0;t<this.cache_item_list.length;t++){(i=this.cache_item_list[t]).deleteMe&&(i.deleteMe(),i=null)}for(var e=0;e<this.cache_item_pool.length;e++){var i;(i=this.cache_item_pool[e]).deleteMe&&(i.deleteMe(),i=null)}this.cache_item_list=null,this.cache_item_pool=null,this.root_wnd&&(this.root_wnd.destroy(),this.root_wnd=null),s.getInstance().releasePrefab(this.prefabPath)}});cc._RF.pop()},{loadermanager:"loadermanager",pathtool:"pathtool"}],common_tab_btn:[function(t,e,i){"use strict";cc._RF.push(e,"caff33GRpBFZIRAKuzgwV+o","common_tab_btn");var s=t("pathtool"),n=cc.Class({extends:ViewClass,ctor:function(){this.prefabPath=s.getPrefabPath("common","common_tab_btn")},initRootWnd:function(){this.size=cc.size(147,64),this.root_wnd=new cc.Node,this.parent.addChild(this.root_wnd),this.root_wnd.setContentSize(this.size),this.toggle=this.root_wnd.addComponent(cc.Toggle),this.toggle.isChecked=!1,this.toggle.transition=cc.Button.Transition.NONE;var t=new cc.Node;this.root_wnd.addChild(t),this.toggle.target=t,this.loadRes(s.getUIIconPath("common","common_1012"),function(e){var i=t.addComponent(cc.Sprite);i.type=cc.Sprite.Type.SLICED,i.sizeMode=cc.Sprite.SizeMode.CUSTOM,i.spriteFrame=e,t.setContentSize(this.size)}.bind(this));var e=new cc.Node;this.root_wnd.addChild(e);var i=e.addComponent(cc.Sprite);this.toggle.checkMark=i,i.type=cc.Sprite.Type.SLICED,i.sizeMode=cc.Sprite.SizeMode.CUSTOM,this.loadRes(s.getUIIconPath("common","common_1011"),function(t){i.spriteFrame=t,e.setContentSize(this.size)}.bind(this));var n=new cc.Node;n.color=new cc.Color(245,224,185,255),this.title_lb=n.addComponent(cc.Label),this.title_lb.fontSize=24,this.title_lb.lineHeight=28,n.setPosition(0,-5),this.root_wnd.addChild(n);var a=this.title_lb.addComponent(cc.LabelOutline);a.color=new cc.Color(42,22,14,255),a.width=2,this.tab_tips=new cc.Node,this.root_wnd.addChild(this.tab_tips),this.tab_tips.setPosition(65.5,26),this.loadRes(s.getUIIconPath("common","common_1014"),function(t){var e=this.tab_tips.addComponent(cc.Sprite);e.type=cc.Sprite.Type.SIMPLE,e.sizeMode=cc.Sprite.SizeMode.CUSTOM,e.spriteFrame=t,this.tab_tips.setContentSize(35,35)}.bind(this));var o=new cc.Node;this.red_lb=o.addComponent(cc.Label),this.red_lb.fontSize=20,this.red_lb.lineHeight=22,this.tab_tips.active=!1,this.registerEvent()},registerEvent:function(){this.root_wnd.on("toggle",function(){this.callback&&this.callback()},this)},setTitle:function(t){this.title_lb.string=t},addCallBack:function(t){this.callback=t},setParent:function(t){this.parent=t,this.parent&&this.initRootWnd()},getToggle:function(){return this.toggle}});e.exports=n,cc._RF.pop()},{pathtool:"pathtool"}],common_tips:[function(t,e,i){"use strict";cc._RF.push(e,"5d904pE+GpHbbm+7jDBqPPX","common_tips");var s=t("loadermanager"),n=t("pathtool");cc.Class({extends:BaseClass,ctor:function(){this.prefabPath=n.getPrefabPath("tips","common_tips"),this.delay=arguments[0]||30,this.initConfig()},initConfig:function(){s.getInstance().loadRes(this.prefabPath,function(t){var e=t;this.createRootWnd(e)}.bind(this))},createRootWnd:function(t){this.root_wnd=t,this.root_wnd.setAnchorPoint(cc.v2(.5,.5)),this.root_wnd.setContentSize(cc.size(SCREEN_WIDTH,1280)),this.root_wnd.setPosition(0,0),ViewManager.getInstance().addToSceneNode(this.root_wnd,SCENE_TAG.msg),this.main_nd=this.root_wnd.getChildByName("main"),this.bg_nd=this.main_nd.getChildByName("bg"),this.label_rt=this.main_nd.getChildByName("label").getComponent(cc.RichText),this.registerEvent(),null!=this.str&&this.showTips(this.str,this.width,this.font_size)},registerEvent:function(){this.root_wnd.on(cc.Node.EventType.TOUCH_END,function(){t("tips_controller").getInstance().closeAllTips()},this)},setPosition:function(t,e){this.main_nd.setPosition(cc.v2(t,e))},addToParent:function(t,e){cc.log("common_tips")},setPos:function(t,e){this.main_nd.setPosition(cc.v2(t,e))},getBgContentSize:function(){if(this.root_wnd)return this.main_nd.getContentSize()},getScreenBg:function(){return this.root_wnd},addCallBack:function(t){this.callback=t,this.root_wnd&&this.callback()},showTips:function(t,e,i){if(null==this.root_wnd)return this.str=t,this.width=e,void(this.font_size=i);i=i||6;this.recoutTextFieldSize(t,e,i);var s=this.label_rt.node.getContentSize(),n=Math.max(80+s.width,this.bg_nd.getContentSize().width),a=Math.max(70+s.height,this.bg_nd.getContentSize().height);this.main_nd.setContentSize(cc.size(n,a)),this.bg_nd.setContentSize(cc.size(n,a)),this.callback&&this.callback()},recoutTextFieldSize:function(t,e,i){this.label_rt.maxWidth=e,this.label_rt.fontSize=i,this.label_rt.lineHeight=i+4,this.label_rt.string=t},setAnchorPoint:function(t){this.root_wnd&&this.root_wnd.setAnchorPoint(t)},open:function(){gcore.Timer.set(function(){t("tips_controller").getInstance().closeAllTips()},1e3*this.delay,1,"close")},close:function(){this.root_wnd&&(this.root_wnd.destroy(),this.root_wnd=null),s.getInstance().releasePrefab(this.prefabPath),gcore.Timer.del("close")}});cc._RF.pop()},{loadermanager:"loadermanager",pathtool:"pathtool",tips_controller:"tips_controller"}],common_window_tab:[function(t,e,i){"use strict";cc._RF.push(e,"3ae3dKMLvdAsK+8BHs+VRRm","common_window_tab");var s=t("pathtool");window.CommonWindowTab=cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("common","common_window_tab"),this.tab_info_list=[],this.title_str=null,this.tab_max=4,this.win_type=WinType.Full,this.viewTag=SCENE_TAG.ui},openCallBack:function(){this.main_container=this.root_wnd.getChildByName("main_container"),this.main_panel=this.main_container.getChildByName("main_panel"),this.background=this.seekChild("background"),this.background.scale=this.background.scale*FIT_SCALE,this.loadRes(s.getBigBg("bigbg_2"),function(t){this.background.getComponent(cc.Sprite).spriteFrame=t}.bind(this)),this.close_btn=this.main_panel.getChildByName("close_btn"),this.win_title=this.main_panel.getChildByName("win_title").getComponent(cc.Label),this.container=this.main_panel.getChildByName("container"),this.scroll_con=this.main_panel.getChildByName("scroll_con"),this.empty_con=this.main_panel.getChildByName("empty_con"),this.empty_con.active=!1,this.empty_con&&(this.empty_label=this.empty_con.getChildByName("label").getComponent(cc.Label)),null!=this.title_str&&(this.win_title.string=this.title_str),this.close_btn.on(cc.Node.EventType.TOUCH_END,function(){this.closeCallBack&&this.closeCallBack()},this),this.createTabInfoList(),this.initPanel()},registerEvent:function(){},openRootWnd:function(){},closeCallBack:function(){},initPanel:function(){},changeTitleName:function(t){null!=this.win_title&&(this.win_title.string=t)},createTabInfoList:function(){if(null!=this.root_wnd&&null!=this.tab_info_list&&null!=Utils.next(this.tab_info_list)){var t,e,i,s,n,a,o,l=this.main_panel.getChildByName("tab_container");null==this.tab_btn_list&&(this.tab_btn_list=[]);for(var r=1;r<=this.tab_max;r++)null!=(t=l.getChildByName("tab_btn_"+r))&&((e=t).setName("tab_btn"+r),i=t.getChildByName("tab_tips"),n=t.getChildByName("red_num").getComponent(cc.Label),o=t.getChildByName("unselect_bg"),a=t.getChildByName("select_bg"),null!=e&&(e.tips=i,e.red_num=n,e.select_bg=a,e.unselect_bg=o,null!=(s=this.tab_info_list[r-1])?(e.notice=s.notice||"",e.label=t.getChildByName("title").getComponent(cc.Label),e.label.string=s.label||"",e.index=s.index,e.label.node.color=new cc.Color(245,224,185,255),e.select_bg.active=!1,e.tips.active=!1,e.red_num.node.active=!1,e.on(cc.Node.EventType.TOUCH_END,function(t){0==t.bubbles?message(t.notice):this.setSelecteTab(t.currentTarget.index)}.bind(this)),this.tab_btn_list[s.index]=e):e.active=!1))}},setSelecteTab:function(t){this.cur_selected&&this.cur_selected.index==t||(null!=this.cur_selected&&(this.cur_selected.label&&(this.cur_selected.label.node.color=new cc.Color(207,181,147,255)),this.cur_selected.select_bg.active=!1),this.cur_selected=this.tab_btn_list[t],null!=this.cur_selected&&(this.cur_selected.label&&(this.cur_selected.label.node.color=new cc.Color(255,237,214,255)),this.cur_selected.select_bg.active=!0),this.selectedTabCallBack&&null!=this.cur_selected&&this.selectedTabCallBack(this.cur_selected.index))},setTabTips:function(t,e){if(this.root_wnd&&this.tab_btn_list){var i=this.tab_btn_list[e];i&&i.tips&&(i.tips.active=t)}},setTabTipsII:function(t,e){var i=!0;t<=0&&(i=!1);var s=this.tab_btn_list[e];s&&s.tips&&(s.tips.active=i,s.red_num.node.active=i),t>=0&&(s.red_num.string=t)}}),cc._RF.pop()},{pathtool:"pathtool"}],commonaction:[function(t,e,i){"use strict";cc._RF.push(e,"c84a3IxYaBKlpMLv8Q7/Agh","commonaction"),window.CommonAction={breatheShineAction:function(t,e,i){if(t){e=e||.7,i=i||.4;var s=cc.fadeIn(e),n=cc.fadeOut(i);t.runAction(cc.repeatForever(cc.sequence(s,n)))}},breatheShineAction3:function(t,e,i){if(t){e=e||1.05,i=i||.6;var s=cc.scaleTo(i,e),n=cc.scaleTo(i,1);t.runAction(cc.repeatForever(cc.sequence(s,n)))}},breatheShineAction4:function(t,e,i){if(null!=t){e=e||.5,i=i||10;var s=cc.moveBy(e,cc.v2(0,-i)),n=cc.moveBy(2*e,cc.v2(0,2*i)),a=cc.moveBy(e,cc.v2(0,-i));t.runAction(cc.repeatForever(cc.sequence(s,n,a)))}}},cc._RF.pop()},{}],commonalert:[function(t,e,i){"use strict";cc._RF.push(e,"7e43doIB2hH3a7V6mLEGcFk","commonalert");var s={show:function(e,i,s,n,a,o,l,r){var c=t("commonalertwin"),_=SCENE_TAG.dialogue;r&&r.view_tag&&(_=r.view_tag);var h=new c(_),d={str:e,confirm_label:i,confirm_callback:s,cancel_label:n,cancel_callback:a,type:o,close_callback:l,other_args:r};return h.open(d),h},showInputApply:function(e,i,s,n,a,o,l,r,c,_){var h=new(t("commoninputalertwin")),d={input_desc:e,desc_str:i,placeholder_str:s,confirm_label:n,confirm_callback:a,cancel_label:o,cancel_callback:l,close:r,close_callback:c,other_args:_||{}};return h.open(d),h},showItemApply:function(e,i,s,n,a,o,l,r,c,_,h,d,u,m,f){var p={str:e,list:i,confirm_callback:s,confirm_label:n,cancel_callback:a,cancel_label:o,title_str:l,font_size:r,type:c,close:_,close_callback:h,desc_label:d,item_info:u,view_tag:m,margin:f},g=new(t("commonitemalertwin"))(m);return g.open(p),g}};e.exports=s,cc._RF.pop()},{commonalertwin:"commonalertwin",commoninputalertwin:"commoninputalertwin",commonitemalertwin:"commonitemalertwin"}],commonalertwin:[function(t,e,i){"use strict";cc._RF.push(e,"4865ccAO3RNXbVPMI4RA662","commonalertwin");var s=t("pathtool"),n=cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("common","common_alert"),this.viewTag=arguments[0]||SCENE_TAG.dialogue},openCallBack:function(){this.main_panel=this.root_wnd.getChildByName("main_panel"),this.background=this.seekChild("background"),this.background.scale=FIT_SCALE,this.ok_btn=this.main_panel.getChildByName("ok_btn").getComponent(cc.Button),this.ok_btn_lb=this.seekChild("ok_txt",cc.Label),this.ok_btn_lo=this.seekChild("ok_txt",cc.LabelOutline),this.cancel_btn=this.main_panel.getChildByName("cancel_btn"),this.cancel_btn_lb=this.seekChild("cancel_txt",cc.Label),this.close_btn=this.main_panel.getChildByName("close_btn"),this.title_lb=this.seekChild("title_label",cc.Label),this.aler_des_rt=this.seekChild("aler_des",cc.RichText),this.click_jump_rt=this.seekChild("jumpBtn",cc.RichText),this.ok_btn.node.on("click",this.didClickOkBtn,this),this.cancel_btn.on("click",this.didClickCancleBtn,this)},registerEvent:function(){this.close_btn.on(cc.Node.EventType.TOUCH_END,function(t){this.close_callback&&this.close_callback(),Utils.playButtonSound(2),this.close()}.bind(this))},openRootWnd:function(t){this.aler_des_rt.string=t.str;var e=[];if(t.other_args&&t.other_args.resArr&&(e=t.other_args.resArr),e&&e.length>0)for(var i=0;i<e.length;++i)this.loadRes(e[i],function(t){this.aler_des_rt.addSpriteFrame=t}.bind(this));if(t.confirm_label&&(this.ok_btn_lb.string=t.confirm_label),t.cancel_label&&(this.cancel_btn_lb.string=t.cancel_label),this.confirm_callback=t.confirm_callback,this.cancel_callback=t.cancel_callback,this.close_callback=t.close_callback,this.main_panel.runAction(cc.scaleTo(.1,1)),t.other_args&&t.other_args.title&&(this.title_lb.string=t.other_args.title),t.other_args&&t.other_args.extend_str&&(this.aler_des_rt.node.y=44,t.other_args.callFunc&&this.click_jump_rt.addTouchHandler("handler",t.other_args.callFunc),this.click_jump_rt.string=t.other_args.extend_str),t.other_args&&t.other_args.maxWidth&&(this.aler_des_rt.maxWidth=t.other_args.maxWidth),t.other_args&&null!=t.other_args.align&&(this.aler_des_rt.horizontalAlign=t.other_args.align),t.other_args&&t.other_args.delayS){this.ok_btn.interactable=!1,this.ok_btn.enableAutoGrayEffect=!0;var s=t.other_args.delayS,n=this;s>0&&(this.ok_btn_lo.color=new cc.Color(125,125,125),n.ok_btn_lb.string=t.confirm_label+"("+s+")",this.ok_btn.schedule(function(){--s<=0?(n.ok_btn_lo.color=new cc.Color(106,43,0),n.ok_btn.unscheduleAllCallbacks(),n.ok_btn.interactable=!0,n.ok_btn.enableAutoGrayEffect=!1,n.ok_btn_lb.string=t.confirm_label):n.ok_btn_lb.string=t.confirm_label+"("+s+")"},1))}},closeCallBack:function(){this.ok_btn.unscheduleAllCallbacks()},didClickOkBtn:function(){Utils.playButtonSound(1),this.close(),this.confirm_callback&&this.confirm_callback()},didClickCancleBtn:function(){Utils.playButtonSound(1),this.close(),this.cancel_callback&&this.cancel_callback()}});e.exports=n,cc._RF.pop()},{pathtool:"pathtool"}],commoninputalertwin:[function(t,e,i){"use strict";cc._RF.push(e,"1bf64QannZCvLhAisYLcDsM","commoninputalertwin");var s=t("pathtool"),n=cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("common","common_input_alert"),this.viewTag=SCENE_TAG.dialogue},openCallBack:function(){this.main_panel=this.root_wnd.getChildByName("main_panel"),this.background=this.seekChild("background"),this.background.scale=FIT_SCALE,this.ok_btn=this.main_panel.getChildByName("ok_btn"),this.ok_label=this.ok_btn.getChildByName("label").getComponent(cc.Label),this.cancel_btn=this.main_panel.getChildByName("cancel_btn"),this.cancel_label=this.cancel_btn.getChildByName("label").getComponent(cc.Label),this.close_btn=this.main_panel.getChildByName("close_btn"),this.input=this.main_panel.getChildByName("editbox").getComponent(cc.EditBox),this.place_label=this.main_panel.getChildByName("editbox").getChildByName("PLACEHOLDER_LABEL").getComponent(cc.Label),this.input_desc=this.main_panel.getChildByName("input_label").getComponent(cc.Label),this.msg=this.main_panel.getChildByName("msg").getComponent(cc.RichText),this.gold_sp=this.seekChild(this.main_panel,"gold",cc.Sprite),null!=this.gold_res&&this.setGoldImg(this.gold_res,this.gold_pos)},registerEvent:function(){},openRootWnd:function(t){this.input_desc.string=t.input_desc||"",this.msg.string=t.desc_str||"",this.place_label.string=t.placeholder_str||"",this.ok_label.string=t.confirm_label||Utils.TI18N("\u786e\u8ba4"),this.cancel_label.string=t.cancel_label||Utils.TI18N("\u53d6\u6d88"),t.other_args&&t.other_args.maxLength&&(this.input.maxLength=t.other_args.maxLength);var e=[];if(t.other_args&&t.other_args.resArr&&(e=t.other_args.resArr),e&&e.length>0)for(var i=0;i<e.length;++i)this.loadRes(e[i],function(t){this.msg.spriteFrame=t}.bind(this));this.ok_btn.on(cc.Node.EventType.TOUCH_END,function(e){t.confirm_callback(this.input.string)&&this.close()}.bind(this)),this.cancel_btn.on(cc.Node.EventType.TOUCH_END,function(e){t.cancel_callback&&t.cancel_callback(),this.close()}.bind(this)),0!=t.close&&this.close_btn.on(cc.Node.EventType.TOUCH_END,function(e){t.close_callback?t.close_callback():t.cancel_callback&&t.cancel_callback(),this.close()}.bind(this))},setGoldImg:function(t,e){if(null==this.gold_sp)return this.gold_res=t,void(this.gold_pos=e);this.loadRes(t,function(t){this.gold_sp.spriteFrame=t}.bind(this)),this.gold_sp.node.setPosition(e.x,e.y)},closeCallBack:function(){}});e.exports=n,cc._RF.pop()},{pathtool:"pathtool"}],commonitemalertwin:[function(t,e,i){"use strict";cc._RF.push(e,"ac7b6iPf7tISZqIdVtqvk8p","commonitemalertwin");var s=t("pathtool"),n=cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("common","common_alert"),this.viewTag=arguments[0]||SCENE_TAG.dialogue,this.item_list={}},openCallBack:function(){this.main_panel=this.root_wnd.getChildByName("main_panel"),this.seekChild("title_label",cc.Label).string=Utils.TI18N("\u5956\u52b1"),this.background=this.seekChild("background"),this.background.scale=FIT_SCALE,this.ok_btn=this.main_panel.getChildByName("ok_btn"),this.ok_btn_lb=this.seekChild("ok_txt",cc.Label),this.cancel_btn=this.main_panel.getChildByName("cancel_btn"),this.cancel_btn_lb=this.seekChild("cancel_txt",cc.Label),this.close_btn=this.main_panel.getChildByName("close_btn"),this.title_lb=this.seekChild("title_label",cc.Label),this.cancel_btn.active=!1,this.ok_btn.x=0,this.aler_des_rt=this.seekChild("aler_des",cc.RichText),this.ok_btn.on(cc.Node.EventType.TOUCH_END,this.didClickOkBtn,this),this.cancel_btn.on(cc.Node.EventType.TOUCH_END,this.didClickCancleBtn,this)},registerEvent:function(){this.close_btn.on(cc.Node.EventType.TOUCH_END,function(t){this.close()}.bind(this))},openRootWnd:function(t){this.aler_des_rt.string=t.str,t.margin?(this.aler_des_rt.node.y=this.aler_des_rt.node.y+t.margin.off_y,1==t.margin.close_off&&(this.close_btn.active=!1)):this.aler_des_rt.node.y=this.aler_des_rt.node.y+57,t.list&&this.createItem(t.list),t.title_str&&(this.title_lb.string=t.title_str),t.confirm_label&&(this.ok_btn_lb.string=t.confirm_label),t.cancel_label&&(this.cancel_btn_lb.string=t.cancel_label),this.confirm_callback=t.confirm_callback,this.cancel_callback=t.cancel_callback,this.main_panel.runAction(cc.scaleTo(.1,1))},createItem:function(t){var e=[];for(var i in t){var s=t[i];(n={}).bid=s[0],n.num=s[1],e.push(n)}for(var i in e){var n=e[i];if(null==this.item_list[i]){var a=ItemsPool.getInstance().getItem("backpack_item");a.initConfig(!1,.9,!1,!0),a.setParent(this.main_panel),a.show(),a.setPosition(140*i-70*(e.length-1),0),this.item_list[i]=a}this.item_list[i].setData(n)}},didClickOkBtn:function(){this.confirm_callback&&this.confirm_callback(),this.close()},didClickCancleBtn:function(){this.cancel_callback&&this.cancel_callback(),this.close()},closeCallBack:function(){if(this.item_list){for(var t in this.item_list)this.item_list[t]&&(this.item_list[t].deleteMe(),this.item_list[t]=null);this.item_list=null}}});e.exports=n,cc._RF.pop()},{pathtool:"pathtool"}],comp_choose_tips_window:[function(t,e,i){"use strict";cc._RF.push(e,"2afe1Z1JSZLXLlfD5VAdH2U","comp_choose_tips_window");var s=t("pathtool"),n=t("backpack_controller");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("tips","comp_choose_tips"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Tips,this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){this.cur_number=1,this.init_number=1},openCallBack:function(){this.background=this.root_wnd.getChildByName("background"),this.main_panel=this.root_wnd.getChildByName("main_panel"),this.text_name=this.main_panel.getChildByName("text_name").getComponent(cc.Label),this.text_name.string="",this.btn_redu=this.main_panel.getChildByName("btn_redu"),this.btn_add=this.main_panel.getChildByName("btn_add"),this.comp_num=this.main_panel.getChildByName("Image_2").getChildByName("comp_num").getComponent(cc.Label),this.comp_num.string="",this.btn_comp=this.main_panel.getChildByName("btn_comp"),this.btn_comp.getChildByName("Text_1").getComponent(cc.Label).string=Utils.TI18N("\u5408\u6210"),this.goods_item=ItemsPool.getInstance().getItem("backpack_item"),this.goods_item.initConfig(!0,1,!1),this.goods_item.setParent(this.main_panel),this.goods_item.show(),this.goods_item.setPosition(0,60)},registerEvent:function(){Utils.onTouchEnd(this.background,function(){this.ctrl.showCompChooseTips(!1)}.bind(this),2),Utils.onTouchEnd(this.btn_redu,function(){this.cur_number=this.cur_number-1,this.cur_number<this.init_number&&(this.setTouchEnable_Add(!1),this.setTouchEnable_Redu(!1)),this.cur_number<=1&&(this.setTouchEnable_Add(!1),this.setTouchEnable_Redu(!0)),this.cur_number<=0&&(this.cur_number=0),this.comp_num.string=this.cur_number}.bind(this),1),Utils.onTouchEnd(this.btn_add,function(){this.cur_number=this.cur_number+1,this.cur_number>1&&(this.setTouchEnable_Add(!1),this.setTouchEnable_Redu(!1)),this.cur_number>=this.init_number&&(this.setTouchEnable_Add(!0),this.setTouchEnable_Redu(!1)),this.cur_number>this.init_number&&(this.cur_number=this.init_number),this.comp_num.string=this.cur_number}.bind(this),1),Utils.onTouchEnd(this.btn_comp,function(){this.item_config&&Config.partner_data.data_get_compound_info[this.item_config.id]&&n.getInstance().sender11008(this.item_config.id,this.cur_number)}.bind(this),1)},setTouchEnable_Add:function(t){this.btn_add.getComponent(cc.Button).interactable=!t,this.btn_add.getComponent(cc.Button).enableAutoGrayEffect=t},setTouchEnable_Redu:function(t){this.btn_redu.getComponent(cc.Button).interactable=!t,this.btn_redu.getComponent(cc.Button).enableAutoGrayEffect=t},openRootWnd:function(t){if(t){var e=Utils.getItemConfig(t);this.item_config=e,this.setBaseInfo()}},setBaseInfo:function(){if(null!=this.item_config){this.goods_item.setData(this.item_config.id),this.text_name.string=this.item_config.name;var t=n.getInstance().getModel().getBackPackItemNumByBid(this.item_config.id),e=1;if(Config.partner_data.data_get_compound_info[this.item_config.id])e=Config.partner_data.data_get_compound_info[this.item_config.id].num;else e=n.getInstance().getModel().getHallowsCompData(this.item_config.id).num;this.cur_number=Math.floor(t/e),this.init_number=this.cur_number,this.comp_num.string=this.cur_number,this.setTouchEnable_Add(!0)}},closeCallBack:function(){this.goods_item&&this.goods_item.deleteMe(),this.goods_item=null,this.ctrl.showCompChooseTips(!1)}});cc._RF.pop()},{backpack_controller:"backpack_controller",pathtool:"pathtool"}],config:[function(t,e,i){"use strict";cc._RF.push(e,"03e8f2O8PND9qc6Aufgji0U","config"),window.DEBUG_LOG=!0,window.INFO_LOG=!0,window.ERROR_LOG=!0,window.SOCKET_LOG=!0,window.NO_SOCKET=!1,window.SHOW_GM=!0,window.OUT_NET=!0,window.USE_SDK=!1,window.CHANNEL="demo",window.GAME_NAME="\u95ea\u70c1\u4e4b\u5149",window.GAME_CODE="h5sszg",window.URL_CONFIG="http://16.163.41.47/url_config.php",window.LOG_URL="http://sszg.local/url_config.php",window.SHOW_BAIDU_TIEBA=!0,window.SHOW_SINGLE_INVICODE=!0,window.SHOW_BIND_PHONE=!0,window.SHOW_WECHAT_CERTIFY=!0,window.SHOW_GAME_SHARE=!0,window.WECHAT_SUBSCRIPTION="sy_sszg",window.SERVER_LIST_URL="http://16.163.41.47/api/role.php",window.ShSdk=!1,cc._RF.pop()},{}],crossshow_controller:[function(t,e,i){"use strict";cc._RF.push(e,"4fdf0VkT9RJbqoONbD6U5Y2","crossshow_controller");var s=t("crossshow_event"),n=cc.Class({extends:BaseController,ctor:function(){},initConfig:function(){var e=t("crossshow_model");this.model=new e,this.model.initConfig()},getModel:function(){return this.model},registerEvents:function(){},registerProtocals:function(){this.RegisterProtocal(22150,this.handle22150)},sender22150:function(){this.SendProtocal(22150,{})},handle22150:function(t){gcore.GlobalEvent.fire(s.Get_Cross_Show_Info_Event,t)},openCrossshowMainWindow:function(t){1==t?(null==this.cross_show_main_window&&(this.cross_show_main_window=Utils.createClass("crossshow_main_window")),0==this.cross_show_main_window.isOpen()&&this.cross_show_main_window.open()):this.cross_show_main_window&&(this.cross_show_main_window.close(),this.cross_show_main_window=null)}});e.exports=n,cc._RF.pop()},{crossshow_event:"crossshow_event",crossshow_model:"crossshow_model"}],crossshow_event:[function(t,e,i){"use strict";cc._RF.push(e,"1e2afblLD1MgbnMO3YhihXh","crossshow_event");var s={Get_Cross_Show_Info_Event:"Get_Cross_Show_Info_Event"};e.exports=s,cc._RF.pop()},{}],crossshow_main_window:[function(t,e,i){"use strict";cc._RF.push(e,"223cfkCWAVNk7Dj8r84F6fv","crossshow_main_window");var s=t("pathtool"),n=t("crossshow_controller"),a=t("rank_controller"),o=t("rank_constant"),l=t("crossshow_event"),r=t("role_controller"),c=t("common_scrollview_single"),_=t("backpack_controller");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("crossshow","crossshow_main_window")},initConfig:function(){this.cross_name_list={},this.ctrl=n.getIntance(),this.role_ctrl=r.getInstance(),this.black_color=new cc.Color(0,0,0,255),this.color_1=new cc.Color(124,215,93,255),this.color_2=new cc.Color(255,230,206,255)},openCallBack:function(){this.backgound=this.seekChild("background"),this.backgound.scale=FIT_SCALE,this.loadRes(s.getBigBg("crossshow/crhosshow_bg"),function(t){this.backgound.getComponent(cc.Sprite).spriteFrame=t}.bind(this)),this.main_container=this.seekChild("main_container"),this.container_size=this.main_container.getContentSize(),this.clost_btn=this.seekChild("close_btn"),this.top_panel=this.seekChild("top_panel"),this.title_name_lb=this.seekChild("title_name",cc.Label),this.title_name_lb.string=Utils.TI18N("\u8de8\u670d\u65f6\u7a7a"),this.lay_scrollview=this.seekChild(this.main_container,"lay_scrollview"),this.bottom_panel=this.seekChild("bottom_panel"),this.icon_scrollview=this.seekChild("icon_scrollview"),this.seekChild(this.bottom_panel,"label_cross",cc.Label).string=Utils.TI18N("\u5f53\u524d\u8de8\u670d\u73a9\u6cd5"),this.seekChild(this.bottom_panel,"label_tips",cc.Label).string=Utils.TI18N("\u8de8\u670d\u65f6\u7a7a\u6bcf\u9694\u4e00\u6bb5\u65f6\u95f4\u4f1a\u91cd\u7ec4"),this.rule_btn=this.seekChild("rule_btn"),this.rule_btn_lb=this.seekChild(this.rule_btn,"label",cc.Label),this.rule_btn_lb.string=Utils.TI18N("\u6392\u884c\u699c"),this.adaptationScreen()},adaptationScreen:function(){},registerEvent:function(){Utils.onTouchEnd(this.clost_btn,function(){this.ctrl.openCrossshowMainWindow(!1)}.bind(this),2),Utils.onTouchEnd(this.rank_btn,function(){a.getIntance().openMainView(!0,o.MainTabType.CrossRank)}.bind(this),1),this.rule_btn.on(cc.Node.EventType.TOUCH_END,function(e){Utils.playButtonSound(1);var i=Config.cross_show_data.data_const.game_rule,s=e.touch.getLocation();i&&t("tips_controller").getInstance().showCommonTips(i.desc,s)}),this.addGlobalEvent(l.Get_Cross_Show_Info_Event,function(t){t&&this.setData(t)})},openRootWnd:function(t){this.world_lev=this.role_ctrl.getModel().getWorldLev()||0,this.role_vo=this.role_ctrl.getRoleVo(),this.role_vo?this.role_lev=this.role_vo.lev||0:this.role_lev=0,this.ctrl.sender22150(),this.addEffect()},setData:function(t){if(t){var e=[];for(var i in t.srv_list){var s=t.srv_list[i],n=Utils.getServerIndex(s.srv_id),a=n[0],o=n[1],l={};0==a?(l.sort_index=1,l.srv_name=Utils.TI18N("\u5f02\u57df")):o?(l.sort_index=0,l.srv_name=cc.js.formatStr(Utils.TI18N("\u672c\u670d%s\u670d"),a)):(l.sort_index=1,l.srv_name=cc.js.formatStr(Utils.TI18N("%s\u670d"),a)),l.srv_index=Number(a),null==l.srv_index&&(l.srv_index=0),l.world_name=cc.js.formatStr(Utils.TI18N("\u4e16\u754c\u7b49\u7ea7%s\u7ea7"),s.world_lev),e[i]=l}e.sort(Utils.tableLowerSorter(["sort_index","srv_index"])),this.show_list=[];for(var r=Math.ceil(e.length/2),c=1;c<=r;c++){var _=e[2*c-1],h=e[2*c],d={};d.left_data=_,d.right_data=h,this.show_list.push(d)}0==this.show_list.length?this.showNoInfo():this.updateNameList(),this.initCrossInfo()}},addEffect:function(){this.size=this.main_container.getSize(),null==this.scene_effect_1&&(this.scene_effect_1=Utils.createEffectSpine(s.getEffectRes(305),cc.v2(.5*self.size.width,.5*self.size.height),cc.v2(.5,.5),!0,PlayerAction.action),this.scene_effect_1.setParent(this.backgound)),null==this.scene_effect_2&&(this.scene_effect_2=Utils.createEffectSpine(s.getEffectRes(306),cc.v2(.5*self.size.width,.5*self.size.height),cc.v2(.5,.5),!0,PlayerAction.action),this.scene_effect_2.setParent(this.backgound))},showNoInfo:function(){if(this.role_vo&&null==this.cross_icon){var t=this.lay_scrollview.getContentSize(),e=.5*t.width,i=.5*t.height+200,n=s.getUIIconPath("crossshow","crossshow_06"),a=this.lay_scrollview;this.cross_icon=Utils.createImage(a,n,e,i,cc.v2(.5,.5)),this.cross_effect=Utils.createEffectSpine(s.getEffectRes(376),cc.v2(e,i),cc.v2(.5,.5),!0,PlayerAction.action),this.cross_effect.setParent(a);var o=s.getUIIconPath("crossshow","crossshow_02");this.left_level_bg=Utils.createImage(a,o,e,i-120,cc.v2(.5,.5),null,null,!0),this.left_level_bg.setContentSize(cc.size(156,40));var l=Utils.getServerIndex(this.role_vo.srv_id),r=l[0],c=(l[1],cc.js.formatStr(Utils.TI18N("\u672c\u670d%s\u670d"),r));this.left_name=Utils.createLabel(22,this.color_1,this.black_color,e,i-120,c,a,2,cc.v2(.5,.5));var _=cc.js.formatStr(Utils.TI18N("\u4e16\u754c\u7b49\u7ea7%s\u7ea7"),this.world_lev);this.left_world_lev=Utils.createLabel(22,this.color_2,this.black_color,e,i-156,_,a,2,cc.v2(.5,.5));var h=Utils.TI18N("\u8be5\u670d\u5c1a\u672a\u8fdb\u884c\u8de8\u670d\u5206\u7ec4(\u03c0v\u03c0)");this.cross_show_tips=Utils.createLabel(24,this.color_2,this.black_color,e,i-200,h,a,2,cc.v2(.5,.5))}},updateNameList:function(){if(this.show_list&&this.scrollview_y&&this.scrollview_height){if(null==this.list_view){var t=this.lay_scrollview.getContentSize(),e=cc.size(t.width,this.scrollview_height),i=this.scrollview_height-135,s=null,n=Math.floor(i/240),a=this.numberOfCellsName();if(n>=a){s=[];for(var o=.5*(i-240*a),l=.5*e.width,r=0;r<a;r++){var _=i-o-(120+240*(r-1));s[r]=cc.v2(l,_)}}var h={start_x:0,space_x:0,start_y:135,end_y:0,space_y:-10,item_width:e.width,item_height:250,delay:1,col:1,need_dynamic:!0,position_data_list:s};this.list_view=new c,this.list_view.createScroll(this.lay_scrollview,cc.v2(.5*e.width,this.scrollview_y),ScrollViewDir.vertical,ScrollViewStartPos.top,e,h,cc.v2(.5,0)),this.list_view.registerScriptHandlerSingle(this.createNewCellName.bind(this),ScrollViewFuncType.CreateNewCell),this.list_view.registerScriptHandlerSingle(this.numberOfCellsName.bind(this),ScrollViewFuncType.NumberOfCells),this.list_view.registerScriptHandlerSingle(this.updateCellByIndexName.bind(this),ScrollViewFuncType.UpdateCellByIndex),n>=a&&this.list_view.setClickEnabled(!1)}this.list_view.reloadData()}},createNewCellName:function(t,e){var i=new cc.Node;i.setAnchorPoint(0,0),i.setContentSize(cc.size(t,e)),i.left_item={},i.right_item={};var n=s.getUIIconPath("crossshow","crossshow_06");i.left_item.icon=Utils.createImage(i,n,146,164,cc.v2(.5,.5)),i.left_item.icon.node.scale=.66,i.right_item.icon=Utils.createImage(i,n,463,133,cc.v2(.5,.5)),i.right_item.icon.node.scale=.66;var a=s.getUIIconPath("crossshow","crossshow_02");i.left_item.level_bg=Utils.createImage(i,a,146,76,cc.v2(.5,.5),null,null,!0),i.left_item.level_bg.setContentSize(cc.size(156,40)),i.right_item.level_bg=Utils.createImage(i,a,463,47,cc.v2(.5,.5),null,null,!0),i.right_item.level_bg.setContentSize(cc.size(156,40));var o=Utils.getEffectRes(377);return i.left_item.cross_effect=Utils.createEffectSpine(o,cc.v2(146,164),cc.v2(.5,.5),!0,PlayerAction.action),i.left_item.cross_effect.node.scale=.66,i.addChild(i.left_item.cross_effect.node,1),o=Utils.getEffectRes(376),i.right_item.cross_effect=Utils.createEffectSpine(o,cc.v2(463,133),cc.v2(.5,.5),!0,PlayerAction.action),i.right_item.cross_effect.node.scale=.66,i.addChild(i.right_item.cross_effect.node,1),o=Utils.getEffectRes(378),i.line_effect1=Utils.createEffectSpine(o,cc.v2(.5*t,150),cc.v2(.5,.5),!0,PlayerAction.action),i.line_effect1.node.scale=.66,i.line_effect1.node.setRotation(10),i.addChild(i.line_effect1.node,1),o=Utils.getEffectRes(378),i.line_effect2=Utils.createEffectSpine(o,cc.v2(.5*t,150),cc.v2(.5,.5),!0,PlayerAction.action),i.line_effect2.node.scale=.66,i.line_effect2.node.setRotation(130),i.line_effect2.node.setScale(1.3,1),i.addChild(i.line_effect2.node,1),i.left_item.name=Utils.createLabel(22,this.color_2,this.black_color,146,76,"",i,2,cc.v2(.5,.5)),i.left_item.world_lev=Utils.createLabel(22,this.color_2,this.black_color,146,40,"",i,2,cc.v2(.5,.5)),i.right_item.name=Utils.createLabel(22,this.color_2,this.black_color,463,47,"",i,2,cc.v2(.5,.5)),i.right_item.world_lev=Utils.createLabel(22,this.color_2,this.black_color,463,11,"",i,2,cc.v2(.5,.5)),i.deleteMe=function(){i.left_item.cross_effect&&(i.left_item.cross_effect.setToSetupPose(),i.left_item.cross_effect.clearTracks(),i.left_item.cross_effect.node.removeFromParent(),i.left_item.cross_effect.node.destroy(),i.left_item.cross_effect=null),i.right_item.cross_effect&&(i.right_item.cross_effect.setToSetupPose(),i.right_item.cross_effect.clearTracks(),i.right_item.cross_effect.node.removeFromParent(),i.right_item.cross_effect.node.destroy(),i.right_item.cross_effect=null),i.line_effect1&&(i.line_effect1.setToSetupPose(),i.line_effect1.clearTracks(),i.line_effect1.node.removeFromParent(),i.line_effect1.node.destroy(),i.line_effect1=null),i.line_effect2&&(i.line_effect2.setToSetupPose(),i.line_effect2.clearTracks(),i.line_effect2.node.removeFromParent(),i.line_effect2.node.destroy(),i.line_effect2=null)}.bind(this),i.DeleteMe=i.deleteMe,i},numberOfCellsName:function(){return this.show_list?this.show_list.length:0},updateCellByIndexName:function(t,e){var i=this.show_list[e];if(i){if(i.left_data&&(0==i.left_data.sort_index?t.left_item.name.node.color=this.color_1:t.left_item.name.node.color=this.color_2,t.left_item.name.string=i.left_data.srv_name,t.left_item.world_lev.string=i.left_data.world_name),i.right_data){for(var s in 0==i.right_data.sort_index?t.right_item.name.node.color=this.color_1:t.right_item.name.node.color=this.color_2,t.right_item.name.string=i.right_data.srv_name,t.right_item.world_lev.string=i.right_data.world_name,t.right_item)t.right_item[s].node.active=!0;t.line_effect1.node.active=!0}else{for(var n in t.right_item)t.right_item[n].node.active=!1;t.line_effect1.node.active=!1}e==this.numberOfCellsName()?t.line_effect2.node.active=!1:t.line_effect2.node.active=!0}},initCrossInfo:function(){var t=Config.cross_show_data.data_base;if(this.cross_list=[],t)for(var e in t)this.cross_list.push(t[e]);this.cross_list.sort(Utils.tableLowerSorter(["id"])),this.updateCrossList()},updateCrossList:function(){if(this.cross_list){if(null==this.cross_list_view){var t=this.icon_scrollview.getContentSize(),e=null,i=Math.floor(t.width/150),s=this.numberOfCells();if(i>=s){e=[];for(var n=0;n<s;n++){var a=125+150*(n-1);e[n]=cc.v2(a,60)}}var o={start_x:0,space_x:0,start_y:0,space_y:0,item_width:150,item_height:120,delay:1,col:1,need_dynamic:!0,position_data_list:e};this.cross_list_view=new c,this.cross_list_view.createScroll(this.icon_scrollview,cc.v2(.5*t.width,.5*t.height),ScrollViewDir.horizontal,ScrollViewStartPos.top,t,o,cc.v2(.5,0)),this.cross_list_view.registerScriptHandlerSingle(this.createNewCell.bind(this),ScrollViewFuncType.CreateNewCell),this.cross_list_view.registerScriptHandlerSingle(this.numberOfCells.bind(this),ScrollViewFuncType.NumberOfCells),this.cross_list_view.registerScriptHandlerSingle(this.updateCellByIndex.bind(this),ScrollViewFuncType.UpdateCellByIndex),this.cross_list_view.registerScriptHandlerSingle(this.onCellTouched.bind(this),ScrollViewFuncType.OnCellTouched),i>=s&&this.cross_list_view.setClickEnabled(!1)}this.cross_list_view.reloadData()}},createNewCell:function(t,e){var i=new cc.Node;i.setAnchorPoint(0,0),i.setContentSize(cc.size(t,e));var n=s.getUIIconPath("common","common_90083");return i.icon=Utils.createImage(i,n,.5*t,.5*e,cc.v2(.5,.5)),i.goto_info=Utils.createLabel(18,this.color_1,this.black_color,.5*t-2,36,"",i,2,cc.v2(.5,.5)),i.goto_info_lo=i.goto_info.node.getComponent(cc.LabelOutline),i.btn=i.addComponet(cc.Button),i.btn.transition=cc.Button.Transition.SCALE,i.on("click",function(){i.is_lock||(Utils.playButtonSound(1),this.onCellTouched(i))},this),i.deleteMe=function(){i.item_load},i},numberOfCells:function(){return this.cross_list.length},updateCellByIndex:function(t,e){t.index=e;var i=this.cross_list[e];if(i){var n=this.checkIconLockInfo(i.open_limit),a=n[0],o=n[1];a?(t.goto_info_lo.enabled=!1,t.btn.interactable=!1,t.goto_info.string=o):(t.goto_info_lo.enabled=!0,t.btn.interactable=!0,t.goto_info.string=Utils.TI18N("\u70b9\u51fb\u524d\u5f80")),t.is_lock=a;var l=cc.js.formatStr("txt_cn_cross_icon_%s",i.icon),r=s.getUIIconPath("crossshow/cross_icon",l);t.record_icon_res!=r&&(t.record_icon_res=r,t.item_load||(t.item_load=this.loadRes(r,function(e){t.icon.spriteFrame=e,a&&(t.btn.interactable=!1)}.bind(this))))}},onCellTouched:function(t){var e=t.index,i=this.cross_list[e],s=this.checkIconLockInfo(i.open_limit),n=s[0],a=s[1];if(n)message(a);else{var o=Config.source_data.data_source_data[i.source_id];o&&_.getInstance().gotoItemSources(o.evt_type,o.extend)}},checkIconLockInfo:function(t){if(t){var e=!1,i="";for(var s in t){var n=t[s];if("world_lev"==n[0]){if(this.world_lev<n[1]){e=!0,i=cc.js.formatStr(Utils.TI18N("%s\u4e16\u754c\u7b49\u7ea7\u89e3\u9501"),n[1]);break}}else if("lev"==n[0]){if(this.role_lev<n[1]){e=!0,i=cc.js.formatStr(Utils.TI18N("%s\u7ea7\u89e3\u9501"),n[1]);break}}else n[0]}return[e,i]}},closeCallBack:function(){this.list_view&&(this.list_view.deleteMe(),this.list_view=null),this.cross_list_view&&(this.cross_list_view.deleteMe(),this.cross_list_view=null),this.cross_effect&&(this.cross_effect.clearTracks(),this.cross_effect.node.removeFromParent(),this.cross_effect.node.destroy(),this.cross_effect=null),this.scene_effect_1&&(this.scene_effect_1.clearTracks(),this.scene_effect_1.node.removeFromParent(),this.scene_effect_1.node.destroy(),this.scene_effect_1=null),this.scene_effect_2&&(this.scene_effect_2.clearTracks(),this.scene_effect_2.node.removeFromParent(),this.scene_effect_2.node.destroy(),this.scene_effect_2=null),this.ctrl.openCrossshowMainWindow(!1)}});cc._RF.pop()},{backpack_controller:"backpack_controller",common_scrollview_single:"common_scrollview_single",crossshow_controller:"crossshow_controller",crossshow_event:"crossshow_event",pathtool:"pathtool",rank_constant:"rank_constant",rank_controller:"rank_controller",role_controller:"role_controller",tips_controller:"tips_controller"}],crossshow_model:[function(t,e,i){"use strict";cc._RF.push(e,"4e746b4MFlHu6JEuPBmJMfD","crossshow_model");cc.Class({extends:BaseClass,ctor:function(){},properties:{},initConfig:function(){}});cc._RF.pop()},{}],customer_service_window:[function(t,e,i){"use strict";cc._RF.push(e,"f6acdQbadFNuLYBECm0RuWO","customer_service_window");var s=t("pathtool"),n=t("login_controller");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("mainui","customer_service_view")},initConfig:function(){this.is_move=!1,this.touch_began=cc.v2(0,0);var e=cc.size(0,0),i=t("viewmanager").getInstance().getSceneNode(SCENE_TAG.msg);i&&(e=i.getContentSize()),this.size=e},initPanel:function(){this.root_wnd.setPosition(cc.v2(-this.size.width/2+35,this.size.height/2-300)),this.main_container=this.root_wnd.getChildByName("container"),this.info_node=this.main_container.getChildByName("info_node"),this.info_bg=this.info_node.getChildByName("info_bg"),this.customer_service_btn=this.info_node.getChildByName("customer_service_btn"),this.reset_btn=this.info_node.getChildByName("reset_btn"),this.cur_timer=gcore.Timer.set(function(){if(0==this.info_node.active){var t=-this.size.width/2;this.root_wnd.getPosition().x>=0&&(t=this.size.width/2),this.root_wnd.runAction(cc.sequence(cc.moveTo(.1,t,this.root_wnd.y),cc.callFunc(function(){})))}}.bind(this),4e3)},registerEvent:function(){Utils.onTouchEnd(this.customer_service_btn,function(){this.info_node.active=!1,"SH_SDK"==PLATFORM_TYPR&&SDK&&SDK.openCustomerServiceConversation()}.bind(this),1),Utils.onTouchEnd(this.reset_btn,function(){if(this.info_node.active=!1,"SH_SDK"==PLATFORM_TYPR){if(1==IS_RESET)return;IS_RESET=!0,n.getInstance().sender10312()}}.bind(this),1),this.root_wnd.on("touchstart",function(t){this.is_move=!1,this.touch_began=t.getLocation(),this.root_wnd.getPosition().x<=-this.size.width/2?this.root_wnd.x=-this.size.width/2+35:this.root_wnd.getPosition().x>=this.size.width/2&&(this.root_wnd.x=this.size.width/2-35)},this),this.root_wnd.on("touchmove",function(t){this.cur_timer&&(gcore.Timer.del(this.cur_timer),this.cur_timer=null);var e=t.getLocation();this.is_move||0==(Math.abs(e.x-this.touch_began.x)<=30&&Math.abs(e.y-this.touch_began.y)<=30)&&(this.is_move=!0);if(this.is_move){if(e=ViewManager.getInstance().getSceneNode(SCENE_TAG.loading).convertToNodeSpaceAR(e),!this.checkPosInRect(e))return;this.root_wnd.setPosition(e),1==this.info_node.active&&(this.info_node.active=!1)}},this),this.root_wnd.on("touchend",function(t){if(0==this.is_move)Utils.playButtonSound(1),0==this.info_node.active&&(this.root_wnd.getPosition().x>=0?(this.info_node.x=-73,this.customer_service_btn.x=8,this.reset_btn.x=-56.4):(this.info_node.x=73,this.customer_service_btn.x=-8,this.reset_btn.x=56.4)),this.info_node.active=!this.info_node.active;else{this.root_wnd.stopAllActions();var e=-this.size.width/2+35;this.root_wnd.getPosition().x>=0&&(e=this.size.width/2-35),this.root_wnd.runAction(cc.sequence(cc.moveTo(.1,e,this.root_wnd.y),cc.callFunc(function(){})))}this.cur_timer&&(gcore.Timer.del(this.cur_timer),this.cur_timer=null),this.cur_timer=gcore.Timer.set(function(){if(0==this.info_node.active){var t=-this.size.width/2;this.root_wnd.getPosition().x>=0&&(t=this.size.width/2),this.root_wnd.runAction(cc.sequence(cc.moveTo(.1,t,this.root_wnd.y),cc.callFunc(function(){})))}}.bind(this),4e3)},this)},checkPosInRect:function(t){if(this.size){var e=-this.size.width/2+35,i=this.size.width/2-35,s=this.size.height/2-35,n=-this.size.height/2+35;return!(t.x<e)&&(!(t.y<n)&&(!(t.x>i)&&!(t.y>s)))}},onShow:function(t){},onHide:function(){},onDelete:function(){this.cur_timer&&(gcore.Timer.del(this.cur_timer),this.cur_timer=null)}});cc._RF.pop()},{login_controller:"login_controller",pathtool:"pathtool",viewmanager:"viewmanager"}],daily_gift_item:[function(t,e,i){"use strict";cc._RF.push(e,"04caazCG7lJIZULGOmH8ubn","daily_gift_item");var s=t("pathtool"),n=t("common_scrollview"),a=t("vip_controller"),o=t("role_controller");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("vip","daily_gift_item")},initConfig:function(){this.ctrl=a.getInstance(),this.model=this.ctrl.getModel(),this.role_vo=o.getInstance().getRoleVo(),this.limit_num=0},initPanel:function(){this.container_nd=this.seekChild("container"),this.image_bg_sp=this.seekChild("image_bg",cc.Sprite),this.title_txt_lb=this.seekChild("title_txt",cc.Label),this.buy_btn=this.seekChild("buy_btn",cc.Button),this.buy_btn_lb=this.seekChild(this.buy_btn.node,"Label",cc.Label),this.gift_desc_rt=this.seekChild("gift_desc_txt",cc.RichText),this.left_num_lb=this.seekChild("left_num",cc.Label);var t=this.seekChild("good_list"),e=t.getContentSize(),i={item_class:"backpack_item",start_x:0,space_x:25,start_y:0,space_y:0,item_width:.7*BackPackItem.Width,item_height:.7*BackPackItem.Width,row:1,col:1,scale:.7};this.item_scrollview=new n,this.item_scrollview.createScroll(t,cc.v2(0,0),ScrollViewDir.horizontal,ScrollViewStartPos.top,e,i,cc.v2(.5,.5))},registerEvent:function(){Utils.onTouchEnd(this.buy_btn.node,function(){this.limit_num>0&&this._onClickBuyBtn()}.bind(this),1)},_onClickBuyBtn:function(){if(this.gift_config){var t=this.gift_config.limit_vip;if(this.role_vo.vip_lev>=t){var e=this.gift_config.charge_id,i=gdata("charge_data","data_charge_data",[e||0]);i&&SDK.pay(i.val,null,i.id,i.name,i.name,null,null)}else message(cc.js.formatStr(Utils.TI18N("VIP%d\u53ef\u8d2d\u4e70"),t))}},setData:function(t){this.data=t,this.root_wnd&&this.onShow()},onShow:function(){if(null!=this.data){this.gift_config=this.data;var t=this.data.id,e=this.model.getDailyGiftBuyCountById(t),i=s.getBigBg(this.gift_config.bg_res);this.loadRes(i,function(t){this.image_bg_sp.spriteFrame=t}.bind(this)),this.title_txt_lb.string=this.gift_config.name||"",this.gift_config.limit_count<=e?(Utils.setGreyButton(this.buy_btn,!0),this.buy_btn_lb.string=Utils.TI18N("\u4eca\u65e5\u5df2\u8d2d"),this.buy_btn_lb.node.color=new cc.Color(255,255,255)):(Utils.setGreyButton(this.buy_btn,!1),this.buy_btn_lb.string=cc.js.formatStr(Utils.TI18N("%d\u5143"),this.gift_config.val||0),this.buy_btn_lb.node.color=new cc.Color(113,40,4)),this.left_num_lb.string=cc.js.formatStr(Utils.TI18N("\u9650\u8d2d:%d\u6b21"),this.gift_config.limit_count-e),this.limit_num=this.gift_config.limit_count-e;var n=StringUtil.parse(this.gift_config.desc),a=cc.js.formatStr("<img src='%s' /></img>",3),o=cc.js.formatStr(n,a,a);this.gift_desc_rt.string=o,this.loadRes(s.getItemRes(3),function(t){this.gift_desc_rt.spriteFrame=t}.bind(this));var l=gdata("charge_data","data_daily_gift_award",[t]);if(l){var r={};for(var c in l){if((h=l[c]).min<=this.role_vo.lev&&h.max>=this.role_vo.lev){r=Utils.deepCopy(h.reward);break}}var _=[];for(var c in r){var h=r[c],d=Utils.deepCopy(Utils.getItemConfig(h[0]));d&&(d.num=h[1],d.bid=h[0],d.quantity=h[1],_.push(d))}var u=!1;this.gift_config&&this.gift_config.is_double&&1==this.gift_config.is_double&&(u=!0),this.item_scrollview.setData(_),this.item_scrollview.addEndCallBack(function(){for(var t=this.item_scrollview.getItemList(),e=0;e<t.length;++e){if(u){var i=t[e].getData();i&&3==i.id?t[e].setDoubleIcon(!0):t[e].setDoubleIcon(!1)}t[e]&&t[e].setDefaultTip()}}.bind(this))}}},onHide:function(){},onDelete:function(){this.item_scrollview&&(this.item_scrollview.deleteMe(),this.item_scrollview=null)}});cc._RF.pop()},{common_scrollview:"common_scrollview",pathtool:"pathtool",role_controller:"role_controller",vip_controller:"vip_controller"}],daily_gift_panel:[function(t,e,i){"use strict";cc._RF.push(e,"8f76eDIrw9HiqBa2xFai58N","daily_gift_panel");var s=t("pathtool"),n=t("role_controller"),a=t("vip_event"),o=t("common_scrollview"),l=t("daily_gift_item"),r=t("welfare_event"),c=t("welfare_controller");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("vip","daily_gift_panel")},initConfig:function(){this.role_vo=n.getInstance().getRoleVo()},initPanel:function(){this.main_container=this.seekChild("main_container"),this.daily_btn=this.seekChild(this.main_container,"daily_btn"),this.daily_btn_tips=this.seekChild(this.daily_btn,"redpoint");var t=this.seekChild(this.main_container,"scrollCon"),e=t.getContentSize(),i={item_class:l,start_x:0,space_x:0,start_y:0,space_y:0,item_width:668,item_height:213,row:1,col:1};this.item_scrollview=new o,this.item_scrollview.createScroll(t,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,e,i,cc.v2(.5,.5))},registerEvent:function(){this.addGlobalEvent(a.DAILY_GIFT_INFO,function(){this.setData()},this),this.addGlobalEvent(r.Update_Daily_Awawd_Data,function(){this.updateDailyAwardRed()},this),Utils.onTouchEnd(this.daily_btn,function(){c.getInstance().sender21009()}.bind(this),1)},setData:function(){var t=[],e=Config.charge_data.data_daily_gift_data;for(var i in e)t.push(e[i]);t.sort(Utils.tableLowerSorter(["id"])),this.item_scrollview.setData(t),this.updateDailyAwardRed()},setVisibleStatus:function(t){this.setVisible(t)},updateDailyAwardRed:function(){var t=!1;0==c.getInstance().getModel().getDailyAwardStatus()&&(t=!0),this.daily_btn_tips.active=t},onShow:function(t){this.setData()},onHide:function(){},onDelete:function(){this.item_scrollview&&(this.item_scrollview.deleteMe(),this.item_scrollview=null)}});cc._RF.pop()},{common_scrollview:"common_scrollview",daily_gift_item:"daily_gift_item",pathtool:"pathtool",role_controller:"role_controller",vip_event:"vip_event",welfare_controller:"welfare_controller",welfare_event:"welfare_event"}],daycharge_controller:[function(t,e,i){"use strict";cc._RF.push(e,"71e8bFZS7xFx5DVmX3VESG3","daycharge_controller");var s=cc.Class({extends:BaseController,ctor:function(){},initConfig:function(){var e=t("daycharge_model");this.model=new e,this.model.initConfig()},getModel:function(){return this.model},registerEvents:function(){},registerProtocals:function(){this.RegisterProtocal(21010,this.handle21010),this.RegisterProtocal(21011,this.handle21011)},sender21010:function(){this.SendProtocal(21010,{})},handle21010:function(e){var i=!1;1==e.status&&(i=!0);var s=t("mainui_controller"),n=t("mainui_const"),a=t("daycharge_event");s.getInstance().setFunctionTipsStatus(n.icon.day_first_charge,i),gcore.GlobalEvent.fire(a.DAY_FIRST_CHARGE_EVENT,e)},sender21011:function(){this.SendProtocal(21011,{})},handle21011:function(t){message(t.msg),1==t.code&&gcore.Timer.set(function(){this.openDayFirstChargeView(!1)}.bind(this),500,1)},openDayFirstChargeView:function(t){t?(this.daycharge_window||(this.daycharge_window=Utils.createClass("daycharge_window",this)),this.daycharge_window&&0==this.daycharge_window.isOpen()&&this.daycharge_window.open()):this.daycharge_window&&(this.daycharge_window.close(),this.daycharge_window=null)}});e.exports=s,cc._RF.pop()},{daycharge_event:"daycharge_event",daycharge_model:"daycharge_model",mainui_const:"mainui_const",mainui_controller:"mainui_controller"}],daycharge_event:[function(t,e,i){"use strict";cc._RF.push(e,"9ea035GcBlFvYnG24fF25V/","daycharge_event"),e.exports={DAY_FIRST_CHARGE_EVENT:"DayChargetEvent.DAY_FIRST_CHARGE_EVENT"},cc._RF.pop()},{}],daycharge_model:[function(t,e,i){"use strict";cc._RF.push(e,"c1de3vRrMpNiJ1AbDna6gq8","daycharge_model");cc.Class({extends:BaseClass,ctor:function(){},properties:{},initConfig:function(){}});cc._RF.pop()},{}],daycharge_window:[function(t,e,i){"use strict";cc._RF.push(e,"322b6m5h+ZIXarsm7Ud5F/B","daycharge_window");var s=t("pathtool"),n=t("daycharge_event");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("action","action_day_charge_window"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Big,this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){this.first_effect=[]},openCallBack:function(){this.background=this.root_wnd.getChildByName("background"),this.background.scale=FIT_SCALE,this.main_container=this.root_wnd.getChildByName("main_container"),this.Sprite_8_node=this.main_container.getChildByName("Sprite_8"),this.Sprite_8=this.Sprite_8_node.getComponent(cc.Sprite);var e=s.getBigBg("txt_cn_action_bigbg_2",null,"action");this.loadRes(e,function(t){this.Sprite_8.spriteFrame=t}.bind(this)),this.btn_charge=this.main_container.getChildByName("btn_charge"),this.btn_charge.active=!1,this.btn_get=this.main_container.getChildByName("btn_get"),this.btn_get.active=!1,this.title_eff_nd=this.main_container.getChildByName("title_eff_nd"),this.first_effect[1]=this.title_eff_nd.getComponent(sp.Skeleton);var i=s.getSpinePath(s.getEffectRes(650),"action");this.loadRes(i,function(t,e){t.skeletonData=e,t.setAnimation(0,PlayerAction.action,!0)}.bind(this,this.first_effect[1])),this.get_eff_nd=this.main_container.getChildByName("get_eff_nd"),this.first_effect[2]=this.get_eff_nd.getComponent(sp.Skeleton),this.first_effect[2].node.active=!1;i=s.getSpinePath(s.getEffectRes(651),"action");this.loadRes(i,function(t,e){t.skeletonData=e,t.setAnimation(0,PlayerAction.action,!0)}.bind(this,this.first_effect[2])),this.charge_num=this.seekChild(this.main_container,"charge_num").getComponent("CusRichText"),this.cahrge_num_child_nd=this.seekChild(this.charge_num.node,"CusNum"),this.diamond=this.main_container.getChildByName("Sprite_9");var n=this.main_container.getChildByName("good_cons"),a=n.getContentSize(),o=t("common_scrollview");this.item_scrollview=new o,this.item_scrollview.createScroll(n,cc.v2(0,0),ScrollViewDir.horizontal,ScrollViewStartPos.top,a,{item_class:"backpack_item",start_x:0,space_x:15,start_y:15,space_y:0,item_width:108,item_height:108,row:1,col:0,scale:.9}),this.item_scrollview.setClickEnabled(!1)},registerEvent:function(){this.addGlobalEvent(n.DAY_FIRST_CHARGE_EVENT,function(t){if(t){var e=Config.charge_data.data_constant.day_charge_goal.val-t.num;e<=0&&(e=0),this.charge_num.setNum(e),this.diamond.x=this.charge_num.node.x+1.4*this.cahrge_num_child_nd.getContentSize().width,0==t.status?(this.first_effect[2].node.active=!0,this.btn_charge.active=!0,this.btn_get.active=!1):1==t.status&&(this.first_effect[2].node.active=!1,this.btn_charge.active=!1,this.btn_get.active=!0)}}.bind(this)),Utils.onTouchEnd(this.background,function(){this.ctrl.openDayFirstChargeView(!1)}.bind(this),2),Utils.onTouchEnd(this.btn_charge,function(){this.ctrl.openDayFirstChargeView(!1),t("vip_controller").getInstance().openVipMainWindow(!0,VIPTABCONST.CHARGE)}.bind(this),1),Utils.onTouchEnd(this.btn_get,function(){this.ctrl.sender21011()}.bind(this),1)},openRootWnd:function(e){this.ctrl.sender21010();var i=t("role_controller").getInstance().getRoleVo(),s=Config.charge_data.data_daily_reward_length,n=Config.charge_data.data_daily_reward;for(var a in n)if(i.open_day>=n[a].min&&i.open_day<=n[a].max){s=n[a].id;break}if(this.item_scrollview){var o=[];for(var a in n[s].reward){var l=n[s].reward[a],r={};r.bid=l[0],r.num=l[1],o.push(r)}this.item_scrollview.setData(o),this.item_scrollview.addEndCallBack(function(){var t=this.item_scrollview.getItemList();for(var e in t)t[e].setDefaultTip()}.bind(this))}this.diamond.x=this.charge_num.node.x+1.4*this.cahrge_num_child_nd.getContentSize().width},closeCallBack:function(){for(var t in this.item_scrollview&&(this.item_scrollview.deleteMe(),this.item_scrollview=null),this.first_effect)this.first_effect[t]&&(this.first_effect[t].setToSetupPose(),this.first_effect[t].clearTracks());this.ctrl.openDayFirstChargeView(!1)}});cc._RF.pop()},{common_scrollview:"common_scrollview",daycharge_event:"daycharge_event",pathtool:"pathtool",role_controller:"role_controller",vip_controller:"vip_controller"}],downloadmanager:[function(t,e,i){"use strict";cc._RF.push(e,"36187xGjVFOz6dZMgh6XWg8","downloadmanager"),window.DownloadManager=cc.Class({ctor:function(){this._spinesCache=[]},checkAnimaCache:function(){},downloadSpine:function(t,e){var i={spine_id:t,index:e};this._spinesCache.push(i),this._spinesCache.length>0&&!this._downTimer&&(this._downTimer=gcore.Timer.set(this.preDownLoad.bind(this),500,-1))},preDownLoad:function(){if(!cc.loader.getDownLoadStatus()){var t=this._spinesCache.shift();if(t.index){var e=t.index;t.index>=CacheAnimas.length-1&&(e="finish"),cc.sys.localStorage.setItem("sszg_anima_cache_1",JSON.stringify({status:e}))}this.doDownloadSpine(t.spine_id),this._spinesCache.length<=0&&this._downTimer&&(gcore.Timer.del(this._downTimer),this._downTimer=null)}},doDownloadSpine:function(t){if(t){var e="spine/"+t+"/",i=cc.loader.getDirUuids(e,sp.SkeletonData);cc.log(i)}},downloadText:function(t,e){var i=cc.loader.getXMLHttpRequest(),s="Load text file failed: "+t;i.open("GET",t,!0),i.overrideMimeType&&i.overrideMimeType("text/plain; charset=utf-8"),i.onload=function(){4===i.readyState?200===i.status||0===i.status?e&&e(null,i.responseText):e&&e({status:i.status,errorMessage:s+"(wrong status)"}):e&&e({status:i.status,errorMessage:s+"(wrong readyState)"})},i.onerror=function(){e&&e({status:i.status,errorMessage:s+"(error)"})},i.ontimeout=function(){e&&e({status:i.status,errorMessage:s+"(time out)"})},i.send(null)},downloadImage:function(t,e,i){if(t){void 0===i&&(i=!0);var s=new Image;if(i&&"file:"!==window.location.protocol?s.crossOrigin="anonymous":s.crossOrigin=null,s.complete&&s.naturalWidth>0&&s.src===t)return s;var n=function t(){s.removeEventListener("load",t),s.removeEventListener("error",a)},a=function t(){s.removeEventListener("load",n),s.removeEventListener("error",t)};s.addEventListener("load",n),s.addEventListener("error",a),s.src=t}}}),DownloadManager.getInstance=function(){return DownloadManager.instance||(DownloadManager.instance=new DownloadManager),DownloadManager.instance},e.exports=DownloadManager,cc._RF.pop()},{}],element_controller:[function(t,e,i){"use strict";cc._RF.push(e,"0ab24G2T2JArJP7gMPVFyU/","element_controller");var s=cc.Class({extends:BaseController,ctor:function(){},initConfig:function(){var e=t("element_model");this.model=new e,this.model.initConfig()},getModel:function(){return this.model},registerEvents:function(){},registerProtocals:function(){this.RegisterProtocal(25e3,this.handle25000),this.RegisterProtocal(25001,this.handle25001),this.RegisterProtocal(25002,this.handle25002),this.RegisterProtocal(25003,this.handle25003),this.RegisterProtocal(25004,this.handle25004),this.RegisterProtocal(25005,this.handle25005)},handle25000:function(){},handle25001:function(){},handle25002:function(){},handle25003:function(){},handle25004:function(){},handle25005:function(){},openElementMainWindow:function(t){if(1==t){if(!this.model.checkElementIsOpen())return;null==this.element_main_wnd&&(this.element_main_wnd=ElementMainWindow.New()),0==this.element_main_wnd.isOpen()&&this.element_main_wnd.open()}else this.element_main_wnd&&(this.element_main_wnd.close(),this.element_main_wnd=null)}});e.exports=s,cc._RF.pop()},{element_model:"element_model"}],element_model:[function(t,e,i){"use strict";cc._RF.push(e,"f2275sSXYlBkoIS1clF90pW","element_model");cc.Class({extends:BaseClass,ctor:function(){},properties:{},initConfig:function(){}});cc._RF.pop()},{}],elitesummon_const:[function(t,e,i){"use strict";cc._RF.push(e,"e83d4JG7pZD6a7dnJr08gtU","elitesummon_const");var s={ActivityID:{elite_summon_1:34001,elite_summon_2:36017,elite_summon_3:39014}};e.exports=s,cc._RF.pop()},{}],elitesummon_controller:[function(t,e,i){"use strict";cc._RF.push(e,"4e7fa/tWJZDpKuLcdb8m4W+","elitesummon_controller");var s=t("elitesummon_event"),n=cc.Class({extends:BaseController,ctor:function(){},initConfig:function(){var e=t("elitesummon_model");this.model=new e,this.model.initConfig()},getModel:function(){return this.model},registerEvents:function(){},registerProtocals:function(){this.RegisterProtocal(23220,this.handle23220),this.RegisterProtocal(23221,this.handle23221),this.RegisterProtocal(23222,this.handle23222)},send23220:function(){this.SendProtocal(23220)},send23222:function(){this.SendProtocal(23222)},send23221:function(t,e){var i={};i.times=t,i.recruit_type=e,this.SendProtocal(23221,i)},handle23220:function(t){gcore.GlobalEvent.fire(s.EliteSummon_Message,t)},handle23221:function(t){message(t.msg)},handle23222:function(t){message(t.msg)},handle16690:function(t){},handle16691:function(t){},handle16692:function(t){},handle16693:function(t){},handle16694:function(t){}});e.exports=n,cc._RF.pop()},{elitesummon_event:"elitesummon_event",elitesummon_model:"elitesummon_model"}],elitesummon_event:[function(t,e,i){"use strict";cc._RF.push(e,"8ccfa7UFG5CJpu9qCNEM+CZ","elitesummon_event");var s={EliteSummon_Message:"EliteSummonEvent.EliteSummon_Message",PresageSummon_Message:"EliteSummonEvent.PresageSummon_Message",PresageSummon_ReFresh:"EliteSummonEvent.PresageSummon_ReFresh",PresageSummon_Buy_Return:"EliteSummonEvent.PresageSummon_Buy_Return",PresageSummon_Open_Pine:"EliteSummonEvent.PresageSummon_Open_Pine"};e.exports=s,cc._RF.pop()},{}],elitesummon_model:[function(t,e,i){"use strict";cc._RF.push(e,"81d51neok5EE6cggTMtZXvX","elitesummon_model");cc.Class({extends:BaseClass,ctor:function(){},properties:{},initConfig:function(){},isHolidayHasID:function(t){var e=!1,i=Config.recruit_holiday_elite_data.data_action;if(i)for(var s in i){if(t==i[s].camp_id){e=!0;break}}return e}});cc._RF.pop()},{}],elitesummon_panel:[function(t,e,i){"use strict";cc._RF.push(e,"5d6b5Pw8BNGuKO7vASj0fv2","elitesummon_panel");var s=t("pathtool"),n=t("action_controller"),a=t("elitesummon_event"),o=t("elitesummon_controller"),l=t("role_controller"),r=t("backpack_controller"),c=t("backpack_event"),_=t("backpack_const"),h=t("partnersummon_event"),d=t("mainui_controller"),u=t("partnersummon_controller"),m=t("timetool");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("action","action_time_summon_panel"),this.holiday_bid=arguments[0],this.ctrl=o.getInstance()},initConfig:function(){this._summon_type_1=1,this._summon_type_10=3,this.role_vo=l.getInstance().getRoleVo(),this.arard_data=Config.recruit_holiday_elite_data.data_award,this.const_data=Config.recruit_holiday_elite_data.data_const,this.summon_item_bid=this.const_data.common_s.val,this.summon_data=Config.recruit_holiday_elite_data.data_summon,this.action_config=Config.recruit_holiday_elite_data.data_action},initPanel:function(){this.setPosition(0,-20);var t=this.root_wnd.getChildByName("main_container");this.progress_txt=t.getChildByName("progress_txt").getComponent(cc.Label);var e=t.getChildByName("image_bg").getComponent(cc.Sprite);this.progress=t.getChildByName("progress").getComponent(cc.ProgressBar),this.baodi_bg=t.getChildByName("baodi_bg");var i="txt_cn_elitesummon_1",a=n.getInstance().getActionSubTabVo(this.holiday_bid);a&&""!=a.aim_title&&a.aim_title&&(i=a.aim_title);var o=s.getBigBg(i,"jpg","timesummon");this.loadRes(o,function(t){e.spriteFrame=t}.bind(this)),this.item_num_txt=t.getChildByName("item_num_txt").getComponent(cc.Label),this.award_btn=t.getChildByName("award_btn"),this.award_btn.getChildByName("label").getComponent(cc.Label).string=Utils.TI18N("\u5956\u52b1\u9884\u89c8"),t.getChildByName("preview_btn").active=!1,this.summon_btn_1=t.getChildByName("summon_btn_1"),this.summon_btn_1.getChildByName("label").getComponent(cc.Label).string=Utils.TI18N("\u62db\u52df1\u6b21"),this.summon_txt_1_rt=this.summon_btn_1.getChildByName("summon_txt_1").getComponent(cc.RichText),this.summon_prop_1_nd=this.summon_btn_1.getChildByName("summon_prop"),this.summon_prop_num_lb=this.summon_prop_1_nd.getChildByName("summon_prop_num").getComponent(cc.Label),this.summon_btn_10=t.getChildByName("summon_btn_10"),this.summon_btn_10.getChildByName("label").getComponent(cc.Label).string=Utils.TI18N("\u62db\u52df10\u6b21"),this.summon_prop_10_nd=this.summon_btn_10.getChildByName("summon_prop"),this.summon_prop_sp=this.summon_prop_10_nd.getChildByName("summon_prop_item").getComponent(cc.Sprite),this.summon_10_num_lb=this.summon_prop_10_nd.getChildByName("summon_prop_num").getComponent(cc.Label),this.time_txt=t.getChildByName("time_txt").getComponent(cc.Label),this.time_txt.node.setPosition(414,283),this.time_txt.node.color=new cc.Color(255,252,187);var l=this.time_txt.node.addComponent(cc.LabelOutline);l.color=new cc.Color(112,18,18),l.width=2,this.time_txt.lineHeight=30,this.baodi_text_rt=this.seekChild("baodi_text",cc.RichText),this.baodi_text_rt.node.setAnchorPoint(1,.5),this.baodi_text_rt.node.x=75,this.award_item=ItemsPool.getInstance().getItem("backpack_item"),this.award_item.setParent(t),this.award_item.setPosition(60,728),this.award_item.initConfig(!1,.6,!1,!1),this.award_item.show(),this.award_item.addCallBack(this._onClickAwardItem.bind(this));var r=Utils.getItemConfig(this.summon_item_bid),c=s.getItemRes(r.icon);this.loadRes(c,function(e){this.summon_prop_1_nd.getChildByName("summon_prop_item").getComponent(cc.Sprite).spriteFrame=e,t.getChildByName("item_icon").getComponent(cc.Sprite).spriteFrame=e}.bind(this)),this.baodi_bg.getChildByName("tip").active=!0,this.btn_rule=this.baodi_bg.getChildByName("tip")},registerEvent:function(){this.addGlobalEvent(a.EliteSummon_Message,function(t){t&&(this.ctrl.getModel().isHolidayHasID(t.camp_id)&&this.setData(t))}.bind(this)),this.addGlobalEvent(c.ADD_GOODS,function(t,e){this.updateItemNum(t,e)}.bind(this)),this.addGlobalEvent(c.DELETE_GOODS,function(t,e){this.updateItemNum(t,e)}.bind(this)),this.addGlobalEvent(c.MODIFY_GOODS_NUM,function(t,e){this.updateItemNum(t,e)}.bind(this)),this.addGlobalEvent(h.PartnerSummonSuccess,function(){this.playRecruitEffect()}.bind(this)),this.award_btn.on("click",function(){if(this.data&&this.data.camp_id){var e=this.action_config[this.data.camp_id];if(e)t("timesummon_controller").getInstance().openTimeSummonAwardView(!0,e.group_id,this.data,!0)}},this),this.btn_rule.on("click",function(e){if(this.data&&this.data.camp_id){var i=this.action_config[this.data.camp_id];if(i){var s=e.node.convertToWorldSpaceAR(cc.v2(0,0));t("tips_controller").getInstance().showCommonTips(i.desc,s,null,null,500)}}},this),this.summon_btn_1.on("click",function(){if(Utils.playButtonSound(1),!(this.checkHeroBagIsFull(1)||this.last_time&&gcore.SmartSocket.getTime()-this.last_time<2))if(this.last_time=gcore.SmartSocket.getTime(),3==this._summon_type_1){if(this.data&&this.data.camp_id){var t=this.action_config[this.data.camp_id].group_id,e=this.summon_data[t],i=e.loss_gold_once[0][1],s=Utils.getItemConfig(e.loss_gold_once[0][0]).icon,n=Utils.getItemConfig(e.gain_once[0][0]).name||"",a=e.gain_once[0][1];this.showGoldTips(s,i,1,a,n,function(){this.ctrl.send23221(1,this._summon_type_1)})}}else this.ctrl.send23221(1,this._summon_type_1)},this),this.summon_btn_10.on("click",function(){if(Utils.playButtonSound(1),!(this.checkHeroBagIsFull(10)||this.last_time&&Math.abs(gcore.SmartSocket.getTime()-this.last_time)<.5))if(this.last_time=gcore.SmartSocket.getTime(),3==this._summon_type_10){if(this.data&&this.data.camp_id){var t=this.action_config[this.data.camp_id].group_id,e=this.summon_data[t],i=e.loss_gold_ten[0][1],s=Utils.getItemConfig(e.loss_gold_ten[0][0]).icon,n=Utils.getItemConfig(e.gain_ten[0][0]).name||"",a=e.gain_ten[0][1];this.showGoldTips(s,i,10,a,n,function(){this.ctrl.send23221(10,this._summon_type_10)})}}else this.ctrl.send23221(10,this._summon_type_10)},this),this.ctrl.send23220()},onShow:function(t){},onHide:function(){},setData:function(t){this.data=t,this.updateSummonBtnStatus(),this.nextRewardLevel(),this.updateItemNum();var e=cc.js.formatStr("%s-%s",m.getMD2(t.start_time),m.getMD2(t.end_time));this.time_txt.string=e,this.baodi_text_rt.string=Utils.TI18N(cc.js.formatStr(StringUtil.parseStr("<div fontcolor=#ffffff outline=2,#000000>\u5269\u4f59</div><div fontcolor=#5fde46 outline=2,#000000>%d</div><div fontcolor=#ffffff outline=2,#000000>\u6b21\u62db\u52df\u5185\u5fc5\u51faUP\u82f1\u96c4</div>").string,t.must_count))},updateSummonBtnStatus:function(){if(this.data&&this.data.camp_id){var t=this.action_config[this.data.camp_id],e=this.summon_data[t.group_id],i=r.getInstance().getModel().getItemNumByBid(this.summon_item_bid),n=gcore.SmartSocket.getTime();if(0==this.data.free_time&&this.data.free_time<=n){var a=Utils.TI18N(StringUtil.parseStr("<div fontcolor=#ffffff>\u514d\u8d39\u53ec\u5524</div>").string);this._summon_type_1=1,this.openSummonFreeTimer(!1),this.summon_txt_1_rt.node.active=!0,this.summon_prop_1_nd.active=!1,this.summon_txt_1_rt.string=a}else i>=1?(this._summon_type_1=4,this.openSummonFreeTimer(!1),this.summon_txt_1_rt.node.active=!1,this.summon_prop_1_nd.active=!0,this.summon_prop_num_lb.string=i):this.data.free_time&&(this.left_time=this.data.free_time-n,this.summon_txt_1_rt.node.active=!0,this.summon_prop_1_nd.active=!1,this._summon_type_1=3,this.openSummonFreeTimer(!0));if(i>=10){var o=Utils.getItemConfig(this.summon_item_bid);if(o){var l=s.getItemRes(o.icon);this.summon_10_num_lb.string=i,this.summon_prop_sp.node.scale=.4,this.loadRes(l,function(t){this.summon_prop_sp.spriteFrame=t}.bind(this))}this._summon_type_10=4}else{var c=e.loss_gold_ten[0][0],_=e.loss_gold_ten[0][1],h=s.getItemRes(c);this.summon_prop_sp.node.scale=.3,this.loadRes(h,function(t){this.summon_prop_sp.spriteFrame=t}.bind(this)),this.summon_10_num_lb.string=_,this._summon_type_10=3}}},openSummonFreeTimer:function(t){t?this.left_time>0&&this.summon_txt_1_rt?this.summon_timer||(this.setTimeFormatString(),this.summon_timer=gcore.Timer.set(function(){this.setTimeFormatString()}.bind(this),1e3,-1)):this.summon_timer&&(gcore.Timer.del(this.summon_timer),this.summon_timer=null):null!=this.summon_timer&&(gcore.Timer.del(this.summon_timer),this.summon_timer=null)},setTimeFormatString:function(){this.data&&this.data.free_time-gcore.SmartSocket.getTime()>0?(this.left_time=this.data.free_time-gcore.SmartSocket.getTime(),this.summon_txt_1_rt.string=cc.js.formatStr(Utils.TI18N(StringUtil.parseStr("<div fontcolor=#35ff14>%s</div><div fontcolor=#ffffff>\u540e\u514d\u8d39</div>").string),m.getTimeFormat(this.left_time)),this._summon_type_1=3):(this.summon_txt_1_rt.string=Utils.TI18N(StringUtil.parseStr("<div fontcolor=#ffffff>\u514d\u8d39\u53ec\u5524</div>").string),this._summon_type_1=1,this.summon_timer&&(gcore.Timer.del(this.summon_timer),this.summon_timer=null))},nextRewardLevel:function(){var t=this.nextCount(this.data.times);if(this.arard_data[this.data.camp_id]&&this.arard_data[this.data.camp_id][t]){var e=this.arard_data[this.data.camp_id],i=!1;if(this.award_item){var s=e[t].reward[0][0],n=e[t].reward[0][1];this.award_item.setData({bid:s,num:n});var a=this.getBaoDIStatus();this.is_can_award=a.status;var o=a.id;if(1==this.is_can_award){if(o){var l=e[o].reward[0][0],r=e[o].reward[0][1];this.award_item.setData({bid:l,num:r})}this.award_item.showItemEffect(!0,263,PlayerAction.action_1,!0,1.1)}else this.award_item.showItemEffect(!1);0==this.is_can_award&&this.data.times>=e[Utils.getArrLen(e)].times&&(this.award_item.setReceivedIcon(!0),i=!0)}var c=e[t].times,_="";_=i?Utils.TI18N("\u62db\u52df\u6b21\u6570 ")+this.data.times+"/"+c:Utils.TI18N("\u4e0b\u4e00\u9636\u6bb5 ")+this.data.times+"/"+c,this.progress_txt.string=_;var h=0,d=c;1==t?h=this.data.times:(h=this.data.times-e[t-1].times,d=c-e[t-1].times);var u=h/d;this.data.times>=e[Utils.getArrLen(e)].times&&(u=1),this.progress.progress=u}},_onClickAwardItem:function(){this.data&&(this.is_can_award?this.ctrl.send23222():t("timesummon_controller").getInstance().openTimeSummonProgressView(!0,this.data.times,this.data.camp_id))},nextCount:function(t){var e=1,i=this.arard_data[this.data.camp_id];if(this.arard_data&&i){var s=Utils.getArrLen(i);if(t>=i[s].times)return i[s].id;for(var n in i){var a=n+1;if(a>=s&&(a=s),i[n].times>t&&t<=i[a].times){e=i[n].id;break}}}return e},getBaoDIStatus:function(){var t=!1,e=null;if(this.data&&this.arard_data[this.data.camp_id])for(var i in this.arard_data[this.data.camp_id]){var s=this.arard_data[this.data.camp_id][i],n=!1,a=null;this.data.times>=s.times&&(n=!0,a=s.id);var o=!0;if(1==n)for(var l=0;l<this.data.reward_list.length;++l){if(this.data.reward_list[l].id==a){o=!1;break}}a&&1==o&&(t=!0,e=a)}return{status:t,id:e}},updateItemNum:function(t,e){if(this.summon_item_bid)if(t&&e){if(t==_.Bag_Code.BACKPACK)for(var i in e){var s=e[i];if(s&&s.base_id&&this.summon_item_bid==s.base_id){var n=r.getInstance().getModel().getItemNumByBid(this.summon_item_bid);this.item_num_txt.string=n,this.updateSummonBtnStatus();break}}}else{var a=r.getInstance().getModel().getItemNumByBid(this.summon_item_bid);this.item_num_txt.string=a}},checkHeroBagIsFull:function(e){var i=t("hero_controller").getInstance().getModel().getHeroMaxCount();if(e>i.max_count-i.have_coutn){var s=Utils.TI18N("\u82f1\u96c4\u5217\u8868\u5df2\u6ee1\uff0c\u53ef\u901a\u8fc7\u63d0\u5347\u8d35\u65cf\u7b49\u7ea7\u6216\u8d2d\u4e70\u589e\u52a0\u82f1\u96c4\u643a\u5e26\u6570\u91cf\uff0c\u662f\u5426\u524d\u5f80\u8d2d\u4e70\uff1f");return t("commonalert").show(s,Utils.TI18N("\u786e\u5b9a"),function(){var e=t("mainui_const"),i=t("action_controller");d.getInstance().changeMainUIStatus(e.btn_index.partner),i.getInstance().openActionMainPanel(!1)},Utils.TI18N("\u53d6\u6d88"),function(){}),!0}return!1},showGoldTips:function(e,i,n,a,o,l){this.alert&&(this.alert.close(),this.alert=null);var r=this.role_vo.gold,c=cc.js.formatStr(StringUtil.parseStr(Lang.DIAMOND_CONSUME).string,e,i,r)+cc.js.formatStr(StringUtil.parseStr(Lang.BUY_DES).string,a,o,n),_=[],h=s.getIconPath("item","3");_.push(h);var d=t("commonalert");this.alert=d.show(c,"\u786e\u5b9a",l.bind(this),"\u53d6\u6d88",null,null,null,{resArr:_,maxWidth:450,align:cc.macro.TextAlignment.LEFT})},playRecruitEffect:function(){var e=this.summon_data;if(null==this.summonBg){this.summonBg=(new cc.Node).addComponent(cc.Sprite),this.summonBg.type=cc.Sprite.Type.SLICED,this.summonBg.sizeMode=cc.Sprite.SizeMode.CUSTOM,ViewManager.getInstance().addToSceneNode(this.summonBg.node,SCENE_TAG.dialogue),this.summonBg.node.setContentSize(720,1280),this.summonBg.node.scale=FIT_SCALE,this.summonBg.node.setPosition(0,0);var i=this.action_config[this.data.camp_id].group_id,n=s.getBigBg("timesummon/"+e[i].call_bg_card,"jpg");this.loadRes(n,function(t){this.summonBg.spriteFrame=t,this.summonBg.node.setContentSize(cc.size(720,1280))}.bind(this)),this.summonBg.node.on("touchend",function(){this.summonBg.node.active=!this.summonBg.node.active,this.floor_effect&&(this.floor_effect.paused=!0),this.book_effect&&(this.book_effect.paused=!0),this.light_effect&&(this.light_effect.paused=!0),this.animaComplete()},this)}else this.summonBg.node.active=!this.summonBg.node.active;var a=u.getInstance().getModel().getRecruitData(),o=t("timesummon_controller").getInstance().getModel().getEffectAction(a.rewards);this.floor_action=o[0],this.light_action=o[1];var l=e[a.group_id],r="action";l&&(r=l.action_name);var c="recruit_"+r;Utils.playEffectSound(AUDIO_TYPE.Recruit,c),this.handleFloorEffect(),this.handleLightEffect(),this.handleBookEffect(),d.getInstance().setMainUIBottomStatus(!1),d.getInstance().setMainUITopStatus(!1)},handleFloorEffect:function(){var t=this.floor_action||PlayerAction.action_1;if(this.summonBg&&null==this.floor_effect){this.floor_effect=(new cc.Node).addComponent(sp.Skeleton),this.summonBg.node.addChild(this.floor_effect.node),this.floor_effect.node.setPosition(0,-270);var e=s.getEffectRes("671"),i=s.getSpinePath(e,"action");this.loadRes(i,function(e){this.floor_effect.skeletonData=e,this.floor_effect.setAnimation(0,t)}.bind(this))}else this.floor_effect&&(this.floor_effect.setToSetupPose(),this.floor_effect.paused=!1,this.floor_effect.setAnimation(0,t))},handleLightEffect:function(){var t=this.light_action||PlayerAction.action_1;if(this.summonBg&&null==this.light_effect){this.light_effect=(new cc.Node).addComponent(sp.Skeleton),this.summonBg.node.addChild(this.light_effect.node),this.light_effect.node.setPosition(0,-240);var e=s.getEffectRes("670"),i=s.getSpinePath(e,"action");this.light_effect.setCompleteListener(this.animaComplete.bind(this)),this.loadRes(i,function(e){this.light_effect.skeletonData=e,this.light_effect.setAnimation(0,t)}.bind(this))}else this.light_effect&&(this.light_effect.setToSetupPose(),this.light_effect.paused=!1,this.light_effect.setAnimation(0,t))},handleBookEffect:function(){if(this.summonBg&&null==this.book_effect){this.book_effect=(new cc.Node).addComponent(sp.Skeleton),this.summonBg.node.addChild(this.book_effect.node),this.book_effect.node.setPosition(0,-240);var t=s.getEffectRes("672"),e=s.getSpinePath(t,"action");this.loadRes(e,function(t){this.book_effect.skeletonData=t,this.book_effect.setAnimation(0,PlayerAction.action)}.bind(this))}else this.book_effect&&(this.book_effect.setToSetupPose(),this.book_effect.paused=!1,this.book_effect.setAnimation(0,PlayerAction.action))},animaComplete:function(){this.summonBg.node.active=!1,d.getInstance().setMainUIBottomStatus(!0),d.getInstance().setMainUITopStatus(!0),t("partnersummon_controller").getInstance().openSummonGainWindow(!0)},onDelete:function(){this.award_item&&(this.award_item.deleteMe(),this.award_item=null),this.summon_timer&&(gcore.Timer.del(this.summon_timer),this.summon_timer=null)}});cc._RF.pop()},{action_controller:"action_controller",backpack_const:"backpack_const",backpack_controller:"backpack_controller",backpack_event:"backpack_event",commonalert:"commonalert",elitesummon_controller:"elitesummon_controller",elitesummon_event:"elitesummon_event",hero_controller:"hero_controller",mainui_const:"mainui_const",mainui_controller:"mainui_controller",partnersummon_controller:"partnersummon_controller",partnersummon_event:"partnersummon_event",pathtool:"pathtool",role_controller:"role_controller",timesummon_controller:"timesummon_controller",timetool:"timetool",tips_controller:"tips_controller"}],empoly_item_panel:[function(t,e,i){"use strict";cc._RF.push(e,"9fa0cBYrvVCVYwk/s2Db/1M","empoly_item_panel");var s=t("pathtool"),n=t("heroexpedit_controller");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("heroexpedit","empoly_panel_item"),this.ctrl=n.getInstance(),this.model=this.ctrl.getModel()},initConfig:function(){},initPanel:function(){this.main_container=this.root_wnd.getChildByName("main_container"),this.btn_enpoly=this.main_container.getChildByName("btn_enpoly"),this.btn_enpoly.active=!1,this.text_btn_enpoly=this.btn_enpoly.getChildByName("Text_1_0").getComponent(cc.Label),this.text_btn_enpoly.string=Utils.TI18N("\u9009\u62e9"),this.btn_config=this.main_container.getChildByName("btn_config"),this.btn_config.active=!1,this.btn_config.getChildByName("Text_1").getComponent(cc.Label).string=Utils.TI18N("\u9009\u62e9"),this.text_name=this.main_container.getChildByName("text_name").getComponent(cc.Label),this.text_power=this.main_container.getChildByName("text_power").getComponent(cc.Label),this.text_firend=this.main_container.getChildByName("text_firend").getComponent(cc.Label),this.text_firend_label=this.main_container.getChildByName("text_power_0"),this.text_firend_label.getComponent(cc.Label).string=Utils.TI18N("\u6765\u81ea\u597d\u53cb\uff1a"),this.text_firend_label.active=!1,this.text_firend.node.active=!1,this.my_head=ItemsPool.getInstance().getItem("hero_exhibition_item"),this.my_head.setRootScale(1),this.my_head.setRootPosition(cc.v2(-243,0)),this.my_head.setParent(this.main_container),this.my_head.show(),this.data&&this.updateInfo()},setExtendData:function(t){this.number=t.num||0,this.index=t.index},updateInfo:function(){if(this.root_wnd&&this.data&&null!=Utils.next(this.data)){var t=this.data.index||0,e=this.data.isHelp||!1;if(null==t&&(t=0),1==this.index?(this.text_firend_label.active=!0,this.text_firend.node.active=!0):(this.text_firend_label.active=!1,this.text_firend.node.active=!1),e){this.btn_enpoly.active=!0;var i="";i=1==this.index?Utils.TI18N("\u5df2\u501f\u7528"):Utils.TI18N("\u5df2\u6d3e\u9063"),this.text_btn_enpoly.string=i,this.btn_config.active=!1}else this.btn_config.active=!0,this.btn_enpoly.active=!1;this.text_firend.string=this.data.name,this.text_power.string=this.data.power,this.text_name.string=Config.partner_data.data_partner_base[this.data.bid].name,this.my_head.setData(this.data)}},setData:function(t){this.data=t,this.updateInfo()},registerEvent:function(){Utils.onTouchEnd(this.btn_config,function(){if(this.data&&null!=Utils.next(this.data)){var e=function(){this.main_container&&this.data.rid&&this.data.srv_id&&this.data.id&&(1==this.index?this.ctrl.sender24408(this.data.rid,this.data.srv_id,this.data.id):this.ctrl.sender24407(this.data.id))}.bind(this),i="";i=1==this.index?Utils.TI18N("\u662f\u5426\u786e\u8ba4\u96c7\u4f63\u8be5\u82f1\u96c4\uff1f"):Utils.TI18N("\u662f\u5426\u786e\u8ba4\u6d3e\u9063\u8be5\u82f1\u96c4\uff1f"),t("commonalert").show(i,Utils.TI18N("\u786e\u5b9a"),e,Utils.TI18N("\u53d6\u6d88"))}}.bind(this),1)},onShow:function(t){this.data&&this.updateInfo()},onHide:function(){},onDelete:function(){this.my_head&&(this.my_head.deleteMe(),this.my_head=null)}});cc._RF.pop()},{commonalert:"commonalert",heroexpedit_controller:"heroexpedit_controller",pathtool:"pathtool"}],empoly_window:[function(t,e,i){"use strict";cc._RF.push(e,"879a9lP67hGDYwrB7hhKjgb","empoly_window");var s=t("pathtool"),n=t("hero_controller"),a=t("common_scrollview"),o=t("empoly_item_panel"),l=t("heroexpedit_event");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("heroexpedit","empoly_panel"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Tips,this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){this.cur_index=null,this.reward_list=[],this.tab_list=[],this.employ_data=[],this.send_data=[]},openCallBack:function(){this.background=this.root_wnd.getChildByName("background"),this.background.scale=FIT_SCALE,this.main_container=this.root_wnd.getChildByName("main_container"),this.main_container.getChildByName("Image_6").getChildByName("Text_7").getComponent(cc.Label).string=Utils.TI18N("\u597d\u53cb\u52a9\u9635"),this.text_empoly_num=this.main_container.getChildByName("Text_2").getComponent(cc.Label),this.text_empoly_num.string=Utils.TI18N("\u4eca\u65e5\u5df2\u96c7\u4f63\uff1a ");for(var t=this.main_container.getChildByName("tab_container"),e=[Utils.TI18N("\u652f\u63f4\u6211\u7684"),Utils.TI18N("\u6211\u7684\u652f\u63f4")],i=1;i<3;i++){var l={};l.btn=t.getChildByName("btn_"+i),l.normal=l.btn.getChildByName("normal"),l.select=l.btn.getChildByName("select"),l.select.active=!1,l.title=l.btn.getChildByName("title").getComponent(cc.Label),l.titleLine=l.btn.getChildByName("title").getComponent(cc.LabelOutline),l.title.string=e[i-1],l.title.node.color=new cc.Color(207,181,147,255),l.index=i,this.tab_list[i]=l}this.good_cons=this.main_container.getChildByName("good_cons"),this.empty_bg=Utils.createImage(this.good_cons,null,.5*this.good_cons.width,.5*this.good_cons.height,cc.v2(.5,.5));var r=s.getBigBg("bigbg_3");this.loadRes(r,function(t){this.empty_bg.spriteFrame=t}.bind(this)),this.empty_label=Utils.createLabel(24,new cc.Color(237,205,162,255),null,.5*this.empty_bg.node.width,-75,"",this.empty_bg.node,0,cc.v2(.5,.5)),this.empty_label.string=Utils.TI18N("\u6682\u65e0\u53ef\u96c7\u4f63\u82f1\u96c4\uff0c\u5feb\u53bb\u52a0\u597d\u53cb\u5427"),this.empty_bg.node.active=!1,this.hero_list=n.getInstance().getModel().getExpeditHeroData(),this.hero_list=this.hero_list||[];var c=this.good_cons.getContentSize(),_={item_class:o,start_x:2,space_x:0,start_y:0,space_y:5,item_width:631,item_height:149,row:0,col:1,need_dynamic:!0};this.itemScrollview=new a,this.itemScrollview.createScroll(this.good_cons,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,c,_)},isVisibleRedPoint:function(){var t=this.model.getHeroSendRedPoint();Utils.addRedPointToNodeByStatus(this.tab_list[2].btn,t,null,11)},tabChangeView:function(t){if(t=t||1,this.cur_index!=t)if(null!=this.cur_tab&&(this.cur_tab.select.active=!1,this.cur_tab.title.node.color=new cc.Color(207,181,147,255),this.cur_tab.titleLine.color=new cc.Color(42,22,14,255)),this.cur_index=t,this.cur_tab=this.tab_list[this.cur_index],null!=this.cur_tab&&(this.cur_tab.select.active=!0,this.cur_tab.title.node.color=new cc.Color(255,237,214,255),this.cur_tab.titleLine.color=new cc.Color(42,22,14,255)),1==t){var e=this.model.getPartnerMessage().length;this.text_empoly_num.node.active=!0;var i=cc.js.formatStr(Utils.TI18N("\u4eca\u65e5\u5df2\u96c7\u4f63\uff1a %d/%d"),e,3);if(this.text_empoly_num.string=i,this.employ_data&&null!=Utils.next(this.employ_data))(s={}).num=e,s.index=1,this.itemScrollview.setData(this.employ_data,null,s),this.empty_bg.node.active=!1;else this.itemScrollview.setData([]),this.empty_bg.node.active=!0}else if(2==t)if(this.text_empoly_num.node.active=!1,this.empty_bg.node.active=!1,this.send_data&&null!=Utils.next(this.send_data)){var s;e=this.send_data.length;if((s={}).num=e,s.index=2,this.hero_list.sort(Utils.tableUpperSorter(["power"])),null!=Utils.next(this.send_data)){for(var n=[],a=this.hero_list.length-1;a>=0;a--)this.hero_list[a].id==this.send_data[0].id&&(n=this.hero_list[a],this.hero_list.splice(a,1));n&&null!=Utils.next(n)?(n.isHelp=!0,this.hero_list.unshift(n),s.num=e):s.num=0}this.itemScrollview.setData(this.hero_list,null,s)}else this.ctrl.sender24405()},registerEvent:function(){for(var t in this.addGlobalEvent(l.EmployEvent,function(){var t=this.model.getPartnerMessage(),e=this.model.getEmployPartner();e.sort(function(t,e){return t.power>e.power});for(var i=e.length-1;i>=0;i--)for(var s=t.length-1;s>=0;s--)e[i].bid&&t[s].bid&&e[i].id&&t[s].id&&e[i].srv_id&&t[s].srv_id&&e[i].rid&&t[s].rid&&e[i].bid==t[s].bid&&e[i].id==t[s].id&&e[i].srv_id==t[s].srv_id&&e[i].rid==t[s].rid&&e.shift();var n=t.length;for(var a in 0==e.length&&0==n?this.empty_bg.node.active=!0:this.empty_bg.node.active=!1,t)t[a].isHelp=!0,e.unshift(t[a]);this.text_empoly_num.node.active=!0;var o=cc.js.formatStr(Utils.TI18N("\u4eca\u65e5\u5df2\u96c7\u4f63\uff1a %d/%d"),n,3);this.text_empoly_num.string=o,this.employ_data=e||[];var l={};l.num=n,l.index=1,this.itemScrollview.setData(this.employ_data,null,l)}.bind(this)),this.addGlobalEvent(l.EmploySendEvent,function(t){this.isVisibleRedPoint(),this.send_data=t.list,this.text_empoly_num.node.active=!1;var e=this.send_data.length,i={};if(i.num=e,i.index=2,this.hero_list.sort(Utils.tableUpperSorter(["power"])),null!=Utils.next(this.send_data)){for(var s=[],n=this.hero_list.length-1;n>=0;n--)this.hero_list[n].id==t.list[0].id&&(s=this.hero_list[n],this.hero_list.splice(n,1));s&&null!=Utils.next(s)?(s.isHelp=!0,this.hero_list.unshift(s),i.num=e):i.num=0}this.itemScrollview.setData(this.hero_list,null,i)}.bind(this)),this.addGlobalEvent(l.EmploySendEvent_Success,function(t){var e=this.send_data.length,i={};if(i.num=e,i.index=2,this.hero_list.sort(Utils.tableUpperSorter(["power"])),null!=Utils.next(this.send_data)){for(var s={},n=this.hero_list.length-1;n>=0;n--)this.hero_list[n].id==t&&(s=this.hero_list[n],this.hero_list.splice(n,1));s.isHelp=!0,this.hero_list.unshift(s)}this.itemScrollview.setData(this.hero_list,null,i)}.bind(this)),Utils.onTouchEnd(this.background,function(){this.ctrl.openEmpolyPanelView(!1)}.bind(this),2),this.tab_list)Utils.onTouchEnd(this.tab_list[t].btn,function(t){this.tabChangeView(t.index)}.bind(this,this.tab_list[t]),1)},openRootWnd:function(t){this.tabChangeView(1),this.isVisibleRedPoint(),this.ctrl.sender24406(),this.ctrl.sender24404()},closeCallBack:function(){this.itemScrollview&&(this.itemScrollview.deleteMe(),this.itemScrollview=null),this.cur_index=null,this.reward_list=null,this.tab_list=null,this.employ_data=null,this.send_data=null,this.hero_list=null,this.ctrl.openEmpolyPanelView(!1)}});cc._RF.pop()},{common_scrollview:"common_scrollview",empoly_item_panel:"empoly_item_panel",hero_controller:"hero_controller",heroexpedit_event:"heroexpedit_event",pathtool:"pathtool"}],endless_awards_item_panel:[function(t,e,i){"use strict";cc._RF.push(e,"d59a7ARrMBLYIRoM1CUo+hi","endless_awards_item_panel");var s=t("pathtool");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("endlesstrail","endlesstrail_awards_item")},initConfig:function(){this.item_list=[]},initPanel:function(){this.rank_img=this.root_wnd.getChildByName("rank_img").getComponent(cc.Sprite),this.rank_label=this.root_wnd.getChildByName("rank_label").getComponent(cc.Label),this.item_container=this.root_wnd.getChildByName("item_container"),this.total_width=this.item_container.getContentSize().width,this.data&&this.updateInfo()},registerEvent:function(){},setData:function(t){this.data=t,this.updateInfo()},updateInfo:function(){if(this.root_wnd&&null!=this.data){if(null!=this.data.index)if(this.data.index<=3)if(this.rank_label.node.active=!1,0==this.data.rank)this.rank_img.node.active=!1;else{var t=s.getCommonIcomPath(cc.js.formatStr("common_200%s",this.data.index));this.rank_res_id!=t&&(this.rank_res_id=t,this.loadRes(t,function(t){this.rank_img.spriteFrame=t}.bind(this))),this.rank_img.node.active=!0}else this.rank_img.node.active=!1,this.rank_label.node.active=!0,this.rank_label.string=cc.js.formatStr("%s~%s",this.data.min,this.data.max);for(var e=1,i=null,n=0,a=this.data.items.length-1;a>=0;a--){var o=this.data.items[a];if(Utils.getItemConfig(o[0])){if(null==this.item_list[e]){(i=ItemsPool.getInstance().getItem("backpack_item")).setParent(this.item_container),i.initConfig(!1,.8,!1,!0);n=this.total_width-(106*(e-1)+48);i.setPosition(n,0),i.show(),this.item_list[e]=i}(i=this.item_list[e]).setData({bid:o[0],num:o[1]}),e+=1}}}},onShow:function(t){},onHide:function(){},onDelete:function(){for(var t in this.item_list)this.item_list[t].deleteMe(),this.item_list[t]=null;this.item_list=null}});cc._RF.pop()},{pathtool:"pathtool"}],endless_awards_panel:[function(t,e,i){"use strict";cc._RF.push(e,"2aae49/aLZLiLmg74B1SV9H","endless_awards_panel");var s=t("pathtool"),n=t("endless_awards_item_panel"),a=t("common_scrollview");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("endlesstrail","endlesstrail_awards_panel")},initConfig:function(){},initPanel:function(){var t=this.root_wnd.getChildByName("container");t.getChildByName("rank_title").getComponent(cc.Label).string=Utils.TI18N("\u6392\u540d"),t.getChildByName("award_title").getComponent(cc.Label).string=Utils.TI18N("\u5956\u52b1");var e=t.getChildByName("scroll_container"),i=e.getContentSize(),s={item_class:n,start_x:4,space_x:4,start_y:0,space_y:0,item_width:614,item_height:124,row:0,col:1,need_dynamic:!0};this.scroll_view=new a,this.scroll_view.createScroll(e,null,null,null,i,s)},registerEvent:function(){},setNodeVisible:function(t){this.root_wnd&&(this.root_wnd.active=t)},addToParent:function(){var t=Utils.deepCopy(Config.endless_data.data_rank_reward_data);for(var e in t)t[e].index=parseInt(e)+1;this.scroll_view.setData(t)},onShow:function(t){this.addToParent()},onHide:function(){},onDelete:function(){this.scroll_view&&(this.scroll_view.deleteMe(),this.scroll_view=null)}});cc._RF.pop()},{common_scrollview:"common_scrollview",endless_awards_item_panel:"endless_awards_item_panel",pathtool:"pathtool"}],endless_friend_help_item_2_panel:[function(t,e,i){"use strict";cc._RF.push(e,"69da9MgwjJKVIdtg8p32uz5","endless_friend_help_item_2_panel");var s=t("pathtool"),n=t("partner_const");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("endlesstrail","endlesstrail_friend_help_item_2")},initConfig:function(){this.item_list={},this.is_init=!1},initPanel:function(){var t=this.root_wnd.getChildByName("container");this.career_name=t.getChildByName("career_name").getComponent(cc.Label),this.career_icon=t.getChildByName("career_icon").getComponent(cc.Sprite),this.power_panel=t.getChildByName("power_panel"),this.role_power=this.power_panel.getChildByName("role_power").getComponent(cc.Label),this.role_name=t.getChildByName("role_name").getComponent(cc.Label),this.help_button=t.getChildByName("help_button"),this.help_label=this.help_button.getChildByName("help_label").getComponent(cc.Label),this.help_label.string=Utils.TI18N("\u9009\u62e9"),this.hero_node=t.getChildByName("hero_node"),this.hero_icon=ItemsPool.getInstance().getItem("hero_exhibition_item"),this.hero_icon.setRootScale(.8),this.hero_icon.setRootPosition(0,0),this.hero_icon.setParent(this.hero_node),this.hero_icon.show(),this.data&&this.updateInfo()},registerEvent:function(){Utils.onTouchEnd(this.help_button,function(){this.click_fun&&(1==this.data.select?this.click_fun(this,this.data,this.index,!1):this.click_fun(this,this.data,this.index,!0))}.bind(this),1)},setData:function(t){this.data=t,this.updateInfo()},updateInfo:function(){if(this.root_wnd&&this.data){this.type=this.data.type,this.info_data=this.data.info_data,this.index=this.data._index,this.role_name.string=this.info_data.name,this.role_power.string=this.info_data.power,this.hero_icon.setData(this.info_data);var t=s.getCommonIcomPath(cc.js.formatStr("common_%s",90045+this.info_data.type));this.loadRes(t,function(t){this.career_icon.spriteFrame=t}.bind(this));var e=n.Hero_Type[this.info_data.type]||"";this.career_name.string="["+e+"]"}},addCallBack:function(t){this.click_fun=t},updateBtnStatus:function(t){this.select_status=t},onShow:function(t){},onHide:function(){},onDelete:function(){this.hero_icon&&(this.hero_icon.deleteMe(),this.hero_icon=null)}});cc._RF.pop()},{partner_const:"partner_const",pathtool:"pathtool"}],endless_friend_help_item_panel:[function(t,e,i){"use strict";cc._RF.push(e,"40f79r39nZBQ4H/cB0cFi6U","endless_friend_help_item_panel");var s=t("pathtool"),n=t("partner_const");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("endlesstrail","endlesstrail_friend_help_item")},initConfig:function(){this.item_list={},this.is_init=!1},initPanel:function(){var t=this.root_wnd.getChildByName("container");this.career_name=t.getChildByName("career_name").getComponent(cc.Label),this.career_icon=t.getChildByName("career_icon").getComponent(cc.Sprite),this.power_panel=t.getChildByName("power_panel"),this.role_power=this.power_panel.getChildByName("role_power").getComponent(cc.Label),this.role_name=t.getChildByName("role_name").getComponent(cc.Label),this.help_button=t.getChildByName("help_button"),this.help_button_bg=this.help_button.getComponent(cc.Sprite),this.help_label=this.help_button.getChildByName("help_label").getComponent(cc.Label),this.help_label.string=Utils.TI18N("\u9009\u62e9"),this.help_label_line=this.help_button.getChildByName("help_label").getComponent(cc.LabelOutline),this.firend_label=t.getChildByName("firend_label").getComponent(cc.Label),this.firend_label.active=!1,this.lock_panel=t.getChildByName("lock_panel"),this.lock_panel.getChildByName("limit_label").getComponent(cc.Label).string=Utils.TI18N("\u6218\u529b\u8d85\u51fa\u8303\u56f4"),this.lock_panel.active=!1,this.hero_node=t.getChildByName("hero_node"),this.hero_icon=ItemsPool.getInstance().getItem("hero_exhibition_item"),this.hero_icon.setRootPosition(0,0),this.hero_icon.setParent(this.hero_node),this.hero_icon.show(),this.data&&this.updateInfo()},registerEvent:function(){Utils.onTouchEnd(this.help_button,function(){this.click_fun&&this.data&&(1==this.data.select?this.click_fun(this,this.data,this.index,!1):this.click_fun(this,this.data,this.index,!0))}.bind(this),1)},setData:function(t){this.data=t,this.updateInfo()},updateInfo:function(){if(this.root_wnd&&this.data){this.type=this.data.type,this.info_data=this.data.info_data,this.index=this.data._index,this.hero_icon.setData(this.data),this.firend_label.string=Utils.TI18N("\u6765\u81ea\u597d\u53cb:")+this.data.name,this.role_power.string=this.data.power,this.firend_label.active=!0;var t=Config.partner_data.data_partner_base[this.data.bid];t&&(this.role_name.string=t.name),1==this.data.is_lock?(this.lock_panel.active=!0,this.help_button.active=!1):(this.lock_panel.active=!1,this.help_button.active=!0),this.updateBtnStatus(this.data.select);var e=s.getCommonIcomPath(cc.js.formatStr("common_%s",90045+this.info_data.type));this.loadRes(e,function(t){this.career_icon.spriteFrame=t}.bind(this));var i=n.Hero_Type[this.info_data.type]||"";this.career_name.string="["+i+"]"}},getData:function(){return this.data},addCallBack:function(t){this.click_fun=t},updateBtnStatus:function(t){if(this.cur_status=t,1==t){var e=s.getCommonIcomPath("common_1017");this.loadRes(e,function(t){1==this.cur_status&&(this.help_button_bg.spriteFrame=t)}.bind(this)),this.help_label.string=Utils.TI18N("\u53d6\u6d88\u9009\u62e9"),this.help_label_line.color=new cc.Color(108,43,0,255)}else{e=s.getCommonIcomPath("common_1018");this.loadRes(e,function(t){0==this.cur_status&&(this.help_button_bg.spriteFrame=t)}.bind(this)),this.help_label.string=Utils.TI18N("\u9009\u62e9"),this.help_label_line.color=new cc.Color(43,97,13,255)}},onShow:function(t){},onHide:function(){},onDelete:function(){this.hero_icon&&(this.hero_icon.deleteMe(),this.hero_icon=null)}});cc._RF.pop()},{partner_const:"partner_const",pathtool:"pathtool"}],endless_friend_help_window:[function(t,e,i){"use strict";cc._RF.push(e,"dec88Q9XPVMloT7Ux8yXqzw","endless_friend_help_window");var s=t("pathtool"),n=t("endless_trail_event");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("endlesstrail","endlesstrail_friend_help_window"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Big,this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){this.selected_tab=null,this.tab_list=[],this.panel_list=[]},openCallBack:function(){this.background=this.root_wnd.getChildByName("background"),this.background.scale=FIT_SCALE,this.main_panel=this.root_wnd.getChildByName("main_panel"),this.main_view=this.main_panel.getChildByName("container"),this.close_btn=this.main_panel.getChildByName("close_btn"),this.win_title=this.main_panel.getChildByName("win_title").getComponent(cc.Label),this.win_title.string=Utils.TI18N("\u597d\u53cb\u652f\u63f4");for(var t=this.main_view.getChildByName("tab_container"),e=1;e<3;e++){var i=t.getChildByName("tab_btn_"+e);if(i){var s=i.getChildByName("title").getComponent(cc.Label);1==e?s.string=Utils.TI18N("\u652f\u63f4\u6211\u7684"):2==e&&(s.string=Utils.TI18N("\u6211\u7684\u652f\u63f4")),s.node.color=new cc.Color(207,181,147,255);var n=i.getChildByName("red_point");n.active=!1,2==e&&(n.active=this.model.getIsSendPartner()),i.select=i.getChildByName("select_bg"),i.select.active=!1,i.index=e,i.label=s,i.red_point=n,this.tab_list[e]=i}}this.scroll_container=this.main_view.getChildByName("scroll_container")},registerEvent:function(){for(var t in this.tab_list)Utils.onTouchEnd(this.tab_list[t],function(t){this.changeSelectedTab(t.index)}.bind(this,this.tab_list[t]),3);Utils.onTouchEnd(this.background,function(){this.ctrl.openEndlessFriendHelpView(!1)}.bind(this),2),Utils.onTouchEnd(this.close_btn,function(){this.ctrl.openEndlessFriendHelpView(!1)}.bind(this),2),this.addGlobalEvent(n.UPDATA_REDPOINT_SENDPARTNER_DATA,function(t){this.tab_list&&null!=Utils.next(this.tab_list||[])&&this.tab_list[2]&&this.tab_list[2].red_point&&(this.tab_list[2].red_point.active=t)}.bind(this))},openRootWnd:function(t){t=t||n.helptype.friend,this.changeSelectedTab(t)},changeSelectedTab:function(e){if(null==this.selected_tab||this.selected_tab.index!=e){if(this.selected_tab&&(this.selected_tab.label.node.color=new cc.Color(207,181,147,255),this.selected_tab.select.active=!1,this.selected_tab=null),this.selected_tab=this.tab_list[e],this.selected_tab&&(this.selected_tab.label.node.color=new cc.Color(255,237,214,255),this.selected_tab.select.active=!0),null!=this.cur_panel&&(this.cur_panel.setNodeVisible(!1),this.cur_panel=null),this.cur_panel=this.panel_list[e],null==this.cur_panel){if(e==n.helptype.friend){var i=t("endless_help_me_panel");this.cur_panel=new i}else if(e==n.helptype.me){var s=t("endless_me_help_panel");this.cur_panel=new s}this.panel_list[e]=this.cur_panel,this.cur_panel.show(),this.cur_panel.setParent(this.scroll_container)}this.cur_panel.setNodeVisible(!0)}},closeCallBack:function(){for(var t in this.ctrl.openEndlessFriendHelpView(!1),this.panel_list)this.panel_list[t].deleteMe();this.panel_list=[],this.selected_tab=null,this.cur_panel=null}});cc._RF.pop()},{endless_help_me_panel:"endless_help_me_panel",endless_me_help_panel:"endless_me_help_panel",endless_trail_event:"endless_trail_event",pathtool:"pathtool"}],endless_help_me_panel:[function(t,e,i){"use strict";cc._RF.push(e,"a623fG8o+dB7qUFehEQxZx0","endless_help_me_panel");var s=t("pathtool"),n=t("common_scrollview"),a=t("endless_trail_controller"),o=t("endless_trail_event"),l=(t("role_controller"),t("hero_controller")),r=t("endless_friend_help_item_panel");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("endlesstrail","endlesstrail_help_me_panel"),this.ctrl=a.getInstance(),this.model=a.getInstance().getModel()},initConfig:function(){this.is_select=!1},initPanel:function(){var t=this.root_wnd.getChildByName("container"),e=t.getChildByName("scroll_container");t.getChildByName("desc_label").getComponent(cc.Label).string=Utils.TI18N("(\u8d85\u51fa\u62e5\u6709\u82f1\u96c4120%\u6218\u529b\u7684\u652f\u63f4\u82f1\u96c4\u4e0d\u53ef\u9009\u62e9)");var i=e.getContentSize(),s=cc.size(i.width-4,i.height-10),a={item_class:r,start_x:0,space_x:0,start_y:0,space_y:0,item_width:600,item_height:149,row:0,col:1,need_dynamic:!0};this.scroll_view=new n,this.scroll_view.createScroll(e,cc.v2(4,5),null,null,s,a)},registerEvent:function(){this.addGlobalEvent(o.UPDATA_HIREPARNER_DATA,function(t){this.updateListData(t)}.bind(this)),this.addGlobalEvent(o.UPDATA_HASHIREPARNER_DATA,function(t){this.updateHasListData(this.hire_data,t.list)}.bind(this))},setNodeVisible:function(t){this.root_wnd&&(this.root_wnd.active=t)},updateHasListData:function(t){},updateListData:function(t,e){if(t){this.hire_data=t,this.tmp_list=this.hire_data.list;var i=this.model.getHasHirePartnerData(),s={};i&&(s=i.list);var n=e||s,a=function(t,e,i){if(n&&null!=Utils.next(n||{})){var s=!1;for(var a in n)if(n[a].id==i&&n[a].rid==t&&n[a].srv_id==e){s=!0;break}return s}},o=1.2*l.getInstance().getModel().getMaxFight();for(var r in this.tmp_list){var c=this.tmp_list[r];c.index=r,c._index=r,c.sort_index=2,c.select=!1,1==a(c.rid,c.srv_id,c.id)&&(c.sort_index=3,c.select=!0),c.is_lock=!1,Config.partner_data.data_partner_base[c.bid]&&(c.info_data=Config.partner_data.data_partner_base[c.bid]),c.power>=o&&(c.sort_index=1,c.is_lock=!0)}this.tmp_list.sort(Utils.tableUpperSorter(["sort_index","power"])),this.createList(this.tmp_list)}},createList:function(t){var e=function(t,e,i,s,n){e&&null!=Utils.next(e)&&this.clickFun(t,e,i,s,n)}.bind(this);this.scroll_view.setData(t,e),this.scroll_view.addEndCallBack(function(){var t=this.scroll_view.getItemList();for(var e in t){var i=t[e].getData();1==i.select&&this.clickFun(t[e],i,i._index,!0,!0)}}.bind(this))},addToParent:function(){this.ctrl.send23907()},updateBtnChoseStatus:function(t,e){if(this.tmp_list)for(var i in this.tmp_list){var s=this.tmp_list[i],n=s.select;s._index&&s._index==t?s.select=e:s.select=!1,1==n&&0==s.select?this.ctrl.send23909(s.rid,s.srv_id,s.id,0):0==n&&1==s.select&&this.ctrl.send23909(s.rid,s.srv_id,s.id,1)}},setAllItemBtnStatus:function(){var t=this.scroll_view.getItemList();for(var e in t){1==t[e].getData().select&&t[e].updateBtnStatus(!1)}},clickFun:function(t,e,i,s,n){if(this.setAllItemBtnStatus(),this.select_item_index&&this.select_item_index==i&&this.select_item)return this.updateBtnChoseStatus(this.select_item.index,!1),this.select_item=null,this.is_select=!1,void(this.select_item_index=null);this.select_item=t,this.select_vo=e,this.select_item.updateBtnStatus(!0),this.updateBtnChoseStatus(i,!0),this.select_item_index=i,this.is_select=s},onShow:function(t){this.addToParent()},onHide:function(){},onDelete:function(){this.scroll_view&&(this.scroll_view.deleteMe(),this.scroll_view=null)}});cc._RF.pop()},{common_scrollview:"common_scrollview",endless_friend_help_item_panel:"endless_friend_help_item_panel",endless_trail_controller:"endless_trail_controller",endless_trail_event:"endless_trail_event",hero_controller:"hero_controller",pathtool:"pathtool",role_controller:"role_controller"}],endless_me_help_panel:[function(t,e,i){"use strict";cc._RF.push(e,"20376ZB5zRPzph828HHnJUm","endless_me_help_panel");var s=t("pathtool"),n=t("endless_trail_controller"),a=t("common_scrollview"),o=t("endless_trail_event"),l=t("hero_controller"),r=t("endless_friend_help_item_2_panel"),c=t("partner_const");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("endlesstrail","endlesstrail_me_help_panel"),this.ctrl=n.getInstance(),this.model=n.getInstance().getModel()},initConfig:function(){},initPanel:function(){var t=this.root_wnd.getChildByName("scroll_container");t.getChildByName("desc_title").getComponent(cc.Label).string=Utils.TI18N("\u53ef\u9009\u82f1\u96c4"),t.getChildByName("desc_label").getComponent(cc.Label).string=Utils.TI18N("\u6bcf\u65e5\u6d3e\u9063\u652f\u63f4\u82f1\u96c4\u53ef\u5f97\u5956\u52b1\uff0c\u82e5\u82f1\u96c4\u88ab\u4f7f\u7528\u81ea\u5df1\u5c06\u83b7\u5f97\u53cb\u60c5\u70b9");var e=t.getContentSize(),i=cc.size(e.width-4,e.height-16),s={item_class:r,start_x:0,space_x:0,start_y:0,space_y:0,item_width:600,item_height:124,row:0,col:1,need_dynamic:!0};this.scroll_view=new a,this.scroll_view.createScroll(t,cc.v2(4,7),null,null,i,s);var n=this.root_wnd.getChildByName("my_container");this.item_container=n.getChildByName("item_container"),this.item_container.active=!1,this.career_icon=this.item_container.getChildByName("career_icon").getComponent(cc.Sprite),this.role_name=this.item_container.getChildByName("role_name").getComponent(cc.Label),this.career_name=this.item_container.getChildByName("career_name").getComponent(cc.Label),this.role_power=this.item_container.getChildByName("role_power").getComponent(cc.Label),this.has_label=this.item_container.getChildByName("has_label").getComponent(cc.Label),this.has_label.string=Utils.TI18N("\u5df2\u6d3e\u9063\u652f\u63f4"),n.getChildByName("my_desc_title").getComponent(cc.Label).string=Utils.TI18N("\u5f53\u524d\u5df2\u9009"),this.no_label=n.getChildByName("no_label").getComponent(cc.Label),this.no_label.string=Utils.TI18N("\u6682\u65e0\u6d3e\u9063\u652f\u63f4\u82f1\u96c4,\u5feb\u5feb\u9009\u62e9\u82f1\u96c4\u5e2e\u52a9\u597d\u53cb\u5427"),this.no_label.node.active=!1,this.hero_icon=ItemsPool.getInstance().getItem("hero_exhibition_item"),this.hero_icon.setRootScale(.8),this.hero_icon.setRootPosition(cc.v2(65,64)),this.hero_icon.setParent(this.item_container),this.hero_icon.show()},registerEvent:function(){this.addGlobalEvent(o.UPDATA_SENDPARTNER_DATA,function(t){this.updateListData(t)}.bind(this)),this.addGlobalEvent(o.UPDATA_SENDPARTNER_SUCESS_DATA,function(t){1==t.code&&this.select_item&&(this.select_item.updateBtnStatus(!1),this.select_item=null,this.select_vo=null)}.bind(this))},updateListData:function(t){if(t){if(this.send_data=t,this.send_data.list&&null==Utils.next(this.send_data.list||{}))this.item_container.active=!1,this.no_label.node.active=!0;else if(this.send_data.list[0]&&(this.item_container.active=!0,this.no_label.node.active=!1,this.send_role_data=this.send_data.list[0],this.send_role_data)){this.hero_icon.setData(this.send_role_data),this.role_power.string=this.send_role_data.power;var e=Config.partner_data.data_partner_base[this.send_role_data.bid];if(e){var i=s.getCommonIcomPath(cc.js.formatStr("common_%s",90045+e.type));this.loadRes(i,function(t){this.career_icon.spriteFrame=t}.bind(this));var n=c.Hero_Type[e.type]||"";this.career_name.string="["+n+"]",this.role_name.string=e.name}}var a=0,r=[];(t=l.getInstance().getModel().getAllHeroArray()).sort(Utils.tableUpperSorter(["power","quality","star","lev","sort_order"]));for(var _=0;_<t.length;_++){var h=t[_];this.send_role_data&&this.send_role_data.id&&this.send_role_data.id==h.id||(r[a]={info_data:h,type:o.helptype.me,_index:a},a+=1)}var d=function(t,e,i){e&&null!=Utils.next(e)&&this.clickFun(t,e,i)}.bind(this);this.scroll_view.setData(r,d)}},setNodeVisible:function(t){this.root_wnd&&(this.root_wnd.active=t)},addToParent:function(){this.ctrl.send23905()},clickFun:function(t,e,i){if(this.select_item&&this.select_item.index==i)return this.select_item.updateBtnStatus(!1),this.select_item=null,void(this.select_vo=null);this.select_item&&this.select_item.updateBtnStatus(!1),this.select_item=t,this.select_vo=e,this.select_item.updateBtnStatus(!0),this.select_vo.info_data&&this.select_vo.info_data.partner_id&&this.ctrl.send23908(this.select_vo.info_data.partner_id)},onShow:function(t){this.addToParent()},onHide:function(){},onDelete:function(){this.hero_icon&&(this.hero_icon.deleteMe(),this.hero_icon=null),this.scroll_view&&(this.scroll_view.deleteMe(),this.scroll_view=null)}});cc._RF.pop()},{common_scrollview:"common_scrollview",endless_friend_help_item_2_panel:"endless_friend_help_item_2_panel",endless_trail_controller:"endless_trail_controller",endless_trail_event:"endless_trail_event",hero_controller:"hero_controller",partner_const:"partner_const",pathtool:"pathtool"}],endless_rank_item_panel:[function(t,e,i){"use strict";cc._RF.push(e,"e111eQB9WJDk7AggJkEQ78D","endless_rank_item_panel");var s=t("pathtool"),n=t("friend_controller"),a=t("role_controller"),o=t("playerhead");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("endlesstrail","endlesstrail_rank_item")},initConfig:function(){},initPanel:function(){var t=this.root_wnd.getChildByName("container");this.rank_img=t.getChildByName("rank_img").getComponent(cc.Sprite),this.role_name=t.getChildByName("role_name").getComponent(cc.Label),this.role_power=t.getChildByName("role_power").getComponent(cc.Label),this.rank_txt_nd=t.getChildByName("rank_txt"),this.rank_txt_ct=this.rank_txt_nd.getComponent("CusRichText"),this.score_info=Utils.createRichLabel(20,new cc.Color(104,69,42,255),cc.v2(0,.5),cc.v2(145,0),30,300),this.score_info.horizontalAlign=cc.macro.TextAlignment.LEFT,t.addChild(this.score_info.node),this.role_head=new o,this.role_head.setPosition(-157,0),this.role_head.setScale(.95),this.role_head.setLev(99),this.role_head.setParent(t),this.role_head.show(),this.container=t,this.data&&this.updateInfo()},registerEvent:function(){this.role_head.addCallBack(function(){null!=this.data&&n.getInstance().openFriendCheckPanel(!0,{srv_id:this.data.srv_id,rid:this.data.rid})}.bind(this))},addCallBack:function(t){this.call_back=t},setData:function(t){this.data=t,this.updateInfo()},updateInfo:function(){if(this.root_wnd){var t=a.getInstance().getRoleVo();if(this.data&&t){this.role_name.string=this.data.name,this.role_power.string=this.data.val2,this.role_head.setHeadRes(this.data.face_id),this.role_head.setLev(this.data.lev);var e=this.data.avatar_id,i=Config.avatar_data.data_avatar[e];if(i){var n=i.res_id||0;this.role_head.setFrameRes(n)}if(this.data.idx<=3){null!=this.rank_txt_nd&&(this.rank_txt_nd.active=!1),0==this.data.idx&&(this.rank_img.node.active=!1);n=s.getCommonIcomPath(cc.js.formatStr("common_200%s",this.data.idx));this.rank_res_id!=n&&(this.rank_res_id=n,this.loadRes(n,function(t){this.rank_img.spriteFrame=t}.bind(this))),this.rank_img.node.active=!0}else this.rank_txt_nd.active=!0,this.rank_txt_ct.setNum(this.data.idx),this.rank_img.node.active=!1;var o=cc.js.formatStr(Utils.TI18N("%s<color=#249003 fontsize=22>%s</color>"),Utils.TI18N("\u6700\u5927\u901a\u5173\u6570:"),this.data.val1||0);this.score_info.string=o}}},onShow:function(t){},onHide:function(){},onDelete:function(){this.role_head&&this.role_head.deleteMe(),this.role_head=null}});cc._RF.pop()},{friend_controller:"friend_controller",pathtool:"pathtool",playerhead:"playerhead",role_controller:"role_controller"}],endless_rank_panel:[function(t,e,i){"use strict";cc._RF.push(e,"3c994jZ4wdB04hKk7NQB2GO","endless_rank_panel");var s=t("pathtool"),n=t("endless_trail_controller"),a=t("common_scrollview"),o=t("playerhead"),l=t("rank_event"),r=t("rank_constant"),c=t("rank_controller"),_=t("role_controller"),h=t("endless_rank_item_panel");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("endlesstrail","endlesstrail_rank_panel"),this.ctrl=n.getInstance(),this.model=n.getInstance().getModel()},initConfig:function(){this.is_init=!0},initPanel:function(){this.scroll_container=this.root_wnd.getChildByName("scroll_container"),this.empty_bg=this.scroll_container.getChildByName("empty_bg"),this.empty_bg.active=!1,this.loadRes(s.getBigBg("bigbg_3"),function(t){this.empty_bg.spriteFrame=t}.bind(this)),this.desc_label=this.empty_bg.getChildByName("desc_label").getComponent(cc.Label),this.desc_label.string=Utils.TI18N("\u6682\u65e0\u8bb0\u5f55");var t=this.scroll_container.getContentSize(),e={item_class:h,start_x:4,space_x:4,start_y:0,space_y:-3,item_width:614,item_height:125,row:0,col:1,need_dynamic:!0};this.scroll_view=new a,this.scroll_view.createScroll(this.scroll_container,cc.v2(0,0),null,null,t,e);var i=this.root_wnd.getChildByName("my_container");i.getChildByName("my_rank_title");this.rank_img=i.getChildByName("rank_img").getComponent(cc.Sprite),this.rank_img.node.active=!1,this.rank_x=this.rank_img.node.x,this.rank_y=this.rank_img.node.y,this.rank_txt_nd=i.getChildByName("rank_txt"),this.rank_txt_ct=this.rank_txt_nd.getComponent("CusRichText"),this.role_name=i.getChildByName("role_name").getComponent(cc.Label),this.role_power=i.getChildByName("role_power").getComponent(cc.Label),this.no_rank=i.getChildByName("no_rank").getComponent(cc.Label),this.no_rank.string=Utils.TI18N("\u672a\u4e0a\u699c"),this.no_rank.node.active=!1,this.my_score_info=Utils.createRichLabel(20,new cc.Color(104,69,42,255),cc.v2(.5,.5),cc.v2(520,65),30,300),i.addChild(this.my_score_info.node),this.role_head=new o,this.role_head.setPosition(150,65),this.role_head.setScale(.95),this.role_head.setLev(99),this.role_head.setParent(i),this.role_head.show(),this.my_container=i},registerEvent:function(){this.addGlobalEvent(l.RankEvent_Get_Rank_data,function(t){t.type==r.RankType.endless&&this.updateRankList(t)}.bind(this))},setNodeVisible:function(t){this.root_wnd&&(this.root_wnd.active=t)},addToParent:function(){1==this.is_init&&(c.getInstance().send_12900(r.RankType.endless),this.is_init=!1)},updateRankList:function(t){var e=_.getInstance().getRoleVo();if(t&&e)if(this.role_name.string=e.name,this.role_power.string=e.power,t.my_idx>=0&&t.my_idx<=3)if(null!=this.rank_num&&this.setNodeVisible(!1),0==t.my_idx)this.rank_img.node.active=!1,this.no_rank.node.active=!0;else{this.no_rank.node.active=!1;var i=s.getCommonIcomPath(cc.js.formatStr("common_200%s",t.my_idx));this.rank_res_id!=i&&(this.rank_res_id=i,this.loadRes(i,function(t){this.rank_img.spriteFrame=t}.bind(this))),this.rank_img.node.active=!0}else this.rank_txt_nd.active=!0,this.rank_txt_ct.setNum(t.my_idx),this.rank_img.node.active=!1;var n=cc.js.formatStr(Utils.TI18N("%s<color=#249003 fontsize=22>%s</color>"),Utils.TI18N("\u6700\u5927\u901a\u5173\u6570:"),t.my_val1||0);this.my_score_info.string=n,this.role_head.setHeadRes(e.face_id),this.role_head.setLev(e.lev);var a=e.avatar_base_id,o=Config.avatar_data.data_avatar[a];if(o){i=o.res_id||0;var l=s.getHeadcircle(i);this.role_head.setFrameRes(l)}var r=function(t){this.worshipOtherRole(t)}.bind(this);null!=t.rank_list&&null!=Utils.next(t.rank_list)?(this.scroll_view.setData(t.rank_list,r),this.empty_bg.active=!1):this.empty_bg.active=!0},worshipOtherRole:function(t){null!=t.data&&(this.select_item=t)},onShow:function(t){this.addToParent()},onHide:function(){},onDelete:function(){this.scroll_view&&(this.scroll_view.deleteMe(),this.scroll_view=null),this.role_head&&this.role_head.deleteMe(),this.role_head=null}});cc._RF.pop()},{common_scrollview:"common_scrollview",endless_rank_item_panel:"endless_rank_item_panel",endless_trail_controller:"endless_trail_controller",pathtool:"pathtool",playerhead:"playerhead",rank_constant:"rank_constant",rank_controller:"rank_controller",rank_event:"rank_event",role_controller:"role_controller"}],endless_rank_window:[function(t,e,i){"use strict";cc._RF.push(e,"fe4b4hiJr9F75bDP/xqFqv6","endless_rank_window");var s=t("pathtool"),n=t("endless_trail_event");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("endlesstrail","endlesstrail_rank_window"),this.viewTag=SCENE_TAG.ui,this.win_type=WinType.Full,this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){this.selected_tab=null,this.tab_list=[],this.panel_list=[]},openCallBack:function(){this.root_csb=this.root_wnd.getChildByName("main_container"),this.main_panel=this.root_csb.getChildByName("main_panel"),this.main_view=this.main_panel.getChildByName("container"),this.close_btn=this.root_csb.getChildByName("close_btn"),this.win_title=this.main_panel.getChildByName("win_title").getComponent(cc.Label),this.win_title.string=Utils.TI18N("\u65e0\u5c3d\u8bd5\u70bc\u6392\u884c\u699c");for(var t=this.main_view.getChildByName("tab_container"),e=1;e<3;e++){var i=t.getChildByName("tab_btn_"+e);if(i){var n=i.getChildByName("title").getComponent(cc.Label),a=t.getChildByName("tab_btn_"+e).getComponent(cc.Sprite);1==e?n.string=Utils.TI18N("\u6392\u884c\u699c"):2==e&&(n.string=Utils.TI18N("\u5956\u52b1\u4e00\u89c8")),n.node.color=new cc.Color(207,181,147,255),i.tab_btn_img=a,i.index=e,i.label=n;var o=s.getCommonIcomPath("common_2009");this.loadRes(o,function(t){i.tab_btn_img.spriteFrame=t}.bind(this)),this.tab_list[e]=i}}this.scroll_container=this.main_view.getChildByName("scroll_container")},registerEvent:function(){for(var t in this.tab_list)Utils.onTouchEnd(this.tab_list[t],function(t){this.changeSelectedTab(t.index)}.bind(this,this.tab_list[t]),3);Utils.onTouchEnd(this.close_btn,function(){this.ctrl.openEndlessRankView(!1)}.bind(this),2),this.addGlobalEvent(n.UPDATA_REDPOINT_SENDPARTNER_DATA,function(t){this.tab_list&&null!=Utils.next(this.tab_list||[])&&this.tab_list[2]&&this.tab_list[2].red_point&&(this.tab_list[2].red_point.active=t)}.bind(this))},openRootWnd:function(t){t=t||n.type.rank,this.changeSelectedTab(t)},changeSelectedTab:function(e){if(null==this.selected_tab||this.selected_tab.index!=e){if(this.selected_tab){var i=s.getCommonIcomPath("common_2009");this.loadRes(i,function(t){this.selected_tab.tab_btn_img.spriteFrame=t}.bind(this)),this.selected_tab.label.node.color=new cc.Color(207,181,147,255),this.selected_tab=null}if(this.selected_tab=this.tab_list[e],this.selected_tab){i=s.getCommonIcomPath("common_2010");this.loadRes(i,function(t){this.selected_tab.tab_btn_img.spriteFrame=t}.bind(this)),this.selected_tab.label.node.color=new cc.Color(255,237,214,255)}if(null!=this.cur_panel&&(this.cur_panel.setNodeVisible(!1),this.cur_panel=null),this.cur_panel=this.panel_list[e],null==this.cur_panel){if(e==n.type.rank){var a=t("endless_rank_panel");this.cur_panel=new a}else if(e==n.type.reward){var o=t("endless_awards_panel");this.cur_panel=new o}this.panel_list[e]=this.cur_panel,this.cur_panel.show(),this.cur_panel.setParent(this.scroll_container)}this.cur_panel.setNodeVisible(!0)}},closeCallBack:function(){for(var t in this.ctrl.openEndlessRankView(!1),this.panel_list)this.panel_list[t].deleteMe();this.panel_list=[],this.selected_tab=null,this.cur_panel=null}});cc._RF.pop()},{endless_awards_panel:"endless_awards_panel",endless_rank_panel:"endless_rank_panel",endless_trail_event:"endless_trail_event",pathtool:"pathtool"}],endless_reward_window:[function(t,e,i){"use strict";cc._RF.push(e,"1fb78xQnC5CjpluK8k9V2gB","endless_reward_window");var s=t("pathtool"),n=t("common_scrollview");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("endlesstrail","endlesstrail_reward_window"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Tips,this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){},openCallBack:function(){this.background=this.root_wnd.getChildByName("background"),this.background.scale=FIT_SCALE,this.main_container=this.root_wnd.getChildByName("main_container"),this.main_panel=this.main_container.getChildByName("main_panel"),this.win_title=this.main_panel.getChildByName("win_title").getComponent(cc.Label),this.win_title.string=Utils.TI18N("\u5956\u52b1\u4e00\u89c8"),this.close_btn=this.main_panel.getChildByName("close_btn"),this.first_label=this.main_panel.getChildByName("first_label").getComponent(cc.Label),this.first_label.string=Utils.TI18N("\u9996\u901a\u5956\u52b1"),this.first_container=this.main_panel.getChildByName("first_container"),this.five_label=this.main_panel.getChildByName("five_label").getComponent(cc.Label),this.five_label.string=Utils.TI18N("\u65e5\u5e385\u5173\u6311\u6218\u5956\u52b1"),this.five_container=this.main_panel.getChildByName("five_container"),this.rank_label=this.main_panel.getChildByName("rank_label").getComponent(cc.Label),this.rank_label.string=Utils.TI18N("\u6392\u884c\u699c\u5956\u52b1"),this.rank_container=this.main_panel.getChildByName("rank_container"),this.comfirm_button=this.main_panel.getChildByName("comfirm_button"),this.comfirm_label=this.comfirm_button.getChildByName("comfirm_label").getComponent(cc.Label),this.comfirm_label.string=Utils.TI18N("\u786e\u5b9a")},registerEvent:function(){Utils.onTouchEnd(this.background,function(){this.ctrl.openEndlessRewardWindow(!1)}.bind(this),2),Utils.onTouchEnd(this.close_btn,function(){this.ctrl.openEndlessRewardWindow(!1)}.bind(this),2),Utils.onTouchEnd(this.comfirm_button,function(){this.ctrl.openEndlessRewardWindow(!1)}.bind(this),2)},updateFirstItemData:function(){var t=this.model.getFirstList();if(this.first_scroll_size=this.first_container.getContentSize(),!this.first_scrollview){this.first_scrollview=new n,this.first_scrollview.createScroll(this.first_container,cc.v2(0,0),ScrollViewDir.horizontal,ScrollViewStartPos.top,this.first_scroll_size,{item_class:"backpack_item",start_x:10,space_x:20,start_y:6,space_y:0,item_width:120,item_height:120,row:1,col:0})}if(t){var e=[];for(var i in t){var s=Utils.deepCopy(Utils.getItemConfig(t[i].bid));e.push(s)}this.first_scrollview.setData(e,null,{is_show_tips:!0})}},updateFiveItemData:function(){var t=this.model.getFiveList();if(this.five_scroll_size=this.five_container.getContentSize(),!this.five_scrollview){this.five_scrollview=new n,this.five_scrollview.createScroll(this.five_container,cc.v2(0,0),ScrollViewDir.horizontal,ScrollViewStartPos.top,this.five_scroll_size,{item_class:"backpack_item",start_x:10,space_x:20,start_y:6,space_y:0,item_width:120,item_height:120,row:1,col:0})}if(t){var e=[];for(var i in t){var s=Utils.deepCopy(Utils.getItemConfig(t[i].bid));e.push(s)}this.five_scrollview.setData(e,null,{is_show_tips:!0})}},updateRankItemData:function(){var t=this.model.getRankList();if(this.rank_scroll_size=this.rank_container.getContentSize(),!this.rank_scrollview){this.rank_scrollview=new n,this.rank_scrollview.createScroll(this.rank_container,cc.v2(0,0),ScrollViewDir.horizontal,ScrollViewStartPos.top,this.rank_scroll_size,{item_class:"backpack_item",start_x:10,space_x:20,start_y:6,space_y:0,item_width:120,item_height:120,row:1,col:0})}if(t){var e=[];for(var i in t){var s=Utils.deepCopy(Utils.getItemConfig(t[i].bid));e.push(s)}this.rank_scrollview.setData(e,null,{is_show_tips:!0})}},openRootWnd:function(t){this.updateFirstItemData(),this.updateFiveItemData(),this.updateRankItemData()},closeCallBack:function(){this.first_scrollview&&(this.first_scrollview.deleteMe(),this.first_scrollview=null),this.five_scrollview&&(this.five_scrollview.deleteMe(),this.five_scrollview=null),this.rank_scrollview&&(this.rank_scrollview.deleteMe(),this.rank_scrollview=null),this.ctrl.openEndlessRewardWindow(!1)}});cc._RF.pop()},{common_scrollview:"common_scrollview",pathtool:"pathtool"}],endless_trail_battle_window:[function(t,e,i){"use strict";cc._RF.push(e,"e87fc/LSVBK+YAq2RyQW2Di","endless_trail_battle_window");var s=t("pathtool"),n=t("battle_controller"),a=t("endless_trail_event");t("CusRichText"),cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("endlesstrail","endlesstrail_battle_view"),this.viewTag=SCENE_TAG.effect,this.win_type=WinType.Big,this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){this.is_open=!1},openCallBack:function(){this.effect_num=this.root_wnd.getChildByName("floor_round").getComponent("CusRichText"),this.effect_num.node.action=!1,this.top_container=this.root_wnd.getChildByName("top_container"),this.right_container=this.top_container.getChildByName("right_container"),this.return_btn=this.right_container.getChildByName("return_btn"),this.backpack_btn=this.right_container.getChildByName("backpack_btn"),this.backpack_label=Utils.createRichLabel(22,new cc.Color(255,255,255,255),cc.v2(.5,.5),cc.v2(0,-this.backpack_btn.height/2),30,600),this.backpack_btn.addChild(this.backpack_label.node),this.backpack_red=this.backpack_btn.getChildByName("red_point"),this.left_container=this.top_container.getChildByName("left_container"),this.container_1=this.left_container.getChildByName("container_1"),this.container_1_width=this.container_1.getContentSize().width,this.container_1_height=this.container_1.getContentSize().height,this.container_2=this.left_container.getChildByName("container_2"),this.container_2_width=this.container_2.getContentSize().width,this.container_2_height=this.container_2.getContentSize().height,this.desc_label=Utils.createRichLabel(22,new cc.Color(255,255,255,255),cc.v2(0,.5),cc.v2(35,this.container_1.getContentSize().height/2+2),30,600),this.desc_label.horizontalAlign=cc.macro.TextAlignment.LEFT,this.container_1.addChild(this.desc_label.node),this.desc_label_2=Utils.createRichLabel(22,new cc.Color(255,255,255,255),cc.v2(0,.5),cc.v2(160,this.container_1.getContentSize().height/2+2),30,600),this.desc_label_2.horizontalAlign=cc.macro.TextAlignment.LEFT,this.container_1.addChild(this.desc_label_2.node),this.reward_label=Utils.createRichLabel(22,new cc.Color(255,255,255,255),cc.v2(0,.5),cc.v2(0,this.container_2.getContentSize().height/2),30,600),this.reward_label.horizontalAlign=cc.macro.TextAlignment.LEFT,this.container_2.addChild(this.reward_label.node),this.reward_btn_eff_node=this.seekChild("backpack_eff_node"),this.reward_btn_eff_node.setScale(.5),this.reward_btn_eff_node.active=!1,this.reward_btn_effect=this.seekChild("backpack_eff_node",sp.Skeleton);var t=s.getSpinePath(s.getEffectRes(257),"action");this.loadRes(t,function(t){this.reward_btn_effect.skeletonData=t,this.reward_btn_effect.setAnimation(0,PlayerAction.action,!0)}.bind(this)),this.updateData()},registerEvent:function(){Utils.onTouchEnd(this.return_btn,function(){var e=Utils.TI18N("\u9000\u51fa\u540e\u672c\u573a\u6218\u6597\u5c06\u5224\u5b9a\u4e3a\u5931\u8d25\uff0c\u4e14\u7ed3\u675f\u672c\u6b21\u6311\u6218\u5e76\u7ed3\u7b97\u5956\u52b1\uff0c\u662f\u5426\u786e\u8ba4\u9000\u51fa\u6311\u6218\uff1f");t("commonalert").show(e,Utils.TI18N("\u6211\u8981\u9000\u51fa"),function(){n.getInstance().csFightExit()},Utils.TI18N("\u7ee7\u7eed\u6311\u6218"))}.bind(this),1),Utils.onTouchEnd(this.backpack_btn,function(){this.backpack_btn&&this.ctrl.openEndlessRewardTips(!0,this.backpack_btn)}.bind(this),1),this.addGlobalEvent(a.UPDATA_ENDLESSBATTLE_DATA,function(t){t&&this.updateData(t)}.bind(this)),this.addGlobalEvent(a.UPDATA_FIRST_DATA,function(t){t&&this.updateBtnStatus(t)}.bind(this))},updateData:function(t){var e=t||this.model.getEndlessBattleData();if(e){this.battle_data=e;var i=cc.js.formatStr(Utils.TI18N("\u7b2c%s\u5173"),e.round);this.playFightStartEffect(e.round);var n=Utils.TI18N("\u589e\u76ca\u6548\u679c:");if(e.buff_list&&null!=Utils.next(e.buff_list||{}))for(var a in e.buff_list){var o=e.buff_list[a];if(Config.endless_data.data_buff_data[o.group_id]&&Config.endless_data.data_buff_data[o.group_id][o.id]){var l=Config.endless_data.data_buff_data[o.group_id][o.id];l&&(n+=l.battle_desc)}}else n+=Utils.TI18N("\u6682\u65e0");this.desc_label_2.string=n,this.desc_label.string=i;n=Utils.TI18N("\u5df2\u7d2f\u8ba1\u5956\u52b1:  ");if(e.acc_reward&&Utils.next(e.acc_reward))for(var r in e.acc_reward){n+=cc.js.formatStr(Utils.TI18N("<img src='%s'/> %s "),e.acc_reward[r].base_id,e.acc_reward[r].num),this.loadRes(s.getItemRes(e.acc_reward[r].base_id),function(t){this.reward_label.spriteFrame=t}.bind(this))}else 1==e.reward_flag?n+=Utils.TI18N("\u5f53\u5929\u5df2\u8fbe\u4e0a\u9650,\u65e0\u6cd5\u518d\u7ed3\u7b97\u5956\u52b1"):n=cc.js.formatStr(Utils.TI18N("%s\u518d\u8fc7%s\u5173\u5f00\u59cb\u7ed3\u7b97(\u4eca\u65e5\u81f3\u7b2c%s\u5173)"),n,e.rest_round||0,e.max_reward_round||0);this.reward_label.string=n;t={id:this.battle_data.id,status:this.battle_data.status};this.updateBtnStatus(t)}},playFightStartEffect:function(t){if(null==this.cur_round&&(this.cur_round=t),this.cur_round!=t){if(this.cur_round=t,null==this.effect_container){this.effect_container=new cc.Node,this.effect_container.setContentSize(cc.size(470,80)),this.effect_container.setAnchorPoint(.5,.5),this.effect_container.setPosition(.5*SCREEN_WIDTH,670),this.root_wnd.addChild(this.effect_container);var e=new cc.Node;e.setContentSize(cc.size(470,80)),e.setAnchorPoint(.5,.5),e.setPosition(0,40),this.effect_container.addChild(e),this.top_effect=e.addComponent(sp.Skeleton),this.effect_img_1=Utils.createImage(this.effect_container,null,-62,45,cc.v2(.5,.5));var i=s.getCommonIcomPath("txt_cn_common_90019");this.loadRes(i,function(t){this.effect_img_1.spriteFrame=t}.bind(this)),this.effect_img_2=Utils.createImage(this.effect_container,null,32,45,cc.v2(.5,.5));i=s.getCommonIcomPath("txt_cn_common_90020");this.loadRes(i,function(t){this.effect_img_2.spriteFrame=t}.bind(this)),this.effect_width_1=94,this.effect_width_2=90,this.effect_num&&(this.effect_num.node.removeFromParent(),this.effect_container.addChild(this.effect_num.node),this.effect_num.node.setPosition(0,45));var n=new cc.Node;n.setContentSize(cc.size(470,80)),n.setAnchorPoint(.5,.5),n.setPosition(0,40),this.effect_container.addChild(n),this.bottom_effect=n.addComponent(sp.Skeleton)}var a=s.getSpinePath(s.getEffectRes(323),"action");this.loadRes(a,function(t){this.top_effect.skeletonData=t,this.top_effect.setAnimation(0,PlayerAction.action,!0)}.bind(this));a=s.getSpinePath(s.getEffectRes(324),"action");this.loadRes(a,function(t){this.bottom_effect.skeletonData=t,this.bottom_effect.setAnimation(0,PlayerAction.action,!0)}.bind(this)),this.effect_num.setNum(t);var o=.5*-this.effect_width_1-50,l=63+.5*this.effect_width_2;this.effect_container.active=!0,this.effect_img_1.node.setPosition(-171,102),this.effect_img_2.node.setPosition(240,102),this.effect_img_1.node.opacity=0,this.effect_img_2.node.opacity=0,this.effect_num.node.opacity=0,this.effect_num.node.scale=.5;var r=cc.moveTo(.08,cc.v2(o,45)),c=cc.fadeIn(.1),_=cc.delayTime(.3),h=cc.delayTime(.5),d=cc.callFunc(function(){this.effect_container.active=!1}.bind(this));this.effect_img_1.node.runAction(cc.sequence(cc.spawn(r,c),_,h,d));var u=cc.moveTo(.08,cc.v2(l,45)),m=cc.fadeIn(.1);this.effect_img_2.node.runAction(cc.spawn(u,m));var f=cc.fadeIn(.1),p=cc.scaleTo(.1,1);this.effect_num.node.runAction(cc.spawn(p,f))}},updateBtnStatus:function(t){if(this.battle_data&&t&&Config.endless_data.data_first_data[t.id]){var e=Config.endless_data.data_first_data[t.id];if(e){var i="";this.backpack_btn.id=t.id,this.backpack_label.node.opacity=255,this.backpack_label.node.stopAllActions(),this.reward_btn_eff_node.active=!1,1==t.status?(this.backpack_btn.status=1,i=cc.js.formatStr(Utils.TI18N("<color=#ffffff><outline color=#581818 width=2>\u53ef\u9886\u53d6</outline></color>")),CommonAction.breatheShineAction(this.backpack_label.node),this.reward_btn_eff_node.active=!0):(this.backpack_btn.status=0,i=cc.js.formatStr(Utils.TI18N("<color=#ffffff><outline color=#581818 width=2>\u7b2c</outline></color><color=#fff22a><outline color=#581818 width=2>%s</outline></color><color=#ffffff><outline color=#581818 width=2>\u5173\u9886\u53d6</outline></color>"),e.limit_id)),this.backpack_label.string=i}}},openRootWnd:function(t){n.getInstance().getModel().getBattleScene()&&(this.is_open=!0,gcore.Timer.set(function(){this.ctrl.send23902()}.bind(this),1/60,1))},isOpen:function(){return this.is_open},closeCallBack:function(){this.reward_btn_effect&&(this.reward_btn_effect.setToSetupPose(),this.reward_btn_effect.clearTracks()),this.backpack_label&&this.backpack_label.node&&this.backpack_label.node.stopAllActions(),this.is_open=!1,this.ctrl.openEndlessBattleView(!1)}});cc._RF.pop()},{CusRichText:"CusRichText",battle_controller:"battle_controller",commonalert:"commonalert",endless_trail_event:"endless_trail_event",pathtool:"pathtool"}],endless_trail_buff_item_panel:[function(t,e,i){"use strict";cc._RF.push(e,"161a8Dz3zNHzLt0mT9lT09S","endless_trail_buff_item_panel");var s=t("pathtool"),n=t("endless_trail_controller");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("endlesstrail","endlesstrail_buff_item"),this.ctrl=n.getInstance(),this.model=n.getInstance().getModel()},initConfig:function(){},initPanel:function(){this.root=this.root_wnd.getChildByName("root"),this.buff_icon=this.root.getChildByName("buff_icon").getComponent(cc.Sprite),this.desc_label=Utils.createRichLabel(24,new cc.Color(104,69,42,255),cc.v2(0,.5),cc.v2(130,this.root.getContentSize().height/2),30,250),this.desc_label.horizontalAlign=cc.macro.TextAlignment.LEFT,this.root.addChild(this.desc_label.node),this.select_btn=this.root.getChildByName("select_btn"),this.select_label=this.select_btn.getChildByName("select_label").getComponent(cc.Label),this.select_label.string=Utils.TI18N("\u9009\u62e9\u5e76\u6311\u6218"),this.data&&this.updateInfo()},registerEvent:function(){Utils.onTouchEnd(this.select_btn,function(){this.data&&this.ctrl.send23911(this.data.buff_id)}.bind(this),1)},updateInfo:function(){if(this.root_wnd&&this.data&&Config.endless_data.data_buff_data&&Config.endless_data.data_buff_data[this.data.group_id]&&Config.endless_data.data_buff_data[this.data.group_id][this.data.buff_id]){var t=Config.endless_data.data_buff_data[this.data.group_id][this.data.buff_id];t&&(this.desc_label.string=t.desc,""!=t.icon&&this.loadRes(s.getIconPath("bufficon",t.icon),function(t){this.buff_icon.spriteFrame=t}.bind(this)))}},setData:function(t){this.data=t,this.updateInfo()},getData:function(){return this.data},onShow:function(t){},onHide:function(){},onDelete:function(){}});cc._RF.pop()},{endless_trail_controller:"endless_trail_controller",pathtool:"pathtool"}],endless_trail_buff_window:[function(t,e,i){"use strict";cc._RF.push(e,"acb59BiSk5AXoq9MWOxwprl","endless_trail_buff_window");var s=t("pathtool"),n=t("common_scrollview"),a=t("hero_const"),o=t("endless_trail_buff_item_panel"),l=t("hero_vo");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("endlesstrail","endlesstrail_buff_view"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Tips,this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){this.is_full_screen=!1,this.partner_list=[]},openCallBack:function(){this.background=this.root_wnd.getChildByName("background"),this.background.scale=FIT_SCALE,this.main_container=this.root_wnd.getChildByName("main_container"),this.main_panel=this.main_container.getChildByName("main_panel"),this.win_title=this.main_panel.getChildByName("win_title").getComponent(cc.Label),this.win_title.string=Utils.TI18N("\u589e\u76ca\u9009\u62e9"),this.desc_label=this.main_panel.getChildByName("desc_label").getComponent(cc.Label),this.desc_label.string=Utils.TI18N("\u5fc5\u987b\u9009\u62e9\u4e00\u4e2aBuff\u624d\u80fd\u7ee7\u7eed\u6311\u6218"),this.buff_container=this.main_panel.getChildByName("buff_container"),this.partner_container=this.main_panel.getChildByName("partner_container"),this.form_icon=this.partner_container.getChildByName("form_icon").getComponent(cc.Sprite),this.form_label=this.partner_container.getChildByName("form_label").getComponent(cc.Label),this.desc_label_1=this.partner_container.getChildByName("desc_label_1").getComponent(cc.Label),this.desc_label_1.string=Utils.TI18N("\u6211\u7684\u9635\u5bb9"),this.cur_num=Utils.createRichLabel(24,new cc.Color(104,69,42,255),cc.v2(.5,.5),cc.v2(545-this.main_container.width/2,772-this.main_container.height/2),30,500),this.main_container.addChild(this.cur_num.node),this.buff_scroll_size=this.buff_container.getContentSize();var t={item_class:o,start_x:0,space_x:2,start_y:0,space_y:0,item_width:604,item_height:149,row:0,col:1};this.buff_scrollview=new n,this.buff_scrollview.createScroll(this.buff_container,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,this.buff_scroll_size,t)},registerEvent:function(){},openRootWnd:function(t){if(t){this.buff_data=t,this.cur_num.string=cc.js.formatStr(Utils.TI18N("\u5373\u5c06\u6311\u6218\u7b2c<color=#249003>%s</color>\u5173"),t.round);var e=s.getUIIconPath("form","form_icon_"+t.formation_type);if(this.loadRes(e,function(t){this.form_icon.spriteFrame=t}.bind(this)),Config.formation_data.data_form_data){var i=Config.formation_data.data_form_data[t.formation_type].name;this.form_label.string=i+" Lv."+t.formation_lev}this.updateBuffData(t),this.updatePartnerData(t);var n=t.end_time-gcore.SmartSocket.getTime();n<=0&&(n=0),n>30&&(n=30),this.desc_label.string=Utils.TI18N("\u5fc5\u987b\u9009\u62e91\u4e2aBuff\u624d\u80fd\u7ee7\u7eed\u6218\u6597\uff0c"+n+"\u79d2\u540e\u81ea\u52a8\u9009\u62e9"),this.timer_hander=this.startUpdate(30,function(){n>0&&n--,this.desc_label.string=Utils.TI18N(cc.js.formatStr("\u5fc5\u987b\u9009\u62e91\u4e2aBuff\u624d\u80fd\u7ee7\u7eed\u6218\u6597\uff0c%d\u79d2\u540e\u81ea\u52a8\u9009\u62e9",n)),0==n&&(this.stopUpdate(this.timer_hander),this.timer_hander=null)}.bind(this),1e3)}},updateBuffData:function(t){t&&(t.list.sort(function(t,e){return t.buff_id-e.buff_id}),this.buff_scrollview.setData(t.list))},updatePartnerData:function(t){if(t){var e=t.partner;if(e){var i=[];for(var s in e){e[s].rare_type=e[s].quality;var n=new l;n.updateHeroVo(e[s]),i.push(n)}for(var o in i){if(!this.partner_list[o]){var r=ItemsPool.getInstance().getItem("hero_exhibition_item");r.setRootScale(.8),r.setParent(this.partner_container),r.show(),this.partner_list[o]=r}var c=this.partner_list[o];if(c){c.setExtendData({from_type:a.ExhibitionItemType.eEndLessHero}),c.setData(i[o],!0);c.setPosition(64+121*o,this.partner_container.getContentSize().height/2-10)}}}}},closeCallBack:function(){if(this.timer_hander&&(this.stopUpdate(this.timer_hander),this.timer_hander=null),this.partner_list){for(var t in this.partner_list)this.partner_list[t].onDelete&&this.partner_list[t].deleteMe();this.partner_list=null}this.buff_scrollview&&(this.buff_scrollview.deleteMe(),this.buff_scrollview=null),this.ctrl.openEndlessBuffView(!1)},getData:function(){return this.buff_data}});cc._RF.pop()},{common_scrollview:"common_scrollview",endless_trail_buff_item_panel:"endless_trail_buff_item_panel",hero_const:"hero_const",hero_vo:"hero_vo",pathtool:"pathtool"}],endless_trail_controller:[function(t,e,i){"use strict";cc._RF.push(e,"55197g7R8pEi7Mul4WatCVh","endless_trail_controller");var s=t("mainui_controller"),n=(t("mainscene_event"),t("login_event")),a=t("battle_const"),o=(t("role_controller"),t("role_event"),t("endless_trail_event")),l=cc.Class({extends:BaseController,ctor:function(){},initConfig:function(){var e=t("endless_trail_model");this.model=new e,this.model.initConfig(),this.cache_buff_data=null},getModel:function(){return this.model},registerEvents:function(){null==this.init_role_event&&(this.init_role_event=gcore.GlobalEvent.bind(EventId.EVT_ROLE_CREATE_SUCCESS,function(){gcore.GlobalEvent.unbind(this.init_role_event),this.init_role_event=null}.bind(this))),null==this.battle_enter_event&&(this.battle_enter_event=gcore.GlobalEvent.bind(EventId.ENTER_FIGHT,function(t){t==a.Fight_Type.Endless&&this.openEndlessBattleView(!0)}.bind(this))),null==this.re_link_game_event&&(this.re_link_game_event=gcore.GlobalEvent.bind(n.RE_LINK_GAME,function(){this.requestInitProtocal(!0)}.bind(this))),null==this.battle_exit_event&&(this.battle_exit_event=gcore.GlobalEvent.bind(EventId.EXIT_FIGHT,function(t){this.openEndlessBattleView(!1),t==a.Fight_Type.Endless&&this.openEndlessBuffView(!1)}.bind(this)))},registerProtocals:function(){this.RegisterProtocal(23900,this.handle23900),this.RegisterProtocal(23901,this.handle23901),this.RegisterProtocal(23902,this.handle23902),this.RegisterProtocal(23903,this.handle23903),this.RegisterProtocal(23904,this.handle23904),this.RegisterProtocal(23905,this.handle23905),this.RegisterProtocal(23906,this.handle23906),this.RegisterProtocal(23907,this.handle23907),this.RegisterProtocal(23908,this.handle23908),this.RegisterProtocal(23909,this.handle23909),this.RegisterProtocal(23910,this.handle23910),this.RegisterProtocal(23911,this.handle23911)},checkIsOpen:function(t){var e=Config.endless_data.data_const.open_lev;if(null==e)return!1;var i=s.getInstance().checkIsOpenByActivate(e.val);return 1==t&&0==i&&message(e.desc),i},requestInitProtocal:function(t){1==this.checkIsOpen()&&(this.send23900(),this.send23903(),this.send23906(),this.role_assets_event&&(this.role_vo.unbind(this.role_assets_event),this.role_assets_event=null))},send23900:function(t,e){this.SendProtocal(23900,{})},handle23900:function(t){t&&this.model.setEndlessData(t)},send23901:function(t,e,i){var s={};s.formation_type=t,s.pos_info=e,s.hallows_id=i,this.SendProtocal(23901,s)},handle23901:function(t){message(t.msg)},send23902:function(){this.SendProtocal(23902,{})},handle23902:function(t){this.model.setEndlessBattleData(t)},send23903:function(){this.SendProtocal(23903,{})},handle23903:function(t){t&&this.model.setFirstData(t)},send23904:function(t){var e={};e.id=t,this.SendProtocal(23904,e)},handle23904:function(t){message(t.msg),1==t.code&&this.openEndlessRewardTips(!1)},send23905:function(){this.SendProtocal(23905,{})},handle23905:function(t){t&&this.model.setSendPartnerData(t)},send23906:function(){this.SendProtocal(23906,{})},handle23906:function(t){t&&this.model.setHasHirePartnerData(t)},send23907:function(){this.SendProtocal(23907,{})},handle23907:function(t){t&&this.model.setHirePartnerData(t)},send23908:function(t){var e={};e.id=t,this.SendProtocal(23908,e)},handle23908:function(t){message(t.msg),1==t.code&&gcore.GlobalEvent.fire(o.UPDATA_SENDPARTNER_SUCESS_DATA,t)},send23909:function(t,e,i,s){var n={};n.id=i,n.rid=t,n.srv_id=e,n.flag=s,this.SendProtocal(23909,n)},handle23909:function(t){message(t.msg)},send23910:function(){this.SendProtocal(23910,{})},handle23910:function(t){if(cc.log("buff\u4fe1\u606f",t.end_time-gcore.SmartSocket.getTime()),t){var e=!1;s.getInstance().checkIsInEndlessUIFight()&&(this.openEndlessBuffView(!0,t),e=!0),e||(this.cache_buff_data=t)}},send23911:function(t){var e={};e.buff_id=t,this.SendProtocal(23911,e)},handle23911:function(e){if(message(e.msg),this.cache_buff_data=null,1==e.code){this.openEndlessBuffView(!1);var i=t("prompt_controller"),s=t("prompt_type_const");i.getInstance().getModel().removePromptDataByTpye(s.Endless_trail)}},openEndlessMainWindow:function(t){if(1==t){if(0==this.checkIsOpen(!0))return;this.endless_main_window||(this.endless_main_window=Utils.createClass("endless_trail_main_window",this)),this.model.getFirstKindList(),this.model.getFiveKindList(),this.model.getRankKindList(),this.endless_main_window&&0==this.endless_main_window.isOpen()&&this.endless_main_window.open()}else this.endless_main_window&&(this.endless_main_window.close(),this.endless_main_window=null)},openEndlessBattleView:function(t){1==t?(this.endless_battle_view||(this.endless_battle_view=Utils.createClass("endless_trail_battle_window",this)),this.endless_battle_view&&0==this.endless_battle_view.isOpen()&&(this.endless_battle_view&&0==this.endless_battle_view.isOpen()&&this.endless_battle_view.open(),this.cache_buff_data&&(this.openEndlessBuffView(!0,this.cache_buff_data),this.cache_buff_data=null))):this.endless_battle_view&&(this.endless_battle_view.close(),this.endless_battle_view=null)},openEndlessBuffView:function(t,e,i){if(1==t){if(this.endless_buff_window||(this.endless_buff_window=Utils.createClass("endless_trail_buff_window",this)),null==(e=e||this.cache_buff_data))return;this.endless_buff_window&&0==this.endless_buff_window.isOpen()&&this.endless_buff_window.open(e),this.cache_buff_data=null}else this.endless_buff_window&&(i&&(this.cache_buff_data=this.endless_buff_window.getData()),this.endless_buff_window.close(),this.endless_buff_window=null)},openEndlessRankView:function(t){1==t?(this.endless_rank_window||(this.endless_rank_window=Utils.createClass("endless_rank_window",this)),this.endless_rank_window&&0==this.endless_rank_window.isOpen()&&this.endless_rank_window.open()):this.endless_rank_window&&(this.endless_rank_window.close(),this.endless_rank_window=null)},openEndlessFriendHelpView:function(t){1==t?(this.endless_friendhelp_window||(this.endless_friendhelp_window=Utils.createClass("endless_friend_help_window",this)),this.endless_friendhelp_window&&0==this.endless_friendhelp_window.isOpen()&&this.endless_friendhelp_window.open()):this.endless_friendhelp_window&&(this.endless_friendhelp_window.close(),this.endless_friendhelp_window=null)},openEndlessRewardWindow:function(t){1==t?(this.endless_reward_window||(this.endless_reward_window=Utils.createClass("endless_reward_window",this)),this.endless_reward_window&&0==this.endless_reward_window.isOpen()&&this.endless_reward_window.open()):this.endless_reward_window&&(this.endless_reward_window.close(),this.endless_reward_window=null)},openEndlessRewardTips:function(t,e){1==t?(this.endless_reward_tips||(this.endless_reward_tips=Utils.createClass("endlesstrail_awards_tips_window",this)),this.endless_reward_tips&&0==this.endless_reward_tips.isOpen()&&this.endless_reward_tips.open(e)):this.endless_reward_tips&&(this.endless_reward_tips.close(),this.endless_reward_tips=null)},__delete:function(){null!=this.model&&(this.model.DeleteMe(),this.model=null)}});e.exports=l,cc._RF.pop()},{battle_const:"battle_const",endless_trail_event:"endless_trail_event",endless_trail_model:"endless_trail_model",login_event:"login_event",mainscene_event:"mainscene_event",mainui_controller:"mainui_controller",prompt_controller:"prompt_controller",prompt_type_const:"prompt_type_const",role_controller:"role_controller",role_event:"role_event"}],endless_trail_event:[function(t,e,i){"use strict";cc._RF.push(e,"352feqa8JBL84NjwRs2C4iD","endless_trail_event"),e.exports={UPDATA_BASE_DATA:"UPDATA_BASE_DATA",UPDATA_FIRST_DATA:"UPDATA_FIRST_DATA",UPDATA_SENDPARTNER_DATA:"UPDATA_SENDPARTNER_DATA",UPDATA_HIREPARNER_DATA:"UPDATA_HIREPARNER_DATA",UPDATA_HASHIREPARNER_DATA:"UPDATA_HASHIREPARNER_DATA",UPDATA_REDPOINT_FIRST_DATA:"UPDATA_REDPOINT_FIRST_DATA",UPDATA_REDPOINT_REWARD_DATA:"UPDATA_REDPOINT_REWARD_DATA",UPDATA_REDPOINT_SENDPARTNER_DATA:"UPDATA_REDPOINT_SENDPARTNER_DATA",UPDATA_ENDLESSBATTLE_DATA:"UPDATA_ENDLESSBATTLE_DATA",UPDATA_BUFF_DATA:"UPDATA_BUFF_DATA",UPDATA_SENDPARTNER_SUCESS_DATA:"UPDATA_SENDPARTNER_SUCESS_DATA",UPDATA_ESECSICE_ENDLESS_REDPOINT:"UPDATA_ESECSICE_ENDLESS_REDPOINT",type:{rank:1,reward:2},helptype:{friend:1,me:2}},cc._RF.pop()},{}],endless_trail_main_window:[function(t,e,i){"use strict";cc._RF.push(e,"f4a95Msbo5DzIi6Az5LohiF","endless_trail_main_window");var s=t("pathtool"),n=t("playerhead"),a=t("common_scrollview"),o=t("mainui_controller"),l=t("hero_controller"),r=t("partner_const"),c=t("commonalert"),_=t("endless_trail_event");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("endlesstrail","endlesstrail_window"),this.viewTag=SCENE_TAG.ui,this.win_type=WinType.Full,this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){this.ack_status=0,this.rank_list={}},openCallBack:function(){this.background=this.seekChild(this.root_wnd,"bigbackground"),this.background.scale=FIT_SCALE,this.bigbackground=this.seekChild(this.root_wnd,"bigbackground",cc.Sprite),this.loadRes(s.getBigBg("bigbg_2","jpg"),function(t){this.bigbackground.spriteFrame=t}.bind(this)),this.title_label=this.root_wnd.getChildByName("title_label").getComponent(cc.Label),this.title_label.string=Utils.TI18N("\u65e0\u5c3d\u8bd5\u70bc"),this.main_panel=this.root_wnd.getChildByName("main_panel"),this.bg_node=this.main_panel.getChildByName("bg"),this.bg_node.scale=2,this.bg=this.bg_node.getComponent(cc.Sprite),this.loadRes(s.getBigBg("bigbg_51"),function(t){this.bg.spriteFrame=t}.bind(this)),this.friend_btn=this.main_panel.getChildByName("friend_btn"),this.firend_red_point=this.friend_btn.getChildByName("red_point"),this.firend_red_point.active=!1,this.friend_btn.getChildByName("label").getComponent(cc.Label).string=Utils.TI18N("\u597d\u53cb\u52a9\u9635"),this.ack_btn=this.main_panel.getChildByName("ack_btn"),this.ack_btn_label=this.ack_btn.getChildByName("label").getComponent(cc.Label),this.ack_btn_label.string=Utils.TI18N("\u5f00\u59cb\u6311\u6218"),this.ack_btn_red_point=this.ack_btn.getChildByName("red_point"),this.tips_button=this.main_panel.getChildByName("tips_button"),this.rank_container=this.main_panel.getChildByName("rank_container"),this.rank_container.getChildByName("rank_desc_label").getComponent(cc.Label).string=Utils.TI18N("\u95ef\u5173\u6392\u884c\u699c"),this.rank_info_btn=this.rank_container.getChildByName("rank_info_btn"),this.first_container=this.main_panel.getChildByName("first_container"),this.get_btn=this.first_container.getChildByName("get_btn"),this.get_btn.getChildByName("label").getComponent(cc.Label).string=Utils.TI18N("\u9886\u53d6"),this.first_label=Utils.createRichLabel(24,new cc.Color(255,255,255,255),cc.v2(0,1),cc.v2(0,this.first_container.height),30,1e3),this.first_label.horizontalAlign=cc.macro.TextAlignment.LEFT,this.first_container.addChild(this.first_label.node),this.limit_label=Utils.createRichLabel(22,new cc.Color(255,255,255,255),cc.v2(1,.5),cc.v2(this.first_container.width,this.first_container.height/2),30,1e3),this.limit_label.node.active=!1,this.limit_label.horizontalAlign=cc.macro.TextAlignment.RIGHT,this.first_container.addChild(this.limit_label.node),this.sum_reward_container=this.main_panel.getChildByName("sum_reward_container"),this.info_btn=this.sum_reward_container.getChildByName("info_btn"),this.sum_reward_container.getChildByName("reward_desc_label").getComponent(cc.Label).string=Utils.TI18N("\u73a9\u6cd5\n\u5956\u52b1"),this.rank_reward_container=this.main_panel.getChildByName("rank_reward_container"),this.rank_reward_container.getChildByName("label").getComponent(cc.Label).string=Utils.TI18N("\u6392\u540d\u5956\u52b1"),this.rank_reward_container.getChildByName("my_title").getComponent(cc.Label).string=Utils.TI18N("\u6211\u7684\u6392\u540d:"),this.my_rank_value=this.rank_reward_container.getChildByName("my_rank").getComponent(cc.Label),this.rank_notice=this.rank_reward_container.getChildByName("rank_notice").getComponent(cc.Label),this.rank_notice.string=Utils.TI18N("\u6682\u65e0\u6392\u884c\u5956\u52b1"),this.my_round_container=this.main_panel.getChildByName("my_round_container"),this.my_round_container.getChildByName("round_desc_label").getComponent(cc.Label).string=Utils.TI18N("\u4e2a\u4eba\u8bb0\u5f55"),this.close_btn=this.main_panel.getChildByName("close_btn"),this.floor_round=this.my_round_container.getChildByName("floor_round").getComponent("CusRichText"),this.friend_container=this.main_panel.getChildByName("friend_container"),this.friend_container.getChildByName("label_1").getComponent(cc.Label).string=Utils.TI18N("\u5df2\u9009\u62e9:"),this.friend_power=this.friend_container.getChildByName("power").getComponent(cc.Label),this.friend_head=new n,this.friend_head.setScale(.5),this.friend_head.setPosition(-30,0),this.friend_head.setParent(this.friend_container),this.friend_head.show(),this.friend_label=Utils.createRichLabel(24,new cc.Color(104,69,42,255),cc.v2(.5,.5),cc.v2(134,27),30),this.main_panel.addChild(this.friend_label.node),this.from_label=Utils.createRichLabel(24,new cc.Color(104,69,42,255),cc.v2(.5,.5),cc.v2(494,140),30),this.main_panel.addChild(this.from_label.node),this.has_label=Utils.createRichLabel(24,new cc.Color(104,69,42,255),cc.v2(.5,.5),cc.v2(494,27),30),this.main_panel.addChild(this.has_label.node),this.can_reward_label=this.main_panel.getChildByName("can_reward_label").getComponent(cc.Label),this.can_reward_label.string=Utils.TI18N("\uff08\u5df2\u83b7\u6240\u6709\u65e5\u5e38\u7ed3\u7b97\u5956\u52b1\uff09")},registerEvent:function(){Utils.onTouchEnd(this.close_btn,function(){this.ctrl.openEndlessMainWindow(!1)}.bind(this),2),Utils.onTouchEnd(this.get_btn,function(){this.first_data&&this.ctrl.send23904(this.first_data.id)}.bind(this),1),Utils.onTouchEnd(this.info_btn,function(){this.ctrl.openEndlessRewardWindow(!0)}.bind(this),1),Utils.onTouchEnd(this.rank_info_btn,function(){this.ctrl.openEndlessRankView(!0,_.type.rank)}.bind(this),1),Utils.onTouchEnd(this.tips_button,function(){Config.endless_data.data_explain&&o.getInstance().openCommonExplainView(!0,Config.endless_data.data_explain,Utils.TI18N("\u73a9\u6cd5\u89c4\u5219"))}.bind(this),1),Utils.onTouchEnd(this.ack_btn,function(){var t=(this.model.getHasHirePartnerData()||{}).list||{};2==this.ack_status?c.show(Utils.TI18N("\u672c\u65e5\u5df2\u4e0d\u53ef\u83b7\u5f97\u901a\u5173\u7d2f\u8ba1\u5956\u52b1\uff0c\u4f46\u4f9d\u7136\u53ef\u4ee5\u7ee7\u7eed\u6311\u6218<color=#289b14>\u9996\u901a\u5956\u52b1</color>\u548c<color=#289b14>\u6392\u884c\u699c\u6392\u540d</color>\uff0c\u662f\u5426\u786e\u8ba4\u7ee7\u7eed\u6311\u6218\uff1f"),Utils.TI18N("\u786e\u5b9a"),function(){l.getInstance().openFormGoFightPanel(!0,r.Fun_Form.EndLess,{has_hire_list:t})},Utils.TI18N("\u53d6\u6d88"),null):l.getInstance().openFormGoFightPanel(!0,r.Fun_Form.EndLess,{has_hire_list:t})}.bind(this),1),Utils.onTouchEnd(this.friend_btn,function(){Config.endless_data.data_explain&&this.ctrl.openEndlessFriendHelpView(!0)}.bind(this),1),this.addGlobalEvent(_.UPDATA_BASE_DATA,function(t){t&&this.updateBaseInfo(t)}.bind(this)),this.addGlobalEvent(_.UPDATA_FIRST_DATA,function(t){t&&this.updateFirstItem(t)}.bind(this)),this.addGlobalEvent(_.UPDATA_REDPOINT_SENDPARTNER_DATA,function(t){this.firend_red_point&&(this.firend_red_point.active=t)}.bind(this)),this.addGlobalEvent(_.UPDATA_REDPOINT_FIRST_DATA,function(t){this.get_btn&&Utils.addRedPointToNodeByStatus(this.get_btn,t,5,5)}.bind(this)),this.addGlobalEvent(_.UPDATA_REDPOINT_REWARD_DATA,function(t){this.ack_btn_red_point&&(null==t&&(t=!1),this.ack_btn_red_point.active=t)}.bind(this))},openRootWnd:function(t){this.ctrl.send23900(),this.ctrl.send23903()},updateBaseInfo:function(t){if(this.base_data=t,this.base_data){if(this.floor_round.setNum(t.max_round),this.from_label.string=cc.js.formatStr(Utils.TI18N("\u4ece%s\u5173\u5f00\u59cb"),t.current_round),this.has_label.string=cc.js.formatStr(Utils.TI18N("\u4eca\u5929\u5df2\u901a\u5173%s\u5173"),t.day_pass_round),0==t.day_pass_round?this.ack_btn_label.string=Utils.TI18N("\u5f00\u59cb\u6311\u6218"):this.ack_btn_label.string=Utils.TI18N("\u91cd\u65b0\u5f00\u59cb"),0!=t.day_pass_round&&1==t.is_reward?this.ack_status=2:this.ack_status=1,0==t.is_employ&&null==Utils.next(t.list||{}))this.friend_label.string=Utils.TI18N("\u9009\u62e9\u4e00\u4f4d\u597d\u53cb\u7684\u82f1\u96c4\u5e2e\u52a9"),this.friend_container.active=!1;else if(t.list&&t.list[0]){var e=t.list[0];this.friend_label.string="",this.friend_container.active=!0,this.friend_head.setHeadRes(e.bid),this.friend_power.string=e.power}1==t.is_reward?(this.can_reward_label.node.active=!0,this.has_label.node.y=42):(this.can_reward_label.node.active=!1,this.has_label.node.y=27),this.updateRankData(),this.updateSumItem(),this.updateRankItem()}},updateFirstItem:function(t){if(t&&Config.endless_data.data_first_data&&this.base_data){this.first_data=t;var e=Config.endless_data.data_first_data[this.first_data.id];if(0==this.first_data.id){var i=Utils.TI18N("\u3010\u5df2\u9886\u5b8c\u6240\u6709\u9996\u901a\u5956\u52b1\uff01\u30fe(*\u30fb\u03c9\u30fb)\u30ce\u309c\u3011");this.limit_label.string=i,this.limit_label.node.active=!0,this.item_scrollview&&(this.item_scrollview.active=!1),this.get_btn.active=!1}else if(e){if(!this.item_scrollview){this.item_scrollview=new a,this.item_scrollview.createScroll(this.first_container,cc.v2(0,0),ScrollViewDir.horizontal,ScrollViewStartPos.bottom,cc.size(300,85),{item_class:"backpack_item",start_x:0,space_x:2,start_y:-17,space_y:0,item_width:119,item_height:119,row:1,col:0})}i=cc.js.formatStr(Utils.TI18N("<color=#ffffff fontsize=22><outline color=#c45a14 width=1>\u9996\u901a\u5956\u52b1(\u7b2c%s\u5173)</outline></color>"),e.limit_id);this.first_label.string=i,1==this.first_data.status?(this.get_btn.active=!0,this.limit_label.node.active=!1):(i=cc.js.formatStr(Utils.TI18N("<color=#249003>%s</color>\u5173\u540e\u53ef\u9886"),e.limit_id-this.base_data.max_round),this.limit_label.string=i,this.limit_label.node.active=!0,this.get_btn.active=!1);var s=[];for(var n in e.items)s.push({bid:e.items[n][0],num:e.items[n][1]});this.item_scrollview.setData(s,null,{is_show_tips:!0,scale:.7}),this.item_scrollview.setRootVisible(!0)}}},updateSumItem:function(){if(Config.endless_data.data_const){var t=Config.endless_data.data_const.reward_show.val||{};if(!this.sum_item_scrollview){this.sum_item_scrollview=new a,this.sum_item_scrollview.createScroll(this.sum_reward_container,cc.v2(70,26),ScrollViewDir.horizontal,ScrollViewStartPos.bottom,cc.size(400,85),{item_class:"backpack_item",start_x:0,space_x:-24,start_y:-17,space_y:0,item_width:119,item_height:119,row:1,col:0})}var e=[];for(var i in t){var s=Utils.deepCopy(Utils.getItemConfig(t[i]));e.push(s)}this.sum_item_scrollview.setData(e,null,{is_show_tips:!0,scale:.7})}},updateRankItem:function(){if(null!=this.base_data&&null!=this.base_data.my_idx){var t=null;for(var e in Config.endless_data.data_rank_reward_data){var i=Config.endless_data.data_rank_reward_data[e];if(this.base_data.my_idx>=i.min&&this.base_data.my_idx<=i.max){t=i;break}}if(null==t)this.rank_notice.node.active=!0,this.rank_item_scrollview&&this.rank_item_scrollview.setRootVisible(!1),this.my_rank_value.string=Utils.TI18N("\u6682\u672a\u4e0a\u699c");else{this.rank_notice.node.active=!1,this.my_rank_value.string=this.base_data.my_idx;var s=[];for(var n in t.items)s.push({bid:t.items[n][0],num:t.items[n][1]});if(!this.rank_item_scrollview){this.rank_item_scrollview=new a,this.rank_item_scrollview.createScroll(this.rank_reward_container,cc.v2(10,40),ScrollViewDir.horizontal,ScrollViewStartPos.bottom,cc.size(270,70),{item_class:"backpack_item",start_x:-16,space_x:-40,start_y:-22,space_y:0,item_width:119,item_height:119,row:1,col:0})}this.rank_item_scrollview.setData(s,null,{is_show_tips:!0,scale:.55}),this.rank_item_scrollview.setRootVisible(!0)}}},updateRankData:function(){var t=this.model.getRaknRoleTopThreeList();if(t&&null!=Utils.next(t||{}))for(var e in t){if(!this.rank_list[e]){var i=this.createSingleRankItem(e,t[e]);this.rank_container.addChild(i),this.rank_list[e]=i}(i=this.rank_list[e])&&(i.setPosition(10,136-parseInt(e)*i.getContentSize().height),i.label.string=t[e].name,i.value.string=(t[e].val||0)+Utils.TI18N("\u5173"))}},createSingleRankItem:function(t,e){var i=new cc.Node;i.setAnchorPoint(0,1),i.setContentSize(180,50);var n=Utils.createImage(i,null,30,20,cc.v2(.5,0)),a=s.getCommonIcomPath("common_300"+(parseInt(t)+1));this.loadRes(a,function(t){n.spriteFrame=t}.bind(this)),n.node.scale=.7;var o=Utils.createLabel(20,new cc.Color(255,255,255,255),null,70,20,"",i,0,cc.v2(0,0)),l=Utils.createLabel(20,new cc.Color(255,155,30,255),null,208,20,"",i,0,cc.v2(0,0));return i.label=o,i.value=l,i},closeCallBack:function(){this.item_scrollview&&(this.item_scrollview.deleteMe(),this.item_scrollview=null),this.sum_item_scrollview&&(this.sum_item_scrollview.deleteMe(),this.sum_item_scrollview=null),this.rank_item_scrollview&&(this.rank_item_scrollview.deleteMe(),this.rank_item_scrollview=null),this.friend_head&&this.friend_head.deleteMe(),this.friend_head=null,this.ctrl.openEndlessMainWindow(!1)}});cc._RF.pop()},{common_scrollview:"common_scrollview",commonalert:"commonalert",endless_trail_event:"endless_trail_event",hero_controller:"hero_controller",mainui_controller:"mainui_controller",partner_const:"partner_const",pathtool:"pathtool",playerhead:"playerhead"}],endless_trail_model:[function(t,e,i){"use strict";cc._RF.push(e,"0943dp4vehAXarkETkg9uwC","endless_trail_model");var s=t("endless_trail_event"),n=t("mainui_controller"),a=t("mainui_const");cc.Class({extends:BaseClass,ctor:function(){},properties:{},initConfig:function(){this.role_rank_list={},this.first_item_list=[],this.five_item_list=[],this.rank_item_list=[],this.endless_data={},this.first_data={},this.send_partner={},this.hire_partner_list={},this.has_hire_partner_list={},this.is_first_get=!1,this.is_award_get=!1,this.is_send_partner=!1,this.endless_battle_data=null},setEndlessData:function(t){t&&(this.endless_data=t,this.updateRedPoint(),gcore.GlobalEvent.fire(s.UPDATA_BASE_DATA,t))},getEndlessData:function(){if(this.endless_data&&null!=Utils.next(this.endless_data||{}))return this.endless_data},setFirstData:function(t){t&&(this.first_data=t,this.updateRedPoint(),gcore.GlobalEvent.fire(s.UPDATA_FIRST_DATA,t))},getFirstData:function(){if(this.first_data&&null!=Utils.next(this.first_data||{}))return this.first_data},setSendPartnerData:function(t){this.send_partner=t,gcore.GlobalEvent.fire(s.UPDATA_SENDPARTNER_DATA,t),this.updateRedPoint()},getSendPartnerData:function(){if(this.send_partner&&null!=Utils.next(this.send_partner||{}))return this.send_partner},setHirePartnerData:function(t){this.hire_partner_list=t,gcore.GlobalEvent.fire(s.UPDATA_HIREPARNER_DATA,t)},getHirePartnerData:function(){if(this.hire_partner_list&&null!=Utils.next(this.hire_partner_list||{}))return this.hire_partner_list},setHasHirePartnerData:function(t){this.has_hire_partner_list=t,gcore.GlobalEvent.fire(s.UPDATA_HASHIREPARNER_DATA,t)},getHasHirePartnerData:function(){if(this.has_hire_partner_list&&null!=Utils.next(this.has_hire_partner_list||{}))return this.has_hire_partner_list},setEndlessBattleData:function(t){this.endless_battle_data=t,gcore.GlobalEvent.fire(s.UPDATA_ENDLESSBATTLE_DATA,t)},getEndlessBattleData:function(){if(this.endless_battle_data)return this.endless_battle_data},getRaknRoleTopThreeList:function(){var t=[{rank:1,name:Utils.TI18N("\u865a\u4f4d\u4ee5\u5f85")},{rank:2,name:Utils.TI18N("\u865a\u4f4d\u4ee5\u5f85")},{rank:3,name:Utils.TI18N("\u865a\u4f4d\u4ee5\u5f85")}];if(this.endless_data.rank_list&&null!=Utils.next(this.endless_data.rank_list||{})){var e=this.endless_data.rank_list;for(var i in e)for(var s in t)e[i].idx==t[s].rank&&(t[s]=e[i])}return t},getFirstKindList:function(){if(null==Utils.next(this.first_item_list||[])&&Config.endless_data.data_first_data){for(var t in Config.endless_data.data_first_data){var e=Config.endless_data.data_first_data[t].items;for(var i in e){var s=e[i][0];this.is_include(s,this.first_item_list)||this.first_item_list.push({bid:s,num:1})}}}},getFirstList:function(){if(this.first_item_list)return this.first_item_list},getFiveKindList:function(){if(null==Utils.next(this.five_item_list||[])&&Config.endless_data.data_floor_data){for(var t in Config.endless_data.data_floor_data){var e=Config.endless_data.data_floor_data[t].items;for(var i in e){var s=e[i][0];this.is_include(s,this.five_item_list)||this.five_item_list.push({bid:s,num:1})}}}},getFiveList:function(){if(this.five_item_list)return this.five_item_list},getRankKindList:function(){if(null==Utils.next(this.rank_item_list||[])&&Config.endless_data.data_rank_reward_data){for(var t in Config.endless_data.data_rank_reward_data){var e=Config.endless_data.data_rank_reward_data[t].items;for(var i in e){var s=e[i][0];this.is_include(s,this.rank_item_list)||this.rank_item_list.push({bid:s,num:1})}}}},updateRedPoint:function(){RedMgr.getInstance().addCalHandler(this.checkRedPoint.bind(this),RedIds.Endless)},checkRedPoint:function(){if(null!=n.getInstance().checkMainFunctionOpenStatus(a.btn_index.esecsice,a.function_type.main,!0)){this.first_data&&(1==this.first_data.status?this.is_first_get=!0:this.is_first_get=!1,gcore.GlobalEvent.fire(s.UPDATA_REDPOINT_FIRST_DATA,this.is_first_get)),this.endless_data&&(1!=this.endless_data.is_reward?this.is_award_get=!0:this.is_award_get=!1,gcore.GlobalEvent.fire(s.UPDATA_REDPOINT_REWARD_DATA,this.is_award_get)),this.endless_data&&(0==this.endless_data.is_appoint&&this.send_partner&&null==Utils.next(this.send_partner.list||{})?this.is_send_partner=!0:this.is_send_partner=!1);var e=this.is_first_get||this.is_award_get||this.is_send_partner;gcore.GlobalEvent.fire(s.UPDATA_REDPOINT_SENDPARTNER_DATA,this.is_send_partner),gcore.GlobalEvent.fire(s.UPDATA_ESECSICE_ENDLESS_REDPOINT);var i=t("scene_const");n.getInstance().setBtnRedPoint(a.btn_index.esecsice,{bid:i.RedPointType.endless,status:e})}},getFirstGet:function(){return this.is_first_get},getIsSendPartner:function(){return this.is_send_partner},getIsGetAllReward:function(){return this.is_award_get},checkRedStatus:function(){return this.is_first_get||this.is_send_partner||this.is_award_get},getRankList:function(){if(this.rank_item_list)return this.rank_item_list},is_include:function(t,e){for(var i in e)if(e[i].bid==t)return!0;return!1}});cc._RF.pop()},{endless_trail_event:"endless_trail_event",mainui_const:"mainui_const",mainui_controller:"mainui_controller",scene_const:"scene_const"}],endlesstrail_awards_tips_window:[function(t,e,i){"use strict";cc._RF.push(e,"6742dTeGy5Gf4cqukwQzfFf","endlesstrail_awards_tips_window");var s=t("pathtool");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("endlesstrail","endlesstrail_awards_tips"),this.viewTag=SCENE_TAG.ui,this.win_type=WinType.Tips,this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){this.item_list=[]},openCallBack:function(){this.background=this.root_wnd.getChildByName("background"),this.background.scale=FIT_SCALE,this.main_panel=this.root_wnd.getChildByName("main_panel"),this.main_container=this.main_panel.getChildByName("main_container"),this.desc_label=this.main_panel.getChildByName("desc_label").getComponent(cc.Label),this.close_btn=this.main_panel.getChildByName("close_btn"),this.ok_btn=this.main_panel.getChildByName("ok_btn"),this.ok_btn.btn=this.main_panel.getChildByName("ok_btn").getComponent(cc.Button),this.ok_btn.label=this.ok_btn.getChildByName("label").getComponent(cc.Label),this.ok_btn.label.string=Utils.TI18N("\u9886\u53d6"),this.ok_btn.line=this.ok_btn.getChildByName("label").getComponent(cc.LabelOutline),this.title_container=this.main_panel.getChildByName("title_container"),this.title_label=this.title_container.getChildByName("title_label").getComponent(cc.Label),this.title_label.string=Utils.TI18N("\u5956\u52b1")},registerEvent:function(){Utils.onTouchEnd(this.background,function(){this.ctrl.openEndlessRewardTips(!1)}.bind(this),2),Utils.onTouchEnd(this.close_btn,function(){this.ctrl.openEndlessRewardTips(!1)}.bind(this),2),Utils.onTouchEnd(this.ok_btn,function(){this.data&&this.ctrl.send23904(this.data.id)}.bind(this),1)},openRootWnd:function(t){if(this.data=t,t&&Config.endless_data.data_first_data&&Config.endless_data.data_first_data[this.data.id]){var e=Config.endless_data.data_first_data[this.data.id];this.updateItemData(e)}},updateItemData:function(t){if(t){var e=cc.js.formatStr(Utils.TI18N("\u7b2c%s\u5173\u9996\u901a\u5956\u52b1"),t.limit_id);this.desc_label.string=e;var i=t.items.length;this.space=30;var s=120*i+(i-1)*this.space;for(var n in this.start_x=.5*(this.main_container.getContentSize().width-s),t.items)if(!this.item_list[n]){var a=ItemsPool.getInstance().getItem("backpack_item");a.setParent(this.main_container),a.initConfig(!0),a.setData({bid:t.items[n][0],num:t.items[n][1]});var o=this.start_x+60+parseInt(n)*(120+this.space);a.setPosition(o,this.main_container.getContentSize().height/2),a.show(),a.setDefaultTip(),this.item_list[n]=a}}this.data&&(1==this.data.status?this.ok_btn.label&&(this.ok_btn.btn&&(this.ok_btn.btn.interactable=!0,this.ok_btn.btn.enableAutoGrayEffect=!1),this.ok_btn.line.enabled=!0,this.ok_btn.label.string=Utils.TI18N("\u9886\u53d6")):this.ok_btn.label&&(this.ok_btn.btn&&(this.ok_btn.btn.interactable=!1,this.ok_btn.btn.enableAutoGrayEffect=!0),this.ok_btn.line.enabled=!1,this.ok_btn.label.string=Utils.TI18N("\u4e0d\u53ef\u9886\u53d6")))},closeCallBack:function(){for(var t in this.item_list)this.item_list[t].deleteMe();this.item_list=[],this.ctrl.openEndlessRewardTips(!1)}});cc._RF.pop()},{pathtool:"pathtool"}],enter_panel:[function(t,e,i){"use strict";cc._RF.push(e,"c66eczs8r5P96fOzGCMI9xt","enter_panel");var s=t("pathtool"),n=t("login_controller"),a=t("login_event"),o=t("loadermanager");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("login","enter_panel"),this.model=n.getInstance().getModel(),this.ctrl=n.getInstance()},initPanel:function(){var t=this.root_wnd.getChildByName("container");this.btn_enter=t.getChildByName("btn_enter"),this.btn_notice=this.seekChild("btn_notice"),this.logo=t.getChildByName("logo"),this.btn_login_server=t.getChildByName("btn_login_server"),this.btn_user_center=this.seekChild("btn_user_center"),this.txt_cur_server=this.btn_login_server.getChildByName("txt_cur_server").getComponent(cc.Label),this.icon_state_sp=this.btn_login_server.getChildByName("icon_state").getComponent(cc.Sprite),this.stateIcon_nd=this.btn_login_server.getChildByName("stateIcon"),this.usert_account_eb=this.seekChild("usert_account",cc.EditBox),"WX_SDK"==PLATFORM_TYPR?this.usert_account_eb.node.active=!0:this.usert_account_eb.node.active=!1,n.getInstance().getModel().getLoginInfo().srv_name&&this.setMainInfo(),"SH_RH"==PLATFORM_TYPR&&(this.btn_user_center.active=!1,this.btn_notice.y=1220)},registerEvent:function(){var e=this;this.btn_login_server.on("touchend",function(){e.model.getServerList().length<=0?message("\u670d\u52a1\u5668\u5217\u8868\u6b63\u5728\u52a0\u8f7d\u4e2d..."):(this.ctrl.openServerList(!0,e.model.getServerList(),function(){e.btn_enter.active=!0,e.btn_login_server.active=!0}),this.btn_enter.active=!1,this.btn_login_server.active=!1)},this),this.btn_enter.on(cc.Node.EventType.TOUCH_END,function(t){if(null!=this.downtime&&1==this.downtime)return message(Utils.TI18N("\u505c\u670d\u7ef4\u62a4\u4e2d")),void this.ctrl.getModel().checkReloadServerData();1==USE_SDK&&"SH_SDK"==PLATFORM_TYPR&&SDK.dataPlacement(8e4),Utils.playButtonSound(1),n.getInstance().getModel().setIsSocket(!1),(IS_SUBMIT||"SH_RH"==PLATFORM_TYPR)&&SDK.sdkSubmitUserData(1),n.getInstance().connectServer(),1==IS_RESET&&(IS_RESET=!1,n.getInstance().openLoginWindow(!1))},this),this.btn_notice.on(cc.Node.EventType.TOUCH_END,function(e){t("notice_controller").getInstance().openNocticeWindow(!0)},this),gcore.GlobalEvent.bind(a.LOGIN_EVENT_CUR_SERVER_UPDATE,function(){this.setMainInfo()}.bind(this))},onShow:function(){1==USE_SDK&&"SH_SDK"==PLATFORM_TYPR&&SDK.dataPlacement(75e3)},onHide:function(){},setMainInfo:function(){var t,e=n.getInstance().getModel().getLoginInfo();this.txt_cur_server.string=e.srv_name,this.stateIcon_nd.active=!0,this.downtime=!1,e.is_close?(this.downtime=!0,t=s.getUIIconPath("login2","login2_1002")):e.is_new?t=s.getUIIconPath("login2","login2_1000"):(t=s.getUIIconPath("login2","login2_1001"),this.stateIcon_nd.active=!1),this.loadRes(t,function(t){this.icon_state_sp.spriteFrame=t}.bind(this))},onDelete:function(){o.getInstance().deleteRes("res/login/app/txt_cn_logo")},getTestAccount:function(){if(this.usert_account_eb)return this.usert_account_eb.string}});cc._RF.pop()},{loadermanager:"loadermanager",login_controller:"login_controller",login_event:"login_event",notice_controller:"notice_controller",pathtool:"pathtool"}],equip_cloth_item:[function(t,e,i){"use strict";cc._RF.push(e,"e7868ORLHxHcJBUuji6H9EI","equip_cloth_item");var s=t("pathtool");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("hero","equip_cloth_item")},initConfig:function(){this.icon_list={atk:21,hp_max:22,def:23,speed:37,atk_per:21},this.attr_data_key=Config.attr_data.data_id_to_key,this.attr_data_name=Config.attr_data.data_id_to_name},initPanel:function(){this.item_con_nd=this.seekChild("item_con"),this.equip_btn_nd=this.seekChild("equip_btn"),this.equip_name_lb=this.seekChild("equip_name",cc.Label),this.equip_lev_lb=this.seekChild("equip_lev",cc.Label),this.equip_score_lb=this.seekChild("equip_score",cc.Label),this.attr_icon_sp=this.seekChild("attr_icon",cc.Sprite),this.attr_name_lb=this.seekChild("attr_name",cc.Label),this.attr_val_lb=this.seekChild("attr_val",cc.Label),this.backpack_item=ItemsPool.getInstance().getItem("backpack_item"),this.backpack_item.setParent(this.item_con_nd),this.backpack_item.setExtendData({effect:!1,scale:.9}),this.backpack_item.show(),this.equip_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickEquipBtn,this)},registerEvent:function(){},onShow:function(t){this.updateWidgets()},onHide:function(){},onDelete:function(){this.backpack_item&&(this.backpack_item.deleteMe(),this.backpack_item=null)},setData:function(t){this.equip_data=t,this.root_wnd&&this.updateWidgets()},updateWidgets:function(){this.equip_name_lb.string=this.equip_data.config.name,this.equip_lev_lb.string=this.equip_data.lev,this.equip_score_lb.string=this.equip_data.score;var t=this.equip_data.main_attr[0];if(t){var e=this.attr_data_key[t.attr_id],i=this.icon_list[e],n=s.getUIIconPath("common","common_900"+i);this.loadRes(n,function(t){this.attr_icon_sp.spriteFrame=t}.bind(this));var a=this.attr_data_name[t.attr_id];this.attr_name_lb.string=a+"\uff1a",this.attr_val_lb.string=t.attr_val}this.backpack_item.setData(this.equip_data)},addCallBack:function(t){this.select_cb=t},onClickEquipBtn:function(){this.select_cb&&this.select_cb(this.equip_data)}});cc._RF.pop()},{pathtool:"pathtool"}],equip_cloth_window:[function(t,e,i){"use strict";cc._RF.push(e,"256db95kRdLz64F9e8mhsqK","equip_cloth_window");var s=t("pathtool"),n=t("equip_cloth_item"),a=t("backpack_controller"),o=t("backpack_const"),l=t("common_scrollview"),r=690,c=550;cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("hero","equip_cloth_window"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Full,this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){},openCallBack:function(){this.mask_nd=this.seekChild("mask"),this.close_btn_nd=this.seekChild("close_btn"),this.list_view_nd=this.seekChild("list_view"),this.empty_tips_nd=this.seekChild("empty_tips"),this.cur_equip_nd=this.seekChild("cur_equip"),this.item_con_nd=this.seekChild("item_con"),this.unequip_btn_nd=this.seekChild("unequip_btn"),this.equip_name_lb=this.seekChild("equip_name",cc.Label),this.equip_lev_lb=this.seekChild("equip_lev",cc.Label),this.equip_score_lb=this.seekChild("equip_score",cc.Label),this.backpack_item=ItemsPool.getInstance().getItem("backpack_item"),this.backpack_item.setParent(this.item_con_nd),this.backpack_item.setExtendData({effect:!1,scale:.9}),this.backpack_item.show(),this.mask_nd.on(cc.Node.EventType.TOUCH_END,this.onClickCloseBtn,this),this.close_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickCloseBtn,this),this.unequip_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickUnEquipBtn,this)},registerEvent:function(){},openRootWnd:function(t){t&&(this.equip_type=t.equip_type,this.partner_id=t.partner_id,t.data?(this.cur_equip_nd.active=!0,this.list_view_nd.height=c,this.cur_equip_data=t.data,this.updateCurEquip(t.data)):(this.cur_equip_nd.active=!1,this.list_view_nd.height=r),this.initRankList(),this.updateWidgets())},closeCallBack:function(){this.item_list&&this.item_list.deleteMe(),this.backpack_item&&this.backpack_item.deleteMe(),this.ctrl.openEquipPanel(!1)},updateWidgets:function(){this.updateItemList()},onClickCloseBtn:function(){this.ctrl.openEquipPanel(!1)},initRankList:function(){var t=this.list_view_nd.getContentSize(),e=cc.size(t.width,t.height),i={item_class:n,start_x:0,space_x:0,start_y:0,space_y:0,item_width:620,item_height:150,row:0,col:1,need_dynamic:!0};this.item_list=new l,this.item_list.createScroll(this.list_view_nd,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,e,i,cc.v2(.5,0))},updateItemList:function(){var t=[],e=a.getInstance().getModel().getBagItemList(o.Bag_Code.EQUIPS)||{};for(var i in e){var s=e[i];s&&s.config&&s.config.type==this.equip_type&&t.push(s)}t.length>0?(this.empty_tips_nd.active=!1,t.sort(Utils.tableUpperSorter(["all_score"]))):this.empty_tips_nd.active=!0,this.item_list.setData(t,this.selectItemEquip.bind(this))},selectItemEquip:function(t){t&&this.partner_id&&this.ctrl.sender11010(this.partner_id,t.id),this.ctrl.openEquipPanel(!1)},updateCurEquip:function(t){this.equip_name_lb.string=t.config.name,this.equip_lev_lb.string=t.lev,this.equip_score_lb.string=t.score,this.backpack_item.setData(t)},onClickUnEquipBtn:function(){this.partner_id&&this.cur_equip_data&&this.ctrl.sender11011(this.partner_id,this.cur_equip_data.id),this.ctrl.openEquipPanel(!1)}});cc._RF.pop()},{backpack_const:"backpack_const",backpack_controller:"backpack_controller",common_scrollview:"common_scrollview",equip_cloth_item:"equip_cloth_item",pathtool:"pathtool"}],equip_item:[function(t,e,i){"use strict";cc._RF.push(e,"935bdWv6P1MIJwGE5tsucn/","equip_item");var s=t("pathtool");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("chat","equip_item")},initConfig:function(){},initPanel:function(){this.backpack_item=ItemsPool.getInstance().getItem("backpack_item"),this.backpack_item.setParent(this.root_wnd),this.backpack_item.addCallBack(this.onClickItem.bind(this)),this.backpack_item.setExtendData({scale:.8}),this.backpack_item.show()},registerEvent:function(){},onShow:function(t){this.udpateWidgets()},onHide:function(){},onDelete:function(){this.backpack_item&&(this.backpack_item.deleteMe(),this.backpack_item=null)},setData:function(t){this.data=t,this.item_data=t.item_data,this.hero_info=t.hero_info,this.root_wnd&&this.udpateWidgets()},udpateWidgets:function(){this.item_data&&this.backpack_item.setData(this.item_data)},addCallBack:function(t){this.select_cb=t},onClickItem:function(t){t.data&&this.select_cb&&this.select_cb(this.data)}});cc._RF.pop()},{pathtool:"pathtool"}],equip_tips:[function(t,e,i){"use strict";cc._RF.push(e,"9705cDvcn9Nj5R7VTOXRjCi","equip_tips");var s=t("pathtool"),n=t("tips_const"),a=t("goods_vo"),o=t("backpack_const"),l=t("string_util"),r=t("hero_controller"),c=t("partner_const"),_=t("partner_calculate");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("tips","equip_tips"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Tips},initConfig:function(){this.tips_controller=t("tips_controller").getInstance(),this.btn_list={}},openCallBack:function(){this.background=this.seekChild("background"),this.container=this.seekChild("container"),this.container_init_height=this.container.height,this.close_btn=this.seekChild("close_btn"),this.base_panel=this.seekChild(this.container,"base_panel"),this.base_panel_sprite=this.base_panel.getComponent(cc.Sprite),this.goods_item=ItemsPool.getInstance().getItem("backpack_item"),this.goods_item.setParent(this.base_panel),this.goods_item.initConfig(!1,1,!1,!1),this.goods_item.setPosition(-134,-68),this.goods_item.show(),this.score_title=this.seekChild(this.base_panel,"score_title",cc.Label),this.score_title.string=Utils.TI18N("\u8bc4\u5206:"),this.power_label=this.seekChild(this.base_panel,"power_num").getComponent("CusRichText"),this.name=this.seekChild(this.base_panel,"name"),this.equip_type=this.seekChild(this.base_panel,"equip_type",cc.Label),this.baseattr_panel=this.seekChild("baseattr_panel"),this.seekChild(this.baseattr_panel,"label",cc.Label).string=Utils.TI18N("\u57fa\u7840\u5c5e\u6027"),this.baseattr_panel_height=this.baseattr_panel.height,this.suitattr_panel=this.seekChild("suitattr_panel"),this.suitattr_panel_height=this.suitattr_panel.height,this.suitattr_name=this.seekChild(this.suitattr_panel,"label",cc.Label),this.desc_panel=this.seekChild(this.container,"desc_panel"),this.desc_panel_height=this.desc_panel.height,this.scroll_view=this.seekChild(this.desc_panel,"content"),this.desc_label=this.seekChild(this.scroll_view,"desc_label"),this.tab_panel=this.seekChild(this.container,"tab_panel"),this.tab_panel_height=this.tab_panel.height,this.left_btn=this.seekChild(this.tab_panel,"tab_btn_1"),this.left_btn_label=this.seekChild(this.left_btn,"Label",cc.Label),this.right_btn=this.seekChild(this.tab_panel,"tab_btn_3"),this.right_btn_label=this.seekChild(this.right_btn,"Label",cc.Label),this.item=this.seekChild("item")},registerEvent:function(){this.background.on(cc.Node.EventType.TOUCH_END,function(t){this.tips_controller.closeTIpsByType(n.type.EQUIP)}.bind(this)),this.close_btn.on(cc.Node.EventType.TOUCH_END,function(t){this.tips_controller.closeTIpsByType(n.type.EQUIP)}.bind(this)),this.right_btn.on(cc.Node.EventType.TOUCH_END,function(e){if(this.data){var i=this.partner_id||0,s=this.data.id||0;if(this.tips_controller.closeTIpsByType(n.type.EQUIP),this.cloth_type==c.EqmTips.backpack)if(0==i){var a=t("mainui_controller"),o=t("mainui_const");a.getInstance().changeMainUIStatus(o.btn_index.partner,{index:1})}else{t("hero_controller").getInstance().sender11010(i,s)}else if(this.cloth_type==c.EqmTips.partner){t("hero_controller").getInstance().openEquipPanel(!0,this.data.type,this.partner_id,this.data)}}}.bind(this)),this.left_btn.on(cc.Node.EventType.TOUCH_END,function(e){if(this.tips_controller.closeTIpsByType(n.type.EQUIP),this.cloth_type==c.EqmTips.backpack){var i=t("backpack_controller"),s=t("backpack_const");i.getInstance().openItemSellPanel(!0,this.data,s.Bag_Code.EQUIPS)}else this.cloth_type==c.EqmTips.partner&&r.getInstance().sender11011(this.partner_id,this.data.id)}.bind(this))},openRootWnd:function(t){var e=(t=t||{}).data,i=this.cloth_type=t.type||n.eqmTips.normal;this.item_config=null,"number"==typeof e?this.item_config=Utils.getItemConfig(e):e instanceof a||"GoodsVo"==e.type_vo?this.item_config=e.config:this.item_config=e,null!=this.item_config?(this.data=e,this.partner=t.partner,this.partner&&(this.partner_id=this.partner.partner_id||0),this.goods_item.setData(this.item_config),this.resetLayout(i)):this.tips_controller.closeTIpsByType(n.type.EQUIP)},resetLayout:function(t){var e=!1;0!=this.item_config.eqm_set&&(this.suit_config=gdata("partner_eqm_data","data_eqm_suit",this.item_config.eqm_set),this.suit_config&&(e=!0));var i=t==n.eqmTips.backpack||t==n.eqmTips.partner,s=this.container_init_height,a=0;if(e){var o=this.setSuitAttrInfo();-1==o?(e=!1,this.suitattr_panel.active=!1,s-=this.suitattr_panel_height):(s+=o-this.suitattr_panel_height,a=o)}else this.suitattr_panel.active=!1,s-=this.suitattr_panel_height;i||(this.tab_panel.active=!1,s-=this.tab_panel_height),this.container_init_height!=s&&(this.container.height=s,this.desc_panel.y=e?this.suitattr_panel.y-a:this.baseattr_panel.y-this.baseattr_panel_height,this.tab_panel.y=this.desc_panel.y-this.desc_panel_height),i&&this.updateBtnList(t),this.setBaseInfo(),this.setBaseAttrInfo()},setSuitAttrInfo:function(){if(null==this.item_config)return-1;if(null==this.suit_config)return-1;this.suit_config.sort(function(t,e){return t.num-e.num});for(var t=this.suit_config[this.suit_config.length-1].num,e=null,i=[],n=0;n<this.suit_config.length;n++){var a=this.suit_config[n];if(null==e&&(e=a.name),a.attr.length>0){var l=a.attr[a.attr.length-1];i.push({count:a.num,attr_key:l[0],attr_val:l[1]})}}var r=this.getEquipActiveCount();this.suitattr_name.string=e+"("+r+"/"+t+")";var c=i[i.length-1];c&&r>=c.count&&this.suitattr_name&&this.suitattr_name.node&&(this.suitattr_name.node.color=new cc.Color(139,255,142,255));for(var _=0;_<i.length;_++){var h=i[_],d=cc.instantiate(this.item);d.active=!0,d.x=-167,d.y=-50-40*_,this.suitattr_panel.addChild(d);var u=s.getAttrIconByStr(h.attr_key),m=s.getCommonIcomPath(u);this.loadRes(m,function(t,e){t.getChildByName("icon").getComponent(cc.Sprite).spriteFrame=e}.bind(this,d));var f=o.getAttrValue(h.attr_key,h.attr_val),p=gdata("attr_data","data_key_to_name",h.attr_key),g="#c1b7ab",v="#ffeedd";r>=h.count&&(g="#8bff8e",v="#8bff8e"),d.getChildByName("attr").getComponent(cc.RichText).string=cc.js.formatStr("<color=%s>%s:</color> <color=%s>%s</color>",g,p,v,f);var b=d.getChildByName("info");b.active=!0;var w=b.color;w.fromHEX(v),b.color=w,b.getComponent(cc.Label).string=cc.js.formatStr("(%s%s)",h.count,Utils.TI18N("\u4ef6\u6fc0\u6d3b"))}return 50+40*i.length},getEquipActiveCount:function(){if(null==this.partner_id||0==this.partner_id)return 0;var t=0,e=[];if(this.item_config.sub_type==o.item_tab_type.HOLYEQUIPMENT);else if(this.item_config.sub_type==o.item_tab_type.EQUIPS)if(null!=this.partner.eqms)for(var i in this.partner.eqms){var s=new a;s.setBaseId(this.partner.eqms[i].base_id),e[this.partner.eqms[i].type]=s}else if(null!=this.partner.eqm_list)for(var n in this.partner.eqm_list)e[n]=this.partner.eqm_list[n];for(var n in e){var l=e[n];l.config&&this.item_config.eqm_set==l.config.eqm_set&&(t+=1)}return t},updateBtnList:function(t){(t=t||n.eqmTips.normal)==n.eqmTips.backpack?(this.right_btn_label.string=Utils.TI18N("\u7a7f\u6234"),this.left_btn_label.string=Utils.TI18N("\u51fa\u552e")):t==n.eqmTips.partner&&(this.right_btn_label.string=Utils.TI18N("\u66f4\u6362"),this.left_btn_label.string=Utils.TI18N("\u5378\u4e0b"))},setBaseInfo:function(){if(null!=this.item_config){var t=o.quality_color(this.item_config.quality),e=this.name.color;e.fromHEX(t),this.name.color=e,this.name.getComponent(cc.Label).string=this.item_config.name,this.equip_type.string=Utils.TI18N("\u7c7b\u578b:")+this.item_config.type_desc,this.desc_label.getComponent(cc.RichText).string="<color=#a1978b>"+l.parse(this.item_config.desc)+"</c>",this.scroll_view.height=this.desc_label.height;var i=this.data.score||0;i<=0&&(i=this.getBaseScore()||0);var n=this.data.all_score||0;n=Math.max(n,i),this.power_label.setNum(n),this.loadRes(s.getUIIconPath("tips","tips_"+this.item_config.quality),function(t){this.base_panel_sprite.spriteFrame=t}.bind(this))}},setBaseAttrInfo:function(){if(null!=this.item_config&&0!=this.item_config.ext.length&&null!=this.item_config.ext[0][1]){var t=this.item_config.ext[0][1][0];if(null!=t){var e=t[0],i=o.getAttrValue(e,t[1]),n=cc.instantiate(this.item);n.active=!0,n.x=-167,n.y=-50,this.baseattr_panel.addChild(n);var a=s.getAttrIconByStr(e),l=s.getCommonIcomPath(a);this.loadRes(l,function(t){n.getChildByName("icon").getComponent(cc.Sprite).spriteFrame=t}.bind(this));var r=gdata("attr_data","data_key_to_name",e);n.getChildByName("attr").getComponent(cc.RichText).string=cc.js.formatStr("<color=#c1b7ab>%s:</c> <color=#ffeedd>%s</color>",r,i)}}},getBaseScore:function(){if(!this.item_config||!this.item_config.ext||!this.item_config.ext[0])return 0;var t=this.item_config.ext[0][1]||{};return _.calculatePower(t)},closeCallBack:function(){this.goods_item&&this.goods_item.deleteMe(),this.tips_controller.closeTIpsByType(n.type.EQUIP)}});cc._RF.pop()},{backpack_const:"backpack_const",backpack_controller:"backpack_controller",goods_vo:"goods_vo",hero_controller:"hero_controller",mainui_const:"mainui_const",mainui_controller:"mainui_controller",partner_calculate:"partner_calculate",partner_const:"partner_const",pathtool:"pathtool",string_util:"string_util",tips_const:"tips_const",tips_controller:"tips_controller"}],equipment_all_synthesis_window:[function(t,e,i){"use strict";cc._RF.push(e,"03ef5Cpqs5PI4ONdxJtzIM2","equipment_all_synthesis_window");var s=t("pathtool"),n=t("forgehouse_controller"),a=t("common_scrollview");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("forgehouse","forgehouse_all_synthesis"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Big},initConfig:function(){this.ctrl=n.getInstance()},openCallBack:function(){this.background=this.seekChild("background"),this.background.scale=FIT_SCALE,this.btn_sure=this.seekChild("btn_sure"),this.btn_comp=this.seekChild("btn_comp"),this.comp_coin_rt=this.seekChild("comp_coin",cc.RichText);var t=this.seekChild("good_cons"),e=t.getContentSize();this.item_scrollview=new a,this.item_scrollview.createScroll(t,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,e,{item_class:"backpack_item",start_x:18,space_x:10,start_y:5,space_y:8,item_width:120,item_height:120,row:1,col:5},cc.v2(.5,.5))},registerEvent:function(){Utils.onTouchEnd(this.btn_sure,function(){var t=this.ctrl.getModel().getCompSendID();t&&this.ctrl.send11081(t)}.bind(this),1),Utils.onTouchEnd(this.btn_comp,function(){this.ctrl.openEquipmentAllSynthesisWindow(!1)}.bind(this),1)},openRootWnd:function(t){if(this.data=t,this.data&&null!=Utils.next(this.data)){var e=Utils.getItemConfig(1),i=s.getItemRes(e.icon),n=cc.js.formatStr(Utils.TI18N("\u662f\u5426\u6d88\u8017 <img src='%s'/>%s \u4ee5\u53ca\u6750\u6599\u5408\u6210\u4ee5\u4e0b\u88c5\u5907"),e.icon,Utils.getMoneyString(this.data.coin));this.comp_coin_rt.string=n,this.loadRes(i,function(t){this.comp_coin_rt.spriteFrame=t}.bind(this));var a=[];for(var o in this.data.list){var l=this.data.list[o],r={};r.bid=l.bid,r.num=l.num,a.push(r)}this.item_scrollview.setData(a),this.item_scrollview.addEndCallBack(function(){var t=this.item_scrollview.getItemList();for(var e in t)t[e]&&t[e].setDefaultTip()}.bind(this))}},closeCallBack:function(){this.item_scrollview&&(this.item_scrollview.deleteMe(),this.item_scrollview=null),this.ctrl.openEquipmentAllSynthesisWindow(!1)}});cc._RF.pop()},{common_scrollview:"common_scrollview",forgehouse_controller:"forgehouse_controller",pathtool:"pathtool"}],equipment_comp_record_item:[function(t,e,i){"use strict";cc._RF.push(e,"73a3aW6uqNHxaAMQoMPNgAe","equipment_comp_record_item");var s=t("pathtool"),n=t("common_scrollview"),a=t("timetool");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("forgehouse","forgehouse_comp_record_item")},initConfig:function(){},initPanel:function(){this.time_text_lb=this.seekChild("time_text",cc.Label),this.consume_text_lb=this.seekChild("consume_text",cc.Label);var t=this.seekChild("consume_item",cc.Sprite),e=Utils.getItemConfig(1),i=s.getItemRes(e.icon);this.loadRes(i,function(e){t.spriteFrame=e}.bind(this));var a=this.seekChild("good_cons"),o=a.getContentSize();this.item_scrollview=new n,this.item_scrollview.createScroll(a,cc.v2(0,0),ScrollViewDir.horizontal,ScrollViewStartPos.top,o,{item_class:"backpack_item",start_x:10,space_x:0,start_y:0,space_y:0,item_width:96,item_height:96,row:1,col:0,scale:.8},cc.v2(.5,.5))},registerEvent:function(){},setData:function(t){this.data=t,this.root_wnd&&this.onShow()},onShow:function(){if(null!=this.data){var t=this.data;this.time_text_lb.string=a.getYMDHMS(t.time),this.consume_text_lb.string=t.coin;var e=[];for(var i in t.items){var s=t.items[i],n=Utils.deepCopy(Utils.getItemConfig(s.bid));n&&(n.num=s.num,n.bid=s.bid,e.push(n))}this.item_scrollview.setData(e),this.item_scrollview.addEndCallBack(function(){var t=this.item_scrollview.getItemList();for(var e in t)t[e]&&t[e].setDefaultTip()}.bind(this))}},onHide:function(){},onDelete:function(){this.item_scrollview&&(this.item_scrollview.deleteMe(),this.item_scrollview=null)}});cc._RF.pop()},{common_scrollview:"common_scrollview",pathtool:"pathtool",timetool:"timetool"}],equipment_comp_record_window:[function(t,e,i){"use strict";cc._RF.push(e,"d5832MJy4VCYKIovE6y9/Jg","equipment_comp_record_window");var s=t("pathtool"),n=t("equipment_comp_record_item"),a=t("common_scrollview"),o=t("forgehouse_controller");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("forgehouse","forgehouse_comp_record"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Big},initConfig:function(){this.ctrl=o.getInstance()},openCallBack:function(){this.background=this.seekChild("background"),this.background.scale=FIT_SCALE,this.empty_bg=this.seekChild("empty_bg"),this.btn_sure=this.seekChild("btn_sure");var t=this.seekChild("good_cons"),e=t.getContentSize(),i={item_class:n,start_x:10,space_x:0,start_y:0,space_y:0,item_width:651,item_height:197,row:0,col:1};this.item_scrollview=new a,this.item_scrollview.createScroll(t,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,e,i,cc.v2(.5,.5))},registerEvent:function(){Utils.onTouchEnd(this.btn_sure,function(){this.ctrl.openEquipmentCompRecordWindow(!1)}.bind(this),1),this.addGlobalEvent(EventId.COMPOSITE_RECORD,function(t){t&&null!=Utils.next(t)&&(null!=Utils.next(t.logs)?this.empty_bg.active=!1:this.empty_bg.active=!0,this.item_scrollview&&this.item_scrollview.setData(t.logs))},this)},openRootWnd:function(){this.ctrl.send11082()},closeCallBack:function(){this.item_scrollview&&(this.item_scrollview.deleteMe(),this.item_scrollview=null),this.ctrl.openEquipmentCompRecordWindow(!1)}});cc._RF.pop()},{common_scrollview:"common_scrollview",equipment_comp_record_item:"equipment_comp_record_item",forgehouse_controller:"forgehouse_controller",pathtool:"pathtool"}],esecsice_const:[function(t,e,i){"use strict";cc._RF.push(e,"0c0284UQwZGvYtSEOZ+pQuD","esecsice_const");var s={execsice_index:{endless:1,stonedungeon:2,heroexpedit:3,honourfane:4}};e.exports=s,cc._RF.pop()},{}],esecsice_controller:[function(t,e,i){"use strict";cc._RF.push(e,"18c73U4iDZOmKL3C3og4MHa","esecsice_controller");var s=t("esecsice_const"),n=cc.Class({extends:BaseController,ctor:function(){},initConfig:function(){var e=t("esecsice_model");this.model=new e,this.model.initConfig()},getModel:function(){return this.model},registerEvents:function(){},registerProtocals:function(){},openEsecsiceView:function(e){if(e){if(!this.esecsiceView){var i=t("esecsice_window");this.esecsiceView=new i}this.esecsiceView.open()}else this.esecsiceView&&(this.esecsiceView.close(),this.esecsiceView=null)},switchEcecsiceActivityView:function(e){Log.info("====>>>",e),e==s.execsice_index.endless?t("mainui_controller").getInstance().requestOpenBattleRelevanceWindow(t("battle_const").Fight_Type.Endless):e==s.execsice_index.stonedungeon?t("mainui_controller").getInstance().requestOpenBattleRelevanceWindow(t("battle_const").Fight_Type.DungeonStone):e==s.execsice_index.heroexpedit?t("mainui_controller").getInstance().requestOpenBattleRelevanceWindow(t("battle_const").Fight_Type.ExpeditFight):e==s.execsice_index.honourfane&&t("mainui_controller").getInstance().requestOpenBattleRelevanceWindow(t("battle_const").Fight_Type.PrimusWar)},getEsecsiceRoot:function(t){if(t)this.esecsiceView?this.esecsiceView.getRootWnd(t):t(null);else if(this.esecsiceView)return this.esecsiceView.root_wnd}});e.exports=n,cc._RF.pop()},{battle_const:"battle_const",esecsice_const:"esecsice_const",esecsice_model:"esecsice_model",esecsice_window:"esecsice_window",mainui_controller:"mainui_controller"}],esecsice_item:[function(t,e,i){"use strict";cc._RF.push(e,"04b23lOWsxAVaKTrIjCrC7f","esecsice_item");var s=t("pathtool"),n=t("esecsice_controller");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("esercise","esercise_item")},initConfig:function(){this.listReward={}},initPanel:function(){this.main_container=this.root_wnd.getChildByName("main_container"),this.itemBG_node=this.main_container.getChildByName("itemBG"),this.itemBG=this.itemBG_node.getComponent(cc.Sprite),this.redPoint=this.main_container.getChildByName("redPoint"),this.redPoint.active=!1,this.limitMask=this.main_container.getChildByName("limitMask"),this.limitMask.zIndex=10,this.textLimitLev=this.main_container.getChildByName("textLimitLev").getComponent(cc.Label),this.textLimitLev.string="",this.textLimitLev.node.zIndex=10,this.textLimitLev.node.active=!1,this.textTimeStart=this.main_container.getChildByName("textTimeStart").getComponent(cc.Label),this.textTimeStart.string="",this.textTimeStart.node.active=!1},registerEvent:function(){this.main_container.on(cc.Node.EventType.TOUCH_END,function(t){this.limitMask.active||n.getInstance().switchEcecsiceActivityView(this.data.goto_id)},this)},onShow:function(e){if(this.data){if(this.main_container.name="guide_activity_item_"+this.data.id,this.loadRes(s.getActivityBig(this.data.pic_name),function(t){this.itemBG.spriteFrame=t}.bind(this)),this.data.desc&&(this.textTimeStart.string=this.data.desc,this.textTimeStart.node.active=!0),1==this.data.is_open)this.textLimitLev.string=this.data.lock_desc,t("mainui_controller").getInstance().checkIsOpenByActivate(this.data.activate)?(this.limitMask.active=!1,this.textLimitLev.node.active=!1):(this.limitMask.active=!0,this.textLimitLev.node.active=!0);else this.limitMask.active=!0,this.textLimitLev.node.active=!0;for(var i in this.data.val[0]){var n=this.data.val[0][i],a=this.listReward[i];a||(a=ItemsPool.getInstance().getItem("backpack_item"),this.listReward[i]=a,a.setParent(this.main_container),a.initConfig(null,.5,!1,!0)),a.setPosition(80*i-260,-40),a.setData(n),a.show()}this.updateRedStatus()}},setData:function(t){this.data=t},onHide:function(){},updateRedStatus:function(){if(this.data&&this.redPoint){var e=!1,i=t("esecsice_const");if(this.data.id==i.execsice_index.endless)e=t("stone_dungeon_controller").getInstance().getModel().checkRedStatus();else if(this.data.id==i.execsice_index.stonedungeon){e=t("endless_trail_controller").getInstance().getModel().checkRedStatus()}else if(this.data.id==i.execsice_index.honourfane){e=t("primus_controller").getInstance().getModel().checkRedStatus()}else if(this.data.id==i.execsice_index.heroexpedit){e=t("heroexpedit_controller").getInstance().getModel().checkRedStatus()}this.redPoint.active=e}},onDelete:function(){for(var t in this.listReward)this.listReward[t].deleteMe();this.listReward=null}});cc._RF.pop()},{endless_trail_controller:"endless_trail_controller",esecsice_const:"esecsice_const",esecsice_controller:"esecsice_controller",heroexpedit_controller:"heroexpedit_controller",mainui_controller:"mainui_controller",pathtool:"pathtool",primus_controller:"primus_controller",stone_dungeon_controller:"stone_dungeon_controller"}],esecsice_model:[function(t,e,i){"use strict";cc._RF.push(e,"bd6b1ze45VDy6YEQrE7USZL","esecsice_model");cc.Class({extends:BaseClass,ctor:function(){},properties:{},initConfig:function(){}});cc._RF.pop()},{}],esecsice_window:[function(t,e,i){"use strict";cc._RF.push(e,"5d7aacF4uNKgLoLHdGJut4E","esecsice_window");var s=t("pathtool"),n=t("esecsice_controller"),a=t("common_scrollview");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("esercise","esercise_window"),this.viewTag=SCENE_TAG.ui,this.win_type=WinType.Full},initConfig:function(){},openCallBack:function(){this.background=this.seekChild(this.root_wnd,"bg"),this.background.scale=2*FIT_SCALE,this.bg=this.seekChild(this.root_wnd,"bg",cc.Sprite),this.main_container=this.seekChild(this.root_wnd,"main_container"),this.loadRes(s.getBigBg("bigbg_63"),function(t){this.bg.spriteFrame=t}.bind(this));var e=this.seekChild(this.main_container,"scoreView"),i=cc.size(690,941),n={item_class:t("esecsice_item"),start_x:0,space_x:4,start_y:0,space_y:10,item_width:690,item_height:274,row:0,col:1,once_num:5,need_dynamic:!0};this.item_scrollview=new a,this.item_scrollview.createScroll(e,cc.v2(345,-471),ScrollViewDir.vertical,ScrollViewStartPos.top,i,n,cc.v2(.5,.5))},registerEvent:function(){var e=t("stone_dungeon_event");this.addGlobalEvent(e.Update_StoneDungeon_Data,function(){this.updateItemListRedStatus()}.bind(this));var i=t("endless_trail_event");this.addGlobalEvent(i.UPDATA_ESECSICE_ENDLESS_REDPOINT,function(){this.updateItemListRedStatus()}.bind(this));var s=t("heroexpedit_event");this.addGlobalEvent(s.Red_Point_Event,function(){this.updateItemListRedStatus()}.bind(this));var n=t("primus_event");this.addGlobalEvent(n.Updata_Primus_RedPoint,function(){this.updateItemListRedStatus()}.bind(this))},updateItemListRedStatus:function(){var t=this.item_scrollview.getItemList();for(var e in t)t[e].updateRedStatus()},openRootWnd:function(t){var e=[];for(var i in Config.dailyplay_data.data_exerciseactivity)e.push(Config.dailyplay_data.data_exerciseactivity[i]);this.item_scrollview.setData(e),this.item_scrollview&&this.item_scrollview.addEndCallBack(function(){this.updateItemListRedStatus()}.bind(this))},closeCallBack:function(){this.item_scrollview&&this.item_scrollview.DeleteMe(),this.item_scrollview=null,n.getInstance().openEsecsiceView(!1)}});cc._RF.pop()},{common_scrollview:"common_scrollview",endless_trail_event:"endless_trail_event",esecsice_controller:"esecsice_controller",esecsice_item:"esecsice_item",heroexpedit_event:"heroexpedit_event",pathtool:"pathtool",primus_event:"primus_event",stone_dungeon_event:"stone_dungeon_event"}],exchange_controller:[function(t,e,i){"use strict";cc._RF.push(e,"1ed8aLtU0NJKJA+X1LXJqRe","exchange_controller");var s=t("exchange_event"),n=cc.Class({extends:BaseController,ctor:function(){},initConfig:function(){var e=t("exchange_model");this.model=new e,this.model.initConfig()},getModel:function(){return this.model},registerEvents:function(){null==this.init_role_event&&(this.init_role_event=gcore.GlobalEvent.bind(EventId.EVT_ROLE_CREATE_SUCCESS,function(){gcore.GlobalEvent.unbind(this.init_role_event),this.init_role_event=null}.bind(this)))},registerProtocals:function(){this.RegisterProtocal(23606,this.on23606),this.RegisterProtocal(23607,this.on23607)},send23606:function(){this.SendProtocal(23606,{})},on23606:function(t){this.model.setExchangeData(t),gcore.GlobalEvent.fire(s.Extra_Reward,t)},send23607:function(t){this.SendProtocal(23607,{id:t})},on23607:function(t){message(t.msg)},openExchangeMainView:function(e){if(e){if(!this.exchange_win){var i=t("exchange_window");this.exchange_win=new i}this.exchange_win.open()}else this.exchange_win&&(this.exchange_win.close(),this.exchange_win=null)}});e.exports=n,cc._RF.pop()},{exchange_event:"exchange_event",exchange_model:"exchange_model",exchange_window:"exchange_window"}],exchange_event:[function(t,e,i){"use strict";cc._RF.push(e,"7e605UKB1FAGJSLsQzfx9SA","exchange_event"),e.exports={Extra_Reward:"ExchangeEvent.Extra_Reward"},cc._RF.pop()},{}],exchange_model:[function(t,e,i){"use strict";cc._RF.push(e,"1abe1v1FFJFJbuyXQKjrfxE","exchange_model");var s=cc.Class({extends:BaseClass,ctor:function(){},properties:{},initConfig:function(){this.exchangeList=[]},setExchangeData:function(t){this.exchangeList=t.list},getRedStatus:function(){for(var t=!1,e=0;e<this.exchangeList.length;++e){var i=this.exchangeList[e];if(1==i.id){i.max-i.num>0&&(t=!0);break}}return t}});e.exports=s,cc._RF.pop()},{}],exchange_window:[function(t,e,i){"use strict";cc._RF.push(e,"7fb6c1VdDVC6ok8cQp3cFLO","exchange_window");var s=t("pathtool"),n=t("loadermanager"),a=(t("role_controller"),t("exchange_controller")),o=t("exchange_event"),l=t("timetool"),r=cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("exchange","exchange_main_win"),this.viewTag=SCENE_TAG.dialogue},openCallBack:function(){var t=this;this.main_container=this.root_wnd.getChildByName("main_container"),this.background=this.root_wnd.getChildByName("background"),this.bg=this.root_wnd.getChildByName("bg").getComponent(cc.Sprite),n.getInstance().loadRes(s.getBigBg("bigbg_65","png"),function(t){this.bg.spriteFrame=t}.bind(this)),this.objects={};for(var e=function(e){(a={}).remain=t.main_container.getChildByName("remain_text_"+e).getComponent(cc.Label),a.btn=t.main_container.getChildByName("btn_"+e),a.get=t.main_container.getChildByName("get_"+e),a.gold=a.btn.getChildByName("label").getComponent(cc.Label),a.coin=t.main_container.getChildByName("coin_"+e).getChildByName("label").getComponent(cc.Label),t.objects[e]=a,n.getInstance().loadRes(s.getItemRes("1"),function(t){this.main_container.getChildByName("coin_"+e).getChildByName("icon").getComponent(cc.Sprite).spriteFrame=t}.bind(t)),t.main_container.getChildByName("btn_"+e).getChildByName("icon")&&n.getInstance().loadRes(s.getItemRes("3"),function(t){this.main_container.getChildByName("btn_"+e).getChildByName("icon").getComponent(cc.Sprite).spriteFrame=t}.bind(t))},i=1;i<=3;i++){var a;e(i)}this.textTime=this.main_container.getChildByName("textTime").getComponent(cc.Label)},registerEvent:function(){var t=this;this.background.on(cc.Node.EventType.TOUCH_END,function(t){Utils.playButtonSound(2),a.getInstance().openExchangeMainView(!1)},this);var e=function(e){t.objects[e].btn.on(cc.Node.EventType.TOUCH_END,function(t){Utils.playButtonSound(1),this.objects[e].v&&a.getInstance().send23607(this.objects[e].v.id)},t)};for(var i in this.objects)e(i);this.addGlobalEvent(o.Extra_Reward,function(t){this.updateData(t)},this)},openRootWnd:function(){a.getInstance().send23606()},updateData:function(t){for(var e in this.data=t,this.setLessTime(),t.list){var i=t.list[e],s=this.objects[i.id];s.v=i,s.remain.string=Utils.TI18N("\u5269\u4f59\uff1a"+Math.max(0,i.max-i.num)),s.coin.string=i.gain,i.num>=i.max?(s.btn.active=!1,s.get.active=!0):(s.btn.active=!0,s.get.active=!1,0==i.price?s.gold.string=Utils.TI18N("\u514d\u8d39\u83b7\u53d6"):s.gold.string=i.price+Utils.TI18N("\u83b7\u53d6"))}},setLessTime:function(){if(cc.isValid(this.textTime)&&this.data){var t=this.data.ref_time-gcore.SmartSocket.getTime();t>0?(this.textTime.string=l.getTimeFormat(t),this.timer=gcore.Timer.set(function(){this.setLessTime(),this.timer=null}.bind(this),1e3,1)):this.textTime.string="00:00:00"}},closeCallBack:function(){a.getInstance().openExchangeMainView(!1),this.timer&&gcore.Timer.del(this.timer),n.getInstance().deleteRes(s.getBigBg("bigbg_65","png"))}});e.exports=r,cc._RF.pop()},{exchange_controller:"exchange_controller",exchange_event:"exchange_event",loadermanager:"loadermanager",pathtool:"pathtool",role_controller:"role_controller",timetool:"timetool"}],face_item:[function(t,e,i){"use strict";cc._RF.push(e,"20996YMh/tAX5wDjggald3u","face_item");var s=t("pathtool");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("chat","face_item")},initConfig:function(){},initPanel:function(){this.fack_sk=this.seekChild("face_sk",sp.Skeleton),this.root_wnd.on(cc.Node.EventType.TOUCH_END,this.onClitemItem,this)},registerEvent:function(){},onShow:function(t){this.updateWidgets()},onHide:function(){},onDelete:function(){},setData:function(t){this.data=t,this.root_wnd&&this.updateWidgets()},updateWidgets:function(){if(this.data){var t=s.getSpinePath(this.data.name,"action");this.loadRes(t,function(t){this.fack_sk.skeletonData=t,this.fack_sk.setAnimation(0,t.name,!0)}.bind(this))}},addCallBack:function(t){this.select_cb=t},onClitemItem:function(){if(this.select_cb){var t="#"+this.data.id;this.select_cb(t)}}});cc._RF.pop()},{pathtool:"pathtool"}],feat_panel:[function(t,e,i){"use strict";cc._RF.push(e,"f063313DrFOmZGPXr9yV6p9","feat_panel");var s=t("pathtool"),n=t("task_controller"),a=t("task_item"),o=t("task_event"),l=t("common_scrollview"),r=cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("task","feat_panel"),this.ctrl=n.getInstance(),this.model=this.ctrl.getModel(),this.status=null},initPanel:function(){this.quest_container=this.root_wnd.getChildByName("quest_container");var t=this.quest_container.getContentSize(),e=cc.size(t.width,t.height-20),i={item_class:a,start_x:6,space_x:0,start_y:0,space_y:2,item_width:610,item_height:148,row:0,col:1,need_dynamic:!0};this.item_scrollview=new l,this.item_scrollview.createScroll(this.quest_container,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,e,i,cc.v2(.5,.5)),this.addToParent(this.status)},addToParent:function(t){this.status=t,null!=this.root_wnd&&(this.setVisible(t),1==t&&this.updateFeatList(!0))},registerEvent:function(){this.addGlobalEvent(o.UpdateFeatList,function(){this.updateFeatList()}.bind(this))},updateFeatList:function(){var t=this.model.getFeatList();this.item_scrollview.setData(t)},onDelete:function(){this.item_scrollview&&(this.item_scrollview.deleteMe(),this.item_scrollview=null)}});e.exports=r,cc._RF.pop()},{common_scrollview:"common_scrollview",pathtool:"pathtool",task_controller:"task_controller",task_event:"task_event",task_item:"task_item"}],fileinfo:[function(t,e,i){"use strict";cc._RF.push(e,"fac31HosGxN8qIzPrxhsnLA","fileinfo");var s=cc.Class({properties:{url:{get:function(){return this._url},set:function(t){this._url=t}},obj:null},ctor:function(){this.loadNum=0,this.obj=arguments[0]},updateLoadNum:function(){this.loadNum+=1},decrementLoadNum:function(){this.loadNum-=1},getLoadNum:function(){return this.loadNum},deleteMe:function(){}});e.exports=s,cc._RF.pop()},{}],forge_artifact_panel:[function(t,e,i){"use strict";cc._RF.push(e,"516c8UY2vRKk73yacT349ks","forge_artifact_panel");var s=t("pathtool"),n=t("hero_controller"),a=t("hero_event"),o=t("backpack_controller"),l=t("role_controller"),r=t("backpack_const"),c=t("guide_event");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("forgehouse","forge_artifact_panel")},initConfig:function(){this.artifact_items={},this.com_artifact_id=0,this.chose_item_list={},this.is_show_effect=!1},initPanel:function(){this.main_container=this.seekChild("main_container"),this.skill_btn=this.seekChild("skill_btn"),this.rate_txt_lb=this.seekChild("rate_txt",cc.Label),this.level_txt_lb=this.seekChild("level_txt",cc.Label),this.rate_txt_lb.node.active=!1,this.level_txt_lb.node.active=!1,this.explain_btn=this.seekChild("explain_btn"),this.quick_add_btn=this.seekChild("quick_add_btn"),this.compound_btn=this.seekChild("compound_btn"),this.image_bg=this.seekChild("image_bg",cc.Sprite),this.loadRes(s.getBigBg("bigbg_79"),function(t){this.image_bg.spriteFrame=t}.bind(this)),this.cost_txt_rt=this.seekChild("cost_txt",cc.RichText),this.zhufu_txt_lb=this.seekChild("zhufu_txt",cc.Label),this.get_zhufu_nd=this.seekChild("get_zhufu"),this.zhufu_tips_nd=this.seekChild("zhufu_tips");var t=this.seekChild("zhufu_icon",cc.Sprite),e=Config.partner_artifact_data.data_artifact_const.change_gift;if(e){var i=e.val[0][0];null!=i&&this.loadRes(s.getItemRes(i),function(e){t.spriteFrame=e}.bind(this))}this.progress_panel=this.seekChild("progress_panel"),this.progress_sk=this.seekChild(this.progress_panel,"effect",sp.Skeleton),this.progress_pb=this.seekChild("progress_panel",cc.ProgressBar),this.handleProgressEffect(!0),this.pos_node=this.seekChild("pos_node");for(var n=function(t){Utils.delayRun(this.main_container,4*t/60,function(){var e=this.seekChild(this.main_container,"pos_node_"+t),i=ItemsPool.getInstance().getItem("backpack_item");i.initConfig(!1,1,!1,!1),i.show(),i.addCallBack(this._onClickItemCallBack.bind(this)),i.showAddIcon(!0),i.setIsShowBackground(!1),i.setParent(e),i.parent_node=e,this.artifact_items[t]=i}.bind(this))}.bind(this),a=1;a<=5;a++)n(a);this.updataZhufuInfo(),this.root_wnd.task_tips=!0,gcore.GlobalEvent.fire(c.OpenTaskEffect,this.root_wnd)},registerEvent:function(){Utils.onTouchEnd(this.skill_btn,function(){n.getInstance().openArtifactSkillWindow(!0,1)}.bind(this),1),Utils.onTouchEnd(this.quick_add_btn,function(){this._onClickQuickAddBtn()}.bind(this),1),Utils.onTouchEnd(this.compound_btn,function(){this._onClickCompoundBtn()}.bind(this),1),Utils.onTouchEnd(this.get_zhufu_nd,function(){n.getInstance().openArtifactAwardWindow(!0)}.bind(this),1),this.explain_btn.on(cc.Node.EventType.TOUCH_END,function(e){Utils.playButtonSound(1);var i=e.touch.getLocation();t("tips_controller").getInstance().showCommonTips(Config.partner_artifact_data.data_artifact_const.artifact_rule.desc,i)}),this.addGlobalEvent(a.Artifact_Lucky_Event,function(){this.updataZhufuInfo()},this),this.addGlobalEvent(a.Artifact_Lucky_Red_Event,function(){this.zhufu_tips_nd.active=n.getInstance().getModel().getArtifactLuckyRedStatus()},this),this.addGlobalEvent(a.Artifact_Compound_Event,function(){this.com_artifact_id=0,this.chose_item_list={},this.updateChoseArtifactItems()},this),this.addGlobalEvent(a.Artifact_Chose_Event,function(t){this.chose_item_list=t,this.updateChoseArtifactItems()},this)},onShow:function(t){},_onClickItemCallBack:function(){var t={};t.bid=this.com_artifact_id,t.max_num=5,t.chose_list=this.chose_item_list||{},n.getInstance().openArtifactChoseWindow(!0,t)},handleComEffect:function(t){if(0==t)this.special_sk&&(this.special_sk.setToSetupPose(),this.special_sk.clearTracks());else if(this.is_show_effect=!0,this.pos_node&&!this.special_sk){this.special_sk=this.pos_node.getComponent(sp.Skeleton);var e=cc.js.formatStr("spine/%s/action.atlas",s.getEffectRes(661));this.loadRes(e,function(t){this.special_sk.skeletonData=t,this.special_sk.setAnimation(1,PlayerAction.action,!1)}.bind(this)),this.special_sk.setCompleteListener(function(){this.requestCompoundArtifact()}.bind(this))}else this.special_sk&&(this.special_sk.setToSetupPose(),this.special_sk.setAnimation(1,PlayerAction.action,!1))},updateChoseArtifactItems:function(){var t=this;this.com_artifact_id=0;var e=function(){n=t.chose_item_list[i-1];var e=t.artifact_items[i];null!=n&&(a=o.getInstance().getModel().getBackPackItemById(n))?(0==t.com_artifact_id&&(r=Config.partner_artifact_data.data_artifact_data[a.config.id],t.com_artifact_id=r.com_artifact),e.setData(a),e.chose_effect||(e.chose_effect=e.parent_node.getComponent(sp.Skeleton),c=cc.js.formatStr("spine/%s/action.atlas",s.getEffectRes(662)),t.loadRes(c,function(t){e.chose_effect.skeletonData=t,e.chose_effect.setAnimation(1,PlayerAction.action,!0)}.bind(t))),e.chose_effect.enabled=!0,e.showAddIcon(!1)):(e.setData({undata:!0}),e.showAddIcon(!0),e.chose_effect&&e.chose_effect.node&&(e.chose_effect.enabled=!1))};for(var i in this.artifact_items){var n,a,r,c;e()}if(this.target_item||(this.target_item=ItemsPool.getInstance().getItem("backpack_item"),this.target_item.initConfig(!1,1,!1,!0),this.target_item.addCallBack(this._onClickTargetCallBack.bind(this)),this.target_item.show(),this.target_item.setIsShowBackground(!1),this.target_item.setParent(this.pos_node)),0!=this.com_artifact_id){this.target_item.setData({bid:this.com_artifact_id,num:1});var _=Config.partner_artifact_data.data_artifact_compound[this.com_artifact_id],h=Config.partner_artifact_data.data_artifact_data[this.com_artifact_id],d=l.getInstance().getRoleVo();if(_&&_[this.chose_item_list.length]){var u=_[this.chose_item_list.length].rate||0;this.rate_txt_lb.string=Utils.TI18N("\u6210\u529f\u7387")+u/10+"%",this.rate_txt_lb.node.color=new cc.Color(112,206,50,255),this.rate_txt_lb.node.active=!0,this.updateCostInfo(_[this.chose_item_list.length].other_expend)}else this.rate_txt_lb.string=Utils.TI18N("\u97002\u4e2a\u540c\u7c7b\u7b26\u6587"),this.rate_txt_lb.node.color=new cc.Color(206,164,120,255),this.rate_txt_lb.node.active=!0,this.cost_txt_rt.node.active=!1;h&&h.limit_lv>d.lev?(this.level_txt_lb.string=cc.js.formatStr("\u9700\u8fbe\u5230%d\u7ea7",h.limit_lv),this.level_txt_lb.node.active=!0,this.cost_txt_rt.node.active=!1):this.level_txt_lb.node.active=!1}else this.target_item.setData({undata:!0}),this.rate_txt_lb.node.active=!1,this.level_txt_lb.node.active=!1,this.cost_txt_rt.node.active=!1},updateCostInfo:function(t){if(null!=t&&null!=Utils.next(t)){this.cost_txt_rt.node.active=!0;var e="";for(var i in t){var n=t[i],a=n[0],o=n[1],l=Utils.getItemConfig(a);e=cc.js.formatStr("%s<img src='%s' scale=0.3 />%s",e,l.icon,Utils.getMoneyString(o))}this.cost_txt_rt.string="\u6d88\u8017\n"+e,this.loadRes(s.getItemRes(l.icon),function(t){this.cost_txt_rt.spriteFrame=t}.bind(this))}},updataZhufuInfo:function(){var t=n.getInstance().getModel().getArtifactLucky(),e=0,i=Config.partner_artifact_data.data_artifact_const.change_condition;i&&null!=i.val&&(e=i.val);var s=t/e;if(this.progress_pb.progress=s,this.zhufu_txt_lb.string=t,this.zhufu_tips_nd.active=n.getInstance().getModel().getArtifactLuckyRedStatus(),this.progress_sk){var a=324*s;a<3&&(a=3),this.progress_sk.node.y=a}},handleProgressEffect:function(t){if(0==t)this.progress_sk&&(this.progress_sk.setToSetupPose(),this.progress_sk.clearTracks());else if(this.progress_sk){var e=cc.js.formatStr("spine/%s/action.atlas",s.getEffectRes(660));this.loadRes(e,function(t){this.progress_sk.skeletonData=t,this.progress_sk.setAnimation(1,PlayerAction.action,!0)}.bind(this))}},_onClickTargetCallBack:function(){0!=this.com_artifact_id&&n.getInstance().openArtifactComTipsWindow(!0,this.com_artifact_id)},_onClickQuickAddBtn:function(){var t=o.getInstance().getModel().getBackPackItemListByType(r.item_type.ARTIFACTCHIPS);for(var e in t.sort(Utils.tableLowerSorter(["quality","id"])),t){var i=t[e].config.id,s=Config.partner_artifact_data.data_artifact_data[i];if(s&&0!=s.com_artifact){var n=Config.partner_artifact_data.data_artifact_data[s.com_artifact],a=o.getInstance().getModel().getItemNumByBid(i);if(n&&a>=n.limit_num){var l=o.getInstance().getModel().getBackPackItemIdListByBid(i);if(l.sort(function(t,e){return t-e}),this.chose_item_list=[],l.length>5)for(var e in l){if(!(e<5))break;this.chose_item_list.push(l[e])}else this.chose_item_list=l;break}}}null==Utils.next(this.chose_item_list)?message(Utils.TI18N("\u6682\u65e0\u53ef\u4f5c\u4e3a\u6750\u6599\u7684\u7b26\u6587")):this.updateChoseArtifactItems(),window.TASK_TIPS&&gcore.GlobalEvent.fire(c.TaskNextStep,"quick_add_btn")},_onClickCompoundBtn:function(){window.TASK_TIPS&&gcore.GlobalEvent.fire(c.TaskNextStep,"compound_btn"),1!=this.is_show_effect&&(0==this.com_artifact_id||null==Utils.next(this.chose_item_list)?message(Utils.TI18N("\u8bf7\u5148\u653e\u5165\u5408\u6210\u6750\u6599")):this.chose_item_list.length<2?message(Utils.TI18N("\u81f3\u5c11\u9700\u8981\u653e\u51652\u4e2a\u540c\u7c7b\u7b26\u6587")):this.handleComEffect(!0))},requestCompoundArtifact:function(){var t=[];for(var e in this.chose_item_list){var i={};i.artifact_id=this.chose_item_list[e],t.push(i)}n.getInstance().sender11036(this.com_artifact_id,t),this.is_show_effect=!1},onHide:function(){},onDelete:function(){if(this.artifact_items){for(var t in this.artifact_items)this.artifact_items[t]&&(this.artifact_items[t].deleteMe(),this.artifact_items[t]=null);this.artifact_items=null}this.handleProgressEffect(!1),this.handleComEffect(!1),this.target_item&&(this.target_item.deleteMe(),this.target_item=null)}});cc._RF.pop()},{backpack_const:"backpack_const",backpack_controller:"backpack_controller",guide_event:"guide_event",hero_controller:"hero_controller",hero_event:"hero_event",pathtool:"pathtool",role_controller:"role_controller",tips_controller:"tips_controller"}],forge_equip_panel:[function(t,e,i){"use strict";cc._RF.push(e,"37b56evyCRFxZsAYx14HZce","forge_equip_panel");var s=t("pathtool"),n=t("forgehouse_controller"),a=t("common_scrollview"),o=t("forgehouse_item_panel"),l=t("backpack_controller"),r=t("backpack_const"),c=t("role_controller");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("forgehouse","forge_equip_panel")},initConfig:function(){this.tab_list={},this.cur_index=null,this.composite_number=0,this.composite_max=0,this.composite_price=0,this.normal_color=new cc.Color(211,180,155,255),this.normal_outlinecolor=new cc.Color(64,34,21,255),this.select_color=new cc.Color(255,255,255,255),this.select_outlinecolor=new cc.Color(109,53,7,255),this.role_vo=c.getInstance().getRoleVo(),this.ctrl=n.getInstance(),this.partner_const=Config.partner_eqm_data.data_partner_const,this.eqm_comp_list=Config.partner_eqm_data.data_eqm_compose_id},initPanel:function(){this.main_container=this.seekChild("main_container"),this.bg_1=this.seekChild("bg_1",cc.Sprite),this.loadRes(s.getBigBg("bigbg_80"),function(t){this.bg_1.spriteFrame=t}.bind(this));for(var t=[Utils.TI18N("\u6b66\u5668"),Utils.TI18N("\u8863\u670d"),Utils.TI18N("\u5934\u76d4"),Utils.TI18N("\u978b\u5b50")],e=[r.item_type.WEAPON,r.item_type.CLOTHES,r.item_type.HAT,r.item_type.SHOE],i=this.seekChild("tab_container"),n=0;n<4;n++){var l={},c=n+1;l.btn=i.getChildByName("tab_btn_"+c),l.normal=l.btn.getChildByName("normal"),l.select=l.btn.getChildByName("select"),l.red_point=l.btn.getChildByName("redpoint"),l.title=l.btn.getChildByName("title"),l.title_label=l.title.getComponent(cc.Label),l.title_outline=l.title.getComponent(cc.LabelOutline),l.title_label.string=t[n],l.index=c,l.type=e[n],this.tab_list[c]=l}this.btn_composite=this.seekChild("btn_composite"),this.seekChild(this.btn_composite,"Text_1",cc.Label).string=Utils.TI18N("\u5408\u6210"),this.all_composite=this.seekChild("btn_all_composite"),this.all_composite_btn=this.seekChild("btn_all_composite",cc.Button),this.all_composite_lo=this.seekChild(this.all_composite,"Text_1",cc.LabelOutline),this.role_vo.vip_lev<this.partner_const.synthesis_vip_lev.val&&this.role_vo.lev<this.partner_const.synthesis_character_lev.val&&(Utils.setGreyButton(this.all_composite_btn,!0),this.all_composite_lo.enabled=!1),this.btn_add=this.seekChild("btn_add"),this.btn_redu=this.seekChild("btn_redu"),this.gold_num=this.seekChild("gold_num",cc.Label),this.spriteGold=this.seekChild("spriteGold").getComponent(cc.Sprite),this.loadRes(s.getItemRes(1),function(t){this.spriteGold.spriteFrame=t}.bind(this)),this.composite_num=this.seekChild("composite_num",cc.Label),this.composite_num.string=9999,this.bar=this.seekChild("bar",cc.ProgressBar),this.bar_num=this.seekChild("bar_num",cc.Label),this.btn_comp_nd=this.seekChild("btn_comp"),this.last_item=ItemsPool.getInstance().getItem("backpack_item"),this.last_item.setPosition(-156,912),this.last_item.setParent(this.main_container),this.last_item.initConfig(!0,1,!1,!0),this.last_item.show(),this.cur_item=ItemsPool.getInstance().getItem("backpack_item"),this.cur_item.setPosition(156,912),this.cur_item.setParent(this.main_container),this.cur_item.initConfig(!0,1,!1,!0),this.cur_item.show();var _=this.seekChild("goods_con"),h={item_class:o,start_x:4,space_x:8,start_y:0,space_y:10,item_width:120,item_height:120,row:5,col:5,once_num:5,need_dynamic:!0};this.item_scrollview=new a,this.item_scrollview.createScroll(_,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,cc.size(_.width,_.height),h,cc.v2(0,0))},registerEvent:function(){var t=this,e=function(){var e=t.tab_list[i];e.btn&&e.btn.on(cc.Node.EventType.TOUCH_END,function(t){this.changeTabView(e.index)}.bind(t))};for(var i in this.tab_list)e();this.btn_add.on(cc.Node.EventType.TOUCH_END,function(){Utils.playButtonSound(1),this.composite_number<this.composite_max&&this.setCompositeVal(this.composite_number+1)}.bind(this)),this.btn_redu.on(cc.Node.EventType.TOUCH_END,function(){Utils.playButtonSound(1),this.composite_number>1&&this.setCompositeVal(this.composite_number-1)}.bind(this)),this.btn_composite.on(cc.Node.EventType.TOUCH_END,function(t){Utils.playButtonSound(1),null!=this.cur_tab&&null!=this.select_data&&(this.composite_number<=0?message(Utils.TI18N("\u5408\u6210\u6570\u91cf\u6750\u6599\u4e0d\u8db3")):n.getInstance().send11080(this.select_data.id,this.composite_number))}.bind(this)),Utils.onTouchEnd(this.all_composite,function(){if(this.role_vo.vip_lev<this.partner_const.synthesis_vip_lev.val&&this.role_vo.lev<this.partner_const.synthesis_character_lev.val){var t=cc.js.formatStr(Utils.TI18N("\u4eba\u7269%s\u7ea7\u6216VIP\u8fbe\u5230%s\u7ea7\u5f00\u542f"),this.partner_const.synthesis_character_lev.val,this.partner_const.synthesis_vip_lev.val);message(t)}else{var e=this.eqm_comp_list[this.cur_index][Object.keys(this.eqm_comp_list[this.cur_index]).length].id;e&&(this.ctrl.getModel().setCompSendID(e),this.ctrl.send11079(e))}}.bind(this),1),Utils.onTouchEnd(this.btn_comp_nd,function(){this.ctrl.openEquipmentCompRecordWindow(!0)}.bind(this),1),this.addGlobalEvent(EventId.COMPOSITE_RESULT,function(){this.compositeResult()}.bind(this))},onShow:function(t){t=t||1;for(var e in this.changeTabView(t),this.tab_list){var i=this.tab_list[e];i&&this.checkTabCanComposite(i.index)}},changeTabView:function(t){this.cur_index!=t&&(this.cur_tab&&(this.cur_tab.select.active=!1,this.cur_tab.title.color=this.normal_color,this.cur_tab.title_outline.color=this.normal_outlinecolor),this.cur_tab=this.tab_list[t],this.cur_index=t,this.cur_tab&&(this.cur_tab.select.active=!0,this.cur_tab.title.color=this.select_color,this.cur_tab.title_outline.color=this.select_outlinecolor),this.setThePanelData())},compositeResult:function(){this.setThePanelData(!0)},setThePanelData:function(t){if(null!=this.cur_tab){var e=this.cur_tab.index,i=n.getInstance().getModel().getBackEquipsData(e);if(null!=i&&0!=i.length){for(var s=[],a=!1,o=0;o<i.length;o++){var l=i[o],r=!1;1==t&&this.select_data&&this.select_data.id==l.id&&(r=!0,a=!0);var c=this.checkCanComposite(l.expend);s.push({data:l,is_select:r,is_red:c})}0==a&&(s[0].is_select=!0);var _=function(t){this.selectItemCell(t)}.bind(this);this.item_scrollview.setData(s,_,{is_other:!1,scale:1,effect:!1,is_show_tips:!0}),1==t&&this.checkTabCanComposite(this.cur_tab.index)}}},checkCanComposite:function(t){var e=!1,i=!1;if(t&&t.length>=2&&t[0].length>=2){var s=t[0][0],n=t[0][1];e=l.getInstance().getModel().getPackItemNumByBid(r.Bag_Code.EQUIPS,s)>=n,i=t[1][1]<=this.role_vo.coin}return e&&i},checkTabCanComposite:function(t){var e=this.tab_list[t];if(null!=e){var i=e.index,s=n.getInstance().getModel().getBackEquipsData(i);if(s&&s.length>0)for(var a=!1,o=0;o<s.length;o++){var l=s[o];if(1==(a=a||this.checkCanComposite(l.expend)))break}e.red_point.active=a}},selectItemCell:function(t){this.select_item&&(this.select_item.setSelectStatus(!1),this.select_item=null),this.select_item=t,this.select_item.setSelectStatus(!0),this.updateChooseItem()},updateChooseItem:function(){if(null!=this.select_item&&null!=this.select_item.data){this.select_data=this.select_item.data,this.cur_item.setData(this.select_data.id);var t=this.select_data.expend;if(t&&t.length>=2){var e=t[0][0],i=t[0][1];this.last_item.setData(e);var s=l.getInstance().getModel().getPackItemNumByBid(r.Bag_Code.EQUIPS,e);this.bar_num.string=s+"/"+i;var n=Math.min(1,Math.max(s/i));this.bar.progress=n,this.composite_max=Math.floor(s/i);var a=t[1][1];this.composite_price=a,this.setCompositeVal(this.composite_max)}}},setCompositeVal:function(t){this.composite_number=t,this.composite_num.string=t,this.gold_num.string=t*this.composite_price},onHide:function(){},onDelete:function(){this.item_scrollview&&this.item_scrollview.DeleteMe(),this.item_scrollview=null,this.last_item&&this.last_item.onDelete(),this.last_item=null,this.cur_item&&this.cur_item.onDelete(),this.cur_item=null}});cc._RF.pop()},{backpack_const:"backpack_const",backpack_controller:"backpack_controller",common_scrollview:"common_scrollview",forgehouse_controller:"forgehouse_controller",forgehouse_item_panel:"forgehouse_item_panel",pathtool:"pathtool",role_controller:"role_controller"}],forge_house_window:[function(t,e,i){"use strict";cc._RF.push(e,"c0ddcQHhyVC4IRDsk5qS/xR","forge_house_window");var s=t("pathtool"),n=t("forgehouse_controller"),a=t("hero_controller"),o=t("hero_event");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("forgehouse","forge_house_window"),this.viewTag=SCENE_TAG.ui,this.win_type=WinType.Full},initConfig:function(){this.panel_list={}},openCallBack:function(){this.close_btn=this.seekChild("btn_return"),this.container=this.seekChild("container"),this.background=this.seekChild("background"),this.background.scale=FIT_SCALE,this.loadRes(s.getBigBg("bigbg_64"),function(t){this.background.getComponent(cc.Sprite).spriteFrame=t}.bind(this)),this.top_container=this.seekChild("top_container"),this.top_tab_list={};for(var t=0;t<2;t++){var e={},i=t+1;e.btn=this.top_container.getChildByName("tab_btn_"+i),e.tab_btn=e.btn.getComponent(cc.Button),e.tips=e.btn.getChildByName("tips"),e.index=i,2==i&&(e.tips.active=a.getInstance().getModel().getArtifactLuckyRedStatus()),this.top_tab_list[i]=e}},registerEvent:function(){var t=this;this.close_btn.on(cc.Node.EventType.TOUCH_END,function(t){n.getInstance().openForgeHouseView(!1)}.bind(this)),this.addGlobalEvent(o.Artifact_Lucky_Red_Event,function(){var t=this.top_tab_list[2];t&&(t.tips.active=a.getInstance().getModel().getArtifactLuckyRedStatus())},this);var e=function(){var e=t.top_tab_list[i];e.btn&&e.btn.on(cc.Node.EventType.TOUCH_END,function(){this.changeSelectedTab(e.index)}.bind(t))};for(var i in this.top_tab_list)e()},openRootWnd:function(t){t=t||1,this.changeSelectedTab(t)},changeSelectedTab:function(e){if(null==this.top_tab_object||this.top_tab_object.index!=e){if(this.top_tab_object&&(this.top_tab_object.tab_btn.interactable=!1),this.top_tab_object=this.top_tab_list[e],this.top_tab_object&&(this.top_tab_object.tab_btn.interactable=!0),2==e&&(this.top_tab_list[1].tab_btn.interactable=!1),this.cur_panel&&this.cur_panel.setVisible(!1),null==this.panel_list[e]){var i=null;if(1==e)i=new(t("forge_equip_panel"));else if(2==e){i=new(t("forge_artifact_panel"))}i&&(i.show(),i.setParent(this.container),this.panel_list[e]=i)}this.cur_panel=this.panel_list[e],this.cur_panel.setVisible(!0)}},closeCallBack:function(){if(this.panel_list){for(var e in this.panel_list)this.panel_list[e]&&(this.panel_list[e].deleteMe(),this.panel_list[e]=null);this.panel_list=null}this.cur_panel=null;var i=t("guide_event");gcore.GlobalEvent.fire(i.CloseTaskEffect),n.getInstance().openForgeHouseView(!1)}});cc._RF.pop()},{forge_artifact_panel:"forge_artifact_panel",forge_equip_panel:"forge_equip_panel",forgehouse_controller:"forgehouse_controller",guide_event:"guide_event",hero_controller:"hero_controller",hero_event:"hero_event",pathtool:"pathtool"}],forgehouse_const:[function(t,e,i){"use strict";cc._RF.push(e,"4d029w7Hb5Lo6MW7p4NtI4k","forgehouse_const");var s={Tab_Index:{Equip:1,Artifact:2}};e.exports=s,cc._RF.pop()},{}],forgehouse_controller:[function(t,e,i){"use strict";cc._RF.push(e,"90240VouUVJFa2ZnVyWZCD8","forgehouse_controller");var s=cc.Class({extends:BaseController,ctor:function(){},initConfig:function(){var e=t("forgehouse_model");this.model=new e,this.model.initConfig()},getModel:function(){return this.model},registerEvents:function(){},registerProtocals:function(){this.RegisterProtocal(11080,this.handle11080),this.RegisterProtocal(11079,this.handle11079),this.RegisterProtocal(11081,this.handle11081),this.RegisterProtocal(11082,this.handle11082)},handle11080:function(t){message(t.msg),1==t.result&&gcore.GlobalEvent.fire(EventId.COMPOSITE_RESULT)},send11080:function(t,e){var i={};i.base_id=t,i.num=e,this.SendProtocal(11080,i)},send11079:function(t,e){var i={};i.base_id=Number(t),i.num=e||0,this.SendProtocal(11079,i)},handle11079:function(t){null!=Utils.next(t.list)?0==t.type&&this.openEquipmentAllSynthesisWindow(!0,t):message(Utils.TI18N("\u6682\u65f6\u65e0\u6cd5\u5408\u6210\u4efb\u4f55\u88c5\u5907\u6216\u91d1\u5e01\u4e0d\u8db3"))},send11081:function(t,e){var i={};i.base_id=t,i.num=e||0,this.SendProtocal(11081,i)},handle11081:function(t){message(t.msg),1==t.result&&(this.openEquipmentAllSynthesisWindow(!1),gcore.GlobalEvent.fire(EventId.COMPOSITE_RESULT))},send11082:function(){this.SendProtocal(11082,{})},handle11082:function(t){gcore.GlobalEvent.fire(EventId.COMPOSITE_RECORD,t)},openForgeHouseView:function(e,i){if(e){if(null==this.forgehouse_win){var s=t("forge_house_window");this.forgehouse_win=new s}this.forgehouse_win.open(i)}else this.forgehouse_win&&(this.forgehouse_win.close(),this.forgehouse_win=null)},openEquipmentAllSynthesisWindow:function(t,e){1==t?(null==this.all_synthsis_view&&(this.all_synthsis_view=Utils.createClass("equipment_all_synthesis_window")),this.all_synthsis_view.open(e)):this.all_synthsis_view&&(this.all_synthsis_view.close(),this.all_synthsis_view=null)},openEquipmentCompRecordWindow:function(t){1==t?(null==this.comp_record_view&&(this.comp_record_view=Utils.createClass("equipment_comp_record_window")),this.comp_record_view.open()):this.comp_record_view&&(this.comp_record_view.close(),this.comp_record_view=null)},getForgeHouseRoot:function(){if(this.forgehouse_win)return this.forgehouse_win.root_wnd},getForgeArtifactRoot:function(){if(this.forgehouse_win&&this.forgehouse_win.panel_list)return this.forgehouse_win.panel_list[2].root_wnd}});e.exports=s,cc._RF.pop()},{forge_house_window:"forge_house_window",forgehouse_model:"forgehouse_model"}],forgehouse_item_panel:[function(t,e,i){"use strict";cc._RF.push(e,"7b5859CsxlP+rPxFKlimim9","forgehouse_item_panel");cc.Class({extends:BaseClass,ctor:function(){this.x=0,this.y=0},setParent:function(t){this.parent=t,this.backpack_item=Utils.createClass("backpack_item"),this.backpack_item.setParent(this.parent),this.backpack_item.initConfig(!0,1,!0,!0),this.backpack_item.show(),this.registerEvent()},registerEvent:function(){},show:function(t){},setData:function(t){null!=t&&null!=t.data&&(this.data=t.data,this.is_select=t.is_select,this.is_red=t.is_red,this.backpack_item.setData(this.data.id),1==this.is_select&&this.callback&&this.callback(this),this.backpack_item.setRedStatus(this.is_red))},addCallBack:function(t){this.callback=t,this.backpack_item.addCallBack(function(){t(this)}.bind(this))},setPosition:function(t,e){this.x=t,this.y=e,this.backpack_item.setPosition(t,e)},setExtendData:function(t){},setSelectStatus:function(t){this.is_select=t,this.backpack_item.setMaskVisible(t)},suspendAllActions:function(){},setVisible:function(t){this.backpack_item.setVisible(t)},hide:function(){},deleteMe:function(){this.backpack_item&&this.backpack_item.deleteMe(),this.backpack_item=null}});cc._RF.pop()},{}],forgehouse_model:[function(t,e,i){"use strict";cc._RF.push(e,"35c988PcHlMjabF08enbtUz","forgehouse_model");cc.Class({extends:BaseClass,ctor:function(){},properties:{},initConfig:function(){this.eqm_data_list={}},getBackEquipsData:function(t){if(this.eqm_data_list[t])return this.eqm_data_list[t];this.eqm_data_list[t]=[];var e=Config.partner_eqm_data.data_eqm_compose_id[t];for(var i in e){var s=e[i];this.eqm_data_list[t].push(s)}return this.eqm_data_list[t].sort(function(t,e){return t.id-e.id}),this.eqm_data_list[t]},setCompSendID:function(t){this.comp_send_id=t},getCompSendID:function(){return this.comp_send_id||null}});cc._RF.pop()},{}],form_filter_hero_panel:[function(t,e,i){"use strict";cc._RF.push(e,"f6354Gkh+pPkJ3Ex1H7jJ18","form_filter_hero_panel");t("pathtool"),cc.Class({extends:BasePanel,ctor:function(){},initConfig:function(){},initPanel:function(){},registerEvent:function(){},onShow:function(t){},onHide:function(){},onDelete:function(){}});cc._RF.pop()},{pathtool:"pathtool"}],form_go_fight_window:[function(t,e,i){"use strict";cc._RF.push(e,"5b531fOdCxANoL0hGfqs/1Q","form_go_fight_window");var s=t("pathtool"),n=t("partner_const"),a=t("hero_const"),o=t("hero_event"),l=t("guide_controller"),r=t("guide_event");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("hero","form_go_fight_panel"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Big,this.rleasePrefab=!1,this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){this.camp_btns={},this.nine_station_bg=[],this.pos_name_list={},this.hero_item_list={},this.five_hero_vo={},this.hava_drag_item=!1,this.cur_camp=0,this.cur_role_list=null},openCallBack:function(){this.close_btn_nd=this.seekChild("close_btn"),this.no_vedio_image_nd=this.seekChild("no_vedio_image"),this.mask_nd=this.seekChild("mask"),this.camp_node_nd=this.seekChild("camp_node"),this.camp_layout_nd=this.seekChild("lay_scrollview"),this.img_select_nd=this.seekChild("img_select"),this.save_btn_nd=this.seekChild("save_btn"),this.key_up_btn_nd=this.seekChild("key_up_btn"),this.fight_btn_nd=this.seekChild("fight_btn"),this.form_icon_sp=this.seekChild("form_icon",cc.Sprite),this.form_change_btn_nd=this.seekChild("form_change_btn"),this.move_item_nd=this.seekChild("move_item"),this.main_container_nd=this.seekChild("main_container"),this.halo_icon_sp=this.seekChild("halo_icon",cc.Sprite),this.halo_txt_nd=this.seekChild("halo_txt"),this.halo_effect_sp=this.seekChild("halo_effect",cc.Sprite),this.halo_effect_nd=this.seekChild("halo_effect"),this.halo_btn_nd=this.seekChild("halo_btn"),this.halo_top_nd=this.halo_btn_nd.getChildByName("top_sp"),this.halo_top_num=this.halo_top_nd.getChildByName("top_num_txt").getComponent(cc.Label),this.halo_bottom_nd=this.halo_btn_nd.getChildByName("bottom_sp"),this.halo_bottom_num=this.halo_bottom_nd.getChildByName("bottom_num_txt").getComponent(cc.Label),this.halo_lb=this.halo_btn_nd.getChildByName("halo_txt").getComponent(cc.Label),this.hallow_btn_nd=this.seekChild("hallow_btn"),this.hallow_txt_nd=this.seekChild("hallow_txt"),this.hallow_txt_lb=this.seekChild("hallow_txt",cc.Label),this.hallows_item=ItemsPool.getInstance().getItem("backpack_item"),this.hallows_item.initConfig(!1,1,!1,!1),this.hallows_item.setParent(this.hallow_btn_nd),this.hallows_item.show(),this.background=this.seekChild("background"),this.background.scale=FIT_SCALE,this.power_val_nd=this.seekChild("power_val"),this.power_val_cus=this.power_val_nd.getComponent("CusRichText"),this.power_val_cus.setNum(100);for(var t=0;t<6;t++){this.camp_btns[t]=this.camp_node_nd.getChildByName("camp_btn"+t),this.camp_btns[t].camp_tag=t;var e=this.camp_btns[t].getComponent(cc.Sprite),i=s.getCommonIcomPath("common_"+(90066+t));this.loadRes(i,function(t,e){t.spriteFrame=e}.bind(this,e)),this.camp_btns[t].on(cc.Node.EventType.TOUCH_END,this.didClickCamp,this)}this.fight_hero_node_nd=this.seekChild("fight_hero_node");for(var n=1;n<=9;n++)this.nine_station_bg[n]=this.fight_hero_node_nd.getChildByName("hero_info_21_"+n),this.nine_station_bg[n].camp_tag=n;for(n=1;n<=5;n++)this.hero_item_list[n]=ItemsPool.getInstance().getItem("hero_exhibition_item"),this.hero_item_list[n].setParent(this.fight_hero_node_nd),this.hero_item_list[n].is_allow_select=!1,this.hero_item_list[n].show(),this.hero_item_list[n].addTouchCb(this.onClickHeroItem.bind(this)),this.hero_item_list[n].hero_index=n,this.hero_item_list[n].setExtendData({from_type:a.ExhibitionItemType.eFormFight});this.move_item=ItemsPool.getInstance().getItem("hero_exhibition_item"),this.move_item.setParent(this.move_item_nd),this.move_item.setData(null),this.move_item.show(),this.move_item_nd.active=!1,this.mask_nd.on(cc.Node.EventType.TOUCH_END,this.onClickCloseBtn,this),this.close_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickCloseBtn,this),this.save_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickSaveBtn,this),this.key_up_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickKeyUpBtn,this),this.form_change_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickChangeForm,this),this.fight_hero_node_nd.on(cc.Node.EventType.TOUCH_CANCEL,this.onClickFightHeroNode,this),this.fight_hero_node_nd.on(cc.Node.EventType.TOUCH_MOVE,this.onClickFightHeroNode,this),this.fight_hero_node_nd.on(cc.Node.EventType.TOUCH_END,this.onClickFightHeroNode,this),this.fight_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickFightBtn,this),this.hallows_item.addCallBack(function(){this.onClickHallowsBtn()}.bind(this))},registerEvent:function(){this.create_role_event=this.addGlobalEvent(o.Update_Save_Form,function(t){this.form_show_type==a.FormShowType.eFormFight?this.gotoFight():(message(Utils.TI18N("\u4fdd\u5b58\u5e03\u9635\u6210\u529f")),t&&t.type!=n.Fun_Form.Drama&&t.type!=n.Fun_Form.Arena&&this.onClickCloseBtn())}.bind(this)),this.addGlobalEvent(o.Update_Fun_Form,function(t){t&&this.updateOtherFormation(t)}.bind(this)),this.halo_btn_nd.on("touchend",function(){t("battle_controller").getInstance().openBattleCampView(!0,this.halo_form_id)},this)},closeCallBack:function(){for(var t in this.hero_item_list)this.hero_item_list[t].deleteMe(),this.hero_item_list[t]=null;this.item_scrollview&&(this.item_scrollview.deleteMe(),this.item_scrollview=null),this.move_item&&(this.move_item.deleteMe(),this.move_item=null),this.hallows_item&&(this.hallows_item.deleteMe(),this.hallows_item=null),gcore.GlobalEvent.fire(r.CloseTaskEffect),this.ctrl.openFormGoFightPanel(!1)},openRootWnd:function(t){this.fun_form_type=t.fun_form_type||n.Fun_Form.Drama,this.form_show_type=t.show_type||a.FormShowType.eFormFight,this.setting=t.setting||{},this.initListView(),this.updateCamp(),this.initFormatInfo()},onClickCloseBtn:function(){this.hallows_item&&this.hallows_item.deleteMe(),this.hallows_item=null,this.ctrl.openFormGoFightPanel(!1)},didClickCamp:function(t){var e=t.target.camp_tag;e!==this.cur_camp&&(this.cur_camp=e,this.img_select_nd.parent=this.camp_btns[e],this.updateCamp())},updateCamp:function(){if(this.cur_role_list=this.model.getDeepHeroListByCamp(this.cur_camp),this.fun_form_type==n.Fun_Form.Expedit_Fight){var e=t("heroexpedit_controller").getInstance().getModel().getExpeditEmployData(),i=Config.partner_data.data_partner_base;for(var s in e){var o=e[s];(r={}).bid=o.bid,r.partner_id=o.id+1e5,r.star=o.star,r.power=o.power,r.camp_type=i[o.bid].camp_type,r.rid=o.rid,r.srv_id=o.srv_id,r.is_used=o.is_used,r.lev=o.lev,r.ext_data=o.ext_data,0==o.is_used?this.cur_role_list.unshift(r):this.cur_role_list.push(r)}}else if(this.fun_form_type==n.Fun_Form.EndLess){var l=this.setting.has_hire_list||{};i=Config.partner_data.data_partner_base;for(var s in l){var r,c=i[(o=l[s]).bid];if(0==this.cur_camp||this.cur_camp==c.camp_type)(r={}).bid=o.bid,r.partner_id=o.id+1e5,r.star=o.star,r.power=o.power,r.camp_type=c.camp_type,r.rid=o.rid,r.srv_id=o.srv_id,r.lev=o.lev,r.ext_data=o.ext_data,r.is_endless=!0,this.cur_role_list.unshift(r)}}this.cur_role_list.length>0?this.no_vedio_image_nd.active=!1:this.no_vedio_image_nd.active=!0;var _=null,h=a.ExhibitionItemType.eFormFight;this.fun_form_type==n.Fun_Form.Expedit_Fight?(h=a.ExhibitionItemType.eExpeditFight,_=!0):this.fun_form_type==n.Fun_Form.EndLess&&(h=a.ExhibitionItemType.eEndLessHero),this.item_scrollview.setData(this.cur_role_list,this.onClickHeroExhibiton.bind(this),{can_click:!0,from_type:h,boold_type:_}),this.updateListSelectItem()},initListView:function(){var e=t("common_scrollview"),i=cc.size(this.camp_layout_nd.width,this.camp_layout_nd.height);this.item_scrollview=new e,this.item_scrollview.createScroll(this.camp_layout_nd,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,i,{item_class:"hero_exhibition_item",start_x:0,space_x:4,start_y:0,space_y:0,item_width:150,item_height:136,col:4,once_num:5,need_dynamic:!0},cc.v2(.5,.5)),l.getInstance().isInGuide()&&this.item_scrollview.setClickEnabled(!1)},onClickHeroExhibiton:function(t){t&&(this.is_play_item_action||this.selectHero(t))},didClickFormChangeBtn:function(){},initFormatInfo:function(){if(this.form_show_type==a.FormShowType.eFormSave?(this.key_up_btn_nd.active=!0,this.save_btn_nd.active=!0,this.fight_btn_nd.active=!1):(this.key_up_btn_nd.active=!1,this.save_btn_nd.active=!1,this.fight_btn_nd.active=!0),this.fun_form_type==n.Fun_Form.Drama)this.upateDramaFormation(),this.updateHallowsIcon();else{if(this.fun_form_type==n.Fun_Form.Expedit_Fight)t("heroexpedit_controller").getInstance().sender24409();this.ctrl.sender11211(this.fun_form_type)}},upateDramaFormation:function(){this.is_form_back=!0,this.formation_type=this.model.use_formation_type,this.hallows_id=this.model.use_hallows_id,this.formation_config=Config.formation_data.data_form_data[this.formation_type];var t=this.model.getMyPosList();this.formation_config&&(this.updateFormationStation(this.formation_config),this.updateFiveHeroItem(t,this.formation_config))},updateOtherFormation:function(t){this.formation_type=t.formation_type,this.hallows_id=t.hallows_id,this.formation_config=Config.formation_data.data_form_data[this.formation_type],this.updateFormationStation(this.formation_config),this.updateFiveHeroItem(t.pos_info,this.formation_config),this.updateHallowsIcon(),this.updateCamp()},updateFormationStation:function(t){for(var e in this.nine_station_bg)this.nine_station_bg[e].active=!0;for(var i in t.pos){var s=t.pos[i][0];i=t.pos[i][1];this.pos_name_list[s]=i<=3?1:i>3&&i<=6?2:3,this.hero_item_list[s].setRootPosition(this.nine_station_bg[i].getPosition()),this.nine_station_bg[i].active=!1}this.updateFormationIcon()},updateFiveHeroItem:function(t,e){for(var i in t){var s=this.model.getHeroById(t[i].id);this.five_hero_vo[t[i].pos]=s}for(var n in this.hero_item_list)this.five_hero_vo[n]?this.hero_item_list[n].setData(this.five_hero_vo[n]):this.hero_item_list[n].setData(null);this.updateListSelectItem(),this.updateFightPower()},updateListSelectItem:function(){for(var t in this.five_hero_vo)if(this.five_hero_vo[t]){var e=this.getCurListIndexByParId(this.five_hero_vo[t].partner_id);e>=0&&(this.cur_role_list[e].is_ui_select=!0,this.item_scrollview.updateItemData(e,this.cur_role_list[e]))}},updateFightPower:function(){var t=0;for(var e in this.five_hero_vo)this.five_hero_vo[e]&&(t=t+this.five_hero_vo[e].power||0);this.power_val_cus.setNum(t),this.calculateCampHaloType()},updateFormationIcon:function(){var t=s.getUIIconPath("form","form_icon_"+this.formation_config.type);this.loadRes(t,function(t){this.form_icon_sp.spriteFrame=t}.bind(this))},selectHero:function(e){if(!this.running_move_act){var i=this.cur_role_list[e.tmp_index];if(this.fun_form_type==n.Fun_Form.Expedit_Fight)if(1==(i.is_used||0))return void message(Utils.TI18N("\u96c7\u4f63\u7684\u82f1\u96c4\u53ea\u80fd\u4f7f\u7528\u4e00\u6b21\u54e6"));if(this.fun_form_type==n.Fun_Form.Expedit_Fight)if(t("heroexpedit_controller").getInstance().getModel().getHeroBloodById(i.partner_id,i.rid,i.srv_id)<=0)return;var s=-1;for(var a in this.five_hero_vo)if(this.five_hero_vo[a]&&this.five_hero_vo[a].partner_id===i.partner_id){s=a;break}if(-1!==s){i.is_ui_select=!1,this.hero_item_list[s].setData(null),delete this.five_hero_vo[s];var o=e.getWorldPos(),l=this.hero_item_list[s].getWorldPos();this.playStationAction(i,l,o,function(){this.item_scrollview.updateItemData(e.tmp_index,i),this.updateFightPower()}.bind(this))}else{var r=0;for(var c in this.five_hero_vo)if(this.five_hero_vo[c]){if(i.bid==this.five_hero_vo[c].bid)return void message(Utils.TI18N(Lang.COMMON_HERO));r++}if(r>=5)return void message(Utils.TI18N(Lang.FULL_POS));var _=this.getTheBestPos(i);if(_<0)return void message(Utils.TI18N(Lang.NOT_POS));l=e.getWorldPos(),o=this.hero_item_list[_].getWorldPos();this.playStationAction(i,l,o,function(){this.five_hero_vo[_]=i,i.is_ui_select=!0,this.hero_item_list[_].setData(i),this.item_scrollview.updateItemData(e.tmp_index,i),this.updateFightPower()}.bind(this))}}},playStationAction:function(t,e,i,s){e=this.main_container_nd.convertToNodeSpaceAR(e),i=this.main_container_nd.convertToNodeSpaceAR(i),this.running_move_act=!0,this.move_item.setData(t),this.move_item_nd.setPosition(e),this.move_item_nd.active=!0;var n=cc.moveTo(.15,i),a=cc.callFunc(function(){this.move_item_nd.active=!1,this.running_move_act=!1,s&&s()},this),o=cc.sequence(n,a);this.move_item_nd.runAction(o)},getTheBestPos:function(t){if(3==t.pos_type){for(var e=4;e>0;e--)if(!this.five_hero_vo[e])return e}else if(2==t.pos_type)for(var e in this.pos_name_list)if(t.pos_type==this.pos_name_list[e]&&!this.five_hero_vo[e])return e;for(var e in this.pos_name_list)if(!this.five_hero_vo[e])return e;return-1},onClickSaveBtn:function(){this.onFightDrama()},onClickKeyUpBtn:function(){if(!this.running_move_act){var t=this.model.getDeepHeroListByCamp(a.CampType.eNone);if(0!=t.length){for(var e in this.five_hero_vo)if(this.five_hero_vo[e]){var i=this.getCurListIndexByParId(this.five_hero_vo[e].partner_id);i>=0&&(this.cur_role_list[i].is_ui_select=!1,this.item_scrollview.updateItemData(i,this.cur_role_list[i])),this.hero_item_list[e].setData(null),delete this.five_hero_vo[e]}for(var s=0,n=0;s<5;){var o=t[n];if(this.allocateHeroPos(o)>=0&&s++,++n==t.length)break}this.updateFightPower()}else message(Utils.TI18N(Lang.NO_HERO))}},allocateHeroPos:function(t){for(var e in this.five_hero_vo)if(this.five_hero_vo[e]&&t.bid==this.five_hero_vo[e].bid)return-1;var i=this.getTheBestPos(t);if(i<0)return-1;this.five_hero_vo[i]=t,this.hero_item_list[i].setData(t);var s=this.getCurListIndexByParId(this.five_hero_vo[i].partner_id);return s>=0&&(this.cur_role_list[s].is_ui_select=!0,this.item_scrollview.updateItemData(s,this.cur_role_list[s])),i},saveForm:function(){var t=[],e=0;for(var i in this.five_hero_vo)if(this.five_hero_vo[i]){var s={};s.pos=i,s.id=this.five_hero_vo[i].partner_id,t.push(s),e++}e<=0&&message(Utils.TI18N(Lang.MINIMUM_NUM)),this.ctrl.sender11212(this.fun_form_type,this.formation_type,t,this.hallows_id)},getCurListIndexByParId:function(t){for(var e in this.cur_role_list)if(this.cur_role_list[e].partner_id===t)return e},onClickChangeForm:function(t){this.ctrl.openFormationSelectPanel(!0,this.formation_type,this.updageFormType.bind(this))},updageFormType:function(t){this.formation_type=t,this.formation_config=Config.formation_data.data_form_data[this.formation_type],this.updateFormationStation(this.formation_config)},onClickFightHeroNode:function(t){var e=this.fight_hero_node_nd.convertToNodeSpace(t.touch.getLocation());if(t.type==cc.Node.EventType.TOUCH_CANCEL){var i=this.fight_hero_node_nd.width/3,s=this.fight_hero_node_nd.height/3,n=Math.ceil(e.x/i),a=Math.ceil(e.y/s),o=null;1<=n&&3>=n&&1<=a&&3>=a&&(o=3*(3-n)+a),this.hava_drag_item.hero_index&&(this.selectStation(this.hava_drag_item.hero_index,o,this.hava_drag_data),this.hava_drag_item=null),this.move_item_nd.active=!1}if(t.type===cc.Node.EventType.TOUCH_MOVE&&this.hava_drag_item){var l=this.fight_hero_node_nd.convertToWorldSpaceAR(e),r=this.main_container_nd.convertToNodeSpaceAR(l);this.move_item_nd.active=!0,this.move_item_nd.setPosition(r),this.hava_drag_item.setData(null),this.move_item.setData(this.hava_drag_data)}t.type===cc.Node.EventType.TOUCH_END&&this.hava_drag_item&&(this.move_item_nd.active=!1,this.selectStationHero(this.hava_drag_data),this.hava_drag_item=null)},onClickHeroItem:function(t){t&&(this.hava_drag_item=t,this.hava_drag_data=t.data)},selectStation:function(t,e,i){if(!e){this.five_hero_vo[t]=null,this.hero_item_list[t].setData(this.five_hero_vo[t]);var s=this.getCurListIndexByParId(i.partner_id);return this.cur_role_list[s].is_ui_select=!1,void this.item_scrollview.updateItemData(s,this.cur_role_list[s])}var n=null;for(var a in this.formation_config.pos)if(this.formation_config.pos[a][1]==e){n=this.formation_config.pos[a][0];break}null!==n?this.five_hero_vo[n]?(this.five_hero_vo[t]=this.five_hero_vo[n],this.five_hero_vo[n]=i,this.hero_item_list[t].setData(this.five_hero_vo[t]),this.hero_item_list[n].setData(this.five_hero_vo[n])):(this.five_hero_vo[t]=null,this.five_hero_vo[n]=i,this.hero_item_list[t].setData(this.five_hero_vo[t]),this.hero_item_list[n].setData(this.five_hero_vo[n])):(this.five_hero_vo[t]=i,this.hero_item_list[t].setData(this.five_hero_vo[t]))},selectStationHero:function(t,e,i){var s=-1;for(var n in this.five_hero_vo)this.five_hero_vo[n]&&this.five_hero_vo[n].partner_id===t.partner_id&&(s=n);if(-1!==s){var a=this.getCurListIndexByParId(this.five_hero_vo[s].partner_id),o=this.item_scrollview.getItem(a);a>=0&&(this.cur_role_list[a].is_ui_select=!1);var l=this.hero_item_list[s].getWorldPos();i=o?o.getWorldPos():this.camp_layout_nd.convertToWorldSpaceAR(cc.v2(0,0));this.playStationAction(t,l,i,function(){this.item_scrollview.updateItemData(a,this.cur_role_list[a]),this.updateFightPower()}.bind(this)),this.hero_item_list[s].setData(null),delete this.five_hero_vo[s]}},calculateCampHaloType:function(){var e={};for(var i in this.five_hero_vo)this.five_hero_vo[i]&&(e[this.five_hero_vo[i].camp_type]?e[this.five_hero_vo[i].camp_type]++:e[this.five_hero_vo[i].camp_type]=1);var n=Config.combat_halo_data.data_halo,a=[];for(var o in n){for(var l=n[o],r=!0,c=0;c<l.pos_info.length;++c){var _=l.pos_info[c];e[_[0]]&&e[_[0]]===_[1]||(r=!1)}r&&a.push(l.id)}var h=t("battle_controller").getInstance().getModel().getCampIconConfigByIds(a);this.halo_form_id=a;var d=null;if(h){d=s.getUIIconPath("campicon","campicon_"+h.icon),this.halo_txt_nd.active=!1,this.updateHaloEffect(!0),this.halo_lb.string="",this.halo_top_nd.active=!0;var u=h.nums,m=u[0],f=u[1];null!=m&&m>0?(this.halo_top_num.string=m,this.halo_top_nd.active=!0):this.halo_top_nd.active=!1,null!=f&&f>0?(this.halo_bottom_num.string=f,this.halo_bottom_nd.active=!0):this.halo_bottom_nd.active=!1}else d=s.getUIIconPath("campicon","campicon_1000"),this.halo_txt_nd.active=!0,this.updateHaloEffect(!1),this.halo_lb.string="\u9635\u578b",this.halo_top_nd.active=!1,this.halo_bottom_nd.active=!1;d&&this.loadRes(d,function(t){this.halo_icon_sp.spriteFrame=t}.bind(this))},updateHaloEffect:function(t,e){if(t){this.halo_effect_nd.scale=.8,this.halo_effect_nd.active=!0;var i=s.getUIIconPath("common","common_1101");this.loadRes(i,function(t){this.halo_effect_sp.spriteFrame=t}.bind(this));var n=cc.fadeIn(.6),a=cc.fadeOut(.6),o=cc.sequence(n,a),l=cc.repeatForever(o);this.halo_effect_nd.runAction(l)}else this.halo_effect_nd.active=!1,this.halo_effect_nd.stopAllActions()},onClickHallowsBtn:function(){this.ctrl.openFormHallowsSelectPanel(!0,this.hallows_id,this.updateHallow.bind(this))},updateHallow:function(t){this.hallows_id=t?t.id:0,this.updateHallowsIcon()},updateHallowsIcon:function(){if(0===this.hallows_id)this.hallow_txt_nd.active=!0,this.hallow_txt_lb.string=Utils.TI18N("\u70b9\u51fb\u88c5\u914d"),this.hallows_item.setData(),this.hallows_item.showAddIcon(!0);else{var t=Config.hallows_data.data_base[this.hallows_id];this.hallow_txt_lb.string=Utils.TI18N("\u70b9\u51fb\u66f4\u6362"),this.hallows_item.showAddIcon(!1),this.hallows_item.setData(t.item_id)}},onClickFightBtn:function(t){window.TASK_TIPS&&gcore.GlobalEvent.fire(r.TaskNextStep,"fight_btn");var e=[];for(var i in this.five_hero_vo)if(this.five_hero_vo[i]){var s={};s.pos=i,s.id=this.five_hero_vo[i].partner_id,e.push(s)}e.length<=0?message(Utils.TI18N(Lang.MINIMUM_NUM)):this.fun_form_type==n.Fun_Form.Expedit_Fight?this.onFightExpedit():this.fun_form_type==n.Fun_Form.EndLess?this.onFightEndLess():this.fun_form_type==n.Fun_Form.GuildDun_AD?this.onFightGuildDun(e):this.fun_form_type==n.Fun_Form.LimitExercise?this.onFightLimitExercise():this.onFightDrama(e)},gotoFight:function(){(this.fun_form_type!=n.Fun_Form.LimitExercise&&this.onClickCloseBtn(),this.fun_form_type===n.Fun_Form.Drama)?t("battle_drama_controller").getInstance().send13003(0):this.fun_form_type==n.Fun_Form.Startower&&this.onFightStarTower()},onFightExpedit:function(){var e=[];for(var i in this.five_hero_vo)if(this.five_hero_vo[i]){var s={};s.pos=i,s.owner_id=this.five_hero_vo[i].rid,s.owner_srv_id=this.five_hero_vo[i].srv_id,this.five_hero_vo[i].partner_id>1e5?s.id=this.five_hero_vo[i].partner_id-1e5:s.id=this.five_hero_vo[i].partner_id,e.push(s)}t("heroexpedit_controller").getInstance().sender24403(this.formation_type,e,this.hallows_id),this.onClickCloseBtn()},onFightEndLess:function(){var e=[];for(var i in this.five_hero_vo)if(this.five_hero_vo[i]){var s={};s.pos=i,this.five_hero_vo[i].partner_id>1e5?s.id=this.five_hero_vo[i].partner_id-1e5:s.id=this.five_hero_vo[i].partner_id,s.owner_id=this.five_hero_vo[i].rid,s.owner_srv_id=this.five_hero_vo[i].srv_id,e.push(s)}t("endless_trail_controller").getInstance().send23901(this.formation_type,e,this.hallows_id),this.onClickCloseBtn()},onFightStarTower:function(){var e=this.setting.tower_lev||0;t("startower_controller").getInstance().sender11322(e)},onFightGuildDun:function(e){var i=this.setting.boss_id;t("guildboss_controller").getInstance().send21308(i,this.formation_type,e,this.hallows_id),this.onClickCloseBtn()},onFightDrama:function(){var t=[];for(var e in this.five_hero_vo)if(this.five_hero_vo[e]){var i={};i.pos=e,i.id=this.five_hero_vo[e].partner_id,t.push(i)}t.length<=0?message(Utils.TI18N(Lang.MINIMUM_NUM)):this.ctrl.sender11212(this.fun_form_type,this.formation_type,t,this.hallows_id)},onFightLimitExercise:function(){var t=[];for(var e in this.five_hero_vo)if(this.five_hero_vo[e]){var i={};i.pos=e,i.id=this.five_hero_vo[e].partner_id,t.push(i)}t.length<=0?message(Utils.TI18N(Lang.MINIMUM_NUM)):this.ctrl.sender11212(n.Fun_Form.LimitExercise,this.formation_type,t,this.hallows_id)}});cc._RF.pop()},{battle_controller:"battle_controller",battle_drama_controller:"battle_drama_controller",common_scrollview:"common_scrollview",endless_trail_controller:"endless_trail_controller",guide_controller:"guide_controller",guide_event:"guide_event",guildboss_controller:"guildboss_controller",hero_const:"hero_const",hero_event:"hero_event",heroexpedit_controller:"heroexpedit_controller",partner_const:"partner_const",pathtool:"pathtool",startower_controller:"startower_controller"}],form_hallows_select_item:[function(t,e,i){"use strict";cc._RF.push(e,"162a7f0gqRGfIP04qSi1Oeu","form_hallows_select_item");var s=t("pathtool"),n=t("backpack_const"),a=t("hallows_controller");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("hero","form_hallows_select_item")},initConfig:function(){this.select_cb=null},initPanel:function(){this.look_btn_nd=this.seekChild("look_btn"),this.comfirm_btn_nd=this.seekChild("comfirm_btn"),this.cancel_btn_nd=this.seekChild("cancel_btn"),this.btn_title_lb=this.seekChild("btn_title",cc.Label),this.hallow_icon_nd=this.seekChild("hallow_icon"),this.hallow_lock_nd=this.seekChild("hallow_lock"),this.item_icon=ItemsPool.getInstance().getItem("backpack_item"),this.item_icon.initConfig(!1,1,!1,!1),this.item_icon.setParent(this.hallow_icon_nd),this.item_icon.show(),this.hallow_name_lb=this.seekChild("hallow_name",cc.Label),this.hallow_name_nd=this.seekChild("hallow_name"),this.hallow_des_lb=this.seekChild("hallow_des",cc.Label),this.open_txt_nd=this.seekChild("open_txt"),this.look_btn_nd.active=!1,this.hallow_lock_nd.active=!1,this.comfirm_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickComfirmBtn,this),this.cancel_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickCancelBtn,this),this.look_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickLookBtn,this)},registerEvent:function(){this.look_btn_nd.on("click",function(){Utils.playButtonSound(1),a.getInstance().openHallowsTips(!0,this.hallow_cfg.id)},this)},onShow:function(t){this.updateWidgets()},onHide:function(){},onDelete:function(){this.item_icon&&this.item_icon.deleteMe(),this.item_icon=null},setData:function(t){this.hallow_vo=t.hallow_vo,this.hallow_cfg=t.hallow_cfg},addCallBack:function(t){this.select_cb=t},updateWidgets:function(){var t=gdata("item_data","data_unit1",this.hallow_cfg.item_id,!1);this.item_icon.setData(this.hallow_cfg.item_id);var e,i=null;this.hallow_vo?(i=this.hallow_cfg.id+"_"+this.hallow_vo.skill_lev,e=this.hallow_vo.step):(i=this.hallow_cfg.id+"_1",e=1);var s=cc.js.formatStr("%s (%s%s)",this.hallow_cfg.name,e,Utils.TI18N("\u7ea7"));this.hallow_name_lb.string=s;var a=n.quality_color(t.quality),o=this.hallow_name_nd.color;cc.log(a),o.fromHEX(a),this.hallow_name_nd.color=o;var l=gdata("hallows_data","data_skill_up",i),r=gdata("skill_data","data_get_skill",l.skill_bid);this.hallow_des_lb.string=r?r.des:Utils.TI18N("\u8be5\u795e\u5668\u6ca1\u6709\u6280\u80fd"),this.item_icon.setItemIconUnEnabled(!this.hallow_vo),this.hallow_vo?(this.look_btn_nd.active=!0,this.hallow_lock_nd.active=!1,this.open_txt_nd.active=!1,this.hallow_vo.is_equip?(this.comfirm_btn_nd.active=!1,this.cancel_btn_nd.active=!0):(this.comfirm_btn_nd.active=!0,this.cancel_btn_nd.active=!1)):(this.hallow_lock_nd.active=!0,this.comfirm_btn_nd.active=!1,this.cancel_btn_nd.active=!1,this.look_btn_nd.active=!1)},onClickComfirmBtn:function(){Utils.playButtonSound(1),this.select_cb&&this.select_cb(this.hallow_vo)},onClickCancelBtn:function(){Utils.playButtonSound(1),this.select_cb&&this.select_cb(null)},onClickLookBtn:function(){if(this.hallow_vo){var e=t("hallows_controller"),i=e.getInstance().getModel().makeHighestHallowVo(this.hallow_vo.id);e.getInstance().openHallowsTips(!0,i)}}});cc._RF.pop()},{backpack_const:"backpack_const",hallows_controller:"hallows_controller",pathtool:"pathtool"}],form_hallows_select_window:[function(t,e,i){"use strict";cc._RF.push(e,"85c9aLJKUlEXaIzFYQUR/yQ","form_hallows_select_window");var s=t("pathtool");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("hero","form_hallows_select_panel"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Full,this.ctrl=arguments[0]},initConfig:function(){var e=t("hallows_controller");this.hallows_model=e.getInstance().getModel()},openCallBack:function(){this.background_nd=this.seekChild("background"),this.items_container=this.seekChild("items_container"),this.background_nd.scale=FIT_SCALE,this.background_nd.on(cc.Node.EventType.TOUCH_END,this.onClickCloseBtn,this),this.initListView()},registerEvent:function(){},closeCallBack:function(){},openRootWnd:function(t){this.hallows_id=t.hallows_id,this.select_cb=t.callback,this.updateWidgets()},testFunction:function(){return this.testData},initListView:function(){var e=t("common_scrollview"),i=t("form_hallows_select_item"),s=cc.size(this.items_container.width,this.items_container.height),n={item_class:i,start_x:0,space_x:4,start_y:0,space_y:0,item_width:630,item_height:150,col:1,once_num:5,need_dynamic:!0};this.item_scrollview=new e,this.item_scrollview.createScroll(this.items_container,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,s,n,cc.v2(.5,.5))},onClickCloseBtn:function(){this.ctrl.openFormHallowsSelectPanel(!1)},updateWidgets:function(){var t=[],e=Config.hallows_data.data_base;for(var i in e){var s={},n=e[i],a=this.hallows_model.getHallowsById(n.id);a&&(this.hallows_id==a.id?a.is_equip=!0:a.is_equip=!1),s.hallow_cfg=n,s.hallow_vo=a,t.push(s)}this.item_scrollview.setData(t,this.onClickHeroExhibiton.bind(this),{can_click:!0})},onClickHeroExhibiton:function(t){this.select_cb&&this.select_cb(t),this.ctrl.openFormHallowsSelectPanel(!1)}});cc._RF.pop()},{common_scrollview:"common_scrollview",form_hallows_select_item:"form_hallows_select_item",hallows_controller:"hallows_controller",pathtool:"pathtool"}],form_select_panel:[function(t,e,i){"use strict";cc._RF.push(e,"744f6w7M7VHnaBcTfBcVGja","form_select_panel");var s=t("pathtool");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("hero","formation_select_panel"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Full,this.ctrl=arguments[0],this.model=this.ctrl.getModel();var e=t("role_controller");this.role_vo=e.getInstance().getRoleVo()},initConfig:function(){for(var t in this.formaiton_cfg=Config.formation_data.data_form_data,this.item_cfgs=[],this.formaiton_cfg)this.item_cfgs.push(this.formaiton_cfg[t]);this.item_cfgs.sort(function(t,e){return t.order-e.order}),this.form_items={},this.cur_select_item=null,this.new_select_type=null},openCallBack:function(){this.comfirm_btn_nd=this.seekChild("comfirm_btn"),this.from_content_nd=this.seekChild("form_content"),this.form_item=this.seekChild("form_item"),this.background_nd=this.seekChild("background"),this.background_nd.scale=FIT_SCALE;for(var t=0;t<6;t++)this.form_items[t]||(this.form_items[t]=cc.instantiate(this.form_item),this.from_content_nd.addChild(this.form_items[t]),this.form_items[t].y=0,this.form_items[t].form_tag=t,this.form_items[t].on(cc.Node.EventType.TOUCH_END,this.onClickFromItem,this));this.comfirm_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickConfirmBtn,this),this.background_nd.on(cc.Node.EventType.TOUCH_END,this.onClickBackground,this)},registerEvent:function(){},openRootWnd:function(t){this.cur_form_type=t.formation_type,this.selent_cb=t.callback,this.updageWidget()},closeCallBack:function(){},updageWidget:function(){for(var t=0;t<this.item_cfgs.length;t++){var e=this.item_cfgs[t],i=this.form_items[t];this.seekChild(i,"form_name",cc.Label).string=e.name;var n=this.seekChild(i,"form_lock"),a=!1;e.need_lev>this.role_vo.lev?(n.active=!0,a=!0):n.active=!1;var o=this.seekChild(i,"form_select_icon"),l=this.seekChild(i,"cur_tag");this.cur_form_type==e.type?(o.active=!0,l.active=!0,this.cur_select_item=i):(o.active=!1,l.active=!1);var r=s.getUIIconPath("form","form_icon_"+e.type);this.loadRes(r,function(t,e,i){var s=this.seekChild(t,"form_icon",cc.Sprite);s.spriteFrame=i,e?s.setMaterial(0,cc.Material.getBuiltinMaterial("2d-gray-sprite")):s.setMaterial(0,cc.Material.getBuiltinMaterial("2d-sprite"))}.bind(this,i,a));var c=this.seekChild(i,"form_lv",cc.Label);if(c){var _=cc.js.formatStr("%s%s",e.need_lev,Utils.TI18N("\u89e3\u9501"));c.string=_,c.node.active=!!a}}},onClickFromItem:function(t){var e=this.item_cfgs[t.target.form_tag];e.type!==this.new_select_type&&(e.need_lev>this.role_vo.lev?message(e.need_lev+Utils.TI18N("\u7ea7\u89e3\u9501")):(this.seekChild(this.cur_select_item,"form_select_icon").active=!1,this.cur_select_item=t.target,this.seekChild(this.cur_select_item,"form_select_icon").active=!0,this.new_select_type=e.type))},onClickConfirmBtn:function(){this.ctrl.openFormationSelectPanel(!1),null!==this.new_select_type&&this.new_select_type!==this.cur_form_type&&this.selent_cb&&this.selent_cb(this.new_select_type)},onClickBackground:function(){this.ctrl.openFormationSelectPanel(!1)}});cc._RF.pop()},{pathtool:"pathtool",role_controller:"role_controller"}],friend_add_window:[function(t,e,i){"use strict";cc._RF.push(e,"8f12clNRplDypP98v6Mecs5","friend_add_window");var s=t("friend_event"),n=t("pathtool"),a=t("friend_controller"),o=t("common_scrollview"),l=t("friend_list_item"),r=t("friend_const"),c=cc.Class({extends:BaseView,ctor:function(){this.prefabPath=n.getPrefabPath("friend","friend_find_panel"),this.ctrl=a.getInstance(),this.win_type=WinType.Big,this.scroll_width=624,this.scroll_height=570,this.create_index=1,this.rend_list=new Array,this.cache_list={},this.is_init=!1},openCallBack:function(){this.background=this.seekChild("background"),this.background.scale=FIT_SCALE,this.main_container=this.root_wnd.getChildByName("main_container"),this.panel=this.main_container.getChildByName("panel"),this.container=this.panel.getChildByName("container"),this.main_panel=this.container.getChildByName("main_panel"),this.top_panel=this.main_panel.getChildByName("top_panel"),this.recommend_label=this.top_panel.getChildByName("recommend_label").getComponent(cc.Label),this.close_btn=this.panel.getChildByName("close_btn"),this.scroll_con=this.main_panel.getChildByName("scroll_con"),this.find_btn=this.top_panel.getChildByName("find_btn"),this.edit_box=this.top_panel.getChildByName("edit_box").getComponent(cc.EditBox),this.edit_box.node.on("editing-return",function(t){t.string},this),this.flash_btn=this.main_panel.getChildByName("flash_btn"),this.num_label=this.main_panel.getChildByName("rich_text").getComponent(cc.RichText);var t=this.ctrl.getModel().getBlackListOnlineAndTotal().total_num,e=Utils.TI18N("\u597d\u53cb\u6570\uff1a")+t+"/100";this.num_label.string=e;var i=cc.size(this.scroll_width,this.scroll_height),s={item_class:l,start_x:0,space_x:0,start_y:0,space_y:2,item_width:624,item_height:114,row:0,col:1,once_num:1,item_obj:{open_type:5},need_dynamic:!0};this.item_scrollview=new o,this.item_scrollview.createScroll(this.scroll_con,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,i,s,cc.v2(.5,.5))},registerEvent:function(){this.close_btn.on(cc.Node.EventType.TOUCH_END,function(t){a.getInstance().openFriendFindWindow(!1)},this),this.apply_list_event||(this.apply_list_event=gcore.GlobalEvent.bind(s.UD_COMMEND_LIST,function(t){this.updateFriendList(t)}.bind(this))),this.find_friend_event||(this.find_friend_event=gcore.GlobalEvent.bind(s.FRIEND_QUERY_RESULT,function(t){this.recommend_label.string="\u641c\u7d22\u7ed3\u679c",this.updateFriendList(t)}.bind(this))),this.flash_btn.on(cc.Node.EventType.TOUCH_END,function(t){this.ctrl.recommend(),this.recommend_label.string="\u63a8\u8350\u597d\u53cb"}.bind(this),this),this.find_btn.on(cc.Node.EventType.TOUCH_END,function(t){var e=this.edit_box.string||"";this.ctrl.queryFind(e)}.bind(this),this),this.ctrl.recommend()},showEmptyIcon:function(t){if(this.empty_con||0!=t){if(!this.empty_con){var e=cc.size(200,200);this.empty_con=new cc.Node,this.empty_con.setContentSize(e),this.empty_con.setAnchorPoint(cc.v2(.5,.5)),this.empty_con.setPosition(cc.v2(0,0)),this.main_panel.addChild(this.empty_con);var i=n.getBigBg("bigbg_3");this.empty_bg=Utils.createImage(this.empty_con,null,0,0,cc.v2(.5,.5),!1),this.loadRes(i,function(t){this.empty_bg.spriteFrame=t}.bind(this)),this.empty_label=Utils.createLabel(26,new cc.Color(104,69,42,255),null,0,-100,"",this.empty_con,0,cc.v2(.5,.5))}var s=Utils.TI18N("\u672a\u641c\u7d22\u5230\u73a9\u5bb6");this.empty_label.string=s,this.empty_con.active=t}},openRootWnd:function(t){t=t||r.Type.MyFriend},closeCallBack:function(){for(var t in this.ctrl.openFriendFindWindow(!1),this.setscheduleUpdate(!1),this.cache_list){var e=this.cache_list[t];e&&e.DeleteMe&&(e.DeleteMe(),e=null)}this.cache_list=null,this.apply_list_event&&(gcore.GlobalEvent.unbind(this.apply_list_event),this.apply_list_event=null),this.find_friend_event&&(gcore.GlobalEvent.unbind(this.find_friend_event),this.find_friend_event=null),this.item_scrollview&&this.item_scrollview.DeleteMe(),this.item_scrollview=null,this.empty_con&&(this.empty_con.destroy(),this.empty_label.destroy(),this.empty_bg.destroy(),this.empty_con=null,this.empty_bg=null,this.empty_label=null)},updateFriendList:function(t){for(var e in this.cache_list)this.cache_list[e];this.create_index=1;var i=new Array;for(var e in t)i.push(t[e]);this.rend_list=i||[],this.showEmptyIcon(!1),i.length<=0&&this.showEmptyIcon(!0),1==this.is_init&&(this.is_init=!1),this.item_scrollview.setData(i)},setscheduleUpdate:function(t){1==t?null==this.queue_timer&&(this.queue_timer=gcore.Timer.set(function(){var t=this.rend_list[this.create_index-1];t&&this.createItem(t),this.create_index>=this.rend_list.length+1&&this.setscheduleUpdate(!1)}.bind(this),1/60,-1)):null!=this.queue_timer&&(gcore.Timer.del(this.queue_timer),this.queue_timer=null)},createItem:function(t){var e=null;null==this.cache_list[this.create_index]&&(e=new l(this.create_index,5),this.cache_list[this.create_index]=e,this.scroll_view.addChild(e)),e=this.cache_list[this.create_index];this.scroll_height,this.create_index;this.create_index=this.create_index+1}});e.exports=c,cc._RF.pop()},{common_scrollview:"common_scrollview",friend_const:"friend_const",friend_controller:"friend_controller",friend_event:"friend_event",friend_list_item:"friend_list_item",pathtool:"pathtool"}],friend_apply_panel:[function(t,e,i){"use strict";cc._RF.push(e,"7369f/rZOBHp4j3xsC0Ox1e","friend_apply_panel");var s=t("pathtool"),n=t("friend_controller"),a=cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("friend","friend_apply_panel"),this.ctrl=n.getInstance(),this.size=cc.size(720,800),this.item_list={}},initPanel:function(){this.root_wnd.setContentSize(this.size),this.main_panel=this.root_wnd.getChildByName("main_panel"),this.num_label=this.main_panel.getChildByName("rich_text").getComponent(cc.RichText),null!=this.num&&this.setApplyNum(this.num)},registerEvent:function(){},setData:function(t){null!=t&&(this.data=t,null!=this.root_wnd&&this.onShow())},setApplyNum:function(t){null!=this.root_wnd?(t=t||0,this.num_label.string=cc.js.formatStr(Utils.TI18N("\u7533\u8bf7\u6570\uff1a%s/%s"),t,99)):this.num=t},setCallFun:function(t){this.call_fun=t},setVisibleStatus:function(t){null!=this.root_wnd&&(this.root_wnd.active=t)},closeCallBack:function(){}});e.exports=a,cc._RF.pop()},{friend_controller:"friend_controller",pathtool:"pathtool"}],friend_award_panel:[function(t,e,i){"use strict";cc._RF.push(e,"5123dYrcXhM0J8vML/avbrz","friend_award_panel");var s=t("pathtool"),n=t("friend_controller"),a=t("role_controller"),o=cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("friend","friend_award_panel"),this.ctrl=n.getInstance(),this.size=cc.size(720,800),this.item_list={}},initPanel:function(){this.root_wnd.setContentSize(this.size),this.main_panel=this.root_wnd.getChildByName("main_panel"),this.cost_panel=this.main_panel.getChildByName("cost_panel"),this.friend_point=this.cost_panel.getChildByName("num_label").getComponent(cc.Label),this.num_label=this.main_panel.getChildByName("rich_text").getComponent(cc.RichText),this.btn_send=this.main_panel.getChildByName("btn_send")},registerEvent:function(){this.btn_send.on(cc.Node.EventType.TOUCH_END,function(){for(var t=[],e=this.ctrl.getModel().getArray(),i=0;i<e.length;i++){var s=e[i];s&&1==s.is_draw&&t.push({rid:s.rid,srv_id:s.srv_id})}this.ctrl.sender_13317(1,t)}.bind(this))},setData:function(t){null!=t&&(this.data=t,this.root_wnd&&this.onShow())},setFriendPoint:function(){var t=a.getInstance().getRoleVo().friend_point||0;this.friend_point.string=t},onShow:function(){var t=0;if(this.data&&Utils.next(this.data))for(var e in this.data){var i=this.data[e];i&&1==i.is_draw&&(t+=1)}var s=Utils.TI18N("\u793c\u7269\u6570\uff1a")+t,n=Config.color_data.data_color16[156];this.num_label.string="<color="+n+">"+s+"</c>",this.setFriendPoint()},setCallFun:function(t){this.call_fun=t},setVisibleStatus:function(t){null!=this.root_wnd&&(this.root_wnd.active=t)},openRootWnd:function(){},closeCallBack:function(){}});e.exports=o,cc._RF.pop()},{friend_controller:"friend_controller",pathtool:"pathtool",role_controller:"role_controller"}],friend_black_panel:[function(t,e,i){"use strict";cc._RF.push(e,"bc78d2jQcZJH6aRp05pzfXJ","friend_black_panel");var s=t("pathtool"),n=t("friend_controller"),a=cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("friend","friend_black_panel"),this.ctrl=n.getInstance(),this.size=cc.size(720,800),this.item_list={}},initPanel:function(){this.root_wnd.setContentSize(this.size),this.main_panel=this.root_wnd.getChildByName("main_panel"),this.num_label=this.main_panel.getChildByName("rich_text").getComponent(cc.RichText)},registerEvent:function(){},setData:function(t){null!=t&&(this.data=t,null!=this.root_wnd&&this.onShow())},onShow:function(){if(null!=this.num_label){var t=this.ctrl.getModel().getBlackListOnlineAndTotal().total_num;this.num_label.string=cc.js.formatStr(Utils.TI18N("\u9ed1\u540d\u5355\u6570\uff1a%s/%s"),t,50)}},setCallFun:function(t){this.call_fun=t},setVisibleStatus:function(t){null!=this.root_wnd&&(this.root_wnd.active=t)},openRootWnd:function(){},closeCallBack:function(){}});e.exports=a,cc._RF.pop()},{friend_controller:"friend_controller",pathtool:"pathtool"}],friend_check_info_winodw:[function(t,e,i){"use strict";cc._RF.push(e,"9dba3YeOMhNGIl+Q+tytrf5","friend_check_info_winodw");var s=t("pathtool"),n=t("friend_const"),a=t("role_event"),o=t("playerhead"),l=t("role_controller"),r=t("hero_vo"),c=t("battle_controller"),_=t("chat_controller"),h=t("chat_const"),d=cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("friend","friend_check_info");var e=t("friend_controller");this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Mini,this.ctrl=e.getInstance(),this.model=this.ctrl.getModel(),this.item_list={}},openCallBack:function(){this.main_panel=this.root_wnd.getChildByName("main_panel"),this.close_btn=this.main_panel.getChildByName("close_btn"),this.friend_btn=this.main_panel.getChildByName("friend_btn"),this.black_btn=this.main_panel.getChildByName("black_btn"),this.pk_btn=this.main_panel.getChildByName("pk_btn"),this.pk_btn_label=this.pk_btn.getChildByName("Label").getComponent(cc.Label),this.friend_btn_label=this.friend_btn.getChildByName("Label").getComponent(cc.Label),this.black_btn_label=this.black_btn.getChildByName("Label").getComponent(cc.Label),this.report_btn=this.main_panel.getChildByName("report_btn"),this.pk_btn_label.string=Utils.TI18N("\u5207\u78cb"),this.background=this.seekChild("background"),this.background.scale=FIT_SCALE,this.info_con=this.main_panel.getChildByName("info_con"),this.name_lb=this.info_con.getChildByName("name").getComponent(cc.Label),this.rank_lb=this.info_con.getChildByName("rank").getComponent(cc.Label),this.rank_lb.string=Utils.TI18N("\u6682\u65e0"),this.guild_lb=this.info_con.getChildByName("guild").getComponent(cc.Label),this.guild_lb.string=Utils.TI18N("\u6682\u65e0"),this.glory_btn=this.info_con.getChildByName("glory_btn"),this.at_btn=this.info_con.getChildByName("at_btn"),this.at_btn.active=!1,this.country=this.info_con.getChildByName("country"),this.main_container=this.main_panel.getChildByName("main_container"),null==this.head&&(this.head=new o,this.head.setParent(this.info_con),this.head.show(),this.head.setPosition(-227,50)),this.vip_label_cr=this.seekChild(this.main_panel,"vip_label").getComponent("CusRichText"),this.fight_label_cr=this.seekChild(this.main_container,"fight_label").getComponent("CusRichText"),this.scrollCon_nd=this.seekChild("scrollCon"),this.scrollCon_content_nd=this.seekChild(this.scrollCon_nd,"content"),this.scroll_view_size=this.scrollCon_nd.getContentSize(),this.scroll_view_sv=this.scrollCon_nd.getComponent(cc.ScrollView)},registerEvent:function(){this.close_btn&&this.close_btn.on(cc.Node.EventType.TOUCH_END,function(){this.ctrl.openFriendCheckPanel(!1),Utils.playButtonSound(2)}.bind(this)),this.glory_btn&&this.glory_btn.on(cc.Node.EventType.TOUCH_END,function(){Utils.playButtonSound(1),this.ctrl.openFriendGloryWindow(!0,this.data)}.bind(this)),this.friend_btn&&this.friend_btn.on(cc.Node.EventType.TOUCH_END,function(){Utils.playButtonSound(1),this.model.isFriend(this.data.srv_id,this.data.rid)?(_.getInstance().openChatPanel(h.Channel.Friend,"friend",this.data),this.ctrl.openFriendCheckPanel(!1)):(this.ctrl.openFriendCheckPanel(!1),this.ctrl.addOther(this.data.srv_id,this.data.rid))}.bind(this)),this.pk_btn&&this.pk_btn.on(cc.Node.EventType.TOUCH_END,function(){Utils.playButtonSound(1),this.data&&(c.getInstance().getWatchReplayStatus()||c.getInstance().getModel().getFightStatus()?message(Utils.TI18N("\u6b63\u5728\u89c2\u770b\u5f55\u50cf\u6216\u8005\u5207\u78cb\u4e2d,\u8bf7\u5148\u9000\u51fa")):c.getInstance().csBattlePk(this.data.rid,this.data.srv_id))}.bind(this)),this.black_btn&&this.black_btn.on(cc.Node.EventType.TOUCH_END,function(){Utils.playButtonSound(1),this.model.isBlack(this.data.rid,this.data.srv_id)?(_.getInstance().closeChatPanel(),this.ctrl.openFriendCheckPanel(!1),this.ctrl.openFriendWindow(!0,n.Type.BlackList)):(this.ctrl.addToBlackList(this.data.rid,this.data.srv_id),this.ctrl.openFriendCheckPanel(!1))}.bind(this)),this.report_btn&&this.report_btn.on("click",function(){Utils.playButtonSound(1),this.onClickReportBtn()}.bind(this)),cc.log(this.updateEvent,"this.updateEvent"),null==this.updateEvent&&(this.updateEvent=gcore.GlobalEvent.bind(a.DISPATCH_PLAYER_VO_EVENT,function(t){t.rid==this.rid&&t.srv_id==this.srv_id&&this.updateData(t)}.bind(this))),this.at_btn&&this.at_btn.on(cc.Node.EventType.TOUCH_END,function(){Utils.playButtonSound(1),this.data&&this.data.name&&(_.getInstance().chatAtPeople(this.data.name,this.data.srv_id),this.ctrl.openFriendCheckPanel(!1))}.bind(this))},openRootWnd:function(t){null!=t&&(this.rid=t.rid,this.srv_id=t.srv_id,this.flag=t.flag,this.channel=t.channel,t&&null!=t.rid&&null!=t.srv_id&&l.getInstance().requestRoleInfo(t.rid,t.srv_id),t.channel&&(this.at_btn.active=!0))},updateData:function(t){this.data=t,this.name_lb.string=Utils.transformNameByServ(t.name,t.srv_id),this.country.x=this.name_lb.node.x+this.name_lb.node.width+5,this.head.setHeadRes(t.face_id),this.head.setLev(t.lev),this.head.setSex(t.sex,cc.v2(20,-50)),""!=t.gname&&(this.guild_lb.string=t.gname);var e=gdata("avatar_data","data_avatar",[t.avatar_bid]);if(e){var i=e.res_id||0,n=s.getHeadcircle(i);this.head.setFrameRes(n)}this.vip_label_cr.setNum(t.vip_lev),this.fight_label_cr.setNum(t.power),this.model.isFriend(t.srv_id,t.rid)?this.friend_btn_label.string=Utils.TI18N("\u79c1\u804a"):this.friend_btn_label.string=Utils.TI18N("\u52a0\u4e3a\u597d\u53cb"),this.model.isBlack(t.rid,t.srv_id)?this.black_btn_label.string=Utils.TI18N("\u9ed1\u540d\u5355"):this.black_btn_label.string=Utils.TI18N("\u52a0\u9ed1\u540d\u5355"),this.createPartnerList(t.partner_list)},createPartnerList:function(e){var i=[];for(var s in e){var n=e[s],a=new r;a.updateHeroVo(n),i.push(a)}var o=i.length,l=104*o+6*(o-1),c=null,_=Math.max(l,this.scroll_view_size.width);this.scrollCon_content_nd.setContentSize(cc.size(_,this.scroll_view_size.height));for(var h=0;h<i.length;++h){n=i[h];null==this.item_list[h]&&((c=ItemsPool.getInstance().getItem("hero_exhibition_item")).setRootScale(.8),c.show(),c.setPosition(60+110*h,.5*this.scroll_view_size.height),c.setData(n),c.setParent(this.scrollCon_content_nd),this.item_list[h]=c,c.addCallBack(function(e){var i=e.getData();if(i&&null!=Utils.next(i)){var s=i.partner_id;0==s&&(s=i.id);var n=this.data.rid,a=this.data.srv_id;t("look_controller").getInstance().sender11061(n,a,s)}}.bind(this)))}},onClickReportBtn:function(){if(this.data){var t=Config.role_data.data_role_const.role_reported_lev_limit,e=(l.getInstance().getRoleVo()||{}).lev||0;t&&e<t.val?message(t.val+Utils.TI18N("\u7ea7\u5f00\u653e\u4e3e\u62a5\u529f\u80fd")):l.getInstance().openRoleReportedPanel(!0,this.data.rid,this.data.srv_id,this.data.name)}},closeCallBack:function(){for(var t in this.item_list){var e=this.item_list[t];e.deleteMe(),e=null}this.item_list=null,this.head&&this.head.deleteMe(),this.head=null,this.updateEvent&&(gcore.GlobalEvent.unbind(this.updateEvent),this.updateEvent=null),this.ctrl.openFriendCheckPanel(!1)}});e.exports=d,cc._RF.pop()},{battle_controller:"battle_controller",chat_const:"chat_const",chat_controller:"chat_controller",friend_const:"friend_const",friend_controller:"friend_controller",hero_vo:"hero_vo",look_controller:"look_controller",pathtool:"pathtool",playerhead:"playerhead",role_controller:"role_controller",role_event:"role_event"}],friend_const:[function(t,e,i){"use strict";var s;function n(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}cc._RF.push(e,"ba6c6J8nMNO2r2ExY5r4YCa","friend_const");var a={Type:{MyFriend:1,Award:2,ApplyList:3,BlackList:4},FriendGroupType:{friend:1,cross_friend:2,black_list:3},FriendGroupName:(s={},n(s,1,"\u6211\u7684\u597d\u53cb"),n(s,2,"\u8de8\u670d\u597d\u53cb"),n(s,3,"\u9ed1\u540d\u5355"),s)};e.exports=a,cc._RF.pop()},{}],friend_controller:[function(t,e,i){"use strict";cc._RF.push(e,"4c2f604RNdJoLI/CXIn0Qv+","friend_controller");var s=t("friend_event"),n=t("role_controller"),a=t("friend_vo"),o=(s=t("friend_event"),t("friend_check_info_winodw")),l=t("friend_const"),r=t("chat_controller"),c=cc.Class({extends:BaseController,ctor:function(){},initConfig:function(){var e=t("friend_model");this.model=new e,this.model.initConfig()},getModel:function(){return this.model},registerEvents:function(){null==this.login_success&&(this.login_success=gcore.GlobalEvent.bind(EventId.EVT_ROLE_CREATE_SUCCESS,function(){this.friendList(),this.time_ticket&&(gcore.Timer.del(this.time_ticket),this.time_ticket=null),this.time_ticket=gcore.Timer.set(function(){this.updateFriendTishi()}.bind(this),60,1)},this)),this.request_event||(this.request_event=gcore.GlobalEvent.bind(s.REQUEST_LIST,function(){this.friendList(),this.getBlackList()},this)),this.add_event||(this.add_event=gcore.GlobalEvent.bind(s.FRIEND_ADD,function(t,e){this.addOther(t,e)},this)),this.query_event||(this.query_event=gcore.GlobalEvent.bind(s.FRIEND_QUERY_FIND,function(t){this.queryFind(t)},this)),this.recommend_event||(this.recommend_event=gcore.GlobalEvent.bind(s.FRIEND_RECOMMEND,function(){this.recommend()},this)),this.infom_event||(this.infom_event=gcore.GlobalEvent.bind(s.OPEN_FRIEND_INFOM,function(t,e,i,s){this.openInfom(t,e,i,s)},this)),this.private_msg||(this.private_msg=gcore.GlobalEvent.bind(EventId.CHAT_UPDATE_SELF,function(t){this.addPrivateMsg(t)},this)),this.update_chat_and_apply_event||(this.update_chat_and_apply_event=gcore.GlobalEvent.bind(s.UPDATE_COUNT,function(){this.updateFriendTishi()},this))},registerProtocals:function(){this.RegisterProtocal(13300,this.friendListHandler),this.RegisterProtocal(13301,this.onlineHandler),this.RegisterProtocal(13302,this.friendStateHandler),this.RegisterProtocal(13303,this.addOtherHandler),this.RegisterProtocal(13304,this.addMeHandler),this.RegisterProtocal(13305,this.acceptHandler),this.RegisterProtocal(13306,this.batchAddHandler),this.RegisterProtocal(13307,this.delOtherHandler),this.RegisterProtocal(13308,this.delMeHandler),this.RegisterProtocal(13310,this.addToListHandler),this.RegisterProtocal(13311,this.applyListHandler),this.RegisterProtocal(13312,this.refuseApplyListHandler),this.RegisterProtocal(13314,this.queryFindHandler),this.RegisterProtocal(13315,this.queryFriendTeamHandler),this.RegisterProtocal(13316,this.strengthHandler),this.RegisterProtocal(13317,this.batchStrengthHandler),this.RegisterProtocal(13320,this.recommendHandler),this.RegisterProtocal(10388,this.getRolesOnline),this.RegisterProtocal(13330,this.handle13330),this.RegisterProtocal(13331,this.handle13331),this.RegisterProtocal(13332,this.handle13332),this.RegisterProtocal(13333,this.handle13333),this.RegisterProtocal(13334,this.handle13334)},isFriend:function(t,e){return null==this.model?null:this.model.isFriend(t,e)},updateFriendTishi:function(){var e=[{bid:1,num:this.getModel().getAwardNum()||0},{bid:2,num:this.getModel().getApplyNum()||0}],i=t("mainui_const");t("mainui_controller").getInstance().setFunctionTipsStatus(i.icon.friend,e)},friendList:function(){this.SendProtocal(13300,{})},friendListHandler:function(t){for(var e in null==this.model&&(this.model=new FriendModel),this.model.setFriendPresentCount(t.present_count),this.model.setFriendDrawCount(t.draw_count),this.model.setFriendDrawTotalCount(t.draw_all),t.friend_list){var i=t.friend_list[e],n=null;this.model.isFriend(i.srv_id,i.rid)?(n=this.model.getVo(i.srv_id,i.rid)).setData(i):((n=new a).setData(i),this.model.add(n))}gcore.GlobalEvent.fire(s.FRIEND_LIST,this.model.getArray()),this.apply(),this.updateFriendTishi()},onlineHandler:function(t){var e=this.model.getIndex(t.srv_id,t.rid),i=this.model.updateVo(t.srv_id,t.rid,"is_online",t.is_online),n=this.model.updateVo(t.srv_id,t.rid,"login_out_time",t.login_out_time),a=this.model.getIndex(t.srv_id,t.rid);null!=e&&null!=a&&null!=n&&null!=i&&1==t.is_online&&(gcore.GlobalEvent.fire(s.FRIEND_UPDATE_ITEM,i,0),message(cc.js.formatStr(Utils.TI18N("\u60a8\u7684\u597d\u53cb<color=#00ff00>%s</c>\u4e0a\u7ebf\u4e86"),i.name)))},friendStateHandler:function(t){null!=t.srv_id&&null!=t.rid&&(this.model.updateSingleFriendData(t.srv_id,t.rid,t),gcore.GlobalEvent.fire(s.FRIEND_LIST,this.model.getArray())),this.updateFriendTishi()},apply:function(){this.SendProtocal(13311,{})},applyListHandler:function(t){for(var e in t.friend_req_list)t.friend_req_list[e].intimacy=-1;this.model.setApplyList(t.friend_req_list),gcore.GlobalEvent.fire(s.FRIEND_LIST,this.model.getApplyList()),gcore.GlobalEvent.fire(s.FRIEND_APPLY),this.updateFriendTishi()},send_refuseApplyList:function(){this.SendProtocal(13312,{})},refuseApplyListHandler:function(t){1==t.code&&(gcore.GlobalEvent.fire(s.UPDATE_APPLY_LIST),this.model.apply=[],this.updateFriendTishi())},send_acceptApplyList:function(t){var e={};e.role_ids=t,this.SendProtocal(13334,e)},handle13334:function(t){gcore.GlobalEvent.fire(s.UPDATE_APPLY_LIST),this.model.apply=[],this.updateFriendTishi(),gcore.GlobalEvent.fire(s.Update_Red_Point)},appCount:function(){return this.model?this.model.apply.length:0},recommend:function(){this.SendProtocal(13320,{})},recommendHandler:function(t){var e=[],i=n.getInstance().getRoleVo().srv_id,a=n.getInstance().getRoleVo().rid;for(var o in t.recommend_list){var l=t.recommend_list[o];this.isFriend(l.srv_id,l.rid)||i==l.srv_id&&a==l.rid||(l.intimacy=-1,e.push(l))}gcore.GlobalEvent.fire(s.UD_COMMEND_LIST,e)},queryFind:function(t){var e={};e.name=t,this.SendProtocal(13314,e)},queryFindHandler:function(t){var e=[];if(Utils.next(t.role_list)){var i=n.getInstance().getRoleVo().srv_id,a=n.getInstance().getRoleVo().rid,o=0;for(var l in t.role_list){var r=t.role_list[l];if(this.isFriend(r.srv_id,r.rid)||i==r.srv_id&&a==r.rid||(r.intimacy=-1,e.push(r),o+=1),o>25)break}e.sort(function(t,e){return t.lev>e.lev}),e&&null!=Utils.next(e)||message("\u627e\u4e0d\u5230\u73a9\u5bb6")}else message("\u627e\u4e0d\u5230\u73a9\u5bb6");gcore.GlobalEvent.fire(s.FRIEND_QUERY_RESULT,e)},queryFriendIsHasTeam:function(t,e){var i={};i.rid=t,i.srv_id=e,this.SendProtocal(13315,i)},queryFriendTeamHandler:function(t){1==t.code?this.openFrinedInfo(1):0==t.code&&this.openFrinedInfo(0)},sender_13316:function(t,e,i){var s={};s.rid=e,s.srv_id=i,s.code=t,this.SendProtocal(13316,s)},strengthHandler:function(t){1==t.code&&(this.model.setFriendPresentCount(t.present_count),this.model.setFriendDrawCount(t.draw_count),this.model.updateVo(t.srv_id,t.rid,"is_draw",t.is_draw),this.model.updateVo(t.srv_id,t.rid,"is_present",t.is_present),gcore.GlobalEvent.fire(s.STRENGTH_UPDATE,{list:{data:t}}),gcore.Timer.set(function(){gcore.GlobalEvent.fire(s.Update_Red_Point)},60,1)),message(t.msg)},sender_13317:function(t,e){var i={};i.list=e,i.code=t,this.SendProtocal(13317,i)},batchStrengthHandler:function(t){1==t.code&&(gcore.GlobalEvent.fire(s.STRENGTH_UPDATE,t),gcore.GlobalEvent.fire(s.Update_Red_Point)),message(t.msg)},addOther:function(t,e){var i={};i.srv_id=t,i.rid=e,this.SendProtocal(13303,i)},addOtherHandler:function(t){message(t.msg),1==t.code&&this.closeInfo()},addMeHandler:function(t){this.model.isBlack(t.rid,t.srv_id)||this.apply()},accept:function(t,e,i){var s={};s.srv_id=t,s.rid=e,s.agreed=i,this.SendProtocal(13305,s)},acceptHandler:function(t){if(null!=t){for(var e in this.model.apply){var i=this.model.apply[e];null!=i&&i.srv_id==t.srv_id&&i.rid==t.rid&&this.model.apply.splice(e,1)}gcore.GlobalEvent.fire(s.UPDATE_COUNT,2,this.model.apply.length),this.updateFriendTishi(),1==t.code?(r.getInstance().getModel().saveTalkTime(t.srv_id,t.rid),message(t.msg)):message(t.msg)}},addToListHandler:function(t){if(null!=this.model){var e=new a;if(e.setData(t),this.model.add(e),null!=this.model.apply)for(var i in this.model.apply){var n=this.model.apply[i];n&&t.srv_id==n.srv_id&&t.rid==n.rid&&this.model.apply.splice(i,1)}gcore.Timer.set(function(){gcore.GlobalEvent.fire(s.UPDATE_APPLY)},1e3,1),message(cc.js.formatStr(Utils.TI18N("\u6210\u529f\u6dfb\u52a0<color=#00ff00>%s</c>\u4e3a\u597d\u53cb"),t.name))}},batchAdd:function(t){var e={};e.role_ids=t,this.SendProtocal(13306,e)},batchAddHandler:function(t){message(t.msg)},delOther:function(e,i){var s=function(){var t={};t.srv_id=e,t.rid=i,this.SendProtocal(13307,t)}.bind(this);t("commonalert").show(Utils.TI18N("\u597d\u53cb\u5220\u9664\u540e\uff0c\u5c06\u6e05\u7a7a\u804a\u5929\u8bb0\u5f55\uff0c\u662f\u5426\u5220\u9664\u597d\u53cb\uff1f"),Utils.TI18N("\u5220\u9664"),s,Utils.TI18N("\u53d6\u6d88"))},delOtherHandler:function(t){if(1==t.code){var e=this.model.getVo(t.srv_id,t.rid);if(null!=e){this.model.del(t.srv_id,t.rid);n.getInstance().getRoleVo();r.getInstance().getModel().deltePrivateTarget(t),gcore.GlobalEvent.fire(s.FRIEND_DELETE,e,this.group_type)}this.closeInfom()}message(t.msg)},delMeHandler:function(t){if(null!=this.model.getVo(t.srv_id,t.rid)){this.model.del(t.srv_id,t.rid);n.getInstance().getRoleVo();r.getInstance().getModel().deltePrivateTarget(t),gcore.GlobalEvent.fire(s.UPDATE_GROUP_COUNT)}},deleteConnecter:function(e){var i=function(){r.getInstance().getModel().clearTalkTime(e.srv_id,e.rid),this.closeInfom(),gcore.GlobalEvent.fire(s.FRIEND_DELETE,e,l.FriendGroupType.communicate)}.bind(this);t("commonalert").show("\u662f\u5426\u4ece\u5217\u8868\u4e2d\u5220\u9664\u8be5\u8054\u7cfb\u4eba\uff1f","\u5220\u9664",i,"\u53d6\u6d88")},deleteBlackConnecter:function(t,e){r.getInstance().getModel().clearTalkTime(t,e),this.closeInfom(),gcore.GlobalEvent.fire(s.FRIEND_DELETE,{srv_id:t,rid:e},l.FriendGroupType.friend)},sender_10388:function(t){var e={};e.id_list=t,this.SendProtocal(10388,e)},getRolesOnline:function(t){null!=t&&gcore.GlobalEvent.fire(s.UPDATE_ONLINE,t.online_roles)},openFriendWindow:function(e,i){if(1==e){if(!this.friend_window){var s=t("friend_window");this.friend_window=new s}this.friend_window.open(i)}else this.friend_window&&(this.friend_window.close(),this.friend_window=null)},openFriendFindWindow:function(e){if(1==e){if(!this.friend_find_window){var i=t("friend_add_window");this.friend_find_window=new i}this.friend_find_window.open()}else this.friend_find_window&&(this.friend_find_window.close(),this.friend_find_window=null)},closeInfo:function(){},openFrinedInfo:function(t){this.closeRecommendPanel();1==this.group_type||this.group_type},openFriendCheckPanel:function(t,e){1==t?(this.friend_check_view||(this.friend_check_view=new o),this.friend_check_view.open(e)):this.friend_check_view&&(this.friend_check_view.close(),this.friend_check_view=null)},openFriendGloryWindow:function(e,i){if(1==e){if(!this.friend_glory_view){var s=t("friend_glory_window");this.friend_glory_view=new s}this.friend_glory_view.open(i)}else this.friend_glory_view&&(this.friend_glory_view.close(),this.friend_glory_view=null)},openInfom:function(t,e,i,s){this.begin_pos=i,this.group_type=s||1,this.select_data=t,this.openFrinedInfo()},closeInfom:function(){},closeRecommendPanel:function(){},addPrivateMsg:function(t){},delPriCount:function(t){this.pri_list[t]=null,gcore.GlobalEvent.fire(s.UPDATE_COUNT,1,t,0)},getLpriCount:function(){var t=0;for(var e in this.pri_list){1==this.model.isFriend2(v)&&(t+=v)}return t},allPriCount:function(){var t=0;for(var e in this.pri_list)t+=v;return t},singlePriCount:function(t){return this.pri_list[t]?this.pri_list[t]:0},__delete:function(){null!=this.model&&(this.model.DeleteMe(),this.model=null),this.closeRecommendPanel()},handle13330:function(t){this.model.initBlackList(t.black_list)},getBlackList:function(){this.SendProtocal(13330,{})},handle13331:function(t){1==t.type?(this.model.initBlackList(t.black_list),gcore.GlobalEvent.fire(s.UPDATE_GROUP_COUNT)):t.type},addToBlackList:function(t,e){var i={};i.rid=t,i.srv_id=e,this.SendProtocal(13332,i)},handle13332:function(t){if(message(t.msg),1==t.code){var e=this.model.getVo(t.srv_id,t.rid);e&&(this.model.del(t.srv_id,t.rid),gcore.GlobalEvent.fire(s.FRIEND_DELETE,e,this.group_type))}},deleteBlackList:function(t,e){var i={};i.rid=t,i.srv_id=e,this.SendProtocal(13333,i)},handle13333:function(t){1==t.code&&(this.model.removeBlack(t.rid,t.srv_id),gcore.GlobalEvent.fire(s.FRIEND_DELETE,t,this.group_type||l.FriendGroupType.black_list))}});e.exports=c,cc._RF.pop()},{chat_controller:"chat_controller",commonalert:"commonalert",friend_add_window:"friend_add_window",friend_check_info_winodw:"friend_check_info_winodw",friend_const:"friend_const",friend_event:"friend_event",friend_glory_window:"friend_glory_window",friend_model:"friend_model",friend_vo:"friend_vo",friend_window:"friend_window",mainui_const:"mainui_const",mainui_controller:"mainui_controller",role_controller:"role_controller"}],friend_event:[function(t,e,i){"use strict";cc._RF.push(e,"dcdf5S9yd5AXoD6rqm2+fwK","friend_event"),e.exports={REQUEST_LIST:"REQUEST_LIST",FRIEND_LIST:"FRIEND_LIST",FLASH_LIST:"FLASH_LIST",FRIEND_UPDATE_ITEM:"FRIEND_UPDATE_ITEM",FRIEND_QUERY_RESULT:"FRIEND_QUERY_RESULT",REQUEST_APPLY:"REQUEST_APPLY",FRIEND_APPLY:"FRIEND_APPLY",OPEN_FRIEND_INFO:"OPEN_FRIEND_INFO",OPEN_FRIEND_INFOM:"OPEN_FRIEND_INFOM",FRIEND_CLEAN_APPLY:"FRIEND_CLEAN_APPLY",FRIEND_DELETE:"FRIEND_DELETE",FRIEND_QUERY_FIND:"FRIEND_QUERY_FIND",FRIEND_ADD:"FRIEND_ADD",FRIEND_RECOMMEND:"FRIEND_RECOMMEND",CLOSE_OTHER:"CLOSE_OTHER",UPDATE_COUNT:"UPDATE_COUNT",UPDATE_INTIMACY:"UPDATE_INTIMACY",UD_COMMEND_LIST:"UD_COMMEND_LIST",ADD_NEW_MSG:"ADD_NEW_MSG",FriendAddOrDel:"FriendAddOrDel",FlowerNum:"FlowerNum",FRIEND_TALK:"FRIEND_TALK",FRIEND_MSG_PANEL:"FRIEND_MSG_PANEL",STRANGER_LIST:"STRANGER_LIST",UPDATE_ONLINE:"UPDATE_ONLINE",SELECT_ITEM:"SELECT_ITEM",CONTACT_DELETE:"CONTACT_DELETE",CONTACT_BLACK:"CONTACT_BLACK",TEAM_RECOMMAND_SUCCESS:"TEAM_RECOMMAND_SUCCESS",Update_Red_Point:"Update_Red_Point",Open_Friend_List:"Open_Friend_List",UPDATE_APPLY:"UPDATE_APPLY",UPDATE_GROUP_COUNT:"UPDATE_GROUP_COUNT",UPDATE_BLACK_LIST:"UPDATE_BLACK_LIST",STRENGTH_UPDATE:"STRENGTH_UPDATE",UPDATE_APPLY_LIST:"UPDATE_APPLY_LIST"},cc._RF.pop()},{}],friend_glory_item:[function(t,e,i){"use strict";cc._RF.push(e,"d5f88084JtEc45asqTJ6qQc","friend_glory_item");var s=t("pathtool");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("friend","friend_glory_item")},initConfig:function(){},initPanel:function(){this.main_container=this.seekChild("main_container"),this.my_title_lb=this.seekChild("my_title",cc.Label),this.my_val_lb=this.seekChild("my_val",cc.Label),this.rank_cr=this.seekChild("rank_cr").getComponent("CusRichText"),this.no_rank_nd=this.seekChild("no_rank"),this.no_rank_nd.active=!1,this.power_nd=this.seekChild("power"),this.power_nd.active=!1,this.power_label_cr=this.power_nd.getChildByName("power_label").getComponent("CusRichText")},registerEvent:function(){this.root_wnd.on(cc.Node.EventType.TOUCH_END,function(){Utils.playButtonSound(1),this.callback&&this.callback(this)}.bind(this))},setData:function(t){this.data=t,this.root_wnd&&this.onShow()},onShow:function(){if(null!=this.data){var t=this.data;if(1==t.type)this.my_title_lb.string=Utils.TI18N("\u73a9\u5bb6\u6218\u6597\u529b\uff1a"),this.power_label_cr.setNum(t.val),this.power_nd.active=!0,this.my_val_lb.string="";else if(2==t.type){this.my_title_lb.string=Utils.TI18N("\u73a9\u5bb6\u63a8\u56fe\u8fdb\u5ea6\uff1a");var e=gdata("dungeon_data","data_drama_dungeon_info",[t.val]);this.my_val_lb.string=e?e.name:Utils.TI18N("\u6682\u65e0")}else 3==t.type?(this.my_title_lb.string=Utils.TI18N("\u73a9\u5bb6\u5929\u68af\u676f\u6570\uff1a"),this.my_val_lb.string=t.val):4==t.type?(this.my_title_lb.string=Utils.TI18N("\u73a9\u5bb6\u4f19\u4f34\u6570\u91cf\uff1a"),this.my_val_lb.string=t.val):5==t.type&&(this.my_title_lb.string=Utils.TI18N("\u8bd5\u7ec3\u5854\u6392\u884c\uff1a"),this.my_val_lb.string=t.val);0!=t.rank?(this.no_rank_nd.active=!1,this.rank_cr.node.active=!0,this.rank_cr.setNum(t.rank)):(this.no_rank_nd.active=!0,this.rank_cr.node.active=!1)}},addCallBack:function(t){this.callback=t},onHide:function(){},onDelete:function(){}});cc._RF.pop()},{pathtool:"pathtool"}],friend_glory_window:[function(t,e,i){"use strict";cc._RF.push(e,"507aadodnVCsY0DBHeZvrg4","friend_glory_window");var s=t("pathtool"),n=t("friend_controller"),a=t("playerhead"),o=t("common_scrollview"),l=t("friend_glory_item");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("friend","friend_glory_window"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Mini},initConfig:function(){this.ctrl=n.getInstance()},openCallBack:function(){this.main_panel=this.seekChild("main_panel"),this.close_btn=this.seekChild("close_btn"),this.background=this.seekChild("background"),this.background.scale=FIT_SCALE,this.title_container_nd=this.seekChild("title_container"),this.title_lb=this.seekChild(this.title_container_nd,"title_label",cc.Label),this.title_lb.string=Utils.TI18N("\u4e2a\u4eba\u8363\u8a89"),this.info_con_nd=this.seekChild("info_con"),this.name_lb=this.seekChild(this.info_con_nd,"name",cc.Label),this.guild_lb=this.seekChild(this.info_con_nd,"guild",cc.Label),this.country_nd=this.seekChild(this.info_con_nd,"country"),null==this.head&&(this.head=new a,this.head.setParent(this.info_con_nd),this.head.show(),this.head.setPosition(-227,50)),this.vip_label_lb=this.seekChild(this.info_con_nd,"vip_label").getComponent("CusRichText"),this.vip_label_lb.setNum(0),this.scrollCon=this.seekChild("scrollCon");var t=this.scrollCon.getContentSize(),e=cc.size(t.width,t.height-10),i={item_class:l,start_x:5,space_x:2,start_y:0,space_y:2,item_width:554,item_height:94,row:1,col:1,need_dynamic:!0};this.item_scrollview=new o,this.item_scrollview.createScroll(this.scrollCon,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,e,i,cc.v2(.5,.5))},registerEvent:function(){this.close_btn&&this.close_btn.on(cc.Node.EventType.TOUCH_END,function(){this.ctrl.openFriendGloryWindow(!1),Utils.playButtonSound(2)}.bind(this))},openRootWnd:function(t){this.data=t,this.updateData()},updateData:function(){if(null!=this.data){var t=this.data;this.name_lb.string=this.data.name,this.country_nd.x=this.name_lb.node.x+this.name_lb.node.width+5,this.head.setHeadRes(this.data.face_id),""!=this.data.gname&&(this.guild_lb.string=this.data.gname);var e=gdata("avatar_data","data_avatar",[t.avatar_bid]);if(e){var i=e.res_id||0,n=s.getHeadcircle(i);this.head.showBg(n,null,!1,e.offy)}this.head.setSex(this.data.sex,cc.v2(70,4)),this.vip_label_lb.setNum(this.data.vip_lev);var a=this.data.honor_list;a.sort(Utils.tableLowerSorter(["type"])),this.item_scrollview.setData(a)}},close_inheritback:function(){this.ctrl.openFriendGloryWindow(!1)},closeCallBack:function(){this.item_scrollview&&(this.item_scrollview.deleteMe(),this.item_scrollview=null),this.head&&(this.head.deleteMe(),this.head=null),this.ctrl.openFriendGloryWindow(!1)}});cc._RF.pop()},{common_scrollview:"common_scrollview",friend_controller:"friend_controller",friend_glory_item:"friend_glory_item",pathtool:"pathtool",playerhead:"playerhead"}],friend_list_item:[function(t,e,i){"use strict";cc._RF.push(e,"55eddYixShPf7Odm68JCgez","friend_list_item");var s=t("pathtool"),n=t("friend_controller"),a=t("friend_const"),o=t("playerhead"),l=t("friend_vo"),r=t("timetool"),c=cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("friend","friend_item"),this.ctrl=n.getInstance(),this.size=cc.size(610,114),this.width=610,this.height=114,this.is_del=!1,this.item_list={},this.vo=null,this.open_type=arguments[0]&&arguments[0].open_type||a.Type.MyFriend},initPanel:function(){this.root_wnd.setContentSize(this.size),this.main_panel=this.root_wnd.getChildByName("main_panel"),this.role_name=this.main_panel.getChildByName("role_name").getComponent(cc.Label),this.role_power=this.main_panel.getChildByName("role_power").getComponent(cc.Label),this.is_online=this.main_panel.getChildByName("is_online").getComponent(cc.Label),this.img_btn=this.main_panel.getChildByName("img"),this.img=this.main_panel.getChildByName("img").getComponent(cc.Sprite),this.button=this.main_panel.getChildByName("add_btn"),this.btn_label=this.button.getChildByName("Label").getComponent(cc.Label),this.btn_label_lo=this.button.getChildByName("Label").getComponent(cc.LabelOutline),this.del_btn=this.main_panel.getChildByName("del_btn"),this.del_btn.active=!1,this.head_con=this.main_panel.getChildByName("head_con"),this.play_head=new o,this.play_head.setParent(this.head_con),this.play_head.show(),this.play_head.addCallBack(function(){this.ctrl.openFriendCheckPanel(!0,this.vo)}.bind(this))},setExtendData:function(t){this.open_type=t},clickHandler:function(){this.call_fun&&this.call_fun(this.vo)},setTouchFuncL:function(t){this.call_fun=t},addCallBackL:function(t){this.call_fun=t},registerEvent:function(){this.button.on(cc.Node.EventType.TOUCH_END,function(){if(this.vo&&this.button.getComponent(cc.Button).interactable){if(this.my_friend){var e=t("chat_controller"),i=t("chat_const"),s={avatar_bid:this.vo.avatar_bid,career:this.vo.career,dun_id:this.vo.dun_id,face_id:this.vo.face_id,gid:this.vo.gid,gift_status:this.vo.gift_status,gname:this.vo.gname,group_id:this.vo.group_id,gsrv_id:this.vo.gsrv_id,intimacy:this.vo.intimacy,is_awake:this.vo.is_awake,is_cross:this.vo.is_cross,is_draw:this.vo.is_draw,is_moshengren:this.vo.is_moshengren,is_online:this.vo.is_online,is_present:this.vo.is_present,is_used:this.vo.is_used,is_vip:this.vo.is_vip,lev:this.vo.lev,login_out_time:this.vo.login_out_time,login_time:this.vo.login_time,main_partner_id:this.vo.main_partner_id,name:this.vo.name,partner_bid:this.vo.partner_bid,partner_lev:this.vo.partner_lev,partner_star:this.vo.partner_star,power:this.vo.power,rid:this.vo.rid,sex:this.vo.sex,srv_id:this.vo.srv_id,talk_time:this.vo.talk_time};e.getInstance().openChatPanel(i.Channel.Friend,"friend",s)}this.award_panel&&this.ctrl.sender_13316(0,this.vo.rid,this.vo.srv_id),this.apply_panel&&this.ctrl.accept(this.vo.srv_id,this.vo.rid,1),this.black_panel&&this.ctrl.deleteBlackList(this.vo.rid,this.vo.srv_id),this.del_friend_btn,this.recommend_panel&&(this.ctrl.addOther(this.vo.srv_id,this.vo.rid),this.btn_label.string=Utils.TI18N("\u7b49\u5f85\u540c\u610f"),this.button.getComponent(cc.Button).interactable=!1,this.button.getComponent(cc.Button).enableAutoGrayEffect=!0,this.btn_label_lo.color=new cc.Color(121,121,121,255)),this.is_del&&this.ctrl.delOther(this.vo.srv_id,this.vo.rid)}},this),this.del_btn.on(cc.Node.EventType.TOUCH_END,function(){this.vo&&this.ctrl.accept(this.vo.srv_id,this.vo.rid,0)},this),this.img_btn.on(cc.Node.EventType.TOUCH_END,function(){this.vo&&this.img_btn.getComponent(cc.Button).interactable&&(this.my_friend&&this.ctrl.sender_13316(0,this.vo.rid,this.vo.srv_id),this.award_panel&&this.ctrl.sender_13316(1,this.vo.rid,this.vo.srv_id))},this)},setData:function(t){null!=t&&(this.unBindEvent(),this.vo=t,null!=this.root_wnd&&this.onShow())},onShow:function(){if(null!=this.vo){var t=this.vo;if(gcore.Timer.set(function(){this.updateMessage()}.bind(this),60,1),t.face_id&&this.play_head.setHeadRes(t.face_id),null!=t.lev&&this.play_head.setLev(t.lev),null!=t.name&&(this.role_name.string=t.name||""),null!=t.power){var e=t.power||0;this.role_power.string=Utils.TI18N("\u6218\u529b\uff1a")+e}this.updateOnlineTime(),this.addVoBindEvent()}},updateOnlineTime:function(){if(this.vo&&this.is_online){var t="";if(null!=this.vo.is_online&&0==this.vo.is_online){var e=0;if(0==this.vo.login_out_time)e=4*r.day2s();else e=gcore.SmartSocket.getTime()-this.vo.login_out_time;t=r.getTimeFormatFriendShowTime(e)}else t=Utils.TI18N("\u5728\u7ebf");this.is_online.string=t}},addVoBindEvent:function(){this.vo&&null!=this.vo&&this.vo.bind&&null==this.item_update_event&&(this.item_update_event=this.vo.bind(l.UPDATE_FRIEND_ATTR_LOGIN_OUT_TIME,function(t){this.updateOnlineTime()},this))},unBindEvent:function(){this.vo&&(null!=this.item_update_event&&(this.vo.unbind(this.item_update_event),this.item_update_event=null),this.vo=null)},updateMessage:function(){this.hideAllPanel(),this.open_type==a.Type.MyFriend?(this.is_del=this.vo.del_status,this.updateMyFriend()):this.open_type==a.Type.Award?(this.is_del=!1,this.updateAwardPanel()):this.open_type==a.Type.ApplyList?(this.is_del=!1,this.updateApplyPanel()):this.open_type==a.Type.BlackList?(this.is_del=!1,this.updateBlackPanel()):5==this.open_type&&(this.is_del=!1,this.updateRecommendPanel())},hideAllPanel:function(){this.my_friend&&(this.my_friend=!1),this.award_panel&&(this.award_panel=!1),this.apply_panel&&(this.apply_panel=!1),this.black_panel&&(this.black_panel=!1),this.del_friend_btn&&(this.del_friend_btn=!1),this.recommend_panel&&(this.recommend_panel=!1)},updateMyFriend:function(){this.my_friend||(this.loadRes(s.getUIIconPath("friend","friend_5"),function(t){this.img.spriteFrame=t}.bind(this)),this.btn_label.string=Utils.TI18N("\u79c1\u804a"),this.button.width=96,this.del_btn.active=!1,this.my_friend=!0),this.img.node.active=!0,this.button.getComponent(cc.Button).interactable=!0,this.button.getComponent(cc.Button).enableAutoGrayEffect=!1,null!=this.vo&&(null!=this.vo.is_present&&1==this.vo.is_present?(this.img_btn.getComponent(cc.Button).interactable=!1,this.img_btn.getComponent(cc.Button).enableAutoGrayEffect=!0):(this.img_btn.getComponent(cc.Button).interactable=!0,this.img_btn.getComponent(cc.Button).enableAutoGrayEffect=!1),this.is_del&&this.setDelStatus(this.is_del))},updateAwardPanel:function(){this.award_panel||(null==this.path?this.loadRes(s.getUIIconPath("friend","friend_2"),function(t){this.img.spriteFrame=t}.bind(this)):this.img.spriteFrame=this.res_object.getSpriteFrame("friend_2"),this.btn_label.string=Utils.TI18N("\u56de\u793c"),this.award_panel=!0),this.img_btn.active=!0,this.del_btn.active=!1,this.img_btn.getComponent(cc.Button).interactable=!0,this.img_btn.getComponent(cc.Button).enableAutoGrayEffect=!1,this.btn_label_lo.color=new cc.Color(173,100,67,255),this.vo&&(null!=this.vo.is_present&&1==this.vo.is_present&&(this.button.getComponent(cc.Button).interactable=!1,this.button.getComponent(cc.Button).enableAutoGrayEffect=!0,this.btn_label_lo.color=new cc.Color(121,121,121,255)),null!=this.vo.is_draw&&0==this.vo.is_draw&&(this.img_btn.getComponent(cc.Button).interactable=!1,this.img_btn.getComponent(cc.Button).enableAutoGrayEffect=!0))},updateApplyPanel:function(){this.apply_panel||(this.img.node.active=!1,this.del_btn.active=!0,this.apply_panel=!0,this.btn_label.string=Utils.TI18N("\u63a5\u53d7"),this.button.setContentSize(cc.size(96,53)),this.button.getComponent(cc.Button).interactable=!0)},updateBlackPanel:function(){this.black_panel||(this.img.node.active=!1,this.del_btn.active=!1,this.btn_label.string=Utils.TI18N("\u79fb\u9664"),this.black_panel=!0,this.button.getComponent(cc.Button).interactable=!0)},updateRecommendPanel:function(){this.recommend_panel||(this.button.getComponent(cc.Button).interactable=!0,this.img.node.active=!1,this.del_btn.active=!1,this.button.setContentSize(cc.size(127,53)),this.recommend_panel=!0,this.btn_label.string=Utils.TI18N("\u52a0\u4e3a\u597d\u53cb"))},isHaveData:function(){return!!this.vo},setDelStatus:function(t){1==t&&this.hideAllPanel(),this.is_del=t,(this.button||0!=t)&&(this.button&&(t?(this.button.setContentSize(cc.size(127,53)),this.btn_label.string=Utils.TI18N("\u5220\u9664\u597d\u53cb"),this.img.node.active=!1):this.button.setContentSize(cc.size(96,53))),0==t&&this.updateMyFriend())},getData:function(){return this.vo},OnDelete:function(){this.unBindEvent(),this.vo=null,this.play_head&&this.play_head.deleteMe(),this.play_head=null},setCallFun:function(t){this.call_fun=t},setVisibleStatus:function(t){null!=this.root_wnd&&(this.root_wnd.active=t)}});e.exports=c,cc._RF.pop()},{chat_const:"chat_const",chat_controller:"chat_controller",friend_const:"friend_const",friend_controller:"friend_controller",friend_vo:"friend_vo",pathtool:"pathtool",playerhead:"playerhead",timetool:"timetool"}],friend_list_panel:[function(t,e,i){"use strict";cc._RF.push(e,"5de0aPIfS9F1rm9NBHdCslq","friend_list_panel");var s=t("pathtool"),n=t("friend_controller"),a=t("role_controller"),o=cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("friend","firend_list_panel"),this.ctrl=n.getInstance(),this.model=this.ctrl.getModel(),this.size=cc.size(720,800),this.item_list={}},initPanel:function(){this.root_wnd.setContentSize(this.size),this.main_panel=this.root_wnd.getChildByName("main_panel"),this.num_label=this.main_panel.getChildByName("rich_text").getComponent(cc.RichText),this.cost_panel=this.main_panel.getChildByName("cost_panel"),this.friend_point=this.cost_panel.getChildByName("num_label").getComponent(cc.Label),this.btn_del=this.main_panel.getChildByName("btn_del"),this.btn_del_label=this.btn_del.getChildByName("Label").getComponent(cc.Label),this.btn_add=this.main_panel.getChildByName("btn_add"),this.btn_send=this.main_panel.getChildByName("btn_send")},registerEvent:function(){this.btn_del&&this.btn_del.on(cc.Node.EventType.TOUCH_END,function(){this.clickDelBtn()},this),this.btn_add&&this.btn_add.on(cc.Node.EventType.TOUCH_END,function(){this.ctrl.openFriendFindWindow(!0)},this),this.cost_panel&&this.cost_panel.on(cc.Node.EventType.TOUCH_END,function(){Utils.TI18N("1\u3001\u53cb\u60c5\u70b9\u901a\u8fc7\u6bcf\u65e5\u6536\u53d6\u597d\u53cb\u8d60\u9001\u7684\u53cb\u60c5\u70b9\u83b7\u5f97\uff0c\u6bcf\u65e5\u6700\u591a\u80fd\u591f\u6536\u53d6\u5230\u4e94\u4e2a\u597d\u53cb\u8d60\u9001\u7684\u53cb\u60c5\u70b9\n2\u3001\u8d85\u51fa\u6b21\u6570\u7684\u8d60\u793c\u4f9d\u7136\u80fd\u591f\u83b7\u5f97\u94f6\u5e01\u5956\u52b1\n3\u3001\u73a9\u5bb6\u8d60\u9001\u597d\u53cb\u793c\u7269\uff0c\u81ea\u5df1\u4e5f\u53ef\u4ee5\u83b7\u5f97\u94f6\u5e01\u5956\u52b1")},this),this.btn_send&&this.btn_send.on(cc.Node.EventType.TOUCH_END,function(){if(null!=this.data){var t=this.model.getFriendPresentCount()||10,e=[],i=null,s=1;for(var n in this.data){if((i=this.data[n])&&0==i.is_present&&(e.push(i),s+=1),s>=t)break}this.ctrl.sender_13317(0,e)}},this)},setData:function(t){null!=this.root_wnd&&this.onShow(),null!=t&&(this.data=t)},clickDelBtn:function(){this.is_del=!this.is_del,this.call_fun&&this.call_fun(this.is_del);var t=Utils.TI18N("\u5220\u9664\u597d\u53cb");1==this.is_del&&(t=Utils.TI18N("\u53d6\u6d88\u5220\u9664")),this.btn_del_label.string=t},onShow:function(){var t=this.ctrl.getModel().getFriendOnlineAndTotal().total_num,e=Utils.TI18N("\u597d\u53cb\u6570\uff1a")+t+"/100",i=Config.color_data.data_color16[156];this.num_label.string="<color="+i+">"+e+"</c>",this.setFriendPoint()},setCallFun:function(t){this.call_fun=t},setVisibleStatus:function(t){null!=this.root_wnd&&(this.root_wnd.active=t,0==t&&(this.is_del=!1,this.btn_del_label.string=Utils.TI18N("\u5220\u9664\u597d\u53cb")))},setFriendPoint:function(){var t=a.getInstance().getRoleVo().friend_point||0;this.friend_point.string=t},openRootWnd:function(){},closeCallBack:function(){}});e.exports=o,cc._RF.pop()},{friend_controller:"friend_controller",pathtool:"pathtool",role_controller:"role_controller"}],friend_model:[function(t,e,i){"use strict";cc._RF.push(e,"46debPOR8hE1ZazERYrrLAe","friend_model");var s=t("friend_controller"),n=t("friend_vo"),a=t("friend_event"),o=cc.Class({extends:BaseClass,ctor:function(){this.ctrl=s.getInstance(),this.initConfig()},properties:{},initConfig:function(){this.list={},this.apply=[],this.plist={},this.onlinelist={},this.blacklist=[],this.honey_list_count=20,this.last_select_group=1,this.last_select_friend_srv_id=null,this.last_select_friend_rid=null,this.present_count=0,this.draw_count=0,this.draw_total_count=0,this.last_select_index=1},add:function(t){null==this.list[t.srv_id+"_"+t.rid]&&(this.list[t.srv_id+"_"+t.rid]=t)},addPchat:function(t){null==this.plist[t.srv_id+"_"+t.rid]&&(this.plist[t.srv_id+"_"+t.rid]=t)},getOnlineFriendList:function(){var t=[];for(var e in this.list){var i=this.list[e];i&&1==i.is_online&&t.push(i)}return t},getFriendInfo:function(t,e){var i=t+"_"+e;return this.list[i]},setApplyList:function(t){var e=[];for(var i in t){var s=t[i];s&&e.push(s)}this.apply=e,gcore.Timer.set(function(){gcore.GlobalEvent.fire(a.Update_Red_Point)},1e3,-1)},getApplyList:function(){return this.apply||[]},getApplyNum:function(){return this.apply.length},del:function(t,e){null!=this.list[t+"_"+e]&&(this.list[t+"_"+e]=null)},updateVo:function(t,e,i,s){var n=this.list[t+"_"+e];return null!=n&&n.update(i,s),n},getAwardNum:function(){var t=0;for(var e in this.list){var i=this.list[e];i&&1==i.is_draw&&(t+=1)}return t},updateSingleFriendData:function(t,e,i){var s=t+"_"+e;this.list[s]&&this.list[s].setData(i)},getVo:function(t,e){return this.list[t+"_"+e]},getArray:function(){var t=new Array;for(var e in this.list)this.list[e]&&t.push(this.list[e]);return t.sort(Utils.tableUpperSorter(["is_online","lev","power"])),t},getGroupList:function(t){var e=new Array;for(var i in this.list){var s=this.list[i];1==s.is_cross&&"cross"==t?e.push(s):0==s.is_cross&&"alike"==t&&e.push(s)}return e.sort(Utils.tableUpperSorter(["is_online","lev"])),e},getGroupOnlineAndTotal:function(t){var e,i=0,s=this.getGroupList(t),n=s.GetSize();e=n;for(var a=1;a<=n;a++){var o=s.Get(a-1);o.srv_id&&o.rid&&1==o.is_online&&(i+=1)}return{online_num:i,total_num:e}},getFriendOnlineAndTotal:function(){var t=0,e=0;if(this.list)for(var i in this.list){var s=this.list[i];s&&s.srv_id&&s.rid&&1==s.is_online&&(t+=1),s&&(e+=1)}return{online_num:t,total_num:e}},getHoneyListOnlineAndTotal:function(t){var e,i=0,s=this.getHoneyList(t),n=s.GetSize();e=n;for(var a=1;a<=n;a++){var o=s.Get(a-1);o.srv_id&&o.rid&&1==o.is_online&&(i+=1)}return{online_num:i,total_num:e}},getBlackListOnlineAndTotal:function(){var t=0,e=0;for(var i in this.blacklist){var s=this.blacklist[i];null!=s&&null!=s.is_online&&1==s.is_online&&(e+=1),t+=1}return{online_num:e,total_num:t}},getIndex:function(t,e){for(var i=this.getArray(),s=0;s<i.length;s++){var n=i[s];if(n.srv_id==t&&n.rid==e)return s}return null},isFriend:function(t,e){if(null==t||null==e)return!1;var i=this.list[t+"_"+e];return!(!i||0!=i.is_moshengren)},isFriend2:function(t){var e=this.list[t];return!(!e||0!=e.is_moshengren)},setOnlineData:function(t){for(var e in this.onlinelist=[],list){var i=list[e];t=i.srv_id+"+"+i.id;this.onlinelist[t]=1}},getOnlineData:function(t){return this.onlinelist[t]?1:0},setOnlineKey:function(t){this.onlinelist[t]=1},setFriendPresentCount:function(t){this.present_count=t},getFriendPresentCount:function(){return this.present_count},setFriendDrawCount:function(t){this.draw_count=t},getFriendDrawCount:function(){return this.draw_count},setFriendDrawTotalCount:function(t){this.draw_total_count=t},getFriendDrawTotalCount:function(){return this.draw_total_count},initBlackList:function(t,e){for(var i in t){var s=new n,a=t[i];s.setData(a),this.blacklist[a.rid+"_"+a.srv_id]=s}},removeBlack:function(t,e){t&&e&&delete this.blacklist[t+"_"+e]},getBlackArray:function(){var t=new Array;for(var e in this.blacklist)t.push(this.blacklist[e]);return t.sort(Utils.tableUpperSorter(["is_online","lev","power"])),t},isBlack:function(t,e){var i=!1;return t&&e&&this.blacklist[t+"_"+e]&&(i=!0),i},setLastSelectGroup:function(t){this.last_select_group=t},getLastSelectGroup:function(){return this.last_select_group},setLastSelectFriend:function(t,e){this.last_select_friend_srv_id=t,this.last_select_friend_rid=e},setLastSelectFriendIndex:function(t){this.last_select_index=t||1},getLastSelectFriendIndex:function(){return this.last_select_index},getLastSelectFriend:function(){return this.last_select_friend_srv_id,this.last_select_friend_rid},__delete:function(){}});e.exports=o,cc._RF.pop()},{friend_controller:"friend_controller",friend_event:"friend_event",friend_vo:"friend_vo"}],friend_vo:[function(t,e,i){"use strict";cc._RF.push(e,"a359c0Jv7BIObPPn73n04ab","friend_vo");var s=cc.Class({extends:gcore.BaseEvent,ctor:function(){this.initData()},initData:function(){this.srv_id="",this.rid=0,this.name="",this.sex=1,this.lev=0,this.career=1,this.power=0,this.login_time=0,this.login_out_time=0,this.face_id=0,this.is_online=1,this.group_id=0,this.is_cross=0,this.intimacy=0,this.is_vip=0,this.avatar_bid=0,this.gift_status=1,this.gid=0,this.gsrv_id="",this.is_moshengren=0,this.talk_time=0,this.dun_id=0,this.gname="",this.main_partner_id=0,this.partner_bid=0,this.partner_lev=0,this.partner_star=0,this.is_awake=0,this.is_used=0,this.is_present=0,this.is_draw=0},setData:function(t){for(var e in t)null!=this[e]&&this.setKey(e,t[e])},update:function(t,e){null!=this[t]&&this[t]!=e&&(this[t]=e,"login_out_time"==t&&this.fire(s.UPDATE_FRIEND_ATTR_LOGIN_OUT_TIME,this))},setKey:function(t,e){this.update(t,e)},_delete:function(){}});s.UPDATE_FRIEND_ATTR_LOGIN_OUT_TIME="UPDATE_FRIEND_ATTR_LOGIN_OUT_TIME",e.exports=s,cc._RF.pop()},{}],friend_window:[function(t,e,i){"use strict";cc._RF.push(e,"206f7ai3axIgJQSSPY0yn2p","friend_window");var s=t("friend_controller"),n=t("role_controller"),a=t("common_scrollview"),o=t("friend_list_item"),l=t("friend_const"),r=t("friend_event"),c=t("friend_award_panel"),_=t("friend_apply_panel"),h=t("friend_black_panel"),d=t("friend_list_panel"),u=t("mainui_const"),m=cc.Class({extends:CommonWindowTab,ctor:function(){this.ctrl=s.getInstance(),this.win_type=WinType.Full,this.viewTag=SCENE_TAG.ui,this.tab_info_list=[{label:Utils.TI18N("\u6211\u7684\u597d\u53cb"),index:l.Type.MyFriend,status:!0},{label:Utils.TI18N("\u9886\u53d6\u793c\u7269"),index:l.Type.Award,status:!0},{label:Utils.TI18N("\u7533\u8bf7\u5217\u8868"),index:l.Type.ApplyList,status:!0},{label:Utils.TI18N("\u9ed1\u540d\u5355"),index:l.Type.BlackList,status:!0}],this.title_str=Utils.TI18N("\u597d\u53cb"),this.view_list={},this.friend_list={},this.scroll_width=630,this.scroll_height=614,this.rend_list={},this.cache_lit={},this.role_vo=n.getInstance().getRoleVo()},initPanel:function(){var t=cc.size(this.scroll_width,this.scroll_height),e={item_class:o,start_x:7.5,space_x:0,start_y:0,space_y:2,item_width:624,item_height:114,row:0,col:1,once_num:1,need_dynamic:!0};this.item_scrollview=new a,this.item_scrollview.createScroll(this.scroll_con,cc.v2(0,65),ScrollViewDir.vertical,ScrollViewStartPos.top,t,e,cc.v2(.5,.5))},registerEvent:function(){this.addGlobalEvent(r.FRIEND_APPLY,function(){this.cur_type==l.Type.ApplyList&&this.updateFriendList(!1)}.bind(this)),this.addGlobalEvent(r.STRENGTH_UPDATE,function(t){if(this.cur_type==l.Type.Award||this.cur_type==l.Type.MyFriend){var e=t.list||{},i={};for(var s in e){i[(o=e[s]).rid+"_"+o.srv_id]=o}var n=this.item_scrollview.getItemList();if(n)for(var a in n){var o,r=(o=n[a]).getData();r&&i[r.rid+"_"+r.srv_id]&&o.setData(i[r.rid+"_"+r.srv_id])}}}.bind(this)),this.addGlobalEvent(r.FRIEND_DELETE,function(){this.cur_type!=l.Type.MyFriend&&this.cur_type!=l.Type.BlackList||(this.updateFriendList(!1,!0),this.changeFriendBtn(!0))}.bind(this)),this.addGlobalEvent(r.UPDATE_APPLY,function(){this.cur_type!=l.Type.MyFriend?(this.setTabTips(!0,l.Type.MyFriend),this.cur_type==l.Type.ApplyList&&this.updateFriendList(!1)):this.updateFriendList(!1),this.showRedPoint()}.bind(this)),null!=this.role_vo&&null==this.role_assets_event&&(this.role_assets_event=this.role_vo.bind(EventId.UPDATE_ROLE_ATTRIBUTE,function(t,e){"friend_point"==t&&(this.cur_type!=l.Type.MyFriend&&this.cur_type!=l.Type.Award||this.pre_panel&&this.pre_panel.setFriendPoint&&this.pre_panel.setFriendPoint())}.bind(this))),this.addGlobalEvent(r.UPDATE_COUNT,function(){this.updateFriendList(!1),this.showRedPoint()}.bind(this)),this.addGlobalEvent(r.UPDATE_GROUP_COUNT,function(){this.updateFriendList(!1,!0),this.showRedPoint()}.bind(this)),this.addGlobalEvent(r.FRIEND_LIST,function(){this.updateFriendList(!1),this.showRedPoint()}.bind(this)),this.addGlobalEvent(r.Update_Red_Point,function(){this.showRedPoint()}.bind(this))},openRootWnd:function(t){t=t||l.Type.MyFriend,this.setSelecteTab(t,!0),this.showRedPoint()},selectedTabCallBack:function(t){t=t||l.Type.MyFriend,this.cur_type!=t&&(this.changeFriendBtn(!1),this.setTabTips(!1,l.Type.MyFriend),this.cur_type=t,null!=this.pre_panel&&this.pre_panel.setVisibleStatus&&this.pre_panel.setVisibleStatus(!1),this.pre_panel=this.createSubPanel(this.cur_type),null!=this.pre_panel&&this.pre_panel.setVisibleStatus&&this.pre_panel.setVisibleStatus(!0),this.cur_type==l.Type.MyFriend?(this.scroll_con.y=433,this.scroll_con.setContentSize(cc.size(this.scroll_width,this.scroll_height)),this.item_scrollview.resetSize(cc.size(this.scroll_width,this.scroll_height))):this.cur_type==l.Type.Award?(this.scroll_con.y=375,this.scroll_con.setContentSize(cc.size(this.scroll_width,600)),this.item_scrollview.resetSize(cc.size(this.scroll_width,674))):(this.scroll_con.y=323,this.scroll_con.setContentSize(cc.size(this.scroll_width,724)),this.item_scrollview.resetSize(cc.size(this.scroll_width,724))),this.updateFriendList(!0))},createSubPanel:function(t){var e=this.view_list[t];if(null==e){t==l.Type.MyFriend?e=new d:t==l.Type.ApplyList?e=new _(this.container):t==l.Type.Award?e=new c:t==l.Type.BlackList&&(e=new h),e.show();this.container.getContentSize();e.setParent(this.container),this.view_list[t]=e}return e&&e.setCallFun&&e.setCallFun(function(e){t==l.Type.MyFriend&&(e=e||!1,this.changeFriendBtn(e))}.bind(this)),e},changeFriendBtn:function(t){this.del_friend_status=t;for(var e=0;e<this.rend_list.length;++e)this.rend_list[e].del_status=t;this.item_scrollview.resetAddPosition(this.rend_list,null,this.cur_type)},updateFriendList:function(t,e){t=t||!1,this.rend_list=[];var i=[];if(this.cur_type==l.Type.MyFriend)i=this.ctrl.getModel().getArray()||[];else if(this.cur_type==l.Type.ApplyList){if(1==t)return void this.ctrl.apply();var s=[],n=this.ctrl.getModel().getApplyList()||{};for(var a in n)s.push(n[a]);i=s,this.updateApplyNum()}else if(this.cur_type==l.Type.Award){s=this.ctrl.getModel().getArray()||[];var o=[];for(a=0;a<s.length;a++){var r=s[a];r&&1==r.is_draw&&o.push(r)}i=o}else this.cur_type==l.Type.BlackList&&(i=this.ctrl.getModel().getBlackArray()||[]);if(i)for(var c in i)i[c]&&this.rend_list.push(i[c]);this.showEmptyIcon(!1),this.rend_list.length<=0&&this.showEmptyIcon(!0),this.pre_panel.setData(this.rend_list),1==e&&0==t&&null!=Utils.next(this.rend_list)?this.item_scrollview.setData(this.rend_list,null):this.item_scrollview.setData(this.rend_list,null,this.cur_type)},updateApplyNum:function(){if(this.pre_panel&&this.pre_panel.setApplyNum){var t=this.ctrl.getModel().getApplyNum()||0;this.pre_panel.setApplyNum(t)}},showRedPoint:function(){var e=this.ctrl.getModel().getAwardNum()||0;this.setTabTipsII(e,l.Type.Award);var i=this.ctrl.getModel().getApplyNum()||0;this.setTabTipsII(i,l.Type.ApplyList);var s=[{bid:1,num:e},{bid:2,num:i}];t("mainui_controller").getInstance().setFunctionTipsStatus(u.icon.friend,s)},showEmptyIcon:function(t){if(this.empty_con||0!=t){var e="\u6682\u65e0\u597d\u53cb";this.cur_type==l.Type.Award?e="\u6682\u65e0\u597d\u53cb\u8d60\u9001":this.cur_type==l.Type.ApplyList?e="\u6682\u65e0\u597d\u53cb\u7533\u8bf7":this.cur_type==l.Type.BlackList&&(e="\u6682\u65e0\u62c9\u9ed1\u540d\u5355"),this.empty_label.string=e,this.empty_con.active=t}},closeCallBack:function(){for(var t in this.ctrl.openFriendWindow(!1),this.item_scrollview&&(this.item_scrollview.DeleteMe(),this.item_scrollview=null),this.view_list){var e=this.view_list[t];e&&e.deleteMe&&(e.deleteMe(),e=null)}this.view_list=null,null!=this.role_vo&&null!=this.role_assets_event&&(this.role_vo.unbind(this.role_assets_event),this.role_assets_event=null)}});e.exports=m,cc._RF.pop()},{common_scrollview:"common_scrollview",friend_apply_panel:"friend_apply_panel",friend_award_panel:"friend_award_panel",friend_black_panel:"friend_black_panel",friend_const:"friend_const",friend_controller:"friend_controller",friend_event:"friend_event",friend_list_item:"friend_list_item",friend_list_panel:"friend_list_panel",mainui_const:"mainui_const",mainui_controller:"mainui_controller",role_controller:"role_controller"}],function_icon_panel:[function(t,e,i){"use strict";cc._RF.push(e,"51f41q7mKlA4YX7Yk3ZSXLC","function_icon_panel");var s=t("pathtool"),n=t("function_icon_vo"),a=t("mainui_const"),o=t("mainui_controller"),l=t("action_event"),r=t("action_controller"),c=t("role_controller"),_=t("timetool");cc.Class({extends:BasePanel,ctor:function(){this.time_ticket_desc="",this.data=arguments[0],this.width=0,this.height=0,this.data.config.type==n.type.right_top_1||this.data.config.type==n.type.right_top_2?(this.prefabPath=s.getPrefabPath("mainui","function_icon_left"),this.width=74,this.height=90):this.data.config.type!=n.type.right_bottom_1&&this.data.config.type!=n.type.right_bottom_2||(this.prefabPath=s.getPrefabPath("mainui","function_icon_right"),this.width=74,this.height=74)},initConfig:function(){this.node_list=[],this.need_load=!1},initPanel:function(){this.container_nd=this.seekChild("main_container"),this.button_sp=this.seekChild("button",cc.Sprite),this.tishi_nd=this.seekChild("tips"),this.tishi_sp=this.seekChild("tips",cc.Sprite),this.skeleton=this.seekChild("skeleton",sp.Skeleton),this.container_nd.name=this.data.config.name,this.tishi_nd.active=!1,this.data.config.type==n.type.right_bottom_1||this.data.config.type==n.type.right_bottom_2?(this.num_lb=this.seekChild(this.container_nd,"num",cc.Label),this.num_lb.node.active=!1,this.data.config.id!=a.icon.mail&&this.data.config.id!=a.icon.friend||this.loadRes(s.getUIIconPath("mainui","mainui_1034"),function(t){this.tishi_sp.spriteFrame=t}.bind(this))):(this.name_lb=this.seekChild(this.container_nd,"name",cc.Label),this.setIconName()),this.updateInfo(),this.data&&this.data.config&&(this.data.config.id==a.icon.seven_login?this.updateSevenLoginInfo():this.data.config.id!=a.icon.icon_charge1&&this.data.config.id!=a.icon.icon_charge2||this.updateFirstChargeInfo()),this.need_load&&this.updateIconRes()},registerEvent:function(){this.container_nd.on(cc.Node.EventType.TOUCH_END,function(){null==this.data&&null==this.data.config||(Utils.playButtonSound(1),o.getInstance().iconClickHandle(this.data.config.id,this.data.action_id))},this),null!=this.data&&(null==this.update_by_self_event&&(this.update_by_self_event=this.data.bind(n.UPDATE_SELF_EVENT,function(t){null==t?this.updateInfo():"res_id"==t?this.updateIconRes():"tips_status"==t&&this.updateTishiState()},this)),this.data.id==a.icon.seven_login&&this.addGlobalEvent(l.UPDATE_SEVEN_LOGIN_STATUS,function(){this.updateSevenLoginInfo()},this))},updateInfo:function(){this.updateTishiState(),this.updateIconRes(),this.setIconName(),this.data&&this.data.config&&(this.data.config.id!=a.icon.icon_charge1&&this.data.config.id!=a.icon.icon_charge2||this.updateFirstChargeInfo())},setIconName:function(){this.name_lb&&null!=this.data&&null!=this.data.config&&(this.data.real_name&&""!=this.data.real_name&&"null"!=this.data.real_name?this.name_lb.string=this.data.real_name:this.name_lb.string=this.data.config.icon_name)},updateSevenLoginInfo:function(){var t=r.getInstance().getModel().getMaxSevenDay();if(null!=t&&null!=t.day){var e=gdata("login_days_data","data_day",[t.day]);if(e){var i="";i=3==t.status?e.next_desc:e.day_desc,null==this.extend_label&&(this.extend_label=Utils.createLabel(20,new cc.Color(255,255,255,255),new cc.Color(52,13,0,255),0,-this.container_nd.getContentSize().height/2-12,"",this.container_nd,2,cc.v2(.5,.5)),this.node_list.push(this.extend_label)),this.extend_label.string=i}}},updateFirstChargeInfo:function(){if(null!=this.data){var t=this.data.status;null==this.extend_label&&(this.extend_label=Utils.createLabel(20,1,163,this.container_nd.getContentSize().width/2,-12,"",this.container_nd,2,cc.v2(.5,.5))),this.extend_label.string=0==t?Utils.TI18N("\u660e\u65e5\u53ef\u9886"):Utils.TI18N("\u53ef\u9886\u53d6")}},updateIconRes:function(){if(null!=this.root_wnd||null!=this.button_sp){if(null!=this.data&&null!=this.data.config)if(1==this.data.config.res_type){var t=this.data.real_res_id;""==t&&(t=this.data.res_id),(e=s.getFunctionRes(t))!=this.res_id&&(this.res_id=e,this.loadRes(e,function(t){this.button_sp.spriteFrame=t}.bind(this)))}else if(o.getInstance().getHideContainerStatus())if(this.data.id==a.icon.first_charge){var e;(e=s.getFunctionRes(this.data.res_id))!=this.res_id&&(this.res_id=e,this.loadRes(e,function(t){this.button_sp.spriteFrame=t}.bind(this))),this.button_sp.node.active=!1,null==this.icon_first_effect&&(this.icon_first_effect=s.getSpinePath(this.data.config.icon_effect),this.loadRes(this.icon_first_effect,function(t){this.skeleton.skeletonData=t,this.skeleton.setAnimation(0,PlayerAction.action,!0)}.bind(this)));for(var i=!1,n=1;n<=6;n++){if(1==r.getInstance().getModel().getFirstBtnStatus(n)){i=!0;break}}this.tishi_nd.active=i,c.getInstance().getRoleVo().vip_exp/10>=100?1==i?(this.skeleton.node.active=!0,this.button_sp.node.active=!1):(this.skeleton.node.active=!1,this.button_sp.node.active=!0):this.skeleton.node.active=!0}else null==this.icon_effect&&(this.icon_effect=s.getSpinePath(this.data.config.icon_effect),this.loadRes(this.icon_effect,function(t){this.skeleton.skeletonData=t,this.skeleton.setAnimation(0,PlayerAction.action,!0)}.bind(this)))}else this.need_load=!0},updateTime:function(){null!=this.data&&null!=this.data.config&&(this.data.end_time>0?this.setLessTime():this.removeTimeLabel())},setLessTime:function(){var t=this.data.end_time-gcore.SmartSocket.getTime();if(t<=0)this.removeTimeLabel();else{null==this.time_label&&(this.time_label=Utils.createLabel(17,new cc.Color(20,255,50,255),new cc.Color(0,0,0,255),0,-55,"",this.container_nd,1,cc.v2(.5,.5)));var e="";this.data.config.id==a.icon.champion?1==this.data.status?e=_.getTimeForFunction(t)+"\u540e\u5f00\u542f":2==this.data.status&&(e="\u8fdb\u884c\u4e2d:"+_.getTimeForFunction(t)):this.data.config.id==a.icon.godbattle?1==this.data.status?e="\u62a5\u540d\u4e2d:"+_.getTimeForFunction(t):2==this.data.status&&(e="\u8fdb\u884c\u4e2d:"+_.getTimeForFunction(t)):this.data.config.id==a.icon.guildwar?1==this.data.status?e=_.getTimeForFunction(t)+"\u540e\u5f00\u542f":2==this.data.status&&(e=_.getTimeForFunction(t)+"\u540e\u7ed3\u675f"):e=_.getTimeForFunction(t),this.setBaseTimeInfo(e)}},removeTimeLabel:function(){this.time_label&&(this.time_label.node.destroy(),this.time_label=null)},updateTishiState:function(){if(null!=this.tishi_nd&&null!=this.data){var t=this.data.getTipsStatus();if(this.tishi_nd.active=t,this.data.config.id==a.icon.friend||this.data.config.id==a.icon.mail){var e=this.data.getTipsNum();e>0&&null!=this.num_lb?(this.num_lb.string=e,this.num_lb.node.active=!0):this.num_lb.node.active=!1}}},setBaseTimeInfo:function(t){this.time_ticket_desc!=t&&(this.time_ticket_desc=t,this.time_label.string=t)},getData:function(){return this.data},onShow:function(t){},onHide:function(){},onDelete:function(){for(var t in this.node_list){var e=this.node_list[t];e instanceof cc.Node?(e.destroy(),e=null):(e.node.destroy(),e=null)}this.node_list=null,this.data&&(null!=this.update_by_self_event&&(this.data.unbind(this.update_by_self_event),this.update_by_self_event=null),this.data=null)}});cc._RF.pop()},{action_controller:"action_controller",action_event:"action_event",function_icon_vo:"function_icon_vo",mainui_const:"mainui_const",mainui_controller:"mainui_controller",pathtool:"pathtool",role_controller:"role_controller",timetool:"timetool"}],function_icon_vo:[function(t,e,i){"use strict";function s(t){"@babel/helpers - typeof";return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}cc._RF.push(e,"6323c6c9RBEWoj+IY7WdwxX","function_icon_vo");var n=cc.Class({extends:gcore.BaseEvent,ctor:function(){this.config=arguments[0]||{},this.pos=this.config.type||1,this.sort=this.config&&this.config.index||1,this.is_new=!1,this.is_lock=arguments[1],this.tips_status=!1,this.res_id=this.config.icon_res,this.unclick=!1,this.status=0,this.end_time=0,this.action_id=0,this.dynamicres_id=0,this.real_name="",this.tips_status_list={},this.real_res_id=""},setConfig:function(t){this.config=t},setLock:function(t){this.is_lock=t},setUnclick:function(t){this.unclick=t},update:function(t){if(null!=t&&null!=Utils.next(t)){if(1==Utils.getArrLen(t)){var e=t[0];if("object"==s(e)){e instanceof Object&&(this.id=e.id,this.status=e.status,this.int_args=e.int_args),this.int_args&&null!=Utils.next(this.int_args)&&(this.end_time=this.int_args[0].val||0);var i=e.ext_args;if(i&&Utils.next(i))for(var a in i){var o=i[a];if(1==o.type){this.dynamicres_id=o.val,this.real_name=o.str,0!=o.val&&this.changeDynamicResId();break}}}else if("number"==typeof e)this.status=e;else if("string"==typeof e){var l=Config.function_data.data_convert_icon[e];l&&(this.real_name=l.icon_name,this.real_res_id=l.icon_res)}}else Utils.getArrLen(t)>=2&&(this.status=t[0]||0,this.end_time=t[1]||0);this.fire(n.UPDATE_SELF_EVENT)}},setTipsStatus:function(t){if(t instanceof Object)if(null!=t.bid)this.tips_status_list[t.bid]=t;else for(var e in t){var i=t[e];null!=t[e].bid&&(this.tips_status_list[i.bid]=i)}else this.tips_status=null!=t?t:!this.tips_status;this.fire(n.UPDATE_SELF_EVENT,"tips_status")},getTipsStatus:function(){for(var t in this.tips_status_list){var e=this.tips_status_list[t];if(null!=e.num&&"number"==typeof e.num&&e.num>0)return!0}return this.tips_status},getTipsNum:function(){var t=0;if(this.tips_status_list&&Utils.next(this.tips_status_list))for(var e in this.tips_status_list){t+=this.tips_status_list[e].num||0}return t},changeDynamicResId:function(){if(0!=this.dynamicres_id){var t="icon"+this.dynamicres_id;this.changeIcon(t)}},getBattleIconRes:function(){return this.dynamicres_id||1},changeIcon:function(t){this.res_id=t,this.fire(n.UPDATE_SELF_EVENT,"res_id")},changeTime:function(t){this.end_time=t,this.fire(n.UPDATE_SELF_EVENT,"end_time")},getID:function(){if(null!=this.config)return this.config.id},_delete:function(){}});n.UPDATE_SELF_EVENT="FunctionIconVo.UPDATE_SELF_EVENT",n.type={right_top_1:1,right_top_2:2,right_bottom_1:3,right_bottom_2:4},e.exports=n,cc._RF.pop()},{}],functiontool:[function(t,e,i){"use strict";cc._RF.push(e,"eee01GOxiVCyLSGtDKZRmgs","functiontool"),window.delayOnce=function(t,e){if(e=e||1,t)gcore.Timer.set(function(t){t&&t()}.bind(this,t),1e3*e)},e.exports={getServerName:function(e){if(null==e)return"";var i="",s=t("role_controller").getInstance().getRoleVo();if(s){var n=e.split("_"),a=s.srv_id.split("_");return n[1]&&a[0]&&n[0]!=a[0]?i=Utils.TI18N("\u5f02\u57df"):n.length>1&&(i=cc.js.formatStr("S%s",n[n.length-1])),"robot_1"==e&&(i=name),i}}},cc._RF.pop()},{role_controller:"role_controller"}],"game-core-js-min":[function(t,e,i){"use strict";cc._RF.push(e,"e3218URp9BHeqDf5i/2UjvX","game-core-js-min");var s=s||{};e.exports=s;var n=cc.Class({ctor:function(){this._evt_idx=0,this._evt_list={}},bind:function(t,e,i){if(t){if(e){this._evt_list.hasOwnProperty(t)||(this._evt_list[t]={});var s=this._evt_idx++;return this._evt_list[t][s]={f:e,o:i},{evt:t,id:s}}cc.log("evt_func===null")}else cc.log("evt_label===null")},unbind:function(t){this._evt_list.hasOwnProperty(t.evt)&&(delete this._evt_list[t.evt][t.id],0==Object.keys(this._evt_list[t.evt]).length&&delete this._evt_list[t.evt])},fire:function(t){if(this._evt_list.hasOwnProperty(t)){var e=this._evt_list[t],i=Array.prototype.slice.apply(arguments);for(var s in i.shift(),e)e[s].f.apply(e[s].o,i)}}});s.BaseEvent=n;var a=t("proto_mate"),o={idx:0,ws:null,buffer:null,cmd_func_list:[],msg_list:[],diff_time:0,wait_time:0,getInstance:function(){return this},getTime:function(){return this.diff_time+parseInt(Date.now()/1e3)},getMsTime:function(){return 1e3*this.diff_time+Date.now()},setTime:function(t){this.diff_time=t-parseInt(Date.now()/1e3)},init:function(){this.is_init||(this.is_init=!0,Uint8Array.prototype.slice||(Uint8Array.prototype.slice=Array.prototype.slice),this.bindCmd(1199,this.on1199.bind(this)))},on1199:function(t){this.restHeartbeat(),this.setTime(t.time)},tick:function(){this.send(1199,{}),this.setTickTimer()},restHeartbeat:function(){this.wait_time=0},updateTimer:function(){this.ws&&(this.wait_time+=1),10<=this.wait_time?this.close():6<=this.wait_time&&this.send(1199,{})},setTickTimer:function(){this.heart_timer||(this.heart_timer=s.Timer.set(this.updateTimer.bind(this),1e3,-1))},stopHeart:function(){this.heart_timer&&(s.Timer.del(this.heart_timer),this.heart_timer=null)},clearTickTimer:function(){this.tick_timer&&(window.clearTimeout(this.tick_timer),this.tick_timer=null)},connect:function(t,e,i){i=i||"ws",OUT_NET&&(i="wss"),this.host=t,this.port=e,this.ws=i,this.buffer=null,this.msg_list=[],(i=new WebSocket(i+"://"+t+":"+e+"/websocket")).binaryType="arraybuffer";var n=i.net_id=++this.idx;this.ws=i,c.debug("socket_connect start",i,t,e,n),i.onopen=function(t){n==this.idx&&(c.debug("socket_connected",t,i),this.ws=i,s.GlobalEvent.fire(s.GlobalEvent.EVT_SOCKET_CONNECT),this.setTickTimer(),this.restHeartbeat())}.bind(this),i.onclose=function(t){n==this.idx&&(c.debug("socket_close",t),s.GlobalEvent.fire(s.GlobalEvent.EVT_SOCKET_DISCONNECT),this.clearTickTimer(),this.ws=null)}.bind(this),i.onerror=function(t){}.bind(this),i.onmessage=function(t){this.restHeartbeat(),this.doRecv(t.data)}.bind(this)},close:function(){this.ws&&(this.ws.close(),this.ws=null)},bindCmd:function(t,e){this.cmd_func_list.hasOwnProperty(t)||(this.cmd_func_list[t]=[]),this.cmd_func_list[t].push(e)},send:function(t,e){try{if(null==this.ws)return void c.debug("send_msg_socket_not_connect");var i=this.packData(t,e),s=new ArrayBuffer(i.length+4),n=new DataView(s);n.setUint32(0,i.length);for(var a=0;a<i.length;a++)n.setUint8(a+4,i[a]);this.ws.send(n.buffer)}catch(t){c.error("send_msg_error:"+t.message,t.stack)}},handleMsg:function(){if(0!=this.msg_list.length)for(var t=0;t<5;t++){var e=this.msg_list.shift();if(this.onCmdCallback(e.cmd,e.data),0==this.msg_list.length)return}},onCmdCallback:function(t,e){try{for(var i=this.cmd_func_list[t],s=0;s<i.length;s++)(0,i[s])(e)}catch(i){c.error("handle_msg_error:"+t+", err="+i.message+", data="+e,i,i.stack)}},doRecv:function(t){this.ws&&this.ws.net_id==this.idx?"string"!=typeof t?(t=null==this.buffer?new Uint8Array(t):this.buffer.concat(Array.from(new Uint8Array(t))),this.unpackBuffer(t)):c.info("recv=text= "+t):c.error("\u7f51\u7edc\u5207\u6362 \u672c\u534f\u8bae\u6570\u636e\u65e0\u6548",this.ws,this.idx)},unpackBuffer:function(t){if(t.length<6)this.buffer=t;else{var e=new DataView(new Uint8Array(t).buffer),i=e.getUint32(0,!1);8e4<i&&(c.error("data_to_long:"+i),this.ws.close());var s=t.length;if(!(s<i+4)){var n=0;try{n=e.getUint16(4,!1),this.unpackData(e,n,t,i)}catch(e){c.error(n+": unpackData_error:"+e.message,t,e.stack)}i+4<s?(c.socket("data_length==",n,i),this.unpackBuffer(t.slice(i+4))):this.buffer=null}}},unpackData:function(t,e,i,s){if(!a.recv.hasOwnProperty(e))throw new Error("unpackData\u67e5\u627e\u4e0d\u5230\u534f\u8bae\u5b9a\u4e49\uff1a"+e);if(this.cmd_func_list.hasOwnProperty(e)){var n={},o=a.recv[e];return this.unpackData_(t,i,n,o,6,s),this.msg_list.push({cmd:e,data:n}),c.socket("unpackData==end===== "+e,s),n}c.socket("\u534f\u8bae\u5904\u7406\u51fd\u6570\u672a\u5b9a\u4e49:"+e)},unpackData_:function(t,e,i,s,n,a){for(var o=0,l=s.length;o<l;o++){var r=s[o];switch(r.t){case 1:i[r.s]=t.getInt8(n,!1),n+=1;break;case 2:i[r.s]=t.getUint8(n,!1),n+=1;break;case 3:i[r.s]=t.getInt16(n,!1),n+=2;break;case 4:i[r.s]=t.getUint16(n,!1),n+=2;break;case 5:i[r.s]=t.getInt32(n,!1),n+=4;break;case 6:i[r.s]=t.getUint32(n,!1),n+=4;break;case 7:var c=t.getUint16(n,!1);n+=2;var _=new Uint8Array(e.slice(n,n+c)),h=String.fromCharCode.apply(null,_);i[r.s]=decodeURIComponent(escape(h)),n+=c;break;case 8:c=t.getUint32(n,!1),n+=4,i[r.s]=e.slice(n,n+c),n+=c;break;case 9:c=t.getUint16(n,!1),n+=2;var d=[];i[r.s]=d;for(var u=0;u<c;u++){var m={};d[u]=m,n=this.unpackData_(t,e,m,r.f,n,a)}}}return n},packData:function(t,e){if(!a.send.hasOwnProperty(t))throw new Error("unpackData\u67e5\u627e\u4e0d\u5230\u534f\u8bae\u5b9a\u4e49\uff1a"+t);var i=a.send[t],s=[];return this.i16ToBytes(s,t),this.packData_(s,i,e),s},packData_:function(t,e,i){for(var s=0,n=e.length;s<n;s++){var a=e[s],o=i[a.s];switch(a.t){case 1:case 2:t.push(new Uint8Array([o])[0]);break;case 3:case 4:this.i16ToBytes(t,o);break;case 5:case 6:this.i32ToBytes(t,o);break;case 7:this.strToBytes(t,o);break;case 8:var l=o.length;this.i32ToBytes(t,l);for(var r=0;r<l;r++)t.push(o[r]);break;case 9:for(l=o.length,this.i16ToBytes(t,l),r=0;r<l;r++)this.packData_(t,a.f,o[r])}}},strToBytes:function(t,e){var i=unescape(encodeURIComponent(e)),s=i.length;this.i16ToBytes(t,s);for(var n=0;n<s;n++)t.push(i.charCodeAt(n))},i16ToBytes:function(t,e){var i=new Uint8Array(new Uint16Array([e]).buffer);t.push(i[1]),t.push(i[0])},i32ToBytes:function(t,e){var i=new Uint8Array(new Uint32Array([e]).buffer);t.push(i[3]),t.push(i[2]),t.push(i[1]),t.push(i[0])}};o.init(),s.SmartSocket=o;var l={dataName:function(t){switch(window.DATA_TYPE||1){case 1:return t+".json";case 2:return"jsc/"+t+".json";case 3:return"jsc/"+t+".zip"}},parseData:function(e,i){switch(window.DATA_TYPE||1){case 1:case 2:return void(Config[e]=i);case 3:var s=t("pako"),n=t("base64").Base64;return void(Config[e]=JSON.parse(s.inflate(n.atob(i),{to:"string"})))}},getDataKeyVal:function(t,e,i,s){if(Config[t])if(Config[t][e]){if(Config[t][e][i]){var n=e+"_cache";Config[t][n]||(Config[t][n]={});var a=Config[t][n][i];if(!a){a={};var o=e+"_fields",l=Config[t][e][i],r=Config[t][o];if(!r)return l;for(var _=0,h=r.length;_<h;_++)a[r[_]]=l[_];Config[t][n][i]=a}return a}0!=s&&c.debug("config_data_not_found",t,e,i)}else 0!=s&&c.debug("config_data_not_found",t,e);else 0!=s&&c.debug("config_data_not_found",t)}};s.CoreUtils=l;var r={idx:1,evts:{},getInstance:function(){return this},bind:function(t,e,i){if(t){if(e){this.evts.hasOwnProperty(t)||(this.evts[t]={});var s=this.idx++;return this.evts[t][s]={f:e,o:i},{evt:t,id:s}}cc.log("evt_func===null")}else cc.log("evt_label===null")},unbind:function(t){this.evts.hasOwnProperty(t.evt)&&(delete this.evts[t.evt][t.id],0==Object.keys(this.evts[t.evt]).length&&delete this.evts[t.evt])},fire:function(t){if(this.evts.hasOwnProperty(t)){var e=this.evts[t],i=cc.js.shiftArguments.apply(null,arguments);for(var s in e)e[s].f.apply(e[s].o,i)}},EVT_SOCKET_CONNECT:"EVT_SOCKET_CONNECT",EVT_SOCKET_DISCONNECT:"EVT_SOCKET_DISCONNECT"};s.GlobalEvent=r;var c={debug:function(){if(DEBUG_LOG)return cc.log.apply(null,cc.js.array.appendObjectsAt(Array.prototype.slice.call(arguments),["[debug]#"],0))},info:function(){if(INFO_LOG)return cc.log.apply(null,cc.js.array.appendObjectsAt(Array.prototype.slice.call(arguments),["[info]#"],0))},error:function(){if(ERROR_LOG)return cc.error.apply(null,cc.js.array.appendObjectsAt(Array.prototype.slice.call(arguments),["[error]#"],0))},socket:function(){if(SOCKET_LOG)return cc.log.apply(null,cc.js.array.appendObjectsAt(Array.prototype.slice.call(arguments),["[socket]#"],0))}};s.Log=c;var _={getInstance:function(){return this},get:function(t,e){if(this[t])return this[t];var i=cc.sys.localStorage.getItem(t);return i||(i=e),i&&(this[t]=i),i},set:function(t,e,i){this[t]=e,0!=i&&cc.sys.localStorage.setItem(t,this[t])},del:function(t){delete this[t],cc.sys.localStorage.removeItem(t)},clear:function(){cc.sys.localStorage.clear()},setBool:function(t,e,i){this.set(t,e.toString(),i)},getBool:function(t){return"false"!=this.get(t)},setInt:function(t,e,i){this.set(t,e.toString(),i)},getInt:function(t){return Number(this.get(t,"0"))},setObject:function(t,e,i){this.set(t,JSON.stringify(e),i)},getObject:function(t){return JSON.parse(this.get(t,"{}"))}};s.SysEnv=_;var h={idx:1,timer:{},getInstance:function(){return this},set:function(t,e,i,s){return e=e||1e3,i=i||1,s||(s=this.idx++),this.del(s),this.timer[s]=window.setTimeout(function(){1==i?this.del(s):this.set(t,e,i-1,s),t()}.bind(this),e),s},del:function(t){this.timer.hasOwnProperty(t)&&(window.clearTimeout(this.timer[t]),delete this.timer[t])}};s.Timer=h,cc._RF.pop()},{base64:"base64",pako:"pako",proto_mate:"proto_mate"}],game_views:[function(t,e,i){"use strict";cc._RF.push(e,"cd98dYaRCNFELc5JdeLIbzW","game_views");var s=t("story_controller"),n=t("guide_controller");window.WaitingStaus={CONNECT:1,LOADING:2},cc.Class({extends:cc.Component,properties:{},onLoad:function(){this.scene_tag=this.node.getChildByName("scene_tag"),this.battle_tag=this.node.getChildByName("battle_tag"),this.effect_tag=this.node.getChildByName("effect_tag"),this.ui_tag=this.node.getChildByName("ui_tag"),this.win_tag=this.node.getChildByName("win_tag"),this.top_tag=this.node.getChildByName("top_tag"),this.dialogue_tag=this.node.getChildByName("dialogue_tag"),this.msg_tag=this.node.getChildByName("msg_tag"),this.reconnect_tag=this.node.getChildByName("reconnect_tag"),this.loading_tag=this.node.getChildByName("loading_tag"),this.fille_nd=this.node.getChildByName("fille_node"),this.left_fill_bg=this.fille_nd.getChildByName("left_bg"),this.right_gill_bg=this.fille_nd.getChildByName("right_bg");var t=.5*(cc.winSize.width-720)+50;this.left_fill_bg.width=t,this.right_gill_bg.width=t,this.touch_cp=this.msg_tag.addComponent(cc.BlockInputEvents),this.touch_cp.enabled=!1},start:function(){},initMsgView:function(){LoaderManager.getInstance().loadRes("spine/E51110/action.atlas",function(t){this.touch_effect_nd=new cc.Node,this.loading_tag.addChild(this.touch_effect_nd),this.touch_efftct_sk=this.touch_effect_nd.addComponent(sp.Skeleton),this.touch_efftct_sk.skeletonData=t}.bind(this)),this.loading_tag.on(cc.Node.EventType.TOUCH_END,function(t){if(!n.getInstance().isInGuide()&&!s.getInstance().isInStory()&&this.touch_efftct_sk&&this.touch_effect_nd){var e=t.touch.getLocation(),i=this.loading_tag.convertToNodeSpaceAR(e);this.touch_effect_nd.position=i,this.touch_efftct_sk.setAnimation(0,"action",!1)}},this),this.loading_tag._touchListener&&this.loading_tag._touchListener.setSwallowTouches(!1)},initWaitingView:function(){var t=this.mask_nd=new cc.Node;t.setContentSize(this.loading_tag.getContentSize()),window.isMobile&&window.FIT_HEIDGHT&&(t.scale=FIT_SCALE),this.loading_tag.addChild(t),this.touch_block=t.addComponent(cc.BlockInputEvents);var e=this.waitint_mask=t.addComponent(cc.Graphics);e.clear(),e.fillColor=cc.color(0,0,0,168),e.rect(-.5*t.width,t.height*FIT_SCALE*-.5,t.width,t.height*FIT_SCALE),e.fill();var i=this.skeleton_nd=new cc.Node;this.mask_nd.addChild(i);this.waiting_sk=i.addComponent(sp.Skeleton);LoaderManager.getInstance().loadRes("spine/E51006/action.atlas",function(t){this.waiting_sk.skeletonData=t}.bind(this)),t.active=!1,this.touch_block.enabled=!1,i.active=!1},updateWaitingStatus:function(t){this._waiting_status!==t&&(t&&this.waiting_sk.skeletonData?(this.mask_nd.active=!0,this.skeleton_nd.active=!0,this.touch_block.enabled=!0,t==WaitingStaus.CONNECT?this.waiting_sk.setAnimation(0,"action",!0):t==WaitingStaus.LOADING&&(this.waiting_sk.setAnimation(0,"action1",!0),this.cancle_timer=gcore.Timer.set(function(){this._waiting_status==WaitingStaus.LOADING&&this.updateWaitingStatus(!1)}.bind(this),6e3,1))):(this.mask_nd.active=!1,this.skeleton_nd.active=!1,this.cancle_timer&&(gcore.Timer.del(this.cancle_timer),this.cancle_timer=null)),this._waiting_status=t)},showFrame:function(){this.fille_nd.active=!0},forBidTouch:function(){this.touch_cp.enabled=!0},cancelTouch:function(){this.touch_cp.enabled=!1}}),cc._RF.pop()},{guide_controller:"guide_controller",story_controller:"story_controller"}],gamestart:[function(t,e,i){"use strict";cc._RF.push(e,"6ac98UJ8W1KqKWD6zsw9E9A","gamestart"),t("baseclass"),t("basecontroller"),t("baseview"),t("basepanel"),t("global"),t("viewmanager"),t("globalmessagemgr"),t("config"),window.Config={},window.gcore=t("game-core-js-min"),window.Log=gcore.Log,window.gdata=gcore.CoreUtils.getDataKeyVal,window.xhr=cc.loader.getXMLHttpRequest(),window.DEBUG=!0;var s=t("loadermanager"),n=t("login_controller");t("ZipLoader"),t("downloadmanager");cc.Class({extends:cc.Component,properties:{game_canvas:{default:null,type:cc.Canvas}},ctor:function(){this.finish_loading=!1,this.preload_loading=!1,window.game=this},onLoad:function(){this.adjustFrame(),cli_log&&cli_log.log_loading_start&&cli_log.log_loading_start();var t=SCREEN_WIDTH/SCREEN_HEIGHT,e=cc.view.getFrameSize(),i=e.width/e.height;window.isMobile=!0,cc.sys.os!=cc.sys.OS_OSX&&cc.sys.os!=cc.sys.OS_WINDOWS&&cc.sys.os!=cc.sys.OS_LINUX||(window.isMobile=!1),OUT_NET||(window.isMobile=!0,window.WEN_DING_FU&&(cc.sys.os!=cc.sys.OS_OSX&&cc.sys.os!=cc.sys.OS_WINDOWS&&cc.sys.os!=cc.sys.OS_LINUX||(window.isMobile=!1))),isMobile?i>t?(window.FIT_HEIDGHT=!0,this.game_canvas.fitHeight=!0,this.game_canvas.fitWidth=!1,window.FIT_SCALE=Math.ceil(i/t*100)/100):(window.FIT_WIDTH=!0,this.game_canvas.fitHeight=!1,this.game_canvas.fitWidth=!0,window.FIT_SCALE=Math.ceil(t/i*100)/100):(this.game_canvas.fitHeight=!0,this.game_canvas.fitWidth=!0,window.FIT_SCALE=1);var a=this.node.addComponent(cc.Graphics);a.clear(),a.fillColor=cc.color(111,111,111,128),a.rect(-.5*this.node.width,-.5*this.node.height,this.node.width,this.node.height),a.fill(),this.scheduleOnce(function(){s.getInstance().loadPrefab("prefab/login/game_views",function(t){if(t){var e=t;this.node.addChild(e),this.views_js=e.addComponent("game_views"),this.views_js.initWaitingView(),this.initViewTags(this.views_js),1!=window.FIT_SCALE||window.isMobile||this.views_js.showFrame()}}.bind(this));var t=URL_CONFIG+"?platform="+PLATFORM+"&chanleId="+CHANNEL+"&time="+Date.now();cc.loader.load(t,function(t,e){for(var i in e=JSON.parse(e),cc.log("DDDDDDDDDDDDDDDDDDD"),cc.log(e),e)Log.debug(i,e[i]),window[i]=e[i];this.url_init=!0,this.view_init&&n.getInstance().openLoginWindow({status:!0,index:1})}.bind(this)),this.initPreloadRes()}.bind(this),.1),window.ImportConfigs&&console.log(window.ImportConfigs)},initViewTags:function(t){ViewManager.getInstance().addSceneNode(SCENE_TAG.scene,t.scene_tag),ViewManager.getInstance().addSceneNode(SCENE_TAG.battle,t.battle_tag),ViewManager.getInstance().addSceneNode(SCENE_TAG.effect,t.effect_tag),ViewManager.getInstance().addSceneNode(SCENE_TAG.ui,t.ui_tag),ViewManager.getInstance().addSceneNode(SCENE_TAG.win,t.win_tag),ViewManager.getInstance().addSceneNode(SCENE_TAG.top,t.top_tag),ViewManager.getInstance().addSceneNode(SCENE_TAG.dialogue,t.dialogue_tag),ViewManager.getInstance().addSceneNode(SCENE_TAG.msg,t.msg_tag),ViewManager.getInstance().addSceneNode(SCENE_TAG.reconnect,t.reconnect_tag),ViewManager.getInstance().addSceneNode(SCENE_TAG.loading,t.loading_tag),this.view_init=!0,n.getInstance().openLoginWindow({status:!0,index:1})},initConfigs:function(e){s.getInstance().initConfigs(function(i){if(i>1&&(i=1),"number"==typeof i)n.getInstance().updateLoading(.5*i),n.getInstance().updateSeconLoading(i);else{t("role_controller").getInstance();var s=t("modulelist");for(var a in s.module_list){var o=t(s.module_list[a]);o.getInstance&&o.getInstance()}e&&e()}}.bind(this))},updateProtoProgress:function(t){var e=.5+.4*t;n.getInstance().updateLoading(e),n.getInstance().updateSeconLoading(t)},update:function(e){gcore.SmartSocket.handleMsg(),t("battle_controller").getInstance().update(e)},initMsgView:function(){this.views_js.initMsgView()},addGuideRes:function(){this._pre_load_res.push("prefab/drama/guide_main_view.prefab"),this._pre_load_res.push("prefab/drama/dramatalk_view.prefab")},addChapterRes:function(t){t||(t=1);var e=Config.dungeon_data.data_drama_world_info[1][t].map_id,i=PathTool.getBattleDrameBg(e);this._pre_load_res.push(i.s),this._pre_load_res.push(i.f)},addRenameRes:function(){this._pre_load_res.push("prefab/roleinfo/role_setname_view.prefab");var t=PathTool.getSpinePath(PathTool.getEffectRes(237),"action");this._pre_load_res.push(t)},initPreloadRes:function(){for(var t in this._pre_load_res=["spine/E50069/action.atlas"],cacheAtlas){var e=cacheAtlas[t];this._pre_load_res.push(e+".plist")}for(var i in cachePrefabs){var s="prefab/"+cachePrefabs[i]+".prefab";this._pre_load_res.push(s)}},preloadRes:function(e){var i=0;for(var a in this.preload_loading=!0,s.getInstance().initConfigScript(),this._pre_load_res)this.waiting_timer=gcore.Timer.set(function(o){s.getInstance().loadRes(o,function(s){var a=++i/this._pre_load_res.length,o=.5+.4*a;(n.getInstance().updateLoading(o),n.getInstance().updateSeconLoading(a),i==this._pre_load_res.length&&e)&&(this.preload_loading=!1,e(),OUT_NET&&t("gmcmd").show())}.bind(this,a))}.bind(this,this._pre_load_res[a]),100,this._pre_load_res.length)},updateLoadingStatus:function(t){this.finish_loading=t},updateWaitingStatus:function(t){this.views_js&&this.views_js.updateWaitingStatus(t)},relogin:function(){this.scheduleOnce(function(){"SH_SDK"==PLATFORM_TYPR?n.getInstance().openLoginWindow({status:!0,index:1}):window.location.reload()},2)},adjustFrame:function(){cc.sys.os==cc.sys.OS_ANDROID?cc.sys.osVersion<8?cc.game.setFrameRate(40):cc.game.setFrameRate(60):cc.sys.os==cc.sys.OS_IOS?cc.game.setFrameRate(40):cc.game.setFrameRate(60)}}),cc._RF.pop()},{ZipLoader:"ZipLoader",baseclass:"baseclass",basecontroller:"basecontroller",basepanel:"basepanel",baseview:"baseview",battle_controller:"battle_controller",config:"config",downloadmanager:"downloadmanager","game-core-js-min":"game-core-js-min",global:"global",globalmessagemgr:"globalmessagemgr",gmcmd:"gmcmd",loadermanager:"loadermanager",login_controller:"login_controller",modulelist:"modulelist",role_controller:"role_controller",viewmanager:"viewmanager"}],gift_select_item_panel:[function(t,e,i){"use strict";cc._RF.push(e,"52cc4oQJd9LYbs/Zl1qWqSH","gift_select_item_panel");var s=t("pathtool");cc.Class({extends:BasePanel,ctor:function(){this.width=544,this.height=128,this.index=arguments[0]||1,this.is_break=!1,this.old_lev=0,this.attr_list={},this.initPanel()},initConfig:function(){},initPanel:function(){this.root_wnd=new cc.Node("gift_select_item"),this.root_wnd.setAnchorPoint(.5,0),this.root_wnd.setContentSize(cc.size(this.width,this.height)),this.bg=Utils.createImage(this.root_wnd,null,0,this.height/2,cc.v2(.5,.5),!0,0,!0),this.bg.node.setContentSize(cc.size(this.width,this.height));var t=s.getCommonIcomPath("common_1029");this.loadRes(t,function(t){this.bg.spriteFrame=t}.bind(this)),this.goods_item=ItemsPool.getInstance().getItem("backpack_item"),this.goods_item.initConfig(!1,.9,!1,!0),this.goods_item.setParent(this.root_wnd),this.goods_item.show(),this.goods_item.setPosition(-205,65),this.goods_name=Utils.createLabel(24,new cc.Color(118,69,25,255),null,-112,this.height/2,"",this.root_wnd,0,cc.v2(0,.5)),this.registerEvent(),this.vo&&this.updateInfo()},registerEvent:function(){Utils.onTouchEnd(this.root_wnd,function(){this.vo&&this.call_fun&&this.call_fun(this.index,this.vo)}.bind(this),1)},setData:function(t){null!=t&&(this.vo=t,this.updateInfo())},updateInfo:function(){if(this.root_wnd){var t=Utils.getItemConfig(this.vo.base_id);if(t){this.goods_item.setData(t);var e=t.name||"",i=this.vo.quantity||1;this.goods_name.string=e+"*"+i}}},setSelected:function(t){t=t||!1;var e=s.getCommonIcomPath("common_1029");if(1==t)e=s.getCommonIcomPath("common_1020");this.loadRes(e,function(t){this.bg.spriteFrame=t}.bind(this))},isHaveData:function(){return!!this.vo},clickHandler:function(){this.call_fun&&call_fun(this.vo)},addCallBack:function(t){this.call_fun=t},getData:function(){return this.vo},onShow:function(t){},onHide:function(){},onDelete:function(){this.goods_item&&(this.goods_item.deleteMe(),this.goods_item=null),this.vo=null}});cc._RF.pop()},{pathtool:"pathtool"}],gift_select_window:[function(t,e,i){"use strict";cc._RF.push(e,"b00c3eFmMBH97uyPdz6r5+V","gift_select_window");var s=t("pathtool");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("backpack","gift_select"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Mini,this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){this.WIDTH=460,this.HEIGHT=350,this.GOODS_WIDTH=68,this.select_type=1},openCallBack:function(){this.main_panel=this.root_wnd.getChildByName("main_panel");var t=this.main_panel.getContentSize();this.close_btn=this.main_panel.getChildByName("close_btn"),this.top_panel=this.main_panel.getChildByName("top_panel"),this.top_panel.getChildByName("title_label").getComponent(cc.Label).string=Utils.TI18N("\u81ea\u9009\u793c\u5305"),this.use_btn=this.main_panel.getChildByName("use_btn"),this.use_btn.getChildByName("Label").getComponent(cc.Label).string=Utils.TI18N("\u4f7f\u7528"),this.scroll_view=this.seekChild("items_content"),this.desc_label=Utils.createRichLabel(24,new cc.Color(118,69,25,255),cc.v2(.5,1),cc.v2(t.width/2,625),null,400),this.main_panel.addChild(this.desc_label.node)},updateGiftList:function(e,i,s,n){this.giftid=e,this.giftBid=i,this.goods_list=s||[],this.choose_num=n||1,this.desc_label.string=cc.js.formatStr(Utils.TI18N("\u8bf7\u4ece\u4ee5\u4e0b\u5956\u52b1\u4e2d\u9009\u62e9%s\u4e2a"),this.choose_num),this.item_list||(this.item_list=[]),this.name_list||(this.name_list=[]);var a=this.scroll_view.getContentSize(),o=0,l=t("role_controller").getInstance().getRoleVo();for(var r in this.goods_list)this.goods_list[r].min_lev<=l.lev&&this.goods_list[r].max_lev>=l.lev&&(o+=1);var c=Math.max(a.height,128*o+20);this.scroll_view.setContentSize(cc.size(a.width,c));var _=1;for(var r in this.goods_list){var h=this.goods_list[r];if(h.min_lev<=l.lev&&h.max_lev>=l.lev){var d,u,m=h;d=a.width/2,u=c-128*_;var f=m.bid;if(!this.item_list[_]){var p=t("gift_select_item_panel");this.item_list[_]=new p(_),this.item_list[_].setParent(this.scroll_view)}this.item_list[_].setPosition(d,u);var g={base_id:f,quantity:m.num};this.item_list[_].setData(g),this.item_list[_].addCallBack(function(t,e){var i=t||1;this.clickCallBack(i,e.base_id,e.quantity)}.bind(this)),_+=1}}this.select_list=[]},clickCallBack:function(t,e,i){if(this.select_list&&this.select_list.length>0)for(var s=this.select_list.length-1;s>=0;s--){if(this.select_list[s].goods_id==t)return this.select_list.splice(s,1),void this.setSelectedState(t,!1)}if(this.select_list.length>=this.choose_num){var n=this.select_list.shift().goods_id;this.setSelectedState(n,!1)}this.select_list.push({goods_id:t,bid:e,num:i}),this.setSelectedState(t,!0)},setSelectedState:function(t,e){if(this.item_list)for(var i in this.item_list){var s=this.item_list[i];s.index&&s.index==t&&s.setSelected(e)}},registerEvent:function(){Utils.onTouchEnd(this.use_btn,function(){if(this.select_list&&this.select_list.length>=this.choose_num){var e=this.giftid,i=[];for(var s in this.select_list)i.push({name:1,value:this.select_list[s].bid,str:""}),this.select_list[s].num;var n=t("backpack_const");this.model.getPackItemNumByBid(n.Bag_Code.BACKPACK,this.giftBid)>1&&1==this.choose_num?this.ctrl.openBatchUseItemView(!0,this.gift_vo,1,i):(this.ctrl.sender10515(e,1,i),this.ctrl.closeGiftSelectPanel())}else message(cc.js.formatStr(Utils.TI18N("\u8bf7\u9009\u62e9<color=#5a503c>%d\u4e2a</color>\u7269\u54c1\uff01"),this.choose_num))}.bind(this),1),Utils.onTouchEnd(this.close_btn,function(){this.ctrl.closeGiftSelectPanel()}.bind(this),2)},openRootWnd:function(t){var e=1;if(this.gift_vo=t,t){var i=t.id,s=t.base_id,n=[];if(Config.gift_data.data_choose_gift[s]){var a=Utils.getItemConfig(s);if(a&&a.ext&&a.ext.length>0)for(var o in a.ext)e=a.ext[o];var l=Config.gift_data.data_choose_gift[s];for(var o in l)n.push(l[o])}n.sort(Utils.tableLowerSorter(["sort_id"])),this.updateGiftList(i,s,n,e)}},closeCallBack:function(){for(var t in this.item_list)this.item_list[t].deleteMe();this.item_list=null,this.select_list=null,this.name_list=null}});cc._RF.pop()},{backpack_const:"backpack_const",gift_select_item_panel:"gift_select_item_panel",pathtool:"pathtool",role_controller:"role_controller"}],globalmessagemgr:[function(t,e,i){"use strict";cc._RF.push(e,"9060fLBPhlATpjglAtlk3gA","globalmessagemgr"),window.GlobalMessageMgr=cc.Class({cotr:function(){},properties:{vertical_array:[],vertical_array_tmp:[]},statics:{instance:null},showMoveVertical:function(t,e){if(""!=t){if(this.vertical_array.length>=3)return this.vertical_array_tmp.push({msg:t,color:e}),void(this.vertical_array_tmp.length>10&&this.vertical_array_tmp.shift());var i=ViewManager.getInstance().getSceneNode(SCENE_TAG.msg),s=new cc.Node;s.setAnchorPoint(.5,.5),s.setPosition(0,300),i.addChild(s);var n=s.addComponent(cc.Sprite);this.loadRes(PathTool.getUIIconPath("common","common_90056"),function(t){s&&s.isValid&&(n.spriteFrame=t)}.bind(this)),n.type=cc.Sprite.Type.SLICED,n.sizeMode=cc.Sprite.SizeMode.CUSTOM,n.node.setContentSize(500,60);var a=Utils.createRichLabel(24,new cc.Color(255,218,47,255),cc.v2(.5,.5),cc.v2(0,0),26,500,s);a.handleTouchEvent=!1,a.horizontalAlign=cc.macro.TextAlignment.CENTER,a.string=StringUtil.parseStr(t).string;var o=StringUtil.parseStr(t).resArr;if(o)for(var l in o)this.loadRes(PathTool.getItemRes(o[l]),function(t){s&&s.isValid&&(a.spriteFrame=t)}.bind(this));s.rict_text_nd=a.node;var r=cc.sequence(cc.delayTime(2),cc.removeSelf(),cc.callFunc(function(){var t=this.vertical_array.shift();if(t.destroy(),t=null,this.vertical_array_tmp.length>0){var e=this.vertical_array_tmp.shift();this.showMoveVertical(e.msg,e.color)}},this));this.vertical_array.push(s),this.sortPosition(),s.rict_text_nd.runAction(r)}},sortPosition:function(){var t=this.vertical_array.length;if(t>0)for(var e,i=this.vertical_array[t-1].height,s=t;s>0;s--){var n=this.vertical_array[s-1];if(null==n)return;n.stopAllActions(),t==s?(n.setPosition(cc.v2(0,230)),e=230+n.height):(n.setPosition(cc.v2(0,e)),e+=n.height),n.runAction(cc.moveBy(.5,0,i))}},loadRes:function(t,e){null==this.res_list&&(this.res_list={}),this.res_list[t]?e(this.res_list[t]):LoaderManager.getInstance().loadRes(t,function(i){this.is_close||this.delete||(this.res_list[t]=i,e(i))}.bind(this))},showPowerMove:function(e,i,s){t("mainui_controller").getInstance().showPower(e,s)},showMoveHorizontal:function(t,e){var i=ViewManager.getInstance().getSceneNode(SCENE_TAG.msg);if(i){var s=this,n=cc.size(682,38);if(null==this.per_bg_icon){var a=new cc.Node,o=a.addComponent(cc.Widget);o.isAlignTop=!0,o.isAlignHorizontalCenter=!0,o.top=55,o.horizontalCenter=0;var l=a.addComponent(cc.Sprite);this.loadRes(PathTool.getUIIconPath("common","common_90056"),function(t){a&&a.isValid&&(l.spriteFrame=t)}.bind(this)),l.type=cc.Sprite.Type.SLICED,l.sizeMode=cc.Sprite.SizeMode.CUSTOM,a.setAnchorPoint(.5,1),a.setContentSize(n),i.addChild(a),o.updateAlignment(),this.per_bg_icon=a}null==this.msg_save_arr&&(this.msg_save_arr=[]),this.msg_save_arr.length>5&&this.msg_save_arr.pop(),this.msg_save_arr.push({msg:t,delay_time:3,color:e}),1!=this.has_msg_moveing&&function t(){if(s.has_msg_moveing=!1,s.per_move_msg_word&&(s.per_move_msg_word.node.destroy(),s.per_move_msg_word=null),s.msg_save_arr.length>0){s.has_msg_moveing=!0;var e=s.msg_save_arr.pop(),i=r(e.msg,e.color),a=e.delay_time||3;s.per_move_msg_word=i;var o=null,l=i.node;if(l.width>n.width){i.node.x=-n.width/2;var c=cc.moveTo(.1,cc.v2(i.node.x,-n.height/2)),_=cc.moveTo(a,cc.v2(i.node.x-(l.width-n.width)-5,-n.height/2)),h=cc.delayTime(1);o=cc.sequence(c,_,h,cc.callFunc(t))}else{i.node.x=-l.width/2;var d=cc.delayTime(a),u=cc.moveTo(.1,cc.v2(i.node.x,-n.height/2));o=cc.sequence(u,d,cc.callFunc(t))}i.node.runAction(o)}else s.msg_save_arr=null,s.per_bg_icon&&(s.per_bg_icon.destroy(),s.per_bg_icon=null)}()}function r(t,e){var i=s.createhorizontalLabel(t,e,0,20);return i.node.setAnchorPoint(cc.v2(0,.5)),i.node.setPosition(cc.v2(0,-n.height/2-n.height)),s.per_bg_icon.addChild(i.node),i}},createhorizontalLabel:function(t,e,i,s){var n=(new cc.Node).addComponent(cc.RichText);return n.node.color=e||new cc.Color(25,30,40),n.maxWidth=i||0,n.fontSize=s,n.string=t,n}}),GlobalMessageMgr.getInstance=function(){return GlobalMessageMgr.instance||(GlobalMessageMgr.instance=new GlobalMessageMgr),GlobalMessageMgr.instance},window.message=function(t,e){null!=t&&""!=t&&GlobalMessageMgr.getInstance().showMoveVertical(t,e)},window.showAssetsMsg=function(t,e){message(t,e)},cc._RF.pop()},{mainui_controller:"mainui_controller"}],global:[function(t,e,i){"use strict";cc._RF.push(e,"40f6bcelL5Py5PrWRXbF0RP","global"),window.ButtonSound={Normal:1,Close:2,Tab:3,Cus:4},window.SCENE_TAG={scene:0,battle:1,effect:2,ui:3,win:4,top:5,dialogue:6,msg:7,reconnect:8,loading:9},window.LoadingDes={3:18,6:8,9:20,10:16,11:55},window.ScrollViewDir={vertical:1,horizontal:2},window.ScrollViewFuncType={UpdateCellByIndex:1,CreateNewCell:2,NumberOfCells:3,OnCellTouched:4},window.ScrollViewStartPos={top:1,bottom:2},window.WinType={Tips:1,Mini:2,Big:3,Full:4},window.BackPackItem={Width:120,Height:120},window.EventId={EVT_ROLE_CREATE_SUCCESS:"EVT_ROLE_CREATE_SUCCESS",UPDATE_ROLE_ATTRIBUTE:"UPDATE_ROLE_ATTRIBUTE",ROLE_EVENT_BASE_ATTR:"ROLE_EVENT_BASE_ATTR",EVT_RE_LINK_GAME:"EVT_RE_LINK_GAME",GET_ALL_DATA:"GET_ALL_DATA",ADD_GOODS:"ADD_GOODS",DELETE_GOODS:"DELETE_GOODS",MODIFY_GOODS_NUM:"MODIFY_GOODS_NUM",COMPOSITE_RESULT:"COMPOSITE_RESULT",COMPOSITE_RECORD:"COMPOSITE_RECORD",ENTER_FIGHT:"ENTER_FIGHT",EXIT_FIGHT:"EXIT_FIGHT",CAN_OPEN_LEVUPGRADE:"CAN_OPEN_LEVUPGRADE",OPEN_SRV_DAY:"OPEN_SRV_DAY",CHAT_NEWMSG_FLAG:"CHAT_NEWMSG_FLAG",LOADING_FINISH:"LOADING_FINISH",VOICE_SETTING:"VOICE_SETTING"},window.PlayerAction={stand:"stand",stand_1:"stand2_1",run:"run",run_1:"run_1",sit:"sit",action:"action",action_1:"action1",action_2:"action2",action_3:"action3",action_4:"action4",action_5:"action5",action_6:"action6",action_7:"action7",action_8:"action8",battle_stand:"stand2",hurt:"hurt",fun:"fun",show:"show",special_action_0:"status_0",special_action_1:"status_1",special_action_2:"status_2"},window.SayConfig={default_bubble:{val:1e3,desc:"\u9ed8\u8ba4\u804a\u5929\u6c14\u6ce1"},say_repeak_vip:{val:4,desc:"VIPX\u4ee5\u4e0b\u9650\u5236"},say_repeak_lev:{val:80,desc:"X\u7ea7\u4ee5\u4e0b\u9650\u5236"},say_repeak_span:{val:5,desc:"\u6700\u8fd1X\u5206\u949f\u5185\u7684\u53d1\u8a00\u6761\u6570"},say_repeak_num:{val:3,desc:"\u7b5b\u9009\u7684\u53d1\u8a00\u6761\u6570"},say_repeak_similar:{val:60,desc:"\u5c01\u7981\u7684\u76f8\u4f3c\u5ea6\uff08\u767e\u5206\u6bd4\uff09"},say_repeak_time:{val:10,desc:"\u5c01\u7981\u7684\u5c0f\u65f6"},say_string_length:{val:31,desc:"\u9650\u5236\u7684\u5b57\u7b26\u4e32\u957f\u5ea6\uff08\u4e2d\u65873\u4e2a\u5b57\u7b26\uff0c\u82f1/\u6570\u4e00\u4e2a\u5b57\u7b26\uff09"},cooldown_same_province:{val:5,desc:"\u540c\u7701\u53d1\u8a00\u51b7\u5374"},cooldown_cross_service:{val:10,desc:"\u8de8\u670d\u53d1\u8a00\u51b7\u5374"},cooldown_world:{val:10,desc:"\u4e16\u754c\u53d1\u8a00\u51b7\u5374"},cooldown_guild:{val:5,desc:"\u516c\u4f1a\u53d1\u8a00\u51b7\u5374"}},window.SCREEN_WIDTH=720,window.SCREEN_HEIGHT=1280,window.BATTLE_VIEW_BACK_LAYER_Z=0,window.BATTLE_VIEW_BLACK_LAYER_Z0=3,window.BATTLE_VIEW_UI_LAYER_Z=40,window.BATTLE_VIEW_UI_LAYER_TAG=40,window.BATTLE_VIEW_ROLE_LAYER_Z=25,window.BATTLE_VIEW_ROLE_LAYER_TAG=20,window.BATTLE_VIEW_TOP=999,window.BATTLE_VIEW_EFFECT_LAYER_Z0=20,window.BATTLE_VIEW_EFFECT_LAYER_Z2=15,window.FILTER_CHARGE=!1,window.IS_VERIFYIOS=!1,window.IS_SHOW_CHARGE=!0,window.IS_LOADING=!1,window.IS_RESET=!1,window.GIRD_POS_OFFSET=9,window.Pos2GridLeft=[{x:27,y:15},{x:28,y:21},{x:29,y:27},{x:17,y:15},{x:18,y:21},{x:19,y:27},{x:7,y:15},{x:8,y:21},{x:9,y:27},{x:7,y:43}],window.Pos2GridRight=[{x:53,y:15},{x:52,y:21},{x:51,y:27},{x:63,y:15},{x:62,y:21},{x:61,y:27},{x:73,y:15},{x:72,y:21},{x:71,y:27},{x:73,y:43}],window.NormalPosGridRight=[{x:42,y:15},{x:42,y:21},{x:42,y:27},{x:42,y:15},{x:42,y:21},{x:42,y:27},{x:42,y:15},{x:42,y:21},{x:42,y:27},{x:42,y:43}],window.BattleRoleZorder=[[998,995,992,999,996,993,997,994,991,990],[998,995,992,999,996,993,997,994,991,990]],window.Pos_To_Col=[0,1,2,0,1,2,0,1,2],window.VIPTABCONST={CHARGE:1,ACC_CHARGE:2,VIP:3,DAILY_GIFT:4,PRIVILEGE:5},window.VIPREDPOINT={MONTH_CARD:1,VIP_TAB:2,DAILY_AWARD:3,PRIVILEGE:4},window.NEED_ADAPTIVE_SDK={WX_SDK:"WX_SDK",SH_SDK:"SH_SDK",QQ_SDK:"QQ_SDK"},window.SHOW_BAIDU_TIEBA=!0,window.SHOW_SINGLE_INVICODE=!0,window.SHOW_BIND_PHONE=!0,window.SHOW_WECHAT_CERTIFY=!0,window.SHOW_GAME_SHARE=!0,window.WECHAT_SUBSCRIPTION="sy_sszg",window.cacheAtlas=["res/item/equip","res/item/heads","res/item/items"],window.cachePrefabs=["hero/hero_bag_window","hero/hero_main_info_window","hero/hero_main_tab_train_panel","battle/battle_button_list","battle/battle_real_role","mainui/mainui_view","partnersummon/partnersummon_window","partnersummon/partnersummon_item"],window.CacheAnimas=["H30009","E53051","E53052","E53070","H30012","E53007","E50012","H30016","E53010","E50028","E53204","E53210","H30091","H31091","H32091","E53015","E50030","E53061","E53813","E53814","E53265","E53266","E50033","H30022","E50007","E53028","E50001","H30045","E53009","E50027","E53057","E53248","H30003","E53137","E53073","E50051","E50002","H30018","E53005","E50010","E53259","E50057","H30027","E53035","E53033","E50041","E50053","E53237","H30088","E53139","E53138","E50004","H30025","E53137"],window.WorshipType={normal:0,godbattle:1,ladder:3,crossarena:4,home:5,crosschampion:6},window.TASK_TIPS=!1,cc._RF.pop()},{}],gmcmd:[function(require,module,exports){"use strict";function _typeof(t){"@babel/helpers - typeof";return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}cc._RF.push(module,"5c013vN5KFCGKEPXIcgtbFA","gmcmd");var LoaderManager=require("loadermanager"),PathTool=require("pathtool"),StringUtil=require("string_util"),GmCmd={getInstance:function(){return this},cli_cmds:[{name:"\u5173\u95edGM",func:function(){this.show()}},{name:"net_ping",func:function(){this.ping_timer_id?(gcore.Timer.del(this.ping_timer_id),this.ping_timer_id=void 0,self.label.string=""):this.ping_timer_id=gcore.Timer.set(function(){gcore.SmartSocket.send(1198,{time:this.get_ping_time()})}.bind(this),1e3,-1)}},{name:"\u65ad\u7f51",func:function(){gcore.SmartSocket.close()}},{name:"FPS",func:function(){cc.debug.setDisplayStats(cc.game.config.showFPS=!cc.game.config.showFPS)}},{name:"SOCKET",func:function(){window.SOCKET_LOG=0==window.SOCKET_LOG}},{name:"UI\u8c03\u8bd5",func:function(){this.openDebugUI()}},{name:"\u7cfb\u7edf\u4fe1\u606f",func:function(){cc.sys.dump()}},{name:"\u5728\u7ebf\u798f\u5229",func:function(){require("onlinegift_controller").getInstance().openOnlineGiftView(!0)}}],handleInput:function(t){if(""!=t&&"@"!=t.charAt(0))if("."!=t.charAt(0))this.saveMsg(t),gcore.SmartSocket.send(10399,{msg:t});else{for(var e=t.substr(1).split("."),i=window,s=0,n=e.length;s<n;s++)i=i[e[s]];Log.info(i)}},get_ping_time:function(){return Date.now()%1e7},show:function(){0==OUT_NET&&"sszgh5gy"==gcore.SysEnv.get("password")&&(SHOW_GM=!0),1==SHOW_GM&&(this.root?this.root.active=0==this.root.active:LoaderManager.getInstance().loadRes(PathTool.getPrefabPath("gm","gm_panel"),function(t){this.root=t,this.root.gm=!0;var e=this.root.getChildByName("gm_btn");this.input=this.root.getChildByName("editbox").getComponent(cc.EditBox),this.input.maxLength=300,this.label=this.root.getChildByName("msg").getComponent(cc.RichText),this.root.setPosition(.5*-SCREEN_WIDTH,.5*-SCREEN_HEIGHT),ViewManager.getInstance().addToSceneNode(this.root,SCENE_TAG.loading),e.on(cc.Node.EventType.TOUCH_END,function(t){this.move?this.move=!1:(this.debug_ui&&this.debug_ui.active&&(this.debug_ui.active=!1,this.setDebugUIObjBorder(this.debug_ui_obj1,!1)),this.showLayer())}.bind(this)),e.on(cc.Node.EventType.TOUCH_MOVE,function(t){var e=t.getTouches()[0].getDelta();this.root.x=this.root.x+e.x,this.root.y=this.root.y+e.y,0!==e.x&&0!==e.y&&(this.move=!0)},this),this.input.node.on("editing-did-ended",function(){this.handleInput(this.input.string)},this),this.cmds=gcore.SysEnv.getObject("gm_cmds").cmds||[],this.cmds.length>0&&(this.input.string=this.cmds[this.cmds.length-1]),gcore.SmartSocket.bindCmd(10391,this.on10391.bind(this)),gcore.SmartSocket.bindCmd(10399,this.on10399.bind(this)),gcore.SmartSocket.bindCmd(1198,this.on1198.bind(this)),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this),this.button=this.root.getChildByName("Button")}.bind(this)))},showLayer:function(){if(this.layer)this.layer.active=0==this.layer.active;else{this.layer=this.root.getChildByName("layer"),this.layer.active=!0;var t=[{name:"\u57fa\u7840\u529f\u80fd",list:this.cli_cmds},{name:"\u6700\u8fd1\u4f7f\u7528"}];if(Config&&Config.gm_data)for(var e in Config.gm_data.data_list){var i=Config.gm_data.data_list[e];1==i.is_show&&(0==i.list.length?t.push({name:i.tips,msg:i.info}):t.push({name:i.tips,list:i.list}))}this.showGmList(!0,t)}},showGmList:function(t,e){if(this.sub_layer&&this.sub_layer.active&&1!=t&&this.sub_layer!=t.layer&&(this.sub_layer.active=!1),1==t)for(var i=0;i<e.length;i++){var s=e[i];this.createGmButton(i,this.layer,s)}else if(t.layer)t.layer.lately?(t.layer.destroy(),t.layer=null,this.sub_layer=null):(t.layer.active=0==t.layer.active,this.sub_layer=t.layer);else{if(t.layer=new cc.Node,this.sub_layer=t.layer,this.layer.addChild(t.layer),t.layer.setAnchorPoint(0,1),t.layer.setPosition(0,t.y-25),!e){t.layer.lately=!0,e=[];for(i=0;i<this.cmds.length;i++)e.push({name:this.cmds[i],msg:this.cmds[i]})}for(i=0;i<e.length;i++){s=e[i];this.createGmButton(i,t.layer,s,"common_1018")}}},createGmButton:function(t,e,i,s){"number"==typeof i&&(i=0==(i=Config.gm_data.data_list[i]).list.length?{name:i.tips,msg:i.info}:{name:i.tips,list:i.list});var n=this.createButton(i.name,i.func||function(t){i.msg?gcore.SmartSocket.send(10399,{msg:i.msg}):this.showGmList(t.target,i.list)},s);n.setPosition(t%4*135+70,-(65*parseInt(t/4)+40)),e.addChild(n)},onKeyDown:function(t){this.keyCode=t.keyCode;var e=function(t){if(this.keyCode&&this.root.active){switch(this.keyCode){case cc.macro.KEY.up:this.cmds.length>1&&(this.cmds.unshift(this.cmds.pop()),this.saveMsg(this.cmds.pop()),t=t||1500);break;case cc.macro.KEY.down:this.cmds.length>0&&(this.saveMsg(this.cmds[0]),t=t||600);break;case cc.macro.KEY.enter:this.handleInput(this.input.string),t=null;break;case cc.macro.KEY.a:this.moveDebugUIObjPos(-1,0),t=t||100;break;case cc.macro.KEY.d:this.moveDebugUIObjPos(1,0),t=t||100;break;case cc.macro.KEY.w:this.moveDebugUIObjPos(0,1),t=t||100;break;case cc.macro.KEY.s:this.moveDebugUIObjPos(0,-1),t=t||100;break;default:t=null}t&&gcore.Timer.set(e,t,1,"gm_cmd_key_timer")}}.bind(this);e(2e3)},onKeyUp:function(t){this.keyCode==t.keyCode&&(this.keyCode=null)},on10391:function on10391(data){cc.log("DDDDDDDDDDDDDDDDDDD"),cc.log(data);var ret=eval(data.data);1==data.type&&("object"==_typeof(ret)?ret=JSON.stringify(ret):ret+="",gcore.SmartSocket.send(10391,{msg:ret}))},on10399:function(t){t.msg.length<500&&message(t.msg),Log.info(t.msg.split("\n"))},on1198:function(t){this.ping_timer_id&&(this.label.string="time:<color=#00ff00>"+(this.get_ping_time()-t.time)+"</color>,msg_len:<color=#00ff00>"+gcore.SmartSocket.msg_list.length+"</color>")},saveMsg:function(t){this.input.string=t;for(var e=this.cmds.length-1;e>=0;e--)this.cmds[e]==t&&this.cmds.splice(e,1);this.cmds.push(t),this.cmds.length>20&&this.cmds.shift(),gcore.SysEnv.setObject("gm_cmds",{cmds:this.cmds})},createButton:function(t,e,i){var s=cc.instantiate(this.button);if(s.active=!0,i){var n=PathTool.getCommonIcomPath(i);LoaderManager.getInstance().loadRes(n,function(t){s.getComponent(cc.Sprite).spriteFrame=t}.bind(this))}return s.getChildByName("Label").getComponent(cc.Label).string=t,s.on(cc.Node.EventType.TOUCH_END,e,this),s},createLabel:function(t,e,i){var s=new cc.Node,n=s.addComponent(cc.Label);return s.obj=n,n.string=t||"",n.fontSize=i||24,s.color=e||new cc.Color(255,0,0),s},openDebugUI:function(){if(this.layer.active=!1,this.debug_ui)this.debug_ui.active=0==this.debug_ui.active,this.setDebugUIObjBorder(this.debug_ui_obj1,!1);else{this.debug_ui=this.root.getChildByName("debug_ui"),this.debug_ui.active=!0;var t={};t.touch=this.debug_ui.getChildByName("touch_node"),t.name=this.debug_ui.getChildByName("name").getChildByName("msg").getComponent(cc.Label),t.type=this.debug_ui.getChildByName("type").getChildByName("msg").getComponent(cc.Label),t.node_w=this.debug_ui.getChildByName("node_w").getChildByName("editbox").getComponent(cc.EditBox),t.node_h=this.debug_ui.getChildByName("node_h").getChildByName("editbox").getComponent(cc.EditBox),t.node_sx=this.debug_ui.getChildByName("node_sx").getChildByName("editbox").getComponent(cc.EditBox),t.node_sy=this.debug_ui.getChildByName("node_sy").getChildByName("editbox").getComponent(cc.EditBox),t.node_ax=this.debug_ui.getChildByName("node_ax").getChildByName("editbox").getComponent(cc.EditBox),t.node_ay=this.debug_ui.getChildByName("node_ay").getChildByName("editbox").getComponent(cc.EditBox),t.node_wx=this.debug_ui.getChildByName("node_wx").getChildByName("editbox").getComponent(cc.EditBox),t.node_wy=this.debug_ui.getChildByName("node_wy").getChildByName("editbox").getComponent(cc.EditBox),t.node_x=this.debug_ui.getChildByName("node_x").getChildByName("editbox").getComponent(cc.EditBox),t.node_y=this.debug_ui.getChildByName("node_y").getChildByName("editbox").getComponent(cc.EditBox),t.node_c_r=this.debug_ui.getChildByName("node_c").getChildByName("editbox_r").getComponent(cc.EditBox),t.node_c_g=this.debug_ui.getChildByName("node_c").getChildByName("editbox_g").getComponent(cc.EditBox),t.node_c_b=this.debug_ui.getChildByName("node_c").getChildByName("editbox_b").getComponent(cc.EditBox),t.node_c_a=this.debug_ui.getChildByName("node_c").getChildByName("editbox_a").getComponent(cc.EditBox),t.show=this.debug_ui.getChildByName("show").getComponent(cc.Toggle),t.child_btn=this.debug_ui.getChildByName("child_btn"),t.parent_btn=this.debug_ui.getChildByName("parent_btn"),t.scroll_content=this.debug_ui.getChildByName("scrollview").getComponent(cc.ScrollView).content,t.scroll_item=t.scroll_content.getChildByName("item"),this.debug_ui_o=t,this.setDebugUIEvt(t)}this.debug_ui.active&&this.setDebugUIObj(this.input)},setDebugUIEvt:function(t){t.touch.on(cc.Node.EventType.TOUCH_END,function(t){this.selectDebugUIObj(t.getTouches()[0].getLocation())},this),t.show.node.on(cc.Node.EventType.TOUCH_END,function(t){this.debug_ui_obj1.active=!this.debug_ui_obj1.active},this),t.parent_btn.on(cc.Node.EventType.TOUCH_END,function(t){this.setDebugUIObj(this.debug_ui_obj.node||this.debug_ui_obj.parent)},this),t.node_w.node.on("editing-did-ended",function(e){this.debug_ui_obj1.width=Number(t.node_w.string),this.setDebugUIObjBorder(this.debug_ui_obj1,!0)},this),t.node_h.node.on("editing-did-ended",function(e){this.debug_ui_obj1.height=Number(t.node_h.string),this.setDebugUIObjBorder(this.debug_ui_obj1,!0)},this),t.node_sx.node.on("editing-did-ended",function(e){this.debug_ui_obj1.scaleX=Number(t.node_sx.string),this.setDebugUIObjBorder(this.debug_ui_obj1,!0)},this),t.node_sy.node.on("editing-did-ended",function(e){this.debug_ui_obj1.scaleY=Number(t.node_sy.string),this.setDebugUIObjBorder(this.debug_ui_obj1,!0)},this),t.node_ax.node.on("editing-did-ended",function(e){this.debug_ui_obj1.setAnchorPoint(Number(t.node_ax.string),Number(t.node_ay.string)),this.setDebugUIObjBorder(this.debug_ui_obj1,!0)},this),t.node_ay.node.on("editing-did-ended",function(e){this.debug_ui_obj1.setAnchorPoint(Number(t.node_ax.string),Number(t.node_ay.string)),this.setDebugUIObjBorder(this.debug_ui_obj1,!0)},this),t.node_x.node.on("editing-did-ended",function(e){this.debug_ui_obj1.x=Number(t.node_x.string),this.setDebugUIObjBorder(this.debug_ui_obj1,!0)},this),t.node_y.node.on("editing-did-ended",function(e){this.debug_ui_obj1.y=Number(t.node_y.string),this.setDebugUIObjBorder(this.debug_ui_obj1,!0)},this),t.node_c_a.node.on("editing-did-ended",function(e){this.debug_ui_obj1.opacity=Number(t.node_c_a.string)},this),t.node_c_r.node.on("editing-did-ended",function(e){this.setDebugUIObjColor(t)},this),t.node_c_g.node.on("editing-did-ended",function(e){this.setDebugUIObjColor(t)},this),t.node_c_b.node.on("editing-did-ended",function(e){this.setDebugUIObjColor(t)},this)},moveDebugUIObjPos:function(t,e){this.debug_ui&&this.debug_ui.active&&this.debug_ui_obj1&&(this.debug_ui_obj1.setPosition(this.debug_ui_obj1.x+t,this.debug_ui_obj1.y+e),this.setDebugUIObj(this.debug_ui_obj1))},setDebugUIObjColor:function(t){this.debug_ui_obj.fontColor?this.debug_ui_obj.fontColor=new cc.Color(Number(t.node_c_r.string),Number(t.node_c_g.string),Number(t.node_c_b.string)):this.debug_ui_obj1.color&&(this.debug_ui_obj.color=new cc.Color(Number(t.node_c_r.string),Number(t.node_c_g.string),Number(t.node_c_b.string)))},setDebugUIObj:function(t){if(t){this.setDebugUIObjBorder(this.debug_ui_obj1,!1),this.debug_ui_obj!=t&&this.updateChildNodes(t),this.debug_ui_obj=t;var e=this.debug_ui_o,i=t.node||t;this.debug_ui_obj1=i;var s=t.fontColor||i.color||{};e.show.isChecked=i.active,e.name.string=i._name||t.name||"",e.type.string=cc.js.getClassName(t)||"",e.node_w.string=i.width||0,e.node_h.string=i.height||0,e.node_sx.string=i.scaleX||0,e.node_sy.string=i.scaleY||0,e.node_ax.string=i.anchorX,e.node_ay.string=i.anchorY;var n=this.debug_ui_obj1.convertToWorldSpaceAR(cc.v2(0,0));e.node_wx.string=n.x||0,e.node_wy.string=n.y||0,e.node_x.string=i.x||0,e.node_y.string=i.y||0,e.node_c_r.string=s.getR&&s.getR()||0,e.node_c_g.string=s.getG&&s.getG()||0,e.node_c_b.string=s.getB&&s.getB()||0,e.node_c_a.string=i.opacity||0,this.setDebugUIObjBorder(i,!0)}},updateChildNodes:function(t){var e=this.debug_ui_items||[];this.debug_ui_items=e;for(var i=0,s=e.length;i<s;i++)e[i].active=!1;for(var n=0,a=0,o=t._components||[],l=0,r=o.length;l<r;l++)o[l].border||(n=this.createDebugUIItem("c",a++,o[l],n));for(var c=0,_=(o=t.children||[]).length;c<_;c++)o[c].border||(n=this.createDebugUIItem("n",a++,o[c],n));this.debug_ui_o.scroll_content.height=-n},createDebugUIItem:function(t,e,i,s){var n=this.debug_ui_items[e];n||((n=cc.instantiate(this.debug_ui_o.scroll_item)).on(cc.Node.EventType.TOUCH_END,function(t){this.setDebugUIObj(n.o)},this),this.debug_ui_o.scroll_content.addChild(n)),this.debug_ui_items[e]=n,n.active=!0,n.o=i;var a=i.node||i;return n.getComponent(cc.Label).string="["+t+"]"+(cc.js.getClassName(i)||"")+"("+(a._name||i.name||"name")+")",n.y=s,s-30},setDebugUIObjBorder:function(t,e){t&&(0!=e?(t.draw_node||(t.draw_node=new cc.Node,t.draw_node.border=!0,t.parent.addChild(t.draw_node),t.draw_layer=t.draw_node.addComponent(cc.Graphics),t.draw_layer.strokeColor=new cc.Color(0,255,0),t.draw_layer.lineWidth=2),t.draw_node.active=!0,t.draw_node.setAnchorPoint(t.anchorX,t.anchorY),t.draw_node.setPosition(t.x,t.y),t.draw_layer.clear(),t.draw_layer.rect(-t.width*t.anchorX,-t.height*t.anchorY,t.width,t.height),t.draw_layer.stroke()):t&&t.draw_node&&(t.draw_node.active=!1))},selectDebugUIObj:function(t){if(this.debug_ui&&this.debug_ui.active){var e=this.matchDebugUIObj(cc.director.getScene(),1,t,null,0);this.setDebugUIObj(e)}},matchDebugUIObj:function(t,e,i,s,n){if(e>100)return s;for(var a=t.children,o=0,l=a.length;o<l;o++)a[o].active&&!a[o].gm&&(e>1&&this.hitObj(a[o],i)&&(a[o].w_zIndex=n+o,s=this.compObj(a[o],s)),s=this.matchDebugUIObj(a[o],e+1,i,s,n+1e5*o));return s},hitObj:function(t,e){return t.getBoundingBoxToWorld().contains(e)},compObj:function(t,e){return t.width<1||t.height<1||t.width>=SCREEN_WIDTH||t.height>=SCREEN_HEIGHT?e:e?t.width*t.height<e.width*e.height?t:e:t}};module.exports=GmCmd,cc._RF.pop()},{loadermanager:"loadermanager",onlinegift_controller:"onlinegift_controller",pathtool:"pathtool",string_util:"string_util"}],goods_item:[function(t,e,i){"use strict";cc._RF.push(e,"8b142p9bb9GI7cXWwc6Lt7w","goods_item");var s=t("pathtool"),n=t("chat_item_controller");cc.Class({extends:BasePanel,ctor:function(){this.rleasePrefab=!1,this.prefabPath=s.getPrefabPath("chat","goods_item"),this.chat_item_ctrl=n.getInstance()},initConfig:function(){},initPanel:function(){this.backpack_item=ItemsPool.getInstance().getItem("backpack_item"),this.backpack_item.setParent(this.root_wnd),this.backpack_item.setExtendData({scale:.8}),this.backpack_item.addCallBack(this.onClickItem.bind(this)),this.backpack_item.show()},registerEvent:function(){},onShow:function(t){this.udpateWidgets()},onHide:function(){},onDelete:function(){this.backpack_item&&(this.backpack_item.deleteMe(),this.backpack_item=null)},setData:function(t){this.data=t,this.root_wnd&&this.udpateWidgets()},udpateWidgets:function(){this.data&&this.backpack_item.setData(this.data)},addCallBack:function(t){this.select_cb=t},onClickItem:function(t){t.data&&this.select_cb&&this.select_cb(t.data)}});cc._RF.pop()},{chat_item_controller:"chat_item_controller",pathtool:"pathtool"}],goods_vo:[function(t,e,i){"use strict";cc._RF.push(e,"fb54cUnTEdHypAMg2JhWAhQ","goods_vo");cc.Class({extends:gcore.BaseEvent,ctor:function(){this.id=0,this.base_id=0,this.bind=0,this.quantity=0,this.pos=0,this.expire_type=0,this.expire_time=0,this.main_attr={},this.enchant=0,this.attr={},this.extra_attr={},this.score=0,this.all_score=0,this.extra={},this.config={},this.use_type=0,this.quality=0,this.sub_type=0,this.lev=0,this.sort=0,this.type=0,this.type_vo="GoodsVo"},setBaseId:function(t){this.config=Utils.getItemConfig(t),this.config&&(this.type=this.config.type||0,this.use_type=this.config.use_type||0,this.quality=this.config.quality||0,this.sub_type=this.config.sub_type||0,this.lev=this.config.lev||0,this.sort=gdata("item_data","data_item_sort",this.type))},initAttrData:function(t){for(var e in t)this.setGoodsAttr(e,t[e])},setGoodsAttr:function(t,e){e instanceof Array?(this[t]=e,this.dispatchUpdateAttrByKey(t,e)):this[t]!=e&&(this[t]=e,"base_id"==t&&this.setBaseId(e),this.dispatchUpdateAttrByKey(t,e))},dispatchUpdateAttrByKey:function(t,e){},setEnchantScore:function(t){var e=t||0,i=this.getEquipBaseScore();this.all_score=i+e},getEquipBaseScore:function(){if(!(this.config&&this.config.ext&&this.config.ext[0]&&this.config.ext[0][1]))return 0;var e=this.config.ext[0][1],i=t("partner_calculate");return this.score=i.calculatePower(e),this.score}});cc._RF.pop()},{partner_calculate:"partner_calculate"}],guide_const:[function(t,e,i){"use strict";cc._RF.push(e,"a48caQk68VNNLN8q5Xy0svw","guide_const");var s={NodeKeys:{mainui_tab_1:"mainui_tab_1",guidesign_build_5:"guidesign_build_5",guildsign_summon_1_1:"tag|recruit_btn_one_1",guildsign_summon_comfirm_btn:"confirm_btn",guidesign_battle_reward_btn:"passnode",guildsign_summon_3_1:"tag|recruit_btn_one_3",guidesign_quick_btn:"source_btn",guidesign_tipsqingbao:"qingbao"},NodeTas:{},getNameInfo:function(t){var e=null;return s.NodeKeys[t]&&(e=s.NodeKeys[t].split("|")),e},special_id:{guild:10212,market:10510,seerpalace:10222,stronger:10174,quick_guide:10120,hook_guide:10165},Finger_Speed:1500};e.exports=s,cc._RF.pop()},{}],guide_controller:[function(t,e,i){"use strict";cc._RF.push(e,"bb271us3xdCWoCufE4ruTzR","guide_controller");var s=t("story_controller"),n=(t("guide_main_window"),t("story_event")),a=t("guide_event"),o=cc.Class({extends:BaseController,ctor:function(){},initConfig:function(){var e=t("guide_model");this.model=new e,this.model.initConfig(),this.is_guiding=!1,this.guide_list=[]},getModel:function(){return this.model},registerEvents:function(){this.init_role_event=gcore.GlobalEvent.bind(n.STORY_OVER,function(){if(this.guide_list&&this.guide_list.length>0){var t=this.guide_list.shift();this.checkGuideToPlay(t)}}.bind(this)),this.can_play_drama_event=gcore.GlobalEvent.bind(n.PREPARE_PLAY_PLOT,function(){if(null!=this.guide_list&&null!=Utils.next(this.guide_list)&&this.guide_list.length){var t=this.guide_list.splice(0,1);this.checkGuideToPlay(t)}}.bind(this))},registerProtocals:function(){this.RegisterProtocal(11120,this.handle11120.bind(this)),this.RegisterProtocal(11121,this.handle11121.bind(this)),this.RegisterProtocal(11123,this.handle11123.bind(this))},handle11120:function(t){(cc.log("\u6536\u5230\u670d\u52a1\u7aef\u6267\u884c\u5f15\u5bfc\u534f\u8bae"),cc.log(t),t&&t.id)&&(this.cur_guide_config&&this.cur_guide_config.id==t.id||(Config.drama_data.data_guide[t.id]?this.startPlayGuide(!0,t.id):this.startPlayGuide(!1,t.id)))},send11121:function(t,e){var i={};i.id=t,i.n=e,this.SendProtocal(11121,i)},handle11121:function(t){this.guide_view&&(cc.log("\u4fdd\u5b58\u6210\u529f\uff0c\u670d\u52a1\u5668\u8fd4\u56de"),this.guide_view.doNextGuideFromServer(t.id,t.n))},handle11123:function(){},startPlayGuide:function(e,i,s){if(gcore.GlobalEvent.fire(a.CloseButtonListPanelEffect),e){cc.log("222");l=Config.drama_data.data_guide[i];var n=t("role_controller").getInstance().getRoleVo(),o=cc.sys.localStorage.getItem("guide_data"+n.srv_id+n.rid);if(o&&(o=JSON.parse(o))[i]&&o[i][l.over_step])return void this.startPlayGuide(!1,i);if(!l||!l.act||0==l.act.length)return void this.startPlayGuide(!1,i);cc.log("111"),this.checkGuideToPlay(l)}else if(this.delayTouchEnabled(),this.guide_view&&(this.guide_view.close(),this.guide_view=null),this.is_guiding=!1,this.cur_guide_config=null,this.send11122(i,s),this.guide_list&&this.guide_list.length>0){cc.log("\u6267\u884c\u7f13\u5b58\u4e2d\u7684\u5f15\u5bfc");var l=this.guide_list.shift();this.checkGuideToPlay(l)}else{t("mainui_controller").getInstance().setMainUIChatBubbleStatus(!0)}},send11122:function(t,e){e=!!e;var i={};i.id=t,i.is_skip=e,this.SendProtocal(11122,i)},checkGuideToPlay:function(t){if(t&&(!this.cur_guide_config||this.cur_guide_config.id!=t.id)){for(var e in this.guide_list)if(this.guide_list[e].id==t.id)return;s.getInstance().getModel().isStoryState()||!1?this.guide_list.push(t):this.cur_guide_config?this.guide_list.push(t):(cc.log("3333"),t.act.length>0?this.playGuide(t):this.startPlayGuide(!1,t.bid))}},playGuide:function(t){},delayTouchEnabled:function(){},isInGuide:function(){return this.is_guiding},openTaskGuideWindow:function(t,e){t?(null==this.task_guide_window&&(this.task_guide_window=Utils.createClass("task_guide_window")),this.task_guide_window.open(e)):(this.task_guide_window&&this.task_guide_window.close(),this.task_guide_window=null)},getTaskGuideWindow:function(){return this.task_guide_window},getTaskGuideEffectStatus:function(){return!!this.task_guide_window&&this.task_guide_window.getEffectActive()},setGuideMainRootWnd:function(t){this.guide_view&&(this.guide_view.root_wnd.active=t)}});e.exports=o,cc._RF.pop()},{guide_event:"guide_event",guide_main_window:"guide_main_window",guide_model:"guide_model",mainui_controller:"mainui_controller",role_controller:"role_controller",story_controller:"story_controller",story_event:"story_event"}],guide_event:[function(t,e,i){"use strict";cc._RF.push(e,"24537HzpPlGw6fpi4A8sFP6","guide_event"),e.exports={TaskNextStep:"TaskNextStep",CloseTaskEffect:"CloseTaskEffect",OpenTaskEffect:"OpenTaskEffect",NewPlayerGuideStart:"NewPlayerGuideStart",NewPlayerGuideClose:"NewPlayerGuideClose",CloseButtonListPanelEffect:"CloseButtonListPanelEffect"},cc._RF.pop()},{}],guide_main_window:[function(t,e,i){"use strict";cc._RF.push(e,"9c98apAG71O57m0Zpx7osfE","guide_main_window");var s=t("pathtool"),n=t("guide_const"),a=t("guide_event");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("drama","guide_main_view"),this.viewTag=SCENE_TAG.msg,this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){this.adjust_guide_timer=null,this.timer_hander=null,this.time_num=0},openCallBack:function(){cc.log("99999999999999999999"),game.views_js&&game.views_js.cancelTouch(),this.root_wg=this.root_wnd.getComponent(cc.Widget),window.FIT_SCALE>1&&(this.root_wg.isAlignTop=!0,this.root_wg.isAlignBottom=!0),this.background_nd=this.seekChild("background"),this.clip_con_nd=this.seekChild("clip_con"),this.clip_mask_nd=this.seekChild("clip_mask"),this.skip_btn_nd=this.seekChild("skip_btn"),this.skip_btn_wd=this.skip_btn_nd.getComponent(cc.Widget),1!=USE_SDK||"WX_SDK"!=PLATFORM_TYPR&&"SH_SDK"!=PLATFORM_TYPR&&"QQ_SDK"!=PLATFORM_TYPR||(this.skip_btn_wd.top=150),this.effect_con_nd=this.seekChild("effect_con"),this.background_bi=this.seekChild("background",cc.BlockInputEvents),this.background_bi.enabled=!0,this.effect_con_sk=this.seekChild("effect_con",sp.Skeleton),this.guide_clip_nd=this.seekChild("guide_clip"),this.clip_mask_bl=this.seekChild("guide_clip",cc.BlockInputEvents),this.guide_mask_nd=this.seekChild("guide_mask"),this.guide_mask_nd.width=this.guide_mask_nd.width*window.FIT_SCALE,this.msg_bg_nd=this.seekChild("msg_bg"),this.msg_txt_nd=this.seekChild("msg_txt"),this.msg_txt_rt=this.seekChild("msg_txt",cc.RichText),this.mas_con_nd=this.seekChild("mas_con"),this.clip_mask_nd.on(cc.Node.EventType.TOUCH_END,this.onClickMaskBg,this),this.skip_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickSkipBtn,this)},openCacheView:function(){},registerEvent:function(){this.re_link_game_event=gcore.GlobalEvent.bind(EventId.EVT_RE_LINK_GAME,function(){this.background_bi.enabled&&(this.background_bi.enabled=!1)}.bind(this)),gcore.GlobalEvent.bind(gcore.GlobalEvent.EVT_SOCKET_DISCONNECT,function(){this.disconnect()}.bind(this))},openRootWnd:function(t){cc.log("99999999999999999"),this.act_config&&(cc.log("2222222"),this.playGuide(this.act_config))},closeCallBack:function(){},addGuid:function(t){cc.log("4444"),this.act_config=t,this.root_wnd&&(cc.log("555"),this.playGuide(t))},playGuide:function(t){game.views_js&&!this.root_wnd&&game.views_js.forBidTouch(),gcore.GlobalEvent.fire(a.NewPlayerGuideStart),cc.log("\u5f53\u524d\u6b63\u5728\u6267\u884c\u7684\u5f15\u5bfc\u914d\u7f6e\u8868"),cc.log(t),this.config=t,t&&(this.background_bi.enabled=!0,this.act_list=Utils.deepCopy(t.act),this.cur_zone_list={},this.need_save=!1,this.guide_step=0,this.guide_cache_data={},this.playNextGuide(),this.showSkipBtn())},checkDoNextGuide:function(){if(this.target,this.saveGuideStep(),this.background_bi.enabled=!0,this.close_all&&Utils.closeAllWindow(),this.need_save){if(!this.act_config)return void this.endPlayGuide();this.ctrl.send11121(this.act_config.id,this.guide_step)}else this.readyDoNextGuide()},doNextGuideFromServer:function(t,e){this.act_config&&this.act_config.id==t&&this.guide_step==e&&this.readyDoNextGuide()},readyDoNextGuide:function(){cc.log("\u51c6\u5907\u6267\u884c\u4e0b\u4e00\u6b65\u7684\u64cd\u4f5c"),this.hideSKipBtn(),this.guide_clip_nd.active&&(this.guide_clip_nd.active=!1),this.clip_con_nd.active&&(this.clip_con_nd.active=!1),this.effect_con_nd.active&&(this.effect_con_nd.active=!1),this.clip_mask_bl.enabled||(this.clip_mask_bl.enabled=!0),this.mas_con_nd.active&&(this.mas_con_nd.active=!1),this.target=null,0==this.delay?this.playNextGuide():this.delayPlayNextGuide(this.delay)},delayPlayNextGuide:function(t){this.hasTicket("delayPlayNextGuide")&&this.delTicker("delayPlayNextGuide"),this.addTicket(this.playNextGuide.bind(this),t,"delayPlayNextGuide")},playNextGuide:function(){if(this.saveGuideStep(),this.clearTargetInfo(),this.act_list&&0!=this.act_list.length){if(this.target_data=this.act_list.shift(),this.guide_step=this.guide_step+1,cc.log("\u5f53\u524d\u6b65\u9aa4\u7684\u6570\u636e"),cc.log(this.target_data),this.guide_cache_data[this.act_config.id]&&this.guide_cache_data[this.act_config.id][this.guide_step]&&!this.cur_zone_list[this.guide_step])this.playNextGuide();else if(this.target_data){switch(this.target_data[0]){case"checkstatus":this.findRootWndByParams4();break;case"openview":this.findRootWndByParams3();break;case"conditonstatus":this.findRootWndByCondition();break;case"emptystep":this.playNextGuide();break;default:2==this.target_data.length?this.findRootWndByParams2():this.findTargetByParams()}this.showSkipBtn()}}else this.endPlayGuide()},addSkipTimeTicket:function(){},findRootWndByCondition:function(){if(this.target_data&&this.target_data[3]){var e=this.target_data[1];this.delay=this.target_data[2];if("partner"==e)(n=t("hero_controller")).getInstance().getHeroBagRoot(this.getFinishCB.bind(this));else if("battletopscene"==e){t("battle_controller");BattleDramaController.getInstance().getDramaFightUI(this.getFinishCB.bind(this))}else if("battlesceneview"==e){t("battle_controller").getInstance().getCtrlBattleScene(this.getFinishCB.bind(this))}else if("checkmainui"==e){var i=t("mainui_controller"),s=t("mainui_const");i.getInstance().getMainUIIndex()!=s.btn_index.main_scene?i.getInstance().getMainUiRoot(this.getFinishCB.bind(this)):this.getFinishCB()}else if("adventurescene"==e)AdventureController.getInstance().getAdventureRoot();else if("partnerform"==e)n.getInstance().getHeroFormRoot();else if("partnereinfoview"==e){(n=t("hero_controller")).getInstance().getHeroMianInfoRoot(this.getFinishCB.bind(this))}else if("partnergofight"==e){var n;(n=t("hero_controller")).getInstance().getHeroGoFightRoot(this.getFinishCB.bind(this))}else if("hallowsactivitywindow"==e){t("hallows_controller").getInstance().getHallowsActivityRoot(this.getFinishCB.bind(this))}else if("hallowspreview"==e){t("hallows_controller").getInstance().getHallowsPreviewRoot(this.getFinishCB.bind(this))}else if("hallowswindow"==e){t("hallows_controller").getInstance().getHallowsRoot(this.getFinishCB.bind(this))}else if("adventureevtview"==e)AdventureController.getInstance().getAdventureEvtRoot();else if("esecsiceview"==e){t("esecsice_controller").getInstance().getEsecsiceRoot(this.getFinishCB.bind(this))}else if("stonedunview"==e){t("stone_dungeon_controller").getInstance().getStoneDungeonRoot(this.getFinishCB.bind(this))}else if("varietystoreview"==e){t("mall_controller").getInstance().getVarietyStoreRoot(this.getFinishCB.bind(this))}}},getFinishCB:function(t){var e;t?(this.target_root_wnd=t,(e=this.target_data[3][0])&&e.length>0&&(this.act_list=Utils.deepCopy(e),this.guide_step=0)):(e=this.target_data[3][1])&&e.length>0&&(this.act_list=Utils.deepCopy(e),this.guide_step=0);this.playNextGuide()},params2RootWndCB:function(t){t&&t.active?0==this.delay?this.playNextGuide():this.delayPlayNextGuide(this.delay):this.endPlayGuide(!0)},findRootWndByParams2:function(e){if(this.target_data&&2==this.target_data.length){var i=this.target_data[0];if(this.delay=this.target_data[1]||0,"mainui"==i){var s=t("mainui_controller");this.target_root_wnd=s.getInstance().getMainUiRoot()}else if("summon"==i){var n=t("partnersummon_controller");this.target_root_wnd=n.getInstance().getSummonItemRoot()}else if("summonshow"==i){n=t("partnersummon_controller");this.target_root_wnd=n.getInstance().getSummonShowRoot()}else if("summonresult"==i){n=t("partnersummon_controller");this.target_root_wnd=n.getInstance().getSummonResultRoot()}else if("partner"==i){var a=t("hero_controller");this.target_root_wnd=a.getInstance().getHeroBagRoot()}else if("partnerform"==i)this.target_root_wnd=a.getInstance().getHeroFormRoot();else if("battlesceneview"==i)this.target_root_wnd=l.getInstance().getCtrlBattleScene();else if("partnereinfoview"==i){a=t("hero_controller");this.target_root_wnd=a.getInstance().getHeroMianInfoRoot()}else if("partnergofight"==i){a=t("hero_controller");this.target_root_wnd=a.getInstance().getHeroGoFightRoot()}else if("battlequickview"==i){var o=t("battle_drama_controller");this.target_root_wnd=o.getInstance().getDramBattleQuickRoot()}else if("battletophookrewards"==i){o=t("battle_drama_controller");this.target_root_wnd=o.getInstance().getDramaBattleHookRewardRoot()}else if("battletoppassrewards"==i){o=t("battle_drama_controller");this.target_root_wnd=o.getInstance().getDramaBattlePassRewardRoot()}else if("battletopscene"==i){var l=t("battle_controller");this.target_root_wnd=l.getInstance().getDramaFightUI()}else if("getitemview"==i){s=t("mainui_controller");this.target_root_wnd=s.getInstance().getItemExhibtionRoot()}else if("backpack"==i){var r=t("backpack_controller");this.target_root_wnd=r.getInstance().getBackpackRoot()}else if("backpacksell"==i)this.target_root_wnd=r.getInstance().getBackpackSellRoot();else if("arenaloopview"==i){var c=t("arena_controller");this.target_root_wnd=c.getInstance().getArenaRoot()}else if("guildinitview"==i)this.target_root_wnd=GuildController.getInstance().getGuildInitRoot();else if("startowerview"==i){var _=t("startower_controller");this.target_root_wnd=_.getInstance().getStarTowerRoot()}else if("startowerchallengeview"==i){_=t("startower_controller");this.target_root_wnd=_.getInstance().getStarTowerChallengeRoot()}else if("auguryview"==i)this.target_root_wnd=AuguryController.getInstance().getAuguryRoot();else if("summonshowview"==i)this.target_root_wnd=n.getInstance().getSummonShowRoot();else if("mallview"==i)this.target_root_wnd=f.getInstance().getMallRoot();else if("adventurescene"==i)this.target_root_wnd=AdventureController.getInstance().getAdventureRoot();else if("adventureevtview"==i)this.target_root_wnd=AdventureController.getInstance().getAdventureEvtRoot();else if("adventurenextfloor"==i){this.target_root_wnd=AdventureController.getInstance().getNextAlertRoot();o=t("battle_drama_controller");this.target_root_wnd=o.getInstance().getBattleQingbaoRoot()}else if("battleqingbaoview"==i);else if("tipssourceroot"==i)this.target_root_wnd=r.getInstance().getItemTipsSourceRoot();else if("skybattleresult"==i)this.target_root_wnd=l.getInstance().getFinishView(BattleConst.Fight_Type.Adventrue);else if("activitywindow"==i)this.target_root_wnd=ActivityController.getInstance().getActivityRoot();else if("hallowswindow"==i){var h=t("hallows_controller");this.target_root_wnd=h.getInstance().getHallowsRoot()}else if("hallowsactivitywindow"==i){h=t("hallows_controller");this.target_root_wnd=h.getInstance().getHallowsActivityRoot()}else if("hallowspreview"==i){h=t("hallows_controller");this.target_root_wnd=h.getInstance().getHallowsPreviewRoot()}else if("comptipsview"==i){var d=t("tips_controller");this.target_root_wnd=d.getInstance().getCompTipsRoot()}else if("esecsiceview"==i){var u=t("esecsice_controller");this.target_root_wnd=u.getInstance().getEsecsiceRoot()}else if("stonedunview"==i){var m=t("stone_dungeon_controller");this.target_root_wnd=m.getInstance().getStoneDungeonRoot()}else if("varietystoreview"==i){var f=t("mall_controller");this.target_root_wnd=f.getInstance().getVarietyStoreRoot()}else if("sevenloginview"==i){var p=t("action_controller");this.target_root_wnd=p.getInstance().getSevenLoginRoot()}else if("welfareview"==i){var g=t("welfare_controller");this.target_root_wnd=g.getInstance().getWelfareRoot()}else if("treasureview"==i){p=t("action_controller");this.target_root_wnd=p.getInstance().getTreasureRoot()}else if("voyageview"==i){var v=t("voyage_controller");this.target_root_wnd=v.getInstance().getVoyageMainRoot()}else if("strongerview"==i){var b=t("stronger_controller");this.target_root_wnd=b.getInstance().getStrongerRoot()}else if("seerpalaceview"==i){var w=t("seerpalace_controller");this.target_root_wnd=w.getInstance().getSeerpalaceMainRoot()}else if("voyagedispatchview"==i){v=t("voyage_controller");this.target_root_wnd=v.getInstance().getVoyageDispatchRoot()}this.target_root_wnd?(0==this.delay?this.playNextGuide():this.delayPlayNextGuide(this.delay),this.timer_hander&&this.removeTimer()):this.timer_hander||(this.timer_hander=this.startUpdate(10,this.findRootWndByParams2.bind(this),1e3)),e&&e>=9&&(this.removeTimer(),this.endPlayGuide(!0))}},findRootWndByParams3:function(){if(this.target_data){var e=this.target_data[1];if(this.delay=this.target_data[2],"firstrecharge"==e)ActionController.getInstance().openFirstChargeView(!0);else if("newfirstrecharge"==e||"firstrecharge1"==e){t("newfirstcharge_controller").getInstance().openNewFirstChargeView(!0)}0==this.delay?this.playNextGuide():this.delayPlayNextGuide(this.delay)}},findRootWndByParams4:function(){if(this.target_data){var e=this.target_data[1],i=this.target_data[2];if(this.delay=this.target_data[3],"centercity"==e){var s=t("mainscene_controller");s.getInstance().getCenterCityBuildById(i,function(t){t&&t.root_wnd?(s.getInstance().moveToBuild(i),this.target_root_wnd=t.root_wnd,0==this.delay?this.playNextGuide():this.delayPlayNextGuide(this.delay)):this.endPlayGuide(!0)}.bind(this))}}},findTargetByParams:function(){if(this.target_data){this.target_type=this.target_data[0],this.delay=this.target_data[1]||0,this.target_name=this.target_data[2];this.target_data[3];this.need_save=this.target_data[4]||0,this.close_all=this.target_data[5]||0,this.wait_delay=this.target_data[6]||0,this.show_guide_step=this.target_data[7]||!0,this.figer_off_x=this.target_data[8]||0,this.figer_off_y=this.target_data[9]||0,this.guide_msg=this.target_data[10]||"",this.sprite_off_x=this.target_data[11]||0,this.sprite_off_y=this.target_data[12]||0,this.sprite_flip=this.target_data[13]||0,this.bg_opacity="number"==typeof this.target_data[14]?this.target_data[14]:100,this.sound_name=this.target_data[15]||"",this.findTargetByRootND()}},findTargetByRootND:function(t){if("name"==this.target_type){var e=n.NodeKeys[this.target_name],i=n.getNameInfo(this.target_name);e||(e=this.target_name),i&&2==i.length?"tag"==i[0]&&(this.target=this.seekChildByTag(this.target_root_wnd,i[1])):this.target=this.seekChild(this.target_root_wnd,e)}else"tag"==this.target_type&&(this.target=this.seekChildByTag(this.target_root_wnd,this.target_name));this.target?(this.removeTimer(),this.drawTargetRect(),0==this.wait_delay?this.once_hander=this.target.once(cc.Node.EventType.TOUCH_END,function(){this.act_config&&this.checkDoNextGuide(),this.showSkipBtn()},this):this.delayPlayNextGuide(this.wait_delay)):this.timer_hander||(this.time_num=0,this.timer_hander=this.startUpdate(6,this.findTargetByRootND.bind(this),1e3)),t&&t>=5&&(this.removeTimer(),this.endPlayGuide(!0))},saveGuideStep:function(){if(this.config&&this.config.over_step&&this.config.over_step==this.guide_step){this.guide_cache_data[this.config.id]||(this.guide_cache_data[this.config.id]={}),this.guide_cache_data[this.config.id][this.config.over_step]=!0;var e=t("role_controller").getInstance().getRoleVo();cc.sys.localStorage.setItem("guide_data"+e.srv_id+e.rid,JSON.stringify(this.guide_cache_data))}},clearTargetInfo:function(){},endPlayGuide:function(t){cc.log("\u7ed3\u675f\u5f53\u524d\u5f15\u5bfc---"+this.act_config.id),this.guide_step=0,gcore.GlobalEvent.fire(a.NewPlayerGuideClose),this.hasTicket("delayPlayNextGuide")&&this.delTicker("delayPlayNextGuide"),this.ctrl&&this.ctrl.startPlayGuide(!1,this.act_config.id,t),this.model&&this.model.setGuideLastPos(null),this.background_bi.enabled=!1,this.act_config=null,this.hideSKipBtn()},findNodeByName:function(){},findNodeByTag:function(){},removeTimer:function(){this.timer_hander&&(this.stopUpdate(this.timer_hander),this.time_num=0,this.timer_hander=null)},drawTargetRect:function(){if(this.target){this.clip_con_nd.active=!0,this.effect_con_nd.active=!0;var t=this.target.convertToWorldSpaceAR(cc.v2(0,0)),e=this.root_wnd.convertToNodeSpaceAR(t);e.y<t.y&&(e.y=t.y);var i=e.x+(.5-this.target.anchorX)*this.target.width+this.figer_off_x||0,a=e.y+(.5-this.target.anchorY)*this.target.height,o=cc.v2(i,a);if(this.clip_con_nd.position=o,this.clip_con_nd.width=this.target.width,this.clip_con_nd.height=this.target.height,this.bg_opacity>0?(this.guide_clip_nd.active=!0,this.guide_clip_nd.position=o):this.guide_clip_nd.active=!1,this.show_guide_step){var l=this.model.getGuideLastPos(),r=PlayerAction.action_1;l&&(r=PlayerAction.action_2);var c=s.getEffectRes(240),_=s.getSpinePath(c);if(this.loadRes(_,function(t,e){this.effect_con_sk.skeletonData=e,this.effect_con_sk.setAnimation(0,t,!0),this.background_bi.enabled=!1}.bind(this,r)),this.effect_con_nd.stopAllActions(),l){var h=this.calDistanch(o,l)/n.Finger_Speed,d=cc.callFunc(function(){this.clip_mask_bl.enabled=!1,this.effect_con_sk.setAnimation(0,PlayerAction.action_1,!0),this.finish_action=!0},this),u=cc.moveTo(h,o),m=cc.sequence(u,d);this.effect_con_nd.runAction(m),this.finish_action=!1}else this.effect_con_nd.position=o;""==this.guide_msg?this.showNoticeContainer():(this.showLittleSpiritAndTips(o),this.effect_con_nd.active&&this.showNoticeContainer())}else this.background_bi.enabled=!1;this.model.setGuideLastPos(o)}},onClickMaskBg:function(){if(this.effect_con_nd.active&&this.effect_con_sk.skeletonData&&"action1"==this.effect_con_sk.animation)if(this.notice_effect)this.notice_effect_nd.position=this.effect_con_nd.position,this.notice_effect_nd.active=!0,this.notice_effect.skeletonData&&this.notice_effect.setAnimation(0,"action",!1);else{this.notice_effect_nd=new cc.Node,this.root_wnd.addChild(this.notice_effect_nd),this.notice_effect=this.notice_effect_nd.addComponent(sp.Skeleton),this.notice_effect.setEndListener(this.noticeAnimaEnd.bind(this)),this.notice_effect_nd.position=this.effect_con_nd.position;var t=s.getEffectRes("198"),e=s.getSpinePath(t);this.loadRes(e,function(t){this.notice_effect.skeletonData=t,this.notice_effect.setAnimation(0,"action",!1)}.bind(this))}},noticeAnimaEnd:function(){this.notice_effect.clearTracks(),this.notice_effect_nd.active=!1},onClickSkipBtn:function(){this.endPlayGuide(!0)},calDistanch:function(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))},showNoticeContainer:function(){},showLittleSpiritAndTips:function(t){this.mas_con_nd.active=!0,this.msg_txt_rt.string=this.guide_msg,this.msg_bg_nd.height=this.msg_txt_nd.height+30,this.updateGuideTipsBgPos(t)},updateGuideTipsBgPos:function(t){var e=this.root_wnd.getContentSize(),i=!1,s=t.x;t.x<.5*e.width?(i=!1,s=t.x+.5*this.msg_bg_nd.width):(i=!0,s=t.x-.5*this.msg_bg_nd.width);var n=!1,a=t.y;t.y<.5*e.height?(n=!1,a=t.y+this.clip_con_nd.height):(n=!0,a=t.y-this.clip_con_nd.height),this.msg_bg_nd.scaleX=i?-1:1,n?(this.msg_bg_nd.scaleY=-1,this.msg_bg_nd.y+=10):(this.msg_bg_nd.scaleY=1,this.msg_bg_nd.y=0),this.mas_con_nd.position=cc.v2(s,a)},showSkipBtn:function(){this.act_config&&this.act_config.skip?(this.hasTicket("skip_btn_show")&&this.delTicker("skip_btn_show"),this.skip_btn_nd.active&&(this.skip_btn_nd.active=!1),this.addTicket(function(){this.skip_btn_nd.active=!0;var t=this.getSkipBtnAct();this.skip_btn_nd.runAction(t)}.bind(this),5,"skip_btn_show")):this.skip_btn_nd.active=!1},hideSKipBtn:function(){this.hasTicket("skip_btn_show")&&this.delTicker("skip_btn_show"),this.skip_btn_nd.stopAllActions(),this.skip_btn_nd.active=!1},getSkipBtnAct:function(){var t=cc.fadeIn(.7),e=cc.fadeOut(.4);return cc.repeatForever(cc.sequence(t,e))},adjustGuide:function(){if(this.clip_con_nd.active&&this.finish_action){var t=this.target.convertToWorldSpaceAR(cc.v2(0,0)),e=(t=this.root_wnd.convertToNodeSpaceAR(t)).x+(.5-this.target.anchorX)*this.target.width+this.figer_off_x||0,i=t.y+(.5-this.target.anchorY)*this.target.height,s=cc.v2(e,i);this.clip_con_nd.x===s.x&&this.clip_con_nd.y===s.y||(this.clip_con_nd.x=s.x,this.clip_con_nd.y=s.y)}},resetGuide:function(){if(cc.log("\u65ad\u7ebf\u91cd\u8fde\u91cd\u65b0\u6267\u884c\u5f15\u5bfc"),this.act_config){var e=t("mainui_controller"),i=t("mainui_const");e.getInstance().changeMainUIStatus(i.btn_index.main_scene),this.timer_hander&&(this.stopUpdate(this.timer_hander),this.time_num=0,this.timer_hander=null),this.hasTicket("delayPlayNextGuide")&&this.delTicker("delayPlayNextGuide"),this.hideSKipBtn(),this.guide_clip_nd.active&&(this.guide_clip_nd.active=!1),this.clip_con_nd.active&&(this.clip_con_nd.active=!1),this.effect_con_nd.active&&(this.effect_con_nd.active=!1),this.background_bi.enabled=!1,this.mas_con_nd.active&&(this.mas_con_nd.active=!1),this.wait_status_time_ticket=gcore.Timer.set(function(){this.model&&this.model.setGuideLastPos(null),this.playGuide(this.act_config)}.bind(this),1e3,1)}},disconnect:function(){this.background_bi.enabled=!0}});cc._RF.pop()},{action_controller:"action_controller",arena_controller:"arena_controller",backpack_controller:"backpack_controller",battle_controller:"battle_controller",battle_drama_controller:"battle_drama_controller",esecsice_controller:"esecsice_controller",guide_const:"guide_const",guide_event:"guide_event",hallows_controller:"hallows_controller",hero_controller:"hero_controller",mainscene_controller:"mainscene_controller",mainui_const:"mainui_const",mainui_controller:"mainui_controller",mall_controller:"mall_controller",newfirstcharge_controller:"newfirstcharge_controller",partnersummon_controller:"partnersummon_controller",pathtool:"pathtool",role_controller:"role_controller",seerpalace_controller:"seerpalace_controller",startower_controller:"startower_controller",stone_dungeon_controller:"stone_dungeon_controller",stronger_controller:"stronger_controller",tips_controller:"tips_controller",voyage_controller:"voyage_controller",welfare_controller:"welfare_controller"}],guide_model:[function(t,e,i){"use strict";cc._RF.push(e,"c28a7tGGTRGFJ2G3cJObrQR","guide_model");cc.Class({extends:BaseClass,ctor:function(){},properties:{},initConfig:function(){},getGuideLastPos:function(){return this.last_guide_pos},setGuideLastPos:function(t){this.last_guide_pos=t},getTaskGuideLastPos:function(){return this.task_last_guide_pos},setTaskGuideLastPos:function(t){this.task_last_guide_pos=t}});cc._RF.pop()},{}],guild_action_goal_item:[function(t,e,i){"use strict";cc._RF.push(e,"d8003AmJbFEEp07VGw/JRhl","guild_action_goal_item");var s=t("pathtool"),n=t("guild_controller"),a=cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("guild","guild_action_goal_item"),this.ctrl=n.getInstance()},initPanel:function(){this.container=this.seekChild("container"),this.title_1=this.seekChild(this.container,"title_1"),this.title_1.active=!1,this.title_2=this.seekChild(this.container,"title_2"),this.title_2.active=!1,this.btn_goto=this.seekChild(this.container,"btn_goto"),this.sprite_has=this.seekChild(this.container,"sprite_has"),this.sprite_has.active=!1,this.btn_commit=this.seekChild("btn_commit"),this.btn_commit.active=!1,this.item_desc={};for(var t=1;t<4;t++)this.item_desc[t]=this.seekChild("desc_"+t,cc.Label)},registerEvent:function(){this.btn_goto&&this.btn_goto.on(cc.Node.EventType.TOUCH_END,function(){this.data.show_jump?t("backpack_controller").getInstance().gotoItemSources(this.data.show_jump,{}):message(Utils.TI18N("\u8be5\u6d3b\u52a8\u672a\u5f00\u542f"))},this),this.btn_commit&&this.btn_commit.on(cc.Node.EventType.TOUCH_END,function(){this.ctrl.send16903(this.data.id)},this)},setData:function(t){this.data=t,this.root_wnd&&this.onShow()},setExtendData:function(t){this.task_data=t},onShow:function(){if(null!=this.data){var t=this.data;t.desc&&(this.item_desc[1].string=t.desc),this.title_1.active=1==t.type,this.title_2.active=2==t.type,t.exp&&(this.item_desc[3].string=t.exp),this.changeItemStatus(this.data.index)}},changeItemStatus:function(t){this.btn_goto.active=0==this.task_data[t].finish,this.btn_commit.active=1==this.task_data[t].finish,this.sprite_has.active=2==this.task_data[t].finish;var e=cc.js.formatStr("(%s/%s)",this.task_data[t].value,this.task_data[t].target_val);this.item_desc[2].string=e},onDelete:function(){}});e.exports=a,cc._RF.pop()},{backpack_controller:"backpack_controller",guild_controller:"guild_controller",pathtool:"pathtool"}],guild_action_goal_window:[function(t,e,i){"use strict";cc._RF.push(e,"21387lF4ndJCoOcyb99pEwp","guild_action_goal_window");var s=t("pathtool"),n=t("guild_controller"),a=t("guild_event"),o=t("common_scrollview"),l=t("guild_action_goal_item"),r=cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("guild","guild_action_goal"),this.win_type=WinType.Big,this.viewTag=SCENE_TAG.dialogue,this.ctrl=n.getInstance(),this.reward_list={},this.receve_list={}},openCallBack:function(){this.background=this.seekChild("background"),this.background.scale=FIT_SCALE;var t=this.seekChild("main_container"),e=this.seekChild(t,"main_panel");this.close_btn=this.seekChild(e,"close_btn"),this.textLv=this.seekChild(e,"textLv",cc.Label),this.progress=this.seekChild(e,"progress",cc.ProgressBar),this.progress_num=this.seekChild(e,"progress_num",cc.Label),this.goods=this.seekChild(e,"goods").getChildByName("content"),this.rewardLayer=this.seekChild(e,"rewardLayer"),this.btn_reward=this.seekChild(e,"btn_reward"),this.btn_reward_redpoint=this.seekChild(this.btn_reward,"redpoint"),this.btn_reward_redpoint.active=!1,this.textAllGetReward=this.seekChild(e,"textAllGetReward",cc.Label),this.textAllGetReward.node.active=!1,this.skill_full={};for(var i=1;i<4;i++)this.skill_full[i]=this.seekChild(e,"skill_full_"+i),this.skill_full[i].actvie=!1;this.goods_list=this.seekChild(e,"goods_list");var s=this.goods_list.getContentSize(),n=cc.size(s.width,s.height-4),a={item_class:l,start_x:1,space_x:0,start_y:0,space_y:0,item_width:599,item_height:73,row:0,col:1,need_dynamic:!0};this.item_scrollview=new o,this.item_scrollview.createScroll(this.goods_list,cc.v2(0,4),ScrollViewDir.vertical,ScrollViewStartPos.top,n,a,cc.v2(.5,.5)),this.desc_label=this.seekChild("desc_label",cc.RichText);var r=this.seekChild(e,"cur");this.current_att={};for(i=0;i<3;i++)this.current_att[i]={},this.current_att[i].label=this.seekChild(r,"label_"+(i+1),cc.RichText),this.current_att[i].sprite=this.seekChild(r,"sprite_"+(i+1),cc.Sprite);var c=this.seekChild(e,"next");this.next_att={};for(i=0;i<3;i++)this.next_att[i]={},this.next_att[i].label=this.seekChild(c,"label_"+(i+1),cc.RichText),this.next_att[i].sprite=this.seekChild(c,"sprite_"+(i+1),cc.Sprite)},registerEvent:function(){this.addGlobalEvent(a.UpdataGuildGoalBasicData,function(t){var e=Config.guild_quest_data.data_lev_data;t.exp>=e[t.lev].exp?this.btn_reward_redpoint.active=!0:this.btn_reward_redpoint.active=!1,this.textLv.string=cc.js.formatStr("Lv.%s",t.lev);var i=cc.js.formatStr("<color=#68452A>\u4eca\u65e5\u5df2\u83b7\u6d3b\u8dc3\uff1a<color=#249003>%s</c> \u672c\u5468\u5df2\u83b7\u6d3b\u8dc3\uff1a<color=#249003>%s</c></c>",t.day_exp,t.week_exp);this.desc_label.string=i;var s=t.lev+1;if(s>=Config.guild_quest_data.data_lev_data_length){this.progress_num.string=Utils.TI18N("\u5df2\u6ee1\u7ea7"),this.progress.progress=1,this.textAllGetReward.node.active=!0,this.textAllGetReward.string=Utils.TI18N("\u6240\u6709\u5956\u52b1\u5df2\u9886\u5b8c"),this.textAllGetReward.node.color=new cc.Color(104,69,42,255),this.btn_reward.active=!1,this.upGradeReward(e[t.lev],items),this.upGradeAttr(e[t.lev].attr);for(var n=1;n<4;n++)this.skill_full[n].active=!0,this.next_att[n].active=!1}else{var a=cc.js.formatStr("%s/%s",t.exp,e[t.lev].exp);if(this.progress_num.string=a,this.progress.progress=Math.floor(t.exp/e[t.lev].exp*100)/100,t.exp>=e[t.lev].exp)this.btn_reward.active=!0,this.textAllGetReward.node.active=!1;else{this.btn_reward.active=!1,this.textAllGetReward.node.active=!0;i=cc.js.formatStr("\u6d3b\u8dc3\u7b49\u7ea7%s\u7ea7\u53ef\u9886",s);this.textAllGetReward.node.color=new cc.Color(217,80,20,255),this.textAllGetReward.string=i}this.upGradeAttr(e[t.lev].attr,e[s].attr),this.upGradeReward(e[s].items)}},this),this.addGlobalEvent(a.UpdataGuildGoalTaskData,function(t){this.receve_list={};var e=[];for(var i in t.list){var s=t.list[i];for(var n in Config.guild_quest_data.data_task_data){var a=Config.guild_quest_data.data_task_data[n];s.id==a.id&&(a.index=i,e.push(a))}}this.receve_list=t.list,this.item_scrollview&&this.item_scrollview.setData(e,null,t.list)},this),this.addGlobalEvent(a.UpdataGuildGoalSingleTaskData,function(t){var e=t.list[0].id,i=1;for(var s in this.receve_list){if(this.receve_list[s].id==e){i=s;break}}if(this.item_scrollview){var n=this.item_scrollview.getItemList();if(n)for(var a in n){var o=n[a];a==i&&(this.receve_list[i].finish=t.list[0].finish,this.receve_list[i].target_val=t.list[0].target_val,this.receve_list[i].value=t.list[0].value,o.changeItemStatus(i))}}},this),this.background&&this.background.on(cc.Node.EventType.TOUCH_END,function(){Utils.playButtonSound(2),this.ctrl.openGuildActionGoalWindow(!1)},this),this.close_btn&&this.close_btn.on(cc.Node.EventType.TOUCH_END,function(){Utils.playButtonSound(2),this.ctrl.openGuildActionGoalWindow(!1)},this),this.btn_reward&&this.btn_reward.on(cc.Node.EventType.TOUCH_END,function(){Utils.playButtonSound(1),this.ctrl.send16904()},this),this.rewardLayer&&this.rewardLayer.on(cc.Node.EventType.TOUCH_END,function(){Utils.playButtonSound(1),this.ctrl.openGuildRewardWindow(!0)},this)},openRootWnd:function(){this.ctrl.send16900(),this.ctrl.send16901()},upGradeReward:function(t){for(var e in this.reward_list)this.reward_list[e].active=!1;for(e=0;e<t.length;e++){if(!this.reward_list[e]){var i=ItemsPool.getInstance().getItem("backpack_item");i.initConfig(!1,.75,!1,!1),i.setParent(this.goods),i.show(),this.reward_list[e]=i}var s=this.reward_list[e];s&&(s.setVisible(!0),s.setPosition(100*e-155,0),s.setData({bid:t[e][0],num:t[e][1]}))}},upGradeAttr:function(t,e){if(t)for(var i in t){var n=t[i],a=s.getAttrIconByStr(n[0]),o=Config.attr_data.data_key_to_name[n[0]]||"",l=cc.js.formatStr(Utils.TI18N("%s\uff1a %s "),o,n[1]);this.current_att[i].label.string=l;var r=s.getCommonIcomPath(a);this.updateImg(r,this.current_att[i])}if(e)for(var i in e){n=e[i],a=s.getAttrIconByStr(n[0]),o=Config.attr_data.data_key_to_name[n[0]]||"",l=cc.js.formatStr(Utils.TI18N("%s\uff1a %s "),o,n[1]);this.next_att[i].label.string=l;r=s.getCommonIcomPath(a);this.updateImg(r,this.next_att[i])}},updateImg:function(t,e){this.loadRes(t,function(t){e.sprite.spriteFrame=t}.bind(this))},closeCallBack:function(){for(var t in this.item_scrollview&&this.item_scrollview.deleteMe(),this.item_scrollview=null,this.reward_list)this.reward_list[t]&&(this.reward_list[t].deleteMe(),this.reward_list[t]=null);this.reward_list=null,this.ctrl.openGuildActionGoalWindow(!1)}});e.exports=r,cc._RF.pop()},{common_scrollview:"common_scrollview",guild_action_goal_item:"guild_action_goal_item",guild_controller:"guild_controller",guild_event:"guild_event",pathtool:"pathtool"}],guild_apply_item:[function(t,e,i){"use strict";cc._RF.push(e,"0387cdPSQ1MU45qyKW67bHD","guild_apply_item");var s=t("pathtool"),n=t("guild_controller"),a=t("playerhead"),o=cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("guild","guild_apply_item"),this.ctrl=n.getInstance()},initPanel:function(){this.container=this.seekChild("container"),this.confirm_btn=this.seekChild("confirm_btn"),this.cancel_btn=this.seekChild("cancel_btn"),this.role_name=this.seekChild("role_name",cc.Label),this.role_online=this.seekChild("role_online",cc.Label),this.play_head=new a,this.play_head.setParent(this.container),this.play_head.setPosition(-230,0),this.play_head.show()},registerEvent:function(){this.confirm_btn&&this.confirm_btn.on(cc.Node.EventType.TOUCH_END,function(){null!=this.data&&this.ctrl.requestOperationApply(1,this.data.rid,this.data.srv_id)},this),this.cancel_btn&&this.cancel_btn.on(cc.Node.EventType.TOUCH_END,function(){this.ctrl.requestOperationApply(2,this.data.rid,this.data.srv_id)},this)},setData:function(t){this.data=t,this.root_wnd&&this.onShow()},onShow:function(){if(null!=this.data){var t=this.data;1==t.is_online?this.role_online.string=Utils.TI18N("\u5728\u7ebf"):(this.role_online.node.color=new cc.Color(217,80,20,255),this.role_online.string=Utils.TI18N("\u79bb\u7ebf")),this.role_name.string=t.name,this.play_head.setHeadRes(t.face),this.play_head.setLev(t.lev)}},onDelete:function(){this.play_head&&this.play_head.deleteMe(),this.play_head=null}});e.exports=o,cc._RF.pop()},{guild_controller:"guild_controller",pathtool:"pathtool",playerhead:"playerhead"}],guild_apply_set_window:[function(t,e,i){"use strict";cc._RF.push(e,"9b86cpKra5A9qWm7QqxE1Sa","guild_apply_set_window");var s=t("pathtool"),n=t("guild_controller"),a=cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("guild","guild_apply_set_window"),this.win_type=WinType.Big,this.viewTag=SCENE_TAG.dialogue,this.ctrl=n.getInstance(),this.set_index=0,this.condition_list=[],this.condition_index=0,this.initConditionList()},openCallBack:function(){this.background=this.seekChild("background"),this.background.scale=FIT_SCALE;var t=this.seekChild("container");this.close_btn=this.seekChild(t,"close_btn"),this.confirm_btn=this.seekChild(t,"confirm_btn"),this.set_value=this.seekChild("set_value",cc.Label),this.condition_value=this.seekChild("condition_value",cc.Label),this.condition_left=this.seekChild("condition_left",cc.Button),this.condition_right=this.seekChild("condition_right",cc.Button),this.set_left=this.seekChild("set_left",cc.Button),this.set_right=this.seekChild("set_right",cc.Button)},registerEvent:function(){this.background&&this.background.on(cc.Node.EventType.TOUCH_END,function(){this.ctrl.openGuildApplySetWindow(!1)},this),this.close_btn&&this.close_btn.on(cc.Node.EventType.TOUCH_END,function(){this.ctrl.openGuildApplySetWindow(!1)},this),this.confirm_btn.on("click",function(){var t=this.condition_list[this.condition_index];this.ctrl.requestChangeApplySet(this.set_index,t.lev)},this),this.condition_left.node.on("click",function(){0!=this.condition_index&&(this.condition_index=this.condition_index-1,this.setGuildConditionInfo(this.condition_index))},this),this.condition_right.node.on("click",function(){this.condition_index+1>=this.condition_list.length||(this.condition_index=this.condition_index+1,this.setGuildConditionInfo(this.condition_index))},this),this.set_left.node.on("click",function(){0!=this.set_index&&(this.set_index=this.set_index-1,this.setGuildSetInfo(this.set_index))},this),this.set_right.node.on("click",function(){1!=this.set_index&&(this.set_index=this.set_index+1,this.setGuildSetInfo(this.set_index))},this)},initConditionList:function(){this.condition_list=[{index:1,lev:1,desc:Utils.TI18N("1\u7ea7")},{index:2,lev:10,desc:Utils.TI18N("10\u7ea7")},{index:3,lev:20,desc:Utils.TI18N("20\u7ea7")},{index:4,lev:30,desc:Utils.TI18N("30\u7ea7")},{index:5,lev:40,desc:Utils.TI18N("40\u7ea7")},{index:6,lev:50,desc:Utils.TI18N("50\u7ea7")},{index:7,lev:60,desc:Utils.TI18N("60\u7ea7")}]},setGuildConditionInfo:function(t){var e=this.condition_list[t];null!=e&&(this.condition_value.string=e.desc);var i=1;i=0==t?1:t+1==this.condition_list.length?2:3,this.condition_status!=i&&(this.condition_status=i,1==i?(Utils.setGreyButton(this.condition_left,!0),Utils.setGreyButton(this.condition_right,!1)):2==i?(Utils.setGreyButton(this.condition_left,!1),Utils.setGreyButton(this.condition_right,!0)):(Utils.setGreyButton(this.condition_left,!1),Utils.setGreyButton(this.condition_right,!1)))},setGuildSetInfo:function(t){0==t?(this.set_value.string=Utils.TI18N("\u4e0d\u9700\u8981\u9a8c\u8bc1"),Utils.setGreyButton(this.set_left,!0),Utils.setGreyButton(this.set_right,!1)):1==t&&(this.set_value.string=Utils.TI18N("\u9700\u8981\u9a8c\u8bc1"),Utils.setGreyButton(this.set_left,!1),Utils.setGreyButton(this.set_right,!0))},openRootWnd:function(){var t=this.ctrl.getModel().getMyGuildInfo();if(t){this.set_index=t.apply_type,this.setGuildSetInfo(this.set_index);var e=t.apply_lev;for(var i in this.condition_list){if(this.condition_list[i].lev==e){this.condition_index=Number(i);break}}this.setGuildConditionInfo(this.condition_index)}},closeCallBack:function(){this.ctrl.openGuildApplySetWindow(!1)}});e.exports=a,cc._RF.pop()},{guild_controller:"guild_controller",pathtool:"pathtool"}],guild_apply_window:[function(t,e,i){"use strict";cc._RF.push(e,"5d712kXUbZIAYJqo5V4z45j","guild_apply_window");var s=t("pathtool"),n=t("guild_controller"),a=t("guild_event"),o=t("guild_apply_item"),l=t("common_scrollview"),r=cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("guild","guild_apply_window"),this.win_type=WinType.Big,this.viewTag=SCENE_TAG.dialogue,this.ctrl=n.getInstance()},openCallBack:function(){this.background=this.seekChild("background"),this.background.scale=FIT_SCALE,this.close_btn=this.seekChild("close_btn"),this.list_bg=this.seekChild("listbg"),this.list_con=this.seekChild(this.list_bg,"con"),this.empty_tips=this.seekChild("empty_tips")},registerEvent:function(){this.addGlobalEvent(a.UpdateApplyListInfo,function(){this.updateApplyList()},this),this.background&&this.background.on(cc.Node.EventType.TOUCH_END,function(){this.ctrl.openGuildApplyWindow(!1)},this),this.close_btn&&this.close_btn.on(cc.Node.EventType.TOUCH_END,function(){this.ctrl.openGuildApplyWindow(!1)},this)},openRootWnd:function(){this.ctrl.requestGuildApplyList()},updateApplyList:function(){var t=this.ctrl.getModel().getGuildApplyList();if(null==Utils.next(t))this.empty_tips.active=!0,this.list_con.active=!1;else{if(this.empty_tips.active=!1,this.list_con.active=!0,null==this.scroll_view){var e=this.list_bg.getContentSize();e=cc.size(e.width,e.height-10);var i={item_class:o,start_x:-2,space_x:0,start_y:2,space_y:0,item_width:616,item_height:134,row:0,col:1,need_dynamic:!0};this.scroll_view=new l,this.scroll_view.createScroll(this.list_con,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,e,i,cc.v2(.5,.5))}this.scroll_view.setData(t)}},closeCallBack:function(){this.ctrl.openGuildApplyWindow(!1),this.scroll_view&&this.scroll_view.DeleteMe(),this.scroll_view=null}});e.exports=r,cc._RF.pop()},{common_scrollview:"common_scrollview",guild_apply_item:"guild_apply_item",guild_controller:"guild_controller",guild_event:"guild_event",pathtool:"pathtool"}],guild_change_name_window:[function(t,e,i){"use strict";cc._RF.push(e,"82fa3Vm/mxHI4FNRhkGFjk8","guild_change_name_window");var s=t("pathtool"),n=t("guild_controller"),a=t("role_controller"),o=cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("guild","guild_change_name_window"),this.win_type=WinType.Big,this.viewTag=SCENE_TAG.dialogue,this.ctrl=n.getInstance()},openCallBack:function(){this.background=this.seekChild("background"),this.background.scale=FIT_SCALE,this.close_btn=this.seekChild("close_btn"),this.confirm_btn=this.seekChild("confirm_btn"),this.cost_value=this.seekChild("cost_value",cc.Label),this.edit_title=this.seekChild("edit_title",cc.EditBox),this.item_img_sp=this.seekChild("item_img",cc.Sprite),this.loadRes(s.getItemRes(3),function(t){this.item_img_sp.spriteFrame=t}.bind(this))},registerEvent:function(){this.background.on(cc.Node.EventType.TOUCH_END,function(){this.ctrl.openGuildChangeNameWindow(!1)},this),this.close_btn.on(cc.Node.EventType.TOUCH_END,function(){this.ctrl.openGuildChangeNameWindow(!1)},this),this.confirm_btn.on(cc.Node.EventType.TOUCH_END,function(){if(null!=this.role_vo){var t=this.edit_title.string;""==t?message(Utils.TI18N("\u516c\u4f1a\u540d\u5b57\u4e0d\u80fd\u4e3a\u7a7a\uff01")):t==this.role_vo.gname?message(Utils.TI18N("\u516c\u4f1a\u540d\u5b57\u4e0d\u80fd\u4e0e\u5f53\u524d\u4e00\u6837\uff01")):this.ctrl.requestChangGuildName(t)}},this)},openRootWnd:function(){var t=Config.guild_data.data_const.rename_gold;if(null==this.role_vo&&(this.role_vo=a.getInstance().getRoleVo()),null!=t&&null!=this.role_vo){var e=this.role_vo.gold;this.cost_value.string=cc.js.formatStr("%s/%s",Utils.getMoneyString(e),t.val)}},closeCallBack:function(){this.ctrl.openGuildChangeNameWindow(!1)}});e.exports=o,cc._RF.pop()},{guild_controller:"guild_controller",pathtool:"pathtool",role_controller:"role_controller"}],guild_change_sign_window:[function(t,e,i){"use strict";cc._RF.push(e,"3270dmQc9tBA76KTDZ7EcIK","guild_change_sign_window");var s=t("pathtool"),n=t("guild_controller"),a=cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("guild","guild_change_sign_window"),this.win_type=WinType.Mini,this.viewTag=SCENE_TAG.dialogue,this.ctrl=n.getInstance()},openCallBack:function(){this.background=this.seekChild("background"),this.background.scale=FIT_SCALE,this.close_btn=this.seekChild("close_btn"),this.confirm_btn=this.seekChild("confirm_btn"),this.cost_value=this.seekChild("cost_value",cc.Label),this.edit_title=this.seekChild("edit_title",cc.EditBox)},registerEvent:function(){this.background.on(cc.Node.EventType.TOUCH_END,function(){this.ctrl.openGuildChangeSignWindow(!1)},this),this.close_btn.on(cc.Node.EventType.TOUCH_END,function(){this.ctrl.openGuildChangeSignWindow(!1)},this),this.confirm_btn.on(cc.Node.EventType.TOUCH_END,function(){var t=this.edit_title.string;""==t?message(Utils.TI18N("\u5ba3\u8a00\u4e0d\u80fd\u4e3a\u7a7a\uff01")):this.ctrl.requestChangeGuildSign(t)},this)},openRootWnd:function(){},closeCallBack:function(){this.ctrl.openGuildChangeSignWindow(!1)}});e.exports=a,cc._RF.pop()},{guild_controller:"guild_controller",pathtool:"pathtool"}],guild_const:[function(t,e,i){"use strict";var s;function n(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}cc._RF.push(e,"4af57GMzJRMVJgZa8aSLqys","guild_const");var a=(n(s={post_type:{leader:1,assistant:2,member:3},init_type:{create:2,list:1,search:3},list_type:{total:1,search:2}},"post_type",{leader:1,assistant:2,member:3}),n(s,"status",{normal:0,un_activity:1,activity:2,finish:3}),n(s,"red_index",{apply:1,boss_times:2,boss_kill:3,boss_first:4,donate:5,voyage_escort:6,voyage_interaction:7,voyage_order:8,voyage_temp_escort:9,donate_activity:10,red_bag:12,goal_action:13,guildwar_match:14,guildwar_start:15,guildwar_count:16,guildwar_log:17,guildwar_box:18,skill_2:1002,skill_3:1003,skill_4:1004,skill_5:1005}),s);e.exports=a,cc._RF.pop()},{}],guild_controller:[function(t,e,i){"use strict";cc._RF.push(e,"2dbf7Am47tNd4tWjYCt9GEt","guild_controller");var s=t("guild_const"),n=t("pathtool"),a=t("guild_event"),o=t("role_controller"),l=cc.Class({extends:BaseController,ctor:function(){},initConfig:function(){var e=t("guild_model");this.model=new e,this.model.initConfig()},getModel:function(){return this.model},registerEvents:function(){null==this.login_event_success&&(this.login_event_success=gcore.GlobalEvent.bind(EventId.EVT_ROLE_CREATE_SUCCESS,function(){gcore.GlobalEvent.unbind(this.login_event_success),this.login_event_success=null;var e=t("role_controller");this.role_vo=e.getInstance().getRoleVo(),this.role_vo&&(this.requestInitProtocal(),null==this.role_assets_event&&(this.role_assets_event=this.role_vo.bind(EventId.UPDATE_ROLE_ATTRIBUTE,function(t,e){"gid"==t?(0==e?(this.openGuildMainWindow(!1),this.openGuildMemberWindow(!1),this.openGuildDonateWindow(!1)):(this.init_window&&(this.request_open_main_window=!0),this.openGuildInitWindow(!1)),this.requestInitProtocal()):"position"==t&&this.model.updateMemberByPosition(e)}.bind(this))))}.bind(this)))},registerProtocals:function(){this.RegisterProtocal(13500,this.handle13500),this.RegisterProtocal(13501,this.handle13501),this.RegisterProtocal(13503,this.handle13503),this.RegisterProtocal(13505,this.handle13505),this.RegisterProtocal(13507,this.handle13507),this.RegisterProtocal(13513,this.handle13513),this.RegisterProtocal(13514,this.handle13514),this.RegisterProtocal(13516,this.handle13516),this.RegisterProtocal(13518,this.handle13518),this.RegisterProtocal(13519,this.handle13519),this.RegisterProtocal(13520,this.handle13520),this.RegisterProtocal(13521,this.handle13521),this.RegisterProtocal(13522,this.handle13522),this.RegisterProtocal(13523,this.handle13523),this.RegisterProtocal(13524,this.handle13524),this.RegisterProtocal(13542,this.hander13542),this.RegisterProtocal(13558,this.handle13558),this.RegisterProtocal(13565,this.handle13565),this.RegisterProtocal(13568,this.handle13568),this.RegisterProtocal(13573,this.handle13573),this.RegisterProtocal(13574,this.handle13574),this.RegisterProtocal(13575,this.handle13575),this.RegisterProtocal(13576,this.handle13576),this.RegisterProtocal(16900,this.handle16900),this.RegisterProtocal(16901,this.handle16901),this.RegisterProtocal(16902,this.handle16902),this.RegisterProtocal(16903,this.handle16903),this.RegisterProtocal(16904,this.handle16904)},requestInitProtocal:function(){null!=this.role_vo&&(0==this.role_vo.gid?this.model.clearMyGuildInfo():(this.SendProtocal(13518,{}),this.SendProtocal(13523,{}),this.SendProtocal(16900,{}),this.role_vo.position!=s.post_type.member&&this.SendProtocal(13573,{})))},checkOpenGuildWindow:function(t){null==this.role_vo||0==this.role_vo.gid?this.openGuildInitWindow(!0,t):this.openGuildMainWindow(!0,t)},openGuildInitWindow:function(t,e){t?(null==this.init_window&&(this.init_window=Utils.createClass("guildinit_window")),this.init_window.open(e)):null!=this.init_window&&(this.init_window.close(),this.init_window=null)},openGuildMainWindow:function(t,e){t?(null==this.main_window&&(this.main_window=Utils.createClass("guild_main_window")),this.main_window.open(e)):this.main_window&&(this.main_window.close(),this.main_window=null)},openGuildMemberWindow:function(t){t?(null==this.member_window&&(this.member_window=Utils.createClass("guild_member_window")),this.member_window.open()):this.member_window&&(this.member_window.close(),this.member_window=null)},openGuildDonateWindow:function(t){if(t){if(null==this.role_vo||!this.role_vo.isHasGuild())return void message(Utils.TI18N("\u60a8\u6682\u65f6\u8fd8\u6ca1\u6709\u52a0\u5165\u516c\u4f1a"));null==this.donate_window&&(this.donate_window=Utils.createClass("guild_donate_window")),this.donate_window.open()}else this.donate_window&&(this.donate_window.close(),this.donate_window=null)},openGuildApplyWindow:function(t){t?(null==this.apply_window&&(this.apply_window=Utils.createClass("guild_apply_window")),this.apply_window.open()):this.apply_window&&(this.apply_window.close(),this.apply_window=null)},openGuildActionGoalWindow:function(t){t?(null==this.goal_window&&(this.goal_window=Utils.createClass("guild_action_goal_window")),this.goal_window.open()):this.goal_window&&(this.goal_window.close(),this.goal_window=null)},openGuildRewardWindow:function(t){t?(null==this.reward_window&&(this.reward_window=Utils.createClass("guild_reward_window")),this.reward_window.open()):this.reward_window&&(this.reward_window.close(),this.reward_window=null)},openGuildApplySetWindow:function(t){t?(null==this.apply_set_window&&(this.apply_set_window=Utils.createClass("guild_apply_set_window")),this.apply_set_window.open()):this.apply_set_window&&(this.apply_set_window.close(),this.apply_set_window=null)},openGuildOperationPostWindow:function(t,e){t?(null==this.operation_post_window&&(this.operation_post_window=Utils.createClass("guild_operation_post_window")),this.operation_post_window.open(e)):this.operation_post_window&&(this.operation_post_window.close(),this.operation_post_window=null)},openGuildImpeachPostWindow:function(t){t?(null==this.impeach_post_window&&(this.impeach_post_window=Utils.createClass("guild_impeach_post_window")),this.impeach_post_window.open()):this.impeach_post_window&&(this.impeach_post_window.close(),this.impeach_post_window=null)},openGuildChangeNameWindow:function(t){t?(null==this.change_name_window&&(this.change_name_window=Utils.createClass("guild_change_name_window")),this.change_name_window.open()):this.change_name_window&&(this.change_name_window.close(),this.change_name_window=null)},openGuildChangeSignWindow:function(t){t?(null==this.change_sign_window&&(this.change_sign_window=Utils.createClass("guild_change_sign_window")),this.change_sign_window.open()):this.change_sign_window&&(this.change_sign_window.close(),this.change_sign_window=null)},requestCreateGuild:function(t,e,i,s){var n={};n.name=t,n.sign=e,n.apply_lev=s||1,n.apply_type=i||0,this.SendProtocal(13500,n)},handle13500:function(t){message(t.msg)},requestGuildList:function(t,e,i,s){var n={};n.page=t||0,n.flag=e||1,n.num=i||0,n.name=s||"",this.SendProtocal(13501,n)},handle13501:function(t){this.model.updateGuildList(t.name,t.guilds)},requestJoinGuild:function(t,e,i){if(null!=t&&null!=e){var s={};s.gid=t,s.gsrv_id=e,s.type=i||1,this.SendProtocal(13503,s)}},handle13503:function(t){message(t.msg),1==t.code&&this.model.updateGuildApplyStatus(t.gid,t.gsrv_id,t.is_apply)},handle13518:function(t){this.model.updateMyGuildInfo(t),1==this.request_open_main_window&&(this.request_open_main_window=!1,this.openGuildMainWindow(!0))},send13565:function(){this.SendProtocal(13565,{})},handle13565:function(t){message(t.msg)},requestGuildMemberList:function(){this.SendProtocal(13519,{})},handle13519:function(t){this.model.updateMyGuildMemberList(t.members,1)},handle13523:function(e){this.model.updateDonateInfo(e.donate_list),this.model.updateDonateBoxInfo(e.boxes,e.donate_exp),t("redbag_controller").getInstance().getModel().updateRedBagNum(e.day_send_num,e.day_recv_num)},requestGuildDonate:function(t){var e={};e.type=t,this.SendProtocal(13524,e)},handle13524:function(t){message(t.msg),1==t.code&&this.model.setGuildDonateStatus()},hander13542:function(t){this.model.updateMyGuildMemberList(t.members,t.type)},requestOperationApply:function(t,e,i){var s={};s.type=t,s.rid=e,s.srv_id=i,this.SendProtocal(13505,s)},handle13505:function(t){message(t.msg),1==t.code&&this.model.deleteApplyInfo(t.rid,t.srv_id)},requestGuildApplyList:function(t,e){var i={};i.page=t,i.num=e,this.SendProtocal(13507,i)},handle13507:function(t){this.model.updateGuildApplyList(t.guids)},requestExitGuild:function(){var e=o.getInstance().getRoleVo();if(null!=e)if(e.position==s.post_type.leader){var i=cc.js.formatStr(Utils.TI18N("\u662f\u5426\u786e\u5b9a\u89e3\u6563\u516c\u4f1a\u3010%s\u3011\uff1f"),e.gname),n="";n=0!=e.guild_quit_time?Utils.TI18N("(\u89e3\u6563\u516c\u4f1a\u540e\uff0c\u4f1a\u957f\u5c06\u572824\u5c0f\u65f6\u5185\u65e0\u6cd5\u52a0\u5165\u5176\u4ed6\u516c\u4f1a)"):Utils.TI18N("(\u9996\u6b21\u9000\u51fa\u6216\u89e3\u6563\u516c\u4f1a\u540e\uff0c\u53ef\u7acb\u5373\u52a0\u5165\u5176\u4ed6\u516c\u4f1a\u3002)"),t("commonalert").show(i,Utils.TI18N("\u786e\u5b9a"),function(){this.SendProtocal(13516,{})}.bind(this),Utils.TI18N("\u53d6\u6d88"),null,null,null,{timer:3,timer_for:!0,off_y:43,title:Utils.TI18N("\u89e3\u6563\u516c\u4f1a"),extend_str:n,extend_offy:-5,extend_aligment:cc.TEXT_ALIGNMENT_CENTER})}else{i=cc.js.formatStr(Utils.TI18N("\u662f\u5426\u786e\u5b9a\u9000\u51fa\u516c\u4f1a\u3010%s\u3011\uff1f"),e.gname),n="";n=0!=e.guild_quit_time?Utils.TI18N("(\u9000\u51fa\u516c\u4f1a\u540e12\u5c0f\u65f6\u5185\u65e0\u6cd5\u52a0\u5165\u5176\u4ed6\u516c\u4f1a)"):Utils.TI18N("(\u9996\u6b21\u9000\u51fa\u516c\u4f1a\u53ef\u7acb\u5373\u52a0\u5165\u5176\u5b83\u516c\u4f1a)"),t("commonalert").show(i,Utils.TI18N("\u786e\u5b9a"),function(){this.SendProtocal(13514,{})}.bind(this),Utils.TI18N("\u53d6\u6d88"),null,null,null,{timer:3,timer_for:!0,off_y:43,title:Utils.TI18N("\u9000\u51fa\u516c\u4f1a"),extend_str:n,extend_offy:-5,extend_aligment:cc.TEXT_ALIGNMENT_CENTER})}},handle13514:function(t){message(t.msg)},handle13516:function(t){message(t.msg)},requestChangeApplySet:function(t,e){var i={};i.apply_type=t,i.apply_lev=e,this.SendProtocal(13522,i)},handle13522:function(t){message(t.msg),1==t.code&&this.openGuildApplySetWindow(!1)},requestChangeGuildSign:function(t){var e={};e.sign=t,this.SendProtocal(13521,e)},handle13521:function(t){message(t.msg),1==t.code&&this.openGuildChangeSignWindow(!1)},requestKickoutMember:function(e,i,s){var n=function(){var t={};t.rid=e,t.srv_id=i,this.SendProtocal(13513,t)}.bind(this),a=cc.js.formatStr(Utils.TI18N("\u662f\u5426\u786e\u8ba4\u5c06\u3010%s\u3011\u73a9\u5bb6\u79fb\u9664\u51fa\u516c\u4f1a\uff1f"),s);t("commonalert").show(a,Utils.TI18N("\u786e\u5b9a"),function(){n()}.bind(this),Utils.TI18N("\u53d6\u6d88"))},handle13513:function(t){message(t.msg),1==t.code&&this.openGuildOperationPostWindow(!1)},requestOperationPost:function(t,e,i){var s={};s.rid=t,s.srv_id=e,s.position=i,this.SendProtocal(13520,s)},handle13520:function(t){message(t.msg),1==t.code&&this.openGuildOperationPostWindow(!1)},requestChangGuildName:function(t){var e={};e.name=t,this.SendProtocal(13568,e)},handle13568:function(t){message(t.msg),1==t.code&&this.openGuildChangeNameWindow(!1)},requestGuildRecruit:function(){var e=this.model.getMyGuildInfo();if(null!=e)if(0==e.recruit_num){var i=Utils.TI18N("\u662f\u5426\u786e\u5b9a\u53d1\u5e03\u62db\u52df\u516c\u544a\uff1f\n\n<color=#AA6111><size=22>\u6bcf\u65e5\u9996\u6b21\u53d1\u5e03\u516c\u544a\u514d\u8d39</size></c>"),s=Utils.TI18N("\uff08\u6bcf\u65e5\u9996\u6b21\u53d1\u5e03\u516c\u544a\u514d\u8d39\uff09");(c=t("commonalert")).show(i,Utils.TI18N("\u786e\u5b9a"),function(){this.SendProtocal(13558,{})}.bind(this),Utils.TI18N("\u53d6\u6d88"),null,null,null,null)}else{var a=gdata("guild_data","data_const","recruit_cost"),l=o.getInstance().getRoleVo();if(a&&l){var r=l.gold,c=(s=cc.js.formatStr("<color=#AA6111><size=22>\u53d1\u5e03\u6d88\u8017\uff1a<img src='%s' scale=0.5 />%s/%s</size></c>",15,Utils.getMoneyString(r),a.val),i=cc.js.formatStr(Utils.TI18N("\u662f\u5426\u786e\u5b9a\u82b1\u8d39<img src='%s' scale=0.5 />%s\u53d1\u5e03\u62db\u52df\u5e7f\u544a\uff1f\n\n%s"),15,a.val,s),t("commonalert")),_=n.getItemRes(15);c.show(i,Utils.TI18N("\u786e\u5b9a"),function(){this.SendProtocal(13558,{})}.bind(this),Utils.TI18N("\u53d6\u6d88"),null,2,null,{resArr:[_]})}}},handle13558:function(t){message(t.msg)},handle13573:function(t){this.model.updateGuildRedStatus(s.red_index.apply,1==t.code)},setApplyListStatus:function(t){this.model.updateGuildRedStatus(s.red_index.apply,!0)},requestDonateBoxRewards:function(t){var e={};e.box_id=t,this.SendProtocal(13574,e)},handle13574:function(t){message(t.msg),1==t.code&&this.model.setDonateBoxStatus(t.box_id)},handle13575:function(t){this.model.updateDonateActivity(t.donate_exp)},welcomeNewMember:function(t,e){var i={};i.rid=t,i.srv_id=e,this.SendProtocal(13576,i)},handle13576:function(t){message(t.msg)},send16900:function(){this.SendProtocal(16900,{})},handle16900:function(t){this.model.updataGuildActionRedStatus(t),gcore.GlobalEvent.fire(a.UpdataGuildGoalBasicData,t)},send16901:function(){this.SendProtocal(16901,{})},handle16901:function(t){gcore.GlobalEvent.fire(a.UpdataGuildGoalTaskData,t)},handle16902:function(t){gcore.GlobalEvent.fire(a.UpdataGuildGoalSingleTaskData,t)},send16903:function(t){var e={};e.id=t,this.SendProtocal(16903,e)},handle16903:function(t){message(t.msg)},send16904:function(){this.SendProtocal(16904,{})},handle16904:function(t){message(t.msg)},getGuildMainRootWnd:function(){if(this.main_window)return this.main_window.root_wnd}});e.exports=l,cc._RF.pop()},{commonalert:"commonalert",guild_const:"guild_const",guild_event:"guild_event",guild_model:"guild_model",pathtool:"pathtool",redbag_controller:"redbag_controller",role_controller:"role_controller"}],guild_create_panel:[function(t,e,i){"use strict";cc._RF.push(e,"1d2faO6rhxJOaYfWW7GOSZ8","guild_create_panel");var s=t("pathtool"),n=t("guild_controller"),a=cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("guild","guild_create_panel"),this.ctrl=n.getInstance(),this.set_index=0,this.condition_index=0,this.condition_list=[],this.desc_="",this.initConditionList()},initPanel:function(){var t=this.root_wnd.getChildByName("container");this.set_value=this.seekChild(t,"set_value",cc.Label),this.condition_value=this.seekChild(t,"condition_value",cc.Label),this.condition_left=this.seekChild(t,"condition_left",cc.Button),this.condition_right=this.seekChild(t,"condition_right",cc.Button),this.set_left=this.seekChild(t,"set_left",cc.Button),this.set_right=this.seekChild(t,"set_right",cc.Button),this.edit_title=this.seekChild(t,"edit_title",cc.EditBox),this.declaration_value=this.seekChild(t,"declaration_value",cc.EditBox),this.declaration_value.string=this.desc_,this.declaration_text=this.seekChild(this.declaration_value.node,"TEXT_LABEL",cc.Label),this.declaration_text.enableWrapText=!0,this.create_btn=this.seekChild(t,"create_btn",cc.Button),this.create_btn_label=this.seekChild(this.create_btn.node,"Label",cc.Label),this.create_btn_img=this.seekChild(this.create_btn.node,"Sprite",cc.Sprite),this.create_btn_img.node.setScale(.3,.3);var e=gdata("guild_data","data_const","create_gold"),i=100;null!=e&&(i=e.val);var n=Utils.getItemConfig(gdata("item_data","data_assets_label2id","gold")),a=2;null!=n&&(a=n.icon),this.create_btn_label.string=cc.js.formatStr("%s %s",i,Utils.TI18N("\u521b\u5efa\u516c\u4f1a")),s.getItemRes(a)&&this.loadRes(s.getItemRes(a),function(t){this.create_btn_img.spriteFrame=t}.bind(this)),this.desc_vip_lb=this.seekChild("desc_vip",cc.Label);var o=gdata("guild_data","data_const","maintain_vip_condition");o.val>0?this.desc_vip_lb.string=cc.js.formatStr(Utils.TI18N("\u9700\u8fbeVIP%s\u624d\u53ef\u521b\u5efa\u516c\u4f1a"),o.val):this.desc_vip_lb.node.active=!1},registerEvent:function(){this.condition_left.node.on("click",function(){0!=this.condition_index&&(this.condition_index=this.condition_index-1,this.setGuildConditionInfo(this.condition_index))},this),this.condition_right.node.on("click",function(){this.condition_index+1>=this.condition_list.length||(this.condition_index=this.condition_index+1,this.setGuildConditionInfo(this.condition_index))},this),this.set_left.node.on("click",function(){0!=this.set_index&&(this.set_index=this.set_index-1,this.setGuildSetInfo(this.set_index))},this),this.set_right.node.on("click",function(){1!=this.set_index&&(this.set_index=this.set_index+1,this.setGuildSetInfo(this.set_index))},this),this.create_btn.node.on(cc.Node.EventType.TOUCH_END,function(){var t=this.condition_list[this.condition_index],e=this.edit_title.string;if(""==e)message(Utils.TI18N("\u516c\u4f1a\u540d\u79f0\u4e0d\u80fd\u4e3a\u7a7a"));else if(Utils.getByteLen(e)>12)message(Utils.TI18N("\u516c\u4f1a\u540d\u5b57\u4e0d\u5f97\u8d85\u8fc76\u4e2a\u6587\u5b57"));else{var i=this.declaration_value.string;null!=t&&this.ctrl.requestCreateGuild(e,i,self.set_index,t.lev)}},this)},openRootWnd:function(){},onShow:function(){if(this.setGuildSetInfo(this.set_index),this.setGuildConditionInfo(this.condition_index),Config.guild_data.data_sign_length>0){var t=Math.floor(Math.random()*Config.guild_data.data_sign_length+1),e=Config.guild_data.data_sign[t];null!=e&&(this.declaration_value.string=e.sign,this.desc_=e.sign)}},addToParent:function(t){this.showStatus=t,null!=this.root_wnd&&this.setVisible(t)},initConditionList:function(){this.condition_list=[{index:1,lev:1,desc:Utils.TI18N("1\u7ea7")},{index:2,lev:10,desc:Utils.TI18N("10\u7ea7")},{index:3,lev:20,desc:Utils.TI18N("20\u7ea7")},{index:4,lev:30,desc:Utils.TI18N("30\u7ea7")},{index:5,lev:40,desc:Utils.TI18N("40\u7ea7")},{index:6,lev:50,desc:Utils.TI18N("50\u7ea7")},{index:7,lev:60,desc:Utils.TI18N("60\u7ea7")}]},setGuildConditionInfo:function(t){var e=this.condition_list[t];null!=e&&(this.condition_value.string=e.desc);var i=1;i=0==t?1:t+1==this.condition_list.length?2:3,this.condition_status!=i&&(this.condition_status=i,1==i?(Utils.setGreyButton(this.condition_left,!0),Utils.setGreyButton(this.condition_right,!1)):2==i?(Utils.setGreyButton(this.condition_left,!1),Utils.setGreyButton(this.condition_right,!0)):(Utils.setGreyButton(this.condition_left,!1),Utils.setGreyButton(this.condition_right,!1)))},setGuildSetInfo:function(t){0==t?(this.set_value.string=Utils.TI18N("\u4e0d\u9700\u8981\u9a8c\u8bc1"),Utils.setGreyButton(this.set_left,!0),Utils.setGreyButton(this.set_right,!1)):1==t&&(this.set_value.string=Utils.TI18N("\u9700\u8981\u9a8c\u8bc1"),Utils.setGreyButton(this.set_left,!1),Utils.setGreyButton(this.set_right,!0))},onDelete:function(){}});e.exports=a,cc._RF.pop()},{guild_controller:"guild_controller",pathtool:"pathtool"}],guild_donate_item:[function(t,e,i){"use strict";cc._RF.push(e,"58196Em/oRK4oGq5cZKvIKY","guild_donate_item");var s=t("pathtool"),n=t("guild_controller"),a=cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("guild","guild_donate_item"),this.ctrl=n.getInstance(),this.model=this.ctrl.getModel(),this.awards_list={}},initPanel:function(){this.donate_btn=this.seekChild("donate_btn",cc.Button),this.donate_btn_label=this.seekChild(this.donate_btn.node,"label",cc.Label),this.donate_btn_lo=this.seekChild(this.donate_btn.node,"label",cc.LabelOutline),this.donate_btn_label.string=Utils.TI18N("\u6350\u732e"),this.pass_donate=this.seekChild("pass_donate",cc.Sprite),this.img=this.seekChild("img",cc.Sprite),this.title_desc=this.seekChild("title_desc",cc.Label),this.item_img=this.seekChild("item_img",cc.Sprite),this.donate_value=this.seekChild("donate_value",cc.Label)},registerEvent:function(){this.donate_btn.node.on("click",function(){null!=this.data&&this.ctrl.requestGuildDonate(this.data.id)},this)},setData:function(t){this.data=t,this.root_wnd&&this.onShow()},onShow:function(){if(null!=this.data){var t=this.data;if(this.updateDonateStatus(),this.title_desc.string=t.desc,null!=this.data.loss){var e=this.data.loss[0];if(null!=e)(n=Utils.getItemConfig(e[0]))&&(s.getItemRes(n.icon)&&this.loadRes(s.getItemRes(n.icon),function(t){this.item_img.spriteFrame=t}.bind(this)),this.donate_value.string=e[1])}if(null!=this.data.gain)for(var i in this.data.gain){var n,a=this.data.gain[i];if(null==this.awards_list[i])if(null!=(n=Utils.getItemConfig(a[0]))){this.awards_list[i]={},this.awards_list[i].label=this.seekChild(cc.js.formatStr("rich_%s",Number(i)+1),cc.RichText),this.awards_list[i].img=this.seekChild(cc.js.formatStr("gold_%s",Number(i)+1),cc.Sprite),this.awards_list[i].label.string=cc.js.formatStr(" %s",a[1]);var o=this.awards_list[i].img;this.updateImg(s.getItemRes(n.icon),o)}}var l=cc.js.formatStr("txt_cn_guild_100%s",this.data.id);this.res_id!=l&&(this.res_id=l,this.loadRes(s.getUIIconPath("guild",l),function(t){this.img.spriteFrame=t}.bind(this)))}},updateImg:function(t,e){this.loadRes(t,function(t){e.spriteFrame=t}.bind(this))},updateDonateStatus:function(t){if(null!=this.data){var e=this.model.checkDonateStatus(this.data.id),i=e[0],s=e[1];1==i?1==s?(this.pass_donate.node.active=!0,this.donate_btn.node.active=!1,this.donate_btn_label.string=Utils.TI18N("\u5df2\u6350\u732e")):(Utils.setGreyButton(this.donate_btn),this.donate_btn_label.string=Utils.TI18N("\u4e0d\u53ef\u6350\u732e"),this.donate_btn.active=!0,this.donate_btn_lo.enabled=!1,this.pass_donate.node.active=!1):(Utils.setGreyButton(this.donate_btn,!1),this.donate_btn_label.string=Utils.TI18N("\u6350\u732e"),this.donate_btn.node.active=!0,this.pass_donate.node.active=!1)}},onDelete:function(){}});e.exports=a,cc._RF.pop()},{guild_controller:"guild_controller",pathtool:"pathtool"}],guild_donate_window:[function(t,e,i){"use strict";cc._RF.push(e,"b24e1N99hdD1plf6g9CHud5","guild_donate_window");var s=t("pathtool"),n=t("guild_controller"),a=t("guild_const"),o=t("common_scrollview"),l=t("role_controller"),r=t("guild_event"),c=t("guild_donate_item"),_=cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("guild","guild_donate_window"),this.win_type=WinType.Big,this.viewTag=SCENE_TAG.dialogue,this.ctrl=n.getInstance(),this.model=this.ctrl.getModel(),this.role_vo=l.getInstance().getRoleVo(),this.awards_list={}},openCallBack:function(){this.main_panel=this.seekChild("main_panel"),this.close_btn=this.seekChild(this.main_panel,"close_btn"),this.background=this.seekChild("background"),this.background.scale=FIT_SCALE,this.donate_container=this.seekChild("donate_container"),this.progress_bar=this.seekChild("progress_bar",cc.ProgressBar),this.lev_title=this.seekChild("lev_title",cc.Label),this.exp_value=this.seekChild("exp_value",cc.Label),this.explain_btn=this.seekChild("explain_btn"),this.total_width=this.progress_bar.node.getContentSize().width,this.start_x=174;var t=Config.guild_data.data_const.day_exp_max;if(t)for(var e in Config.guild_data.data_donate_box){var i=gdata("guild_data","data_donate_box",[e]),s=this.seekChild(cc.js.formatStr("awards_%s",Number(e)));s.active=!0;var n=s.getChildByName("container"),l=n.getComponent(sp.Skeleton);s.getChildByName("value").getComponent(cc.Label).string=i.box_val;var r=i.box_val/t.val;s.setPosition(this.start_x+this.total_width*r,270);var _={};_.item=s,_.container=n,_.status=a.status.normal,_.id=e,_.config=i,_.skeleton=l,_.is_show_tips=!0,this.awards_list[e]=_}this.desc=this.seekChild("desc",cc.RichText);var h=this.donate_container.getContentSize(),d=cc.size(h.width,h.height-10),u={item_class:c,start_x:4,space_x:0,start_y:0,space_y:-1,item_width:614,item_height:187,row:0,col:1,need_dynamic:!0};this.scroll_view=new o,this.scroll_view.createScroll(this.donate_container,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,d,u,cc.v2(.5,.5))},registerEvent:function(){var e=this;this.explain_btn.on(cc.Node.EventType.TOUCH_END,function(e){var i=Config.guild_data.data_const.game_rule1;Utils.playButtonSound(1);var s=e.touch.getLocation();t("tips_controller").getInstance().showCommonTips(i.desc,s)},this),this.close_btn.on(cc.Node.EventType.TOUCH_END,function(){this.ctrl.openGuildDonateWindow(!1)},this),this.background.on(cc.Node.EventType.TOUCH_END,function(){this.ctrl.openGuildDonateWindow(!1)},this);var i=function(){var i=e.awards_list[s];i.item.on(cc.Node.EventType.TOUCH_END,function(){i.config&&(1==i.is_show_tips?t("commonalert").showItemApply(Utils.TI18N("\u5f53\u524d\u6350\u732e\u6d3b\u8dc3\u5ea6\u5956\u52b1"),i.config.rewards,null,Utils.TI18N("\u786e\u5b9a"),null,null,Utils.TI18N("\u5956\u52b1"),null,null,!0):this.ctrl.requestDonateBoxRewards(i.id))},e)};for(var s in this.awards_list)i();null==this.my_guild_info&&(this.my_guild_info=this.model.getMyGuildInfo(),this.addGlobalEvent(r.UpdateMyInfoEvent,function(t,e){"lev"==t&&this.updateMyGuildLev()},this)),this.addGlobalEvent(r.UpdateDonateInfo,function(){this.updateDonateListStatus()},this),this.addGlobalEvent(r.UpdateDonateBoxStatus,function(t){if(null!=t){var e=this.awards_list[t];e&&(e.is_show_tips=!0,e.status=a.status.finish,e.skeleton&&(e.skeleton.setToSetupPose(),e.skeleton.clearTracks(),e.skeleton.setAnimation(0,PlayerAction.action_3,!0)))}else this.updateDonateBoxList()},this)},openRootWnd:function(){var t=Config.guild_data.data_donate,e=[];for(var i in t)e.push(t[i]);this.scroll_view.setData(e),this.updateDonateBoxList(),this.updateMyGuildLev()},updateDonateBoxList:function(){var t=this.model.getDonateActivityValue();if(this.exp_value.string=t,null!=(n=gdata("guild_data","data_const","day_exp_max")))for(var e in this.progress_bar.progress=t/n.val,this.awards_list){var i=this.awards_list[e],n=i.config,o=this.model.getDonateBoxStatus(i.id),l=a.status.normal;l=1==o?a.status.finish:t>=i.config.box_val?a.status.activity:a.status.un_activity;var r=PlayerAction.action_1;if(l==a.status.finish?r=PlayerAction.action_3:l==a.status.activity&&(r=PlayerAction.action_2),l==a.status.activity?i.is_show_tips=!1:i.is_show_tips=!0,i.skeleton.skeletonData)l!=i.status&&(i.status=l,i.skeleton.setAnimation(0,r,!0));else{var c=s.getEffectRes(i.config.effect_id),_=cc.js.formatStr("spine/%s/action.atlas",c),h=i.skeleton;this.createEffect(h,_,r)}}},createEffect:function(t,e,i){this.loadRes(e,function(e){t.skeletonData=e,t.setAnimation(0,i,!0)}.bind(this))},updateMyGuildLev:function(){if(null!=this.my_guild_info){this.lev_title.string=cc.js.formatStr(Utils.TI18N("\u516c\u4f1a\u7b49\u7ea7\uff1a%s\u7ea7"),this.my_guild_info.lev);var t=this.my_guild_info.lev+1,e=gdata("guild_data","data_guild_lev",[t]);this.desc.string=null==e?Utils.TI18N("\u5f53\u524d\u5df2\u8fbe\u6700\u5927\u503c\uff01"):StringUtil.parse(e.desc)}},updateDonateListStatus:function(){var t=this.scroll_view.getItemList();if(t)for(var e in t){var i=t[e];i.updateDonateStatus&&i.updateDonateStatus()}},closeCallBack:function(){this.ctrl.openGuildDonateWindow(!1),this.scroll_view&&this.scroll_view.DeleteMe(),this.scroll_view=null}});e.exports=_,cc._RF.pop()},{common_scrollview:"common_scrollview",commonalert:"commonalert",guild_const:"guild_const",guild_controller:"guild_controller",guild_donate_item:"guild_donate_item",guild_event:"guild_event",pathtool:"pathtool",role_controller:"role_controller",tips_controller:"tips_controller"}],guild_event:[function(t,e,i){"use strict";cc._RF.push(e,"84a36HGKtBI+pm9CmS6PXja","guild_event"),e.exports={UpdateGuildList:"UpdateGuildList",UpdateGuildItemEvent:"UpdateGuildItemEvent",UpdateMyInfoEvent:"UpdateMyInfoEvent",UpdateMyMemberListEvent:"UpdateMyMemberListEvent",UpdateMyMemberItemEvent:"UpdateMyMemberItemEvent",UpdateAssistantNumEvent:"UpdateAssistantNumEvent",UpdateDonateInfo:"UpdateDonateInfo",UpdateApplyListInfo:"UpdateApplyListInfo",UpdateGuildRedStatus:"UpdateGuildRedStatus",UpdateDonateBoxStatus:"UpdateDonateBoxStatus",UpdataGuildGoalBasicData:"UpdataGuildGoalBasicData",UpdataGuildGoalTaskData:"UpdataGuildGoalTaskData",UpdataGuildGoalSingleTaskData:"UpdataGuildGoalSingleTaskData"},cc._RF.pop()},{}],guild_impeach_post_window:[function(t,e,i){"use strict";cc._RF.push(e,"c0e33PMi69FxZXnqOntHkF6","guild_impeach_post_window");var s=t("pathtool"),n=t("guild_controller"),a=cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("guild","guild_impeach_post_window"),this.win_type=WinType.Mini,this.viewTag=SCENE_TAG.dialogue,this.ctrl=n.getInstance()},openCallBack:function(){this.background=this.seekChild("background"),this.close_btn=this.seekChild("close_btn"),this.background.scale=FIT_SCALE,this.notice=this.seekChild("notice",cc.Label),this.impeach_btn=this.seekChild("impeach_btn"),this.text_diamond=this.seekChild(this.impeach_btn,"textDiamond",cc.Label),this.btn_sp=this.seekChild(this.impeach_btn,"sprite",cc.Sprite),this.loadRes(s.getItemRes(3),function(t){this.btn_sp.spriteFrame=t}.bind(this))},registerEvent:function(){this.background.on(cc.Node.EventType.TOUCH_END,function(){this.ctrl.openGuildImpeachPostWindow(!1)},this),this.close_btn.on(cc.Node.EventType.TOUCH_END,function(){this.ctrl.openGuildImpeachPostWindow(!1)},this),this.impeach_btn.on(cc.Node.EventType.TOUCH_END,function(){this.ctrl.send13565(),this.ctrl.openGuildImpeachPostWindow(!1)},this)},openRootWnd:function(){this.notice&&(this.notice.string=Utils.TI18N("\u8be5\u4f1a\u957f\u957f\u671f\u4e0d\u5728\u7ebf\uff0c\u4e3a\u4e86\u516c\u4f1a\u7684\u5065\u5eb7\u53d1\u5c55\uff0c\u9700\u8981\u4e00\u4f4d\u65b0\u7684\u4f1a\u957f\u7ad9\u51fa\u6765\u3002\u5f39\u52be\u4f1a\u957f\u540e\uff0c\u4f60\u5c06\u6210\u4e3a\u65b0\u7684\u4f1a\u957f")),this.text_diamond.string=gdata("guild_data","data_const","impeach_gold").val[0][1]},closeCallBack:function(){this.ctrl.openGuildImpeachPostWindow(!1)}});e.exports=a,cc._RF.pop()},{guild_controller:"guild_controller",pathtool:"pathtool"}],guild_list_panel:[function(t,e,i){"use strict";cc._RF.push(e,"7a7c5TpThNGGa9p08TFtMLb","guild_list_panel");var s=t("pathtool"),n=t("guild_const"),a=t("common_scrollview"),o=t("guild_request_item"),l=t("guild_controller"),r=t("guild_event"),c=cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("guild","guild_list_panel"),this.ctrl=l.getInstance()},initPanel:function(){if(this.empty_tips=this.seekChild("empty_tips"),this.desc=this.seekChild("desc",cc.Label),this.desc.string=Utils.TI18N("\u6682\u65e0\u4efb\u4f55\u516c\u4f1a\u4fe1\u606f"),this.scroll_container=this.seekChild("background"),this.checkbox=this.seekChild("checkbox",cc.Toggle),this.checkbox.isChecked=!1,null==this.scroll_view){var t=this.scroll_container.getContentSize(),e={item_class:o,start_x:2.5,space_x:0,start_y:2,space_y:0,item_width:616,item_height:134,row:0,col:1,need_dynamic:!0};this.scroll_view=new a,this.scroll_view.createScroll(this.scroll_container,cc.v2(0,.5*t.height-5),ScrollViewDir.vertical,ScrollViewStartPos.top,t,e,cc.v2(.5,.5))}},registerEvent:function(){this.addGlobalEvent(r.UpdateGuildList,function(t,e){t==n.list_type.total&&(this.all_list=e||[],this.filterNotFullList())}.bind(this)),this.checkbox.node.on("toggle",function(){this.filterNotFullList()},this),this.ctrl.requestGuildList()},openRootWnd:function(){},onShow:function(){},addToParent:function(t){null!=this.root_wnd&&this.setVisible(t),1==t&&this.scroll_view},filterNotFullList:function(){if(this.all_list){var t;if(this.checkbox.isChecked){if(null==this.filter_list)for(var e in this.filter_list=[],this.all_list){var i=this.all_list[e];i.members_num<i.members_max&&this.filter_list.push(i)}t=this.filter_list}else t=this.all_list;this.updateGuildList(t)}},updateGuildList:function(t){if(null==t||null==Utils.next(t))this.empty_tips.active=!0;else{if(this.empty_tips.active=!1,null==this.scroll_view){var e=this.scroll_container.getContentSize(),i={item_class:o,start_x:2.5,space_x:0,start_y:2,space_y:0,item_width:616,item_height:134,row:0,col:1,need_dynamic:!0};this.scroll_view=new a,this.scroll_view.createScroll(this.scroll_container,cc.v2(0,.5*e.height-5),ScrollViewDir.vertical,ScrollViewStartPos.top,e,i,cc.v2(.5,.5))}this.scroll_view.setData(t)}},onDelete:function(){this.scroll_view&&this.scroll_view.deleteMe(),this.scroll_view=null}});e.exports=c,cc._RF.pop()},{common_scrollview:"common_scrollview",guild_const:"guild_const",guild_controller:"guild_controller",guild_event:"guild_event",guild_request_item:"guild_request_item",pathtool:"pathtool"}],guild_list_vo:[function(t,e,i){"use strict";cc._RF.push(e,"cfec1vreFpEkrBYsKV6vAuC","guild_list_vo");var s=t("guild_event"),n=cc.Class({extends:gcore.BaseEvent,ctor:function(){this.initData()},initData:function(){this.gid=0,this.gsrv_id="",this.name="",this.lev=0,this.members_num=0,this.members_max=0,this.leader_name=0,this.apply_type=0,this.apply_lev=0,this.is_apply=0},updateData:function(t){for(var e in t)null!=this[e]&&this.setGuildAttribute(e,t[e])},setGuildAttribute:function(t,e){this[t]!=e&&(this[t]=e,this.dispatchUpdateAttrByKey(t,e))},dispatchUpdateAttrByKey:function(t,e){this.fire(s.UpdateGuildItemEvent,t,e)},_delete:function(){}});e.exports=n,cc._RF.pop()},{guild_event:"guild_event"}],guild_main_window:[function(t,e,i){"use strict";cc._RF.push(e,"ae30fDIOj1A/53G+jrrGUOn","guild_main_window");var s=t("pathtool"),n=t("guild_controller"),a=t("guildboss_controller"),o=t("guildskill_controller"),l=t("redbag_controller"),r=t("guildwar_controller"),c=t("role_controller"),_=t("guild_const"),h=t("guild_event"),d=t("role_event"),u=cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("guild","guild_main_window"),this.win_type=WinType.Full,this.viewTag=SCENE_TAG.ui,this.rleasePrefab=!1,this.ctrl=n.getInstance(),this.model=this.ctrl.getModel(),this.role_vo=c.getInstance().getRoleVo(),this.gb_model=a.getInstance().getModel(),this.skill_model=o.getInstance().getModel(),this.redbag_model=l.getInstance().getModel(),this.gw_model=r.getInstance().getModel()},openCallBack:function(){var t=this.seekChild("main_container"),e=this.seekChild(t,"main_panel");this.main_view=this.seekChild(e,"container"),this.sign_btn=this.seekChild(this.main_view,"sign_btn",cc.Button),this.guild_sign_value=this.seekChild(this.main_view,"guild_sign_value",cc.Label),this.background=this.seekChild("background"),this.background.scale=FIT_SCALE,this.loadRes(s.getBigBg("bigbg_2"),function(t){this.background.getComponent(cc.Sprite).spriteFrame=t}.bind(this)),this.change_name_btn=this.seekChild(this.main_view,"change_name_btn",cc.Button),this.action_goal_btn=this.seekChild(this.main_view,"action_goal_btn",cc.Button),this.redpacket_btn=this.seekChild(this.main_view,"redpacket_btn",cc.Button),this.redpacket_btn.tips=this.seekChild(this.redpacket_btn.node,"tips"),this.donate_btn=this.seekChild(this.main_view,"donate_btn",cc.Button),this.donate_btn.tips=this.seekChild(this.donate_btn.node,"tips"),this.rank_btn=this.seekChild(this.main_view,"skill_btn",cc.Button),this.shop_container=this.seekChild(this.main_view,"shop_container"),this.shop_container.notice=this.seekChild(this.main_view,"guild_shop_notice",cc.Label),this.shop_container.tips=this.seekChild(this.shop_container,"tips"),this.shop_container.tips.active=!1,this.shop_container.is_unlock=!0,this.war_container=this.seekChild(this.main_view,"war_container"),this.war_container.notice=this.seekChild(this.main_view,"guild_war_notice",cc.Label),this.war_container.tips=this.seekChild(this.war_container,"tips"),this.war_container.is_unlock=!1,this.war_container.notice.node.active=!1,this.war_container.notice.string=Utils.TI18N("\u656c\u8bf7\u671f\u5f85"),this.dungeon_container=this.seekChild(this.main_view,"dungeon_container"),this.dungeon_container.notice=this.seekChild(this.main_view,"guild_dun_notice",cc.Label),this.dungeon_container.tips=this.seekChild(this.dungeon_container,"tips"),this.dungeon_container.is_unlock=!1,this.skill_container=this.seekChild(this.main_view,"voyage_container"),this.skill_container.notice=this.seekChild(this.main_view,"guild_voyage_notice",cc.Label),this.skill_container.tips=this.seekChild(this.skill_container,"tips"),this.skill_container.is_unlock=!1,this.check_member_btn=this.seekChild(this.main_view,"rank_btn",cc.Button),this.recruit_btn=this.seekChild(this.main_view,"recruit_btn",cc.Button),this.checkapply_btn=this.seekChild(this.main_view,"checkapply_btn",cc.Button),this.joinset_btn=this.seekChild(this.main_view,"joinset_btn",cc.Button),this.checkapply_btn.tips=this.seekChild(this.checkapply_btn.node,"tips"),this.guild_name_value=this.seekChild(this.main_view,"guild_name_value",cc.Label),this.guild_leader_value=this.seekChild(this.main_view,"guild_leader_value",cc.Label),this.guild_lev_value=this.seekChild(this.main_view,"guild_lev_value",cc.Label),this.guild_exp_value=this.seekChild(this.main_view,"guild_exp_value",cc.Label),this.guild_member_value=this.seekChild(this.main_view,"guild_member_value",cc.Label)},registerEvent:function(){this.sign_btn.node.on("click",function(){this.ctrl.openGuildChangeSignWindow(!0)},this),this.change_name_btn.node.on("click",function(){this.ctrl.openGuildChangeNameWindow(!0)},this),this.action_goal_btn.node.on("click",function(){t("mall_controller").getInstance().openMallPanel(!0,t("mall_const").MallType.UnionShop)},this),this.redpacket_btn.node.on("click",function(){l.getInstance().openMainView(!0)},this),this.donate_btn.node.on("click",function(){this.ctrl.openGuildDonateWindow(!0)},this),this.rank_btn.node.on("click",function(){t("rank_controller").getInstance().openRankView(!0,t("rank_constant").RankType.union)},this),this.shop_container.on("click",function(){if(null!=this.role_vo){var t=gdata("guild_quest_data","data_guild_action_data","open_glev").val;this.role_vo.guild_lev>=t?this.ctrl.openGuildActionGoalWindow(!0):message(cc.js.formatStr(Utils.TI18N("\u8054\u76df\u8fbe\u5230%d\u7ea7\u540e\u5f00\u542f"),t))}},this),this.war_container.on("click",function(){t("mainui_controller").getInstance().requestOpenBattleRelevanceWindow(t("battle_const").Fight_Type.GuildWar),this.gw_model.updateGuildWarRedStatus(_.red_index.guildwar_start,!1)},this),this.dungeon_container.on("click",function(){t("mainui_controller").getInstance().requestOpenBattleRelevanceWindow(t("battle_const").Fight_Type.GuildDun)},this),this.skill_container.on("click",function(){o.getInstance().openGuildSkillMainWindow(!0)},this),this.check_member_btn.node.on("click",function(){this.ctrl.openGuildMemberWindow(!0)},this),this.recruit_btn.node.on("click",function(){this.ctrl.requestGuildRecruit()},this),this.checkapply_btn.node.on("click",function(){this.ctrl.openGuildApplyWindow(!0)},this),this.joinset_btn.node.on("click",function(){this.ctrl.openGuildApplySetWindow(!0)},this),null!=this.role_vo&&null==this.role_assets_event&&(this.role_assets_event=this.role_vo.bind(EventId.UPDATE_ROLE_ATTRIBUTE,function(t,e){"position"==t&&this.updateJurisdiction()},this)),this.addGlobalEvent(h.UpdateGuildRedStatus,function(t,e){this.updateSomeRedStatus(t,e)},this),this.addGlobalEvent(d.OPEN_SRV_DAY,function(t,e){this.checkGuildWarStatus()},this)},openRootWnd:function(){null==this.my_guild_info&&(this.my_guild_info=this.model.getMyGuildInfo(),null!=this.my_guild_info&&this.addGlobalEvent(h.UpdateMyInfoEvent,function(t,e){"sign"==t?this.updateGuildSignInfo():"members_num"==t?this.updateGuildMemberInfo():"lev"==t||"exp"==t?this.updateGuildBaseInfo():"name"==t?this.updateGuildNameInfo():"leader_name"==t&&this.updateGuildLeaderInfo()},this),this.updateGuildNameInfo(),this.updateGuildSignInfo(),this.updateGuildBaseInfo(),this.updateGuildLeaderInfo(),this.updateGuildMemberInfo(),this.updateSomeRedStatus()),this.updateJurisdiction()},updateJurisdiction:function(){null!=this.role_vo&&(this.role_vo.position==_.post_type.member?(this.sign_btn.node.active=!1,this.change_name_btn.node.active=!1,Utils.setGreyButton(this.joinset_btn,!0),Utils.setGreyButton(this.recruit_btn,!0),Utils.setGreyButton(this.checkapply_btn,!0)):(this.sign_btn.node.active=!0,this.change_name_btn.node.active=!0,Utils.setGreyButton(this.joinset_btn,!1),Utils.setGreyButton(this.recruit_btn,!1),Utils.setGreyButton(this.checkapply_btn,!1)))},updateGuildSignInfo:function(){null!=this.my_guild_info&&(this.guild_sign_value.string=this.my_guild_info.sign)},updateGuildBaseInfo:function(){if(null!=this.my_guild_info){this.guild_lev_value.string=cc.js.formatStr("%s\u7ea7",this.my_guild_info.lev);var t=gdata("guild_data","data_guild_lev",[this.my_guild_info.lev]);null!=t&&(0==t.exp?this.guild_lev_value.string=Utils.TI18N("\u5df2\u6ee1\u7ea7"):this.guild_exp_value.string=cc.js.formatStr("%s/%s",this.my_guild_info.exp,t.exp)),this.guild_member_value.string=cc.js.formatStr("%s/%s",this.my_guild_info.members_num,this.my_guild_info.members_max),this.checkGuildDunLockStatus(),this.checkGuildWarStatus()}},updateGuildNameInfo:function(){null!=this.my_guild_info&&(this.guild_name_value.string=this.my_guild_info.name)},checkGuildDunLockStatus:function(){var t=!1;if(0==this.dungeon_container.is_unlock){var e=gdata("guild_dun_data","data_const","guild_lev");e&&(t=this.my_guild_info&&this.my_guild_info.lev>=e.val,this.dungeon_container.is_unlock=t,this.dungeon_container.notice.node.active=!t,Utils.setGreyButton(this.dungeon_container.getComponent(cc.Button),!t),0==t&&(this.dungeon_container.notice.string=e.desc))}},checkGuildWarStatus:function(){var t=!1;if(0==this.war_container.is_unlock){var e=gdata("guild_war_data","data_const","limit_lev"),i=gdata("guild_war_data","data_const","limit_open_time");if(e&&i){var s="";if(1==(t=this.my_guild_info&&this.my_guild_info.lev>=e.val))t=c.getInstance().getModel().getOpenSrvDay()>i.val,s=i.desc;else s=e.desc;0==IS_SHOW_CHARGE&&(t=!1,s=Utils.TI18N("\u656c\u8bf7\u671f\u5f85!")),this.war_container.is_unlock=t,this.war_container.notice.node.active=!t,Utils.setGreyButton(this.war_container.getComponent(cc.Button),!t),0==t&&(this.war_container.notice.string=s)}}},updateGuildLeaderInfo:function(){null!=this.my_guild_info&&(this.guild_leader_value.string=this.my_guild_info.leader_name)},updateGuildMemberInfo:function(){null!=this.my_guild_info&&(this.guild_member_value.string=cc.js.formatStr("%s/%s",this.my_guild_info.members_num,this.my_guild_info.members_max))},updateSomeRedStatus:function(t,e){var i=!1;t==_.red_index.apply?this.checkapply_btn.tips.active=e:t==_.red_index.boss_times?(i=this.gb_model.checkGuildDunRedStatus(),this.dungeon_container.tips.active=i):t==_.red_index.donate||t==_.red_index.donate_activity?(i=this.model.getDonateRedStatus(),this.donate_btn.tips.active=i):t==_.red_index.skill_2||t==_.red_index.skill_3||t==_.red_index.skill_4||t==_.red_index.skill_5?this.skill_container.tips.active=this.skill_model.getRedTotalStatus():t==_.red_index.red_bag?this.redpacket_btn.tips.active=e:t==_.red_index.goal_action?this.shop_container.tips.active=e:t==_.red_index.guildwar_start||t==_.red_index.guildwar_match||t==_.red_index.guildwar_count?this.war_container.tips.active=this.gw_model.checkGuildGuildWarRedStatus():(this.checkapply_btn.tips.active=this.model.getRedStatus(_.red_index.apply),this.donate_btn.tips.active=this.model.getDonateRedStatus(),this.dungeon_container.tips.active=this.gb_model.checkGuildDunRedStatus(),this.war_container.tips.active=this.gw_model.checkGuildGuildWarRedStatus(),this.skill_container.tips.active=this.skill_model.getRedTotalStatus(),this.redpacket_btn.tips.active=this.redbag_model.getAllRedBagStatus(),this.shop_container.tips.active=this.model.getGoalRedStatus())},closeCallBack:function(){null!=this.role_vo&&(null!=this.role_assets_event&&(this.role_vo.unbind(this.role_assets_event),this.role_assets_event=null),this.role_vo=null),this.ctrl.openGuildMainWindow(!1)}});e.exports=u,cc._RF.pop()},{battle_const:"battle_const",guild_const:"guild_const",guild_controller:"guild_controller",guild_event:"guild_event",guildboss_controller:"guildboss_controller",guildskill_controller:"guildskill_controller",guildwar_controller:"guildwar_controller",mainui_controller:"mainui_controller",mall_const:"mall_const",mall_controller:"mall_controller",pathtool:"pathtool",rank_constant:"rank_constant",rank_controller:"rank_controller",redbag_controller:"redbag_controller",role_controller:"role_controller",role_event:"role_event"}],guild_member_item:[function(t,e,i){"use strict";cc._RF.push(e,"8c7a4ozZjhGa7XwxBfj3IeV","guild_member_item");var s=t("pathtool"),n=t("guild_controller"),a=t("playerhead"),o=t("role_controller"),l=t("guild_const"),r=t("guild_event"),c=cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("guild","guild_member_item"),this.ctrl=n.getInstance()},initPanel:function(){var e=this.seekChild("container");this.container_img=this.seekChild("container",cc.Sprite),this.set_post_btn=this.seekChild("set_post_btn"),this.role_online=this.seekChild("role_online",cc.Label),this.role_name=this.seekChild("role_name",cc.Label),this.role_position=this.seekChild("role_position",cc.Label),this.role_donate=this.seekChild("role_donate",cc.Label),this.role_day_donate=this.seekChild("role_day_donate",cc.Label),this.role_action=this.seekChild("role_action",cc.Label),this.role_head=new a,this.role_head.setParent(e),this.role_head.show(),this.role_head.setLev(99),this.role_head.setPosition(-230,0),this.role_head.addCallBack(function(){null!=this.data&&(1==this.data.is_self?message(Utils.TI18N("\u600e\u4e48\uff1f\u81ea\u5df1\u90fd\u4e0d\u8ba4\u8bc6\u4e86\uff1f")):t("friend_controller").getInstance().openFriendCheckPanel(!0,{srv_id:this.data.srv_id,rid:this.data.rid}))}.bind(this))},registerEvent:function(){this.set_post_btn.on(cc.Node.EventType.TOUCH_END,function(){if(null!=this.data){var t=o.getInstance().getRoleVo();1==t.position?this.data.post!=l.post_type.leader&&this.ctrl.openGuildOperationPostWindow(!0,this.data):2==t.position?this.data.post==l.post_type.member?this.ctrl.openGuildOperationPostWindow(!0,this.data):this.data.post==l.post_type.leader&&this.ctrl.openGuildImpeachPostWindow(!0):3==t.position&&this.data.post==l.post_type.leader&&this.ctrl.openGuildImpeachPostWindow(!0)}},this),this.addGlobalEvent(r.UpdateMyMemberItemEvent,function(t,e){"post"!=t&&"role_post"!=t||(this.setPostInfo(),this.updateBtnStatusByRolePost())},this)},setData:function(t){this.data=t,this.root_wnd&&this.onShow()},onShow:function(){if(null!=this.data){var t=this.data;this.set_post_btn.active=!0,this.setBaseData(),this.setOnLineStatus(),this.updateBtnStatusByRolePost(),1==t.is_self?this.loadRes(s.getCommonIcomPath("common_1020"),function(t){this.container_img.spriteFrame=t}.bind(this)):this.loadRes(s.getCommonIcomPath("common_1029"),function(t){this.container_img.spriteFrame=t}.bind(this))}},setBaseData:function(){if(null!=this.data){var t=this.data;this.role_name.string=t.name,this.role_head.setHeadRes(t.face),this.role_head.setLev(t.lev),this.role_donate.string=cc.js.formatStr(Utils.TI18N("\u8d21\u732e\uff1a%s"),t.donate),this.role_day_donate.string=cc.js.formatStr(Utils.TI18N("\u4eca\u65e5\u8d21\u732e\uff1a%s"),t.day_donate),this.role_action.string=cc.js.formatStr(Utils.TI18N("\u6d3b\u8dc3\u7b49\u7ea7\uff1a%s"),t.active_lev),this.setPostInfo()}},updateBtnStatusByRolePost:function(){if(null!=this.data){var t=Config.guild_data.data_const.impeach_offline_day.val,e=o.getInstance().getRoleVo();if(1==e.position)this.data.post==l.post_type.leader?this.set_post_btn.active=!1:this.set_post_btn.active=!0;else if(2==e.position){if(e.position==this.data.post&&(this.set_post_btn.active=!1),this.data.post==l.post_type.leader){var i=gcore.SmartSocket.getTime()-this.data.login_time;this.set_post_btn.active=i>=86400*t}}else if(3==e.position)if(this.data.post==l.post_type.leader){i=gcore.SmartSocket.getTime()-this.data.login_time;this.set_post_btn.active=i>=86400*t}else this.set_post_btn.active=!1}},setOnLineStatus:function(){if(null!=this.data)if(0==this.data.online){this.role_online.node.color=new cc.Color(217,80,20,255);var t=gcore.SmartSocket.getTime()-this.data.login_time;this.role_online.string=t<=60?Utils.TI18N("\u521a\u521a"):t>60&&t<=3600?cc.js.formatStr(Utils.TI18N("%s\u5206\u949f\u524d"),Math.floor(t/60)):t>3600&&t<=86400?cc.js.formatStr(Utils.TI18N("%s\u5c0f\u65f6\u524d"),Math.floor(t/3600)):t>86400&&t<=604800?cc.js.formatStr(Utils.TI18N("%s\u5929\u524d"),Math.floor(t/86400)):Utils.TI18N("7\u5929\u524d")}else this.role_online.node.color=new cc.Color(51,150,13,255),this.role_online.string=Utils.TI18N("\u5728\u7ebf")},setPostInfo:function(){if(null!=this.data){var t=Config.guild_data.data_position[this.data.post];null!=t&&(this.data.post==l.post_type.member?this.role_position.node.color=new cc.Color(104,69,42,255):this.role_position.node.color=new cc.Color(168,56,188,255),this.role_position.string=t.name)}},suspendAllActions:function(){},onDelete:function(){this.role_head&&this.role_head.deleteMe(),this.role_head=null}});e.exports=c,cc._RF.pop()},{friend_controller:"friend_controller",guild_const:"guild_const",guild_controller:"guild_controller",guild_event:"guild_event",pathtool:"pathtool",playerhead:"playerhead",role_controller:"role_controller"}],guild_member_vo:[function(t,e,i){"use strict";cc._RF.push(e,"10943t70QtNjKm6P4hPl6rb","guild_member_vo");var s=t("guild_event"),n=t("guild_const"),a=cc.Class({extends:gcore.BaseEvent,ctor:function(){this.initData()},initData:function(){this.rid=0,this.srv_id="",this.name="",this.lev=0,this.face=0,this.post=0,this.online=0,this.vip_lev=0,this.power=0,this.join_time=0,this.login_time=0,this.donate=0,this.day_donate=0,this.avatar_bid=0,this.sex=0,this.active_lev=0,this.is_self=!1,this.role_post=n.post_type.member},updateData:function(t){for(var e in t)null!=this[e]&&this.setGuildAttribute(e,t[e])},setGuildAttribute:function(t,e){this[t]!=e&&(this[t]=e,this.dispatchUpdateAttrByKey(t,e)),"post"==t&&(this.post_sort=99-e)},dispatchUpdateAttrByKey:function(t,e){gcore.GlobalEvent.fire(s.UpdateMyMemberItemEvent,t,e)},_delete:function(){}});e.exports=a,cc._RF.pop()},{guild_const:"guild_const",guild_event:"guild_event"}],guild_member_window:[function(t,e,i){"use strict";cc._RF.push(e,"7e353/c4UtDaKl95vKK/Jf8","guild_member_window");var s=t("pathtool"),n=t("guild_controller"),a=t("guild_const"),o=t("common_scrollview"),l=t("role_controller"),r=t("guild_member_item"),c=t("guild_event"),_=(t("role_event"),cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("guild","guild_member_window"),this.win_type=WinType.Mini,this.viewTag=SCENE_TAG.dialogue,this.ctrl=n.getInstance(),this.model=this.ctrl.getModel(),this.my_guild_info=this.model.getMyGuildInfo(),this.role_vo=l.getInstance().getRoleVo()},openCallBack:function(){this.background=this.seekChild("background"),this.background.scale=FIT_SCALE,this.main_panel=this.seekChild("main_panel"),this.scroll_container=this.seekChild("scroll_container"),this.desc=this.seekChild(this.main_panel,"desc",cc.Label),this.close_btn=this.seekChild("close_btn"),this.exit_btn=this.seekChild(this.main_panel,"exit_btn"),this.exit_btn_label=this.seekChild(this.exit_btn,"label",cc.Label),this.explain_btn=this.seekChild(this.main_panel,"explain_btn"),this.extend_container=this.seekChild(this.main_panel,"extend_container")},registerEvent:function(){Utils.onTouchEnd(this.background,function(){this.ctrl.openGuildMemberWindow(!1)}.bind(this),2),Utils.onTouchEnd(this.close_btn,function(){this.ctrl.openGuildMemberWindow(!1)}.bind(this),2),this.exit_btn.on(cc.Node.EventType.TOUCH_END,function(){this.ctrl.requestExitGuild()},this),this.explain_btn.on(cc.Node.EventType.TOUCH_END,function(e){var i=e.touch.getLocation(),s=Config.guild_data.data_const.game_rule;s&&t("tips_controller").getInstance().showCommonTips(StringUtil.parse(s.desc),i,null,null,500)},this),this.addGlobalEvent(c.UpdateMyInfoEvent,function(t,e){"members_num"!=t&&"members_max"!=t||this.updateMemberNum()},this),this.addGlobalEvent(c.UpdateMyMemberListEvent,function(t){0!=t&&this.updateMemberList(t)},this),this.addGlobalEvent(c.UpdateAssistantNumEvent,function(){null!=this.role_vo&&this.role_vo.position!=a.post_type.member&&this.updateMemberNum()},this),null!=this.role_vo&&null==this.role_assets_event&&(this.role_assets_event=this.role_vo.bind(EventId.UPDATE_ROLE_ATTRIBUTE,function(t,e){"gid"==t?0==e&&this.ctrl.openGuildMemberWindow(!1):"position"==t&&this.updateExitStatus()},this))},openRootWnd:function(){this.ctrl.requestGuildMemberList(),this.updateMemberNum(),this.updateExitStatus()},updateExitStatus:function(){null!=this.role_vo&&(this.role_vo.position==a.post_type.leader?this.exit_btn_label.string=Utils.TI18N("\u89e3\u6563\u516c\u4f1a"):this.exit_btn_label.string=Utils.TI18N("\u9000\u51fa\u516c\u4f1a"),this.extend_container.active=this.role_vo.position!=a.post_type.member)},updateMemberNum:function(){if(null!=this.my_guild_info&&null!=this.role_vo)if(this.role_vo.position==a.post_type.member)this.desc.string=cc.js.formatStr("\u4eba\u6570\uff1a%s/%s",this.my_guild_info.members_num,this.my_guild_info.members_max);else{var t=Config.guild_data.data_post[Utils.getNorKey(a.post_type.assistant,this.my_guild_info.lev)];if(null!=t){var e=this.model.getAssistantSum();this.desc.string=cc.js.formatStr("%s%s/%s   %s%s/%s",Utils.TI18N("\u4eba\u6570\uff1a"),this.my_guild_info.members_num,this.my_guild_info.members_max,Utils.TI18N("\u526f\u4f1a\u957f\uff1a"),e,t.num)}}},updateMemberList:function(t){var e=this.model.getGuildMemberList();if(null!=e&&null!=Utils.next(e)){if(null==this.scroll_view){var i=this.scroll_container.getContentSize(),s=cc.size(i.width,i.height-10),n={item_class:r,start_x:4,space_x:0,start_y:0,space_y:0,item_width:600,item_height:135,row:0,col:1,need_dynamic:!0};this.scroll_view=new o,this.scroll_view.createScroll(this.scroll_container,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,s,n,cc.v2(.5,.5))}e.sort(Utils.tableLowerSorter(["_index"])),this.scroll_view&&this.scroll_view.setData(e)}},closeCallBack:function(){this.ctrl.openGuildMemberWindow(!1),null!=this.role_vo&&null!=this.role_assets_event&&(this.role_vo.unbind(this.role_assets_event),this.role_assets_event=null),this.scroll_view&&(this.scroll_view.deleteMe(),this.scroll_view=null)}}));e.exports=_,cc._RF.pop()},{common_scrollview:"common_scrollview",guild_const:"guild_const",guild_controller:"guild_controller",guild_event:"guild_event",guild_member_item:"guild_member_item",pathtool:"pathtool",role_controller:"role_controller",role_event:"role_event",tips_controller:"tips_controller"}],guild_model:[function(t,e,i){"use strict";cc._RF.push(e,"e3e73qrgAxPZb0kkCHS45i4","guild_model");var s=t("guild_list_vo"),n=t("guild_const"),a=t("guild_event"),o=t("guild_my_info_vo"),l=t("role_controller"),r=t("guild_member_vo"),c=t("mainui_controller"),_=t("mainui_const");cc.Class({extends:BaseClass,ctor:function(){var e=t("guild_controller");this.ctrl=e.getInstance(),this.guild_cache_list={},this.guild_apply_list={},this.donate_sum=0,this.guild_member_list={},this.guild_list=[],this.guild_search_list=[],this.my_guild_assistant={},this.guild_red_status_list={},this.guild_donate_activity_list=[]},properties:{},initConfig:function(){},updateGuildList:function(t,e){if(""==t)for(var i in this.guild_list=[],e){var o=e[i];null==(l=this.guild_cache_list[Utils.getNorKey(o.gid,o.gsrv_id)])&&(l=new s,this.guild_cache_list[Utils.getNorKey(o.gid,o.gsrv_id)]=l),l.updateData(o),this.guild_list.push(l)}else for(var i in this.guild_search_list=[],e){var l;o=e[i];null==(l=this.guild_cache_list[Utils.getNorKey(o.gid,o.gsrv_id)])&&(l=new s,this.guild_cache_list[Utils.getNorKey(o.gid,o.gsrv_id)]=l),l.updateData(o),this.guild_search_list.push(l)}var r=n.list_type.total,c=this.guild_list;""!=t&&(r=n.list_type.search,c=this.guild_search_list),gcore.GlobalEvent.fire(a.UpdateGuildList,r,c)},updateGuildApplyStatus:function(t,e,i){var s=this.guild_cache_list[Utils.getNorKey(t,e)];null!=s&&s.setGuildAttribute("is_apply",i)},updateMyGuildInfo:function(t){null==this.my_guild_info&&(this.my_guild_info=new o),this.my_guild_info.updateData(t)},clearMyGuildInfo:function(){this.my_guild_info=null,this.guild_red_status_list={},this.my_guild_assistant={},this.guild_member_list={},this.guild_donate_activity_list=[],c.getInstance().setBtnRedPoint(_.btn_index.guild)},getMyGuildInfo:function(){return this.my_guild_info},updateMyGuildMemberList:function(t,e){var i=l.getInstance().getRoleVo();if(null!=i){if(2==e)for(var s in t){var o=t[s];this.guild_member_list[Utils.getNorKey(o.rid,o.srv_id)]=null,null!=this.my_guild_assistant[Utils.getNorKey(o.rid,o.srv_id)]&&(this.my_guild_assistant[Utils.getNorKey(o.rid,o.srv_id)]=null,i.position!=n.post_type.member&&gcore.GlobalEvent.fire(a.UpdateAssistantNumEvent))}else{var c=null;for(var s in t){o=t[s];c=this.guild_member_list[Utils.getNorKey(o.rid,o.srv_id)],null!=this.my_guild_assistant[Utils.getNorKey(o.rid,o.srv_id)]?o.post!=n.post_type.assistant&&(this.my_guild_assistant[Utils.getNorKey(o.rid,o.srv_id)]=null,i.position!=n.post_type.member&&gcore.GlobalEvent.fire(a.UpdateAssistantNumEvent)):o.post==n.post_type.assistant&&(this.my_guild_assistant[Utils.getNorKey(o.rid,o.srv_id)]=o,i.position!=n.post_type.member&&gcore.GlobalEvent.fire(a.UpdateAssistantNumEvent)),null==c&&(c=new r,this.guild_member_list[Utils.getNorKey(o.rid,o.srv_id)]=c),null==o.is_self&&(o.is_self=l.getInstance().checkIsSelf(o.srv_id,o.rid)),o.role_post=i.position,c.updateData(o)}}gcore.GlobalEvent.fire(a.UpdateMyMemberListEvent,e)}},updateMemberByPosition:function(t){if(null!=this.guild_member_list)for(var e in this.guild_member_list)this.guild_member_list[e].setGuildAttribute("role_post",t)},getAssistantSum:function(){if(null!=this.my_guild_assistant){var t=0;for(var e in this.my_guild_assistant)null!=this.my_guild_assistant[e]&&(t+=1);return t}},getGuildMemberList:function(){var t=[];for(var e in this.guild_member_list)null!=this.guild_member_list[e]&&t.push(this.guild_member_list[e]);return t.length>0&&t.sort(Utils.tableUpperSorter(["online","post_sort","donate"])),t},updateDonateInfo:function(t){if(null!=t){for(var e in this.donate_sum=0,this.donate_list=[],t){var i=t[e];this.donate_list[i.type]=i.num,this.donate_sum=this.donate_sum+i.num}gcore.GlobalEvent.fire(a.UpdateDonateInfo),this.updateGuildRedStatus(n.red_index.donate,this.donate_sum<=0)}},setGuildDonateStatus:function(){this.donate_sum=this.donate_sum+1,this.updateGuildRedStatus(n.red_index.donate,!1)},checkDonateStatus:function(t){var e=this.donate_list[t];return[this.donate_sum>0,e&&e>0]},updateGuildApplyList:function(t){for(var e in this.guild_apply_list={},t){var i=t[e];this.guild_apply_list[Utils.getNorKey(i.rid,i.srv_id)]=i}gcore.GlobalEvent.fire(a.UpdateApplyListInfo),this.clearApplyRedStatus()},deleteApplyInfo:function(t,e){null!=this.guild_apply_list[Utils.getNorKey(t,e)]&&(this.guild_apply_list[Utils.getNorKey(t,e)]=null,gcore.GlobalEvent.fire(a.UpdateApplyListInfo),this.clearApplyRedStatus())},clearApplyRedStatus:function(){0==Utils.getArrTrueLen(this.guild_apply_list)&&this.updateGuildRedStatus(n.red_index.apply,!1)},getGuildApplyList:function(){var t=[];for(var e in this.guild_apply_list)null!=this.guild_apply_list[e]&&t.push(this.guild_apply_list[e]);return t.length>0&&t.sort(Utils.tableUpperSorter(["is_online","power","vip_lev"])),t},updateGuildRedStatus:function(t,e){var i=Config.function_data.data_base;0!=c.getInstance().checkIsOpenByActivate(i[6].activate)&&(this.guild_red_status_list[t]!=e&&(this.guild_red_status_list[t]=e,c.getInstance().setBtnRedPoint(_.btn_index.guild,{bid:t,status:e}),gcore.GlobalEvent.fire(a.UpdateGuildRedStatus,t,e)))},updataGuildActionRedStatus:function(t){RedMgr.getInstance().addCalHandler(function(){this.goal_data=t;var e=!1,i=Config.guild_quest_data.data_lev_data,s=Config.guild_quest_data.data_lev_data_length;t.lev<s&&t.exp>=i[t.lev].exp&&(e=!0),c.getInstance().setBtnRedPoint(_.btn_index.guild,{bid:n.red_index.goal_action,status:e}),gcore.GlobalEvent.fire(a.UpdateGuildRedStatus,n.red_index.goal_action,e)}.bind(this),RedIds.GuildActive)},getGoalRedStatus:function(){if(null==this.goal_data||!Utils.next(this.goal_data))return!1;var t=!1,e=Config.guild_quest_data.data_lev_data;return this.goal_data.lev<Config.guild_quest_data.data_lev_data_length&&this.goal_data.exp>=e[this.goal_data.lev].exp&&(t=!0),t},getRedStatus:function(t){return this.guild_red_status_list[t]},getDonateRedStatus:function(){var t=this.getRedStatus(n.red_index.donate);return 1==t?t:t=this.getRedStatus(n.red_index.donate_activity)},updateDonateBoxInfo:function(t,e){for(var i in this.guild_donate_activity_list={},this.guild_donate_activity=e,t)this.guild_donate_activity_list[t[i].box_id]=!0;this.checkDonateActivity()},setDonateBoxStatus:function(t){null==this.guild_donate_activity_list&&(this.guild_donate_activity_list={}),this.guild_donate_activity_list[t]=!0,gcore.GlobalEvent.fire(a.UpdateDonateBoxStatus,t),this.checkDonateActivity()},updateDonateActivity:function(t){this.guild_donate_activity=t,gcore.GlobalEvent.fire(a.UpdateDonateBoxStatus),this.checkDonateActivity()},checkDonateActivity:function(){RedMgr.getInstance().addCalHandler(function(){var t=this.guild_donate_activity||0,e=!1;for(var i in Config.guild_data.data_donate_box){if(t>=Config.guild_data.data_donate_box[i].box_val&&!this.guild_donate_activity_list[i]){e=!0;break}}this.updateGuildRedStatus(n.red_index.donate_activity,e)}.bind(this),RedIds.GuildDonate)},getDonateActivityValue:function(){return this.guild_donate_activity||0},getDonateBoxStatus:function(t){return this.guild_donate_activity_list[t]}});cc._RF.pop()},{guild_const:"guild_const",guild_controller:"guild_controller",guild_event:"guild_event",guild_list_vo:"guild_list_vo",guild_member_vo:"guild_member_vo",guild_my_info_vo:"guild_my_info_vo",mainui_const:"mainui_const",mainui_controller:"mainui_controller",role_controller:"role_controller"}],guild_my_info_vo:[function(t,e,i){"use strict";cc._RF.push(e,"4e710kYa5hFpoWaoxaDHwbZ","guild_my_info_vo");var s=t("guild_event"),n=cc.Class({extends:gcore.BaseEvent,ctor:function(){this.initData()},initData:function(){this.gid=0,this.gsrv_id="",this.name="",this.lev=0,this.members_num=0,this.members_max=0,this.leader_name=0,this.rid=0,this.srv_id="",this.sign="",this.exp=0,this.day_exp=0,this.apply_type=0,this.apply_lev=0,this.recruit_num=0,this.rank_idx=0},updateData:function(t){for(var e in t)null!=this[e]&&this.setGuildAttribute(e,t[e])},setGuildAttribute:function(t,e){this[t]!=e&&(this[t]=e,this.dispatchUpdateAttrByKey(t,e))},dispatchUpdateAttrByKey:function(t,e){gcore.GlobalEvent.fire(s.UpdateMyInfoEvent,t,e)},_delete:function(){}});e.exports=n,cc._RF.pop()},{guild_event:"guild_event"}],guild_operation_post_window:[function(t,e,i){"use strict";cc._RF.push(e,"24dcaikkoBNkq4PBIbHMXFT","guild_operation_post_window");var s=t("pathtool"),n=t("guild_controller"),a=t("guild_const"),o=cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("guild","guild_operation_post_window"),this.win_type=WinType.Mini,this.viewTag=SCENE_TAG.dialogue,this.ctrl=n.getInstance()},openCallBack:function(){this.background=this.seekChild("background"),this.background.scale=FIT_SCALE,this.notcie=this.seekChild("notice",cc.Label),this.close_btn=this.seekChild("close_btn"),this.setmember_btn=this.seekChild("setmember_btn"),this.setmember_btn_label=this.seekChild(this.setmember_btn,"label",cc.Label),this.kickout_btn=this.seekChild("kickout_btn"),this.setleader_btn=this.seekChild("setleader_btn"),this.center_y=this.setmember_btn.y},registerEvent:function(){this.background.on(cc.Node.EventType.TOUCH_END,function(){this.ctrl.openGuildOperationPostWindow(!1)},this),this.close_btn.on(cc.Node.EventType.TOUCH_END,function(){this.ctrl.openGuildOperationPostWindow(!1)},this),this.setleader_btn.on(cc.Node.EventType.TOUCH_END,function(){null!=this.data&&this.ctrl.requestOperationPost(this.data.rid,this.data.srv_id,a.post_type.leader)},this),this.setmember_btn.on(cc.Node.EventType.TOUCH_END,function(t){var e=t.currentTarget;null!=e.index&&null!=this.data&&this.ctrl.requestOperationPost(this.data.rid,this.data.srv_id,e.index)},this),this.kickout_btn.on(cc.Node.EventType.TOUCH_END,function(){null!=this.data&&this.ctrl.requestKickoutMember(this.data.rid,this.data.srv_id,this.data.name)},this)},openRootWnd:function(t){null!=t&&(this.data=t,this.notcie.string=cc.js.formatStr("\u4f60\u8981\u5bf9\u3010%s\u3011\u73a9\u5bb6\u6267\u884c\u7684\u64cd\u4f5c\u662f",t.name),t.role_post==a.post_type.leader?t.post==a.post_type.assistant?(this.setmember_btn_label.string=Utils.TI18N("\u7f62\u514d\u526f\u4f1a\u957f"),this.setmember_btn.index=a.post_type.member):(this.setmember_btn.index=a.post_type.assistant,this.setmember_btn_label.string=Utils.TI18N("\u4efb\u547d\u526f\u4f1a\u957f")):t.role_post==a.post_type.assistant&&(t.post==a.post_type.member?(this.kickout_btn.y=this.center_y,this.setleader_btn.active=!1,this.setmember_btn.active=!1):(this.kickout_btn.active=!1,this.setleader_btn.active=!1,this.setmember_btn.active=!1)))},closeCallBack:function(){this.ctrl.openGuildOperationPostWindow(!1)}});e.exports=o,cc._RF.pop()},{guild_const:"guild_const",guild_controller:"guild_controller",pathtool:"pathtool"}],guild_request_item:[function(t,e,i){"use strict";cc._RF.push(e,"28768LXZHpApLF6kxPhdpIv","guild_request_item");var s=t("pathtool"),n=t("guild_controller"),a=t("guild_event"),o=t("role_controller"),l=cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("guild","guild_list_item"),this.ctrl=n.getInstance(),this.data=null},initPanel:function(){var t=this.seekChild("container");this.request_btn=this.seekChild(t,"request_btn",cc.Button),this.request_btn_label=this.seekChild(this.request_btn.node,"label",cc.Label),this.request_btn_lo=this.seekChild(this.request_btn.node,"label",cc.LabelOutline),this.request_btn_label.string=Utils.TI18N("\u7533\u8bf7\u52a0\u5165"),this.request_btn_img=this.seekChild(t,"request_btn",cc.Sprite),this.condition_desc=this.seekChild(t,"condition_desc",cc.Label),this.guild_name=this.seekChild("guild_name",cc.Label),this.guild_lev=this.seekChild("guild_lev",cc.Label),this.leader_value=this.seekChild("leader_value",cc.Label),this.member_value=this.seekChild("member_value",cc.Label),this.btn_res_id=s.getCommonIcomPath("common_1018")},registerEvent:function(){this.request_btn.node.on(cc.Node.EventType.TOUCH_END,function(){0!=this.request_btn.interactable&&null!=this.data&&(1==this.data.is_apply?this.ctrl.requestJoinGuild(this.data.gid,this.data.gsrv_id,2):this.ctrl.requestJoinGuild(this.data.gid,this.data.gsrv_id,1))},this)},setData:function(t){null!=this.data&&null!=this.update_self_event&&(this.data.unbind(this.update_self_event),this.update_self_event=null),this.data=t,this.root_wnd&&this.onShow()},onShow:function(){if(null!=this.data){var t=this.data;null==this.update_self_event&&(this.update_self_event=this.data.bind(a.UpdateGuildItemEvent,function(t,e){"is_apply"==t&&this.setApplyStatus()},this)),this.guild_name.string=t.name,this.guild_lev.string=cc.js.formatStr(Utils.TI18N("(%s\u7ea7)"),t.lev),this.leader_value.string=cc.js.formatStr(Utils.TI18N("\u4f1a\u957f\uff1a%s"),t.leader_name),this.member_value.string=cc.js.formatStr(Utils.TI18N("%s/%s"),t.members_num,t.members_max),t.members_num>=t.members_max?this.member_value.node.color=new cc.Color(217,80,20,255):this.member_value.node.color=new cc.Color(36,144,3,255),this.guild_lev.x=this.guild_name.node.x+this.guild_name.node.getContentSize().width+5,this.setApplyStatus()}},setApplyStatus:function(){if(null!=this.data){var t=o.getInstance().getRoleVo();if(null!=t){var e=this.data,i=217,n=80,a=20,l=255,r=104,c=69,_=42,h=255;1==e.is_apply?(this.request_btn_label.string=Utils.TI18N("\u53d6\u6d88\u7533\u8bf7"),this.loadRes(s.getCommonIcomPath("common_1017"),function(t){this.request_btn_img.spriteFrame=t}.bind(this)),this.request_btn_lo.color=new cc.Color(108,43,0,255),2==e.apply_type?(Utils.setGreyButton(this.request_btn,!0),this.condition_desc.node.color=new cc.Color(i,n,a,l),this.condition_desc.string=Utils.TI18N("\u516c\u4f1a\u4e0d\u5141\u8bb8\u52a0\u5165")):(e.apply_lev>t.lev?(Utils.setGreyButton(this.request_btn,!0),this.condition_desc.node.color=new cc.Color(i,n,a,l)):(Utils.setGreyButton(this.request_btn,!1),this.condition_desc.node.color=new cc.Color(r,c,_,h)),1==e.apply_lev?this.condition_desc.string=Utils.TI18N("\u65e0\u7b49\u7ea7\u9700\u6c42"):this.condition_desc.string=cc.js.formatStr("\u9700\u8981\u8fbe\u5230%s\u7ea7",e.apply_lev))):(this.loadRes(s.getCommonIcomPath("common_1018"),function(t){this.request_btn_img.spriteFrame=t}.bind(this)),2==e.apply_type?(Utils.setGreyButton(this.request_btn,!0),this.request_btn_label.string=Utils.TI18N("\u6761\u4ef6\u4e0d\u8db3"),this.request_btn_lo.enabled=!1,this.condition_desc.node.color=new cc.Color(i,n,a,l),this.condition_desc.string=Utils.TI18N("\u516c\u4f1a\u4e0d\u5141\u8bb8\u52a0\u5165")):(e.apply_lev>t.lev?(Utils.setGreyButton(this.request_btn,!0),this.request_btn_lo.enabled=!1,this.request_btn_label.string=Utils.TI18N("\u6761\u4ef6\u4e0d\u8db3"),this.condition_desc.node.color=new cc.Color(i,n,a,l)):(Utils.setGreyButton(this.request_btn,!1),this.request_btn_label.string=Utils.TI18N("\u7533\u8bf7\u52a0\u5165"),this.request_btn_lo.color=new cc.Color(43,97,13,255),this.request_btn_lo.enabled=!0,this.condition_desc.node.color=new cc.Color(r,c,_,h)),1==e.apply_lev?this.condition_desc.string=Utils.TI18N("\u65e0\u7b49\u7ea7\u9700\u6c42"):this.condition_desc.string=cc.js.formatStr("\u9700\u8981\u8fbe\u5230%s\u7ea7",e.apply_lev)))}}},suspendAllActions:function(){null!=this.data&&(null!=this.update_self_event&&(this.data.unbind(this.update_self_event),this.update_self_event=null),this.data=null)},onDelete:function(){this.suspendAllActions()}});e.exports=l,cc._RF.pop()},{guild_controller:"guild_controller",guild_event:"guild_event",pathtool:"pathtool",role_controller:"role_controller"}],guild_reward_item:[function(t,e,i){"use strict";cc._RF.push(e,"122582xcihMWa884hN00wlv","guild_reward_item");var s=t("pathtool"),n=t("guild_controller"),a=cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("guild","guild_reward_item"),this.ctrl=n.getInstance(),this.data=null,this.item_list={}},initPanel:function(){this.container=this.seekChild("container"),this.desc_label=this.seekChild("desc_label",cc.RichText)},registerEvent:function(){},setData:function(t){this.data=t,this.root_wnd&&this.onShow()},onShow:function(){if(null!=this.data){var t=this.data,e=cc.js.formatStr(Utils.TI18N("\u6d3b\u8dc3\u5230\u8fbe <color=#249003>%d</c> \u7ea7\u9886\u53d6"),t.lev);for(var i in this.desc_label.string=e,this.item_list)this.item_list[i].setVisible(!1);for(i=0;i<t.items.length;i++){var s=t.items[i];if(!this.item_list[i]){var n=ItemsPool.getInstance().getItem("backpack_item");n.initConfig(!1,.8,!1,!1),n.show(),n.setPosition(110*i+70,62),n.setParent(this.container),this.item_list[i]=n}(n=this.item_list[i])&&(n.setVisible(!0),n.setData({bid:s[0],num:s[1]}))}}},onDelete:function(){if(this.item_list){for(var t in this.item_list){var e=this.item_list[t];e.deleteMe(),e=null}this.item_list=null}}});e.exports=a,cc._RF.pop()},{guild_controller:"guild_controller",pathtool:"pathtool"}],guild_reward_window:[function(t,e,i){"use strict";cc._RF.push(e,"4d6ddVhgN1OvahXwVtbTIe4","guild_reward_window");var s=t("pathtool"),n=t("guild_controller"),a=t("guild_reward_item"),o=t("common_scrollview"),l=cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("guild","guild_reward_window"),this.win_type=WinType.Mini,this.viewTag=SCENE_TAG.dialogue,this.ctrl=n.getInstance()},openCallBack:function(){this.background=this.seekChild("background"),this.background.scale=FIT_SCALE,this.main_container=this.seekChild("main_container");var t=this.seekChild(this.main_container,"main_panel");this.close_btn=this.seekChild("close_btn");var e=this.seekChild(t,"container"),i=e.getContentSize(),s=cc.size(i.width,i.height-10),n={item_class:a,start_x:10,space_x:0,start_y:0,space_y:0,item_width:599,item_height:159,row:0,col:1,need_dynamic:!0};this.scroll_view=new o,this.scroll_view.createScroll(e,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,s,n,cc.v2(.5,.5))},registerEvent:function(){this.background.on(cc.Node.EventType.TOUCH_END,function(){this.ctrl.openGuildRewardWindow(!1)},this),this.close_btn.on(cc.Node.EventType.TOUCH_END,function(){this.ctrl.openGuildRewardWindow(!1)},this)},openRootWnd:function(){var t=Config.guild_quest_data.data_lev_data,e=[];for(var i in t){var s=t[i];0!=s.lev&&e.push(s)}this.scroll_view.setData(e)},closeCallBack:function(){this.ctrl.openGuildRewardWindow(!1),this.scroll_view&&(this.scroll_view.deleteMe(),this.scroll_view=null)}});e.exports=l,cc._RF.pop()},{common_scrollview:"common_scrollview",guild_controller:"guild_controller",guild_reward_item:"guild_reward_item",pathtool:"pathtool"}],guild_search_panel:[function(t,e,i){"use strict";cc._RF.push(e,"79413u5nOZDEYbX0m2T0Fhf","guild_search_panel");var s=t("pathtool"),n=t("guild_const"),a=t("common_scrollview"),o=t("guild_request_item"),l=t("guild_controller"),r=t("guild_event"),c=cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("guild","guild_search_panel"),this.panel_index=1,this.ctrl=l.getInstance()},initPanel:function(){this.background=this.seekChild("background"),this.background_width=this.background.getContentSize().width,this.search_container=this.seekChild("search_container"),this.search_btn=this.seekChild(this.search_container,"search_btn"),this.guild_value=this.seekChild(this.search_container,"guild_value",cc.EditBox),this.list_container=this.seekChild("list_container"),this.return_btn=this.seekChild(this.list_container,"return_btn"),this.notice_container=this.seekChild("notice_container"),this.notice_btn=this.seekChild(this.notice_container,"notice_btn")},registerEvent:function(){this.search_btn.on(cc.Node.EventType.TOUCH_END,function(){var t=this.guild_value.string;""==t?message(Utils.TI18N("\u516c\u4f1a\u540d\u5b57\u4e0d\u5f97\u4e3a\u7a7a")):this.ctrl.requestGuildList(null,null,null,t)},this),this.return_btn.on(cc.Node.EventType.TOUCH_END,function(){this.changeViewStatus(1)},this),this.notice_btn.on(cc.Node.EventType.TOUCH_END,function(){this.changeViewStatus(1)},this),this.addGlobalEvent(r.UpdateGuildList,function(t,e){t==n.list_type.search&&this.updateGuildList(e)}.bind(this))},openRootWnd:function(){},onShow:function(){var t=this.root_wnd.getPosition();this.setPosition(t.x,t.y)},addToParent:function(t){null!=this.root_wnd&&this.setVisible(t)},changeViewStatus:function(t){this.panel_index!=t&&(this.panel_index=t,this.search_container.active=1==this.panel_index,this.list_container.active=2==this.panel_index,this.notice_container.active=3==this.panel_index,1==this.panel_index?this.background.setContentSize(this.background_width,780):this.background.setContentSize(this.background_width,702))},checkIsInListStatus:function(){return 2==this.panel_index},changeToSearchListStatus:function(){this.changeViewStatus(1)},updateGuildList:function(t){if(null==t||null==Utils.next(t))this.changeViewStatus(3);else{if(null==this.scroll_view){var e=this.list_container.getContentSize(),i={item_class:o,start_x:3,space_x:0,start_y:2,space_y:0,item_width:616,item_height:134,row:0,col:1,need_dynamic:!0};this.scroll_view=new a,this.scroll_view.createScroll(this.list_container,cc.v2(0,.5*-e.height-3),ScrollViewDir.vertical,ScrollViewStartPos.top,e,i,cc.v2(.5,.5))}this.scroll_view.setData(t),this.changeViewStatus(2)}},onDelete:function(){this.scroll_view&&this.scroll_view.deleteMe(),this.scroll_view=null}});e.exports=c,cc._RF.pop()},{common_scrollview:"common_scrollview",guild_const:"guild_const",guild_controller:"guild_controller",guild_event:"guild_event",guild_request_item:"guild_request_item",pathtool:"pathtool"}],guildboss_const:[function(t,e,i){"use strict";cc._RF.push(e,"4bf1cnx3EdM94+KXWKZLGQH","guildboss_const");e.exports={rank:{guild:1,role:2},status:{activity:0,un_activity:1,pass_activity:2},type:{physics:2,magic:1}},cc._RF.pop()},{}],guildboss_controller:[function(t,e,i){"use strict";cc._RF.push(e,"b7c6bk9cudNq7xr3s77FCOb","guildboss_controller");var s=t("role_controller"),n=t("mainui_controller"),a=t("guildboss_event"),o=t("battle_controller"),l=t("battle_const"),r=t("guildboss_const"),c=cc.Class({extends:BaseController,ctor:function(){},initConfig:function(){var e=t("guildboss_model");this.model=new e,this.model.initConfig()},getModel:function(){return this.model},registerEvents:function(){null==this.init_role_event&&(this.init_role_event=gcore.GlobalEvent.bind(EventId.EVT_ROLE_CREATE_SUCCESS,function(){gcore.GlobalEvent.unbind(this.init_role_event),this.init_role_event=null,this.role_vo=s.getInstance().getRoleVo(),null!=this.role_vo&&(this.requestInitProtocal(!0),null==this.role_assets_event&&(this.role_assets_event=this.role_vo.bind(EventId.UPDATE_ROLE_ATTRIBUTE,function(t,e){"guild_lev"==t?this.requestInitProtocal():"gid"==t&&0==e&&this.openMainWindow(!1)},this)))},this)),null==this.re_link_game_event&&(this.re_link_game_event=gcore.GlobalEvent.bind(EventId.EVT_RE_LINK_GAME,function(){this.requestInitProtocal(!0)},this))},requestInitProtocal:function(t){if(null!=this.role_vo){var e=gdata("guild_dun_data","data_const","guild_lev");if(null!=e)if(0==this.role_vo.gid||this.role_vo.guild_lev<e.val)this.model.clearGuildBossInfo({});else if(1==t)this.requestGuildDunBaseInfo();else{var i=this.model.getBaseInfo();null!=i&&null!=Utils.next(i)||this.requestGuildDunBaseInfo()}}},registerProtocals:function(){this.RegisterProtocal(21300,this.handle21300),this.RegisterProtocal(21307,this.handle21307),this.RegisterProtocal(21308,this.handle21308),this.RegisterProtocal(21312,this.handle21312),this.RegisterProtocal(21318,this.handle21318),this.RegisterProtocal(21319,this.handle21319),this.RegisterProtocal(21303,this.handle21303),this.RegisterProtocal(21304,this.handle21304),this.RegisterProtocal(21309,this.handle21309),this.RegisterProtocal(21317,this.handle21317),this.RegisterProtocal(21305,this.handle21305),this.RegisterProtocal(21323,this.handle21323)},openMainWindow:function(t){if(t){if(null==this.role_vo||0==this.role_vo.gid)return void message(Utils.TI18N("\u4f60\u5f53\u524d\u8fd8\u6ca1\u6709\u52a0\u5165\u4efb\u4f55\u516c\u4f1a!"));var e=gdata("guild_dun_data","data_const","guild_lev");if(null==e)return void message(Utils.TI18N("\u516c\u4f1a\u526f\u672c\u6570\u636e\u5f02\u5e38!"));if(this.role_vo.guild_lev<e.val)return void message(e.desc);var i=gdata("function_data","data_base",[6]);if(0==n.getInstance().checkIsOpenByActivate(i.activate))return void message(i.desc);null==this.main_window&&(this.main_window=Utils.createClass("guildboss_main_window")),this.main_window.open()}else this.main_window&&(this.main_window.close(),this.main_window=null)},openGuildBossPreviewWindow:function(t){t?(null==this.boss_preview_window&&(this.boss_preview_window=Utils.createClass("guildboss_preview_window")),this.boss_preview_window.open()):this.boss_preview_window&&(this.boss_preview_window.close(),this.boss_preview_window=null)},openGuildbossResultWindow:function(t,e){t?(null==this.result_window&&(this.result_window=Utils.createClass("guildboss_result_window")),this.result_window.open(e)):this.result_window&&(this.result_window.close(),this.result_window=null)},openGuildBossRankWindow:function(t,e){t?(null==this.rank_window&&(this.rank_window=Utils.createClass("guildboss_rank_window")),this.rank_window.open(e)):this.rank_window&&(this.rank_window.close(),this.rank_window=null)},oepnGuildRewardShowView:function(t){t?(null==this.reward_view&&(this.reward_view=Utils.createClass("guildboss_reward_view")),this.reward_view.open()):this.reward_view&&(this.reward_view.close(),this.reward_view=null)},requestGuildDunBaseInfo:function(){this.SendProtocal(21300,{})},handle21300:function(t){this.model.updateGuildDunBaseInfo(t),gcore.GlobalEvent.fire(a.MusterCoolTime,t.coldtime||0)},requestBuyChallengeTimes:function(e){var i=this.model.getBaseInfo();if(null!=i&&null!=i.buy_count){var n=s.getInstance().getRoleVo();if(null!=n)if(0==i.count){var a=function(t){var e={};e.type=t,this.SendProtocal(21312,e)}.bind(this),o=i.buy_count+1,l=gdata("guild_dun_data","data_buy_count",[o]);if(null==l)message(Utils.TI18N("\u5f53\u524d\u8d2d\u4e70\u6b21\u6570\u5df2\u5230\u8fbe\u672c\u65e5\u4e0a\u9650"));else if(n.vip_lev<l.vip_lev){var r=cc.js.formatStr(Utils.TI18N("\u63d0\u5347\u81f3<color=#289b14>vip%s</c>\u53ef\u63d0\u9ad8<color=#289b14>1</c>\u70b9\u6b21\u6570\u8d2d\u4e70\u4e0a\u9650\uff0c\u662f\u5426\u524d\u5f80\u5145\u503c\u63d0\u5347vip\u7b49\u7ea7"),l.vip_lev);t("commonalert").show(r,Utils.TI18N("\u6211\u8981\u63d0\u5347"),function(){t("vip_controller").getInstance().openVipMainWindow(!0,VIPTABCONST.CHARGE)},Utils.TI18N("\u53d6\u6d88"),null,2)}else{var c=l.expend;if(null==c||Utils.getArrLen(c)<2)return;var _=Utils.getItemConfig(c[0]);if(_){r=cc.js.formatStr(Utils.TI18N("\u662f\u5426\u82b1\u8d39 <img src='%s' scale=0.35 />%s \u8d2d\u4e70<color=#289b14>1</c>\u70b9\u6311\u6218\u6b21\u6570\uff1f"),_.icon,c[1]);var h=PathTool.getItemRes(_.icon);t("commonalert").show(r,Utils.TI18N("\u786e\u5b9a"),function(){a(e)},Utils.TI18N("\u53d6\u6d88"),null,2,null,{resArr:[h]})}}}else message(Utils.TI18N("\u6311\u6218\u6b21\u6570\u4e3a0\u65f6\u53ef\u8d2d\u4e70\uff0c\u8bf7\u52aa\u529b\u6311\u6218Boss\uff01"))}},handle21312:function(t){message(t.msg),1==t.code&&this.model.updateBaseWithTimes(t.count,t.buy_count,t.type)},requestResetGuildDun:function(t){var e={};e.type=t,this.SendProtocal(21307,e)},handle21307:function(t){message(t.msg)},send21308:function(t,e,i,s){var n={};n.boss_id=t,n.formation_type=e,n.pos_info=i,n.hallows_id=s,this.SendProtocal(21308,n)},handle21308:function(t){message(t.msg)},handle21303:function(t){this.model.initDayBoxRewardsStatus(t.bos_list)},handle21304:function(t){message(t.msg),1==t.code&&this.model.updateBoxRewards(t.fid,t.num)},handle21321:function(t){message(t.msg)},send21323:function(){this.SendProtocal(21323,{})},handle21323:function(t){if(0==t.code)message(t.msg);else if(1==t.code){var e=t.coldtime-gcore.SmartSocket.getTime();gcore.GlobalEvent.fire(a.MusterCoolTime,e||0)}},send21305:function(){this.SendProtocal(21305,{})},handle21305:function(t){message(t.msg)},requestGuildDunRank:function(t,e){t==r.rank.guild?this.SendProtocal(21327,{}):t==r.rank.role&&e&&this.SendProtocal(21319,e)},handle21318:function(t){gcore.GlobalEvent.fire(a.UpdateGuildDunRank,t,r.rank.guild)},handle21319:function(t){this.model.setRaknRoleList(t),gcore.GlobalEvent.fire(a.UpdateGuildDunRank,t,r.rank.role)},handle21309:function(t){o.getInstance().openFinishView(!0,l.Fight_Type.GuildDun,t)},handle21317:function(t){message(t.msg),1==t.code&&o.getInstance().openFinishView(!0,l.Fight_Type.GuildDun,t)},requestMopupMonster:function(t){var e={};e.boss_id=t,this.SendProtocal(21317,e)},getGuildBossMainRootWnd:function(){if(this.main_window)return this.main_window.root_wnd}});e.exports=c,cc._RF.pop()},{battle_const:"battle_const",battle_controller:"battle_controller",commonalert:"commonalert",guildboss_const:"guildboss_const",guildboss_event:"guildboss_event",guildboss_model:"guildboss_model",mainui_controller:"mainui_controller",role_controller:"role_controller",vip_controller:"vip_controller"}],guildboss_event:[function(t,e,i){"use strict";cc._RF.push(e,"ee636OMdR1Mc7uNRtoVhh4J","guildboss_event"),e.exports={UpdateGuildDunBaseInfo:"UpdateGuildDunBaseInfo",UpdateGuildBossChallengeTimes:"UpdateGuildBossChallengeTimes",UpdateFirstPassReward:"UpdateFirstPassReward",MusterCoolTime:"MusterCoolTime",BossActivityDoubleTime:"BossActivityDoubleTime",UpdateGuildDunRank:"UpdateGuildDunRank",UpdateBoxRewardsStatus:"UpdateBoxRewardsStatus",UpdateChangeStatus:"UpdateChangeStatus"},cc._RF.pop()},{}],guildboss_main_window:[function(t,e,i){"use strict";cc._RF.push(e,"15aedZLqDpA/rPxanyKewrG","guildboss_main_window");var s=t("pathtool"),n=t("guildboss_controller"),a=t("guild_event"),o=t("playerhead"),l=t("backpack_controller"),r=t("timetool"),c=t("role_controller"),_=t("guildboss_event"),h=t("guildboss_const"),d=t("baserole"),u=t("hero_controller"),m=t("partner_const"),f=t("activity_controller"),p=t("guide_event"),g=cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("guildboss","guildboss_main_window"),this.win_type=WinType.Big,this.viewTag=SCENE_TAG.dialogue,this.ctrl=n.getInstance(),this.model=this.ctrl.getModel(),this._doubleRewardList={},this._currentPassNum={},this._doublePassNum={},this.item_pool=[],this.item_list=[],this.item_list_1={},this.item_list_2={},this.rank_list={}},openCallBack:function(){this.background=this.seekChild("background"),this.background.scale=FIT_SCALE;var e=this.seekChild("main_panel");this.close_btn=this.seekChild(e,"close_btn"),this.explain_btn=this.seekChild(e,"explain_btn"),this.add_btn=this.seekChild(e,"add_btn"),this.rank_btn=this.seekChild(e,"rank_btn"),this.challenge_btn=this.seekChild(e,"challenge_btn"),this.mopup_btn=this.seekChild(e,"mopup_btn",cc.Button),this.challenge_btn_label=this.seekChild(this.challenge_btn,"label",cc.Label),this.challenge_btn_lo=this.seekChild(this.challenge_btn,"label",cc.LabelOutline),this.mopup_btn_label=this.seekChild(this.mopup_btn.node,"label",cc.Label),this.mopup_btn_lo=this.seekChild(this.mopup_btn.node,"label",cc.LabelOutline),this.challenge_btn_label.string=Utils.TI18N("\u6311\u6218"),this.mopup_btn_label.string=Utils.TI18N("\u626b\u8361"),this.muster_btn=this.seekChild(e,"muster_btn"),this.muster_btn_tips=this.seekChild(this.muster_btn,"label",cc.Label),this.muster_btn_tips.string="",this.musterImage=this.seekChild(e,"musterImage"),this.musterImage.active=!1,this.muster_btn_label=this.seekChild(this.musterImage,"label",cc.Label),this._doubleReward=this.seekChild(e,"doubleReward"),this._doubleReward.active=!1,this.reset_time_value=this.seekChild(e,"reset_time_value",cc.RichText),this.challenge_times_value=this.seekChild(e,"challenge_times_value",cc.Label),this.chapter_name=this.seekChild(e,"chapter_name",cc.Label),this.chapter_boss_container=this.seekChild(e,"chapter_boss_container");var i=t("guildboss_preview_window");this.guild_boss_view=new i,this.guild_boss_view.setParent(this.chapter_boss_container),this.guild_boss_view.show(),this.buff_container=this.seekChild(e,"buff_container"),this.buff_name=this.seekChild(this.buff_container,"buff_name",cc.Label),this.buff_name.string="",this.buff_icon=this.seekChild(this.buff_container,"buff_icon",cc.Sprite),this.buff_acitive_label=this.seekChild(this.buff_container,"buff_acitive_label",cc.RichText),this.remain_buy_lb=this.seekChild(e,"remain_buy",cc.Label),this.rank_container=this.seekChild(e,"rank_container"),this.rank_info_btn=this.seekChild(this.rank_container,"rank_btn"),this.rank_btn_label=this.seekChild(this.rank_btn,"label",cc.Label),this.bg=this.seekChild(e,"bg",cc.Sprite);var s={};s.container=this.seekChild(e,"monster_container_1"),s.model=this.seekChild(s.container,"monster_model"),s.pass_icon=this.seekChild(s.container,"pass_icon"),s.monster_name=this.seekChild(s.container,"monster_name",cc.Label),s.progress_container=this.seekChild(s.container,"progress_container"),s.progress=this.seekChild(s.progress_container,"progress",cc.ProgressBar),s.hp_value=this.seekChild(s.progress_container,"hp_value",cc.Label),s.boss_icon=new o,this.boss_icon=s.boss_icon,s.boss_icon.show(),s.boss_icon.setPosition(-105,133),s.boss_icon.setScale(.55),s.boss_icon.setParent(s.container),this.monster_container=s,this.main_panel=e},registerEvent:function(){this.role_vo=c.getInstance().getRoleVo(),null!=this.role_vo&&null==this.role_assets_event&&(this.role_assets_event=this.role_vo.bind(EventId.UPDATE_ROLE_ATTRIBUTE,function(t,e){},this)),this.muster_btn.on(cc.Node.EventType.TOUCH_END,function(){if(1==this.role_vo.position||2==this.role_vo.position){var e=Utils.TI18N("\u53d1\u51fa\u96c6\u7ed3\u540e\u5c06\u4f1a\u63d0\u9192\u6240\u6709\u4f1a\u53cb\uff0c\u4e14\u67091\u5c0f\u65f6\u5185\u4e0d\u53ef\u518d\u53d1\u51fa\u96c6\u7ed3\uff08\u5168\u4f1a\uff09\uff0c\u662f\u5426\u786e\u5b9a\u53d1\u51fa\u96c6\u7ed3\uff1f"),i=function(){this.ctrl.send21323()}.bind(this);t("commonalert").show(e,Utils.TI18N("\u786e\u5b9a"),i,Utils.TI18N("\u53d6\u6d88"),null,1,null,null,24)}else message(Utils.TI18N("\u53ea\u6709\u4f1a\u957f\u3001\u526f\u4f1a\u957f\u53ef\u53d1\u51fa\u96c6\u7ed3"))},this),this.close_btn.on(cc.Node.EventType.TOUCH_END,function(){this.ctrl.openMainWindow(!1)},this),this.addGlobalEvent(_.MusterCoolTime,function(t){1==this.role_vo.position||2==this.role_vo.position?this.musterCoolCountTime(t):this.muster_btn_tips.string=Utils.TI18N("\u96c6\u7ed3\u53f7\u89d2")},this),this.addGlobalEvent(_.BossActivityDoubleTime,function(t){this.doubleTimeAction(t)},this),this.buff_container.on(cc.Node.EventType.TOUCH_END,function(){this.checkBuff()},this),this.background.on(cc.Node.EventType.TOUCH_END,function(){this.ctrl.openMainWindow(!1)},this),this.explain_btn.on(cc.Node.EventType.TOUCH_END,function(e){Utils.playButtonSound(1);var i=e.touch.getLocation();t("tips_controller").getInstance().showCommonTips(Config.guild_dun_data.data_const.game_rule.desc,i)},this),this.add_btn.on(cc.Node.EventType.TOUCH_END,function(){this.ctrl.requestBuyChallengeTimes(0)},this),this.rank_btn.on(cc.Node.EventType.TOUCH_END,function(){var t;this.guild_boss_view&&(t=this.guild_boss_view.getCurSelect()),t&&t.data&&this.ctrl.openGuildBossRankWindow(!0,t.data)},this),this.rank_info_btn.on(cc.Node.EventType.TOUCH_END,function(){var e=null;this.guild_boss_view&&(e=this.guild_boss_view.getCurSelect()),t("rank_controller").getInstance().openRankView(!0,t("rank_constant").RankType.union_boss,null,e)},this),this.challenge_btn.on(cc.Node.EventType.TOUCH_END,function(){this.cur_selected_object&&this.cur_selected_object.config&&this.base_info&&(this.base_info.count>0?u.getInstance().openFormGoFightPanel(!0,m.Fun_Form.GuildDun_AD,{boss_id:this.cur_selected_object.config.boss_id}):this.ctrl.requestBuyChallengeTimes(1)),gcore.GlobalEvent.fire(p.TaskNextStep,"challenge_btn")},this),this.mopup_btn.node.on("click",function(){this.cur_selected_object&&this.cur_selected_object.config&&this.base_info&&this.requestMopupMonster()},this),this.addGlobalEvent(_.UpdateGuildDunBaseInfo,function(){this.guild_boss_view&&this.guild_boss_view.updateScrollViewList(),this.updateDunBaseInfo()},this),this.addGlobalEvent(_.UpdateChangeStatus,function(t){this.updateChangeStatus(t)},this),this.addGlobalEvent(_.UpdateGuildDunRank,function(){var t=this.ctrl.getModel().getRaknRoleTopThreeList();if(t&&null!=Utils.next(t||{}))for(var e in t){var i=t[e];if(!this.rank_list[e]){var s=this.createSingleRankItem(e,i);this.rank_list[e]=s}(s=this.rank_list[e])&&(s.label.string=i.name,i.all_dps?s.value.string="["+Utils.getMoneyString(i.all_dps,!1)+Utils.TI18N("\u4f24\u5bb3")+"]":s.value.string="")}},this),this.addGlobalEvent(_.UpdateGuildBossChallengeTimes,function(t){if(null!=this.base_info)this.challenge_times_value.string=this.base_info.count,this.remainBuyCount(this.base_info.buy_count);else{var e=this.model.getBaseInfo();null!=e&&(this.remainBuyCount(e.buy_count),this.challenge_times_value.string=e.count)}1==t&&this.autoOpenChallengeWindow()},this),this.addGlobalEvent(a.UpdateGuildRedStatus,function(t,e){this.updateSomeRedStatus(t,e)},this)},checkBuff:function(){if(this.base_info){var e=gdata("guild_dun_data","data_const","buff_item").val,i=l.getInstance().getModel().getBackPackItemNumByBid(e),n=gdata("guild_dun_data","data_const","buff_cost").val,a=Utils.getItemConfig(e).icon,o=Math.min(this.base_info.buff_lev+1,Config.guild_dun_data.data_buff_data_length),r=gdata("guild_dun_data","data_buff_data",[o]).desc,c="",_=cc.js.formatStr(Utils.TI18N("<color=#764519>(\u6fc0\u6d3b\u540e\u6548\u679c\u4e3a</c><color=#289b14 ><size= 24>%s</></c><color=#764519>)</c>"),r),h=null;i>0?(this.base_info.buff_lev,c=cc.js.formatStr(Utils.TI18N("\u662f\u5426\u6d88\u8017<img src='%s' visible=true scale=0.5 /><color=#289b14 ><size= 24>%s</></c><color=#764519>(\u62e5\u6709:</c><color=#289b14><size=24>%s</></c><color=#764519>)\u6fc0\u6d3b\u5168\u516c\u4f1a\u4f24\u5bb3\u63d0\u5347Buff\n</c>"),a,1,i)+_,h=s.getItemRes(a)):(this.base_info.buff_lev,c=cc.js.formatStr(Utils.TI18N("\u662f\u5426\u6d88\u8017<img src='%s' visible=true scale=0.5 /><color=#289b14 ><size= 24>%s</></c><color=#764519>\u6fc0\u6d3b\u5168\u516c\u4f1a\u4f24\u5bb3\u63d0\u5347Buff\n</c>"),Config.item_data.data_assets_label2id.gold,n)+_,h=s.getItemRes(Config.item_data.data_assets_label2id.gold));var d=function(){this.ctrl.send21305()}.bind(this);new t("commonalert").show(c,Utils.TI18N("\u786e\u8ba4"),d,Utils.TI18N("\u53d6\u6d88"),null,2,null,{resArr:[h]})}},updateMusterCoolTimeTicket:function(){this.remainTime=this.remainTime-1,this.remainTime<=0&&(this.musterImage.active=!1,this.muster_btn_tips.active=!0,this.muster_btn_label.node.stopAllActions()),this.muster_btn_label.string=cc.js.formatStr(Utils.TI18N("%s\n\u540e\u53ef\u96c6\u7ed3"),r.getTimeFormat(this.remainTime))},musterCoolCountTime:function(t){if(this.muster_btn_label)if(this.remainTime=t,this.muster_btn_label.node.stopAllActions(),this.remainTime>0){this.musterImage.active=!0;var e=this;this.muster_btn_label.node.runAction(cc.repeatForever(cc.sequence(cc.delayTime(1),cc.callFunc(function(){e.remainTime=e.remainTime-1,e.remainTime<=0?(e.musterImage.active=!1,e.muster_btn_tips.active=!0,e.muster_btn_label.node.stopAllActions()):(e.musterImage.active=!0,e.muster_btn_tips.active=!1,e.muster_btn_label.string=cc.js.formatStr(Utils.TI18N("%s\n\u540e\u53ef\u96c6\u7ed3"),r.getTimeFormat(e.remainTime)))})))),this.updateMusterCoolTimeTicket()}else this.musterImage.active=!1,this.muster_btn_label.node.stopAllActions(),this.muster_btn_tips.string=Utils.TI18N("\u96c6\u7ed3\u53f7\u89d2")},updateChangeStatus:function(t){if(t){var e=0,i=this.model.getBaseInfo(),s=this.monster_container,n=null;if(0==t.status){if(e=i.fid,null!=i&&null!=i.info){for(var a in i.info){var o=i.info[a],l=gdata("guild_dun_data","data_guildboss_list",[o.boss_id]);l&&null!=s&&(s.config=l,n=o)}if(i.combat_info)for(var a in i.combat_info){o=i.combat_info[a];s&&s.config&&o.boss_id==s.config.boss_id&&(s.dps=o.dps)}}this.buff_container.active=!0}else e=t.config.id,s.config=t.config,n={boss_id:t.config.boss_id,hp:0},s.dps=0,this.buff_container.active=!1;if(e){var r=gdata("guild_dun_data","data_chapter_reward",[e]),c=gdata("guild_dun_data","data_guildboss_list",[r.show_id]);null!=r&&(this.chapter_name.string=r.chapter_name+" "+r.chapter_desc),this.updateBg(c.bg_res)}n&&this.updateMonsterHPStatus(s,n),s&&(this.updateMonsterInfo(s),this.updateSelectedBtnStatus())}},createSingleRankItem:function(t,e){var i={},s=this.seekChild(this.rank_container,"rank_"+(Number(t)+1)),n=this.seekChild(s,"label",cc.Label),a=this.seekChild(s,"value",cc.Label),o=this.seekChild(s,"sp");return i.node=s,i.label=n,i.value=a,i.sp=o,i},requestMopupMonster:function(){if(null!=this.base_info){var e=this.base_info;if(e.count>0){var i=cc.js.formatStr(Utils.TI18N("\u786e\u5b9a\u6309\u7167\u4e0a\u6b21\u6311\u6218\u7684\u4f24\u5bb3\u91cf<color=#249003>%s</c>\u626b\u8361\u4e00\u6b21\u5417\uff1f"),this.cur_selected_object.dps);t("commonalert").show(i,Utils.TI18N("\u786e\u5b9a"),function(){this.ctrl.requestMopupMonster(this.cur_selected_object.config.boss_id)}.bind(this),Utils.TI18N("\u53d6\u6d88"),null,2)}else{var n=e.buy_count+1,a=gdata("guild_dun_data","data_buy_count",[n]);if(null==a)message(Utils.TI18N("\u5f53\u524d\u6ca1\u6709\u626b\u8361\u6b21\u6570\uff0c\u4e14\u8d2d\u4e70\u6b21\u6570\u5df2\u5230\u8fbe\u672c\u65e5\u4e0a\u9650\uff01"));else{var o=c.getInstance().getRoleVo();if(o)if(o.vip_lev<a.vip_lev){i=cc.js.formatStr(Utils.TI18N("\u6311\u6218\u6b21\u6570\u4e0d\u8db3\uff0c\u63d0\u5347\u81f3<color='#289b14'>vip%s</c>\uff0c\u53ef\u589e\u52a0<color='#289b14'>1</c>\u70b9\u6b21\u6570\u8d2d\u4e70\u4e0a\u9650\uff01"),a.vip_lev);t("commonalert").show(i,Utils.TI18N("\u6211\u8981\u63d0\u5347"),function(){t("vip_controller").getInstance().openVipMainWindow(!0,VIPTABCONST.CHARGE)}.bind(this),Utils.TI18N("\u53d6\u6d88"),null,2)}else{var l=a.expend;if(null==l||l.length<2)return;var r=Utils.getItemConfig(l[0]);if(r){i=cc.js.formatStr(Utils.TI18N("\u6311\u6218\u6b21\u6570\u4e0d\u8db3\uff0c\u662f\u5426\u82b1\u8d39 <img src='%s' scale=0.5 /> %s \u8d2d\u4e70<color=#289b14>1</c>\u70b9\u6311\u6218\u6b21\u6570\u5e76\u626b\u8361\uff1f\n(\u626b\u8361\u6839\u636e\u4e0a\u6b21\u7684\u4f24\u5bb3\u91cf<color=#249003>%s</c>\u8fdb\u884c\u7ed3\u7b97)"),r.icon,l[1],this.cur_selected_object.dps);var _=s.getItemRes(r.icon);t("commonalert").show(i,Utils.TI18N("\u786e\u5b9a"),function(){this.ctrl.requestMopupMonster(this.cur_selected_object.config.boss_id)}.bind(this),Utils.TI18N("\u53d6\u6d88"),null,2,null,{resArr:[_]})}}}}}},openRootWnd:function(){this.ctrl.requestGuildDunBaseInfo(),f.getInstance().setFirstComeGuild(!1),this.updateSomeRedStatus(),1==f.getInstance().getBossActivityDoubleTime()&&(this._doubleReward.active=!0)},updateBuffTime:function(t){t&&t&&(this.buff_second=t,this.buff_second<=0?this.clearBuffTimeTicket():null==this.buff_time_ticket&&(this.buff_time_ticket=gcore.Timer.set(function(){this.updateBuffTimeTicket()}.bind(this),1e3,-1)))},clearBuffTimeTicket:function(){null!=this.buff_time_ticket&&(gcore.Timer.del(this.buff_time_ticket),this.buff_time_ticket=null)},updateBuffTimeTicket:function(){this.buff_second=this.buff_second-1,this.buff_second<=0&&this.clearBuffTimeTicket(),this.buff_acitive_label.string=cc.js.formatStr(Utils.TI18N("<color=#35ff14>(%s\u540e\u5931\u6548)</c>"),r.getTimeFormat(this.buff_second))},autoOpenChallengeWindow:function(){this.cur_selected_object&&this.cur_selected_object.config&&this.base_info&&this.base_info.count>0&&u.getInstance().openFormGoFightPanel(!0,m.Fun_Form.GuildDun_AD,{boss_id:this.cur_selected_object.config.boss_id})},updateDunBaseInfo:function(){this.base_info=this.model.getBaseInfo();var t=this.base_info;if(null!=t&&null!=t.info){for(var e in this.remainBuyCount(t.buy_count),t.info){var i=t.info[e],s=gdata("guild_dun_data","data_guildboss_list",[i.boss_id]);if(s){var n=this.monster_container;null!=n&&(n.config=s,this.updateMonsterHPStatus(n,i))}}if(t.combat_info)for(var e in this.base_info.combat_info){i=this.base_info.combat_info[e];this.monster_container&&this.monster_container.config&&i.boss_id==this.monster_container.config.boss_id&&(this.monster_container.dps=i.dps)}if(this.challenge_times_value.string=t.count,this.cur_fid!=t.fid){this.cur_fid=t.fid;var a=gdata("guild_dun_data","data_chapter_reward",[t.fid]);if(null!=a){if(this.monster_container&&this.monster_container.boss_icon){var o=gdata("guild_dun_data","data_guildboss_list",[a.show_id]);o&&(this.monster_container.boss_icon.setHeadRes(o.head_icon),this.updateBg(o.bg_res))}this.chapter_name.string=a.chapter_name+" "+a.chapter_desc,this.updateFillRewardsItems(a.dps_awrard,a.award,a.guild_exp)}}if(gcore.Timer.set(function(){this.updateMonsterInfo(this.monster_container)}.bind(this),8/60,1),this.selecetMonsterContainer(),null!=t&&0!=t.buff_end_time){var l=gdata("guild_dun_data","data_buff_data",[t.buff_lev]);l&&(this.buff_name.string=l.desc),this.buff_icon.setMaterial(0,cc.Material.getBuiltinMaterial("2d-sprite")),this.buff_name.node.color=new cc.Color(137,237,255,255),this.updateBuffTime(t.buff_end_time),this.buff_container.active=!0}else this.buff_icon.setMaterial(0,cc.Material.getBuiltinMaterial("2d-gray-sprite")),this.buff_name.node.color=new cc.Color(cc.Color.WHITE),this.buff_name.string=gdata("guild_dun_data","data_const",["des_nobuff"]).desc,this.buff_acitive_label.string=Utils.TI18N("<color=#ff5858>(\u672a\u6fc0\u6d3b)</c>")}},remainBuyCount:function(t){t=t||0;var e=0,i=Config.guild_dun_data.data_buy_count_length,s=Config.guild_dun_data.data_buy_count[i];s&&(e=s.count-t),this.remain_buy_lb.string=e},updateBg:function(t){var e=s.getBigBg(t,null,"guildboss");this.res_id!=e&&(this.res_id=e,this.loadRes(this.res_id,function(t){this.bg.spriteFrame=t}.bind(this)))},updateMonsterInfo:function(t){if(null!=t&&null!=t.config){var e=t.config;t.boss_id!=e.boss_id&&(t.boss_id=e.boss_id,t.monster_name.string=e.item_name,t.spine?t.spine.setData(d.type.unit,e.combat_id,PlayerAction.show,!0):(t.spine=new d,t.spine.setParent(t.model),t.spine.setData(d.type.unit,e.combat_id,PlayerAction.show,!0)))}},selecetMonsterContainer:function(t){this.cur_selected_object=this.monster_container,this.updateSelectedBtnStatus()},updateSelectedBtnStatus:function(){null!=this.cur_selected_object&&null!=this.cur_selected_object.hp&&null!=this.cur_selected_object.dps&&(0==this.cur_selected_object.hp?(Utils.setGreyButton(this.challenge_btn,!0),Utils.setGreyButton(this.mopup_btn,!0),this.challenge_btn_lo.enabled=!1,this.mopup_btn_lo.enabled=!1):0==this.cur_selected_object.dps?(Utils.setGreyButton(this.mopup_btn,!0),Utils.setGreyButton(this.challenge_btn,!1),this.challenge_btn_lo.enabled=!0,this.mopup_btn_lo.enabled=!1):(Utils.setGreyButton(this.challenge_btn,!1),Utils.setGreyButton(this.mopup_btn,!1),this.challenge_btn_lo.enabled=!0,this.mopup_btn_lo.enabled=!0))},updateMonsterHPStatus:function(t,e){if(null!=t&&null!=e&&null!=t.config){e.hp<=0?this.doubleTimeAction(!1):1==f.getInstance().getBossActivityDoubleTime()&&this.doubleTimeAction(!0);var i=t.config,s=Math.ceil(100*e.hp/i.hp);t.hp_value.string=s+"%",t.progress.progress=s/100,t.hp=e.hp,t.pass_icon.active=0==e.hp,t.boss_icon.setVisible(0!=e.hp),t.monster_name.node.active=0!=e.hp,t.progress_container.active=0!=e.hp}},doubleTimeAction:function(t){if(0==t&&(this._doubleReward.stopAllActions(),null!=Utils.next(this._doubleRewardList)))for(var e in this._doubleReward)this._doubleReward[e];this._doubleReward.active=t;var i=cc.sequence(cc.fadeOut(1),cc.fadeIn(1),cc.delayTime(.3));if(this._doubleReward.runAction(cc.repeatForever(i)),null!=Utils.next(this._doubleRewardList))for(var e in this._doubleRewardList)this._doubleRewardList[e]},updateFillRewardsItems:function(t,e,i){t=t||{},s=e||[];var s=Utils.deepCopy(e);for(var n in i=i||0,s.push([gdata("item_data","data_assets_label2id","guild_exp"),i]),this.item_list_1){(a=this.item_list_1[n])&&a.setVisible(!1)}for(var n in this.item_list_2){var a;(a=this.item_list_2[n])&&a.setVisible(!1)}var o=1,l=0,r=null;for(var n in t){var c=t[n];if(null==this.item_list_1[o]){var _=ItemsPool.getInstance().getItem("backpack_item");_.initConfig(!1,.8,!1,!0),_.setParent(this.main_panel),_.show(),this.item_list_1[o]=_}if((u=this.item_list_1[o]).setVisible(!0),l=100+(o-1)*(.8*BackPackItem.Width+14)+.8*BackPackItem.Width*.5-335,u.setPosition(l,-339),u.setData({bid:c[0],num:c[1]}),r=c[1]>=1e3?cc.js.formatStr("%sK",Math.floor(.001*c[1])):c[1],c[2]&&(r=r),this._currentPassNum[n]=r,!this._doubleRewardList[n]){this._doubleRewardList[n]=u;var h=null;h=2*c[1]>=1e3?cc.js.formatStr("%sK",Math.floor(2*c[1]*.001)):2*c[1],c[2]&&(h=h),this._doublePassNum[n]=h}o+=1}for(var n in 1==f.getInstance().getBossActivityDoubleTime()&&this.doubleTimeAction(!0),o=1,s){if((c=s[n])instanceof Array&&c[0]&&c[1]){if(null==this.item_list_2[o]){var d=ItemsPool.getInstance().getItem("backpack_item");d.initConfig(!1,.8,!1,!0),d.setParent(this.main_panel),d.show(),this.item_list_2[o]=d}var u;(u=this.item_list_2[o]).setVisible(!0),l=100+(o-1)*(.8*BackPackItem.Width+14)+.8*BackPackItem.Width*.5-23,u.setPosition(l,-339),u.setData({bid:c[0],num:c[1]}),this.item_list.push(u),o+=1}}},updateSomeRedStatus:function(t,e){},getType:function(t){return 1==t?h.type.physics:h.type.magic},closeCallBack:function(){if(this.boss_icon&&(this.boss_icon.deleteMe(),this.boss_icon=null),this._doubleRewardList){for(var t in this._doubleRewardList){(e=this._doubleRewardList[t]).deleteMe&&(e.deleteMe(),e=null)}this._doubleRewardList=null}if(this.clearBuffTimeTicket(),this.monster_list){for(var t in this.monster_list){var e;(e=this.monster_list[t]).spine&&(e.spine.deleteMe(),e.spine=null)}this.monster_list=null}if(this.item_list_2){for(var t in this.item_list_2)this.item_list_2[t]&&(this.item_list_2[t].deleteMe(),this.item_list_2[t]=null);this.item_list_2=null}this.muster_btn_label.node.stopAllActions(),this.guild_boss_view&&(this.guild_boss_view.deleteMe(),this.guild_boss_view=null),null!=this.role_vo&&(null!=this.role_assets_event&&(this.role_vo.unbind(this.role_assets_event),this.role_assets_event=null),this.role_vo=null),this.ctrl.openMainWindow(!1)}});e.exports=g,cc._RF.pop()},{activity_controller:"activity_controller",backpack_controller:"backpack_controller",baserole:"baserole",commonalert:"commonalert",guide_event:"guide_event",guild_event:"guild_event",guildboss_const:"guildboss_const",guildboss_controller:"guildboss_controller",guildboss_event:"guildboss_event",guildboss_preview_window:"guildboss_preview_window",hero_controller:"hero_controller",partner_const:"partner_const",pathtool:"pathtool",playerhead:"playerhead",rank_constant:"rank_constant",rank_controller:"rank_controller",role_controller:"role_controller",timetool:"timetool",tips_controller:"tips_controller",vip_controller:"vip_controller"}],guildboss_model:[function(t,e,i){"use strict";cc._RF.push(e,"63353o0oUxMXLyGJQRMY0+Z","guildboss_model");var s=t("guild_event"),n=t("mainui_controller"),a=t("mainui_const"),o=(n=t("mainui_controller"),t("guildboss_event")),l=t("guild_const");cc.Class({extends:BaseClass,ctor:function(){var e=t("guildboss_controller");this.ctrl=e.getInstance()},properties:{},initConfig:function(){this.guildboss_red_list={},this.role_rank_list={}},clearGuildBossInfo:function(){this.base_info={},this.first_pass_list={},this.day_bos_list={},this.guildboss_red_list={},this._initFirstPassData={}},updateGuildRedStatus:function(t,e){RedMgr.getInstance().addCalHandler(function(){var i=Config.function_data.data_base;if(0!=n.getInstance().checkIsOpenByActivate(i[6].activate)&&this.guildboss_red_list[t]!=e){this.guildboss_red_list[t]=e,cc.log("\u66f4\u65b0\u573a\u666f\u7ea2\u70b9\u72b6\u6001",a.btn_index.guild,{bid:t,status:e}),n.getInstance().setBtnRedPoint(a.btn_index.guild,{bid:t,status:e});this.base_info&&this.base_info.count,gcore.GlobalEvent.fire(s.UpdateGuildRedStatus,t,e)}}.bind(this),RedIds.GuildBoss)},checkGuildDunRedStatus:function(){for(var t in this.guildboss_red_list){if(1==this.guildboss_red_list[t])return!0}return!1},getRedStatusByType:function(t){return this.guildboss_red_list[t]},updateGuildDunBaseInfo:function(t){var e=!1;null!=this.base_info&&this.base_info.count==t.count||(e=!0),this.base_info=t,gcore.GlobalEvent.fire(o.UpdateGuildDunBaseInfo),1==e&&this.updateGuildRedStatus(l.red_index.boss_times,this.base_info.count>0)},getChangeCount:function(){if(this.base_info)return!!this.base_info.count&&this.base_info.count>0},getBaseInfo:function(){return this.base_info},updateBaseWithTimes:function(t,e,i){null==this.base_info&&(this.base_info={}),this.base_info.count=t,this.base_info.buy_count=e,gcore.GlobalEvent.fire(o.UpdateGuildBossChallengeTimes,i),this.updateGuildRedStatus(l.red_index.boss_times,this.base_info.count>0)},getFirstPassRewardList:function(){var t=[],e=[],i=[];if(this._initFirstPassData.award_list){for(var s in this._initFirstPassData.award_list){0==(n=this._initFirstPassData.award_list[s]).status?t.push(n):1==n.status?e.push(n):3==n.status&&i.push(n)}if(0!=t.length)for(var s in t){var n=t[s];e.push(n)}if(0!=i.length)for(var s in i){n=t[s];e.push(n)}}},getRankAward:function(t){for(var e in t=t||1,Config.guild_dun_data.data_rank_reward){var i=gdata("guild_dun_data","data_rank_reward",[e]);if(i.rank1<t&&t<=i.rank2)return i.award}return[]},initDayBoxRewardsStatus:function(t){this.day_bos_list={};for(var e=1;e<=Config.guild_dun_data.data_chapter_box_length;e++)this.day_bos_list[e]=0;var i=!1;for(var e in t){var s=t[e];this.day_bos_list[s.fid]=s.num,s.num>0&&0==i&&(i=!0)}gcore.GlobalEvent.fire(o.UpdateBoxRewardsStatus)},updateBoxRewards:function(t,e){null!=this.day_bos_list[t]&&(this.day_bos_list[t]=e)},getBoxRewardList:function(){return this.day_bos_list||{}},setRaknRoleList:function(t){this.role_rank_list=t},getRaknRoleTopThreeList:function(){var t=[{rank:1,name:Utils.TI18N("\u865a\u4f4d\u4ee5\u5f85")},{rank:2,name:Utils.TI18N("\u865a\u4f4d\u4ee5\u5f85")},{rank:3,name:Utils.TI18N("\u865a\u4f4d\u4ee5\u5f85")}];if(this.role_rank_list.rank_list&&null!=Utils.next(this.role_rank_list.rank_list||{})){var e=this.role_rank_list.rank_list;for(var i in e){var s=e[i];for(var n in t){var a=t[n];s.rank==a.rank&&(t[n]=s)}}}return t}});cc._RF.pop()},{guild_const:"guild_const",guild_event:"guild_event",guildboss_controller:"guildboss_controller",guildboss_event:"guildboss_event",mainui_const:"mainui_const",mainui_controller:"mainui_controller"}],guildboss_preview_item_panel:[function(t,e,i){"use strict";cc._RF.push(e,"fd4c5czettAKqiySUJ/A0JO","guildboss_preview_item_panel");var s=t("playerhead"),n=t("pathtool");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=n.getPrefabPath("guildboss","guildboss_preview_item")},initConfig:function(){this.boss_id=0},initPanel:function(){this.size=this.root_wnd.getContentSize(),this.root_wnd.setContentSize(this.size),this.root_wnd.setAnchorPoint(.5,.5),this.center_x=.5*this.size.width,this.head_icon=this.seekChild("head_icon"),this.boss_icon=new s,this.boss_icon.show(),this.boss_icon.setScale(.8),this.boss_icon.setPosition(0,0),this.boss_icon.setParent(this.head_icon),this.pass_icon=this.seekChild("pass_icon"),this.chapter_value=this.seekChild("chapter_value",cc.Label),this.status_value=this.seekChild("status_value",cc.Label),this.status_value.node.active=!1,this.lock_icon=this.seekChild("lock_icon"),this.lock_icon.setScale(.8),this.select_img=this.seekChild("select_img"),null!=this.select_status&&this.setSelect(this.select_status)},registerEvent:function(){this.root_wnd.on(cc.Node.EventType.TOUCH_END,function(){this.callback&&this.callback()},this)},setData:function(t,e){this.data=t,this.index=e,this.root_wnd&&this.onShow()},getData:function(){return this.data},updateMonsterInfo:function(t,e){var i=gdata("guild_dun_data","data_guildboss_list",[t]);this.data.config=i,null!=i&&(this.boss_id=t,this.boss_icon.setHeadRes(i.head_icon),this.boss_icon.setLockStatus(!0),2!=e&&3!=e||this.boss_icon.setLockStatus(!1))},addCallBack:function(t){this.callback=t},setSelect:function(t){null!=this.root_wnd?t?(CommonAction.breatheShineAction(this.select_img),this.select_img.active=!0):this.select_img.active=!1:this.select_status=t},getItemPosition:function(){if(this.root_wnd)return cc.v2(this.root_wnd.getPosition())},getIsShow:function(){return this.is_show},onShow:function(){if(null!=this.data){var t=this.data;this.data=t,this.chapter_value.string=t.desc,this.updateMonsterInfo(t.show_id,t.status),this.pass_icon.active=!1,0==t.status?this.lock_icon.active=!1:1==t.status?(this.pass_icon.active=!0,this.lock_icon.active=!1):(t.status,this.lock_icon.active=!0)}},onHide:function(){},onDelete:function(){this.boss_icon&&(this.boss_icon.deleteMe(),this.boss_icon=null)}});cc._RF.pop()},{pathtool:"pathtool",playerhead:"playerhead"}],guildboss_preview_window:[function(t,e,i){"use strict";cc._RF.push(e,"14831Vf98pMb4YdA4MPlUWZ","guildboss_preview_window");var s=t("pathtool"),n=t("common_scrollview_single"),a=t("guildboss_controller"),o=t("guildboss_const"),l=t("guildboss_event"),r=t("guildboss_preview_item_panel");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("guildboss","guildboss_preview_window")},initConfig:function(){this.is_first_enter=!0,this.monster_list={},this.cell_data_list=null},initPanel:function(){this.scroll_container=this.seekChild("scroll_container"),this.is_show&&this.updateScrollViewList()},registerEvent:function(){},onShow:function(t){},updateScrollViewList:function(){if(null!=this.root_wnd){if(this.cell_data_list=this.getCellData()[0],null==this.scroll_view){this.scroll_size=cc.size(625,100);this.scroll_view=new n,this.scroll_view.createScroll(this.scroll_container,cc.v2(0,0),ScrollViewDir.horizontal,ScrollViewStartPos.top,this.scroll_size,{start_x:7,space_x:2,start_y:4,space_y:0,item_width:100,item_height:90,row:1,col:1,delay:5},cc.v2(.5,.5)),this.scroll_view.registerScriptHandlerSingle(this.createNewCell.bind(this),ScrollViewFuncType.CreateNewCell),this.scroll_view.registerScriptHandlerSingle(this.numberOfCells.bind(this),ScrollViewFuncType.NumberOfCells),this.scroll_view.registerScriptHandlerSingle(this.updateCellByIndex.bind(this),ScrollViewFuncType.UpdateCellByIndex),this.scroll_view.registerScriptHandlerSingle(this.onCellTouched.bind(this),ScrollViewFuncType.OnCellTouched)}this.scroll_view.reloadData(Number(this.getCellData()[1]))}else this.is_show=!0},createNewCell:function(t,e){var i=new r;return i.show(),i.addCallBack(function(){this.onCellTouched(i)}.bind(this)),i},numberOfCells:function(){return this.cell_data_list?this.cell_data_list.length:0},updateCellByIndex:function(t,e){t.index=e;var i=this.cell_data_list[e];i&&(t.setData(i,e),this.cur_index==e?t.setSelect(!0):t.setSelect(!1))},onCellTouched:function(t){var e=t.index,i=this.cell_data_list[e];if(i)if(2==i.status||3==i.status)message(Utils.TI18N("\u901a\u5173\u4e0a\u4e00\u7ae0\u5f00\u542f"));else{this.clickOpen(t,e,!0);var s={boss_id:t.data.show_id,start_num:1,end_num:3};a.getInstance().requestGuildDunRank(o.rank.role,s)}},getCellData:function(){var t=a.getInstance().getModel().getBaseInfo(),e=[],i=null;if(t&&Utils.next(t||null!={})){var s=!1;for(var n in Config.guild_dun_data.data_chapter_reward){var o=gdata("guild_dun_data","data_chapter_reward",[n]),l={};l.desc=o.chapter_name,l.show_id=o.show_id,t.fid&&t.fid==o.id?(i=n,l.status=0):t.fid>o.id?l.status=1:0==s?(l.status=3,s=!0):l.status=2,e[n-1]=l}}return[e,i-1]},clickOpen:function(t,e,i){if(!this.cur_index||this.cur_index!=e||1!=i){if(null!=this.cur_select&&this.cur_index&&this.cur_index!=e&&this.cur_select.setSelect(!1),this.cur_select=t,this.cur_index=e,this.cur_select.setSelect(!0),!this.is_first_enter){var s=this.cell_data_list[this.cur_index];gcore.GlobalEvent.fire(l.UpdateChangeStatus,s)}this.is_first_enter=!1}},getCurSelect:function(){if(this.cur_select)return this.cur_select},onDelete:function(){this.scroll_view&&(this.scroll_view.deleteMe(),this.scroll_view=null)}});cc._RF.pop()},{common_scrollview_single:"common_scrollview_single",guildboss_const:"guildboss_const",guildboss_controller:"guildboss_controller",guildboss_event:"guildboss_event",guildboss_preview_item_panel:"guildboss_preview_item_panel",pathtool:"pathtool"}],guildboss_rank_item_panel:[function(t,e,i){"use strict";cc._RF.push(e,"30614BafRxOcJAzMprs2L1J","guildboss_rank_item_panel");var s=t("pathtool");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("guildboss","guildboss_rank_item")},initConfig:function(){this.item_list={}},initPanel:function(){this.rank_sp=this.seekChild("rank_img",cc.Sprite),this.rank_lb=this.seekChild("rank_label",cc.Label),this.item_nd=this.seekChild("item_container")},registerEvent:function(){},setData:function(t){this.data=t,this.root_wnd&&this.onShow()},onShow:function(t){if(null!=this.data){var e=this.data;if(e.rank2<=3)if(this.rank_lb.node.active=!1,0==e.rank2)this.rank_sp.node.active=!1;else{var i=s.getCommonIcomPath(cc.js.formatStr("common_200%s",e.rank2));this.rank_res_id!=i&&(this.rank_res_id=i,this.loadRes(i,function(t){this.rank_sp.spriteFrame=t}.bind(this))),this.rank_sp.node.active=!0}else this.rank_sp.node.active=!1,this.rank_lb.node.active=!0,this.rank_lb.string=cc.js.formatStr("%s~%s",e.rank1,e.rank2);for(var n in this.item_list)this.item_list[n].setVisible(!1);for(var a=1,o=null,l=e.award.length,r=0;r<l;r++){var c=e.award[r];Utils.getItemConfig(c[0])&&(null==this.item_list[a]&&((o=ItemsPool.getInstance().getItem("backpack_item")).initConfig(!1,.8,!1,!1),o.setParent(this.item_nd),o.show(),o.setPosition(110*r-50,0),this.item_list[a]=o),(o=this.item_list[a]).setData({bid:c[0],num:c[1]}),o.setVisible(!0),a+=1)}}},onHide:function(){},onDelete:function(){for(var t in this.item_list)this.item_list[t].deleteMe(),this.item_list[t]=null;this.item_list=null}});cc._RF.pop()},{pathtool:"pathtool"}],guildboss_rank_window:[function(t,e,i){"use strict";cc._RF.push(e,"dfd4dCiT1hMkpWwqpw4C1eu","guildboss_rank_window");var s=t("pathtool"),n=t("common_scrollview"),a=t("guildboss_controller"),o=t("guildboss_rank_item_panel");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("guildboss","guildboss_rank_window"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Big},initConfig:function(){this.selected_tab=null,this.tab_list={},this.panel_list={}},openCallBack:function(){this.background=this.seekChild("background");var t=this.seekChild("main_container"),e=this.seekChild(t,"main_panel");this.background.scale=FIT_SCALE;var i=this.seekChild(e,"scroll_view"),s=i.getContentSize(),a={item_class:o,start_x:0,space_x:0,start_y:0,space_y:0,item_width:596,item_height:140,row:0,col:1,need_dynamic:!0};this.scroll_view=new n,this.scroll_view.createScroll(i,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,s,a,cc.v2(.5,.5))},registerEvent:function(){this.background.on(cc.Node.EventType.TOUCH_END,function(){a.getInstance().openGuildBossRankWindow(!1)},this)},openRootWnd:function(t){if(t&&t.config){var e=gdata("guild_dun_data","data_rank_reward",[t.config.boss_id]);if(e){var i=Utils.deepCopy(e);i.sort(Utils.tableLowerSorter(["rank1"])),this.scroll_view.setData(i,null,this.item)}}},closeCallBack:function(){for(var t in a.getInstance().openGuildBossRankWindow(!1),this.scroll_view&&(this.scroll_view.deleteMe(),this.scroll_view=null),this.panel_list)this.panel_list[t].deleteMe(),this.panel_list[t]=null;this.panel_list=null}});cc._RF.pop()},{common_scrollview:"common_scrollview",guildboss_controller:"guildboss_controller",guildboss_rank_item_panel:"guildboss_rank_item_panel",pathtool:"pathtool"}],guildboss_result_window:[function(t,e,i){"use strict";cc._RF.push(e,"800e1sREPxPi6rh566TQNtM","guildboss_result_window");var s=t("pathtool"),n=t("guildboss_controller");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("guildboss","guildboss_result_window"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Mini},initConfig:function(){this.ctrl=n.getInstance(),this.label_list=[]},openCallBack:function(){this.background=this.seekChild("background"),this.background.scale=FIT_SCALE;var t=this.seekChild("container");this.title_container=this.seekChild("title_container"),this.special_sk=this.title_container.getComponent(sp.Skeleton),this.harm_btn=this.seekChild("harm_btn"),this.partner_item=ItemsPool.getInstance().getItem("hero_exhibition_item"),this.partner_item.setPosition(-200,8),this.partner_item.show(),this.partner_item.setParent(t),this.dps_value_lb=this.seekChild("dps_value",cc.Label),this.container=t},registerEvent:function(){Utils.onTouchEnd(this.background,function(){this.ctrl.openGuildbossResultWindow(!1)}.bind(this),2),Utils.onTouchEnd(this.harm_btn,function(){this.data&&null!=Utils.next(this.data)&&t("battle_controller").getInstance().openBattleHarmInfoView(!0,this.data)}.bind(this),1)},openRootWnd:function(e){if(this.handleEffect(!0),null!=e){this.data=e,this.dps_value_lb.string=cc.js.formatStr(Utils.TI18N("\u603b\u4f24\u5bb3\uff1a%s"),e.all_dps);var i=t("hero_controller").getInstance().getModel().getHeroById(e.best_partner);this.partner_item.setData(i),this.createRewardsList(e.award_list),this.harm_btn.active=!0}},createRewardsList:function(t){var e=this;if(null!=t){var i=0,n=null,a=1,o="";for(var l in t){var r,c=t[l];if(n=Utils.getItemConfig(c.bid))(function(){i=36-50*(a-1);var t=Utils.createRichLabel(24,new cc.Color(53,255,20,255),cc.v2(0,.5),cc.v2(-100,i),null,500,e.container);t.horizontalAlign=cc.macro.TextAlignment.LEFT,o=n.id==Config.item_data.data_assets_label2id.guild?Utils.TI18N("\u8d21\u732e"):n.name,t.string=cc.js.formatStr("%s%s\uff1a<img src='%s' scale=0.4 /> +%s",Utils.TI18N("\u83b7\u5f97"),o,n.icon,c.num),r=s.getItemRes(n.icon),e.loadRes(r,function(e){t.spriteFrame=e}.bind(e)),a+=1,e.label_list.push(t)})()}}},handleEffect:function(t){if(0==t)this.special_sk&&(this.special_sk.setToSetupPose(),this.special_sk.clearTracks());else if(this.special_sk){var e=cc.js.formatStr("spine/%s/action.atlas",s.getEffectRes(103));this.loadRes(e,function(t){this.special_sk.skeletonData=t,this.special_sk.setAnimation(1,PlayerAction.action_2,!1)}.bind(this))}},closeCallBack:function(){if(this.ctrl.openGuildbossResultWindow(!1),this.handleEffect(!1),this.partner_item&&(this.partner_item.deleteMe(),this.partner_item=null),this.label_list){for(var t in this.label_list){var e=this.label_list[t];e&&(e.node.destroy(),e=null)}this.label_list=null}}});cc._RF.pop()},{battle_controller:"battle_controller",guildboss_controller:"guildboss_controller",hero_controller:"hero_controller",pathtool:"pathtool"}],guildinit_window:[function(t,e,i){"use strict";cc._RF.push(e,"325ac7r+hZJoZGtiDdHDUpZ","guildinit_window");var s=t("guild_const"),n=t("pathtool");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=n.getPrefabPath("guild","guild_init_window"),this.viewTag=SCENE_TAG.ui,this.win_type=WinType.Full},initConfig:function(){this.panel_list={},this.tab_list={},this.normal_color=new cc.Color(211,180,155,255),this.normal_outlinecolor=new cc.Color(64,34,21,255),this.select_color=new cc.Color(255,255,255,255),this.select_outlinecolor=new cc.Color(109,53,7,255),this.controller=t("guild_controller").getInstance()},openCallBack:function(){this.background_nd=this.seekChild("background"),this.background_nd.scale=FIT_SCALE,this.loadRes(n.getBigBg("bigbg_2"),function(t){this.background_nd.getComponent(cc.Sprite).spriteFrame=t}.bind(this)),this.title_list=[Utils.TI18N("\u516c\u4f1a\u5217\u8868"),Utils.TI18N("\u521b\u5efa\u516c\u4f1a"),Utils.TI18N("\u67e5\u627e\u516c\u4f1a")];var t=this.seekChild("tab_container");this.win_title=this.seekChild("win_title",cc.Label),this.container=this.seekChild("container");for(var e=0;e<3;e++){var i={},s=e+1;i.btn=t.getChildByName("tab_btn_"+s),i.normal=i.btn.getChildByName("unselect_bg"),i.select=i.btn.getChildByName("select_bg"),i.title=i.btn.getChildByName("title").getComponent(cc.Label),i.title_outline=i.title.getComponent(cc.LabelOutline),i.title.string=this.title_list[e],i.index=s,this.tab_list[s]=i}},registerEvent:function(){var t=this,e=function(){var e=t.tab_list[i];e.btn&&e.btn.on(cc.Node.EventType.TOUCH_END,function(t){this.changeTabView(e.index)}.bind(t))};for(var i in this.tab_list)e()},openRootWnd:function(t){var e=t||1;this.changeTabView(e)},changeTabView:function(t){this.cur_index!=t&&(this.cur_tab&&(this.cur_tab.select.active=!1,this.cur_tab.title.node.color=this.normal_color,this.cur_tab.title_outline.color=this.normal_outlinecolor),this.cur_index=t,this.cur_tab=this.tab_list[t],this.cur_tab&&(this.cur_tab.select.active=!0,this.cur_tab.title.node.color=this.select_color,this.cur_tab.title_outline.color=this.select_outlinecolor),this.setPanelData())},setPanelData:function(){if(null!=this.cur_index){this.win_title.string=this.title_list[this.cur_index-1],null!=this.cur_panel&&(this.cur_panel.addToParent(!1),this.cur_panel=null);var e=this.cur_index,i=this.panel_list[e];if(null==i){if(e==s.init_type.create)i=new(t("guild_create_panel"));else if(e==s.init_type.list){i=new(t("guild_list_panel"))}else if(e==s.init_type.search){i=new(t("guild_search_panel"))}this.panel_list[e]=i,i.show(),null!=i&&i.setParent(this.container)}null!=i&&(i.addToParent(!0),this.cur_panel=i)}},closeCallBack:function(){for(var t in this.controller.openGuildInitWindow(!1),this.panel_list){var e=this.panel_list[t];e.deleteMe(),e=null}this.panel_list=null}});cc._RF.pop()},{guild_const:"guild_const",guild_controller:"guild_controller",guild_create_panel:"guild_create_panel",guild_list_panel:"guild_list_panel",guild_search_panel:"guild_search_panel",pathtool:"pathtool"}],guildskill_const:[function(t,e,i){"use strict";cc._RF.push(e,"daddbhnZUhEd5y3TPhgfWq3","guildskill_const");e.exports={index:{physics:3,magic:2,defence:4,assist:5},status:{un_activity:0,activity:1}},cc._RF.pop()},{}],guildskill_controller:[function(t,e,i){"use strict";cc._RF.push(e,"ec5e4GZ/kJJUZqoa4DyVHTD","guildskill_controller");var s=t("backpack_const"),n=t("guildskill_const"),a=t("role_controller"),o=cc.Class({extends:BaseController,ctor:function(){},initConfig:function(){var e=t("guildskill_model");this.model=new e,this.model.initConfig()},getModel:function(){return this.model},registerEvents:function(){null==this.backpack_init_event&&(this.backpack_init_event=gcore.GlobalEvent.bind(EventId.GET_ALL_DATA,function(t){t==s.Bag_Code.BACKPACK&&(this.role_vo=a.getInstance().getRoleVo(),null==this.role_vo?null==this.init_role_event&&(this.init_role_event=gcore.GlobalEvent.bind(EventId.EVT_ROLE_CREATE_SUCCESS,function(){gcore.GlobalEvent.unbind(this.init_role_event),this.role_vo=a.getInstance().getRoleVo(),this.role_vo&&this.registerRoleEvent()}.bind(this))):this.registerRoleEvent())}.bind(this)),null==this.re_link_game_event&&(this.login_event_success=gcore.GlobalEvent.bind(EventId.EVT_RE_LINK_GAME,function(){t("guide_controller").getInstance().isInGuide()||this.openGuildSkillMainWindow(!1),this.model.clearGuildCareerSkill(),this.requestInitProtocal()}.bind(this))))},registerRoleEvent:function(){this.requestInitProtocal(!0),null==this.role_assets_event&&(this.role_assets_event=this.role_vo.bind(EventId.UPDATE_ROLE_ATTRIBUTE,function(t,e){"gid"==t?this.requestInitProtocal():"guild"==t&&this.model.checkGuildSkillRedStatus()},this))},requestInitProtocal:function(){null!=this.role_vo&&(0!=this.role_vo.gid?this.SendProtocal(23703,{}):(this.openGuildSkillMainWindow(!1),this.model.clearGuildCareerSkill()))},registerProtocals:function(){this.RegisterProtocal(23700,this.handle23700),this.RegisterProtocal(23701,this.handle23701),this.RegisterProtocal(23702,this.handle23702),this.RegisterProtocal(23703,this.handle23703)},openGuildSkillMainWindow:function(t){0==t?null!=this.main_window&&(this.main_window.close(),this.main_window=null):(null==this.main_window&&(this.main_window=Utils.createClass("guildskill_main_window")),this.main_window.open())},requestCareerSkillInfo:function(t){t=t||n.index.physics;var e={};e.career=t,this.SendProtocal(23700,e)},handle23700:function(t){this.model.initGuildCareerSkill(t)},requestActivitySkill:function(t){var e={};e.skill_id=t,this.SendProtocal(23701,e)},handle23701:function(t){message(t.msg),1==t.code&&this.model.updateGuildCareerSkill(t.career,t.skill_id)},handle23702:function(t){this.model.upgradeGuildCareerSkill(t.career,t.group_id)},handle23703:function(t){this.model.initGuildSkillStatus(t)}});e.exports=o,cc._RF.pop()},{backpack_const:"backpack_const",guide_controller:"guide_controller",guildskill_const:"guildskill_const",guildskill_model:"guildskill_model",role_controller:"role_controller"}],guildskill_event:[function(t,e,i){"use strict";cc._RF.push(e,"0886f6RmqRNg4Z5qfGnKur9","guildskill_event"),e.exports={UpdateGuildSkillEvent:"UpdateGuildSkillEvent",UpdateSkillStatusEvent:"UpdateSkillStatusEvent",UpdateSkilUpgradeEvent:"UpdateSkilUpgradeEvent"},cc._RF.pop()},{}],guildskill_item:[function(t,e,i){"use strict";cc._RF.push(e,"b59f6RhApBBIbTwOxbFXzpb","guildskill_item");var s=t("pathtool"),n=t("viewclass"),a=t("partner_calculate"),o=cc.Class({extends:n,ctor:function(){this.node=arguments[0],this.attr_key=arguments[1],this.size=this.node.getContentSize();var t=gdata("attr_data","data_key_to_name",[this.attr_key])||"";this.attr_desc=this.node.getChildByName("attr_desc").getComponent(cc.RichText),this.attr_desc.string=cc.js.formatStr("<color=#68452A>%s</c> <color=#249004><size=26>%s</size></c>",t,Utils.TI18N("+0"));var e=s.getAttrIconByStr(this.attr_key),i=this.node.getChildByName("attr_icon").getComponent(cc.Sprite);this.attr_icon=i,this.loadRes(s.getCommonIcomPath(e),function(t){this.attr_icon.spriteFrame=t}.bind(this))},setData:function(t,e){t=t||0,this.attr_key=e;var i=gdata("attr_data","data_key_to_name",[this.attr_key])||"";this.attr_desc.string=cc.js.formatStr("<color=#68452A>%s</c> <color=#249004><size=26>%s</size></c>",i,Utils.TI18N("+0"));var n=s.getAttrIconByStr(this.attr_key);this.loadRes(s.getCommonIcomPath(n),function(t){this.attr_icon.spriteFrame=t}.bind(this)),1==a.isShowPerByStr(this.attr_key)?this.attr_desc.string=cc.js.formatStr("<color=#68452A>%s</c> <color=#249004><size=26>%s</size></c>",i,"+"+.1*t+"%"):this.attr_desc.string=cc.js.formatStr("<color=#68452A>%s</c> <color=#249004><size=26>%s</size></c>",i,"+"+t)},onDelete:function(){}});e.exports=o,cc._RF.pop()},{partner_calculate:"partner_calculate",pathtool:"pathtool",viewclass:"viewclass"}],guildskill_main_window:[function(t,e,i){"use strict";cc._RF.push(e,"0f5dfetmPZI+oE1UBgFLTXJ","guildskill_main_window");var s=t("pathtool"),n=t("guildskill_controller"),a=t("guildskill_event"),o=t("guildskill_const"),l=t("backpack_const"),r=t("backpack_controller"),c=t("guild_const"),_=t("role_controller"),h=t("guildskill_item"),d=t("guild_event"),u=t("partner_calculate"),m=cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("guildskill","guildskill_main_window"),this.win_type=WinType.Big,this.viewTag=SCENE_TAG.dialogue,this.ctrl=n.getInstance(),this.model=this.ctrl.getModel(),this.tab_list={},this.attr_list={},this.item_list={},this.singe_att_list={},this.attr_value_list={},this.cur_info_group_id=0,this.backpack_item_list={},this.upgrade_cost_list={},this.cur_index=1,this.role_vo=_.getInstance().getRoleVo()},openCallBack:function(){this.background=this.seekChild("background");var t=this.seekChild("main_panel");this.background.scale=FIT_SCALE,this.career_desc=this.seekChild(t,"career_desc",cc.RichText),this.close_btn=this.seekChild(t,"close_btn"),this.explain_btn=this.seekChild(t,"explain_btn"),this.cost_container=this.seekChild(t,"cost_container"),this.handle_btn=this.seekChild(t,"handle_btn"),this.handle_btn_label=this.seekChild(this.handle_btn,"label",cc.Label),this.handle_btn_label_outline=this.seekChild(this.handle_btn,"label",cc.LabelOutline),this.handle_btn_label.string=Utils.TI18N("\u70b9\u4eae"),this.condition_value=this.seekChild(this.cost_container,"condition_value",cc.Label);var e=this.seekChild(this.cost_container,"cost_node");e.active=!1,this.cost_item_icon=this.seekChild(e,"item_img"),this.cost_item_value=this.seekChild(e,"cost_value"),this.auto_buy_label=this.seekChild(t,"auto_buy_label",cc.RichText),this.auto_buy_label.node.active=!1;for(var i=this.seekChild(t,"tab_container"),s=1;s<5;s++){var n=i.getChildByName("tab_btn_"+s);if(n){var a=n.getChildByName("title").getComponent(cc.Label),o=n.getChildByName("tips");1==s?a.string=Utils.TI18N("\u6218\u58eb\u804c\u4e1a"):2==s?a.string=Utils.TI18N("\u6cd5\u5e08\u804c\u4e1a"):3==s?a.string=Utils.TI18N("\u5766\u514b\u804c\u4e1a"):4==s&&(a.string=Utils.TI18N("\u8f85\u52a9\u804c\u4e1a"));var l=this.getType(s);n.career=l,n.label=a,n.label.node.color=new cc.Color(207,181,147,255),n.tips=o,n.index=s,n.btn=n.getComponent(cc.Button),n.btn.interactable=!1,this.tab_list[l]=n}}this.scroll_view=this.seekChild(t,"scroll_view"),this.scroll_view_con=this.seekChild(this.scroll_view,"content");var r=this.scroll_view.getContentSize(),c=this.seekChild(t,"attr_container");c.active=!1;var _,d,u=gdata("guild_skill_data","data_const",["attr_show_"+this.cur_index]);if(u&&u.val){var m=Math.ceil(u.val.length/3),f=24*m+13*(m+1);for(var s in f=Math.max(f,r.height),u.val){var p=u.val[s],g=cc.instantiate(c);g.active=!0;var v=new h(g,p);g.setParent(this.scroll_view_con),_=-r.width/2+s%3*190,d=-(19+37*Math.floor(s/3)),g.setPosition(_,d),this.attr_list[s]=v}}this.selected=this.seekChild(t,"selected"),CommonAction.breatheShineAction3(this.selected);for(s=1;s<7;s++){var b={},w=t.getChildByName("item_"+s).getComponent(cc.Sprite),y=t.getChildByName("item_lev_"+s).getComponent(cc.Label);w&&(b.node=w,b.lev=y,b.index=s,b.x=w.node.x,b.y=w.node.y,b.status=null,b.data=null,b.config=null,this.item_list[s]=b)}this.single_item_attr_container=this.seekChild(t,"single_item_attr_container");for(s=1;s<3;s++){(b={}).attr_title=this.single_item_attr_container.getChildByName("attr_title_"+s).getComponent(cc.Label),b.attr_value=this.single_item_attr_container.getChildByName("attr_value_"+s).getComponent(cc.Label),b.attr_title.node.active=!1,b.attr_value.node.active=!1,this.singe_att_list[s]=b}this.lev_upgrade_model=this.seekChild(t,"lev_upgrade_model"),this.main_panel=t},registerEvent:function(){for(var e in this.background&&this.background.on(cc.Node.EventType.TOUCH_END,function(){this.ctrl.openGuildSkillMainWindow(!1)},this),this.close_btn&&this.close_btn.on(cc.Node.EventType.TOUCH_END,function(){this.ctrl.openGuildSkillMainWindow(!1),Utils.playButtonSound(2)},this),this.explain_btn.on(cc.Node.EventType.TOUCH_END,function(e){var i=Config.guild_skill_data.data_const.game_rule;Utils.playButtonSound(1);var s=e.touch.getLocation();t("tips_controller").getInstance().showCommonTips(i.desc,s,null,null,500)},this),this.tab_list){this.tab_list[e].on(cc.Node.EventType.TOUCH_END,function(t){var e=t.currentTarget;this.changeSelectedTab(e.career,e.index)},this)}this.handle_btn.on(cc.Node.EventType.TOUCH_END,function(){if(this.selected_item&&this.selected_item.data){if(this.auto_buy_item_bid&&this.auto_buy_item_price&&this.auto_buy_item_price>0&&!this.auto_buy_label.active){var t=Utils.getItemConfig(this.auto_buy_item_bid);return r.getInstance().openTipsSource(!0,t),void message(Utils.TI18N("\u9053\u5177\u4e0d\u8db3\uff0c\u65e0\u6cd5\u70b9\u4eae"))}this.ctrl.requestActivitySkill(this.selected_item.data.id)}},this),this.addGlobalEvent(a.UpdateGuildSkillEvent,function(t){this.selected_tab&&this.selected_tab.career==t&&this.updateSkillList(t)},this),this.addGlobalEvent(a.UpdateSkillStatusEvent,function(t,e){this.selected_tab&&this.selected_tab.career==t&&this.updateSkillItemById(e)},this),this.addGlobalEvent(a.UpdateSkilUpgradeEvent,function(t,e){this.selected_tab&&this.selected_tab.career==t&&this.updateSkillList(t,!0)},this),this.addGlobalEvent(d.UpdateGuildRedStatus,function(t,e){this.updateGuildSkillRed(t,e)},this),this.addGlobalEvent(EventId.ADD_GOODS,function(t,e){t==l.Bag_Code.BACKPACK&&this.changeNeedItemInfo(e)},this),this.addGlobalEvent(EventId.MODIFY_GOODS_NUM,function(t,e){t==l.Bag_Code.BACKPACK&&this.changeNeedItemInfo(e)},this),this.role_vo&&null==this.update_role_assets_event&&(this.update_role_assets_event=this.role_vo.bind(EventId.UPDATE_ROLE_ATTRIBUTE,function(t,e){this.selected_item&&this.upgrade_cost_list&&(this.upgrade_cost_list.base_list&&this.upgrade_cost_list.base_list[t]?this.setUpgradeCostStatus(0):this.upgrade_cost_list.asset_list&&this.upgrade_cost_list.asset_list[t]&&this.setUpgradeCostStatus(1))},this))},openRootWnd:function(t){t=t||o.index.physics,this.changeSelectedTab(t,this.cur_index),this.updateGuildSkillRed()},updateGuildSkillRed:function(t,e){if(null==t)for(var i in this.tab_list){var s=this.tab_list[i];e=this.model.getRedStatus(s.career);s.tips&&(s.tips.active=e)}else if(t==c.red_index.skill_2){(s=this.tab_list[o.index.magic])&&s.tips&&(s.tips.active=e)}else if(t==c.red_index.skill_3){(s=this.tab_list[o.index.physics])&&s.tips&&(s.tips.active=e)}else if(t==c.red_index.skill_4){(s=this.tab_list[o.index.defence])&&s.tips&&(s.tips.active=e)}else if(t==c.red_index.skill_5){(s=this.tab_list[o.index.assist])&&s.tips&&(s.tips.active=e)}},changeSelectedTab:function(t,e){if(null==this.selected_tab||this.selected_tab.career!=t){this.cur_index=e,this.selected_tab&&(this.selected_tab.label.node.color=new cc.Color(207,181,147,255),this.selected_tab.btn.interactable=!1,this.selected_tab=null),this.selected_tab=this.tab_list[t],this.selected_tab&&(this.selected_tab.label.node.color=new cc.Color(255,237,214,255),this.selected_tab.btn.interactable=!0),null==this.model.getCareerSkillInfo(t)?this.ctrl.requestCareerSkillInfo(t):this.updateSkillList(t);var i=this.model.getCareerKey(t);this.model.updateGuildRedStatus(i,!1);var n="";for(var a in this.item_list){var o=this.item_list[a];n=cc.js.formatStr("guildskill_%s_%s",t,o.index),o.node&&this.loadRes(s.getUIIconPath("guildskill",n),function(t){o.node.spriteFrame=t}.bind(this))}}},updateSkillAttrNameAndVal:function(){var t="attr_show_"+this.cur_index,e=gdata("guild_skill_data","data_const",[t]);if(e&&e.val)for(var i in e.val){var s=e.val[i],n=this.attr_list[i];if(n){var a=s,o=this.attr_value_list[a];n.setData(o,a)}}},updateSkillItemById:function(t){if(null!=t){var e=[];for(var i in this.item_list){if((c=this.item_list[i]).data&&c.data.id==t&&c.node){if(c.status!=c.data.status){c.status=c.data.status;var s=c.status==o.status.activity;c.node.setMaterial(0,s?cc.Material.getBuiltinMaterial("2d-gray-sprite"):cc.Material.getBuiltinMaterial("2d-sprite"))}if(c.config)for(var i in c.config.attr_list){var n=c.config.attr_list[i];n instanceof Array&&n.length>=2&&(null==this.attr_value_list[n[0]]&&(this.attr_value_list[n[0]]=0),this.attr_value_list[n[0]]=this.attr_value_list[n[0]]+n[1],e.push(n[0]))}break}}if(this.updateSkillAttrNameAndVal(),this.selected_item&&this.selected_item.node){var a=this.selected_item.node.x,l=this.selected_item.node.y;this.handleUpgradeEffect(!0,cc.v2(a,l))}var r=0;if(this.cur_skill_info&&this.cur_skill_info.skill_ids){for(var i in this.cur_skill_info.skill_ids){var c;(c=this.cur_skill_info.skill_ids[i]).status==o.status.un_activity&&(0==r||r>c.index)&&(r=c.index)}this.changeSelectedItem(r,!0)}}},handleUpgradeEffect:function(t,e){if(0==t)null!=this.upgrade_effect&&(this.upgrade_effect.removeFromParent(),this.upgrade_effect=null);else{null==this.upgrade_effect&&this.main_panel}},handleLevUpgradeEffect:function(t){},updateSkillList:function(t,e){if(null!=t){var i=this.model.getCareerSkillInfo(t);if(i){if(this.cur_info_group_id==i.group_id)return;this.cur_info_group_id=i.group_id,this.cur_skill_info=i;var s=gdata("guild_skill_data","data_group",[Utils.getNorKey(t,i.group_id)]);if(null!=s){var n=this.model.getCareerGroupMax(t);this.career_desc.string=cc.js.formatStr("%s<color=#249003>(%s/%s)</c>",s.group_name,s.group_seq,n)}if(i.skill_ids){var a=0,l=null,r=null;for(var c in i.skill_ids){var _=i.skill_ids[c];if(l=this.item_list[_.index],r=gdata("guild_skill_data","data_info",[_.id]),l&&r){if(l.data=_,l.config=r,l.node&&l.status!=_.status){l.status=_.status;var h=_.status==o.status.activity;l.node.setMaterial(0,h?cc.Material.getBuiltinMaterial("2d-gray-sprite"):cc.Material.getBuiltinMaterial("2d-sprite"))}l.lev&&(l.lev.string=r.lev)}_.status==o.status.un_activity&&(0==a||a>_.index)&&(a=_.index)}0==Number(a)&&(a=1),this.changeSelectedItem(a,!0)}this.calculateTotalAttr()}1==e&&this.handleLevUpgradeEffect(!0)}},calculateTotalAttr:function(){if(null!=this.cur_skill_info){var t=[];if(this.cur_skill_info.group_ids&&Utils.next(this.cur_skill_info.group_ids))for(var e in this.cur_skill_info.group_ids){var i=this.cur_skill_info.group_ids[e],s=gdata("guild_skill_data","data_info_group",[i.group_id]);if(null==s)return;for(var n in s)t.push(s[n].id)}if(this.cur_skill_info.skill_ids&&Utils.next(this.cur_skill_info.skill_ids))for(var e in this.cur_skill_info.skill_ids){(i=this.cur_skill_info.skill_ids[e]).status==o.status.activity&&t.push(i.id)}var a=[];for(var e in t){i=t[e];var l=gdata("guild_skill_data","data_info",[i]);if(null!=l)for(var n in l.attr_list){var r=l.attr_list[n];null==a[r[0]]&&(a[r[0]]=0),a[r[0]]=a[r[0]]+r[1]}}this.attr_value_list=a,this.updateSkillAttrNameAndVal()}},changeSelectedItem:function(t,e){if((!this.selected_item||e||this.selected_item.index!=t)&&(this.selected_item=this.item_list[t],null!=this.selected_item)){this.selected_item.node&&this.selected.setPosition(this.selected_item.x,this.selected_item.y);var i=this.selected_item.config;if(i){var s=null,n=null;for(var a in i.attr_list){var o=i.attr_list[a];if(o instanceof Array&&o.length>=2){var l=this.singe_att_list[Number(a)+1];l&&(s=o[0],(n=gdata("attr_data","data_key_to_name",[s]))&&(l.attr_title.node.active=!0,l.attr_title.string=n,l.attr_value.node.active=!0,l.attr_value.string=o[1],1==u.isShowPerByStr(s)?l.attr_value.string="+"+.1*o[1]+"%":l.attr_value.string="+"+o[1]))}}this.setUpgradeCost()}}},setUpgradeCost:function(){if(null!=this.selected_item&&null!=this.selected_item.config&&null!=this.selected_item.data){var t=this.selected_item.config,e=this.selected_item.data;if(t.lev>=20&&e.status==o.status.activity)this.cost_container.active=!1,null==this.max_lev_label&&(self.max_lev_label=Utils.createLabel(28,175,null,338,96,Utils.TI18N("\u8be5\u6280\u80fd\u5df2\u6ee1\u7ea7!"),this.main_panel,0,cc.v2(.5,.5))),this.max_lev_label.active=!0;else if(this.cost_container.active=!0,this.max_lev_label&&(this.max_lev_label.active=!1),t.loss){var i={};if(null==this.upgrade_cost_list&&(this.upgrade_cost_list={}),this.upgrade_cost_list.base_list={},this.upgrade_cost_list.item_list={},this.upgrade_cost_list.asset_list={},i&&i[0]&&i[1])Utils.getItemConfig(i[0]),(c=gdata("item_data","data_assets_id2label",[i[0]]))&&(this.upgrade_cost_list.base_list[c]={need_num:i[1],condition_status:!1,item:self.cost_item_value});for(var s in this.backpack_item_list)this.backpack_item_list[s].setVisible(!1);var n=1,a=94;for(var l in t.loss){var r=t.loss[l];if(null!=r[0]&&null!=r[1]){var c,_=this.backpack_item_list[n];null==_&&((_=ItemsPool.getInstance().getItem("backpack_item")).initConfig(!1,1,!1,!1),_.show(),this.backpack_item_list[n]=_,_.setParent(this.cost_container),a=(n-1)*(BackPackItem.Width+28)-300+.5*BackPackItem.Width,_.setPosition(a,80),_.setNumBgPos(cc.v2(0,-74),cc.v2(.5,.5),cc.v2(0,0),cc.v2(.5,.5))),_.setData({bid:r[0],num:0}),_.setVisible(!0),n+=1,null!=(c=gdata("item_data","data_assets_id2label",[r[0]]))?this.upgrade_cost_list.asset_list[c]={need_num:r[1],condition_status:!1,item:_}:this.upgrade_cost_list.item_list[r[0]]={need_num:r[1],condition_status:!1,item:_}}}this.setUpgradeCostStatus()}}},setUpgradeCostStatus:function(t){for(var e in this.upgrade_cost_list.base_list){if((s=this.upgrade_cost_list.base_list[e]).need_num&&s.item)(i=this.role_vo[e]||0)>=s.need_num?(s.condition_status=!0,s.item.color=new cc.Color(104,69,42,255)):(s.condition_status=!1,s.item.color=new cc.Color(217,80,20,255)),s.item.string=s.need_num}for(var e in this.upgrade_cost_list.asset_list){if((s=this.upgrade_cost_list.asset_list[e]).item&&s.item.setNeedNum){var i=this.role_vo[e]||0;s.item.setNeedNum(s.need_num,i),i<s.need_num?s.condition_status=!1:s.condition_status=!0}}for(var e in this.auto_buy_item_price=0,this.auto_buy_item_bid=0,this.upgrade_cost_list.item_list){var s;i=r.getInstance().getModel().getBackPackItemNumByBid(e);(s=this.upgrade_cost_list.item_list[e]).item&&s.item.setNeedNum&&(s.item.setNeedNum(s.need_num,i),i<s.need_num?(this.auto_buy_item_price=this.auto_buy_item_price+this.getItemPrice(e)*(s.need_num-i),this.auto_buy_item_bid=e,s.condition_status=!0):s.condition_status=!0)}this.checkUpgradeCostStatus()},getItemPrice:function(t){for(var e in Config.exchange_data.data_shop_exchange_guild){var i=Config.exchange_data.data_shop_exchange_guild[e];if(i.item_bid==t)return i.price}return 0},checkUpgradeCostStatus:function(){if(null!=this.upgrade_cost_list&&null!=this.selected_item&&null!=this.selected_item.config){var t=this.selected_item.config,e=!0;for(var i in this.upgrade_cost_list){var s=this.upgrade_cost_list[i];for(var n in s){if(0==s[n].condition_status){e=!1;break}}}var a=0;a=this.role_vo.guild_lev>=t.guild_lev?0==e?1:2:3,this.condition_type!=a&&(this.condition_type=a,1==a?(this.condition_value.active=!1,Utils.setGreyButton(this.handle_btn),this.handle_btn_label_outline.enabled=!1,Utils.setGreyButton(this.handle_btn.getComponent(cc.Button)),this.handle_btn_label.string=Utils.TI18N("\u6d88\u8017\u4e0d\u8db3")):2==a?(this.condition_value.active=!1,Utils.setGreyButton(this.handle_btn,!1),this.handle_btn_label_outline.enabled=!0,Utils.setGreyButton(this.handle_btn.getComponent(cc.Button),!1),this.handle_btn_label_outline.color=new cc.Color(196,90,20,255),this.handle_btn_label.string=Utils.TI18N("\u70b9\u4eae")):3==a&&(this.condition_value.active=!0,this.condition_value.string=cc.js.formatStr(Utils.TI18N("\u9700\u8981\u516c\u4f1a\u5230\u8fbe%s\u7ea7"),t.guild_lev),Utils.setGreyButton(this.handle_btn,!0),this.handle_btn_label_outline.enabled=!1,Utils.setGreyButton(this.handle_btn.getComponent(cc.Button)),this.handle_btn_label.string=Utils.TI18N("\u6761\u4ef6\u4e0d\u8db3"))),this.updateAutoBuyInfo()}},updateAutoBuyInfo:function(){},changeNeedItemInfo:function(t){if(null!=this.upgrade_cost_list&&null!=this.upgrade_cost_list.item_list&&null!=t&&null!=Utils.next(t)){var e={};for(var i in t){var s=t[i];s.base_id&&(e[s.base_id]=!0)}var n=!1;for(var a in this.auto_buy_item_price=0,this.upgrade_cost_list.item_list)if(1==e[a]){n=!0;var o=r.getInstance().getModel().getBackPackItemNumByBid(a);v.item&&v.item.setNeedNum&&(v.item.setNeedNum(v.need_num,o),o<v.need_num?(this.auto_buy_item_price=this.auto_buy_item_price+this.getItemPrice(a)*(v.need_num-o),v.condition_status=!0):v.condition_status=!0)}1==n&&this.checkUpgradeCostStatus()}},getType:function(t){return 1==t?o.index.physics:2==t?o.index.magic:3==t?o.index.defence:4==t?o.index.assist:void 0},closeCallBack:function(){for(var t in this.ctrl.openGuildSkillMainWindow(!1),this.handleUpgradeEffect(!1),this.handleLevUpgradeEffect(!1),this.fight_label&&(this.fight_label.deleteMe(),this.fight_label=null),this.backpack_item_list)this.backpack_item_list[t].deleteMe(),this.backpack_item_list[t]=null;this.backpack_item_list={},this.role_vo&&null!=this.update_role_assets_event&&(this.role_vo.unbind(this.update_role_assets_event),this.update_role_assets_event=null)}});e.exports=m,cc._RF.pop()},{backpack_const:"backpack_const",backpack_controller:"backpack_controller",guild_const:"guild_const",guild_event:"guild_event",guildskill_const:"guildskill_const",guildskill_controller:"guildskill_controller",guildskill_event:"guildskill_event",guildskill_item:"guildskill_item",partner_calculate:"partner_calculate",pathtool:"pathtool",role_controller:"role_controller",tips_controller:"tips_controller"}],guildskill_model:[function(t,e,i){"use strict";cc._RF.push(e,"8fcedmpqCNCGZm7xYbxB3ZO","guildskill_model");var s=t("guildskill_const"),n=t("guildskill_event"),a=t("role_controller"),o=t("backpack_controller"),l=t("guild_const"),r=t("mainui_const"),c=t("mainui_controller"),_=t("guild_event");cc.Class({extends:BaseClass,ctor:function(){this.ctrl=t("guildskill_controller").getInstance(),this.initConfig()},properties:{},initConfig:function(){this.career_skill_list={},this.skill_wait_upgrade_list={},this.skill_upgrade_cost_list={},this.skill_red_status_list={},this.had_send_mainui=!1,this.had_close_mainui=!1},clearGuildCareerSkill:function(){this.career_skill_list={},this.skill_wait_upgrade_list={},this.skill_upgrade_cost_list={},this.skill_red_status_list={}},initGuildCareerSkill:function(t){if(null!=t&&null!=t.group_id){var e=Config.guild_skill_data.data_info_group[t.group_id];if(null==e)cc.log("\u516c\u4f1a\u6280\u80fd\u914d\u7f6e\u6570\u636e\u6709\u95ee\u9898\uff0c\u6280\u80fd\u7ec4id\u4e3a\uff1a",t.group_id);else{var i={};for(var a in i.career=t.career,i.group_id=t.group_id,i.group_ids=t.group_ids,i.skill_ids=[],e){var o=e[a];i.skill_ids.push({id:o.id,index:o.seq,status:s.status.un_activity})}for(var a in t.skill_ids){o=t.skill_ids[a];for(var l in i.skill_ids){var r=i.skill_ids[l];if(o.skill_id==r.id){r.status=s.status.activity;break}}}Utils.next(i.skill_ids)&&i.skill_ids.sort(function(t,e){return t.index<e.index}),this.career_skill_list[t.career]=i,gcore.GlobalEvent.fire(n.UpdateGuildSkillEvent,t.career)}}},getCareerSkillInfo:function(t){return this.career_skill_list[t]},updateGuildCareerSkill:function(t,e){if(null!=t&&null!=e){var i=this.career_skill_list[t];if(i&&i.skill_ids){for(var a in i.skill_ids){var o=i.skill_ids[a];if(o.id==e){o.status=s.status.activity;break}}var l=0;for(var r in i.skill_ids){var c=i.skill_ids[r];if(c.status==s.status.un_activity){l=c.id;break}}this.updateGuildSkillStatus(t,l),gcore.GlobalEvent.fire(n.UpdateSkillStatusEvent,t,e)}}},upgradeGuildCareerSkill:function(t,e){if(null!=t&&null!=e){var i=this.career_skill_list[t];if(null==i&&((i={}).group_ids=[],this.career_skill_list[t]=i),i.group_ids&&i.group_ids.push({group_id:i.group_id}),i.career=t,i.group_id!=e){i.group_id=e,i.skill_ids=[];var a=Config.guild_skill_data.data_info_group[e];if(null==a)return void cc.log("\u66f4\u65b0\u6280\u80fd\u7ec4\u51fa\u9519\uff0c\u914d\u7f6e\u6570\u636e\u6709\u95ee\u9898\uff0c\u6280\u80fd\u7ec4id\u4e3a\uff1a",e);for(var o in a){var l=a[o];i.skill_ids.push({id:l.id,index:l.seq,status:s.status.un_activity})}Utils.next(i.skill_ids)&&i.skill_ids.sort(function(t,e){return t.index<e.index})}var r=0;for(var c in i.skill_ids){if((l=i.skill_ids[c]).status==s.status.un_activity){r=l.id;break}}this.updateGuildSkillStatus(t,r),gcore.GlobalEvent.fire(n.UpdateSkilUpgradeEvent,t,e)}},getCareerGroupMax:function(t){if(t=t||s.index.physics,null==this.career_group_max&&(this.career_group_max={}),null==this.career_group_max[t]){var e=gdata("guild_skill_data","data_career_list",[t]);this.career_group_max[t]=e?e.length:0}return this.career_group_max[t]},initGuildSkillStatus:function(t){if(t&&t.outline)for(var e in this.skill_wait_upgrade_list={},t.outline){var i=t.outline[e];this.skill_wait_upgrade_list[i.career]=i.skill_id}this.checkGuildSkillRedStatus()},updateGuildSkillStatus:function(t,e){null==this.skill_wait_upgrade_list&&(this.skill_wait_upgrade_list={}),this.skill_wait_upgrade_list[t]=e,this.checkGuildSkillRedStatus()},checkGuildSkillRedStatus:function(){null!=this.skill_wait_upgrade_list&&null!=Utils.next(this.skill_wait_upgrade_list)&&RedMgr.getInstance().addCalHandler(function(){var t=a.getInstance().getRoleVo(),e=o.getInstance().getModel(),i={};for(var s in this.skill_wait_upgrade_list){var n=this.skill_wait_upgrade_list[s],l=gdata("guild_skill_data","data_info",[n]);if(l)if(i[s]=!0,l.guild_lev>t.guild_lev)i[s]=!1;else for(var r in l.loss||{}){var c=l.loss[r];if(null!=c[0]&&null!=c[1]){var _=c[0],h=c[1],d=Config.item_data.data_assets_id2label[_];if(d){if(h>t[d]){i[s]=!1;break}}else if(h>e.getBackPackItemNumByBid(_)){i[s]=!1;break}}}}for(var s in i){var u=this.getCareerKey(s);this.updateGuildRedStatus(u,i[s])}}.bind(this),RedIds.GuildSkill)},getCareerKey:function(t){return(t=t||s.index.physics)==s.index.magic?l.red_index.skill_2:t==s.index.physics?l.red_index.skill_3:t==s.index.defence?l.red_index.skill_4:t==s.index.assist?l.red_index.skill_5:l.red_index.skill_3},clearGuildSkillIconRed:function(){if(1!=this.had_close_mainui){this.had_close_mainui=!0;var t=!1;for(var e in this.skill_red_status_list){if(1==this.skill_red_status_list[e]){t=!0;break}}if(1==t){var i=[{bid:l.red_index.skill_2,status:!1},{bid:l.red_index.skill_3,status:!1},{bid:l.red_index.skill_4,status:!1},{bid:l.red_index.skill_5,status:!1}];c.getInstance().setBtnRedPoint(r.btn_index.guild,i)}}},updateGuildRedStatus:function(t,e){var i=Config.function_data.data_base;0!=c.getInstance().checkIsOpenByActivate(i[6].activate)&&(this.skill_red_status_list[t]!=e&&(this.skill_red_status_list[t]=e,0==this.had_send_mainui&&(this.had_send_mainui=!0,c.getInstance().setBtnRedPoint(r.btn_index.guild,{bid:t,status:e})),gcore.GlobalEvent.fire(_.UpdateGuildRedStatus,t,e)))},getRedStatus:function(t){var e=this.getCareerKey(t);return this.skill_red_status_list[e]},getRedTotalStatus:function(){for(var t in this.skill_red_status_list){if(1==this.skill_red_status_list[t])return!0}return!1},getCareerSkillLevel:function(t){if(this.career_skill_list[t]){for(var e=this.career_skill_list[t].skill_ids,i=6*this.career_skill_list[t].group_ids.length,n=0;n<e.length;++n){e[n].status==s.status.activity&&(i+=1)}return i}return-1}});cc._RF.pop()},{backpack_controller:"backpack_controller",guild_const:"guild_const",guild_event:"guild_event",guildskill_const:"guildskill_const",guildskill_controller:"guildskill_controller",guildskill_event:"guildskill_event",mainui_const:"mainui_const",mainui_controller:"mainui_controller",role_controller:"role_controller"}],guildwar_attk_look_item:[function(t,e,i){"use strict";function s(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}cc._RF.push(e,"13caaHHt+hLe7BPJZVu9ST5","guildwar_attk_look_item");var n=t("pathtool"),a=t("guildwar_event"),o=t("guildwar_const");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=n.getPrefabPath("guildwar","guildwar_attk_look_item")},initConfig:function(){this.ctrl=t("guildwar_controller").getInstance(),this.model=this.ctrl.getModel()},initPanel:function(){var t;this.container=this.seekChild("container"),this.build_sp=this.seekChild("build",cc.Sprite),this.name_lb=this.seekChild("name_label",cc.Label),this.attk_lb=this.seekChild("attk_label",cc.Label),this.tips_lb=this.seekChild("tips_label",cc.Label),this.tips_lb.string=Utils.TI18N("\u5df2\u8fbe\u88ab\u6311\u6218\u4e0a\u9650"),this.tips_lb_2=this.seekChild("tips_label_2",cc.Label),this.tips_lb_2.string=Utils.TI18N("\u6311\u6218\u5e9f\u589f\u63d0\u5347\u589e\u76ca"),this.confirm_btn=this.seekChild("confirm_btn"),this.confirm_btn_lb=this.seekChild(this.confirm_btn,"label",cc.Label);var e=(s(t={},1,3),s(t,2,2),s(t,3,1),t);this.star_list={};for(var i=1;i<4;i++){var n=this.seekChild("star_"+i);if(n){n.active=!1;var a=e[i];this.star_list[a]=n}}},registerEvent:function(){Utils.onTouchEnd(this.confirm_btn,function(){this.model.getGuildWarStatus()==o.status.settlement?message(Utils.TI18N("\u672c\u6b21\u516c\u4f1a\u6218\u5df2\u7ed3\u675f\u5566\uff0c\u4e0d\u80fd\u518d\u6311\u6218\u4e86\u54e6")):this.data&&this.ctrl.openAttkPositionWindow(!0,this.data.pos)}.bind(this),1)},setData:function(t){null!=this.data&&null!=this.update_self_event&&(this.data.unbind(this.update_self_event),this.update_self_event=null),null!=t&&(this.data=t,null==this.update_self_event&&(this.update_self_event=this.data.bind(a.UpdateGuildWarPositionDataEvent,function(){this.onShow()},this))),this.root_wnd&&this.onShow()},onShow:function(){if(null!=this.data){if(this.data.hp<=0){this.loadRes(n.getUIIconPath("guildwar","guildwar_1020"),function(t){this.build_sp.spriteFrame=t}.bind(this));var t=0,e=Config.guild_war_data.data_const.ruins_challange_limit;if(e&&(t=e.val),this.data.relic_def_count>=t?(this.tips_lb.node.active=!0,this.confirm_btn.active=!1,this.tips_lb_2.node.active=!1):(this.tips_lb.node.active=!1,this.confirm_btn.active=!0,this.tips_lb_2.node.active=!0),!this.special_sk){this.special_sk=this.seekChild("special_sk",sp.Skeleton);var i=cc.js.formatStr("spine/%s/action.atlas",n.getEffectRes(326));this.loadRes(i,function(t){this.special_sk.skeletonData=t,this.special_sk.setAnimation(1,PlayerAction.action,!0)}.bind(this))}this.special_sk.node.active=!0}else this.loadRes(n.getUIIconPath("guildwar","guildwar_1017"),function(t){this.build_sp.spriteFrame=t}.bind(this)),this.tips_lb.node.active=!1,this.confirm_btn.active=!0,this.tips_lb_2.node.active=!1,this.special_sk&&(this.special_sk.node.active=!1);for(var s=1;s<4;s++){var a=this.star_list[s];this.data.hp<s?a.active=!0:a.active=!1}this.name_lb.string=cc.js.formatStr(Utils.TI18N("\u6240\u5c5e\u73a9\u5bb6\uff1a%s"),this.data.name),this.attk_lb.string=cc.js.formatStr(Utils.TI18N("\u6218\u529b\uff1a%s"),this.data.power)}},suspendAllActions:function(){null!=this.data&&(null!=this.update_self_event&&(this.data.unbind(this.update_self_event),this.update_self_event=null),this.data=null)},onHide:function(){},onDelete:function(){this.special_sk&&(this.special_sk.setToSetupPose(),this.special_sk.clearTracks()),this.suspendAllActions()}});cc._RF.pop()},{guildwar_const:"guildwar_const",guildwar_controller:"guildwar_controller",guildwar_event:"guildwar_event",pathtool:"pathtool"}],guildwar_attk_look_window:[function(t,e,i){"use strict";cc._RF.push(e,"60bd8SHiQ1BW7yyOb7siMG6","guildwar_attk_look_window");var s=t("pathtool"),n=t("common_scrollview"),a=t("guildwar_attk_look_item");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("guildwar","guildwar_attk_look_window"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Big},initConfig:function(){this.ctrl=t("guildwar_controller").getInstance(),this.model=this.ctrl.getModel()},openCallBack:function(){this.background=this.seekChild("background"),this.background.scale=FIT_SCALE,this.challenge_lb=this.seekChild("challenge_label",cc.Label),this.close_btn=this.seekChild("close_btn"),this.confirm_btn=this.seekChild("confirm_btn"),this.confirm_btn_lb=this.seekChild(this.confirm_btn,"label",cc.Label),this.list_panel=this.seekChild("list_panel");var t=this.list_panel.getContentSize(),e={item_class:a,start_x:0,space_x:0,start_y:0,space_y:0,item_width:616,item_height:124,row:0,col:1,need_dynamic:!0};this.box_scrollview=new n,this.box_scrollview.createScroll(this.list_panel,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,t,e,cc.v2(.5,.5))},registerEvent:function(){Utils.onTouchEnd(this.background,function(){this.ctrl.openAttkLookWindow(!1)}.bind(this),2),Utils.onTouchEnd(this.close_btn,function(){this.ctrl.openAttkLookWindow(!1)}.bind(this),2),Utils.onTouchEnd(this.confirm_btn,function(){this.ctrl.openAttkLookWindow(!1)}.bind(this),2)},openRootWnd:function(t){this.setData()},setData:function(){var t=this.model.getGuildWarChallengeCount(),e=Config.guild_war_data.data_const.challange_time_limit.val;this.challenge_lb.string=cc.js.formatStr(Utils.TI18N("\u6311\u6218\u6b21\u6570\uff1a%s/%s"),e-t,e);var i=this.model.getEnemyGuildWarPositionList();i.sort(function(t,e){return t.hp==e.hp?t.pos-e.pos:e.hp-t.hp}),this.box_scrollview.setData(i)},closeCallBack:function(){this.box_scrollview&&(this.box_scrollview.deleteMe(),this.box_scrollview=null),this.ctrl.openAttkLookWindow(!1)}});cc._RF.pop()},{common_scrollview:"common_scrollview",guildwar_attk_look_item:"guildwar_attk_look_item",guildwar_controller:"guildwar_controller",pathtool:"pathtool"}],guildwar_attk_position_window:[function(t,e,i){"use strict";function s(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}cc._RF.push(e,"29eda5kpwJIKoQNdDJemO2s","guildwar_attk_position_window");var n=t("pathtool"),a=t("partner_calculate"),o=t("guildwar_battle_array_panel");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=n.getPrefabPath("guildwar","guildwar_attk_position_window"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Big},initConfig:function(){this.ctrl=t("guildwar_controller").getInstance(),this.model=this.ctrl.getModel(),this.star_list={},this.color_1=new cc.Color(36,144,3,255),this.color_2=new cc.Color(217,80,20,255),this.color_3=new cc.Color(255,255,255,255),this.item_list={},this.star_list_3={},this.star_list_2={}},openCallBack:function(){var t;this.background=this.seekChild("background"),this.container=this.seekChild("container"),this.background.scale=FIT_SCALE;var e=this.seekChild("top_panel");this.pos_panel=this.seekChild("pos_panel"),this.buff_panel=this.seekChild("buff_panel"),this.buff_panel.active=!1;var i=this.pos_panel,n=this.buff_panel;this.defend_lb=this.seekChild(e,"defend_label",cc.Label),this.check_def_label_nd=this.seekChild(e,"check_def_label");for(var a=(s(t={},1,3),s(t,2,2),s(t,3,1),t),o=1;o<=3;o++){if(r=this.seekChild(e,"star_"+o)){r.active=!1;var l=a[o];this.star_list[l]=r}}this.close_btn=this.seekChild("close_btn"),this.easy_btn=this.seekChild(this.pos_panel,"easy_btn"),this.com_btn=this.seekChild(i,"com_btn"),this.diff_btn=this.seekChild(i,"diff_btn"),this.com_btn_sp=this.com_btn.getComponent(cc.Sprite),this.com_btn_label=this.seekChild(this.com_btn,"label"),this.diff_btn_sp=this.diff_btn.getComponent(cc.Sprite),this.diff_btn_label=this.seekChild(this.diff_btn,"label"),this.tips_lb=this.seekChild("tips_label",cc.Label),this.award_bg_nd=this.seekChild("image_2"),this.count_lb=this.seekChild("count_label",cc.Label),this.easy_lb=this.seekChild("easy_label",cc.Label),this.easy_coe_lb=this.seekChild(i,"easy_coe_label",cc.Label),this.com_lb=this.seekChild(i,"com_label",cc.Label),this.com_coe_lb=this.seekChild(i,"com_coe_label",cc.Label),this.diff_lb=this.seekChild(i,"diff_label",cc.Label),this.diff_coe_lb=this.seekChild(i,"diff_coe_label",cc.Label),this.good_con=this.seekChild("good_con"),this.challenge_btn=this.seekChild(n,"challenge_btn"),this.challenge_btn_btn=this.challenge_btn.getComponent(cc.Button),this.buff_count_lb=this.seekChild(n,"buff_count_label",cc.Label),this.lv_label_lb=this.seekChild(n,"lv_label",cc.Label),this.progress_pb=this.seekChild(n,"progress",cc.ProgressBar),this.image_com_sp=this.seekChild("image_com",cc.Sprite),this.image_dif_sp=this.seekChild("image_dif",cc.Sprite);for(o=1;o<=2;o++){if(r=this.seekChild(this.image_com_sp.node,"star_"+o,cc.Sprite)){r.active=!1;l=a[o];this.star_list_2[l]=r}}for(o=1;o<=3;o++){var r;if(r=this.seekChild(this.image_dif_sp.node,"star_"+o,cc.Sprite)){r.active=!1;l=a[o];this.star_list_3[l]=r}}this.attr_panel={};for(o=1;o<=6;o++){var c=this.seekChild(n,"attr_panel_"+o);c&&(c.attr_label=c.getChildByName("attr_label").getComponent(cc.Label),c.attr_value_1_lb=c.getChildByName("attr_value_1").getComponent(cc.Label),c.attr_value_2_lb=c.getChildByName("attr_value_2").getComponent(cc.Label),c.attr_iamge_nd=c.getChildByName("image"),this.attr_panel[o]=c)}},registerEvent:function(){this.check_def_label_nd.on(cc.Node.EventType.TOUCH_END,function(){if(this.data&&this.data.pos){var t=this.model.getEnemyGuildWarBaseInfo();this.ctrl.openDefendLookWindow(!0,t.g_id,t.g_sid,this.data.pos)}},this),Utils.onTouchEnd(this.background,function(){this.ctrl.openAttkPositionWindow(!1)}.bind(this),2),Utils.onTouchEnd(this.close_btn,function(){this.ctrl.openAttkPositionWindow(!1)}.bind(this),2),Utils.onTouchEnd(this.easy_btn,function(){this.data&&this.data.pos&&this.ctrl.requestGuildWarFighting(this.data.pos,1,0)}.bind(this),1),this.com_btn.on("click",function(){this.data&&this.data.pos&&this.ctrl.requestGuildWarFighting(this.data.pos,2,0),Utils.playButtonSound(1)},this),this.diff_btn.on("click",function(){this.data&&this.data.pos&&this.ctrl.requestGuildWarFighting(this.data.pos,3,0),Utils.playButtonSound(1)},this),this.challenge_btn.on("click",function(){if(this.model.checkEnemyIsHaveLivePosition()){var e=function(){this.ctrl.requestGuildWarFighting(this.data.pos,0,1)}.bind(this),i=cc.js.formatStr(Utils.TI18N("\u6311\u6218\u5e9f\u589f\u83b7\u5f97\u7684\u6218\u7ee9\u5c06\u5927\u5927\u51cf\u5c11\uff0c\u63a8\u8350\u4f18\u5148\u6311\u6218\u5176\u4ed6\u672a\u6ca6\u9677\u7684\u636e\u70b9\uff0c\u8bf7\u95ee\u662f\u5426\u7ee7\u7eed\u6311\u6218\u5e9f\u589f\uff1f"));t("commonalert").show(i,Utils.TI18N("\u786e\u5b9a"),e,Utils.TI18N("\u53d6\u6d88"),null,1)}else this.ctrl.requestGuildWarFighting(this.data.pos,0,1);Utils.playButtonSound(1)},this)},openRootWnd:function(t){this.ctrl.requestEnemyPositionData(t)},setData:function(t){this.data=t,this.pos_panel.active=t.hp>0,this.buff_panel.active=t.hp<=0;var e=t.power||0;if(t.hp>0){if(1==t.hp){for(var i in this.image_com_sp.setMaterial(0,cc.Material.getBuiltinMaterial("2d-gray-sprite")),this.image_dif_sp.setMaterial(0,cc.Material.getBuiltinMaterial("2d-gray-sprite")),this.com_btn_sp.setMaterial(0,cc.Material.getBuiltinMaterial("2d-gray-sprite")),this.diff_btn_sp.setMaterial(0,cc.Material.getBuiltinMaterial("2d-gray-sprite")),this.com_btn_label.color=this.color_3,this.diff_btn_label.color=this.color_3,this.star_list_2)this.star_list_2[i]&&this.star_list_2[i].setMaterial(0,cc.Material.getBuiltinMaterial("2d-gray-sprite"));for(var i in this.star_list_3)this.star_list_3[i]&&this.star_list_3[i].setMaterial(0,cc.Material.getBuiltinMaterial("2d-gray-sprite"))}else if(2==t.hp)for(var i in this.image_dif_sp.setMaterial(0,cc.Material.getBuiltinMaterial("2d-gray-sprite")),this.diff_btn_sp.setMaterial(0,cc.Material.getBuiltinMaterial("2d-gray-sprite")),this.diff_btn_label.color=this.color_3,this.star_list_3)this.star_list_3[i]&&this.star_list_3[i].setMaterial(0,cc.Material.getBuiltinMaterial("2d-gray-sprite"));var s=Config.guild_war_data.data_const.easy_difficulty;this.easy_coe_lb.string=s.val/10+"%"+Utils.TI18N("\u96be\u5ea6");var n=Config.guild_war_data.data_const.normal_difficulty;this.com_coe_lb.string=n.val/10+"%"+Utils.TI18N("\u96be\u5ea6");var l=Config.guild_war_data.data_const.hard_difficulty;this.diff_coe_lb.string=l.val/10+"%"+Utils.TI18N("\u96be\u5ea6");var r=Config.guild_war_data.data_position[t.pos];if(r){var c=r.warscore[0][1]||0;this.easy_lb.string=cc.js.formatStr(Utils.TI18N("+%s\u6218\u7ee9"),Math.ceil(c));var _=r.warscore[1][1]||0;this.com_lb.string=cc.js.formatStr(Utils.TI18N("+%s\u6218\u7ee9"),Math.ceil(_));var h=r.warscore[2][1]||0;this.diff_lb.string=cc.js.formatStr(Utils.TI18N("+%s\u6218\u7ee9"),Math.ceil(h))}this.award_bg_nd.setContentSize(560,190),this.tips_lb.string=Utils.TI18N("\u96be\u5ea6\u8d8a\u9ad8\uff0c\u654c\u65b9\u5c5e\u6027\u52a0\u6210\u8d8a\u9ad8")}else{this.award_bg_nd.setContentSize(560,160),this.tips_lb.string=Utils.TI18N("\u6311\u6218\u6210\u529f\u53ef\u589e\u5f3a\u516c\u4f1a\u589e\u76ca");var d=this.model.getMyGuildWarBaseInfo().buff_lev||0,u=Config.guild_war_data.data_buff_length;this.progress_pb.progress=d/u,this.lv_label_lb.string=cc.js.formatStr("%s/%s",d,u);var m=Config.guild_war_data.data_buff[d]||{},f=Config.guild_war_data.data_buff[d+1]||{};m.attr=m.attr||{},f.attr=f.attr||{};for(i=0;i<6;i++){var p=this.attr_panel[i+1];if(m.attr[i]||f.attr[i]){p.active=!0;var g=m.attr[i]||f.attr[i],v=Config.attr_data.data_key_to_name[g[0]],b=0;m.attr[i]&&(b=m.attr[i][1]);var w=null;f.attr[i]&&(w=f.attr[i][1]),p.attr_label.string=v;var y=a.isShowPerByStr(g[0]);y&&(b=b/10+"%"),p.attr_value_1_lb.string=b,w?(y&&(w=w/10+"%"),p.attr_value_2_lb.string=w,p.attr_value_2_lb.node.active=!0,p.attr_iamge_nd.active=!0):(p.attr_value_2_lb.node.active=!1,p.attr_iamge_nd.active=!1)}else p.active=!1}var C=0,k=Config.guild_war_data.data_const.ruins_challange_limit;k&&(C=k.val);var S=t.relic_def_count||0,T=C-S;T<0&&(T=0),this.buff_count_lb.node.color=T>0?this.color_1:this.color_2,this.buff_count_lb.string=cc.js.formatStr("%s/%s",T,C),S>=C&&Utils.setGreyButton(this.challenge_btn_btn)}for(i=1;i<4;i++){var I=this.star_list[i];I&&i>t.hp?I.active=!0:I.active=!1}this.defend_lb.string=cc.js.formatStr(Utils.TI18N("\u5df2\u6210\u529f\u9632\u5fa1%s\u6b21"),t.def_count||0);var E=Config.guild_war_data.data_const.win_strongholds_reward_hard;if(E&&E.val){var B=E.val.length,x=1;for(var P in E.val){var R=E.val[P],N=R[0],U=R[1];if(Utils.getItemConfig(N)){var A=this.item_list[P];A||((A=ItemsPool.getInstance().getItem("backpack_item")).initConfig(!1,.8,!1,!0),this.item_list[P]=A,A.setParent(this.good_con),A.show()),A.setData({bid:N,num:U}),A.setPosition(110*x-110*B/2-55,0)}x+=1}}var D=this.model.getGuildWarChallengeCount(),L=Config.guild_war_data.data_const.challange_time_limit.val,F=L-D;F<0&&(F=0),this.count_lb.node.color=F>0?this.color_1:this.color_2,this.count_lb.string=cc.js.formatStr("%s/%s",F,L),this.enemy_battle_array_panel||(this.enemy_battle_array_panel=new o,this.enemy_battle_array_panel.show(),this.enemy_battle_array_panel.setParent(this.container),this.enemy_battle_array_panel.setPosition(0,220));var M=[],G=[];for(var P in t.defense)G.push(t.defense[P]);M.partner_list=G,M.rid=t.rid,M.srv_id=t.srv_id,M.power=e,M.formation_type=t.formation_type,M.formation_lev=t.formation_lev,this.enemy_battle_array_panel.setData(M)},closeCallBack:function(){if(this.enemy_battle_array_panel&&(this.enemy_battle_array_panel.deleteMe(),this.enemy_battle_array_panel=null),this.item_list){for(var t in this.item_list){var e=this.item_list[t];e&&(e.deleteMe(),e=null)}this.item_list=null}this.ctrl.openAttkPositionWindow(!1)}});cc._RF.pop()},{commonalert:"commonalert",guildwar_battle_array_panel:"guildwar_battle_array_panel",guildwar_controller:"guildwar_controller",partner_calculate:"partner_calculate",pathtool:"pathtool"}],guildwar_award_box_item:[function(t,e,i){"use strict";cc._RF.push(e,"2bc87aFHBJOYol0HFhV/Kcp","guildwar_award_box_item");var s=t("pathtool"),n=t("guildwar_event"),a=t("guildwar_const");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("guildwar","guildwar_award_box_item")},initConfig:function(){this.ctrl=t("guildwar_controller").getInstance(),this.model=this.ctrl.getModel(),this.size=cc.size(206,218)},initPanel:function(){this.container=this.seekChild("container"),this.iamge_box_sp=this.seekChild("image_box",cc.Sprite),this.name_txt_lb=this.seekChild("name_txt",cc.Label),this.name_txt_lb.node.active=!1},registerEvent:function(){this.container.on(cc.Node.EventType.TOUCH_END,function(){null!=this.data&&this.ctrl.requestGetBoxAward(this.data.order)},this)},setData:function(t){null!=this.data&&null!=this.update_self_event&&(this.data.unbind(this.update_self_event),this.update_self_event=null),null!=t&&(this.data=t,null==this.update_self_event&&(this.update_self_event=this.data.bind(n.UpdateSingleBoxDataEvent,function(){this.onShow()},this))),this.root_wnd&&this.onShow()},onShow:function(){if(null!=this.data)if(0==this.data.rid)this.iamge_box_sp.node.active=!0,this.name_txt_lb.node.active=!1,this.item_node&&this.item_node.setVisible(!1),this.load_image_flag||(this.load_image_flag=!0,this.data.status==a.box_type.gold?this.loadRes(s.getUIIconPath("bigbg/guildwar","guildwar_3"),function(t){this.iamge_box_sp.spriteFrame=t}.bind(this)):this.data.status==a.box_type.copper&&this.loadRes(s.getUIIconPath("bigbg/guildwar","guildwar_4"),function(t){this.iamge_box_sp.spriteFrame=t}.bind(this)));else{this.iamge_box_sp.node.active=!1,this.name_txt_lb.node.active=!0,null==this.item_node&&(this.item_node=ItemsPool.getInstance().getItem("backpack_item"),this.item_node.initConfig(!1,1,!1,!0),this.item_node.setPosition(0,20),this.item_node.show(),this.item_node.setParent(this.container)),this.item_node.setVisible(!0),this.item_node.setData({bid:this.data.item_id,num:this.data.item_num}),this.name_txt_lb.string=this.data.name;var e=t("role_controller").getInstance().getRoleVo();this.data.rid==e.rid&&this.data.sid==e.srv_id&&(this.name_txt_lb.node.color=new cc.Color(36,144,3))}},onHide:function(){},suspendAllActions:function(){null!=this.data&&(null!=this.update_self_event&&(this.data.unbind(this.update_self_event),this.update_self_event=null),this.data=null)},onDelete:function(){this.item_node&&(this.item_node.deleteMe(),this.item_node=null),this.suspendAllActions()}});cc._RF.pop()},{guildwar_const:"guildwar_const",guildwar_controller:"guildwar_controller",guildwar_event:"guildwar_event",pathtool:"pathtool",role_controller:"role_controller"}],guildwar_award_box_window:[function(t,e,i){"use strict";cc._RF.push(e,"f9f85gsuRFP1bL+xjnN74p3","guildwar_award_box_window");var s=t("common_scrollview"),n=t("guildwar_event"),a=t("guildwar_const"),o=t("timetool"),l=t("guildwar_award_box_item"),r=t("pathtool");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=r.getPrefabPath("guildwar","guildwar_award_box_window"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Big},initConfig:function(){this.ctrl=t("guildwar_controller").getInstance(),this.model=this.ctrl.getModel()},openCallBack:function(){this.background=this.seekChild("background"),this.background.scale=FIT_SCALE;var t=this.seekChild("main_container");this.time_tips_lb=this.seekChild(t,"time_tips",cc.Label),this.tips_txt_lb=this.seekChild(t,"tips_txt",cc.Label),this.tips_txt_lb.string=Utils.TI18N("\u5b9d\u7bb1\u5728\u516c\u4f1a\u6218\u7ed3\u675f\u540e\u4ea7\u751f\uff0c\u6210\u5458\u6bcf\u4eba\u53ef\u5f00\u542f1\u6b21\uff0c\u8bd5\u8bd5\u4f60\u7684\u624b\u6c14\u5427\uff01"),this.title_label_lb=this.seekChild(t,"title_label",cc.Label),this.line_1_nd=this.seekChild(t,"line_1"),this.line_2_nd=this.seekChild(t,"line_2"),this.explain_btn=this.seekChild(t,"explain_btn"),this.preview_btn=this.seekChild(t,"preview_btn"),this.preview_btn.active=!1,this.no_box_image_nd=this.seekChild(t,"no_box_image");var e=this.seekChild(t,"box_list"),i=e.getContentSize(),n={item_class:l,start_x:0,space_x:6,start_y:0,space_y:6,item_width:206,item_height:218,row:0,col:3,need_dynamic:!0};this.box_scrollview=new s,this.box_scrollview.createScroll(e,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,i,n,cc.v2(.5,.5))},registerEvent:function(){Utils.onTouchEnd(this.background,function(){this.ctrl.openAwardBoxWindow(!1)}.bind(this),2),this.explain_btn.on(cc.Node.EventType.TOUCH_END,function(e){Utils.playButtonSound(1);var i=e.touch.getLocation();t("tips_controller").getInstance().showCommonTips(Config.guild_war_data.data_const.box_rule.desc,i)}),Utils.onTouchEnd(this.preview_btn,function(){this.ctrl.openAwardBoxPreview(!0)}.bind(this),1),this.addGlobalEvent(n.UpdateGuildWarBoxDataEvent,function(t){this.setData(t)},this),this.addGlobalEvent(n.UpdateMyAwardBoxEvent,function(){this.refreshTimeTips()},this)},openRootWnd:function(t){this.ctrl.requestAwardBoxData()},setData:function(t){if(t){this.data=t;var e=this.model.getGuildWarBoxData(),i=gcore.SmartSocket.getTime();this.data.end_time<=i||null==Utils.next(e)?(this.no_box_image_nd.active=!0,this.title_label_lb.node.active=!1,this.time_tips_lb.node.active=!1,this.line_1_nd.active=!1,this.line_2_nd.active=!1,this.box_scrollview.setVisible(!1),this.box_scrollview.setData([])):(this.no_box_image_nd.active=!1,this.title_label_lb.node.active=!0,this.time_tips_lb.node.active=!0,this.line_1_nd.active=!0,this.line_2_nd.active=!0,this.box_scrollview.setVisible(!0),this.refreshTimeTips(),this.data.result==a.box_type.gold?this.title_label_lb.string=Utils.TI18N("\u516c\u4f1a\u6218\u8363\u8000\u9ec4\u91d1\u5b9d\u7bb1"):this.title_label_lb.string=Utils.TI18N("\u516c\u4f1a\u6218\u6fc0\u52b1\u9752\u94dc\u5b9d\u7bb1"),this.box_scrollview.setData(e))}},refreshTimeTips:function(){if(this.data&&this.time_tips_lb)if(0==this.data.status)this.time_tips_lb.string=cc.js.formatStr(Utils.TI18N("\u60a8\u6b64\u524d\u5904\u4e8e\u4e0d\u6d3b\u8dc3\u72b6\u6001\uff0c\u4e0d\u53ef\u5f00\u542f\u5b9d\u7bb1")),this.time_tips_lb.node.color=new cc.Color(217,80,20),this.openBoxAwardTimer(!1);else if(this.model.checkIsGetBoxAward())this.time_tips_lb.string=cc.js.formatStr(Utils.TI18N("\u60a8\u5df2\u5f00\u542f\u8fc7\u5b9d\u7bb1")),this.time_tips_lb.node.color=new cc.Color(36,144,3),this.openBoxAwardTimer(!1);else{var t=gcore.SmartSocket.getTime(),e=this.data.end_time-t;e<0&&(e=0),this.time_tips_lb.string=cc.js.formatStr(Utils.TI18N("\u8bf7\u5728%s\u5185\u9886\u53d6\u5b9d\u7bb1"),o.getTimeFormat(e)),this.time_tips_lb.node.color=new cc.Color(36,144,3),this.openBoxAwardTimer(!0)}},openBoxAwardTimer:function(t){1==t?this.box_award_timer||(this.box_award_timer=gcore.Timer.set(function(){if(this.data){var t=gcore.SmartSocket.getTime(),e=this.data.end_time-t;e<0&&(e=0,gcore.Timer.del(this.box_award_timer),this.box_award_timer=null),this.time_tips_lb.string=cc.js.formatStr(Utils.TI18N("\u8bf7\u5728%s\u5185\u9886\u53d6\u5b9d\u7bb1"),o.getTimeFormat(e))}else gcore.Timer.del(this.box_award_timer),this.box_award_timer=null}.bind(this),1e3,-1)):null!=this.box_award_timer&&(gcore.Timer.del(this.box_award_timer),this.box_award_timer=null)},closeCallBack:function(){this.box_scrollview&&(this.box_scrollview.deleteMe(),this.box_scrollview=null),this.openBoxAwardTimer(!1),this.ctrl.openAwardBoxWindow(!1)}});cc._RF.pop()},{common_scrollview:"common_scrollview",guildwar_award_box_item:"guildwar_award_box_item",guildwar_const:"guildwar_const",guildwar_controller:"guildwar_controller",guildwar_event:"guildwar_event",pathtool:"pathtool",timetool:"timetool",tips_controller:"tips_controller"}],guildwar_award_item:[function(t,e,i){"use strict";cc._RF.push(e,"3f081JdCQZH8aKh6yQWRQZN","guildwar_award_item");var s=t("pathtool");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("guildwar","guilewar_award_list_item")},initConfig:function(){this.ctrl=t("guildwar_controller").getInstance(),this.model=this.ctrl.getModel(),this.item_list={}},initPanel:function(){this.main_container=this.seekChild("main_container"),this.image_sp=this.seekChild("image",cc.Sprite),this.range_lb=this.seekChild("rank_label_2",cc.Label),this.good_con=this.seekChild("good_con")},registerEvent:function(){},setData:function(t){this.data=t,this.root_wnd&&this.onShow()},onShow:function(t){if(null!=this.data){var e=this.data;1==e.num?(this.image_sp.node.active=!0,this.range_lb.node.active=!1,this.loadRes(s.getUIIconPath("common","common_2001"),function(t){this.image_sp.spriteFrame=t}.bind(this))):2==e.num?(this.image_sp.node.active=!0,this.range_lb.node.active=!1,this.loadRes(s.getUIIconPath("common","common_2002"),function(t){this.image_sp.spriteFrame=t}.bind(this))):3==e.num?(this.image_sp.node.active=!0,this.range_lb.node.active=!1,this.loadRes(s.getUIIconPath("common","common_2003"),function(t){this.image_sp.spriteFrame=t}.bind(this))):(this.image_sp.node.active=!1,this.range_lb.node.active=!0,this.range_lb.string=cc.js.formatStr("%s~%s",e.pre_num,e.num));var i=1;for(var n in e.award){var a=e.award[n],o=a[0],l=a[1];if(Utils.getItemConfig(o)){var r=this.item_list[n];r||((r=ItemsPool.getInstance().getItem("backpack_item")).initConfig(!1,.8,!1,!0),this.item_list[n]=r,r.setParent(this.good_con),r.show()),r.setData({bid:o,num:l}),r.setPosition(110*i-20,48),i+=1}}}},onHide:function(){},onDelete:function(){}});cc._RF.pop()},{guildwar_controller:"guildwar_controller",pathtool:"pathtool"}],guildwar_award_window:[function(t,e,i){"use strict";cc._RF.push(e,"9814bi6R+FFvq3hl39HKoHe","guildwar_award_window");var s=t("pathtool"),n=t("common_scrollview"),a=t("guildwar_award_item");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("guildwar","guildwar_award_list_panel"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Big},initConfig:function(){this.ctrl=t("guildwar_controller").getInstance(),this.model=this.ctrl.getModel()},openCallBack:function(){this.background=this.seekChild("background"),this.background.scale=FIT_SCALE,this.main_container=this.seekChild("main_container"),this.close_btn=this.seekChild("close_btn"),this.item_list=this.seekChild("item_list");var t=this.item_list.getContentSize(),e={item_class:a,start_x:0,space_x:0,start_y:0,space_y:-4,item_width:616,item_height:124,row:0,col:1,need_dynamic:!0};this.box_scrollview=new n,this.box_scrollview.createScroll(this.item_list,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,t,e,cc.v2(.5,.5))},registerEvent:function(){Utils.onTouchEnd(this.background,function(){this.ctrl.openGuildWarAwardWindow(!1)}.bind(this),2),Utils.onTouchEnd(this.close_btn,function(){this.ctrl.openGuildWarAwardWindow(!1)}.bind(this),2)},openRootWnd:function(t){this.setData()},setData:function(){var t=this.getGuildWarAwardData();for(var e in t){var i=t[e],s=1;t[e-1]&&(s=t[e-1].num+1),i.pre_num=s}this.box_scrollview.setData(t)},getGuildWarAwardData:function(){var t=[];for(var e in Config.guild_war_data.data_award){var i=Config.guild_war_data.data_award[e],s=Utils.deepCopy(i);t.push(s)}return t.sort(Utils.tableLowerSorter(["num"])),t},closeCallBack:function(){this.box_scrollview&&(this.box_scrollview.deleteMe(),this.box_scrollview=null),this.ctrl.openGuildWarAwardWindow(!1)}});cc._RF.pop()},{common_scrollview:"common_scrollview",guildwar_award_item:"guildwar_award_item",guildwar_controller:"guildwar_controller",pathtool:"pathtool"}],guildwar_battle_array_panel:[function(t,e,i){"use strict";cc._RF.push(e,"93b9fPfcwxMCYgP1CzKMsNg","guildwar_battle_array_panel");var s=t("pathtool"),n=t("hero_vo");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("guildwar","guildwar_battle_array_panel")},initConfig:function(){this.ctrl=t("guildwar_controller").getInstance(),this.model=this.ctrl.getModel(),this.hero_item_list=[]},initPanel:function(){this.container=this.seekChild("container"),this.bg_image_nd=this.seekChild("image_1"),this.title_bg_nd=this.seekChild("titile_bg"),this.form_image_sp=this.seekChild("form_image",cc.Sprite),this.form_label_lb=this.seekChild("form_label",cc.Label),this.scrollCon=this.seekChild("scrollCon"),this.power_cr=this.seekChild("power").getComponent("CusRichText"),this.scroll_view_nd=this.seekChild("scroll_view"),this.scroll_view_size=this.scroll_view_nd.getContentSize(),this.scroll_content=this.seekChild(this.scroll_view_nd,"content"),this.newsize&&this.setPanelContentSize(this.newsize)},registerEvent:function(){},setData:function(t,e){this.data=t,this.is_spec=e,this.root_wnd&&this.onShow()},onShow:function(t){if(null!=this.data){var e=this.data||{};this.power_cr.setNum(e.power||0);var i=[];for(var a in e.partner_list){var o=e.partner_list[a],l=new n;l.updateHeroVo(o),i.push(l)}var r=i.length,c=119*r*.87+6*r,_=Math.max(c,this.scroll_view_size.width);this.scroll_content.setContentSize(_,this.scroll_view_size.height);var h=1;for(var d in i){o=i[d];var u=ItemsPool.getInstance().getItem("hero_exhibition_item");u.setRootScale(.87),u.setPosition(-c/2-60+130*h*.87,0),u.show(),u.setData(o,null,this.is_spec),o.rare_type&&o.rare_type>0&&u.showRareType(o.rare_type),this.hero_item_list.push(u),u.setParent(this.scroll_content),h+=1}if(e.formation_type){var m=Config.formation_data.data_form_data[e.formation_type];if(m){e.formation_lev;this.form_label_lb.string=m.name}this.form_label_lb.node.active=!0,this.form_image_sp.node.active=!0,this.loadRes(s.getUIIconPath("form","form_icon_"+e.formation_type),function(t){this.form_image_sp.spriteFrame=t}.bind(this))}else this.form_label_lb.node.active=!1,this.form_image_sp.node.active=!1}},setPanelContentSize:function(t){this.root_wnd?(this.root_wnd.setContentSize(t),this.container.setContentSize(t),this.bg_image_nd.setContentSize(t),this.title_bg_nd.setContentSize(t.width-3,44)):this.newsize=t},onHide:function(){},onDelete:function(){if(this.hero_item_list){for(var t in this.hero_item_list){var e=this.hero_item_list[t];e&&(e.deleteMe(),e=null)}this.hero_item_list=null}}});cc._RF.pop()},{guildwar_controller:"guildwar_controller",hero_vo:"hero_vo",pathtool:"pathtool"}],guildwar_battle_list_item:[function(t,e,i){"use strict";cc._RF.push(e,"6e2e0ROgsxBppsk6d1sBiXp","guildwar_battle_list_item");var s=t("pathtool"),n=t("guildwar_const");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("guildwar","guildwar_against_list_item")},initConfig:function(){this.size=cc.size(616,124)},initPanel:function(){this.ctrl=t("guildwar_controller").getInstance(),this.model=this.ctrl.getModel(),this.state_label_lb=this.seekChild("state_label",cc.Label),this.gname_label_1_lb=this.seekChild("gname_label_1",cc.Label),this.srvname_label_1_lb=this.seekChild("srvname_label_1",cc.Label),this.rank_label_1_lb=this.seekChild("rank_label_1",cc.Label),this.win_image_1_nd=this.seekChild("win_image_1"),this.gname_label_2_lb=this.seekChild("gname_label_2",cc.Label),this.srvname_label_2_lb=this.seekChild("srvname_label_2",cc.Label),this.rank_label_2_lb=this.seekChild("rank_label_2",cc.Label),this.win_image_2_nd=this.seekChild("win_image_2")},registerEvent:function(){},setData:function(t){this.data=t,this.root_wnd&&this.onShow()},onShow:function(){if(null!=this.data){var t=this.data;this.gname_label_1_lb.string=String(t.guild_name1);var e=t.g_sid1.search("_"),i=1;null!=e&&(i=t.g_sid1.substring(e+1));var s=cc.js.formatStr(Utils.TI18N("[S%s] %s"),i,t.srv_name1);this.srvname_label_1_lb.string=s;var a="";a=t.rank1<=0?Utils.TI18N("\u672a\u4e0a\u699c"):String(t.rank1),this.rank_label_1_lb.string=cc.js.formatStr(Utils.TI18N("\u670d\u52a1\u5668\u6392\u540d\uff1a%s"),a),this.gname_label_2_lb.string=t.guild_name2;var o=t.g_sid2.search("_"),l=1;null!=o&&(l=t.g_sid2.substring(o+1));var r=cc.js.formatStr(Utils.TI18N("[S%s] %s"),l,t.srv_name2);this.srvname_label_2_lb.string=r;var c="";c=t.rank2<=0?Utils.TI18N("\u672a\u4e0a\u699c"):String(t.rank2),this.rank_label_2_lb.string=cc.js.formatStr(Utils.TI18N("\u670d\u52a1\u5668\u6392\u540d\uff1a%s"),c),this.win_image_1_nd.active=!1,this.win_image_2_nd.active=!1;var _=this.model.getGuildWarStatus();1==t.status?(this.state_label_lb.node.active=!0,0==t.g_id?(this.state_label_lb.string=Utils.TI18N("\u5e73\u5c40"),this.state_label_lb.node.color=n.against_color[3]):(this.state_label_lb.string=Utils.TI18N("\u5df2\u7ed3\u675f"),this.state_label_lb.node.color=n.against_color[1],t.g_id&&t.g_sid==t.g_sid1?this.win_image_1_nd.active=!0:this.win_image_2_nd.active=!0)):_==n.status.processing?(this.state_label_lb.node.active=!0,this.state_label_lb.string=Utils.TI18N("\u8fdb\u884c\u4e2d"),this.state_label_lb.node.color=n.against_color[2]):this.state_label_lb.node.active=!1}},onHide:function(){},onDelete:function(){}});cc._RF.pop()},{guildwar_const:"guildwar_const",guildwar_controller:"guildwar_controller",pathtool:"pathtool"}],guildwar_battle_list_window:[function(t,e,i){"use strict";cc._RF.push(e,"2adc1XN9d1O3re26VhxYbJr","guildwar_battle_list_window");var s=t("pathtool"),n=t("common_scrollview"),a=t("guildwar_battle_list_item");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("guildwar","guildwar_against_list_panel"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Big},initConfig:function(){this.ctrl=t("guildwar_controller").getInstance(),this.model=this.ctrl.getModel()},openCallBack:function(){this.background=this.seekChild("background"),this.background.scale=FIT_SCALE;var t=this.seekChild("main_container");this.close_btn=this.seekChild("close_btn"),this.explain_btn=this.seekChild("explain_btn"),this.time_label_lb=this.seekChild(t,"time_label",cc.Label),this.item_list_nd=this.seekChild(t,"item_list"),this.my_item_bg_nd=this.seekChild(t,"image_3"),this.time_label_lb.string=Config.guild_war_data.data_const.time_desc.desc||"",this.no_log_image_nd=this.seekChild("no_log_image"),this.no_log_label_lb=this.seekChild("no_log_label",cc.Label),this.no_log_label_lb.string=Utils.TI18N("\u6682\u65e0\u5176\u4ed6\u5bf9\u9635"),this.tips_label_lb=this.seekChild("tips_label",cc.Label);var e=this.item_list_nd.getContentSize(),i={item_class:a,start_x:0,space_x:0,start_y:0,space_y:0,item_width:616,item_height:124,row:0,col:1,need_dynamic:!0};this.box_scrollview=new n,this.box_scrollview.createScroll(this.item_list_nd,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,e,i,cc.v2(.5,.5))},registerEvent:function(){Utils.onTouchEnd(this.background,function(){this.ctrl.openBattleListWindow(!1)}.bind(this),2),Utils.onTouchEnd(this.close_btn,function(){this.ctrl.openBattleListWindow(!1)}.bind(this),2),Utils.onTouchEnd(this.explain_btn,function(){t("mainui_controller").getInstance().openCommonExplainView(!0,Config.guild_war_data.data_explain)}.bind(this),1)},openRootWnd:function(){this.ctrl.requestGuildWarBattleList()},setData:function(e){e.match_info=e.match_info||{};var i=t("guild_controller").getInstance().getModel().getMyGuildInfo(),n={},o=!1;for(var l in e.match_info){if((c=e.match_info[l]).g_id1==i.gid&&c.g_sid1==i.gsrv_id){0!=c.g_id2&&(n=e.match_info.splice(l,1)),o=!0;break}if(c.g_id2==i.gid&&c.g_sid2==i.gsrv_id){0!=c.g_id1&&(n=e.match_info.splice(l,1)),o=!0;break}}for(var r in this.data=[],e.match_info){var c;0!=(c=e.match_info[r]).g_id1&&0!=c.g_id2&&this.data.push(c)}if(this.data.sort(function(t,e){return 0==t.rank1&&0==e.rank1?1:0!=t.rank1&&0==e.rank1?-1:0==t.rank1&&0!=e.rank1?1:t.rank1-e.rank1}),n&&null!=Utils.next(n)){if(this.tips_label_lb.node.active=!1,!this.my_guildwar_battle_item){this.my_guildwar_battle_item=new a,this.my_guildwar_battle_item.show(),this.my_guildwar_battle_item.setParent(this.my_item_bg_nd);var _=this.my_item_bg_nd.getContentSize();this.my_guildwar_battle_item.setPosition(0,-_.height/2),this.my_guildwar_battle_item.setData(n[0])}}else this.tips_label_lb.string=!0,this.tips_label_lb.string=o?Utils.TI18N("\u672c\u6b21\u516c\u4f1a\u6218\u8f6e\u7a7a"):Utils.TI18N("\u7531\u4e8e\u516c\u4f1a\u5185\u6d3b\u8dc3\u4eba\u6570\u4e0d\u8db3\uff0c\u65e0\u6cd5\u53c2\u4e0e\u672c\u6b21\u516c\u4f1a\u6218");this.data&&null!=Utils.next(this.data)?(this.box_scrollview.setData(this.data),this.no_log_image_nd.active=!1,this.no_log_label_lb.node.active=!1):(this.no_log_image_nd.active=!0,null==this.no_log_image_sp&&(this.no_log_image_sp=this.no_log_image_nd.getComponent(cc.Sprite),this.loadRes(s.getBigBg("bigbg_3"),function(t){this.no_log_image_sp.spriteFrame=t}.bind(this))),this.no_log_label_lb.node.active=!0)},closeCallBack:function(){this.box_scrollview&&(this.box_scrollview.deleteMe(),this.box_scrollview=null),this.ctrl.openBattleListWindow(!1)}});cc._RF.pop()},{common_scrollview:"common_scrollview",guild_controller:"guild_controller",guildwar_battle_list_item:"guildwar_battle_list_item",guildwar_controller:"guildwar_controller",mainui_controller:"mainui_controller",pathtool:"pathtool"}],guildwar_battle_log_item:[function(t,e,i){"use strict";cc._RF.push(e,"8fbecAL5NVPmqTm+BqZ1AQb","guildwar_battle_log_item");var s=t("pathtool"),n=t("timetool");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("guildwar","guildwar_battle_log_item")},initConfig:function(){},initPanel:function(){this.top_image_sp=this.seekChild("top_image",cc.Sprite),this.flag_image=this.seekChild("flag_image"),this.time_label_lb=this.seekChild("time_label",cc.Label),this.log_text_rt=this.seekChild("log_text_rt",cc.RichText)},registerEvent:function(){},setData:function(t){this.data=t,this.root_wnd&&this.onShow()},onShow:function(){if(null!=this.data){var e=this.data;1==e.flag1?this.loadRes(s.getUIIconPath("guildwar","guildwar_1025"),function(t){this.top_image_sp.spriteFrame=t}.bind(this)):0==e.flag1&&this.loadRes(s.getUIIconPath("guildwar","guildwar_1026"),function(t){this.top_image_sp.spriteFrame=t}.bind(this)),this.time_label_lb.string=n.getYMDHMS(e.time);var i=t("role_controller").getInstance().getRoleVo(),a=this.getLogSrvName(i.gsrv_id),o=this.getLogSrvName(e.srv_id1),l=e.name1||"",r=i.gname||"",c=this.getLogSrvName(e.srv_id),_=this.getLogSrvName(e.srv_id2),h=e.name2||"",d=e.gname||"",u=0,m=0,f=0,p=0,g=!1,v=0;for(var b in e.int_args){var w=e.int_args[b];1==w.key?u=w.val:2==w.key?m=w.val:3==w.key?f=w.val:4==w.key?p=w.val:5==w.key?g=1==w.val:6==w.key&&(v=w.val)}var y=s.getUIIconPath("guildwar","guildwar_1007"),C="";if(u>0)for(var k=1;k<=u;k++)C+=cc.js.formatStr("<img src='%s' />","guildwar_1007");var S=cc.js.formatStr("<img src='%s' />","guildwar_1007"),T="",I=[y,y];for(var k in 1==e.flag1&&2==e.flag2?T=i.rid==e.rid1&&i.srv_id==e.srv_id1?g?cc.js.formatStr(Utils.TI18N("      <color=#3a78c4>%s</c>\u6311\u6218<color=#d95014>%s%s</c>\u5e9f\u589f\u6210\u529f\uff0c\u5c06\u516c\u4f1aBuff\u7b49\u7ea7\u63d0\u5347\u81f3<color=#a838bc>%s\u7ea7</c>\u3002"),l,_,h,p):cc.js.formatStr(Utils.TI18N("      \u5f88\u9057\u61be\uff0c<color=#3a78c4>%s</c>\u6311\u6218<color=#d95014>%s%s</c>\u5e9f\u589f\u5931\u8d25\uff0c\u4e0b\u6b21\u5c06\u5377\u571f\u91cd\u6765\uff01"),l,_,h):cc.js.formatStr(Utils.TI18N("      \u516c\u4f1a\u6210\u5458<color=#3a78c4>%s</c>\u6311\u6218<color=#d95014>%s%s</c>\u5e9f\u589f\u6210\u529f\uff0c\u5c06\u516c\u4f1aBuff\u7b49\u7ea7\u63d0\u5347\u81f3<color=#a838bc>%s\u7ea7</c>\u3002"),l,_,h,p):1==e.flag1&&1==e.flag2?T=i.rid==e.rid1&&i.srv_id==e.srv_id1?g?cc.js.formatStr(Utils.TI18N("      <color=#3a78c4>%s</c>\u6311\u6218<color=#d95014>%s%s</c>\u636e\u70b9\u6210\u529f\uff0c\u83b7\u5f97[%s]\u548c<color=#249003>\u6218\u7ee9%s\u70b9</c>\uff0c\u5df1\u65b9\u516c\u4f1a<color=#d95014>%s%s</c>\u5f53\u524d\u661f\u6570\u4e3a%s<color=#a838bc>%s</c>\u3002"),l,_,h,C,m,a,r,S,v):cc.js.formatStr(Utils.TI18N("      \u5f88\u9057\u61be\uff0c<color=#3a78c4>%s</c>\u6311\u6218<color=#d95014>%s%s</c>\u636e\u70b9\u5931\u8d25\uff0c\u4e0b\u6b21\u5c06\u5377\u571f\u91cd\u6765\uff01"),l,_,h):cc.js.formatStr(Utils.TI18N("      \u516c\u4f1a\u6210\u5458<color=#3a78c4>%s</c>\u6311\u6218<color=#d95014>%s%s</c>\u636e\u70b9\u6210\u529f\uff0c\u83b7\u5f97[%s]\u548c<color=#249003>\u6218\u7ee9%s\u70b9</c>\uff0c\u5df1\u65b9\u516c\u4f1a<color=#d95014>%s%s</c>\u5f53\u524d\u661f\u6570\u4e3a%s<color=#a838bc>%s</c>\u3002"),l,_,h,C,m,a,r,S,v):0==e.flag1&&2==e.flag2?T=i.rid!=e.rid1||i.srv_id!=e.srv_id1||g?cc.js.formatStr(Utils.TI18N("      \u654c\u65b9\u516c\u4f1a\u6210\u5458<color=#d95014>%s%s</c>\u6311\u6218<color=#3a78c4>%s%s</c>\u5e9f\u589f\u6210\u529f\uff0c\u5c06\u516c\u4f1aBuff\u7b49\u7ea7\u63d0\u5347\u81f3<color=#a838bc>%s\u7ea7</c>\u3002"),_,h,o,l,p):cc.js.formatStr(Utils.TI18N("      <color=#3a78c4>%s</c>\u7684\u5e9f\u589f\u62b5\u6321\u4f4f\u4e86\u654c\u65b9\u516c\u4f1a\u6210\u5458<color=#d95014>%s%s</c>\u7684\u6311\u6218\uff0c\u56fa\u82e5\u91d1\u6c64\uff01"),l,_,h):0==e.flag1&&1==e.flag2&&(T=i.rid!=e.rid1||i.srv_id!=e.srv_id1||g?cc.js.formatStr(Utils.TI18N("      \u654c\u65b9\u516c\u4f1a\u6210\u5458<color=#d95014>%s%s</c>\u6311\u6218<color=#3a78c4>%s%s</c>\u636e\u70b9\u6210\u529f\uff0c\u83b7\u5f97[%s]\u548c<color=#249003>\u6218\u7ee9%s\u70b9</c>\uff0c\u654c\u65b9\u516c\u4f1a<color=#d95014>%s%s</c>\u5f53\u524d\u661f\u6570\u4e3a%s<color=#a838bc>%s</c>\u3002"),_,h,o,l,C,m,c,d,S,f):cc.js.formatStr(Utils.TI18N("      <color=#3a78c4>%s</c>\u7684\u636e\u70b9\u62b5\u6321\u4f4f\u4e86\u654c\u65b9\u516c\u4f1a\u6210\u5458<color=#d95014>%s%s</c>\u7684\u6311\u6218\uff0c\u56fa\u82e5\u91d1\u6c64\uff01"),l,_,h)),this.log_text_rt.string=T,I)this.loadRes(I[k],function(t){this.log_text_rt.spriteFrame=t}.bind(this))}},getLogSrvName:function(t){if(!t)return"";var e=t.search("_"),i=1;return e&&(i=t.substring(e+1)),"[s"+i+"]"},onHide:function(){},onDelete:function(){}});cc._RF.pop()},{pathtool:"pathtool",role_controller:"role_controller",timetool:"timetool"}],guildwar_battle_log_window:[function(t,e,i){"use strict";cc._RF.push(e,"39a3fvaWElFJpa2zvewR8VZ","guildwar_battle_log_window");var s=t("pathtool"),n=t("common_scrollview"),a=t("guildwar_battle_log_item");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("guildwar","guildwar_battle_log_window"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Big},initConfig:function(){this.tab_list={},this.ctrl=t("guildwar_controller").getInstance(),this.model=this.ctrl.getModel(),this.color_1=new cc.Color(245,224,185,255),this.color_2=new cc.Color(105,55,5,255)},openCallBack:function(){this.background=this.seekChild("background"),this.background.scale=FIT_SCALE;for(var t=this.seekChild("tab_container"),e=1;e<3;e++){var i={},s=this.seekChild(t,"tab_btn_"+e);if(s){var o=s.getChildByName("title").getComponent(cc.Label),l=s.getComponent(cc.Button);1==e?o.string=Utils.TI18N("\u6218\u573a\u65e5\u5fd7"):2==e&&(o.string=Utils.TI18N("\u6211\u7684\u65e5\u5fd7")),o.node.color=new cc.Color(245,224,185,255);var r=s.getChildByName("tips");i.tab_btn=s,i.label=o,i.index=e,i.tips=r,i.btn=l,this.tab_list[e]=i}}this.close_btn=this.seekChild("close_btn"),this.confirm_btn=this.seekChild("confirm_btn"),this.log_panel=this.seekChild("log_panel"),this.no_log_label_nd=this.seekChild("no_log_label"),this.no_log_iamge_nd=this.seekChild("no_log_image");var c=this.log_panel.getContentSize(),_={item_class:a,start_x:0,space_x:0,start_y:0,space_y:0,item_width:612,item_height:163,row:0,col:1,need_dynamic:!0};this.box_scrollview=new n,this.box_scrollview.createScroll(this.log_panel,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,c,_,cc.v2(.5,.5))},registerEvent:function(){var t=this;Utils.onTouchEnd(this.background,function(){this.ctrl.openBattleLogWindow(!1)}.bind(this),2),Utils.onTouchEnd(this.close_btn,function(){this.ctrl.openBattleLogWindow(!1)}.bind(this),2),Utils.onTouchEnd(this.confirm_btn,function(){this.ctrl.openBattleLogWindow(!1)}.bind(this),2);var e=function(){var e=t.tab_list[i];e.tab_btn&&e.tab_btn.on(cc.Node.EventType.TOUCH_END,function(){this.changeSelectedTab(e.index)},t)};for(var i in this.tab_list)e()},changeSelectedTab:function(t){null!=this.tab_object&&this.tab_object.index==t||(this.tab_object&&(this.tab_object.label.node.color=this.color_1,this.tab_object.btn.interactable=!1,this.tab_object=null),this.tab_object=this.tab_list[t],this.tab_object&&(this.tab_object.label.node.color=this.color_2,this.tab_object.btn.interactable=!0),this.data&&null!=Utils.next(this.data)&&this.refreshLogList())},refreshLogList:function(){if(this.tab_object&&this.tab_object.index)if(1==this.tab_object.index){if(this.all_log_data&&null!=Utils.next(this.all_log_data))this.box_scrollview.setData(this.all_log_data);else{for(var e in this.data){var i=this.data[e],s=!1;for(var n in i.int_args){var a=i.int_args[n];if(5==a.key){s=1==a.val;break}}s&&this.all_log_data.push(i)}this.box_scrollview.setData(this.all_log_data)}this.all_log_data&&null!=Utils.next(this.all_log_data)?(this.no_log_iamge_nd.active=!1,this.no_log_label_nd.active=!1):(this.no_log_iamge_nd.active=!0,this.no_log_label_nd.active=!0)}else{if(this.my_log_data&&null!=Utils.next(this.my_log_data))this.box_scrollview.setData(this.my_log_data);else{var o=t("role_controller").getInstance().getRoleVo();for(var e in this.data){i=this.data[e];o.rid==i.rid1&&o.srv_id==i.srv_id1&&this.my_log_data.push(i)}this.box_scrollview.setData(this.my_log_data)}this.my_log_data&&null!=Utils.next(this.my_log_data)?(this.no_log_iamge_nd.active=!1,this.no_log_label_nd.active=!1):(this.no_log_iamge_nd.active=!0,this.no_log_label_nd.active=!0)}},setData:function(t){this.data=t,this.all_log_data=[],this.my_log_data=[],this.refreshLogList()},openRootWnd:function(t){t=t||1,this.changeSelectedTab(t),this.ctrl.requestBattleLogData()},closeCallBack:function(){this.box_scrollview&&(this.box_scrollview.deleteMe(),this.box_scrollview=null),this.ctrl.openBattleLogWindow(!1)}});cc._RF.pop()},{common_scrollview:"common_scrollview",guildwar_battle_log_item:"guildwar_battle_log_item",guildwar_controller:"guildwar_controller",pathtool:"pathtool",role_controller:"role_controller"}],guildwar_box_vo:[function(t,e,i){"use strict";cc._RF.push(e,"3ddca1I/4hBh6C5FYrEs63d","guildwar_box_vo");var s=t("guildwar_const"),n=t("guildwar_event"),a=cc.Class({extends:gcore.BaseEvent,ctor:function(){this.order=0,this.rid=0,this.sid=0,this.name="",this.item_id=0,this.item_num=0,this.status=s.box_type.gold},updateData:function(t){for(var e in t){var i=t[e];this[e]=i}this.fire(n.UpdateSingleBoxDataEvent)},_delete:function(){}});e.exports=a,cc._RF.pop()},{guildwar_const:"guildwar_const",guildwar_event:"guildwar_event"}],guildwar_const:[function(t,e,i){"use strict";var s;function n(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}cc._RF.push(e,"a09e3XGp29J8I9scKIewl+E","guildwar_const");var a={index:{list:1,positions:2,award:3},position_status:{normal:0,attacked:1,fall:2},positions:{myself:1,others:2},status:{close:1,matching:2,showing:3,processing:4,settlement:5},difficulty:{easy:1,common:2,difficult:3},result:{fighting:0,lose:1,win:2,dogfall:3},against_color:(s={},n(s,1,new cc.Color(104,69,42)),n(s,2,new cc.Color(58,120,196)),n(s,3,new cc.Color(121,121,121)),s),box_type:{copper:0,gold:1}};e.exports=a,cc._RF.pop()},{}],guildwar_controller:[function(t,e,i){"use strict";cc._RF.push(e,"0425f3UaltIrbxpcLSkBcOr","guildwar_controller");var s=t("role_controller"),n=t("guildwar_event"),a=cc.Class({extends:BaseController,ctor:function(){},initConfig:function(){var e=t("guildwar_model");this.model=new e(this),this.model.initConfig()},getModel:function(){return this.model},registerEvents:function(){null==this.init_role_event&&(this.init_role_event=gcore.GlobalEvent.bind(EventId.EVT_ROLE_CREATE_SUCCESS,function(){gcore.GlobalEvent.unbind(this.init_role_event),this.init_role_event=null,this.role_vo=s.getInstance().getRoleVo(),null!=this.role_vo&&null==this.role_assets_event&&(this.role_assets_event=this.role_vo.bind(EventId.UPDATE_ROLE_ATTRIBUTE,function(t,e){"guild_lev"==t&&0==e&&this.model.initConfig()},this))},this))},requestInitProtocal:function(){this.reqestGuildWarStatus(),this.requestAwardBoxData()},requestGuildWarData:function(){this.SendProtocal(24200,{})},requestEnemyPositionData:function(t){if(t){var e={};e.pos=t,this.SendProtocal(24201,e)}},requestGuildWarFighting:function(t,e,i){if(t){var s={};s.pos=t,s.hp=e,s.flag=i,this.SendProtocal(24202,s)}},reqestGuildWarStatus:function(){this.SendProtocal(24204,{})},requestGuildWarBattleList:function(){this.SendProtocal(24205,{})},requestMyGuildPositionData:function(){this.SendProtocal(24208,{})},requestPositionDefendData:function(t,e,i){var s={};s.pos=i,s.g_id1=t,s.g_sid1=e,this.SendProtocal(24209,s)},requestBattleLogData:function(){this.SendProtocal(24212,{})},requestGuildWarRankData:function(){this.SendProtocal(24213,{})},requestAwardBoxData:function(){this.SendProtocal(24220,{})},requestGetBoxAward:function(t){var e={};e.order=t,this.SendProtocal(24221,e)},registerProtocals:function(){this.RegisterProtocal(24200,this.handle24200),this.RegisterProtocal(24201,this.handle24201),this.RegisterProtocal(24202,this.handle24202),this.RegisterProtocal(24203,this.handle24203),this.RegisterProtocal(24204,this.handle24204),this.RegisterProtocal(24205,this.handle24205),this.RegisterProtocal(24206,this.handle24206),this.RegisterProtocal(24207,this.handle24207),this.RegisterProtocal(24208,this.handle24208),this.RegisterProtocal(24209,this.handle24209),this.RegisterProtocal(24210,this.handle24210),this.RegisterProtocal(24212,this.handle24212),this.RegisterProtocal(24213,this.handle24213),this.RegisterProtocal(24214,this.handle24214),this.RegisterProtocal(24220,this.handle24220),this.RegisterProtocal(24221,this.handle24221),this.RegisterProtocal(24223,this.handle24223)},handle24200:function(t){(t=t||{}).count&&this.model.setGuildWarChallengeCount(t.count),t.result&&this.model.setGuildWarResult(t.result),t.ranks&&this.model.setGuildWarTopThreeRank(t.ranks);var e={};e.gname=t.gname1,e.hp=t.hp1,e.buff_lev=t.buff_lev1,this.model.setMyGuildWarBaseInfo(e),this.model.setEnemyGuildWarData(t),gcore.GlobalEvent.fire(n.GuildWarEnemyPositionDataInitEvent)},handle24201:function(t){t&&this.attk_position_window&&this.attk_position_window.setData(t)},handle24202:function(t){message(t.msg),1==t.code&&(this.model.setGuildWarChallengeCount(t.count),gcore.GlobalEvent.fire(n.UpdateGuildwarChallengeCountEvent),this.openAttkPositionWindow(!1),this.openAttkLookWindow(!1))},handle24203:function(e){var i=t("battle_const");t("battle_controller").getInstance().openFinishView(!0,i.Fight_Type.GuildWar,e)},handle24204:function(t){t&&(this.model.setGuildWarStatus(t),gcore.GlobalEvent.fire(n.UpdateGuildWarStatusEvent,t.status,t.flag))},handle24205:function(t){t&&this.battle_list_window&&this.battle_list_window.setData(t)},handle24206:function(t){t&&(t.flag&&1==t.flag?this.model.updateMyGuildWarPositionData(t.defense):this.model.updateEnemyGuildWarPositionData(t.defense))},handle24207:function(t){if(t){if(t.result&&this.model.setGuildWarResult(t.result),t.hp&&t.buff_lev){var e={};e.hp=t.hp,e.buff_lev=t.buff_lev,this.model.updateMyGuildWarBaseInfo(e)}t.hp2&&this.model.updateEnemyGuildWarBaseInfo(t.hp2),t.ranks&&this.model.setGuildWarTopThreeRank(t.ranks),gcore.GlobalEvent.fire(n.UpdateGuildWarBaseInfoEvent)}},handle24208:function(t){t&&(this.model.setMyGuildWarPositionData(t.defense),gcore.GlobalEvent.fire(n.GetGuildWarMyPositionDataEvent))},handle24209:function(t){t&&this.defend_look_window&&this.defend_look_window.setData(t)},handle24210:function(){var e=t("guild_const");this.model.updateGuildWarRedStatus(e.red_index.guildwar_log,!0,!0)},handle24212:function(t){this.battle_log_window&&t&&this.battle_log_window.setData(t.guild_war_log)},handle24213:function(t){t&&gcore.GlobalEvent.fire(n.UpdateGuildWarRankDataEvent,t.ranks)},handle24214:function(t){t&&t.result&&(this.model.setGuildWarResult(t.result),gcore.GlobalEvent.fire(n.UpdateGuildWarBaseInfoEvent))},handle24220:function(t){t&&(this.model.setGuildWarBoxData(t),gcore.GlobalEvent.fire(n.UpdateGuildWarBoxDataEvent,t))},handle24221:function(t){message(t.msg)},handle24223:function(t){t&&(this.model.updateGuildWarBoxData(t),this.role_vo&&t.rid==this.role_vo.rid&&t.sid==this.role_vo.srv_id&&gcore.GlobalEvent.fire(n.UpdateMyAwardBoxEvent))},openMainWindow:function(t){if(0==t)this.main_window&&(this.main_window.close(),this.main_window=null);else{if(0==IS_SHOW_CHARGE)return void message(Utils.TI18N("\u529f\u80fd\u6682\u672a\u5f00\u653e\uff0c\u656c\u8bf7\u671f\u5f85"));if(null==this.role_vo||0==this.role_vo.gid)return void message(Utils.TI18N("\u60a8\u5f53\u524d\u672a\u52a0\u5165\u4efb\u4f55\u516c\u4f1a\uff0c\u52a0\u5165\u516c\u4f1a\u540e\u624d\u80fd\u53c2\u4e0e\u8be5\u73a9\u6cd5\uff01"));var e=Config.guild_war_data.data_const.limit_lev;if(null==e)return void message(Utils.TI18N("\u516c\u4f1a\u6218\u6570\u636e\u5f02\u5e38!"));if(this.role_vo.guild_lev<e.val)return void message(Utils.TI18N("\u60a8\u6240\u5728\u7684\u516c\u4f1a\u672a\u8fbe\u53c2\u8d5b\u6761\u4ef6\uff0c\u4e0d\u80fd\u53c2\u4e0e\u54e6\uff0c\u8bf7\u52aa\u529b\u63d0\u9ad8\u516c\u4f1a\u7b49\u7ea7\uff01"));null==this.main_window&&(this.main_window=Utils.createClass("guildwar_main_window")),this.main_window.open()}},openAttkLookWindow:function(t){0==t?this.attk_look_window&&(this.attk_look_window.close(),this.attk_look_window=null):(null==this.attk_look_window&&(this.attk_look_window=Utils.createClass("guildwar_attk_look_window")),this.attk_look_window.open())},openDefendLookWindow:function(t,e,i,s){0==t?this.defend_look_window&&(this.defend_look_window.close(),this.defend_look_window=null):(null==this.defend_look_window&&(this.defend_look_window=Utils.createClass("guildwar_defend_look_window")),this.defend_look_window.open({g_id:e,g_sid:i,pos:s}))},openBattleListWindow:function(t){0==t?this.battle_list_window&&(this.battle_list_window.close(),this.battle_list_window=null):(null==this.battle_list_window&&(this.battle_list_window=Utils.createClass("guildwar_battle_list_window")),this.battle_list_window.open())},openBattleLogWindow:function(t){0==t?this.battle_log_window&&(this.battle_log_window.close(),this.battle_log_window=null):(null==this.battle_log_window&&(this.battle_log_window=Utils.createClass("guildwar_battle_log_window")),this.battle_log_window.open())},openGuildWarAwardWindow:function(t){0==t?this.guildwar_award_window&&(this.guildwar_award_window.close(),this.guildwar_award_window=null):(null==this.guildwar_award_window&&(this.guildwar_award_window=Utils.createClass("guildwar_award_window")),this.guildwar_award_window.open())},openAttkPositionWindow:function(t,e){0==t?this.attk_position_window&&(this.attk_position_window.close(),this.attk_position_window=null):(null==this.attk_position_window&&(this.attk_position_window=Utils.createClass("guildwar_attk_position_window")),this.attk_position_window.open(e))},openGuildWarRankView:function(t,e){0==t?this.guildwar_rank_window&&(this.guildwar_rank_window.close(),this.guildwar_rank_window=null):(null==this.guildwar_rank_window&&(this.guildwar_rank_window=Utils.createClass("guildwar_rank_window")),this.guildwar_rank_window.open(e))},checkIsCanOpenGuildWarWindow:function(t){var e=Config.guild_war_data.data_const.limit_lev.val,i=Config.guild_war_data.data_const.limit_open_time,n=s.getInstance().getRoleVo(),a=s.getInstance().getModel().getOpenSrvDay();return n.isHasGuild()?n.guild_lev<e?(t||message(Utils.TI18N("\u60a8\u6240\u5728\u7684\u516c\u4f1a\u672a\u8fbe\u53c2\u8d5b\u6761\u4ef6\uff0c\u4e0d\u80fd\u53c2\u4e0e\u54e6\uff0c\u8bf7\u52aa\u529b\u63d0\u9ad8\u516c\u4f1a\u7b49\u7ea7\uff01")),!1):a<=i.val&&(t||message(i.desc),!1):(t||message(Utils.TI18N("\u60a8\u5f53\u524d\u672a\u52a0\u5165\u4efb\u4f55\u516c\u4f1a\uff0c\u52a0\u5165\u516c\u4f1a\u540e\u624d\u80fd\u53c2\u4e0e\u8be5\u73a9\u6cd5\uff01")),!1),e},openAwardBoxWindow:function(t){0==t?this.award_box_window&&(this.award_box_window.close(),this.award_box_window=null):(null==this.award_box_window&&(this.award_box_window=Utils.createClass("guildwar_award_box_window")),this.award_box_window.open())},openAwardBoxPreview:function(t){0==t?this.award_box_preview&&(this.award_box_preview.close(),this.award_box_preview=null):(null==this.award_box_preview&&(this.award_box_preview=Utils.createClass("guildwar_award_box_preview")),this.award_box_preview.open())}});e.exports=a,cc._RF.pop()},{battle_const:"battle_const",battle_controller:"battle_controller",guild_const:"guild_const",guildwar_event:"guildwar_event",guildwar_model:"guildwar_model",role_controller:"role_controller"}],guildwar_defend_look_item:[function(t,e,i){"use strict";cc._RF.push(e,"dcb71508s1J3r/ZAwxHz7sF","guildwar_defend_look_item");var s=t("pathtool"),n=t("hero_vo"),a=t("timetool");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("guildwar","guildwar_defend_look_item")},initConfig:function(){this.ctrl=t("guildwar_controller").getInstance(),this.model=this.ctrl.getModel(),this.color_1=new cc.Color(217,80,20,255),this.color_2=new cc.Color(36,144,3,255),this.item_list=[]},initPanel:function(){this.container=this.seekChild("containr"),this.name_lb=this.seekChild("name_label",cc.Label),this.time_lb=this.seekChild("time_label",cc.Label),this.attk_lb=this.seekChild("attk_label",cc.Label),this.result_lb=this.seekChild("result_label",cc.Label),this.magic_lb=this.seekChild("magic_label",cc.Label),this.diff_lb=this.seekChild("diff_label",cc.Label),this.vedio_btn=this.seekChild("vedio_btn"),this.role_list=this.seekChild("role_list"),this.scroll_view=this.seekChild(this.role_list,"scroll_view"),this.scroll_content=this.seekChild(this.scroll_view,"content"),this.scroll_view_size=this.scroll_view.getContentSize()},registerEvent:function(){Utils.onTouchEnd(this.vedio_btn,function(){this.data&&this.data.repaly_id&&t("battle_controller").getInstance().csRecordBattle(this.data.repaly_id)}.bind(this),1)},setData:function(t){this.data=t,this.root_wnd&&this.onShow()},onShow:function(t){if(null!=this.data){var e=this.data;this.name_lb.string=cc.js.formatStr(Utils.TI18N("\u6311\u6218\u8005\uff1a%s"),e.name),this.attk_lb.string=cc.js.formatStr(Utils.TI18N("\u6218\u529b\uff1a%s"),e.power),this.time_lb.string=cc.js.formatStr(a.getYMDHMS(e.time));var i=Config.formation_data.data_form_data[e.formation_type];if(i){var s=e.formation_lev||1;this.magic_lb.string=cc.js.formatStr("%s Lv.%s",i.name,s)}1==e.result?(this.result_lb.string=Utils.TI18N("\u6311\u6218\u5931\u8d25"),this.result_lb.node.color=this.color_1):(this.result_lb.string=Utils.TI18N("\u6311\u6218\u6210\u529f"),this.result_lb.node.color=this.color_2),1==e.hp?this.diff_lb.string=Utils.TI18N("[\u7b80\u5355]"):2==e.hp?this.diff_lb.string=Utils.TI18N("[\u666e\u901a]"):3==e.hp&&(this.diff_lb.string=Utils.TI18N("[\u56f0\u96be]"));var o=[];for(var l in e.defense){var r=e.defense[l],c=new n;c.updateHeroVo(r),o.push(c)}var _=o.length,h=119*_*.77+6*(_-1),d=Math.max(h,this.scroll_view_size.width);for(var u in this.scroll_content.setContentSize(cc.size(d,this.scroll_view_size.height)),o){r=o[u];var m=ItemsPool.getInstance().getItem("hero_exhibition_item");m.show(),m.setRootScale(.77),m.setPosition(97.63*(u-1)-99.185,0),m.setData(r,null,null),m.setParent(this.scroll_content),this.item_list.push(m)}}},onHide:function(){},onDelete:function(){if(this.item_list){for(var t in this.item_list){var e=this.item_list[t];e&&(e.deleteMe(),e=null)}this.item_list=null}}});cc._RF.pop()},{battle_controller:"battle_controller",guildwar_controller:"guildwar_controller",hero_vo:"hero_vo",pathtool:"pathtool",timetool:"timetool"}],guildwar_defend_look_window:[function(t,e,i){"use strict";cc._RF.push(e,"a777eyptYBHhZ5CfeQTUVjx","guildwar_defend_look_window");var s=t("pathtool"),n=t("common_scrollview"),a=t("guildwar_defend_look_item"),o=t("guildwar_battle_array_panel");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("guildwar","guildwar_defend_look_window"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Big},initConfig:function(){this.ctrl=t("guildwar_controller").getInstance(),this.model=this.ctrl.getModel()},openCallBack:function(){this.background=this.seekChild("background"),this.background.scale=FIT_SCALE,this.container=this.seekChild("container"),this.close_btn=this.seekChild("close_btn"),this.no_vedio_image_nd=this.seekChild("no_vedio_image"),this.no_vedio_nd=this.seekChild("no_vedio_label"),this.time_label_lb=this.seekChild("time_label",cc.Label),this.list_panel=this.seekChild("list_panel"),this.time_label_lb.string=Config.guild_war_data.data_const.time_desc.desc||"";var t=this.list_panel.getContentSize(),e={item_class:a,start_x:0,space_x:0,start_y:0,space_y:0,item_width:616,item_height:218,row:0,col:1,need_dynamic:!0};this.box_scrollview=new n,this.box_scrollview.createScroll(this.list_panel,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,t,e,cc.v2(.5,.5))},registerEvent:function(){Utils.onTouchEnd(this.background,function(){this.ctrl.openDefendLookWindow(!1)}.bind(this),2),Utils.onTouchEnd(this.close_btn,function(){this.ctrl.openDefendLookWindow(!1)}.bind(this),2)},openRootWnd:function(t){this.ctrl.requestPositionDefendData(t.g_id,t.g_sid,t.pos)},setData:function(t){t=t||{},this.enemy_battle_array_panel||(this.enemy_battle_array_panel=new o,this.enemy_battle_array_panel.show(),this.enemy_battle_array_panel.setParent(this.container),this.enemy_battle_array_panel.setPanelContentSize(cc.size(616,190)),this.enemy_battle_array_panel.setPosition(0,260));var e={},i=[];for(var s in t.defense)i.push(t.defense[s]);e.partner_list=i,e.power=t.power,e.formation_type=t.formation_type,e.formation_lev=t.formation_lev,this.enemy_battle_array_panel.setData(e),t.guild_war_role_log&&null!=Utils.next(t.guild_war_role_log)?(this.box_scrollview.setData(t.guild_war_role_log),this.no_vedio_image_nd.active=!1,this.no_vedio_nd.active=!1):(this.no_vedio_image_nd.active=!0,this.no_vedio_nd.active=!0)},closeCallBack:function(){this.box_scrollview&&(this.box_scrollview.deleteMe(),this.box_scrollview=null),this.enemy_battle_array_panel&&(this.enemy_battle_array_panel.deleteMe(),this.enemy_battle_array_panel=null),this.ctrl.openDefendLookWindow(!1)}});cc._RF.pop()},{common_scrollview:"common_scrollview",guildwar_battle_array_panel:"guildwar_battle_array_panel",guildwar_controller:"guildwar_controller",guildwar_defend_look_item:"guildwar_defend_look_item",pathtool:"pathtool"}],guildwar_event:[function(t,e,i){"use strict";cc._RF.push(e,"a6511QZ/dRON4sQrYMJqv80","guildwar_event"),e.exports={UpdateGuildWarStatusEvent:"UpdateGuildWarStatusEvent",GuildWarEnemyPositionDataInitEvent:"GuildWarEnemyPositionDataInitEvent",UpdateGuildwarChallengeCountEvent:"UpdateGuildwarChallengeCountEvent",UpdateGuildWarPositionDataEvent:"UpdateGuildWarPositionDataEvent",UpdateGuildWarBaseInfoEvent:"UpdateGuildWarBaseInfoEvent",GetGuildWarMyPositionDataEvent:"GetGuildWarMyPositionDataEvent",UpdateGuildWarRankDataEvent:"UpdateGuildWarRankDataEvent",UpdateGuildWarRedStatusEvent:"UpdateGuildWarRedStatusEvent",UpdateGuildWarBoxDataEvent:"UpdateGuildWarBoxDataEvent",UpdateSingleBoxDataEvent:"UpdateSingleBoxDataEvent",UpdateMyAwardBoxEvent:"UpdateMyAwardBoxEvent"},cc._RF.pop()},{}],guildwar_main_window:[function(t,e,i){"use strict";cc._RF.push(e,"e53d8rVP7dGsI6SOA8CagO+","guildwar_main_window");var s=t("guild_const"),n=t("guildwar_const"),a=t("guildwar_event"),o=t("pathtool"),l=t("timetool"),r=t("guildwar_position_item");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=o.getPrefabPath("guildwar","guildwar_main_window"),this.viewTag=SCENE_TAG.ui,this.win_type=WinType.Full},initConfig:function(){this.ctrl=t("guildwar_controller").getInstance(),this.model=this.ctrl.getModel(),this.cur_position_type=n.positions.others,this.position_vo_data={},this.position_stack=[],this.position_pool=[],this.position_pos={},this.map_bgs=[],this.top3_item_list={},this.color_1=new cc.Color(137,237,255,255),this.free_size=cc.size(720,1280)},openCallBack:function(){this.background=this.seekChild("background"),this.background.scale=FIT_SCALE,this.main_container=this.seekChild("main_container"),this.map_layer=this.seekChild(this.main_container,"map_layer"),this.show_panel=this.seekChild(this.main_container,"show_panel"),this.state_panel=this.seekChild(this.main_container,"state_panel"),this.state_panel.getChildByName("background").scale=FIT_SCALE,this.top_panel=this.seekChild(this.main_container,"top_panel"),this.myguild_container=this.seekChild(this.show_panel,"myguild_container"),this.enemyguild_container=this.seekChild(this.show_panel,"enemyguild_container"),this.rank_container=this.seekChild(this.show_panel,"rank_container"),this.title_container=this.seekChild(this.show_panel,"title_container"),this.buff_container=this.seekChild(this.show_panel,"buff_container"),this.battle_list_btn=this.seekChild(this.show_panel,"battle_list_btn"),this.attk_check_btn=this.seekChild(this.show_panel,"attk_check_btn"),this.ally_atk_btn=this.seekChild(this.show_panel,"ally_atk_btn"),this.look_award_btn=this.seekChild(this.show_panel,"look_award_btn"),this.change_scene_btn=this.seekChild(this.show_panel,"change_scene_btn"),this.change_scene_btn_lb=this.seekChild(this.change_scene_btn,"label",cc.Label),this.change_scene_btn_lb.string=Utils.TI18N("\u654c\u65b9\u9635\u5730"),this.award_box_btn=this.seekChild(this.show_panel,"award_box_btn"),this.clash_list_btn=this.seekChild(this.state_panel,"clash_list_btn"),this.look_box_btn=this.seekChild(this.state_panel,"look_box_btn"),this.rank_btn=this.seekChild(this.rank_container,"rank_btn"),this.close_btn=this.seekChild(this.top_panel,"close_btn"),this.explain_btn=this.seekChild(this.top_panel,"explain_btn"),this.time_label_lb=this.seekChild(this.title_container,"time_label",cc.Label),this.challenge_label_lb=this.seekChild(this.title_container,"challenge_label",cc.Label),this.state_tips_label_lb=this.seekChild(this.state_panel,"state_tips_label",cc.Label),this.buff_lv_label_lb=this.seekChild(this.buff_container,"buff_lv_label",cc.Label),this.buff_icon_sp=this.seekChild(this.buff_container,"buff_icon",cc.Sprite),this.loadRes(o.getIconPath("bufficon","2"),function(t){this.buff_icon_sp.spriteFrame=t}.bind(this)),this.my_guild_name_lb=this.seekChild(this.myguild_container,"guild_name_label_1",cc.Label),this.my_guild_star_lb=this.seekChild(this.myguild_container,"star_label_1",cc.Label),this.my_guild_win_nd=this.seekChild(this.myguild_container,"image_win_1"),this.my_guild_dogfall_nd=this.seekChild(this.myguild_container,"image_dogfall_1"),this.enemy_guild_name_lb=this.seekChild(this.enemyguild_container,"guild_name_label_2",cc.Label),this.enemy_guild_star_lb=this.seekChild(this.enemyguild_container,"star_label_2",cc.Label),this.enemy_guild_win_nd=this.seekChild(this.enemyguild_container,"image_win_2"),this.enemy_guild_dogfall_nd=this.seekChild(this.enemyguild_container,"image_dogfall_2"),this.map_layer_posX=-360,this.map_layer_posY=-670,this.map_size=cc.size(720,7680),this.map_layer.setContentSize(this.map_size),this.map_layer.setPosition(cc.v2(this.map_layer_posX,this.free_size.height-this.map_size.height+this.map_layer_posY)),this.addMapImage()},registerEvent:function(){this.addGlobalEvent(a.UpdateGuildWarStatusEvent,function(t,e){this.guildwar_status<=3&&t>3&&1==e&&this.ctrl.requestGuildWarData(),t<=3&&(this.ctrl.openAttkLookWindow(!1),this.ctrl.openAttkPositionWindow(!1),this.ctrl.openGuildWarAwardWindow(!1),this.ctrl.openBattleLogWindow(!1),this.ctrl.openDefendLookWindow(!1),this.ctrl.openGuildWarRankView(!1)),this.refreshGuildWarStatus()},this),this.addGlobalEvent(a.GuildWarEnemyPositionDataInitEvent,function(){this.refreshChallengeCount(),this.refreshStarAndBuffInfo(),this.refreshTopThreeRank(),this.refreshGuildWarPosition()},this),this.addGlobalEvent(a.UpdateGuildwarChallengeCountEvent,function(){this.refreshChallengeCount()},this),this.addGlobalEvent(a.UpdateGuildWarBaseInfoEvent,function(){this.refreshTopThreeRank(),this.refreshStarAndBuffInfo()},this),this.addGlobalEvent(a.GetGuildWarMyPositionDataEvent,function(){this.refreshGuildWarPosition()},this),this.addGlobalEvent(a.UpdateGuildWarRedStatusEvent,function(t,e){this.updateMainRedStatus(t,e)},this),Utils.onTouchEnd(this.close_btn,function(){this.ctrl.openMainWindow(!1)}.bind(this),2),Utils.onTouchEnd(this.explain_btn,function(){t("mainui_controller").getInstance().openCommonExplainView(!0,Config.guild_war_data.data_explain)}.bind(this),1),Utils.onTouchEnd(this.attk_check_btn,function(){this.ctrl.openAttkLookWindow(!0)}.bind(this),1),Utils.onTouchEnd(this.battle_list_btn,function(){this.ctrl.openBattleListWindow(!0)}.bind(this),1),Utils.onTouchEnd(this.clash_list_btn,function(){this.ctrl.openBattleListWindow(!0),this.model.updateGuildWarRedStatus(s.red_index.guildwar_match,!1)}.bind(this),1),Utils.onTouchEnd(this.ally_atk_btn,function(){this.ctrl.openBattleLogWindow(!0),this.model.updateGuildWarRedStatus(s.red_index.guildwar_log,!1)}.bind(this),1),Utils.onTouchEnd(this.look_award_btn,function(){this.ctrl.openGuildWarAwardWindow(!0)}.bind(this),1),Utils.onTouchEnd(this.rank_btn,function(){this.ctrl.openGuildWarRankView(!0)}.bind(this),1),Utils.onTouchEnd(this.change_scene_btn,function(){this.changeGuildwarPositionType()}.bind(this),1),Utils.onTouchEnd(this.award_box_btn,function(){this.ctrl.openAwardBoxWindow(!0)}.bind(this),1),Utils.onTouchEnd(this.look_box_btn,function(){this.ctrl.openAwardBoxWindow(!0)}.bind(this),1),this.map_layer.on(cc.Node.EventType.TOUCH_START,function(t){return this.last_point=null,this.is_move_map_layer=!0,!0},this),this.map_layer.on(cc.Node.EventType.TOUCH_MOVE,function(t){var e=t.getTouches();this.last_point=e[0].getDelta(),this.moveMapLayer(this.last_point.x,this.last_point.y),this.dynamicShowGuildWarPosition(),this.dynamicAddMapImage()},this),this.map_layer.on(cc.Node.EventType.TOUCH_END,function(t){this.is_move_map_layer=!1},this)},openRootWnd:function(){var t=this.model.getGuildWarEnemyFlag(),e=this.model.getGuildWarStatus();this.refreshGuildWarStatus(),this.updateMainRedStatus(),1==t&&e>n.status.showing&&!this.model.checkIsHaveEnemyCacheData()?this.ctrl.requestGuildWarData():(this.refreshGuildWarPosition(),this.refreshStarAndBuffInfo(),this.refreshTopThreeRank(),this.refreshChallengeCount())},refreshGuildWarStatus:function(){var t=this.model.getGuildWarStatus(),e=!1,i="";this.clash_list_btn.active=!1;var s=this.model.getGuildWarEnemyFlag();if(t==n.status.close){e=!0,i=Utils.TI18N("\u516c\u4f1a\u6218\u6682\u672a\u5f00\u59cb\uff0c\u8bf7\u5728\u6bcf\u5468\u4e00\u3001\u5468\u4e09\u3001\u5468\u516d12:00-20:00\u51c6\u65f6\u53c2\u52a0\u54e6\uff01\uff08\uff9f\u2200\uff9f\uff09\u3064");for(var a=this.position_stack.length;a>0;a--){var o=this.position_stack.pop(),l=o.getPositionPos();o.setVisible(!1),o.suspendAllActions(),this.position_pool.push(o),this.position_pos[l]=null}}else t==n.status.matching?(e=!0,i=Utils.TI18N("\u6b63\u5728\u5339\u914d\uff0c\u8bf7\u8010\u5fc3\u7b49\u5f85")):t==n.status.showing?(i=1==s?Utils.TI18N("\u516c\u4f1a\u6218\u6682\u672a\u5f00\u59cb\uff0c\u8bf7\u5728\u6bcf\u5468\u4e00\u3001\u5468\u4e09\u3001\u5468\u516d12:00-20:00\u51c6\u65f6\u53c2\u52a0\u54e6\uff01\uff08\uff9f\u2200\uff9f\uff09\u3064"):Utils.TI18N("\u5f88\u9057\u61be\uff0c\u60a8\u7684\u516c\u4f1a\u5728\u6b64\u6b21\u516c\u4f1a\u6218\u4e2d\u5339\u914d\u8f6e\u7a7a\u6216\u6d3b\u8dc3\u4eba\u6570\u672a\u8fbe\u6807\uff0c\u8bf7\u671f\u5f85\u4e0b\u6b21\uff01(\u3064\u0434\u2229)"),this.clash_list_btn.active=!0,e=!0):t==n.status.processing?1==s?e=!1:(i=Utils.TI18N("\u5f88\u9057\u61be\uff0c\u60a8\u7684\u516c\u4f1a\u5728\u6b64\u6b21\u516c\u4f1a\u6218\u4e2d\u5339\u914d\u8f6e\u7a7a\u6216\u6d3b\u8dc3\u4eba\u6570\u672a\u8fbe\u6807\uff0c\u8bf7\u671f\u5f85\u4e0b\u6b21\uff01(\u3064\u0434\u2229)"),e=!0,this.clash_list_btn.active=!0):t==n.status.settlement&&(1==s?e=!1:(i=Utils.TI18N("\u5f88\u9057\u61be\uff0c\u60a8\u7684\u516c\u4f1a\u5728\u6b64\u6b21\u516c\u4f1a\u6218\u4e2d\u5339\u914d\u8f6e\u7a7a\u6216\u6d3b\u8dc3\u4eba\u6570\u672a\u8fbe\u6807\uff0c\u8bf7\u671f\u5f85\u4e0b\u6b21\uff01(\u3064\u0434\u2229)"),e=!0,this.clash_list_btn.active=!0));this.guildwar_status=t,e&&(this.state_tips_label_lb.string=i),this.show_panel.active=!e,this.state_panel.active=e,this.refreshSurplusTime(),this.refreshChallengeCount()},addMapImage:function(){for(var t=1;t<4;t++){var e=1280*(6-t),i=Utils.createImage(this.map_layer,null,0,e,cc.v2(0,0));this.loadImage(i,o.getUIIconPath("bigbg/guildwar","guildwar_1")),this.map_bgs.push(i)}this.dynamicAddMapImage()},loadImage:function(t,e){this.loadRes(e,function(e){t.spriteFrame=e}.bind(this))},getTopOrBottomMapBgPosY:function(t){var e=null;for(var i in this.map_bgs){var s=this.map_bgs[i].node.y;e=e||s,1==t&&s>e?e=s:2==t&&s<e&&(e=s)}return e},dynamicAddMapImage:function(){var t=this.map_layer.y;t=Math.abs(t);for(var e in this.map_bgs){var i=this.map_bgs[e],s=i.node.y;s+640<t-1280?i.node.y=this.getTopOrBottomMapBgPosY(1)+1280:s-640>t+1280&&(i.node.y=this.getTopOrBottomMapBgPosY(2)-1280)}},moveMapLayer:function(t,e){t=this.map_layer.x+t,e=this.map_layer.y+e;var i=this.checkMapLayerPoint(t,e);this.map_layer.setPosition(i.x,i.y)},checkMapLayerPoint:function(t,e){var i=cc.v2(t,e);return t>this.map_layer_posX?i.x=this.map_layer_posX:t<this.free_size.width-this.map_size.width+this.map_layer_posX&&(i.x=this.free_size.width-this.map_size.width+this.map_layer_posX),e<this.free_size.height-this.map_size.height+this.map_layer_posY?i.y=this.free_size.height-this.map_size.height+this.map_layer_posY:i.y>=this.map_layer_posY&&(i.y=this.map_layer_posY),i},refreshSurplusTime:function(){this.surplusTime=this.model.getGuildWarSurplusTime(),this.surplusTime<0&&(this.surplusTime=0),this.time_label_lb.string=l.getTimeFormatDayIIIIIIII(this.surplusTime),this.openGuildWarSurplusTimer(!0)},openGuildWarSurplusTimer:function(t){1==t?null==this.guildwar_timer&&(this.guildwar_timer=gcore.Timer.set(function(){this.surplusTime=this.surplusTime-1,this.surplusTime>=0?this.time_label_lb.string=l.getTimeFormatDayIIIIIIII(this.surplusTime):(this.surplusTime=0,gcore.Timer.del(this.guildwar_timer),this.guildwar_timer=null)}.bind(this),1e3,-1)):null!=this.guildwar_timer&&(gcore.Timer.del(this.guildwar_timer),this.guildwar_timer=null)},refreshChallengeCount:function(){if(this.guildwar_status==n.status.settlement)this.challenge_label_lb.string=Utils.TI18N("\u540e\u5173\u95ed");else{var t=this.model.getGuildWarChallengeCount(),e=Config.guild_war_data.data_const.challange_time_limit.val;this.challenge_label_lb.string=cc.js.formatStr(Utils.TI18N("\u6311\u6218\u6b21\u6570:%s/%s"),e-t,e)}},refreshStarAndBuffInfo:function(){var t=this.model.getMyGuildWarBaseInfo();cc.log(t),this.my_guild_name_lb.string=t.gname||"",this.my_guild_star_lb.string=t.hp||0;var e=t.buff_lev||0,i=Config.guild_war_data.data_buff_length;this.buff_lv_label_lb.string=cc.js.formatStr(Utils.TI18N("%s/%s\u7ea7"),e,i);var s=this.model.getEnemyGuildWarBaseInfo();this.enemy_guild_name_lb.string=s.gname||"",this.enemy_guild_star_lb.string=s.hp||0;var a=this.model.getGuildWarResult();this.my_guild_win_nd.active=a==n.result.win,this.my_guild_dogfall_nd.active=a==n.result.dogfall,this.enemy_guild_win_nd.active=a==n.result.lose,this.enemy_guild_dogfall_nd.active=a==n.result.dogfall},refreshTopThreeRank:function(){var t=this.model.getGuildWarTopThreeRank();if(null!=t&&null!=Utils.next(t))for(var e in t){var i,s=t[e];if(!this.top3_item_list[s.rank])(i=this.createSingleRankItem(s.rank)).container.setParent(this.rank_container),this.top3_item_list[s.rank]=i;(i=this.top3_item_list[s.rank])&&(i.container.setPosition(-10,-60-(s.rank-1)*i.container.getContentSize().height),i.label.string=s.name)}},createSingleRankItem:function(t){var e={},i=new cc.Node;e.container=i,i.setAnchorPoint(cc.v2(0,1)),i.setContentSize(cc.size(180,40));var s=Utils.createImage(i,null,0,0,cc.v2(0,1));this.loadImage(s,o.getUIIconPath("common","common_300"+t)),s.node.scale=.5,s.node.x=10,s.node.y=20,e.sp=s;var n=Utils.createLabel(20,this.color_1,null,60,20,"",i);return n.node.setAnchorPoint(0,1),e.label=n,e},refreshGuildWarPosition:function(){this.position_vo_data={},this.guildwar_status!=n.status.processing&&this.guildwar_status!=n.status.settlement||(this.cur_position_type==n.positions.myself?this.position_vo_data=this.model.getMyGuildWarPositionList():this.cur_position_type==n.positions.others&&(this.position_vo_data=this.model.getEnemyGuildWarPositionList())),this.dynamicShowGuildWarPosition()},dynamicShowGuildWarPosition:function(){for(var t in this.checkPositionMoveToPool(),this.position_vo_data){var e=this.position_vo_data[t],i=Config.guild_war_data.data_position[e.pos];if(i&&!this.position_pos[e.pos]&&this.checkPositionIsInDisplayRect(i.pos_x,i.pos_y)){var s=this.position_pool.shift();null==s&&((s=new r).show(),s.setParent(this.map_layer)),s.setVisible(!0),s.setData(e,this.cur_position_type),s.setPosition(i.pos_x,i.pos_y),this.position_stack.push(s),this.position_pos[e.pos]=!0}}},checkPositionMoveToPool:function(){for(var t=0;t<this.position_stack.length;t++){var e=this.position_stack[t],i=e.getPosition();if(!this.checkPositionIsInDisplayRect(i.x,i.y)){var s=e.getPositionPos();e.setVisible(!1),e.suspendAllActions(),this.position_pool.push(e),this.position_stack.splice(t,1),this.position_pos[s]=null}}},checkPositionIsInDisplayRect:function(t,e){var i=!0,s=this.map_layer.getPosition(),n=Math.abs(s.x),a=Math.abs(s.y);return(t+95<n-360||t-95>n+this.free_size.width-360||e+226<a-640||e>a-640+1280)&&(i=!1),i},changeGuildwarPositionType:function(){this.map_layer.setPosition(cc.v2(this.map_layer_posX,this.free_size.height-this.map_size.height+this.map_layer_posY));for(var t=1;t<4;t++){var e=1280*(6-t),i=this.map_bgs[t];i&&i.node.setPosition(cc.v2(0,e))}for(t=this.position_stack.length;t>0;t--){var s=this.position_stack.pop(),a=s.getPositionPos();s.setVisible(!1),s.suspendAllActions(),this.position_pool.push(s),this.position_pos[a]=null}if(this.cur_position_type==n.positions.myself)this.cur_position_type=n.positions.others,this.refreshGuildWarPosition(),this.change_scene_btn_lb.string=Utils.TI18N("\u654c\u65b9\u9635\u5730");else{this.cur_position_type=n.positions.myself,this.change_scene_btn_lb.string=Utils.TI18N("\u6211\u65b9\u9635\u5730");var o=this.model.getMyGuildWarPositionList();null==Utils.next(o)?this.ctrl.requestMyGuildPositionData():this.refreshGuildWarPosition()}},updateMainRedStatus:function(t,e){if(t==s.red_index.guildwar_match)Utils.addRedPointToNodeByStatus(this.clash_list_btn,e);else if(t==s.red_index.guildwar_log)Utils.addRedPointToNodeByStatus(this.ally_atk_btn,e);else if(t==s.red_index.guildwar_box)Utils.addRedPointToNodeByStatus(this.award_box_btn,e),Utils.addRedPointToNodeByStatus(this.look_box_btn,e);else{var i=this.model.checkRedIsShowByRedType(s.red_index.guildwar_match);Utils.addRedPointToNodeByStatus(this.clash_list_btn,i);var n=this.model.checkRedIsShowByRedType(s.red_index.guildwar_log);Utils.addRedPointToNodeByStatus(this.ally_atk_btn,n);var a=this.model.checkRedIsShowByRedType(s.red_index.guildwar_box);Utils.addRedPointToNodeByStatus(this.award_box_btn,a),Utils.addRedPointToNodeByStatus(this.look_box_btn,a)}},closeCallBack:function(){for(var t in this.position_stack)this.position_stack[t]&&(this.position_stack[t].deleteMe(),this.position_stack[t]=null);for(var t in this.position_stack=null,this.position_pool)this.position_pool[t]&&(this.position_pool[t].deleteMe(),this.position_pool[t]=null);this.position_pool=null,this.openGuildWarSurplusTimer(!1),this.ctrl.openMainWindow(!1)}});cc._RF.pop()},{guild_const:"guild_const",guildwar_const:"guildwar_const",guildwar_controller:"guildwar_controller",guildwar_event:"guildwar_event",guildwar_position_item:"guildwar_position_item",mainui_controller:"mainui_controller",pathtool:"pathtool",timetool:"timetool"}],guildwar_model:[function(t,e,i){"use strict";cc._RF.push(e,"dc0cbWrCZpHsKhtL0KmhaiN","guildwar_model");var s=t("guild_const"),n=t("guildwar_const"),a=t("guildwar_position_vo"),o=t("guild_event"),l=t("guildwar_event"),r=t("guildwar_box_vo");cc.Class({extends:BaseClass,ctor:function(){this.ctrl=arguments[0]},properties:{},initConfig:function(){this.challengeCount=0,this.guildWarResult=n.result.fighting,this.myGuildWarBaseInfo={},this.enemyGuildWarBaseInfo={},this.guildWarStatus=n.status.close,this.guildWarStartTime=0,this.guildWarEndTime=0,this.guildWarEnemyFlag=0,this.guildWarTopThreeRank={},this.myGuildWarPositionList={},this.enemyGuildWarPositionList={},this.award_box_data=[],this.guildwar_red_list={}},checkIsHaveEnemyCacheData:function(){return null!=Utils.next(this.enemyGuildWarPositionList)},setGuildWarChallengeCount:function(t){this.challengeCount=t||0,this.updateChallengeCountRedStatus(0)},getGuildWarChallengeCount:function(){return this.challengeCount},updateChallengeCountRedStatus:function(){1==this.guildWarEnemyFlag&&this.guildWarStatus==n.status.processing&&this.challengeCount<Config.guild_war_data.data_const.challange_time_limit.val?this.updateGuildWarRedStatus(s.red_index.guildwar_count,!0):this.updateGuildWarRedStatus(s.red_index.guildwar_count,!1)},setGuildWarResult:function(t){this.guildWarResult=t},getGuildWarResult:function(){return this.guildWarResult},setMyGuildWarBaseInfo:function(t){this.myGuildWarBaseInfo=t||{}},getMyGuildWarBaseInfo:function(){return this.myGuildWarBaseInfo},updateMyGuildWarBaseInfo:function(t){for(var e in t)this.myGuildWarBaseInfo[e]=t[e]},updateEnemyGuildWarBaseInfo:function(t){this.enemyGuildWarBaseInfo.hp=t},getEnemyGuildWarBaseInfo:function(){return this.enemyGuildWarBaseInfo},setEnemyGuildWarData:function(t){for(var e in this.enemyGuildWarBaseInfo.gname=t.gname2||"",this.enemyGuildWarBaseInfo.hp=t.hp2||0,this.enemyGuildWarBaseInfo.g_id=t.g_id||0,this.enemyGuildWarBaseInfo.g_sid=t.g_sid||"",this.enemyGuildWarPositionList={},t.defense||{}){var i=t.defense[e],s=new a;s.updateData(i),this.enemyGuildWarPositionList[i.pos]=s}},getEnemyGuildWarPositionList:function(){var t=[];for(var e in this.enemyGuildWarPositionList){var i=this.enemyGuildWarPositionList[e];i&&t.push(i)}return t},getEnemyPositionHpByPos:function(t){var e=this.enemyGuildWarPositionList[t];return e?e.hp:0},checkEnemyIsHaveLivePosition:function(){var t=!1;for(var e in this.enemyGuildWarPositionList){if(this.enemyGuildWarPositionList[e].hp>0){t=!0;break}}return t},setGuildWarStatus:function(t){this.guildWarStatus=t.status||n.status.close,this.guildWarStartTime=t.start_time||0,this.guildWarEndTime=t.end_time||0,this.guildWarEnemyFlag=t.flag||0,this.guildWarStatus==n.status.close&&this.initConfig(),this.checkGuildWarStatusRed(),this.updateChallengeCountRedStatus()},checkGuildWarStatusRed:function(){1==this.guildWarEnemyFlag&&this.guildWarStatus==n.status.showing?this.updateGuildWarRedStatus(s.red_index.guildwar_match,!0):1==this.guildWarEnemyFlag&&this.guildWarStatus==n.status.processing?(this.updateGuildWarRedStatus(s.red_index.guildwar_start,!0),this.updateGuildWarRedStatus(s.red_index.guildwar_match,!1)):(this.updateGuildWarRedStatus(s.red_index.guildwar_match,!1),this.updateGuildWarRedStatus(s.red_index.guildwar_start,!1))},getGuildWarStatus:function(){return this.guildWarStatus},getGuildWarSurplusTime:function(){return this.guildWarEndTime-gcore.SmartSocket.getTime()},getGuildWarEnemyFlag:function(){return this.guildWarEnemyFlag},setMyGuildWarPositionData:function(t){for(var e in this.myGuildWarPositionList={},t){var i=t[e],s=new a;s.updateData(i),this.myGuildWarPositionList[i.pos]=s}},getMyGuildWarPositionList:function(){return this.myGuildWarPositionList},updateMyGuildWarPositionData:function(t){for(var e in t=t||{}){var i=t[e],s=this.myGuildWarPositionList[i.pos];s&&s.updateData(i)}},updateEnemyGuildWarPositionData:function(t){for(var e in t=t||{}){var i=t[e],s=this.enemyGuildWarPositionList[i.pos];s&&s.updateData(i)}},setGuildWarTopThreeRank:function(t){this.guildWarTopThreeRank=t},getGuildWarTopThreeRank:function(){return this.guildWarTopThreeRank},updateGuildWarRedStatus:function(e,i,s){if(null==this.guildwar_red_list&&(this.guildwar_red_list={}),this.guildwar_red_list[e]!=i){if(this.guildwar_red_list[e]=i,!s){var n=t("mainui_const");t("mainui_controller").getInstance().setBtnRedPoint(n.btn_index.guild,{bid:e,status:i}),gcore.GlobalEvent.fire(o.UpdateGuildRedStatus,e,i)}gcore.GlobalEvent.fire(l.UpdateGuildWarRedStatusEvent,e,i)}},checkRedIsShowByRedType:function(t){return this.guildwar_red_list[t]||!1},checkGuildGuildWarRedStatus:function(){for(var t in this.guildwar_red_list){if(1==this.guildwar_red_list[t]&&t!=s.red_index.guildwar_log)return!0}return!1},setGuildWarBoxData:function(t){var e=t.guild_war_box,i=t.result,n=t.status,a=t.end_time;if(e)for(var o in this.award_box_data=[],e){(t=e[o]).status=i;var l=new r;l.updateData(t),this.award_box_data.push(l)}var c=gcore.SmartSocket.getTime();this.is_can_get_box=!!(n&&1==n&&a&&a>c),this.is_can_get_box&&!this.checkIsGetBoxAward()?this.updateGuildWarRedStatus(s.red_index.guildwar_box,!0):this.updateGuildWarRedStatus(s.red_index.guildwar_box,!1)},updateGuildWarBoxData:function(t){if(t){var e=this.getGuildWarDataByOrder(t.order);e&&e.updateData(t),this.is_can_get_box&&!this.checkIsGetBoxAward()?this.updateGuildWarRedStatus(s.red_index.guildwar_box,!0):this.updateGuildWarRedStatus(s.red_index.guildwar_box,!1)}},getGuildWarDataByOrder:function(t){for(var e in this.award_box_data){var i=this.award_box_data[e];if(i.order==t)return i}},getGuildWarBoxData:function(){return this.award_box_data},checkIsGetBoxAward:function(){var e=!1,i=t("role_controller").getInstance().getRoleVo();for(var s in this.award_box_data){var n=this.award_box_data[s];if(n.rid==i.rid&&n.sid==i.srv_id){e=!0;break}}return e}});cc._RF.pop()},{guild_const:"guild_const",guild_event:"guild_event",guildwar_box_vo:"guildwar_box_vo",guildwar_const:"guildwar_const",guildwar_event:"guildwar_event",guildwar_position_vo:"guildwar_position_vo",mainui_const:"mainui_const",mainui_controller:"mainui_controller",role_controller:"role_controller"}],guildwar_position_item:[function(t,e,i){"use strict";function s(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}cc._RF.push(e,"934d8d//01LcqCnjdwEg0Qf","guildwar_position_item");var n=t("pathtool"),a=t("guildwar_const"),o=t("role_controller"),l=t("guildwar_event");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=n.getPrefabPath("guildwar","guildwar_position")},initConfig:function(){this.star_list={},this.ctrl=t("guildwar_controller").getInstance(),this.model=this.ctrl.getModel(),this.color_1=new cc.Color(123,194,244),this.color_2=new cc.Color(244,140,123)},initPanel:function(){var t;this.container=this.seekChild("container"),this.build_sp=this.seekChild("build",cc.Sprite),this.name_label_lb=this.seekChild("name_label",cc.Label),this.attk_label_lb=this.seekChild("attk_label",cc.Label),this.pos_bg_nd=this.seekChild("pos_bg"),this.pos_label_lb=this.seekChild(this.pos_bg_nd,"pos_label",cc.Label),this.image_success_nd=this.seekChild("image_success"),this.image_success_nd.zIndex=10,this.image_buff=this.seekChild(this.image_success_nd,"image_buff",cc.Sprite),this.loadRes(n.getIconPath("bufficon","2"),function(t){this.image_buff.spriteFrame=t}.bind(this));for(var e=(s(t={},1,3),s(t,2,2),s(t,3,1),t),i=1;i<=3;i++){var a=this.seekChild("star_"+i);if(a){a.active=!1;var o=e[i];this.star_list[o]=a}}this.parent_nd&&this.setParentIndex(this.parent_nd,this.z_index)},registerEvent:function(){Utils.onTouchEnd(this.container,function(){if(this.cur_position_type==a.positions.others&&this.data&&this.data.pos)this.model.getGuildWarStatus()==a.status.settlement?message(Utils.TI18N("\u672c\u6b21\u516c\u4f1a\u6218\u5df2\u7ed3\u675f\u5566\uff0c\u4e0d\u80fd\u518d\u6311\u6218\u4e86\u54e6")):this.ctrl.openAttkPositionWindow(!0,this.data.pos);else if(this.cur_position_type==a.positions.myself&&this.data&&this.data.pos){var t=o.getInstance().getRoleVo();0!=t.gid&&this.ctrl.openDefendLookWindow(!0,t.gid,t.gsrv_id,this.data.pos)}}.bind(this),1)},setData:function(t,e){null!=this.data&&null!=this.update_self_event&&(this.data.unbind(this.update_self_event),this.update_self_event=null),null!=t&&(this.data=t,null==this.update_self_event&&(this.update_self_event=this.data.bind(l.UpdateGuildWarPositionDataEvent,function(){this.onShow()},this))),this.cur_position_type=e,this.root_wnd&&this.onShow()},onShow:function(t){if(null!=this.data){if(0==this.data.hp){if(this.loadRes(n.getUIIconPath("guildwar","guildwar_1020"),function(t){this.build_sp.spriteFrame=t}.bind(this)),!this.special_sk){this.special_sk=this.seekChild("special_sk",sp.Skeleton);var e=cc.js.formatStr("spine/%s/action.atlas",n.getEffectRes(326));this.loadRes(e,function(t){this.special_sk.skeletonData=t,this.special_sk.setAnimation(1,PlayerAction.action,!0)}.bind(this))}this.special_sk.node.active=!0}else this.loadRes(n.getUIIconPath("guildwar","guildwar_1017"),function(t){this.build_sp.spriteFrame=t}.bind(this)),this.special_sk&&(this.special_sk.node.active=!1);for(var i=1;i<4;i++){var s=this.star_list[i];this.data.hp<i?s.active=!0:s.active=!1}this.pos_label_lb.string=this.data.pos;var l="";if(this.cur_position_type==a.positions.others)l=this.model.getEnemyGuildWarBaseInfo().g_sid||"";else l=o.getInstance().getRoleVo().gsrv_id||"";var r=l.search("_"),c=1;null!=r&&(c=l.substring(r+1));var _=cc.js.formatStr("[S%s]%s",c,this.data.name);this.name_label_lb.string=_,this.attk_label_lb.string=Utils.TI18N(cc.js.formatStr("\u6218\u529b:%d",this.data.power)),this.image_success_nd.active=!1,this.cur_position_type==a.positions.myself?this.name_label_lb.node.color=this.color_1:(this.name_label_lb.node.color=this.color_2,this.image_success_nd.active=this.data.hp<=0);var h=this.name_label_lb.node.getContentSize(),d=this.name_label_lb.node.x;this.pos_bg_nd.x=d-h.width/2}},getPositionPos:function(){return this.data.pos},suspendAllActions:function(){null!=this.data&&(null!=this.update_self_event&&(this.data.unbind(this.update_self_event),this.update_self_event=null),this.data=null)},getPosition:function(){return this.root_wnd?cc.v2(this.root_wnd.x,this.root_wnd.y):cc.v2(0,0)},setParentIndex:function(t,e){this.root_wnd?t.addChild(this.root_wnd,e):(this.parent_nd=t,this.z_index=e)},onHide:function(){},onDelete:function(){this.special_sk&&(this.special_sk.setToSetupPose(),this.special_sk.clearTracks()),this.suspendAllActions()}});cc._RF.pop()},{guildwar_const:"guildwar_const",guildwar_controller:"guildwar_controller",guildwar_event:"guildwar_event",pathtool:"pathtool",role_controller:"role_controller"}],guildwar_position_vo:[function(t,e,i){"use strict";cc._RF.push(e,"63c72QukVdJ2JcVdrkL0iNh","guildwar_position_vo");var s=t("guildwar_const"),n=t("guildwar_event"),a=cc.Class({extends:gcore.BaseEvent,ctor:function(){this.pos=0,this.rid=0,this.srv_id=0,this.name="",this.lev=0,this.face=0,this.power=0,this.hp=0,this.hp_max=0,this.relic_def_count=0,this.status=s.position_status.normal},updateData:function(t){for(var e in t){var i=t[e];this[e]=i}this.fire(n.UpdateGuildWarPositionDataEvent)},_delete:function(){}});e.exports=a,cc._RF.pop()},{guildwar_const:"guildwar_const",guildwar_event:"guildwar_event"}],guildwar_rank_window:[function(t,e,i){"use strict";function s(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}cc._RF.push(e,"e31c159Ma1PWKAm5zwgVnPf","guildwar_rank_window");var n=t("pathtool"),a=t("rank_constant"),o=t("guildwar_event"),l=t("rank_item"),r=t("common_scrollview"),c=t("role_controller"),_=t("playerhead");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=n.getPrefabPath("rank","rank_window"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Big},initConfig:function(){this.first_list={},this.click_index=a.RankType.guild_war,this.ctrl=t("guildwar_controller").getInstance(),this.model=this.ctrl.getModel(),this.node_list=[]},openCallBack:function(){this.background=this.seekChild("background"),this.main_panel=this.seekChild("main_container"),this.close_btn=this.seekChild("close_btn"),this.rank_panel=this.seekChild("rank_panel"),this.my_rank=this.seekChild("my_rank"),this.rank_index=this.seekChild(this.my_rank,"rank_id",cc.Label),this.four_label=this.seekChild(this.my_rank,"four_label",cc.RichText),this.my_rank_power=this.seekChild(this.my_rank,"my_rank_power",cc.Label),this.my_head=new _,this.my_head.setParent(this.my_rank),this.my_head.show(),this.my_head.setPosition(-155,60),this.my_head.setScale(.9),this.no_rank=this.seekChild(this.my_rank,"no_rank",cc.Label),this.my_name=this.seekChild(this.my_rank,"my_name",cc.Label),this.no_rank.string="\u672a\u4e0a\u699c",this.my_name.string="",this.star_label=Utils.createLabel(24,new cc.Color(104,69,42,255),null,402,56,"",this.my_rank,0,cc.v2(0,.5)),this.score_label=Utils.createLabel(24,new cc.Color(104,69,42,255),null,525,56,"",this.my_rank,0,cc.v2(0,.5)),this.node_list.push(this.star_label),this.node_list.push(this.score_label),this.title_con=this.seekChild(this.main_panel,"title_con");var t=this.seekChild(this.title_con,"title_label",cc.Label),e=a.TitleName[this.click_index]||"";t.string=e,this.top_bg=this.seekChild(this.main_panel,"top_bg",cc.Sprite),this.top_bg.node.setScale(.9,.9);var i=n.getBigBg("rank_1",null,"rank");this.loadRes(i,function(t){this.top_bg.spriteFrame=t}.bind(this)),this.top_container=this.seekChild("top_container"),this.top_rank_list={};for(var s=1;s<=3;s++){var o=this.seekChild(this.top_container,"name_"+s,cc.Label),c=this.seekChild(this.top_container,"guan_"+s);null==this.top_rank_list[s]&&(this.top_rank_list[s]={},this.top_rank_list[s].label=o,this.top_rank_list[s].img=c)}var h=cc.size(610,530),d={item_class:l,start_x:5,space_x:0,start_y:0,space_y:0,item_width:600,item_height:120,row:0,col:1,need_dynamic:!0};this.list_view=new r,this.list_view.createScroll(this.rank_panel,cc.v2(0,-28),ScrollViewDir.vertical,ScrollViewStartPos.top,h,d,cc.v2(.5,.5)),this.updateTitle()},registerEvent:function(){this.background.on(cc.Node.EventType.TOUCH_END,function(){this.ctrl.openGuildWarRankView(!1)},this),this.close_btn.on(cc.Node.EventType.TOUCH_END,function(){this.ctrl.openGuildWarRankView(!1)},this),this.addGlobalEvent(o.UpdateGuildWarRankDataEvent,function(t){this.updateRankList(t)},this)},updateTitle:function(){for(var t=a.RankTitle[this.click_index]||{},e=Object.keys(t).length||0,i=a.TitlePos[this.click_index]||{},s=a.TitleLinePos[this.click_index]||{},n=1;n<=e;n++){n!=e&&this.createImage(s[n]);var o=i[n]||0,l=Utils.createLabel(24,new cc.Color(104,69,42,255),null,o-336,230,"",this.main_panel,0,cc.v2(0,.5)),r=t[n]||"";l.string=r,this.node_list.push(l)}},createImage:function(t){var e=t||0,i=n.getCommonIcomPath("common_1069"),s=Utils.createImage(this.main_panel,i,e-338,230,cc.v2(0,.5),!0,1,!1);this.loadRes(i,function(t){s.spriteFrame=t}.bind(this)),s.node.setScale(1,.8),this.node_list.push(s)},openRootWnd:function(t){this.ctrl.requestGuildWarRankData()},updateRankList:function(t){this.rank_data=t,this.updateMyData(),this.updateRankData(),this.rank_data.length<=0?this.showEmptyIcon(!0):this.showEmptyIcon(!1),this.list_view.setData(this.rank_data,null,{rank_type:a.RankType.guild_war})},getMyselfRankData:function(t,e){var i={};for(var s in this.rank_data){var n=this.rank_data[s];if(n.rid==t&&n.srv_id==e){i=n;break}}return i},updateMyData:function(){if(this.rank_data){var t=c.getInstance().getRoleVo(),e=this.getMyselfRankData(t.rid,t.srv_id),i="0",s=e.rank||0;s&&s>0&&(i=s),this.no_rank.node.active=!1,this.rank_index.string=i,s&&s>=1&&s<=3?(this.rank_index.node.active=!1,this.my_rank_icon||(this.my_rank_icon=this.seekChild(this.my_rank,"my_rank_icon",cc.Sprite)),this.my_rank_icon.node.active=!0,this.loadRes(n.getUIIconPath("common","common_300"+s),function(t){this.my_rank_icon.spriteFrame=t}.bind(this)),this.my_rank_icon.node.scale=.7):s<=0?(this.no_rank.node.active=!0,this.rank_index.node.active=!1):(this.rank_index.node.active=!0,this.my_rank_icon&&(this.my_rank_icon.node.active=!1)),this.my_head.setHeadRes(t.face_id),this.star_label.string=e.star||"",this.my_name.string=e.name||"",this.score_label.string=e.war_score||""}},updateRankData:function(){var e;if(this.rank_data){var i=this.rank_data||{},n=0,a=this.main_panel.getContentSize();for(var o in i){var l=i[o],r=l.idx||l.rank;if(r>0&&r<=3){if(n+=1,!this.first_list[r]){var h=new _;h.show();var d=0,u=373;2==r?(d=-170,u=360,6):3==r&&(d=170,u=360,6),h.setPosition(d,u),h.setParent(this.main_panel),(p=this.top_rank_list[n].label).node.active=!0;var m=this.top_rank_list[n].img;m.active=!0,this.first_list[r]=m,this.first_list[r]=h,this.first_list[r].head_name=p}var f=l.face_id||l.face||l.leader_face||0;l.avatar_bid||l.leader_avatar_bid;this.first_list[r].setHeadRes(f),this.first_list[r].addCallBack(function(e){var i=c.getInstance().getRoleVo(),s=e.rid||e.leader_rid||0,n=e.srv_id||e.leader_srvid||0;if(i.rid!=s||i.srv_id!=n){var a={rid:s,srv_id:n};t("chat_controller").getInstance().openFriendInfo(a)}}.bind(this,l));var p=l.name||"";this.first_list[r].head_name.string=p}if(n>=3)break}for(var o in this.no_label_list||(this.no_label_list={}),this.no_label_list)this.no_label_list[o].setVisible(!1);var g=(s(e={},1,336-a.width/2),s(e,2,167-a.width/2),s(e,3,508-a.width/2),e);if(i.length<3)for(o=i.length+1;o<=3;o++){if(!this.no_label_list[o]){var v=Utils.createLabel(24,null,null,g[o],360,Utils.TI18N("\u865a\u4f4d\u4ee5\u5f85"),this.main_panel,0,cc.v2(.5,.5));this.no_label_list[o]=v.node,this.node_list.push(v),this.top_rank_list[o]&&(this.top_rank_list[o].label.node.active=!1,this.top_rank_list[o].img.active=!1)}this.no_label_list[o].active=!0}}},showEmptyIcon:function(t){if(this.empty_con||0!=t){if(!this.empty_con){var e=cc.size(200,200);this.empty_con=new cc.Node,this.empty_con.setContentSize(e),this.empty_con.setAnchorPoint(cc.v2(.5,.5)),this.empty_con.setPosition(cc.v2(0,0)),this.main_panel.addChild(this.empty_con);var i=n.getBigBg("bigbg_3");this.empty_bg=Utils.createImage(this.empty_con,null,0,0,cc.v2(.5,.5),!1),this.loadRes(i,function(t){this.empty_bg.spriteFrame=t}.bind(this)),this.empty_label=Utils.createLabel(26,new cc.Color(104,69,42,255),null,0,-100,"",this.empty_con,0,cc.v2(.5,.5))}var s=Utils.TI18N("\u5f53\u524d\u6392\u884c\u699c\u6682\u65e0\u6570\u636e");this.empty_label.string=s,this.empty_con.active=t}},closeCallBack:function(){if(this.node_list){for(var t in this.node_list){var e=this.node_list[t];e instanceof cc.Node?(e.destroy(),e=null):(e.node.destroy(),e=null)}this.node_list=null}this.empty_con&&(this.empty_con.destroy(),this.empty_label.destroy(),this.empty_bg.destroy(),this.empty_con=null,this.empty_bg=null,this.empty_label=null),this.my_head&&(this.my_head.deleteMe(),this.my_head=null),this.ctrl.openGuildWarRankView(!1)}});cc._RF.pop()},{chat_controller:"chat_controller",common_scrollview:"common_scrollview",guildwar_controller:"guildwar_controller",guildwar_event:"guildwar_event",pathtool:"pathtool",playerhead:"playerhead",rank_constant:"rank_constant",rank_item:"rank_item",role_controller:"role_controller"}],hallows_activity_window:[function(t,e,i){"use strict";cc._RF.push(e,"3e454zAnlFJ8r0ZWN/tMWTO","hallows_activity_window");var s=t("pathtool"),n=t("hallows_const");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("hallows","hallows_activity_window"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Big,this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){},openCallBack:function(){this.background=this.root_wnd.getChildByName("background"),this.background.scale=FIT_SCALE,this.main_container=this.root_wnd.getChildByName("main_container"),this.background_img=this.main_container.getChildByName("background").getComponent(cc.Sprite),this.loadRes(s.getUIIconPath("levupgrade","levupgrade_1"),function(t){this.background_img.spriteFrame=t}.bind(this)),this.Image_1=this.main_container.getChildByName("Image_1").getComponent(cc.Sprite),this.loadRes(s.getUIIconPath("levupgrade","levupgrade_2"),function(t){this.Image_1.spriteFrame=t}.bind(this)),this.hallows_eff_node=this.seekChild("hallows_eff_node"),this.hallows_eff_sk=this.seekChild("hallows_eff_node",sp.Skeleton),this.title_eff_node=this.seekChild("title_eff_node"),this.title_eff_sk=this.seekChild("title_eff_node",sp.Skeleton),this.hallows_name=this.main_container.getChildByName("hallows_name").getComponent(cc.Label),this.desc=this.main_container.getChildByName("desc").getComponent(cc.Label),this.desc.string=Utils.TI18N("\u5168\u4f53\u4e0a\u9635\u82f1\u96c4"),this.close_btn=this.main_container.getChildByName("close_btn");var t=this.root_wnd.getChildByName("item_1");this.item_bg=t.getComponent(cc.Sprite),this.loadRes(s.getCommonIcomPath("common_90044"),function(t){this.item_bg.spriteFrame=t}.bind(this)),this.attr_1=Utils.createRichLabel(24,new cc.Color(255,232,183,255),cc.v2(0,.5),cc.v2(160,20),30),this.attr_1.horizontalAlign=cc.macro.TextAlignment.LEFT,t.addChild(this.attr_1.node),this.attr_2=Utils.createRichLabel(24,new cc.Color(255,232,183,255),cc.v2(0,.5),cc.v2(430,20),30),this.attr_2.horizontalAlign=cc.macro.TextAlignment.LEFT,t.addChild(this.attr_2.node)},registerEvent:function(){this.close_btn.on(cc.Node.EventType.TOUCH_END,function(){Utils.playButtonSound(ButtonSound.Close),this.ctrl.openHallowsActivityWindow(!1)},this)},openRootWnd:function(t){if(this.data=t,this.handleEffect(!0),t&&(this.step_config=gdata("hallows_data","data_info",Utils.getNorKey(t.id,t.step)),this.step_config)){this.hallows_name.string=this.step_config.name;for(var e=this.step_config.attr,i=1;i<3;i++)this["attr_"+i].string="";if(e&&Utils.next(e))for(var s in e){if(s>2)break;var n=e[s][0],a=e[s][1],o=Config.attr_data.data_key_to_name[n];if(o){var l=cc.js.formatStr("%s<color=#ffffff>    +%s</c>",o,a);this["attr_"+(parseInt(s)+1)].string=l}}this.updateHallowsBaseInfo()}},updateHallowsBaseInfo:function(){if(null!=this.step_config){var t=s.getSpinePath(this.step_config.effect,"action");this.loadRes(t,function(t){this.hallows_eff_sk.skeletonData=t,this.hallows_eff_sk.setAnimation(0,PlayerAction.action_2,!0)}.bind(this))}},handleEffect:function(t){if(t){var e=PlayerAction.action_1;this.open_type==n.Activity_Type.Magic&&(e=PlayerAction.action_2);var i=s.getSpinePath(s.getEffectRes(549),"action");this.loadRes(i,function(t){this.title_eff_sk.skeletonData=t,this.title_eff_sk.setAnimation(0,e,!1)}.bind(this))}else this.title_eff_sk&&(this.title_eff_sk.setToSetupPose(),this.title_eff_sk.clearTracks())},closeCallBack:function(){this.hallows_eff_sk&&(this.hallows_eff_sk.setToSetupPose(),this.hallows_eff_sk.clearTracks()),this.handleEffect(!1),this.ctrl.openHallowsActivityWindow(!1)}});cc._RF.pop()},{hallows_const:"hallows_const",pathtool:"pathtool"}],hallows_const:[function(t,e,i){"use strict";cc._RF.push(e,"2aa5c7hqHNBuqAL5g3cWtXk","hallows_const");e.exports={Tab_Index:{uplv:1,skill:2},Status:{close:1,underway:2,open:3},Red_Index:{task_award:1,hallows_lvup:2,skill_lvup:3,stone_use:4},Activity_Type:{Hallows:1,Magic:2}},cc._RF.pop()},{}],hallows_controller:[function(t,e,i){"use strict";cc._RF.push(e,"ce806DRwFFKc4wfxpJUe+aC","hallows_controller");var s=t("mainui_const"),n=t("mainui_controller"),a=t("backpack_event"),o=t("battle_drama_event"),l=t("hallows_event"),r=t("backpack_const"),c=cc.Class({extends:BaseController,ctor:function(){},initConfig:function(){var e=t("hallows_model");this.model=new e,this.model.initConfig()},getModel:function(){return this.model},registerEvents:function(){null==this.battle_drama_event&&(this.battle_drama_event=gcore.GlobalEvent.bind(o.BattleDrama_Update_Max_Id,function(t){this.requestInitProtocals(t)}.bind(this))),null==this.goods_add_event&&(this.goods_add_event=gcore.GlobalEvent.bind(a.ADD_GOODS,function(t,e){t==r.Bag_Code.BACKPACK&&this.checkNeedUpdateRedStatus(e)}.bind(this))),null==this.goods_update_event&&(this.goods_update_event=gcore.GlobalEvent.bind(a.MODIFY_GOODS_NUM,function(t,e){t==r.Bag_Code.BACKPACK&&this.checkNeedUpdateRedStatus(e)}.bind(this))),null==this.goods_del_event&&(this.goods_del_event=gcore.GlobalEvent.bind(a.DELETE_GOODS,function(t,e){t==r.Bag_Code.BACKPACK&&this.checkNeedUpdateRedStatus(e)}.bind(this))),(this.re_link_game_event=null)&&(this.re_link_game_event=gcore.GlobalEvent.bind(EventId.EVT_RE_LINK_GAME,function(){t("guide_controller").getInstance().isInGuide()||(this.resonate_data=null,this.openHallowsMainWindow(!1))}.bind(this)))},checkNeedUpdateRedStatus:function(t){if(this.is_self_handle)this.is_self_handle=!1;else if(null!=this.item_list&&null!=Utils.next(t))for(var e in t){var i=t[e].config;i&&(72001!=i.id&&72002!=i.id&&72003!=i.id||this.model.checkHallowsRedStatus())}},registerProtocals:function(){this.RegisterProtocal(24100,this.handle24100),this.RegisterProtocal(24101,this.handle24101),this.RegisterProtocal(24102,this.handle24102),this.RegisterProtocal(24103,this.handle24103),this.RegisterProtocal(24104,this.handle24104),this.RegisterProtocal(24105,this.handle24105),this.RegisterProtocal(24107,this.handle24107),this.RegisterProtocal(24108,this.handle24108),this.RegisterProtocal(24120,this.handle24120),this.RegisterProtocal(24121,this.handle24121),this.RegisterProtocal(24122,this.handle24122),this.RegisterProtocal(24123,this.handle24123),this.RegisterProtocal(24124,this.handle24124)},checkIsOpen:function(t){var e=Config.function_data.data_base[s.btn_index.hallows+1];if(null==e)return!1;var i=n.getInstance().checkIsOpenByActivate(e.activate);return t&&!i&&message(e.desc),i},requestInitProtocals:function(){this.checkIsOpen()&&(this.battle_drama_event&&(gcore.GlobalEvent.unbind(this.battle_drama_event),this.battle_drama_event=null),this.requestHallowsInfo())},getHallowsRoot:function(t){if(t)this.hallows_window?this.hallows_window.getRootWnd(t):t(null);else if(this.hallows_window)return this.hallows_window.root_wnd},getHallowsActivityRoot:function(t){if(t)this.activity_window?this.activity_window.getRootWnd(t):t(null);else if(this.activity_window)return this.activity_window.root_wnd},getHallowsPreviewRoot:function(t){if(t)this.hallows_preview?this.hallows_preview.getRootWnd(t):t(null);else if(this.hallows_preview)return this.hallows_preview.root_wnd},openHallowsMainWindow:function(t,e,i){if(t){if(!this.checkIsOpen(!0))return;null==this.hallows_window&&(this.model.checkIsHaveAllHallows()?this.hallows_window=Utils.createClass("hallows_main_window",this):this.hallows_window=Utils.createClass("hallows_task_window",this)),this.hallows_window&&0==this.hallows_window.isOpen()&&this.hallows_window.open(e,i)}else this.hallows_window&&(this.hallows_window.close(),this.hallows_window=null)},openHallowsPreviewWindow:function(t){t?(null==this.hallows_preview&&(this.hallows_preview=Utils.createClass("hallows_preview_window",this)),this.hallows_preview&&0==this.hallows_preview.isOpen()&&this.hallows_preview.open()):this.hallows_preview&&(this.hallows_preview.close(),this.hallows_preview=null)},openHallowsTraceWindow:function(t,e){if(t){if(null==e)return;null==this.trace_window&&(this.trace_window=Utils.createClass("hallows_trace_window",this)),this.trace_window&&0==this.trace_window.isOpen()&&this.trace_window.open(e)}else this.trace_window&&(this.trace_window.close(),this.trace_window=null)},openHallowsTips:function(t,e){if(t){if(null==e)return;null==this.hallows_tips&&(this.hallows_tips=Utils.createClass("hallows_tips_window",this)),this.hallows_tips&&0==this.hallows_tips.isOpen()&&this.hallows_tips.open(e)}else this.hallows_tips&&(this.hallows_tips.close(),this.hallows_tips=null)},openHallowsActivityWindow:function(t,e){if(t){if(null==e)return;null==this.activity_window&&(this.activity_window=Utils.createClass("hallows_activity_window",this)),this.activity_window&&0==this.activity_window.isOpen()&&this.activity_window.open(e)}else this.activity_window&&(this.activity_window.close(),this.activity_window=null)},openHallowsStepUpWindow:function(t,e){if(t){if(null==e)return;null==this.step_up_window&&(this.step_up_window=Utils.createClass("hallows_step_up_window",this)),this.step_up_window&&0==this.step_up_window.isOpen()&&this.step_up_window.open(e)}else this.step_up_window&&(this.step_up_window.close(),this.step_up_window=null),this.resonate_data&&(this.openHallowsResonateUpWindow(!0,this.resonate_data),this.resonate_data=null)},requestHallowsInfo:function(){this.SendProtocal(24100,{}),this.SendProtocal(24120,{})},handle24100:function(t){this.model.updateHallowsInfo(t)},handle24107:function(t){this.model.updateHallowsData(t),gcore.GlobalEvent.fire(l.HallowsUpdateEvent,t.id)},handle24108:function(t){this.model.updateHallowsData(t),this.model.checkIsHaveAllHallows()&&this.hallows_window&&(this.openHallowsMainWindow(!1),this.openHallowsMainWindow(!0)),gcore.GlobalEvent.fire(l.HallowsActivityEvent,t.id),this.openHallowsActivityWindow(!0,t)},requestHallowsAdvance:function(t,e){this.is_self_handle=!0;var i=0;e&&(i=1);var s={};s.id=t,s.is_auto=i,this.SendProtocal(24101,s)},handle24101:function(t){message(t.msg),1==t.result?this.openHallowsStepUpWindow(!0,t.id):this.is_self_handle=!1,gcore.GlobalEvent.fire(l.HallowsAdvanceEvent,t.id,t.result)},requestHallowsSkillUpgrade:function(t){this.is_self_handle=!0;var e={};e.hallows_id=t,this.SendProtocal(24103,e)},handle24103:function(t){message(t.msg),1==t.result||(this.is_self_handle=!1)},requestHallowsEquip:function(t,e,i){this.is_self_handle=!0,t=t||0,e=e||1,i=i||1;var s={};s.hallows_id=t,s.id=e,s.pos=i,this.SendProtocal(24102,s)},handle24102:function(t){message(t.msg),1==t.result?gcore.GlobalEvent.fire(l.HallowsEqupUpEvent,t.id,t.pos):this.is_self_handle=!1},requestUseTraceItem:function(t,e){this.is_self_handle=!0,t=t||0,e=e||1;var i={};i.hallows_id=t,i.num=e,this.SendProtocal(24104,i)},handle24104:function(t){message(t.msg),1==t.result?this.openHallowsTraceWindow(!1):this.is_self_handle=!1},handle24120:function(t){this.model.updateHallowsTask(t.list)},handle24121:function(t){this.model.updateHallowsTask(t.list)},requestSubmitHallowsTask:function(t){var e={};e.id=t,this.SendProtocal(24122,e)},handle24122:function(t){message(t.msg)},handle24105:function(t){this.resonate_data=t},requestHallowsReset:function(t){var e={};e.id=t,this.SendProtocal(24123,e)},handle24123:function(t){message(t.msg)},requestSignOpenHallows:function(){this.SendProtocal(24124,{})},handle24124:function(t){t.is_first&&this.model.setOpenHallowsFlag(t.is_first)},__delete:function(){null!=this.model&&(this.model.DeleteMe(),this.model=null)}});e.exports=c,cc._RF.pop()},{backpack_const:"backpack_const",backpack_event:"backpack_event",battle_drama_event:"battle_drama_event",guide_controller:"guide_controller",hallows_event:"hallows_event",hallows_model:"hallows_model",mainui_const:"mainui_const",mainui_controller:"mainui_controller"}],hallows_event:[function(t,e,i){"use strict";cc._RF.push(e,"c6149L11bVIz4irlYVCZtAD","hallows_event"),e.exports={HallowsActivityEvent:"HallowsActivityEvent",HallowsUpdateEvent:"HallowsUpdateEvent",HallowsAdvanceEvent:"HallowsAdvanceEvent",HallowsSkillUpgradeEvent:"HallowsSkillUpgradeEvent",HallowsEqupUpEvent:"HallowsEqupUpEvent",HallowsRedStatus:"HallowsRedStatus",UpdateHallowsTaskEvent:"UpdateHallowsTaskEvent",InitHallowsEvent:"InitHallowsEvent",UndateHallowsInfoEvent:"UndateHallowsInfoEvent",CloseTaskEffectEvent:"CloseTaskEffectEvent"},cc._RF.pop()},{}],hallows_main_window:[function(t,e,i){"use strict";cc._RF.push(e,"b18f0+jzYJJfL57wcKEO/YN","hallows_main_window");var s=t("pathtool"),n=t("hallows_const"),a=t("backpack_controller"),o=t("hallows_event"),l=t("backpack_event"),r=t("backpack_const"),c=t("partner_calculate");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("hallows","hallows_main_window"),this.viewTag=SCENE_TAG.ui,this.win_type=WinType.Full,this.rleasePrefab=!1,this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){this.skill_attr_list={},this.is_in_advance=!1,this.hallows_list={},this.hallows_sum=0,this.tab_list={},this.attr_bgs={},this.base_attr_list={},this.is_max_hallows_lv=!1,this.is_max_skill_lv=!1,this.cur_index=n.Tab_Index.uplv,this.hallows_uplv_cost_bid_1=0,this.hallows_uplv_cost_num_1=0,this.hallows_uplv_cost_bid_2=0,this.hallows_uplv_cost_num_2=0,this.skill_lvup_cost_bid_1=0,this.skill_lvup_cost_num_1=0,this.skill_lvup_cost_bid_2=0,this.skill_lvup_cost_num_2=0},openCallBack:function(){this.background=this.seekChild(this.root_wnd,"background"),this.background.scale=FIT_SCALE,this.bg=this.seekChild(this.root_wnd,"background",cc.Sprite),this.loadRes(s.getBigBg("bigbg_68","jpg"),function(t){this.bg.spriteFrame=t}.bind(this));var t=this.root_wnd.getChildByName("main_panel"),e=t.getChildByName("title_bg");this.title_bg_img=e.getComponent(cc.Sprite),this.loadRes(s.getCommonIcomPath("common_2015"),function(t){this.title_bg_img.spriteFrame=t}.bind(this)),this.bottom_bg=t.getChildByName("bottom_bg"),this.bottom_bg_img=this.bottom_bg.getComponent(cc.Sprite),this.loadRes(s.getUIIconPath("hallows","hallows_1001"),function(t){this.bottom_bg_img.spriteFrame=t}.bind(this)),this.step_container=t.getChildByName("step_container"),this.attr_bg_1=this.step_container.getChildByName("attr_bg_1").getComponent(cc.Sprite),this.attr_bg_2=this.step_container.getChildByName("attr_bg_2").getComponent(cc.Sprite),this.loadRes(s.getUIIconPath("hallows","hallows_1007"),function(t){this.attr_bg_1.spriteFrame=t,this.attr_bg_2.spriteFrame=t}.bind(this)),this.bottom_bg_2=this.bottom_bg.getChildByName("bottom_bg_2").getComponent(cc.Sprite),this.loadRes(s.getCommonIcomPath("common_2007"),function(t){this.bottom_bg_2.spriteFrame=t}.bind(this)),this.skill_bg=t.getChildByName("skill_bg"),this.skill_bg.getChildByName("skill_title").getComponent(cc.Label).string=Utils.TI18N("\u6280\u80fd\u52a0\u6210"),this.trace_btn=t.getChildByName("trace_btn"),this.trace_btn.getChildByName("label").getComponent(cc.Label).string=Utils.TI18N("\u5723\u5370"),this.trace_btn_tips=this.trace_btn.getChildByName("tips"),this.trace_btn_tips.active=!1,this.reset_btn=t.getChildByName("reset_btn"),this.reset_btn.getChildByName("label").getComponent(cc.Label).string=Utils.TI18N("\u91cd\u94f8"),this.reset_btn.active=!1,this.artifact_btn=t.getChildByName("artifact_btn"),this.artifact_btn.getChildByName("label").getComponent(cc.Label).string=Utils.TI18N("\u5931\u843d\u795e\u5668"),this.touch_layout=t.getChildByName("touch_layout"),this.left_btn=t.getChildByName("left_btn"),this.right_btn=t.getChildByName("right_btn"),this.explain_btn=t.getChildByName("explain_btn"),this.hallows_name=e.getChildByName("hallows_name").getComponent(cc.Label),this.step_container.getChildByName("title_attr").getComponent(cc.Label).string=Utils.TI18N("\u5168\u961f\u57fa\u7840\u5c5e\u6027");for(var i=1;i<3;i++){var n=this.step_container.getChildByName("attr_bg_"+i);this.attr_bgs[i]=n}this.uplv_layout=this.step_container.getChildByName("uplv_layout"),this.step_progress=this.uplv_layout.getChildByName("progress").getComponent(cc.ProgressBar),this.step_progress_value=this.uplv_layout.getChildByName("progress_value").getComponent(cc.Label),this.step_advanced_btn=this.uplv_layout.getChildByName("advanced_btn"),this.step_auto_advanced_btn=this.uplv_layout.getChildByName("auto_advanced_btn"),this.step_advanced_btn.getChildByName("label").getComponent(cc.Label).string=Utils.TI18N("\u5347\u7ea7"),this.step_auto_advanced_btn_label=this.step_auto_advanced_btn.getChildByName("label").getComponent(cc.Label),this.step_auto_advanced_btn_label.string=Utils.TI18N("\u4e00\u952e\u5347\u7ea7"),this.step_advanced_btn_tips=this.step_advanced_btn.getChildByName("tips"),this.step_advanced_btn_tips.active=!1;var a=this.uplv_layout.getChildByName("lvup_cost_bg");this.lvup_cost_bg_img=a.getComponent(cc.Sprite),this.lvup_cost_res_1=a.getChildByName("res_icon").getComponent(cc.Sprite),this.lvup_cost_label_1=a.getChildByName("lvup_cost_label").getComponent(cc.Label);var o=this.uplv_layout.getChildByName("auto_lvup_cost_bg");this.auto_lvup_cost_img=o.getComponent(cc.Sprite),this.lvup_cost_res_2=o.getChildByName("res_icon").getComponent(cc.Sprite),this.lvup_cost_label_2=o.getChildByName("auto_lvup_cost_label").getComponent(cc.Label),this.skill_container=t.getChildByName("skill_container"),this.skill_layout=this.skill_container.getChildByName("skill_layout"),this.skill_lvup_node=this.skill_layout.getChildByName("skill_lvup_btn"),this.skill_lvup_btn=this.skill_layout.getChildByName("skill_lvup_btn").getComponent(cc.Button),this.skill_lvup_btn_label=this.skill_lvup_node.getChildByName("label").getComponent(cc.Label),this.skill_lvup_btn_label.string=Utils.TI18N("\u5347\u7ea7"),this.skill_lvup_btn_line=this.skill_lvup_node.getChildByName("label").getComponent(cc.LabelOutline),this.skill_cost_bg_1=this.skill_layout.getChildByName("skill_cost_bg_1"),this.skill_cost_bg_1_img=this.skill_cost_bg_1.getComponent(cc.Sprite),this.skill_res_icon_1=this.skill_cost_bg_1.getChildByName("skill_res_icon_1").getComponent(cc.Sprite),this.skill_cost_label_1=this.skill_cost_bg_1.getChildByName("skill_cost_label_1").getComponent(cc.Label),this.skill_cost_bg_2=this.skill_layout.getChildByName("skill_cost_bg_2"),this.skill_cost_bg_2_img=this.skill_cost_bg_2.getComponent(cc.Sprite),this.skill_res_icon_2=this.skill_cost_bg_2.getChildByName("skill_res_icon_2").getComponent(cc.Sprite),this.skill_cost_label_2=this.skill_cost_bg_2.getChildByName("skill_cost_label_2").getComponent(cc.Label),this.loadRes(s.getUIIconPath("hallows","hallows_1008"),function(t){this.lvup_cost_bg_img.spriteFrame=t,this.auto_lvup_cost_img.spriteFrame=t,this.skill_cost_bg_1_img.spriteFrame=t,this.skill_cost_bg_2_img.spriteFrame=t}.bind(this)),this.skill_lvup_tips=this.skill_layout.getChildByName("skill_lvup_tips").getComponent(cc.Label),this.maxlv_layout=t.getChildByName("maxlv_layout"),this.max_lv_tips=this.maxlv_layout.getChildByName("max_lv_tips").getComponent(cc.Label);var l=t.getChildByName("tab_container");for(i=1;i<3;i++){var r={},c=l.getChildByName("tab_btn_"+i);if(c){var _=c.getChildByName("title").getComponent(cc.Label);1==i?_.string=Utils.TI18N("\u5347\u7ea7"):2==i&&(_.string=Utils.TI18N("\u6280\u80fd"));var h=c.getChildByName("tips"),d=l.getChildByName("tab_btn_"+i).getComponent(cc.Sprite),u=s.getCommonIcomPath("common_2009");this.loadRes(u,function(t){r.tab_btn_img.spriteFrame=t}.bind(this)),r.tab_btn=c,r.label=_,r.index=i,r.tips=h,r.tab_btn_img=d,this.tab_list[i]=r}}this.hallows_eff_node=this.seekChild("hallows_eff_node"),this.hallows_eff_sk=this.seekChild("hallows_eff_node",sp.Skeleton),this.update_eff_node=this.seekChild("update_eff_node"),this.update_eff_sk=this.seekChild("update_eff_node",sp.Skeleton),this.main_panel=t},registerEvent:function(){for(var e in this.step_advanced_btn.on(cc.Node.EventType.TOUCH_END,function(){Utils.playButtonSound(ButtonSound.Normal),this.changeAutoAdvanceStatus(!1),this.select_hallows&&this.ctrl.requestHallowsAdvance(this.select_hallows.id,!1)},this),this.step_auto_advanced_btn.on(cc.Node.EventType.TOUCH_END,function(){Utils.playButtonSound(ButtonSound.Normal);var t=!this.is_in_advance;1==t&&this.select_hallows&&this.ctrl.requestHallowsAdvance(this.select_hallows.id,!1),this.changeAutoAdvanceStatus(t)},this),this.left_btn.on(cc.Node.EventType.TOUCH_END,function(){if(Utils.playButtonSound(ButtonSound.Normal),this.hallows_list&&null!=Utils.next(this.hallows_list)){var t=parseInt(this.select_index);t<=0?t=this.hallows_sum:t-=1,this.selectHallowsIndex(t)}},this),this.right_btn.on(cc.Node.EventType.TOUCH_END,function(){if(Utils.playButtonSound(ButtonSound.Normal),this.hallows_list&&null!=Utils.next(this.hallows_list)){var t=parseInt(this.select_index);t+1>=this.hallows_sum?t=0:t+=1,this.selectHallowsIndex(t)}},this),this.explain_btn.on(cc.Node.EventType.TOUCH_END,function(e){Utils.playButtonSound(ButtonSound.Normal);var i=Config.hallows_data.data_const.game_rule,s=e.touch.getLocation();t("tips_controller").getInstance().showCommonTips(i.desc,s,null,null,500)},this),this.trace_btn.on(cc.Node.EventType.TOUCH_END,function(){if(Utils.playButtonSound(ButtonSound.Normal),this.select_hallows)if(null==this.select_hallows.vo)message(TI18N("\u8be5\u5723\u5668\u6682\u672a\u6fc0\u6d3b"));else{var t=Config.hallows_data.data_const.imprint_lowest;t&&(this.select_hallows.vo.step<t.val?message(t.desc):this.ctrl.openHallowsTraceWindow(!0,this.select_hallows))}},this),this.reset_btn.on(cc.Node.EventType.TOUCH_END,function(){Utils.playButtonSound(ButtonSound.Normal),this._onClickResetBtn()},this),this.skill_lvup_node.on(cc.Node.EventType.TOUCH_END,function(){Utils.playButtonSound(ButtonSound.Normal),this._onClickSkillLvupBtn()},this),this.artifact_btn.on(cc.Node.EventType.TOUCH_END,function(){Utils.playButtonSound(ButtonSound.Normal),this._onClickBtnArtifact()},this),this.touch_layout.on(cc.Node.EventType.TOUCH_END,function(){Utils.playButtonSound(ButtonSound.Normal),this._onClickTouchLayout()},this),this.tab_list)this.tab_list[e].tab_btn&&this.tab_list[e].tab_btn.on(cc.Node.EventType.TOUCH_END,function(t){Utils.playButtonSound(ButtonSound.Tab),this.changeSelectedTab(t)}.bind(this,this.tab_list[e].index),this);this.addGlobalEvent(o.HallowsUpdateEvent,function(t){this.handleUpdateEvent(t)}.bind(this)),this.addGlobalEvent(o.HallowsAdvanceEvent,function(t,e){this.select_hallows&&this.select_hallows.id!=t?this.changeAutoAdvanceStatus(!1):0!=e&&1!=e||this.changeAutoAdvanceStatus(!1)}.bind(this)),this.addGlobalEvent(o.UndateHallowsInfoEvent,function(t){if(this.select_hallows&&this.select_hallows.id!=t){var e=this.getHallowsIndexById(t);this.selectHallowsIndex(e)}}.bind(this)),this.addGlobalEvent(o.HallowsRedStatus,function(t,e){this.select_hallows&&this.updateTabRedStatus()}.bind(this)),this.addGlobalEvent(l.ADD_GOODS,function(t,e){t==r.Bag_Code.BACKPACK&&this.checkNeedUpdateItemNum(e)}.bind(this)),this.addGlobalEvent(l.MODIFY_GOODS_NUM,function(t,e){t==r.Bag_Code.BACKPACK&&this.checkNeedUpdateItemNum(e)}.bind(this)),this.addGlobalEvent(l.DELETE_GOODS,function(t,e){t==r.Bag_Code.BACKPACK&&this.checkNeedUpdateItemNum(e)}.bind(this))},_onClickResetBtn:function(){var e=Utils.TI18N("\u91cd\u94f8\u540e\u795e\u5668\u5c06\u56de\u5230\u521d\u59cb\u72b6\u6001\uff0c\u540c\u65f6\u8fd4\u8fd8\u9664\u91d1\u5e01\u5916\u6240\u6709\u8d44\u6e90\uff0c\u662f\u5426\u91cd\u94f8\uff1f");t("commonalert").show(e,Utils.TI18N("\u786e\u5b9a"),function(){this.select_hallows&&this.ctrl.requestHallowsReset(this.select_hallows.id)}.bind(this),Utils.TI18N("\u53d6\u6d88"))},_onClickSkillLvupBtn:function(){if(null!=this.select_hallows){var t=this.select_hallows.vo;t&&this.ctrl.requestHallowsSkillUpgrade(t.id)}},_onClickBtnArtifact:function(){this.ctrl.openHallowsPreviewWindow(!0)},_onClickTouchLayout:function(){if(null!=this.select_hallows){var t=this.select_hallows.vo;if(t){var e=this.model.makeHighestHallowVo(t.id);this.ctrl.openHallowsTips(!0,e)}}},changeSelectedTab:function(t){if(!this.tab_object||this.tab_object.index!=t){if(this.tab_object){var e=s.getCommonIcomPath("common_2009");this.loadRes(e,function(t){this.tab_object.tab_btn_img.spriteFrame=t}.bind(this)),this.tab_object.label.node.color=new cc.Color(207,181,147,255),this.tab_object=null}if(this.tab_object=this.tab_list[t],this.tab_object){e=s.getCommonIcomPath("common_2010");this.loadRes(e,function(t){this.tab_object.tab_btn_img.spriteFrame=t}.bind(this)),this.tab_object.label.node.color=new cc.Color(255,237,214,255)}this.cur_index=t,this.step_container.active=t==n.Tab_Index.uplv,this.skill_container.active=t==n.Tab_Index.skill,this.updateMaxLvTips()}},openRootWnd:function(t,e){var i=Config.hallows_data.data_base;for(var s in this.hallows_list=[],this.hallows_sum=Config.hallows_data.data_base_length,i){var a={};a.id=i[s].id,a.name=i[s].name,a.effect=i[s].effect,a.item_id=i[s].item_id,a.open_desc=i[s].open_desc;var o=this.model.getHallowsById(i[s].id);a.vo=o,this.hallows_list.push(a)}Utils.next(this.hallows_list)&&this.hallows_list.sort(function(t,e){return t.id-e.id});var l=this.getDefaultHallowsIndex(t);this.selectHallowsIndex(l),e=e||n.Tab_Index.uplv,this.changeSelectedTab(e)},getDefaultHallowsIndex:function(t){var e=Utils.deepCopy(this.hallows_list),i=0;if(t)i=this.getHallowsIndexById(t);else{var s=[];e.sort(function(t,e){return e.vo.step-t.vo.step});var n=0;for(var a in e)n<=e[a].vo.step&&(n=e[a].vo.step,s.push(e[a]));if(1==s.length)i=this.getHallowsIndexById(s[0].id);else{var o=0;s.sort(function(t,e){return e.vo.lucky-t.vo.lucky});var l=[];for(var r in s){var c=s[r];c.vo.lucky>=o&&(o=c.vo.lucky,l.push(c))}1==l.length?i=this.getHallowsIndexById(l[0].id):(l.sort(function(t,e){return e.id-t.id}),i=this.getHallowsIndexById(l[0].id))}}return i},getHallowsIndexById:function(t){var e=1;for(var i in this.hallows_list)this.hallows_list[i].id&&this.hallows_list[i].id==t&&(e=i);return e},selectHallowsIndex:function(t,e){(this.select_index!=t||e)&&(e?this.handleEffect(!0):this.changeAutoAdvanceStatus(!1),this.select_index=t,this.select_hallows=this.hallows_list[t],null!=this.select_hallows&&(this.reset_btn.active=this.checkIsShowResetBtn(),this.is_max_hallows_lv=!1,this.is_max_skill_lv=!1,this.hallows_uplv_cost_bid_1=0,this.hallows_uplv_cost_num_1=0,this.hallows_uplv_cost_bid_2=0,this.hallows_uplv_cost_num_2=0,this.skill_lvup_cost_bid_1=0,this.skill_lvup_cost_num_1=0,this.skill_lvup_cost_bid_2=0,this.skill_lvup_cost_num_2=0,this.updateHallowsBaseInfo(),this.updateSkillList(),this.updateHallowStatusInfo(),this.updateTabRedStatus()))},handleEffect:function(t){if(t){var e=s.getSpinePath(Config.effect_data.data_effect_info[185],"action");this.loadRes(e,function(t){this.update_eff_sk.skeletonData=t,this.update_eff_sk.setAnimation(0,PlayerAction.action,!1)}.bind(this))}else this.update_eff_sk&&(this.update_eff_sk.setToSetupPose(),this.update_eff_sk.clearTracks())},updateHallowsBaseInfo:function(){if(null!=this.select_hallows){var e=PlayerAction.action_1;if(null!=this.select_hallows.vo&&(e=PlayerAction.action_2),this.hallows_model_id!=this.select_hallows.effect){this.hallows_model_id=this.select_hallows.effect,this.handleEffect(!1),this.hallows_eff_sk&&(this.hallows_eff_sk.setToSetupPose(),this.hallows_eff_sk.clearTracks());var i=s.getSpinePath(this.hallows_model_id,"action");this.loadRes(i,function(t){this.hallows_eff_sk.skeletonData=t,this.hallows_eff_sk.setAnimation(0,e,!0)}.bind(this))}this.select_hallows.vo?this.hallows_eff_node.color=new cc.Color(255,255,255,255):this.hallows_eff_node.color=new cc.Color(169,169,169,255);var n=this.select_hallows.vo;if(null!=n){this.hallows_name.string=this.select_hallows.name+"+"+n.step;var a=gdata("hallows_data","data_info",Utils.getNorKey(n.id,n.step)),o=gdata("hallows_data","data_info",Utils.getNorKey(n.id,n.step+1))||{};for(var l in this.base_attr_list)this.base_attr_list[l].action=!1;for(var r in a.attr){if(r>2)break;var _=a.attr[r][0],h=a.attr[r][1]||0,d=0;if(o.attr)for(var u in o.attr)o.attr[u][0]&&o.attr[u][0]==_&&(d=o.attr[u][1]||0);var m=Config.attr_data.data_key_to_name[_];if(m){var f=this.base_attr_list[r];if(null==f)(f=Utils.createRichLabel(24,new cc.Color(100,50,35,255),cc.v2(0,.5),cc.v2(20,20),30,380)).horizontalAlign=cc.macro.TextAlignment.LEFT,this.attr_bgs[parseInt(r)+1].addChild(f.node),this.base_attr_list[r]=f;f.active=!0;var p=s.getAttrIconByStr(_),g=0;if(d>0){var v=(Config.hallows_data.data_const.temporary_ratio||{}).val||800;g=Math.round(n.lucky/a.max_lucky*(d-h)*(v/1e3))}var b=c.isShowPerByStr(_),w=Config.hallows_data.data_const.stone_attribute;if(n.seal>0&&w){var y=0;for(var u in w.val)if(w.val[u][0]&&w.val[u][0]==_){y=w.val[u][1]||0;break}h+=y*n.seal}b&&(h=h/10+"%");var C=cc.js.formatStr("<img src='%s'/> <color=#643223> %s\uff1a</c><color=#643223>%s</c>",p,m,h.toString());g>0&&(b&&(g=g/10+"%"),C+=cc.js.formatStr("<color=#249003> +%s</c>",g.toString())),f.string=C,this.loadRes(s.getCommonIcomPath(p),function(t,e){t.spriteFrame=e}.bind(this,f))}}var k=gdata("hallows_data","data_skill_up",Utils.getNorKey(this.select_hallows.id,n.skill_lev));if(k&&0!=k.skill_bid){var S=gdata("skill_data","data_get_skill",k.skill_bid);if(!S||null==Utils.next(S))return;if(!this.hallow_skill_icon){var T=t("skill_item");this.hallow_skill_icon=new T,this.hallow_skill_icon.setParent(this.skill_container),this.hallow_skill_icon.setScale(.9),this.hallow_skill_icon.setLeveStatus(!1),this.hallow_skill_icon.setPosition(cc.v2(75,245))}this.hallow_skill_icon.setData(S.bid),this.hallows_skill_name||(this.hallows_skill_name=Utils.createLabel(24,new cc.Color(139,71,21,255),null,135,267,"",this.skill_container,1,cc.v2(0,0))),this.hallows_skill_name.string=S.name+"+"+n.skill_lev,this.hallows_skill_desc||(this.hallows_skill_desc=Utils.createRichLabel(22,new cc.Color(100,50,35,255),cc.v2(0,1),cc.v2(135,250),30,550),this.hallows_skill_desc.horizontalAlign=cc.macro.TextAlignment.LEFT,this.skill_container.addChild(this.hallows_skill_desc.node)),this.hallows_skill_desc.string=S.des}}}},updateSkillList:function(){if(null!=this.select_hallows){var t=this.select_hallows.vo,e=Config.hallows_data.data_skill_attr[this.select_hallows.id]||{};for(var i in this.skill_attr_list)this.skill_attr_list[i].active=!1;for(var s in e){var n=this.skill_attr_list[s];null==n&&(n=Utils.createLabel(20,new cc.Color(157,141,115,255),null,0,0,"",this.skill_bg,1,cc.v2(0,.5)),this.skill_attr_list[s]=n),n.active=!0,n.node.setPosition(cc.v2(20,90-32*(s-1))),t.skill_lev>=e[s].lev_limit?n.node.color=new cc.Color(247,152,68,255):n.node.color=new cc.Color(157,141,115,255);var a=cc.js.formatStr(Utils.TI18N("\u6280\u80fd%d\u7ea7:%s"),e[s].lev_limit,e[s].desc);n.string=a}}},updateHallowStatusInfo:function(){if(null!=this.select_hallows){var t=this.select_hallows.vo;if(null!=t){var e=Config.hallows_data.data_max_lev[t.id]||100;t.step>=e?(this.is_max_hallows_lv=!0,this.uplv_layout.active=!1):(this.is_max_hallows_lv=!1,this.uplv_layout.active=!0);var i=Config.hallows_data.data_skill_max_lev[t.id]||10;t.skill_lev>=i?(this.is_max_skill_lv=!0,this.skill_layout.active=!1):(this.is_max_skill_lv=!1,this.skill_layout.active=!0),this.is_max_hallows_lv||this.updateStepInfo(),this.is_max_skill_lv||this.updateSkillInfo(),this.updateMaxLvTips()}}},updateMaxLvTips:function(){this.cur_index==n.Tab_Index.uplv&&this.is_max_hallows_lv?(this.max_lv_tips.string=Utils.TI18N("\u795e\u5668\u5df2\u6ee1\u7ea7"),this.maxlv_layout.active=!0):this.cur_index==n.Tab_Index.skill&&this.is_max_skill_lv?(this.max_lv_tips.string=Utils.TI18N("\u6280\u80fd\u5df2\u6ee1\u7ea7"),this.maxlv_layout.active=!0):this.maxlv_layout.active=!1},updateStepInfo:function(){if(null!=this.select_hallows){var t=this.select_hallows.vo;if(null!=t){var e=gdata("hallows_data","data_info",Utils.getNorKey(t.id,t.step));if(e){this.step_progress_value.string=t.lucky+"/"+e.max_lucky,this.step_progress.progress=t.lucky/e.max_lucky;var i=e.loss[0],s=e.loss[1];if(i){var n=i[0],a=i[1];this.hallows_uplv_cost_bid_1=n,this.hallows_uplv_cost_num_1=a,this.setCostDataToNode(this.lvup_cost_res_1,this.lvup_cost_label_1,n,a)}if(s){n=s[0],a=s[1];this.hallows_uplv_cost_bid_2=n,this.hallows_uplv_cost_num_2=a,this.setCostDataToNode(this.lvup_cost_res_2,this.lvup_cost_label_2,n,a)}}}}},updateSkillInfo:function(){if(null!=this.select_hallows){var t=this.select_hallows.vo;if(null!=t){var e=gdata("hallows_data","data_skill_up",Utils.getNorKey(this.select_hallows.id,t.skill_lev));if(e&&0!=e.skill_bid)if(e.lev_limit>t.step)this.skill_lvup_tips.string=cc.js.formatStr(Utils.TI18N("\u795e\u5668%d\u7ea7\u53ef\u7ee7\u7eed\u5347\u7ea7"),e.lev_limit),this.skill_lvup_tips.node.active=!0,this.skill_cost_bg_1.active=!1,this.skill_cost_bg_2.active=!1,this.skill_lvup_btn.enableAutoGrayEffect=!0,this.skill_lvup_btn.interactable=!1,this.skill_lvup_btn_line.enabled=!1;else{this.skill_lvup_btn.enableAutoGrayEffect=!1,this.skill_lvup_btn.interactable=!0,this.skill_lvup_btn_line.enabled=!0,this.skill_lvup_tips.node.active=!1,this.skill_cost_bg_1.active=!0,this.skill_cost_bg_2.active=!0;var i=e.lose[0],s=e.lose[1];if(i){var n=i[0],a=i[1];this.skill_lvup_cost_bid_1=n,this.skill_lvup_cost_num_1=a,this.setCostDataToNode(this.skill_res_icon_1,this.skill_cost_label_1,n,a)}if(s){n=s[0],a=s[1];this.skill_lvup_cost_bid_2=n,this.skill_lvup_cost_num_2=a,this.setCostDataToNode(this.skill_res_icon_2,this.skill_cost_label_2,n,a)}}}}},updateTabRedStatus:function(){if(null!=this.select_hallows){var t=this.model.getRedHallowsId();if(t&&t==this.select_hallows.id){for(var e in this.tab_list){if((o=this.tab_list[e]).tips&&o.index){var i=!1;o.index==n.Tab_Index.uplv?i=this.model.checkRedIsShowByRedType(n.Red_Index.hallows_lvup):o.index==n.Tab_Index.skill&&(i=this.model.checkRedIsShowByRedType(n.Red_Index.skill_lvup)),o.tips.active=i}}if(this.trace_btn_tips){var s=this.model.checkRedIsShowByRedType(n.Red_Index.stone_use);this.trace_btn_tips.active=s}}else{for(var a in this.tab_list){var o;(o=this.tab_list[a]).tips&&(o.tips.active=!1)}this.trace_btn_tips&&(this.trace_btn_tips.active=!1)}}},setCostDataToNode:function(t,e,i,n){var o=Utils.getItemConfig(i);if(o){var l=s.getItemRes(o.icon);this.loadRes(l,function(t,e){t.spriteFrame=e}.bind(this,t));var r=a.getInstance().getModel().getItemNumByBid(i);e.string=cc.js.formatStr("%s/%s",Utils.getMoneyString(r,!1),Utils.getMoneyString(n,!1)),e.node.color=r<n?new cc.Color(255,93,93,255):new cc.Color(255,246,228,255)}},checkNeedUpdateItemNum:function(t){if(null!=t&&null!=Utils.next(t))for(var e in t){var i=t[e];if(i.config){var s=i.config.id;s==this.hallows_uplv_cost_bid_1?this.setCostDataToNode(this.lvup_cost_res_1,this.lvup_cost_label_1,s,this.hallows_uplv_cost_num_1):s==this.hallows_uplv_cost_bid_2?this.setCostDataToNode(this.lvup_cost_res_2,this.lvup_cost_label_2,s,this.hallows_uplv_cost_num_2):s==this.skill_lvup_cost_bid_1?this.setCostDataToNode(this.skill_res_icon_1,this.skill_cost_label_1,s,this.skill_lvup_cost_num_1):s==this.skill_lvup_cost_bid_2&&this.setCostDataToNode(this.skill_res_icon_2,this.skill_cost_label_2,s,this.skill_lvup_cost_num_2)}}},handleUpdateEvent:function(t){t&&this.select_hallows&&t==this.select_hallows.id&&this.selectHallowsIndex(this.select_index,!0)},checkIsShowResetBtn:function(){var t=!1;if(null==this.select_hallows)return t;var e=this.select_hallows.vo;return null==e?t:((e.step>1||e.seal>0||e.skill_lev>1)&&(t=!0),t)},changeAutoAdvanceStatus:function(t){t!=this.is_in_advance&&(this.is_in_advance=t,this.is_in_advance?(this.step_auto_advanced_btn_label.string=Utils.TI18N("\u505c\u6b62"),null==this.auto_time_ticket&&(this.auto_time_ticket=gcore.Timer.set(function(){this.is_in_advance&&this.ctrl.requestHallowsAdvance(this.select_hallows.id,!1)}.bind(this),500,-1))):(this.clearAutoTimeticket(),this.step_auto_advanced_btn_label.string=Utils.TI18N("\u4e00\u952e\u5347\u7ea7")))},clearAutoTimeticket:function(){this.auto_time_ticket&&(gcore.Timer.del(this.auto_time_ticket),this.auto_time_ticket=null)},closeCallBack:function(){this.clearAutoTimeticket(),this.handleEffect(!1),this.hallow_skill_icon&&(this.hallow_skill_icon.deleteMe(),this.hallow_skill_icon=null),this.hallows_eff_sk&&(this.hallows_eff_sk.setToSetupPose(),this.hallows_eff_sk.clearTracks()),this.ctrl.openHallowsMainWindow(!1)}});cc._RF.pop()},{backpack_const:"backpack_const",backpack_controller:"backpack_controller",backpack_event:"backpack_event",commonalert:"commonalert",hallows_const:"hallows_const",hallows_event:"hallows_event",partner_calculate:"partner_calculate",pathtool:"pathtool",skill_item:"skill_item",tips_controller:"tips_controller"}],hallows_model:[function(t,e,i){"use strict";cc._RF.push(e,"186e0AtYd5Fi5LuGWBDvVMY","hallows_model");var s=t("hallows_vo"),n=t("mainui_controller"),a=t("hero_controller"),o=t("role_controller"),l=t("backpack_controller"),r=t("hallows_event"),c=t("hallows_const"),_=t("mainui_const");cc.Class({extends:BaseClass,ctor:function(){this.ctrl=t("hallows_controller").getInstance(),this.initConfig()},properties:{},initConfig:function(){this.hallows_list=[],this.open_flag=!1,this.had_request=!1,this.attr_ratio_list=[],this.hallows_red_list=[]},updateHallowsInfo:function(t){if(t){for(var e in t.hallows){var i=this.hallows_list[t.hallows[e].id];i||(i=new s,this.hallows_list[t.hallows[e].id]=i),i.initAttributeData(t.hallows[e])}this.updateRedPoint()}},updateHallowsData:function(t){var e=this.getHallowsById(t.id);e||(e=new s,this.hallows_list[t.id]=e),e.initAttributeData(t),this.updateRedPoint()},updateHallowsRedStatus:function(t,e){this.hallows_red_list[t]!=e&&(this.hallows_red_list[t]=e,n.getInstance().setBtnRedPoint(_.btn_index.hallows,{bid:t,status:e}),gcore.GlobalEvent.fire(r.HallowsRedStatus,t,e))},checkRedIsShowByRedType:function(t){return this.hallows_red_list[t]||!1},getHallowsRedStatus:function(){var t=!1;for(var e in this.hallows_red_list)if(this.hallows_red_list[e]){t=!0;break}return t},updateRedPoint:function(){RedMgr.getInstance().addCalHandler(this.checkHallowsRedStatus.bind(this),RedIds.Hallow)},checkHallowsRedStatus:function(){var t=!1;if(this.checkIsHaveAllHallows()){var e=Utils.deepCopy(this.hallows_list);e.sort(function(t,e){return t.step!=e.step?e.step-t.step:t.lucky!=e.lucky?e.lucky-t.lucky:e.id-t.id});var i=e[0];if(i){this.setRedHallowsId(i.id);var s=o.getInstance().getRoleVo();if((h=gdata("hallows_data","data_info",Utils.getNorKey(i.id,i.step)).loss)&&null!=Utils.next(h))for(var n in h){var a=h[n][0],r=h[n][1],_=0;if((_=(m=Config.item_data.data_assets_id2label[a])?s[m]:l.getInstance().getModel().getItemNumByBid(a))<r){t=!1;break}t=!0}this.updateHallowsRedStatus(c.Red_Index.hallows_lvup,t),t=!1;var h,d=gdata("hallows_data","data_skill_up",Utils.getNorKey(i.id,i.skill_lev));if(d&&0!=d.lev_limit&&d.lev_limit<=i.step)if((h=d.lose)&&null!=Utils.next(h))for(var u in h){var m;a=h[u][0],r=h[u][1],_=0;if((_=(m=Config.item_data.data_assets_id2label[a])?s[m]:l.getInstance().getModel().getItemNumByBid(a))<r){t=!1;break}t=!0}this.updateHallowsRedStatus(c.Red_Index.skill_lvup,t),t=!1;var f=gdata("hallows_data","data_trace_cost",Utils.getNorKey(i.id,i.step)),p=Config.hallows_data.data_const.id_stone;if(f&&p){_=l.getInstance().getModel().getBackPackItemNumByBid(p.val);i.seal<f.num&&_>0&&(t=!0)}this.updateHallowsRedStatus(c.Red_Index.stone_use,t)}this.checkRedIsShowByRedType(c.Red_Index.task_award)&&this.updateHallowsRedStatus(c.Red_Index.task_award,!1)}else t=this.checkHallowsAwardTips(),this.updateHallowsRedStatus(c.Red_Index.task_award,t)},setRedHallowsId:function(t){var e=this.red_hallows_id;this.red_hallows_id=t,e!=this.red_hallows_id&&gcore.GlobalEvent.fire(r.HallowsRedStatus)},getRedHallowsId:function(){return this.red_hallows_id},getHallowsById:function(t){return this.hallows_list[t]},curTotalStep:function(){var t=0;for(var e in this.hallows_list)t+=this.hallows_list[e].step;return t},getHallowsList:function(){var t=[];for(var e in this.hallows_list)t.push(this.hallows_list[e]);return t},getResonateLev:function(){return 0},getFormInfo:function(){if(null==Utils.next(this.attr_ratio_list))for(var t in Config.hallows_data.data_attr_radio){var e=Config.hallows_data.data_attr_radio[t];for(var i in e.ratio){var s=e.ratio[t][0],n=e.ratio[t][1];this.attr_ratio_list[Utils.getNorKey(e.type,s)]=n}}var o={},l=a.getInstance().getModel();if(l){var r=l.getMyPosList();for(var c in r){var _=l.getHeroById(r[c].id);_&&(null==o[_.type]&&(o[_.type]=0),o[_.type]=o[_.type]+1)}}return o},getRatio:function(t,e){return this.attr_ratio_list[Utils.getNorKey(t,e)]},updateHallowsTask:function(t){if(null!=t&&null!=Utils.next(t)){for(var e in null==this.hallows_task_list&&(this.hallows_task_list={}),t)this.hallows_task_list[t[e].id]=t[e];this.updateRedPoint(),gcore.GlobalEvent.fire(r.UpdateHallowsTaskEvent)}},getHallowsTaskList:function(t){var e=[],i=Config.hallows_data.data_task;if(this.hallows_task_list)for(var s in this.hallows_task_list){var n=i[this.hallows_task_list[s].id];n.hid==t&&(this.hallows_task_list[s].sort=n.sort,e.push(this.hallows_task_list[s]))}return Utils.next(e)&&e.sort(function(t,e){return t.id-e.id}),e},getHallowsTaks:function(t){if(this.hallows_task_list)return this.hallows_task_list[t]},getCurActivityHallowsId:function(){if(null==this.hallows_list||null==Utils.next(this.hallows_list))return 1;var t=0;for(var e in this.hallows_list)t<this.hallows_list[e].id&&(t=this.hallows_list[e].id);return t+1},checkHallowsAwardTips:function(){if(null==this.hallows_task_list||null==Utils.next(this.hallows_task_list))return!1;var t=this.getCurActivityHallowsId(),e=this.getHallowsTaskList(t);if(null==e||null==Utils.next(e))return!1;for(var i in e)if(1==e[i].finish)return!0;return!1},checkIsHaveAllHallows:function(){var t=Config.hallows_data.data_base_length,e=0;for(var i in this.hallows_list)e+=1;return e>=t},setOpenHallowsFlag:function(t){this.open_flag=t},getHallowsOpenFlag:function(){return this.open_flag},makeHighestHallowVo:function(t){if(t){var e=new s,i=Config.hallows_data.data_max_lev[t],n=Config.hallows_data.data_skill_max_lev[t],a=gdata("hallows_data","data_info",Utils.getNorKey(t,i)),o=gdata("hallows_data","data_skill_up",Utils.getNorKey(t,n)),l=[];for(var r in a.attr){var c=a.attr[r][0],_={};_.attr_id=Config.attr_data.data_key_to_id[c],_.attr_val=a.attr[r][1],l.push(_)}return e.id=t,e.step=i,e.add_attr=l,e.skill_bid=o.skill_bid,e.skill_lev=n,e}},__delete:function(){}});cc._RF.pop()},{backpack_controller:"backpack_controller",hallows_const:"hallows_const",hallows_controller:"hallows_controller",hallows_event:"hallows_event",hallows_vo:"hallows_vo",hero_controller:"hero_controller",mainui_const:"mainui_const",mainui_controller:"mainui_controller",role_controller:"role_controller"}],hallows_preview_item_panel:[function(t,e,i){"use strict";cc._RF.push(e,"58d29SBvEpKKr6JEg3T43Qw","hallows_preview_item_panel");var s=t("pathtool"),n=t("hallows_const"),a=t("hallows_controller"),o=t("hallows_event");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("hallows","hallows_preview_item"),this.hallows_status=n.Status.close,this.ctrl=a.getInstance()},initConfig:function(){},initPanel:function(){this.container=this.root_wnd,this.hallows_select_node=this.root_wnd.getChildByName("hallows_select_node"),this.hallows_select_sk=this.seekChild("hallows_select_node",sp.Skeleton),this.hallows_pos_node=this.root_wnd.getChildByName("hallows_pos_node"),this.hallows_pos_node.setScale(.65),this.hallows_pos_sk=this.seekChild("hallows_pos_node",sp.Skeleton),this.name_label=this.root_wnd.getChildByName("name_label").getComponent(cc.Label),this.hallows_bg=this.root_wnd.getChildByName("bg")},setData:function(t){this.data=t,this.root_wnd&&this.updateData()},updateData:function(){if(null!=this.data){var t=this.data.id;this.container.name="hallows_"+t,this.name_label.string=this.data.name;PlayerAction.action_2;if(this.ctrl.getModel().getCurActivityHallowsId()==t){this.hallows_status=n.Status.underway,this.hallows_pos_node.color=new cc.Color(169,169,169,255);var e=s.getSpinePath(this.data.effect,"action");this.loadRes(e,function(t){this.hallows_pos_sk.skeletonData=t,this.hallows_pos_sk.setAnimation(0,PlayerAction.action_1,!0)}.bind(this)),this.handleEffect(!0)}else if(this.ctrl.getModel().getHallowsById(t)){this.hallows_status=n.Status.open,this.hallows_pos_node.color=new cc.Color(255,255,255,255);e=s.getSpinePath(this.data.effect,"action");this.loadRes(e,function(t){this.hallows_pos_sk.skeletonData=t,this.hallows_pos_sk.setAnimation(0,PlayerAction.action_2,!0)}.bind(this))}else{this.hallows_status=n.Status.close,this.hallows_pos_node.color=new cc.Color(169,169,169,255);e=s.getSpinePath(this.data.effect,"action");this.loadRes(e,function(t){this.hallows_pos_sk.skeletonData=t,this.hallows_pos_sk.setAnimation(0,PlayerAction.action_1,!0)}.bind(this))}}},handleEffect:function(t){if(t){var e=s.getSpinePath(Config.effect_data.data_effect_info[546],"action");this.loadRes(e,function(t){this.hallows_select_sk.skeletonData=t,this.hallows_select_sk.setAnimation(0,PlayerAction.action,!0)}.bind(this))}else this.hallows_select_sk&&(this.hallows_select_sk.setToSetupPose(),this.hallows_select_sk.clearTracks()),this.hallows_pos_sk&&(this.hallows_pos_sk.setToSetupPose(),this.hallows_pos_sk.clearTracks())},registerEvent:function(){this.container.on(cc.Node.EventType.TOUCH_END,function(){Utils.playButtonSound(ButtonSound.Normal),this._onClickContainer()},this)},_onClickContainer:function(){this.hallows_status==n.Status.close?message(Utils.TI18N("\u89e3\u9501\u4e0a\u4e00\u795e\u5668\u540e\u5f00\u542f")):(this.ctrl.getHallowsRoot()?gcore.GlobalEvent.fire(o.UndateHallowsInfoEvent,this.data.id):this.ctrl.openHallowsMainWindow(!0,this.data.id),this.ctrl.openHallowsPreviewWindow(!1))},onShow:function(t){this.updateData()},onHide:function(){},onDelete:function(){this.handleEffect(!1)}});cc._RF.pop()},{hallows_const:"hallows_const",hallows_controller:"hallows_controller",hallows_event:"hallows_event",pathtool:"pathtool"}],hallows_preview_window:[function(t,e,i){"use strict";cc._RF.push(e,"199feTwpUNJS5MC7MIiHvzP","hallows_preview_window");var s=t("pathtool"),n=t("hallows_preview_item_panel");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("hallows","hallows_preview_window"),this.viewTag=SCENE_TAG.ui,this.win_type=WinType.Full,this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){this.hallows_list=[],this.pos_nodes=[]},openCallBack:function(){this.background=this.seekChild(this.root_wnd,"background"),this.background.scale=FIT_SCALE,this.bg=this.seekChild(this.root_wnd,"background",cc.Sprite),this.loadRes(s.getBigBg("bigbg_69","jpg"),function(t){this.bg.spriteFrame=t}.bind(this)),this.main_panel=this.root_wnd.getChildByName("main_panel"),this.hallows_bg=this.main_panel.getChildByName("hallows_bg").getComponent(cc.Sprite),this.loadRes(s.getBigBg("bigbg_70"),function(t){this.hallows_bg.spriteFrame=t}.bind(this)),this.close_btn=this.main_panel.getChildByName("close_btn")},refreshView:function(){for(var t=Config.hallows_data.data_base_length,e=1;e<=t;e++){var i=this.main_panel.getChildByName("pos_node_"+e);if(i){this.pos_nodes[e]=i;var s=this.hallows_list[e];null==s&&((s=new n).setParent(i),this.hallows_list[e]=s);var a=Config.hallows_data.data_base[e]||{};s.setData(a),s.show()}}},registerEvent:function(){this.close_btn.on(cc.Node.EventType.TOUCH_END,function(){Utils.playButtonSound(ButtonSound.Close),this._onClickCloseBtn()},this)},_onClickCloseBtn:function(){this.ctrl.openHallowsPreviewWindow(!1)},openRootWnd:function(t){this.refreshView()},closeCallBack:function(){for(var t in this.pos_nodes)this.pos_nodes[t].stopAllActions();for(var e in this.pos_nodes=null,this.hallows_list){var i=this.hallows_list[e];i.deleteMe(),i=null}this.hallows_list=null,this.ctrl.openHallowsPreviewWindow(!1)}});cc._RF.pop()},{hallows_preview_item_panel:"hallows_preview_item_panel",pathtool:"pathtool"}],hallows_step_up_window:[function(t,e,i){"use strict";cc._RF.push(e,"debd3Etj6pEQrzeQLJIwJ07","hallows_step_up_window");var s=t("pathtool");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("hallows","hallows_step_up_window"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Big,this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){this.item_list={}},openCallBack:function(){this.background=this.root_wnd.getChildByName("background"),this.background.scale=FIT_SCALE,this.title_container=this.root_wnd.getChildByName("title_container"),this.title_eff_sk=this.seekChild("title_container",sp.Skeleton),this.main_container=this.root_wnd.getChildByName("main_container"),this.background_img=this.main_container.getChildByName("background").getComponent(cc.Sprite),this.loadRes(s.getCommonIcomPath("common_1064"),function(t){this.background_img.spriteFrame=t}.bind(this)),this.Sprite_1=this.main_container.getChildByName("Sprite_1").getComponent(cc.Sprite),this.loadRes(s.getCommonIcomPath("common_1062"),function(t){this.Sprite_1.spriteFrame=t}.bind(this)),this.Sprite_2=this.main_container.getChildByName("Sprite_2").getComponent(cc.Sprite),this.loadRes(s.getCommonIcomPath("common_1063"),function(t){this.Sprite_2.spriteFrame=t}.bind(this)),this.Sprite_3=this.main_container.getChildByName("Sprite_3").getComponent(cc.Sprite),this.Sprite_4=this.main_container.getChildByName("Sprite_4").getComponent(cc.Sprite),this.loadRes(s.getCommonIcomPath("common_30003"),function(t){this.Sprite_3.spriteFrame=t,this.Sprite_4.spriteFrame=t}.bind(this)),this.Sprite_5=this.main_container.getChildByName("Sprite_5").getComponent(cc.Sprite),this.Sprite_6=this.main_container.getChildByName("Sprite_6").getComponent(cc.Sprite),this.loadRes(s.getCommonIcomPath("common_30002"),function(t){this.Sprite_5.spriteFrame=t,this.Sprite_6.spriteFrame=t}.bind(this)),this.Image_1=this.main_container.getChildByName("Image_1").getComponent(cc.Sprite),this.loadRes(s.getCommonIcomPath("common_1091"),function(t){this.Image_1.spriteFrame=t}.bind(this)),this.Sprite_29=this.main_container.getChildByName("Sprite_29").getComponent(cc.Sprite),this.loadRes(s.getCommonIcomPath("common_30014"),function(t){this.Sprite_29.spriteFrame=t}.bind(this)),this.Sprite_13=this.main_container.getChildByName("Sprite_13").getComponent(cc.Sprite),this.loadRes(s.getCommonIcomPath("txt_cn_common_notice"),function(t){this.Sprite_13.spriteFrame=t}.bind(this)),this.hallows_name=this.main_container.getChildByName("hallows_name").getComponent(cc.Label),this.old_step=this.main_container.getChildByName("old_step").getComponent(cc.Label),this.cur_step=this.main_container.getChildByName("cur_step").getComponent(cc.Label);for(var t=1;t<3;t++){var e=this.main_container.getChildByName("item_"+t);if(e){var i={};i.item=e,i.title=e.getChildByName("title").getComponent(cc.Label),i.last_lev=e.getChildByName("last_lev").getComponent(cc.Label),i.now_lev=e.getChildByName("now_lev").getComponent(cc.Label),i.arrow=e.getChildByName("arrow"),i.title.string="",i.last_lev.string="",i.now_lev.string="",i.arrow.active=!1,this.item_list[t]=i}}},registerEvent:function(){this.background.on(cc.Node.EventType.TOUCH_END,function(){Utils.playButtonSound(ButtonSound.Close),this.ctrl.openHallowsStepUpWindow(!1)},this)},openRootWnd:function(t){this.handleEffect(!0),t&&(this.data=this.model.getHallowsById(t),this.data_config=Config.hallows_data.data_base[t],this.data&&this.data_config&&(this.setBaseInfo(),this.setAttrInfo()))},setBaseInfo:function(){null!=this.data&&null!=this.data_config&&(this.hallows_name.string=this.data_config.name,this.old_step.string=this.data.step-1+Utils.TI18N("\u7ea7"),this.cur_step.string=this.data.step+Utils.TI18N("\u7ea7"))},setAttrInfo:function(){if(null!=this.data){var t=this.data,e=gdata("hallows_data","data_info",Utils.getNorKey(t.id,t.step-1)),i=gdata("hallows_data","data_info",Utils.getNorKey(t.id,t.step));if(null!=e&&null!=i){for(var s in e.attr){if(s>1)break;var n=e.attr[s][0],a=e.attr[s][1];if(l=Config.attr_data.data_key_to_name[n])(r=this.item_list[parseInt(s)+1])&&(r.title.string=l,r.last_lev.string=a)}for(var o in i.attr){if(s>1)break;var l,r;n=i.attr[o][0],a=i.attr[o][1];if(l=Config.attr_data.data_key_to_name[n])(r=this.item_list[parseInt(o)+1])&&(r.arrow.active=!0,r.now_lev.string=a,null==e.attr[o]&&(r.title.string=l,r.last_lev.string=0))}}}},handleEffect:function(t){if(t){var e=s.getSpinePath(s.getEffectRes(189),"action");this.loadRes(e,function(t){this.title_eff_sk.skeletonData=t,this.title_eff_sk.setAnimation(0,PlayerAction.action,!1)}.bind(this))}else this.title_eff_sk&&(this.title_eff_sk.setToSetupPose(),this.title_eff_sk.clearTracks())},closeCallBack:function(){this.handleEffect(!1),this.ctrl.openHallowsStepUpWindow(!1)}});cc._RF.pop()},{pathtool:"pathtool"}],hallows_task_item_panel:[function(t,e,i){"use strict";cc._RF.push(e,"63ba2HlWqRBuaNP4xbeKvd2","hallows_task_item_panel");var s=t("pathtool"),n=t("hallows_controller"),a=t("task_controller");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("hallows","hallows_task_item"),this.is_completed=!1,this.ctrl=n.getInstance()},initConfig:function(){},initPanel:function(){this.background=this.root_wnd.getChildByName("background").getComponent(cc.Sprite),this.loadRes(s.getUIIconPath("hallows","hallows_1002"),function(t){this.background.spriteFrame=t}.bind(this)),this.finish_icon=this.root_wnd.getChildByName("finish_icon"),this.finish_icon_img=this.finish_icon.getComponent(cc.Sprite),this.loadRes(s.getCommonIcomPath("common_1000"),function(t){this.finish_icon_img.spriteFrame=t}.bind(this)),this.get_btn=this.root_wnd.getChildByName("get_btn"),this.get_btn.getChildByName("label").getComponent(cc.Label).string=Utils.TI18N("\u9886\u53d6"),this.goto_btn=this.root_wnd.getChildByName("goto_btn"),this.goto_btn.getChildByName("label").getComponent(cc.Label).string=Utils.TI18N("\u524d\u5f80"),this.backpack_item=ItemsPool.getInstance().getItem("backpack_item"),this.backpack_item.setParent(this.root_wnd),this.backpack_item.setPosition(-103.5,-16.5),this.backpack_item.initConfig(!1,.7,!1,!0),this.backpack_item.show(),this.task_desc=this.root_wnd.getChildByName("title_label").getComponent(cc.RichText)},setData:function(t){this.data=t,this.root_wnd&&this.updateData()},updateData:function(){if(null!=this.data){var t=gdata("hallows_data","data_task",this.data.id);if(this.get_btn.name="get_btn_"+this.data.id,this.goto_btn.name="goto_btn_"+this.data.id,t){this.task_desc.string=cc.js.formatStr("%s(%s/%s)",t.desc,this.data.value||0,this.data.target_val||0);var e=t.items;if(e&&e[0]){var i={bid:e[0][0],num:e[0][1]};this.backpack_item.setData(i)}this.config=t}this.goto_btn.active=!1,this.get_btn.active=!1,this.finish_icon.active=!1,0==this.data.finish?this.goto_btn.active=!0:1==this.data.finish?(this.get_btn.active=!0,Utils.addRedPointToNodeByStatus(this.get_btn,!0,5,5)):2==this.data.finish&&(this.finish_icon.active=!0)}},registerEvent:function(){this.get_btn.on(cc.Node.EventType.TOUCH_END,function(){Utils.playButtonSound(ButtonSound.Normal),this.data&&this.config&&this.ctrl.requestSubmitHallowsTask(this.data.id)},this),this.goto_btn.on(cc.Node.EventType.TOUCH_END,function(){Utils.playButtonSound(ButtonSound.Normal),this.data&&this.config&&a.getInstance().gotoTagertFun(this.config.progress[0],this.config.extra)},this)},onShow:function(t){this.updateData()},onHide:function(){},onDelete:function(){this.backpack_item&&this.backpack_item.deleteMe(),this.backpack_item=null}});cc._RF.pop()},{hallows_controller:"hallows_controller",pathtool:"pathtool",task_controller:"task_controller"}],hallows_task_window:[function(t,e,i){"use strict";cc._RF.push(e,"73916WkaclNb4/zAzsuqnIG","hallows_task_window");var s=t("pathtool"),n=t("mainui_const"),a=t("mainui_controller"),o=t("hallows_event"),l=t("common_scrollview"),r=t("hallows_task_item_panel"),c=t("partner_calculate");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("hallows","hallows_task_window"),this.viewTag=SCENE_TAG.ui,this.win_type=WinType.Full,this.ctrl=arguments[0],this.model=this.ctrl.getModel(),this.rleasePrefab=!1},initConfig:function(){this.attr_bgs=[],this.base_attr_list={},this.all_hallows_id=[],this.cur_index=0},openCallBack:function(){this.background=this.seekChild(this.root_wnd,"background"),this.background.scale=FIT_SCALE,this.bg=this.seekChild(this.root_wnd,"background",cc.Sprite),this.loadRes(s.getBigBg("bigbg_68","jpg"),function(t){this.bg.spriteFrame=t}.bind(this)),this.main_panel=this.seekChild("main_panel"),this.title_bg=this.main_panel.getChildByName("title_bg").getComponent(cc.Sprite),this.loadRes(s.getCommonIcomPath("common_2015"),function(t){this.title_bg.spriteFrame=t}.bind(this)),this.skill_bg=this.main_panel.getChildByName("skill_bg"),this.skill_bg_img=this.skill_bg.getComponent(cc.Sprite),this.loadRes(s.getCommonIcomPath("common_1092"),function(t){this.skill_bg_img.spriteFrame=t}.bind(this)),this.bottom_bg=this.main_panel.getChildByName("bottom_bg").getComponent(cc.Sprite),this.loadRes(s.getUIIconPath("hallows","hallows_1001"),function(t){this.bottom_bg.spriteFrame=t}.bind(this)),this.task_panel=this.seekChild(this.main_panel,"task_panel"),this.attr_panel=this.seekChild(this.main_panel,"attr_panel"),this.attr_panel.active=!1,this.attr_bg_1=this.attr_panel.getChildByName("attr_bg_1").getComponent(cc.Sprite),this.attr_bg_2=this.attr_panel.getChildByName("attr_bg_2").getComponent(cc.Sprite),this.loadRes(s.getUIIconPath("hallows","hallows_1007"),function(t){this.attr_bg_1.spriteFrame=t,this.attr_bg_2.spriteFrame=t}.bind(this)),this.max_bg_l=this.attr_panel.getChildByName("max_bg_l").getComponent(cc.Sprite),this.max_bg_r=this.attr_panel.getChildByName("max_bg_r").getComponent(cc.Sprite),this.loadRes(s.getUIIconPath("hallows","hallows_1005"),function(t){this.max_bg_l.spriteFrame=t,this.max_bg_r.spriteFrame=t}.bind(this)),this.bottom_bg_2=this.attr_panel.getChildByName("bottom_bg_2").getComponent(cc.Sprite),this.loadRes(s.getCommonIcomPath("common_2007"),function(t){this.bottom_bg_2.spriteFrame=t}.bind(this)),this.desc_label=this.attr_panel.getChildByName("desc_label").getComponent(cc.Label),this.desc_label.string=Utils.TI18N("\u51fa\u6218\u754c\u9762\u9009\u62e9\u7a7f\u6234\u6fc0\u6d3b\u795e\u5668\u6280\u80fd\u548c\u4e3b\u5c5e\u6027"),this.go_battle_btn=this.seekChild(this.attr_panel,"go_battle_btn"),this.hallows_name=this.seekChild(this.main_panel,"hallows_name",cc.Label),this.explain_btn=this.seekChild(this.main_panel,"explain_btn"),this.artifact_btn=this.seekChild(this.main_panel,"artifact_btn"),this.touch_layout=this.seekChild(this.main_panel,"touch_layout"),this.progress=this.seekChild(this.main_panel,"progress").getComponent(cc.ProgressBar),this.progress_value=this.seekChild(this.main_panel,"value").getComponent(cc.Label),this.left_btn=this.seekChild(this.main_panel,"left_btn"),this.right_btn=this.seekChild(this.main_panel,"right_btn"),this.list_view=this.seekChild(this.main_panel,"list_view");for(var t=1;t<3;t++){var e=this.seekChild(this.main_panel,"attr_bg_"+t);this.attr_bgs[t]=e}this.hallows_eff_node=this.seekChild("hallows_eff_node"),this.hallows_eff_sk=this.seekChild("hallows_eff_node",sp.Skeleton)},registerEvent:function(){this.artifact_btn.on("click",function(){Utils.playButtonSound(ButtonSound.Normal),this.ctrl.openHallowsPreviewWindow(!0)},this),this.go_battle_btn.on("click",function(){Utils.playButtonSound(ButtonSound.Normal),a.getInstance().changeMainUIStatus(n.btn_index.drama_scene),this.ctrl.openHallowsMainWindow(!1)},this),this.explain_btn.on(cc.Node.EventType.TOUCH_END,function(e){Utils.playButtonSound(ButtonSound.Normal);var i=i=Config.hallows_data.data_const.game_rule,s=e.touch.getLocation();t("tips_controller").getInstance().showCommonTips(i.desc,s,null,null,500)},this),this.left_btn.on("click",function(){Utils.playButtonSound(ButtonSound.Normal),this._onClickBtnLeft()},this),this.right_btn.on("click",function(){Utils.playButtonSound(ButtonSound.Normal),this._onClickBtnRight()},this),this.touch_layout.on(cc.Node.EventType.TOUCH_END,function(){if(Utils.playButtonSound(ButtonSound.Normal),this.hallows_id){var t=this.model.makeHighestHallowVo(this.hallows_id);this.ctrl.openHallowsTips(!0,t)}},this),this.addGlobalEvent(o.UpdateHallowsTaskEvent,function(){this.updateHallowsTaskInfo()}.bind(this)),this.addGlobalEvent(o.HallowsUpdateEvent,function(t){t==this.hallows_id&&this.refreshView()}.bind(this)),this.addGlobalEvent(o.HallowsActivityEvent,function(){var t=this.model.getCurActivityHallowsId();t&&(this.hallows_id=t,this.initUnlockHallowsData(t),this.refreshView())}.bind(this)),this.addGlobalEvent(o.UndateHallowsInfoEvent,function(t){t&&this.hallows_id!=t&&(this.hallows_id=t,this.initUnlockHallowsData(t),this.refreshView())}.bind(this))},openRootWnd:function(t){(t=t||this.model.getCurActivityHallowsId())&&(this.hallows_id=t,this.initUnlockHallowsData(t),this.refreshView())},initUnlockHallowsData:function(t){this.all_hallows_id=[];var e=this.model.getCurActivityHallowsId();for(var i in Config.hallows_data.data_base){var s=Config.hallows_data.data_base[i];(this.model.getHallowsById(s.id)||s.id==e)&&(this.all_hallows_id.push(s.id),t&&s.id==t&&(this.cur_index=this.all_hallows_id.length-1))}this.left_btn.active=this.all_hallows_id.length>1,this.right_btn.active=this.all_hallows_id.length>1},updateHallowsBaseInfo:function(){if(this.hallows_id){var t=Config.hallows_data.data_base[this.hallows_id];if(t)if(this.hallows_model_id!=t.effect&&(this.hallows_model_id=t.effect,this.hallows_eff_sk&&(this.hallows_eff_sk.setToSetupPose(),this.hallows_eff_sk.clearTracks())),this.hallows_name.string=t.name,this.model.getHallowsById(this.hallows_id)){this.hallows_eff_node.color=new cc.Color(255,255,255,255);var e=s.getSpinePath(this.hallows_model_id,"action");this.loadRes(e,function(t){this.hallows_eff_sk.skeletonData=t,this.hallows_eff_sk.setAnimation(0,PlayerAction.action_2,!0)}.bind(this))}else{this.hallows_eff_node.color=new cc.Color(169,169,169,255);e=s.getSpinePath(this.hallows_model_id,"action");this.loadRes(e,function(t){this.hallows_eff_sk.skeletonData=t,this.hallows_eff_sk.setAnimation(0,PlayerAction.action_1,!0)}.bind(this))}}},updateHallowsTaskInfo:function(){if(this.hallows_id)if(this.model.getHallowsById(this.hallows_id)){for(var t in this.attr_panel.active=!0,this.task_panel.active=!1,this.progress.progress=1,this.progress_value.string=Utils.TI18N("\u5df2\u5b8c\u6210"),this.base_attr_list)this.base_attr_list[t].active=!1;var e=gdata("hallows_data","data_info",Utils.getNorKey(this.hallows_id,1));if(e)for(var i in e.attr){if(i>2)break;var n=e.attr[i][0],a=e.attr[i][1]||0,o=Config.attr_data.data_key_to_name[n];if(o){var _=this.base_attr_list[i];if(!_)(_=Utils.createRichLabel(24,new cc.Color(100,50,35,255),cc.v2(0,.5),cc.v2(20,20),30,380)).horizontalAlign=cc.macro.TextAlignment.LEFT,this.attr_bgs[parseInt(i)+1].addChild(_.node),this.base_attr_list[i]=_;_.active=!0;var h=s.getAttrIconByStr(n);1==c.isShowPerByStr(n)&&(a=a/10+"%");var d=cc.js.formatStr("<img src='%s'/> <color=#643223> %s%s\uff1a</c><color=#643223>%s</c>",h,Utils.TI18N("\u5168\u961f"),o,a);_.string=d,this.loadRes(s.getCommonIcomPath(h),function(t,e){t.spriteFrame=e}.bind(this,_))}}}else{this.attr_panel.active=!1,this.task_panel.active=!0;var u=this.model.getHallowsTaskList(this.hallows_id);if(u){var m=u.length,f=0;for(var p in u)2==u[p].finish&&(f+=1);var g=f/m;this.progress.progress=g,this.progress_value.string=f+"/"+m}if(null==this.scroll_view){var v=this.list_view.getContentSize(),b={item_class:r,start_x:0,space_x:10,start_y:0,space_y:4,item_width:331,item_height:139,row:0,col:2,need_dynamic:!0};this.scroll_view=new l,this.scroll_view.createScroll(this.list_view,null,null,null,v,b)}this.scroll_view.setData(u)}},updateHallowsSkillInfo:function(){if(this.hallows_id){var e=gdata("hallows_data","data_skill_up",Utils.getNorKey(this.hallows_id,1));if(e&&0!=e.skill_bid){var i=gdata("skill_data","data_get_skill",e.skill_bid)||{};if(!this.skill_icon){var s=t("skill_item");this.skill_icon=new s,this.skill_icon.setParent(this.skill_bg),this.skill_icon.setScale(.9),this.skill_icon.setLeveStatus(!1),this.skill_icon.setPosition(cc.v2(75,70))}this.skill_icon.setData(i.bid),this.skill_name||(this.skill_name=Utils.createLabel(24,new cc.Color(255,238,194,255),null,135,80,"",this.skill_bg,1,cc.v2(0,0))),this.skill_name.string=i.name,this.skill_desc||(this.skill_desc=Utils.createRichLabel(20,new cc.Color(255,238,194,255),cc.v2(0,1),cc.v2(135,80),30,500),this.skill_desc.horizontalAlign=cc.macro.TextAlignment.LEFT,this.skill_bg.addChild(this.skill_desc.node)),this.skill_desc.string=i.des}}},_onClickBtnLeft:function(){this.cur_index=this.cur_index-1,this.cur_index<0&&(this.cur_index=this.all_hallows_id.length-1),this.hallows_id=this.all_hallows_id[this.cur_index],this.refreshView()},_onClickBtnRight:function(){this.cur_index=this.cur_index+1,this.cur_index>=this.all_hallows_id.length&&(this.cur_index=0),this.hallows_id=this.all_hallows_id[this.cur_index],this.refreshView()},refreshView:function(){this.updateHallowsBaseInfo(),this.updateHallowsTaskInfo(),this.updateHallowsSkillInfo()},closeCallBack:function(){this.scroll_view&&(this.scroll_view.deleteMe(),this.scroll_view=null),this.skill_icon&&(this.skill_icon.deleteMe(),this.skill_icon=null),this.hallows_eff_sk&&(this.hallows_eff_sk.setToSetupPose(),this.hallows_eff_sk.clearTracks()),this.ctrl.openHallowsMainWindow(!1)}});cc._RF.pop()},{common_scrollview:"common_scrollview",hallows_event:"hallows_event",hallows_task_item_panel:"hallows_task_item_panel",mainui_const:"mainui_const",mainui_controller:"mainui_controller",partner_calculate:"partner_calculate",pathtool:"pathtool",skill_item:"skill_item",tips_controller:"tips_controller"}],hallows_tips_window:[function(t,e,i){"use strict";cc._RF.push(e,"bdefcwH+vxF2ZiJr9BkScZd","hallows_tips_window");var s=t("pathtool");t("backpack_const"),cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("hallows","hallows_tips"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Tips,this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){this.is_full_screen=!1,this.base_list={}},openCallBack:function(){this.background=this.root_wnd.getChildByName("background"),this.background.scale=FIT_SCALE,this.main_panel=this.root_wnd.getChildByName("main_panel"),this.lab_name_node=this.main_panel.getChildByName("lab_name"),this.box_bg=this.main_panel.getChildByName("box_bg").getComponent(cc.Sprite),this.loadRes(s.getUIIconPath("tips","tips_6"),function(t){this.box_bg.spriteFrame=t}.bind(this)),this.line=this.main_panel.getChildByName("line").getComponent(cc.Sprite),this.loadRes(s.getUIIconPath("tips","tips_8"),function(t){this.line.spriteFrame=t}.bind(this)),this.lab_name=this.main_panel.getChildByName("lab_name").getComponent(cc.Label),this.node_dec=this.main_panel.getChildByName("node_dec"),this.lab_dec=Utils.createRichLabel(22,new cc.Color(224,191,152,255),cc.v2(0,1),cc.v2(0,0),28,366),this.lab_dec.horizontalAlign=cc.macro.TextAlignment.LEFT,this.node_dec.addChild(this.lab_dec.node),this.node_item=this.main_panel.getChildByName("node_item"),this.lab_base=this.main_panel.getChildByName("lab_base").getComponent(cc.Label),this.lab_base.string=Utils.TI18N("\u57fa\u7840\u5c5e\u6027(\u5347\u7ea7\u5c5e\u6027\u5f3a\u5316\u6548\u679c)"),this.lab_special=this.main_panel.getChildByName("lab_special").getComponent(cc.Label),this.lab_special.string=Utils.TI18N("\u7279\u6b8a\u5c5e\u6027(\u5347\u7ea7\u6280\u80fd\u5f3a\u5316\u6548\u679c)"),this.attr_info_list={};for(var t=1;t<3;t++){var e={};e.attr_label=this.main_panel.getChildByName("attr_label"+t).getComponent(cc.Label),e.attr_icon=this.main_panel.getChildByName("attr_icon"+t).getComponent(cc.Sprite),this.attr_info_list[t]=e}this.special_info_list={};for(var i=1;i<4;i++){var n={};n.apecial_left_label=this.main_panel.getChildByName("apecial_left_label"+i).getComponent(cc.Label),n.apecial_right_label=this.main_panel.getChildByName("apecial_right_label"+i).getComponent(cc.Label),this.special_info_list[i]=n}},registerEvent:function(){this.background.on(cc.Node.EventType.TOUCH_END,function(){Utils.playButtonSound(ButtonSound.Close),this.ctrl.openHallowsTips(!1)},this)},openRootWnd:function(t){if(t){var e=null;if(e="number"==typeof t?this.model.getHallowsById(t):t){var i=e.id,n=1,a=!1;if(e?n=e.skill_lev:a=!0,this.config=gdata("hallows_data","data_base",i),this.config){var o=cc.js.formatStr("%s(+%s)",this.config.name,e.step);if(this.lab_name.string=o,Utils.getItemConfig(this.config.item_id)){if(this.node_item.setScale(.9),this.hallows_item||(this.hallows_item=ItemsPool.getInstance().getItem("backpack_item"),this.hallows_item.initConfig(!1,1,!1,!1),this.hallows_item.setParent(this.node_item),this.hallows_item.show()),this.hallows_item.setData(this.config.item_id),a){var l=s.getCommonIcomPath("common_90009"),r=Utils.createImage(this.node_item,null,x,y,cc.v2(.5,.5),!0,0,!1);this.loadRes(l,function(t){r.spriteFrame=t}.bind(this)),r.setScale(.8)}var c=Utils.getNorKey(i,n),_=gdata("hallows_data","data_skill_up",c);if(_){var h=gdata("skill_data","data_get_skill",_.skill_bid);h&&(this.lab_dec.string=h.des)}}var d=e.add_attr;for(var u in this.attr_info_list){var m=this.attr_info_list[u],f=d[u-1];if(f){var p=f.attr_id,g=f.attr_val,v=gdata("attr_data","data_id_to_key",p),b=s.getAttrIconByStr(v);l=s.getCommonIcomPath(b);LoaderManager.getInstance().loadRes(l,function(t,e){t.spriteFrame=e,t.active=!0}.bind(this,m.attr_icon));var w=gdata("attr_data","data_key_to_name",v),C=cc.js.formatStr("%s%s+%s",Utils.TI18N("\u5168\u961f"),w,g);m.attr_label.string=C,m.attr_label.active=!0}else m.attr_label.active=!1,m.attr_icon.active=!1}var k=gdata("hallows_data","data_skill_attr",i);if(k)for(var S in this.special_info_list){var T=this.special_info_list[S];if(k[S]){T.apecial_left_label.string=k[S].desc;o=cc.js.formatStr(Utils.TI18N("\u6280\u80fd\u7b49\u7ea7%s\u7ea7"),k[S].lev_limit);T.apecial_right_label.string=o,(a||n<k[S].lev_limit)&&(T.apecial_left_label.node.color=new cc.Color(139,123,105,255),T.apecial_right_label.node.color=new cc.Color(139,123,105,255)),T.apecial_left_label.active=!0,T.apecial_right_label.active=!0}else T.apecial_left_label.active=!1,T.apecial_right_label.active=!1}}}}},closeCallBack:function(){this.hallows_item&&this.hallows_item.deleteMe(),this.hallows_item=null,this.ctrl.openHallowsTips(!1)}});cc._RF.pop()},{backpack_const:"backpack_const",pathtool:"pathtool"}],hallows_trace_window:[function(t,e,i){"use strict";cc._RF.push(e,"f6b31ozLvBNMIhH+5tRauox","hallows_trace_window");var s=t("pathtool"),n=t("backpack_controller");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("hallows","hallows_trace_window"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Big,this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){this.attr_list={},this.this_use_num=0,this.cost_config=Config.hallows_data.data_const.id_stone,this.attr_config=Config.hallows_data.data_const.stone_attribute},openCallBack:function(){this.background=this.root_wnd.getChildByName("background"),this.background.scale=FIT_SCALE;var t=this.root_wnd.getChildByName("main_panel");this.background_img=t.getChildByName("background").getComponent(cc.Sprite),this.loadRes(s.getCommonIcomPath("common_1036"),function(t){this.background_img.spriteFrame=t}.bind(this)),this.Image_1=t.getChildByName("Image_1").getComponent(cc.Sprite),this.loadRes(s.getCommonIcomPath("common_1037"),function(t){this.Image_1.spriteFrame=t}.bind(this)),this.Image_2=t.getChildByName("Image_2").getComponent(cc.Sprite),this.loadRes(s.getCommonIcomPath("common_1024"),function(t){this.Image_2.spriteFrame=t}.bind(this)),this.Image_5=t.getChildByName("Image_5").getComponent(cc.Sprite),this.loadRes(s.getCommonIcomPath("common_90024"),function(t){this.Image_5.spriteFrame=t}.bind(this)),this.Sprite_5=t.getChildByName("Sprite_5").getComponent(cc.Sprite),this.Sprite_6=t.getChildByName("Sprite_6").getComponent(cc.Sprite),this.loadRes(s.getCommonIcomPath("common_1033"),function(t){this.Sprite_5.spriteFrame=t,this.Sprite_6.spriteFrame=t}.bind(this)),this.Sprite_23=t.getChildByName("Sprite_23").getComponent(cc.Sprite),this.Sprite_23_0=t.getChildByName("Sprite_23_0").getComponent(cc.Sprite),this.loadRes(s.getCommonIcomPath("common_1016"),function(t){this.Sprite_23.spriteFrame=t,this.Sprite_23_0.spriteFrame=t}.bind(this)),t.getChildByName("win_title").getComponent(cc.Label).string=Utils.TI18N("\u5723\u5370"),t.getChildByName("attr_title").getComponent(cc.Label).string=Utils.TI18N("\u5f53\u524d\u5c5e\u6027"),t.getChildByName("desc").getComponent(cc.Label).string=Utils.TI18N("\u6765\u6e90:\u5145\u503c\u6d3b\u52a8"),this.cost_item=ItemsPool.getInstance().getItem("backpack_item"),this.cost_item.setParent(t),this.cost_item.setPosition(336-t.width/2,290-t.height/2),this.cost_item.initConfig(!1,1,!1,!0),this.cost_item.show(),this.can_use_label=t.getChildByName("can_use_label").getComponent(cc.RichText),this.max_btn=t.getChildByName("max_btn"),this.plus_btn=t.getChildByName("plus_btn"),this.min_btn=t.getChildByName("min_btn"),this.slider=t.getChildByName("slider").getComponent(cc.Slider),this.progress=t.getChildByName("ProgressBar").getComponent(cc.ProgressBar),this.upgrade_btn=t.getChildByName("upgrade_btn"),this.upgrade_btn_label=this.upgrade_btn.getChildByName("label").getComponent(cc.Label),this.upgrade_btn_label.string=Utils.TI18N("\u4f7f\u7528");for(var e=1;e<3;e++){var i=t.getChildByName("attr_"+e);if(i){var n={};n.item=i,n.icon=i.getChildByName("icon").getComponent(cc.Sprite),n.label=i.getChildByName("label").getComponent(cc.Label),this.attr_list[e]=n}}this.close_btn=t.getChildByName("close_btn")},registerEvent:function(){this.background.on(cc.Node.EventType.TOUCH_END,function(){Utils.playButtonSound(ButtonSound.Close),this.ctrl.openHallowsTraceWindow(!1)},this),this.close_btn.on(cc.Node.EventType.TOUCH_END,function(){Utils.playButtonSound(ButtonSound.Close),this.ctrl.openHallowsTraceWindow(!1)},this),this.upgrade_btn.on(cc.Node.EventType.TOUCH_END,function(){Utils.playButtonSound(ButtonSound.Close),this.data&&(0==this.this_use_num?this.ctrl.openHallowsTraceWindow(!1):0==this.num?message(Utils.TI18N("\u4f7f\u7528\u6570\u91cf\u4e0d\u80fd\u4e3a0")):this.ctrl.requestUseTraceItem(this.data.id,this.num))},this),this.slider.node.on("slide",function(){this.setComposeNumByPercent(this.slider.progress),this.progress.progress=this.slider.progress},this),this.min_btn.on(cc.Node.EventType.TOUCH_END,function(){Utils.playButtonSound(ButtonSound.Normal),0!=this.slider.progress&&0!=this.num&&0!=this.this_use_num&&(this.num=this.num-1,this.setComposeNum(this.num))},this),this.plus_btn.on(cc.Node.EventType.TOUCH_END,function(){Utils.playButtonSound(ButtonSound.Normal),1!=this.slider.progress&&0!=this.this_use_num&&(this.num>=this.this_use_num||(this.num=this.num+1,this.setComposeNum(this.num)))},this),this.max_btn.on(cc.Node.EventType.TOUCH_END,function(){Utils.playButtonSound(ButtonSound.Normal),1!=this.slider.progress&&0!=this.this_use_num&&(this.num>=this.this_use_num||(this.num=this.this_use_num,this.setComposeNum(this.num)))},this)},setComposeNum:function(t){this.num=t;var e=this.num/this.this_use_num||0;this.slider.progress=e,this.progress.progress=this.slider.progress,this.fileNum(t)},setComposeNumByPercent:function(t){this.num=Math.floor(t*this.this_use_num),this.fileNum(this.num)},fileNum:function(t){null!=this.had_max_num&&this.cost_item.setNeedNum(t,this.had_max_num)},openRootWnd:function(t){if(this.data=t,t&&t.vo&&this.cost_config){if(this.had_use_num=t.vo.seal,this.use_max_num=this.getUseMaxNum(),0==this.use_max_num)return;var e=Config.hallows_data.data_max_lev[this.data.id];if(null==e)return;var i=this.data.vo.step;if(this.had_use_num<this.use_max_num)this.can_use_label.string=cc.js.formatStr(Utils.TI18N("\u5f53\u524d\u5df2\u4f7f\u7528:%s/%s"),this.had_use_num,this.use_max_num);else if(i>=e)this.can_use_label.string=cc.js.formatStr(Utils.TI18N("\u5df2\u8fbe\u6700\u5927\u4f7f\u7528\u6570\u91cf:%s/%s"),this.had_use_num,this.use_max_num);else{var s=gdata("hallows_data","data_trace_cost",Utils.getNorKey(this.data.id,i+1));s&&(this.can_use_label.string=cc.js.formatStr(Utils.TI18N("\u5723\u5668%s\u9636\u53ef\u589e\u52a0\u4f7f\u7528\u6570\u91cf:%s"),i+1,s.num-this.had_use_num))}this.can_use_num=this.use_max_num-this.had_use_num,this.can_use_num<0&&(this.can_use_num=0),this.had_max_num=n.getInstance().getModel().getItemNumByBid(this.cost_config.val);var a={bid:this.cost_config.val,num:this.had_max_num};this.cost_item.setData(a),this.this_use_num=Math.min(this.can_use_num,this.had_max_num),this.num=this.this_use_num,this.setComposeNum(this.num),this.setBaseAttrList()}},setBaseAttrList:function(){if(null!=this.cost_config&&null!=this.attr_config){for(var t in null==this.had_use_num&&(this.had_use_num=0),this.attr_list)this.attr_list[t].item.active=!1;for(var e in this.attr_config.val){var i=this.attr_config.val[e],n=i[0],a=i[1]*this.had_use_num,o=Config.attr_data.data_key_to_name[n];if(o){var l=s.getAttrIconByStr(n),r=cc.js.formatStr(Utils.TI18N(" %s +%s"),o,a),c=this.attr_list[parseInt(e)+1];if(c){c.item.active=!0;var _=s.getCommonIcomPath(l);this.loadRes(_,function(t,e){t.spriteFrame=e}.bind(this,c.icon)),c.label.string=r}}}}},getUseMaxNum:function(){if(null!=this.data&&null!=this.data.vo){var t=gdata("hallows_data","data_trace_cost",Utils.getNorKey(this.data.id,this.data.vo.step));return t?t.num:0}},closeCallBack:function(){this.cost_item&&this.cost_item.onDelete(),this.cost_item=null,this.ctrl.openHallowsTraceWindow(!1)}});cc._RF.pop()},{backpack_controller:"backpack_controller",pathtool:"pathtool"}],hallows_vo:[function(t,e,i){"use strict";cc._RF.push(e,"e55a2NHF6NHZb9LJs9iCTat","hallows_vo");var s=cc.Class({extends:gcore.BaseEvent,ctor:function(){this.initData()},initData:function(){this.id=0,this.step=1,this.lucky=0,this.lucky_endtime=0,this.power=0,this.seal=0,this.add_attr={},this.reward={},this.skill_bid=0,this.skill_lev=1,this.is_update=!1,this.red_status_list={}},initAttributeData:function(t){for(var e in this.is_update=!0,t)null!=this[e]&&this.updateSingleData(e,t[e]),"add_attr"==e?this.updateAddAttr(t[e]):"skill"==e&&this.updateSkill(t[e])},updateSingleData:function(t,e){this[t]!=e&&(this[t]=e)},updateAddAttr:function(t){this.add_attr=t||{}},checkRedStatus:function(t){if(this.is_update||t)return this.is_update=!1,this.red_status_list={},!1;for(var e in this.red_status_list)if(this.red_status_list[e])return!0;return!1},getRedStatus:function(t){return this.red_status_list[t]},checkCanUpgrade:function(){return!1},checkCanUseTrace:function(){return!1},checkCanUpgradeSkill:function(){return!1},updateSkill:function(t){t[0]&&(this.skill_bid=t[0].skill_bid,this.skill_lev=t[0].lev)},checkRewardsIsOver:function(t){return this.reward[t]},_delete:function(){}});e.exports=s,cc._RF.pop()},{}],head_circle_tips:[function(t,e,i){"use strict";cc._RF.push(e,"a61d57TENZIULlk4bQyWy8q","head_circle_tips");var s=t("pathtool"),n=t("tips_const"),a=(t("string_util"),t("timetool"));cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("tips","headcircle_tips"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Tips},initConfig:function(){this.tips_controller=t("tips_controller").getInstance()},openCallBack:function(){this.background=this.seekChild("background"),this.main_panel=this.seekChild("main_panel"),this.time_label=this.seekChild(this.main_panel,"time_label",cc.Label),this.desc=this.seekChild(this.main_panel,"desc",cc.RichText),this.name=this.seekChild(this.main_panel,"name",cc.Label),this.icon=this.seekChild(this.main_panel,"icon",cc.Sprite)},registerEvent:function(){this.background.on(cc.Node.EventType.TOUCH_START,function(t){this.tips_controller.closeTIpsByType(n.type.HEAD_CIRCLE)}.bind(this))},openRootWnd:function(t){var e=Config.avatar_data.data_avatar[t.bid];this.loadRes(s.getHeadcircle(e.res_id),function(t){this.icon.spriteFrame=t}.bind(this)),this.name.string=e.name,this.desc.string=Utils.TI18N("\u6fc0\u6d3b\u6761\u4ef6\uff1a")+e.desc,e.expire_time>0?this.time_label.string=Utils.TI18N("\u4f7f\u7528\u671f\u9650\uff1a")+a.getTimeFormatDay(60*e.expire_time):this.time_label.string=Utils.TI18N("\u4f7f\u7528\u671f\u9650\uff1a\u6c38\u4e45")},closeCallBack:function(){this.tips_controller.closeTIpsByType(n.type.HEAD_CIRCLE)}});cc._RF.pop()},{pathtool:"pathtool",string_util:"string_util",timetool:"timetool",tips_const:"tips_const",tips_controller:"tips_controller"}],hero_bag_window:[function(t,e,i){"use strict";cc._RF.push(e,"0de4dtCbj5N5qD1QLdL024V","hero_bag_window");var s=t("hero_const"),n=t("hero_event"),a=t("hero_calculate"),o=t("pathtool"),l=t("guide_controller");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=o.getPrefabPath("hero","hero_bag_window"),this.viewTag=SCENE_TAG.ui,this.win_type=WinType.Full,this.rleasePrefab=!1,this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){this.cur_index=1,this.cur_camp=0,this.camp_btns={},this.cur_role_list={}},openCallBack:function(){this.tab_btn_1_nd=this.seekChild("tab_btn_1"),this.tab_btn_1_normal_nd=this.tab_btn_1_nd.getChildByName("normal_img"),this.tab_btn_1_select_nd=this.tab_btn_1_nd.getChildByName("select_img"),this.tab_btn_1_label_nd=this.tab_btn_1_nd.getChildByName("label"),this.tab_btn_1_red_point_nd=this.tab_btn_1_nd.getChildByName("red_point"),this.background=this.seekChild("background"),this.loadRes(o.getBigBg("hero/hero_bag_bg"),function(t){this.background.getComponent(cc.Sprite).spriteFrame=t}.bind(this)),this.tab_btn_2_nd=this.seekChild("tab_btn_2"),this.tab_btn_2_normal_nd=this.tab_btn_2_nd.getChildByName("normal_img"),this.tab_btn_2_select_nd=this.tab_btn_2_nd.getChildByName("select_img"),this.tab_btn_2_label_nd=this.tab_btn_2_nd.getChildByName("label"),this.tab_btn_2_red_point_nd=this.tab_btn_2_nd.getChildByName("red_point"),this.camp_node_nd=this.seekChild("camp_node"),this.camp_layout_nd=this.seekChild("camp_layout"),this.img_select_nd=this.seekChild("img_select"),this.no_vedio_image_nd=this.seekChild("no_vedio_image");for(var t=0;t<6;t++)this.camp_btns[t]=this.camp_layout_nd.getChildByName("camp_btn"+t),this.camp_btns[t].camp_tag=t,this.camp_btns[t].on(cc.Node.EventType.TOUCH_END,this.didClickCampBtn,this);this.volume_lb=this.seekChild("volume",cc.Label),this.add_btn_nd=this.seekChild("add_btn"),this.embattle_btn_nd=this.seekChild("embattle_btn"),this.listview_container_nd=this.seekChild("lay_scrollview"),this.tab_btn_1_red_point_nd.active=!1,this.tab_btn_2_red_point_nd.active=!1,this.add_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickAddBtn,this),this.tab_btn_1_nd.on(cc.Node.EventType.TOUCH_END,this.didClickTabBtn,this),this.tab_btn_2_nd.on(cc.Node.EventType.TOUCH_END,this.didClickTabBtn,this),this.embattle_btn_nd.on(cc.Node.EventType.TOUCH_END,this.didClickEmbattleBtn,this),this.initListView(),this.time_ticket=gcore.Timer.set(function(){gcore.Timer.del(this.time_ticket),this.updageTapIndex()}.bind(this),100,1),this.background.scale=FIT_SCALE},registerEvent:function(){this.addGlobalEvent(n.Buy_Hero_Max_Count_Event,function(){this.updateBagVal()}.bind(this)),this.addGlobalEvent(n.All_Hero_RedPoint_Event,function(t){this.updateHeroBagRedpoint(t)}.bind(this)),this.addGlobalEvent(n.Del_Hero_Event,function(){this.updageTapIndex(),this.updateBagVal()}.bind(this)),this.addGlobalEvent(n.Hero_Data_Add,function(){this.updageTapIndex(),this.updateBagVal()}.bind(this))},openRootWnd:function(t){this.updateBagVal(),a.getInstance().checkAllHeroRedPoint()},closeCallBack:function(){this.item_scrollview&&(this.item_scrollview.deleteMe(),this.item_scrollview=null),this.ctrl.openHeroBagWindow(!1)},didClickCampBtn:function(t){var e=t.target.camp_tag;e!==this.cur_camp&&(this.img_select_nd.parent=this.camp_btns[e],this.cur_camp=e,this.updageTapIndex())},didClickTabBtn:function(t){var e=1;if("tab_btn_2"==t.target.name&&(e=2),e!==this.cur_index){this["tab_btn_"+e+"_normal_nd"].active=!1,this["tab_btn_"+e+"_select_nd"].active=!0;var i=this["tab_btn_"+e+"_label_nd"].color;i.fromHEX("#6c402c"),this["tab_btn_"+e+"_label_nd"].color=i,this["tab_btn_"+this.cur_index+"_normal_nd"].active=!0,this["tab_btn_"+this.cur_index+"_select_nd"].active=!1;var s=this["tab_btn_"+this.cur_index+"_label_nd"].color;s.fromHEX("#dda880"),this["tab_btn_"+this.cur_index+"_label_nd"].color=s,2===e?(1===this.cur_index&&(this.cur_camp=1,this.img_select_nd.parent=this.camp_btns[1]),this.camp_btns[0].active=!1):(2===this.cur_index&&(this.cur_camp=0,this.img_select_nd.parent=this.camp_btns[0]),this.camp_btns[0].active=!0),this.cur_index=e,this.updageTapIndex()}},initListView:function(){var e=t("common_scrollview"),i=cc.size(this.listview_container_nd.width,this.listview_container_nd.height);this.item_scrollview=new e,this.item_scrollview.createScroll(this.listview_container_nd,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,i,{item_class:"hero_exhibition_item",start_x:0,space_x:4,start_y:0,space_y:0,item_width:150,item_height:136,col:4,once_num:5,need_dynamic:!0},cc.v2(.5,.5)),l.getInstance().isInGuide()&&this.item_scrollview.setClickEnabled(!1)},updageTapIndex:function(){this.cur_role_list=[];var t=s.ExhibitionItemType.eNone;this.cur_index==s.BagTab.eBagHero?(t=s.ExhibitionItemType.eHeroBag,this.cur_role_list=this.model.getHeroListByCamp(this.cur_camp)):this.cur_index==s.BagTab.eBagPokedex&&(t=s.ExhibitionItemType.ePokedex,this.cur_role_list=this.model.getHeroPokedexList(this.cur_camp)),this.cur_role_list.length>0?this.no_vedio_image_nd.active=!1:this.no_vedio_image_nd.active=!0,this.item_scrollview.setData(this.cur_role_list,this.setlectHeroExhibiton.bind(this),{can_click:!0,from_type:t})},setlectHeroExhibiton:function(t){var e=this.cur_index||s.BagTab.eBagHero;this.ctrl.openHeroMainInfoWindow(!0,t.data,this.cur_role_list,{show_model_type:e})},didClickEmbattleBtn:function(t){this.ctrl.openFormMainWindow(!0)},onClickAddBtn:function(){var e=this.model.getHeroBuyNum(),i=Config.partner_data.data_partner_buy[e+1];if(i){i.expend[0][0];var s=i.expend[0][1],n=Utils.TI18N(cc.js.formatStr("\u662f\u5426\u82b1\u8d39%s<img src='%s'/> \u6269\u5145%s\u4e2a\u82f1\u96c4\u4f4d\u7f6e\u6570\u91cf\u4e0a\u9650\uff1f",s,3,i.add_num)),a=t("commonalert"),l=o.getItemRes(3);a.show(n,Utils.TI18N("\u786e\u5b9a"),function(){this.ctrl.sender11009()}.bind(this),Utils.TI18N("\u53d6\u6d88"),null,2,null,{resArr:[l]})}else message(Utils.TI18N("\u8d2d\u4e70\u6b21\u6570\u5df2\u8fbe\u4e0a\u9650"))},updateBagVal:function(){var t=this.model.getHeroMaxCount(),e=t.have_coutn+"/"+t.max_count;this.volume_lb.string=e},updateHeroBagRedpoint:function(t){for(var e in this.redpoint_status||(this.redpoint_status={}),t){var i=t[e];this.redpoint_status[i.bid]=i.status}var n=!1;for(var a in this.redpoint_status)if(this.redpoint_status[a]){n=!0;break}this.tab_btn_1_red_point_nd.active=!!n,this.cur_index==s.BagTab.eBagHero&&this.item_scrollview.resetCurrentItems()}});cc._RF.pop()},{common_scrollview:"common_scrollview",commonalert:"commonalert",guide_controller:"guide_controller",hero_calculate:"hero_calculate",hero_const:"hero_const",hero_event:"hero_event",pathtool:"pathtool"}],hero_break_exhibition_window:[function(t,e,i){"use strict";cc._RF.push(e,"af381zRigFBy4SLCDYbpQ7d","hero_break_exhibition_window");var s=t("pathtool");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("hero","hero_exhibition_window"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Full,this.ctrl=arguments[0]},initConfig:function(){},openCallBack:function(){this.main_container_nd=this.seekChild("main_container"),this.title_container_sk=this.seekChild("title_container",sp.Skeleton),this.head_con_nd=this.seekChild("head_con"),this.break_con_nd=this.seekChild("break_con"),this.mask_bg_nd=this.seekChild("mask_bg"),this.mask_bg_nd.scale=FIT_SCALE,this.attr_items={};for(var t=1;t<=6;t++){var e=this.attr_items[t]={},i=this.seekChild(this.main_container_nd,"attr_item_"+t);e.old_val_lb=this.seekChild(i,"old_val",cc.Label),e.new_val_lb=this.seekChild(i,"new_val",cc.Label)}this.hero_item=ItemsPool.getInstance().getItem("hero_exhibition_item"),this.hero_item.setParent(this.head_con_nd),this.hero_item.show(),this.mask_bg_nd.on(cc.Node.EventType.TOUCH_END,this.onClickMask,this)},registerEvent:function(){},openRootWnd:function(t){t&&(this.data=t,this.udpateWidgets())},closeCallBack:function(){this.hero_item&&this.hero_item.deleteMe(),this.ctrl.openBreakExhibitionWindow(!1)},udpateWidgets:function(){this.handleEffect(!0),this.updateHead(),this.updateAttrList()},handleEffect:function(t){if(t){var e=PlayerAction.action_6,i=s.getEffectRes(103),n=s.getSpinePath(i,"action");this.loadRes(n,function(t){cc.log(e),cc.log(t),this.title_container_sk.skeletonData=t,this.title_container_sk.setAnimation(0,e,!1)}.bind(this))}},updateHead:function(){var t=this.data.new_vo;this.hero_item.setData(t);for(var e=this.ctrl.getModel().getHeroMaxBreakCountByInitStar(t.init_star),i=t.break_lev,n=1;n<=e;n++){var a=new cc.Node,o=a.addComponent(cc.Sprite),l="hero_info_2";n<=i&&(l="hero_info_1");var r=s.getUIIconPath("hero",l);this.loadRes(r,function(t,e){t.spriteFrame=e}.bind(this,o)),this.break_con_nd.addChild(a)}},updateAttrList:function(){var t=this.data.old_vo,e=this.data.new_vo,i=t.type+"_"+t.break_id+"_"+t.break_lev||0,s=Config.partner_data.data_partner_brach[i],n=e.type+"_"+e.break_id+"_"+e.break_lev||0,a=Config.partner_data.data_partner_brach[n];if(s&&a){if(a.skill_num>s.skill_num){var o=Utils.getNorKey(t.bid,t.star),l=gdata("partner_data","data_partner_star",o);if(l){for(var r=null,c=0;c<l.skills.length;++c){var _=l.skills[c];if(_[0]==a.skill_num){r=_[1];break}}null!=r&&(this.unlock_skill_id=r)}}this.attr_items[1].old_val_lb.string=t.power,this.attr_items[1].new_val_lb.string=e.power,this.attr_items[2].old_val_lb.string=Utils.TI18N("\u7b49\u7ea7\u4e0a\u9650\uff1a")+s.lev_max,this.attr_items[2].new_val_lb.string=a.lev_max;var h=3;for(var d in a.all_attr){var u=a.all_attr[d][0];"hp_max"==u&&(u="hp");var m=Config.attr_data.data_key_to_name[u]+"\uff1a"+t[u],f=e[u];this.attr_items[h].old_val_lb.string=m,this.attr_items[h].new_val_lb.string=f,h++}}},onClickMask:function(){this.ctrl.openBreakExhibitionWindow(!1,this.unlock_skill_id)}});cc._RF.pop()},{pathtool:"pathtool"}],hero_break_window:[function(t,e,i){"use strict";cc._RF.push(e,"fb2dfJZgLJCE5tfZeGx9YKo","hero_break_window");var s=t("pathtool"),n=t("hero_event"),a=t("backpack_controller"),o=t("skill_item");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("hero","hero_break_panel"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Full,this.ctrl=arguments[0]},initConfig:function(){},openCallBack:function(){this.mask_bg_nd=this.seekChild("mask_bg"),this.attr_panel_nd=this.seekChild("attr_panel"),this.break_btn_nd=this.seekChild("break_btn"),this.empty_panel_nd=this.seekChild("empty_panel"),this.skill_panel_nd=this.seekChild("skill_panel"),this.skill_name_lb=this.seekChild("skill_name",cc.Label),this.skill_con_nd=this.seekChild("skill_con"),this.skill_item=new o,this.skill_item.setParent(this.skill_con_nd),this.skill_item.setScale(.8),this.skill_item.setShowTips(!0),this.mask_bg_nd.scale=FIT_SCALE,this.const_items={};for(var t=1;t<=2;t++){var e=this.const_items[t]={},i=e.const_panel=this.seekChild("item_cost_panel"+t);e.iten_icon=this.seekChild(i,"item_icon",cc.Sprite),e.iten_num_nd=this.seekChild(i,"label"),e.iten_num=this.seekChild(i,"label",cc.Label)}this.attr_items={};for(var s=1;s<=5;s++){var n=this.attr_items[s]={};n.attr_icon=this.seekChild(this.attr_panel_nd,"attr_icon"+s,cc.Sprite),n.attr_label_key=this.seekChild(this.attr_panel_nd,"attr_label_key"+s,cc.Label),n.attr_label_left=this.seekChild(this.attr_panel_nd,"attr_label_left"+s,cc.Label),n.attr_label_right=this.seekChild(this.attr_panel_nd,"attr_label_right"+s,cc.Label)}this.break_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickBreakBtn,this),this.mask_bg_nd.on(cc.Node.EventType.TOUCH_END,this.onClickMask,this)},registerEvent:function(){this.addGlobalEvent(n.Next_Break_Info_Event,function(t){t&&this.updateWidgets(t)}.bind(this))},openRootWnd:function(t){t&&(this.hero_vo=t,this.ctrl.sender11016(this.hero_vo.partner_id))},closeCallBack:function(){this.ctrl.openHeroBreakPanel(!1)},onClickBreakBtn:function(){if(this.hero_vo)if(this.need_items.length>0){var t=gdata("item_data","data_unit1",this.need_items[0],!1);message(Utils.TI18N("\u7269\u54c1["+t.name+"]\u4e0d\u8db3")),a.getInstance().openTipsSource(!0,this.need_items[0])}else this.ctrl.sender11004(this.hero_vo.id),this.ctrl.openHeroBreakPanel(!1)},onClickMask:function(){this.ctrl.openHeroBreakPanel(!1)},updateWidgets:function(t){var e=this.hero_vo.type+"_"+this.hero_vo.break_id+"_"+this.hero_vo.break_lev,i=this.hero_vo.type+"_"+this.hero_vo.break_id+"_"+(this.hero_vo.break_lev+1),n=Config.partner_data.data_partner_brach[e],o=Config.partner_data.data_partner_brach[i];if(n&&o){for(var l=1;l<=5;l++){var r=this.attr_items[l];if(1==l)r.attr_label_left.string=n.lev_max,r.attr_label_right.string=o.lev_max;else{var c=o.all_attr[l-2];if(c){var _=c[0],h=s.getAttrIconByStr(_),d=s.getUIIconPath("common",h);this.loadRes(d,function(t,e){t.spriteFrame=e}.bind(this,r.attr_icon));var u=Config.attr_data.data_key_to_name[_];r.attr_label_key.string=u,"hp_max"==_&&(_="hp");var m=this.hero_vo[_],f=t[_]||0;r.attr_label_left.string=m,r.attr_label_right.string=f}}}if(this.need_items=[],0==n.expend)this.const_items[1].const_panel.active=!1,this.const_items[2].const_panel.active=!1;else for(var p=1;p<=2;p++){var g=this.const_items[p],v=n.expend[p-1];if(v){var b=Utils.getItemConfig(v[0]);cc.log(b);var w=s.getIconPath("item",b.icon);this.loadRes(w,function(t,e){t.spriteFrame=e}.bind(this,g.iten_icon));var y=a.getInstance().getModel().getItemNumByBid(v[0]),C=cc.js.formatStr("%s/%s",Utils.getMoneyString(y),Utils.getMoneyString(v[1]));if(g.iten_num.string=C,y<v[1]){var k=new cc.Color(255,89,67,255);g.iten_num_nd.color=k,this.need_items.push(v[0])}}else g.const_panel.active=!1}if(o.skill_num>n.skill_num){var S=this.hero_vo.bid+"_"+this.hero_vo.star,T=gdata("partner_data","data_partner_star",S);if(T){var I=null;for(var E in T.skills)T.skills[E][0]==o.skill_num&&(I=T.skills[E][1]);if(I){var B=gdata("skill_data","data_get_skill",I);this.skill_panel_nd.active=!0,this.skill_name_lb.string=B.name,this.skill_item.setData(I)}else this.showNoneSkillInfo()}else this.showNoneSkillInfo()}else this.showNoneSkillInfo()}},showNoneSkillInfo:function(){this.skill_panel_nd.active=!1,this.empty_panel_nd.active=!0}});cc._RF.pop()},{backpack_controller:"backpack_controller",hero_event:"hero_event",pathtool:"pathtool",skill_item:"skill_item"}],hero_calculate:[function(t,e,i){"use strict";cc._RF.push(e,"a43b2Qoq7pLrawGSHCNCKmH","hero_calculate");var s=t("hero_event"),n=t("hero_const"),a=t("backpack_controller"),o=t("mainui_controller"),l=t("mainui_const"),r=cc.Class({extends:BaseClass,ctor:function(){},isEnoughCondition:function(t,e){var i=!0;for(var s in t)if("star"==t[s][0]&&e.star<t[s][1]){i=!1;break}return i},calculatePower:function(t){var e=0;if(!t||0===t.length)return e;var i=null,s=null;for(var n in t){var a=t[n];"array"==typeof a?(i=a[0],s=a[1]):(i=n,s=a);var o=Config.attr_data.data_power[i];o&&(e+=s*o*.001)}return Math.ceil(e)},checkAllHeroRedPoint:function(){var t=this.checkHeroRedPointByRedPointType(n.RedPointType.eRPLevelUp,!0),e=this.checkHeroRedPointByRedPointType(n.RedPointType.eRPEquip,!0),i=this.checkHeroRedPointByRedPointType(n.RedPointType.eRPStar,!0),a=(this.checkHeroRedPointByRedPointType(n.RedPointType.eRPTalent,!0),[t,e,i]);o.getInstance().setBtnRedPoint(l.btn_index.partner,a);a=[t,e,i];gcore.GlobalEvent.fire(s.All_Hero_RedPoint_Event,a)},checkSingleHeroRedPoint:function(t){return!!this.checkSingleHeroLevelUpRedPoint(t)||(!!this.checkSingleHeroEquipRedPoint(t)||(!!this.checkSingleHeroUpgradeStarRedPoint(t)||this.checkSingleHeroTalentSkillRedPoint(t)))},checkSingleStarFuseRedPointByStarConfig:function(e,i,s){if(!e)return!1;var n=1,a=e.expend1[0],o={},l={},r={},c=0;if(i)r[s]=1;else{if(a){var _=a[0],h=a[1],d=a[2];o[_]={},o[_][h]=d,c+=d}n+=1}for(var u=0;u<e.expend2.length;++u){_=(a=e.expend2[u])[0],h=a[1],d=a[2];o[_]||(o[_]={}),o[_][h]?o[_][h]=o[_][h]+d:o[_][h]=d,c+=d,n+=1}if(n<=4)for(u=0;u<e.expend3.length;++u){var m=(a=e.expend3[u])[0];h=a[1],d=a[2];if(l[m]||(l[m]={}),l[m][h]?l[m][h]=l[m][h]+d:l[m][h]=d,c+=d,(n+=1)>4)break}var f=t("hero_controller").getInstance().getModel().getHeroListByMatchInfo(o,l,r);return{is_redpoint:f>=c,need_count:c,total_count:f}},checkSingleArtifactRedPoint:function(e){var i=t("backpack_controller").getInstance().getModel(),s=t("backpack_const"),n=i.getAllEquipListByType(s.item_type.ARTIFACTCHIPS);return!(null!=e||!n||!Utils.equip_score_list)},clearAllHeroRecordByRedPointType:function(e,i){var s=t("hero_controller").getInstance().getModel(),a=s.getHeroList();for(var o in a)a[o].red_point[e]=null;this.checkHeroRedPointByRedPointType(e),e!=n.RedPointType.eRPLevelUp&&e!=n.RedPointType.eRPTalent||(s.is_delay_redpoint_update[e]=!1)},checkHeroRedPointByRedPointType:function(e,i){var a=t("hero_controller").getInstance().getModel().getHeroList(),r={};for(var c in r.bid=e,r.status=!1,a){var _=a[c];if(this.isCheckHeroRedPointByHeroVo(_))if(e==n.RedPointType.eRPLevelUp){if(r.status=this.checkSingleHeroLevelUpRedPoint(_),r.status)break}else if(e==n.RedPointType.eRPEquip){if(r.status=this.checkSingleHeroEquipRedPoint(_),r.status)break}else if(e==n.RedPointType.eRPStar){if(r.status=this.checkSingleHeroUpgradeStarRedPoint(_),r.status)break}else if(e==n.RedPointType.eRPTalent&&(r.status=this.checkSingleHeroTalentSkillRedPoint(_),r.status))break}if(i)return r;o.getInstance().setBtnRedPoint(l.btn_index.partner,[r]),gcore.GlobalEvent.fire(s.All_Hero_RedPoint_Event,[r])},isCheckHeroRedPointByHeroVo:function(t){if(t)return!!t.isFormDrama()},checkSingleHeroLevelUpRedPoint:function(t){if(!t)return!1;if(t.red_point&&null!=t.red_point[n.RedPointType.eRPLevelUp])return 1==t.red_point[n.RedPointType.eRPLevelUp];var e=this.getHeroShowLevelStatus(t),i=!1;if(1==e){var s=Config.partner_data.data_partner_lev[t.lev];if(s){for(var o=s.expend||[],l=!0,r=0;r<o.length;++r){var c=o[r];a.getInstance().getModel().getItemNumByBid(c[0])<c[1]&&(l=!1)}i=l}}else if(2==e){var _=Utils.getNorKey(t.type,t.break_id,t.break_lev),h=Config.partner_data.data_partner_brach[_];if(h){var d=h.expend||[],u=!0;for(r=0;r<d.length;++r){c=d[r];a.getInstance().getModel().getItemNumByBid(c[0])<c[1]&&(u=!1)}i=u}}return t.red_point&&(t.red_point[n.RedPointType.eRPLevelUp]=i),i},checkSingleHeroEquipRedPoint:function(e){if(!e)return!1;if("boolean"==typeof e.red_point[n.RedPointType.eRPEquip])return 1==e.red_point[n.RedPointType.eRPEquip];var i=!1,s=t("hero_controller").getInstance().getModel().getHeroEquipList(e.partner_id),a=n.EquipPosList||{};for(var o in a)if(i=this.checkSingleHeroEachPosEquipRedPoint(a[o],s[o]))break;return e.red_point[n.RedPointType.eRPEquip]=i,i},checkSingleHeroEachPosEquipRedPoint:function(t,e){t=t||1;var i=a.getInstance().getModel().getAllEquipListByType(t);if(e){e.all_score&&0!=e.all_score||e.setEnchantScore(0);var s=e.all_score||0;if(i)for(var n in i){var o=i[n];if(o&&o.all_score&&o.all_score>s)return!0}}else if(i&&Utils.next(i))return!0;return!1},checkSingleHeroUpgradeStarRedPoint:function(e){if(!e)return!1;var i=e.star||1,s=Utils.getNorKey(e.bid,i+1),o=gdata("partner_data","data_partner_star",s);if(!o)return e.red_point[n.RedPointType.eRPStar]=!1,!1;var l=o,r=!1,c=t("hero_controller").getInstance().getModel();(r=i!=c.hero_info_upgrade_star_param2||c.checkOpenStar11())&&(l?(r=this.checkSingleStarFuseRedPointByStarConfig(l,!0,e.partner_id).is_redpoint)&&l.other_expend.length>0&&a.getInstance().getModel().getItemNumByBid(l.other_expend[0][0])<l.other_expend[0][1]&&(r=!1):r=!1);return e.red_point[n.RedPointType.eRPStar]=r,r},checkSingleHeroTalentSkillRedPoint:function(e){if(cc.log("checkSingleHeroTalentSkillRedPoint"),!e)return!1;if(1==e.is_open_talent)return!0;if(null!=e.red_point[n.RedPointType.eRPTalent])return 1==e.red_point[n.RedPointType.eRPTalent];if(!e.ishaveTalentData())return!1;var i=!1,s=t("hero_controller").getInstance().getModel().getTalentRedpointRecord(),a={};for(var o in e.talent_skill_list){a[e.talent_skill_list[o]]=o}for(var l in Config.partner_skill_data.data_partner_skill_pos){var r=Config.partner_skill_data.data_partner_skill_pos[l];if(e.talent_skill_list[r.pos]){if(i=this.checkSingleTalentSkillLevel(e.talent_skill_list[r.pos]))break}else{var c=!1;if("star"==r.pos_limit[0]&&(c=e.star>=r.pos_limit[1]),c){for(var _ in s)if(null==a[_]){i=!0;break}if(i)break}}}return e.red_point[n.RedPointType.eRPTalent]=i,i},checkSingleTalentSkillLevel:function(t){var e=Config.partner_skill_data.data_partner_skill_level[t];if(e){for(var i=!0,s=0;s<e.expend.length;++s){var n=e.expend[s];if(a.getInstance().getModel().getItemNumByBid(n[0])<n[1]){i=!1;break}}return i}return!1},getHeroShowLevelStatus:function(t){var e=t.type+"_"+t.break_id+"_"+t.break_lev,i=Config.partner_data.data_partner_brach[e];if(!i)return-1;var s=t.type+"_"+t.break_id+"_"+(t.break_lev+1),n=Config.partner_data.data_partner_brach[s],a=i.lev_max,o=0;if(n){if(n.limit&&n.limit.length>0)if(t.lev>=i.lev_max)o=this.isEnoughCondition(n.limit,t)?2:0;else o=1;else o=t.lev>=i.lev_max?2:1}else{e=t.bid+"_"+t.star;var l=gdata("partner_data","data_partner_star",e);l&&a<l.lev_max&&(a=l.lev_max),o=t.lev>=a?0:1}return o},clearAllStarFuseRedpointRecord:function(){var e=t("hero_controller").getInstance().getModel().getStarFuseList();if(!e)return!1;for(var i in e){e[i].cur_redpoint=null}RedMgr.getInstance().addCalHandler(this.checkAllStarFuseRedpoint.bind(this),RedIds.RefuseHero)},checkAllStarFuseRedpoint:function(){var e=t("hero_controller").getInstance().getModel().getStarFuseList();if(!e)return!1;var i=this.checkCampStarFuseRedpoint(e),s=t("mainscene_controller"),n=t("scene_const");return s.getInstance().setBuildRedStatus(n.CenterSceneBuild.fuse,i),i},checkCampStarFuseRedpoint:function(t){if(!t)return!1;var e=!1,i=!1;for(var s in t){var n=t[s];i=this.checkSingleStarFuseRedPoint(n),!e&&i&&(e=!0)}return e},checkSingleStarFuseRedPoint:function(t){if(t.cur_redpoint)return 1==t.cur_redpoint;if(t.star_config){var e=this.checkSingleStarFuseRedPointByStarConfig(t.star_config);return e.is_redpoint?(e.cur_redpoint=1,t.cur_redpoint=1):(e.cur_redpoint=2,t.cur_redpoint=2),t.need_count=e.need_count||0,t.total_count=e.total_count||0,e.is_redpoint}}});r.getInstance=function(){return this.instance||(this.instance=new this),this.instance},e.exports=r,cc._RF.pop()},{backpack_const:"backpack_const",backpack_controller:"backpack_controller",hero_const:"hero_const",hero_controller:"hero_controller",hero_event:"hero_event",mainscene_controller:"mainscene_controller",mainui_const:"mainui_const",mainui_controller:"mainui_controller",scene_const:"scene_const"}],hero_const:[function(t,e,i){"use strict";var s,n,a,o,l,r,c;function _(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}cc._RF.push(e,"b16e9dSbXpH6K8w2egk18m4","hero_const");var h={},d=t("backpack_const");h.BagTab={eBagHero:1,eBagPokedex:2,eHalidom:4},h.MainInfoTab={eMainTrain:1,eMainUpgradeStar:2,eMainTalent:3},h.FormMiddleTab={eFormHero:1,eFormHallows:2,eFormFormation:3},h.FormShowType={eFormFight:1,eFormSave:2},h.LockType={eHeroLock:1,eHeroChangeLock:2,eFormLock:99},h.CampType={eNone:0,eWater:1,eFire:2,eWind:3,eLight:4,eDark:5},h.CampName=(_(s={},h.CampType.eNone,"\u65e0"),_(s,h.CampType.eWater,"\u6c34"),_(s,h.CampType.eFire,"\u706b"),_(s,h.CampType.eWind,"\u98ce"),_(s,h.CampType.eLight,"\u5149"),_(s,h.CampType.eDark,"\u6697"),s),h.CampAttrName=(_(n={},h.CampType.eNone,"\u65e0"),_(n,h.CampType.eWater,"\u6c34\u7cfb"),_(n,h.CampType.eFire,"\u706b\u7cfb"),_(n,h.CampType.eWind,"\u81ea\u7136"),_(n,h.CampType.eLight,"\u5149\u660e"),_(n,h.CampType.eDark,"\u9ed1\u6697"),n),h.CampBgRes=(_(a={},h.CampType.eWater,"hero_info_bg_1"),_(a,h.CampType.eFire,"hero_info_bg_2"),_(a,h.CampType.eWind,"hero_info_bg_3"),_(a,h.CampType.eLight,"hero_info_bg_4"),_(a,h.CampType.eDark,"hero_info_bg_5"),a),h.CampBottomBgRes=(_(o={},h.CampType.eWater,"hero_camp_1"),_(o,h.CampType.eFire,"hero_camp_2"),_(o,h.CampType.eWind,"hero_camp_3"),_(o,h.CampType.eLight,"hero_camp_4"),_(o,h.CampType.eDark,"hero_camp_5"),o),h.CareerType={eNone:0,eMagician:2,eWarrior:3,eTank:4,eSsistant:5},h.CareerName=(_(l={},0,"\u65e0"),_(l,h.CareerType.eMagician,"\u6cd5\u5e08"),_(l,h.CareerType.eWarrior,"\u6218\u58eb"),_(l,h.CareerType.eTank,"\u5766\u514b"),_(l,h.CareerType.eSsistant,"\u8f85\u52a9"),l),h.ExhibitionItemType={eNone:0,eHeroBag:1,ePokedex:2,eHeroChange:4,eHeroReset:5,eFormFight:7,eVoyage:8,eExpeditFight:9,eStronger:10,eEndLessHero:11,eHeroSelect:12,eUpStar:13,eHeroFuse:14},h.RedPointType={eRPLevelUp:1,eRPEquip:2,eRPStar:3,eRPTalent:4,eRPHalidom_Unlock:5,eRPHalidom_Lvup:6,eRPHalidom_Step:7},h.EquipPosList=(_(r={},1,d.item_type.WEAPON),_(r,2,d.item_type.SHOE),_(r,3,d.item_type.CLOTHES),_(r,4,d.item_type.HAT),r),h.HolyequipmentPosList=(_(c={},1,d.item_type.GOD_EARRING),_(c,2,d.item_type.GOD_NECKLACE),_(c,3,d.item_type.GOD_RING),_(c,4,d.item_type.GOD_BANGLE),c),h.ShareType={eHeroInfoShare:1,eLibraryInfoShare:2},h.ShareBtnType={eHeroShareCross:1,eHeroShareWorld:2,eHeroShareGuild:3},h.SacrificeType={eHeroSacrifice:1,eChipSacrifice:2},h.ResetType={eHeroReset:1,eChipReset:2,eHolyEquipSell:3,eTenStarChang:4,eActionHeroReset:5},h.SelectHeroType={eStarFuse:1,eUpgradeStar:2,eHalidom:3,eTenConvert:4,eResonateStone:5,eResonateEmpowerment:6},e.exports=h,cc._RF.pop()},{backpack_const:"backpack_const"}],hero_controller:[function(t,e,i){"use strict";cc._RF.push(e,"622bbkiYFRIaKotw7dT7rwW","hero_controller");var s=t("hero_const"),n=t("hero_event"),a=t("partner_const"),o=t("hero_calculate"),l=t("backpack_const"),r=cc.Class({extends:BaseController,ctor:function(){},initConfig:function(){var e=t("hero_model");this.model=new e(this),this.model.initConfig()},getModel:function(){return this.model},registerEvents:function(){if(this.re_link_game_event=gcore.GlobalEvent.bind(EventId.EVT_RE_LINK_GAME,function(){}.bind(this)),this.login_event_success=gcore.GlobalEvent.bind(EventId.EVT_ROLE_CREATE_SUCCESS,function(){gcore.GlobalEvent.unbind(this.login_event_success),this.login_event_success=null,t("startower_controller").getInstance().sender11320();var e=t("role_controller").getInstance().getRoleVo();this.role_update_evt=e.bind(EventId.UPDATE_ROLE_ATTRIBUTE,function(t,e){"coin"==t?this.model.checkLevelRedPointUpdate():"hero_exp"==t?this.model.checkLevelRedPointUpdate():"lev"==t&&this.model.checkUnlockFormRedPoint(e)},this)}.bind(this)),this.add_goods_event||(this.add_goods_event=gcore.GlobalEvent.bind(EventId.ADD_GOODS,function(t,e){if(t==l.Bag_Code.EQUIPS)this.model.is_equip_redpoint_bag_update=!0,this.model.checkEquipRedPointUpdate();else for(var i in e){var s=e[i];s.base_id==this.model.upgrade_star_cost_id?(this.model.is_upgradestar_redpoint_bag_update=!0,this.model.checkUpgradeStarRedPointUpdate(),this.model.checkLevelRedPointUpdate()):s.base_id==this.model.talent_skill_cost_id&&(this.model.setUpdateTalentRedpoint(),this.model.checkTalentRedPointUpdate()),Utils.getItemConfig(s.base_id)&&(this.model.setUpdateTalentRedpoint(),this.model.checkTalentRedPointUpdate())}}.bind(this))),this.del_goods_event||(this.del_goods_event=gcore.GlobalEvent.bind(EventId.DELETE_GOODS,function(t,e){if(t==l.Bag_Code.EQUIPS)this.model.is_equip_redpoint_bag_update=!0,this.model.checkEquipRedPointUpdate();else for(var i in e){var s=e[i];s.base_id==this.model.upgrade_star_cost_id?(this.model.is_upgradestar_redpoint_bag_update=!0,this.model.checkUpgradeStarRedPointUpdate(),this.model.checkLevelRedPointUpdate()):s.base_id==this.model.talent_skill_cost_id&&(this.model.setUpdateTalentRedpoint(),this.model.checkTalentRedPointUpdate()),Utils.getItemConfig(s.base_id)&&(this.model.setUpdateTalentRedpoint(),this.model.checkTalentRedPointUpdate())}}.bind(this))),this.modify_goods_event||(this.modify_goods_event=gcore.GlobalEvent.bind(EventId.MODIFY_GOODS_NUM,function(t,e){if(t==l.Bag_Code.EQUIPS)this.model.is_equip_redpoint_bag_update=!0,this.model.checkEquipRedPointUpdate();else for(var i in e){var s=e[i];s.base_id==this.model.upgrade_star_cost_id?(this.model.is_upgradestar_redpoint_bag_update=!0,this.model.checkUpgradeStarRedPointUpdate(),this.model.checkLevelRedPointUpdate()):s.base_id==this.model.talent_skill_cost_id&&(this.model.setUpdateTalentRedpoint(),this.model.checkTalentRedPointUpdate()),Utils.getItemConfig(s.base_id)&&(this.model.setUpdateTalentRedpoint(),this.model.checkTalentRedPointUpdate())}}.bind(this))),!this.update_drama_hallows_event){var e=t("hallows_event");this.update_drama_hallows_event=gcore.GlobalEvent.bind(e.HallowsActivityEvent,function(){this.model.checkUnlockHallowsRedPoint()}.bind(this))}},registerProtocals:function(){this.RegisterProtocal(11e3,this.handle11000.bind(this)),this.RegisterProtocal(11001,this.handle11001.bind(this)),this.RegisterProtocal(11002,this.handle11002.bind(this)),this.RegisterProtocal(11007,this.handle11007.bind(this)),this.RegisterProtocal(11003,this.handle11003.bind(this)),this.RegisterProtocal(11004,this.handle11004.bind(this)),this.RegisterProtocal(11005,this.handle11005.bind(this)),this.RegisterProtocal(11006,this.handle11006.bind(this)),this.RegisterProtocal(11009,this.handle11009.bind(this)),this.RegisterProtocal(11016,this.handle11016.bind(this)),this.RegisterProtocal(11017,this.handle11017.bind(this)),this.RegisterProtocal(11010,this.handle11010.bind(this)),this.RegisterProtocal(11011,this.handle11011.bind(this)),this.RegisterProtocal(11012,this.handle11012.bind(this)),this.RegisterProtocal(11015,this.handle11015.bind(this)),this.RegisterProtocal(11211,this.handle11211.bind(this)),this.RegisterProtocal(11212,this.handle11212.bind(this)),this.RegisterProtocal(11213,this.handle11213.bind(this)),this.RegisterProtocal(11030,this.handle11030.bind(this)),this.RegisterProtocal(11031,this.handle11031.bind(this)),this.RegisterProtocal(11032,this.handle11032.bind(this)),this.RegisterProtocal(11033,this.handle11033.bind(this)),this.RegisterProtocal(11034,this.handle11034.bind(this)),this.RegisterProtocal(11035,this.handle11035.bind(this)),this.RegisterProtocal(11036,this.handle11036.bind(this)),this.RegisterProtocal(11037,this.handle11037.bind(this)),this.RegisterProtocal(11038,this.handle11038.bind(this)),this.RegisterProtocal(11040,this.handle11040.bind(this)),this.RegisterProtocal(11060,this.handle11060.bind(this)),this.RegisterProtocal(11075,this.handle11075.bind(this)),this.RegisterProtocal(11076,this.handle11076.bind(this)),this.RegisterProtocal(11096,this.handle11096.bind(this)),this.RegisterProtocal(11097,this.handle11097.bind(this)),this.RegisterProtocal(11098,this.handle11098.bind(this)),this.RegisterProtocal(11099,this.handle11099.bind(this)),this.RegisterProtocal(11063,this.handle11063.bind(this)),this.RegisterProtocal(11019,this.handle11019.bind(this)),this.RegisterProtocal(11020,this.handle11020.bind(this))},sender11063:function(t){var e={};e.partner_id=t,this.SendProtocal(11063,e)},handle11063:function(t){this.model.updateHeroVoDetailedInfo(t)},sender11000:function(){this.SendProtocal(11e3,{})},handle11000:function(t){this.model.setHeroMaxCount(t.num),this.model.setHeroBuyNum(t.buy_num),this.model.updateHeroList(t.partners);var e=o.getInstance();RedMgr.getInstance().addCalHandler(e.checkAllStarFuseRedpoint.bind(e),RedIds.RefuseHero),this.sender11020()},handle11001:function(t){this.model.updateHeroList(t.partners,!0),o.getInstance().clearAllStarFuseRedpointRecord(),this.model.is_upgradestar_redpoint_bag_update=!0,this.model.checkUpgradeStarRedPointUpdate()},handle11002:function(t){this.model.updateHeroVo(t)},handle11007:function(e){t("role_controller").getInstance().getRoleVo().showPower(!0),this.model.updateHeroList(e.ref_partners,null,!0)},sender11003:function(t){var e={};e.partner_id=t,this.SendProtocal(11003,e)},handle11003:function(t){t&&1===t.result&&gcore.GlobalEvent.getInstance().fire(n.Hero_Level_Up_Success_Event,t)},sender11004:function(t){var e={};e.partner_id=t,this.SendProtocal(11004,e)},handle11004:function(t){t&&t.result},sender11005:function(t,e,i){var s={};s.partner_id=t,s.expend1=e,s.expend2=i,this.SendProtocal(11005,s)},handle11005:function(t){message(t.msg),t&&1===t.result?gcore.GlobalEvent.fire(n.Upgrade_Star_Success_Event):this.model.setUpgradeStarUpdateRecord(!0)},handle11006:function(t){this.model.delHeroDataList(t.expend2)},sender11009:function(){this.SendProtocal(11009,{})},handle11009:function(t){t.result&&(this.model.setHeroMaxCount(t.num),this.model.setHeroBuyNum(t.buy_num),gcore.GlobalEvent.fire(n.Buy_Hero_Max_Count_Event))},sender11016:function(t){var e={};e.partner_id=t,this.SendProtocal(11016,e)},handle11016:function(t){gcore.GlobalEvent.fire(n.Next_Break_Info_Event,t)},handle11017:function(t){},sender11010:function(t,e){this.model.setEquipUpdateRecord(!1);var i={};i.partner_id=t,i.item_id=e,this.SendProtocal(11010,i)},handle11010:function(t){message(t.msg),t.result||this.model.setEquipUpdateRecord(!0)},sender11011:function(t,e){this.model.setEquipUpdateRecord(!1);var i={};i.partner_id=t,i.pos_id=e,this.SendProtocal(11011,i)},handle11011:function(t){message(t.msg),t.result||this.model.setEquipUpdateRecord(!0)},handle11012:function(t){message(t.msg),t&&(this.model.updateHeroEquipList(t),t=this.model.getHeroById(t.partner_id),gcore.GlobalEvent.fire(n.Equip_Update_Event,t),this.model.is_equip_redpoint_hero_update=!0,this.model.checkEquipRedPointUpdate())},sender11015:function(t,e){var i={};i.partner_id=t,i.type=e,this.SendProtocal(11015,i)},handle11015:function(t){1==t.result&&(this.model.setLockByPartnerid(t.partner_id,t.type),gcore.GlobalEvent.fire(n.Hero_Lock_Event))},sender11211:function(t){var e={};e.type=t,this.SendProtocal(11211,e)},handle11211:function(t){t&&"number"==typeof t.type&&(!t||t.type!==a.Fun_Form.Drama&&t.type!==a.Fun_Form.Arena||this.model.setFormList(t),gcore.GlobalEvent.fire(n.Update_Fun_Form,t))},sender11212:function(t,e,i,s){var n={};n.type=t,n.formation_type=e,n.pos_info=i,n.hallows_id=s,this.SendProtocal(11212,n)},handle11212:function(e){if(e.code){if(e.type===a.Fun_Form.Drama){var i=[],s={};s.type=a.Fun_Form.Drama,i.push(s);var o={};o.type=a.Fun_Form.Arena,i.push(o),this.sender11213(i)}else if(e.type===a.Fun_Form.Arena)this.sender11211(e.type);else if(e.type===a.Fun_Form.LimitExercise){t("limitexercise_controller").getInstance().checkJoinFight()}gcore.GlobalEvent.fire(n.Update_Save_Form,e)}else message(Utils.TI18N(e.msg))},sender11213:function(t){var e={};e.type_list=t,this.SendProtocal(11213,e)},handle11213:function(t){if(t&&t.info)for(var e in t.info){var i=t.info[e];!i||i.type!==a.Fun_Form.Drama&&i.type!==a.Fun_Form.Arena||this.model.setFormList(i)}},sender11030:function(t,e,i,s){this.model.setEquipUpdateRecord(!1);var n={};n.partner_id=t,n.pos_id=e,n.artifact_id=i,n.type=s,this.SendProtocal(11030,n)},handle11030:function(t){message(t.msg),0==t.result&&this.model.setEquipUpdateRecord(!0)},handle11031:function(t){message(t.msg||""),this.model.updatePartnerArtifactList(t)},sender11032:function(t,e,i){var s={};s.partner_id=t,s.artifact_id=e,s.expends=i,this.SendProtocal(11032,s)},handle11032:function(t){message(t.msg),1==t.result&&gcore.GlobalEvent.fire(n.Artifact_UpStar_Event,t)},sender11033:function(t,e,i){var s={};s.partner_id=t,s.artifact_id=e,s.skills=i,this.SendProtocal(11033,s)},handle11033:function(t){message(t.msg),1==t.result&&gcore.GlobalEvent.fire(n.Artifact_Recast_Event)},sender11034:function(t,e,i){var s={};s.partner_id=t,s.artifact_id=e,s.type=i,this.SendProtocal(11034,s)},handle11034:function(t){message(t.msg),1==t.result&&gcore.GlobalEvent.fire(n.Artifact_Save_Event)},sender11035:function(t){var e={};e.artifact_id=t,this.SendProtocal(11035,e)},handle11035:function(t){message(t.msg)},sender11036:function(t,e){var i={};i.item_id=t,i.expends=e,this.SendProtocal(11036,i)},handle11036:function(t){message(t.msg),1==t.result&&gcore.GlobalEvent.fire(n.Artifact_Compound_Event,t.flag)},sender11037:function(){this.SendProtocal(11037,{})},handle11037:function(t){t&&null!=t.lucky&&(this.model.setArtifactLucky(t.lucky),gcore.GlobalEvent.fire(n.Artifact_Lucky_Event))},sender11038:function(){this.SendProtocal(11038,{})},handle11038:function(t){message(t.msg)},sender11040:function(){this.SendProtocal(11040,{})},handle11040:function(t){this.model.setHadHeroInfo(t.partners)},sender11060:function(t,e){var i={};i.channel=t,i.partner_id=e,this.SendProtocal(11060,i)},handle11060:function(t){message(t.msg)},sender11075:function(t){var e={};e.list=t,this.SendProtocal(11075,e)},handle11075:function(t){1==t.code&&gcore.GlobalEvent.fire(n.Hero_Reset_Look_Event,t.list)},sender11076:function(t){var e={};e.list=t,this.SendProtocal(11076,e)},handle11076:function(t){message(t.msg),t.code&&this.model.delHeroDataList(t.list)},sender11096:function(t,e,i){var s={};s.partner_id=t,s.pos=e,s.skill_id=i,this.SendProtocal(11096,s)},handle11096:function(t){1==t.result?(this.model.updateHeroVoTalent([t],!0),t=this.model.getHeroById(t.partner_id),gcore.GlobalEvent.fire(n.Hero_Learn_Talent_Event,t),o.getInstance().clearAllHeroRecordByRedPointType(s.RedPointType.eRPTalent)):message(t.msg)},openHeroBagWindow:function(e,i){if(e){if(!this.hero_bag_window){var s=t("hero_bag_window");this.hero_bag_window=new s(this)}this.hero_bag_window.open(i)}else this.hero_bag_window&&(this.hero_bag_window.close(),this.hero_bag_window=null)},openHeroLibraryMainWindow:function(e,i){if(0==e)null!=this.hero_library_mainWindow&&(this.hero_library_mainWindow.close(),this.hero_library_mainWindow=null);else{if(null==this.hero_library_mainWindow){var s=t("hero_library_main_window");this.hero_library_mainWindow=new s}this.hero_library_mainWindow.open(i)}},openHeroSMRoomMainWindow:function(e,i){if(0==e)null!=this.hero_smroom_mainWindow&&(this.hero_smroom_mainWindow.close(),this.hero_smroom_mainWindow=null);else{if(null==this.hero_smroom_mainWindow){var s=t("hero_smroom_main_window");this.hero_smroom_mainWindow=new s}this.hero_smroom_mainWindow.open(i)}},openHeroLibraryInfoWindow:function(e,i){if(0==e)null!=this.hero_library_info&&(this.hero_library_info.close(),this.hero_library_info=null);else{if(null==this.hero_library_info){var s=t("hero_library_info_window");this.hero_library_info=new s}this.hero_library_info.open(i)}},openHeroSMRoomInfoWindow:function(e,i){if(0==e)null!=this.hero_smroom_info&&(this.hero_smroom_info.close(),this.hero_smroom_info=null);else{if(null==this.hero_smroom_info){var s=t("hero_smroom_info_window");this.hero_smroom_info=new s}this.hero_smroom_info.open(i)}},openHeroLibraryStoryPanel:function(e,i,s){if(0==e)null!=this.hero_library_story&&(this.hero_library_story.close(),this.hero_library_story=null);else{if(null==this.hero_library_story){var n=t("hero_library_story_window");this.hero_library_story=new n}this.hero_library_story.open({name:i,content:s})}},openHeroMainInfoWindow:function(e,i,s,n){if(e){if(!this.hero_main_info_window){var a=t("hero_main_info_window");this.hero_main_info_window=new a(this)}var o={};o.hero_vo=i,o.hero_list=s,o.setting=n,this.hero_main_info_window.open(o)}else this.hero_main_info_window&&(this.hero_main_info_window.close(),this.hero_main_info_window=null)},openHeroLookDrawWindow:function(t,e,i,s,n){if(t){this.hero_look_draw_window||(this.hero_look_draw_window=Utils.createClass("hero_look_draw_window"));var a={draw_res_id:e,name:i,bid:s,share_type:n};this.hero_look_draw_window.open(a)}else this.hero_look_draw_window&&(this.hero_look_draw_window.close(),this.hero_look_draw_window=null)},openHeroBreakPanel:function(e,i){if(e){if(!this.hero_break_panel){var s=t("hero_break_window");this.hero_break_panel=new s(this)}this.hero_break_panel.open(i)}else this.hero_break_panel&&(this.hero_break_panel.close(),this.hero_break_panel=null)},openBreakExhibitionWindow:function(e,i,s){if(e){if(!this.break_exhibition_window){var n=t("hero_break_exhibition_window");this.break_exhibition_window=new n(this)}if(this.break_exhibition_window&&!this.break_exhibition_window.isOpen()){var a={};a.old_vo=i,a.new_vo=s,this.break_exhibition_window.open(a)}}else if(this.break_exhibition_window&&(this.break_exhibition_window.close(),this.break_exhibition_window=null),i&&"number"==typeof i){var o=i;this.openSkillUnlockWindow(!0,o)}},openHeroUpgradeStarExhibitionPanel:function(e,i,s){if(e){if(!this.upgrade_star_exhibition_window){var n=t("hero_upgrade_star_exhibition_window");this.upgrade_star_exhibition_window=new n(this)}if(this.upgrade_star_exhibition_window&&!this.upgrade_star_exhibition_window.isOpen()){var a={};a.old_vo=i,a.new_vo=s,this.upgrade_star_exhibition_window.open(a)}}else this.upgrade_star_exhibition_window&&(this.upgrade_star_exhibition_window.close(),this.upgrade_star_exhibition_window=null)},openFormGoFightPanel:function(e,i,s,n){if(e){if(!this.form_go_fight_panel){var a=t("form_go_fight_window");this.form_go_fight_panel=new a(this)}var o={};o.fun_form_type=i,o.setting=s,o.show_type=n,this.form_go_fight_panel.open(o)}else this.form_go_fight_panel&&(this.form_go_fight_panel.close(),this.form_go_fight_panel=null)},openFormMainWindow:function(t,e){this.openFormGoFightPanel(t,e,{},s.FormShowType.eFormSave)},openFormationSelectPanel:function(e,i,s){if(e){if(!this.formation_select_panel){var n=t("form_select_panel");this.formation_select_panel=new n(this)}var a={};a.formation_type=i,a.callback=s,this.formation_select_panel.open(a)}else this.formation_select_panel&&(this.formation_select_panel.close(),this.formation_select_panel=null)},openFormHallowsSelectPanel:function(e,i,s){if(e){if(!this.form_hallows_select_panel){var n=t("form_hallows_select_window");this.form_hallows_select_panel=new n(this)}var a={};a.hallows_id=i,a.callback=s,this.form_hallows_select_panel.open(a)}else this.form_hallows_select_panel&&(this.form_hallows_select_panel.close(),this.form_hallows_select_panel=null)},openHeroUpgradeStarFuseWindow:function(e,i){if(e){if(!this.upgrade_star_fuse_window||!this.upgrade_star_fuse_window.root_wnd){var s=t("hero_upgrade_star_fuse_window");this.upgrade_star_fuse_window=new s(this)}this.upgrade_star_fuse_window&&!this.upgrade_star_fuse_window.isOpen()&&this.upgrade_star_fuse_window.open(i)}else this.upgrade_star_fuse_window&&(this.upgrade_star_fuse_window.close(),this.upgrade_star_fuse_window=null)},openHeroUpgradeStarSelectPanel:function(e,i,s,n,a,o,l){if(e){if(!this.upgrade_star_select_panel){var r=t("hero_upgrade_star_select_window");this.upgrade_star_select_panel=new r(this)}var c={};c.select_data=i,c.dic_other_selected=s,c.form_type=n,c.select_cb=o,c.cur_hero_vo=l,c.is_master=a,this.upgrade_star_select_panel.open(c)}else this.upgrade_star_select_panel&&(this.upgrade_star_select_panel.close(),this.upgrade_star_select_panel=null)},openHeroResetWindow:function(e,i){if(e){if(!this.hero_reset_window){var s=t("hero_reset_window");this.hero_reset_window=new s(this)}this.hero_reset_window&&this.hero_reset_window.open(i)}else this.hero_reset_window&&(this.hero_reset_window.close(),this.hero_reset_window=null)},openHeroResetReturnPanel:function(e,i){if(e){if(!this.hero_reset_return_panel){var s=t("hero_rest_return_window");this.hero_reset_return_panel=new s(this)}var n={};n.item_list=i,this.hero_reset_return_panel.open(n)}else this.hero_reset_return_panel&&(this.hero_reset_return_panel.close(),this.hero_reset_return_panel=null)},openHeroResetOfferPanel:function(e,i,s,n,a,o){if(e){if(!this.hero_reset_offer_panel){var l=t("hero_reset_offer_window");this.hero_reset_offer_panel=new l(this)}var r={};r.item_list=i,r.callback=n,r.is_show_tips=s,r.reset_type=a,r.dec=o,this.hero_reset_offer_panel.open(r)}else this.hero_reset_offer_panel&&(this.hero_reset_offer_panel.close(),this.hero_reset_offer_panel=null)},openEquipPanel:function(e,i,s,n){if(e){if(!this.equip_panel){var a=t("equip_cloth_window");this.equip_panel=new a(this)}var o={};o.equip_type=i,o.partner_id=s,o.data=n,this.equip_panel.open(o)}else this.equip_panel&&(this.equip_panel.close(),this.equip_panel=null)},openEquipTips:function(e,i,s,n){e&&t("tips_controller").getInstance().showEquipTips(i,s,n)},openArtifactRecastWindow:function(t,e,i){1==t?(this.artifact_recast_win||(this.artifact_recast_win=Utils.createClass("artifact_recast_window")),this.artifact_recast_win.open({data:e,partner_id:i})):this.artifact_recast_win&&(this.artifact_recast_win.close(),this.artifact_recast_win=null)},openArtifactListWindow:function(t,e,i,s){if(1==t){this.artifact_list_window||(this.artifact_list_window=Utils.createClass("artifact_list_window")),e=e||0,i=i||0;var n={};n.artifact_type=e,n.partner_id=i,n.select_vo=s,this.artifact_list_window.open(n)}else this.artifact_list_window&&(this.artifact_list_window.close(),this.artifact_list_window=null)},openArtifactChoseWindow:function(t,e){1==t?(this.artifact_chose_window||(this.artifact_chose_window=Utils.createClass("artifact_chose_window")),this.artifact_chose_window.open(e)):this.artifact_chose_window&&(this.artifact_chose_window.close(),this.artifact_chose_window=null)},openArtifactTipsWindow:function(t,e,i,s,n){if(1==t){if(null==e||null==e.config)return void message(Utils.TI18N("\u6570\u636e\u5f02\u5e38"));this.artifact_tips_window||(this.artifact_tips_window=Utils.createClass("artifact_tips_window")),null==i&&(i=a.ArtifactTips.backpack);var o={data:e,open_type:i,partner_id:s,pos:n};this.artifact_tips_window.open(o)}else this.artifact_tips_window&&(this.artifact_tips_window.close(),this.artifact_tips_window=null)},openArtifactComTipsWindow:function(t,e){1==t?(this.artifact_com_win||(this.artifact_com_win=Utils.createClass("artifact_com_tips_window")),this.artifact_com_win.open(e)):this.artifact_com_win&&(this.artifact_com_win.close(),this.artifact_com_win=null)},openArtifactAwardWindow:function(t){1==t?(this.artifact_award_win||(this.artifact_award_win=Utils.createClass("artifact_award_window")),this.artifact_award_win.open()):this.artifact_award_win&&(this.artifact_award_win.close(),this.artifact_award_win=null)},openArtifactSkillWindow:function(t,e){1==t?(this.artifact_skill_win||(this.artifact_skill_win=Utils.createClass("artifact_skill_window",e)),this.artifact_skill_win.open()):this.artifact_skill_win&&(this.artifact_skill_win.close(),this.artifact_skill_win=null)},openHeroTipsPanel:function(e,i,s){if(1==e){if(!this.hero_tips_window){var n=t("hero_tips_window");this.hero_tips_window=new n}0==this.hero_tips_window.isOpen()&&this.hero_tips_window.open({hero_vo:i,is_hide_equip:s})}else this.hero_tips_window&&(this.hero_tips_window.close(),this.hero_tips_window=null)},openHeroTipsAttrPanel:function(e,i,s){if(1==e){if(!this.hero_tips_attr_panel){var n=t("hero_tips_attr_window");this.hero_tips_attr_panel=new n}this.hero_tips_attr_panel.open({hero_vo:i,is_my:s})}else this.hero_tips_attr_panel&&(this.hero_tips_attr_panel.close(),this.hero_tips_attr_panel=null)},openHeroTipsPanelByBid:function(t){var e=this.model.getMockHeroVoByBid(t);e&&this.openHeroTipsPanel(!0,e,!0)},openHeroInfoWindowByBidStar:function(t,e,i){if(null!=t&&null!=e){var n=Utils.getNorKey(t,e),a=this.model.getHeroPokedexByBid(n);a&&this.openHeroMainInfoWindow(!0,a,[a],{show_model_type:s.BagTab.eBagPokedex,callback:i})}},openHeroSMRoomInfoWindowByBidStar:function(t,e,i){if(null!=t&&null!=e){var n=Utils.getNorKey(t,e),a=this.model.getHeroPokedexByBid(n);a&&this.openHeroSMRoomInfoWindow(!0,a,[a],{show_model_type:s.BagTab.eBagPokedex,callback:i})}},getHeroGoFightRoot:function(t){if(t)this.form_go_fight_panel?this.form_go_fight_panel.getRootWnd(t):t(null);else if(this.form_go_fight_panel)return this.form_go_fight_panel.root_wnd},getHeroBagRoot:function(t){if(t)this.hero_bag_window?this.hero_bag_window.getRootWnd(t):t(null);else if(this.hero_bag_window)return this.hero_bag_window.root_wnd},getHeroMianInfoRoot:function(t){if(t)this.hero_main_info_window?this.hero_main_info_window.getRootWnd(t):t(null);else if(this.hero_main_info_window)return this.hero_main_info_window.root_wnd},sender11099:function(t){var e={};e.partner_ids=t,this.SendProtocal(11099,e)},handle11099:function(t){this.model.updateHeroVoTalent(t.partner_ids),gcore.GlobalEvent.fire(n.Hero_Get_Talent_Event,t.partner_ids)},sender11097:function(t,e){var i={};i.partner_id=t,i.pos=e,this.SendProtocal(11097,i)},handle11097:function(t){1==t.result?(this.model.updateHeroVoTalent([t],!0),t=this.model.getHeroById(t.partner_id),gcore.GlobalEvent.fire(n.Hero_Level_Up_Talent_Event,t),o.getInstance().clearAllHeroRecordByRedPointType(s.RedPointType.eRPTalent)):message(t.msg)},sender11098:function(t,e){var i={};i.partner_id=t,i.pos=e,this.SendProtocal(11098,i)},handle11098:function(t){1==t.result?(this.model.updateHeroVoTalent([t],!0),t=this.model.getHeroById(t.partner_id),gcore.GlobalEvent.fire(n.Hero_Forget_Talent_Event,t),o.getInstance().clearAllHeroRecordByRedPointType(s.RedPointType.eRPTalent)):message(t.msg)},openHeroTalentSkillLearnPanel:function(e,i,s){if(1==e){if(!this.hero_talent_skill_panel){var n=t("hero_talent_skill_learn_window");this.hero_talent_skill_panel=new n}this.hero_talent_skill_panel.open({hero_vo:i,pos:s})}else this.hero_talent_skill_panel&&(this.hero_talent_skill_panel.close(),this.hero_talent_skill_panel=null)},openHeroTalentSkillLevelUpPanel:function(e,i,s,n){if(1==e){if(!this.hero_talent_levelup_panel){var a=t("hero_talent_skill_level_up_window");this.hero_talent_levelup_panel=new a}this.hero_talent_levelup_panel.open({hero_vo:i,skill_id:s,pos:n})}else this.hero_talent_levelup_panel&&(this.hero_talent_levelup_panel.close(),this.hero_talent_levelup_panel=null)},openSkillUnlockWindow:function(e,i){if(1==e){if(null==this.unlock_window){var s=t("skill_unlock_window");this.unlock_window=new s(i)}this.unlock_window&&0==this.unlock_window.isOpen()&&this.unlock_window.open()}else this.unlock_window&&(this.unlock_window.close(),this.unlock_window=null)},onPlayHeroVoice:function(t,e){if(e=e||4,e+=1,null==this.voice_time_ticket){var i=gcore.SysEnv.get("music_volume");i-=.6,SoundManager.getInstance().setBackgroundVolume(i)}else gcore.Timer.del(this.voice_time_ticket),this.voice_time_ticket=null;null!=this.hero_music&&("undef"==this.hero_music?SoundManager.getInstance().removeEffectSound(null):SoundManager.getInstance().removeEffectSound(this.hero_music)),this.hero_music=SoundManager.getInstance().playHeroEffectOnce(AUDIO_TYPE.DUBBING,t),void 0==this.hero_music&&(this.hero_music="undef"),this.voice_time_ticket=gcore.Timer.set(function(){var t=gcore.SysEnv.get("music_volume");SoundManager.getInstance().setBackgroundVolume(t),this.voice_time_ticket=null}.bind(this),1e3*e,1)},openHeroSkinTipsPanel:function(e,i,s,n){if(1==e){if(!this.hero_skin_tips_panel){var a=t("hero_skin_tips_window");this.hero_skin_tips_panel=new a(this)}this.hero_skin_tips_panel.open({data:i,open_type:s,partner:n})}else this.hero_skin_tips_panel&&(this.hero_skin_tips_panel.close(),this.hero_skin_tips_panel=null)},sender11019:function(t,e){var i={};i.partner_id=t,i.skin_id=e,this.SendProtocal(11019,i)},handle11019:function(t){message(t.msg),cc.log("11019",t),1==t.result&&message(Utils.TI18N("\u66f4\u6362\u6210\u529f"))},sender11020:function(){this.SendProtocal(11020,{})},handle11020:function(t){cc.log("11020",t),this.model.initHeroSkin(t)},openHeroSkinWindow:function(t,e){1==t?(this.hero_skin_window||(this.hero_skin_window=Utils.createClass("hero_skin_window")),this.hero_skin_window.open(e)):this.hero_skin_window&&(this.hero_skin_window.close(),this.hero_skin_window=null)}});e.exports=r,cc._RF.pop()},{backpack_const:"backpack_const",equip_cloth_window:"equip_cloth_window",form_go_fight_window:"form_go_fight_window",form_hallows_select_window:"form_hallows_select_window",form_select_panel:"form_select_panel",hallows_event:"hallows_event",hero_bag_window:"hero_bag_window",hero_break_exhibition_window:"hero_break_exhibition_window",hero_break_window:"hero_break_window",hero_calculate:"hero_calculate",hero_const:"hero_const",hero_event:"hero_event",hero_library_info_window:"hero_library_info_window",hero_library_main_window:"hero_library_main_window",hero_library_story_window:"hero_library_story_window",hero_main_info_window:"hero_main_info_window",hero_model:"hero_model",hero_reset_offer_window:"hero_reset_offer_window",hero_reset_window:"hero_reset_window",hero_rest_return_window:"hero_rest_return_window",hero_skin_tips_window:"hero_skin_tips_window",hero_smroom_info_window:"hero_smroom_info_window",hero_smroom_main_window:"hero_smroom_main_window",hero_talent_skill_learn_window:"hero_talent_skill_learn_window",hero_talent_skill_level_up_window:"hero_talent_skill_level_up_window",hero_tips_attr_window:"hero_tips_attr_window",hero_tips_window:"hero_tips_window",hero_upgrade_star_exhibition_window:"hero_upgrade_star_exhibition_window",hero_upgrade_star_fuse_window:"hero_upgrade_star_fuse_window",hero_upgrade_star_select_window:"hero_upgrade_star_select_window",limitexercise_controller:"limitexercise_controller",partner_const:"partner_const",role_controller:"role_controller",skill_unlock_window:"skill_unlock_window",startower_controller:"startower_controller",tips_controller:"tips_controller"}],hero_event:[function(t,e,i){"use strict";cc._RF.push(e,"dee2biX5/lFuanHQXx283Z/","hero_event");var s={Hero_Data_Update:"HeroEvent.Hero_Data_Update",Hero_Data_Add:"HeroEvent.Hero_Data_Add",Del_Hero_Event:"HeroEvent.Del_Hero_Event",Hero_Level_Up_Success_Event:"HeroEvent.Hero_Level_Up_Success_Event",Hero_Can_Play_Level_UP_Music_Event:"HeroEvent.Hero_Can_Play_Level_UP_Music_Event",Equip_Update_Event:"HeroEvent.Equip_Update_Event",All_Hero_RedPoint_Event:"HeroEvent.All_Hero_RedPoint_Event",Equip_RedPoint_Event:"HeroEvent.Equip_RedPoint_Event",Level_RedPoint_Event:"HeroEvent.Level_RedPoint_Event",UpgradeStar_RedPoint_Event:"HeroEvent.UpgradeStar_RedPoint_Event",Form_RedPoint_Event:"HeroEvent.Form_RedPoint_Event",Next_Break_Info_Event:"HeroEvent.Next_Break_Info_Event",Buy_Hero_Max_Count_Event:"HeroEvent.Buy_Hero_Max_Count_Event",Hero_Lock_Event:"HeroEvent.Hero_Lock_Event",Hero_Disband_Event:"HeroEvent.Hero_Disband_Event",Hero_Reset_Look_Event:"HeroEvent.Hero_Reset_Look_Event",Form_List_Event:"HeroEvent.Form_List_Event",Form_Pos_Update:"HeroEvent.Form_Pos_Update",Use_Form_Success:"HeroEvent.Use_Form_Success",Form_Level_Event:"HeroEvent.Form_Level_Event",Update_Fun_Form:"HeroEvent.Update_Fun_Form",Update_Save_Form:"HeroEvent.Update_Save_Form",Form_Drama_Event:"HeroEvent.Form_Drama_Event",Filter_Hero_Update:"HeroEvent.Filter_Hero_Update",Upgrade_Star_Select_Event:"HeroEvent.Upgrade_Star_Select_Event",Upgrade_Star_Success_Event:"HeroEvent.Upgrade_Star_Success_Event",Artifact_Update_Event:"HeroEvent.Artifact_Update_Event",Artifact_UpStar_Event:"HeroEvent.Artifact_UpStar_Event",Artifact_Recast_Event:"HeroEvent.Artifact_Recast_Event",Artifact_Save_Event:"HeroEvent.Artifact_Save_Event",Artifact_Select_Event:"HeroEvent.Artifact_Select_Event",Artifact_Lucky_Event:"HeroEvent.Artifact_Lucky_Event",Artifact_Compound_Event:"HeroEvent.Artifact_Compound_Event",Artifact_Lucky_Red_Event:"HeroEvent.Artifact_Lucky_Red_Event",Artifact_Chose_Event:"HeroEvent.Artifact_Chose_Event",Hero_Get_Talent_Event:"HeroEvent.Hero_Get_Talent_Event",Hero_Learn_Talent_Event:"HeroEvent.Hero_Learn_Talent_Event",Hero_Level_Up_Talent_Event:"HeroEvent.Hero_Level_Up_Talent_Event",Hero_Forget_Talent_Event:"HeroEvent.Hero_Forget_Talent_Event",Hero_Vo_Detailed_info:"HeroEvent.Hero_Vo_Detailed_info",Hero_Skin_Info_Event:"Hero_Skin_Info_Event"};e.exports=s,cc._RF.pop()},{}],hero_exhibition_item:[function(t,e,i){"use strict";cc._RF.push(e,"88431Z3SJVGCqdRuthx3n7Z","hero_exhibition_item");var s=t("pathtool"),n=t("hero_const"),a=t("hero_calculate");cc.Class({extends:BasePanel,ctor:function(){this.rleasePrefab=!1,this.prefabPath=s.getPrefabPath("hero","hero_exhibition_item");var e=t("hero_controller");this.ctrl=e.getInstance(),this.model=this.ctrl.getModel(),this.isCache=!0},initConfig:function(){this.scale=1,this.data=null,this.id=null,this.is_allow_select=!0,this.is_ui_select=!1,this.percent=null,this.percent_lab=null,this.str_tips_obj=null,this.effect=!0},initPanel:function(){this.cur_pos&&(this.setPosition(this.cur_pos.x,this.cur_pos.y),this.cur_pos=null),this.scale&&(this.root_wnd.scale=this.scale),this.star_item_nd=this.seekChild("star_item"),this.stars_container_nd=this.seekChild("stars_container"),this.head_icon_nd=this.seekChild("head_icon"),this.head_icon_sp=this.seekChild("head_icon",cc.Sprite),this.comp_type_nd=this.seekChild("comp_type"),this.comp_type_sp=this.seekChild("comp_type",cc.Sprite),this.background_sp=this.seekChild("background",cc.Sprite),this.level_lb=this.seekChild("level",cc.Label),this.fight_nd=this.seekChild("fight"),this.select_item_nd=this.seekChild("select_item"),this.lock_item_nd=this.seekChild("lock_item"),this.lock_item_sp=this.seekChild("lock_item",cc.Sprite),this.red_icon_nd=this.seekChild("red_icon"),this.chip_icon_nd=this.seekChild("chip_icon"),this.special_nd=this.seekChild("special"),this.special_sp=this.seekChild("special",cc.Sprite),this.comp_type_sp.spriteFrame=null,this.level_lb.string="",this.red_icon_nd.active=this.red_status||!1,this.data?this.setData(this.data):null!=this.id&&this.setUnitData(this.id)},registerEvent:function(){},onShow:function(t){this.root_wnd&&!this.click_event&&(this.root_wnd.on(cc.Node.EventType.TOUCH_END,this.onClickRootWnd,this),this.root_wnd.on(cc.Node.EventType.TOUCH_START,this.onClickRootWnd,this),this.root_wnd.on(cc.Node.EventType.TOUCH_CANCEL,this.onClickRootWnd,this),this.click_event=!0)},onHide:function(){},onDelete:function(){this.unBindEvent(),this.head_icon_sp&&(this.head_icon_sp.spriteFrame=null),this.root_wnd&&this.click_event&&(this.root_wnd.off(cc.Node.EventType.TOUCH_END,this.onClickRootWnd,this),this.root_wnd.off(cc.Node.EventType.TOUCH_START,this.onClickRootWnd,this),this.root_wnd.off(cc.Node.EventType.TOUCH_CANCEL,this.onClickRootWnd,this),this.click_event=!1),ItemsPool.getInstance().cacheItem(this)},addCallBack:function(t){this.click_cb=t},addTouchCb:function(t){this.touch_cb=t},onClickRootWnd:function(t){var e=!0;this.from_type==n.ExhibitionItemType.eFormFight&&(this.data||(e=!1)),t.type===cc.Node.EventType.TOUCH_START&&(this.effect&&(this.root_wnd.scale=.9*(this.scale||1)),this.touch_cb&&e&&this.touch_cb(this)),t.type===cc.Node.EventType.TOUCH_CANCEL&&this.effect&&(this.root_wnd.scale=this.scale||1),t.type===cc.Node.EventType.TOUCH_END&&(this.effect&&(this.root_wnd.scale=this.scale||1),this.click_cb&&e&&(Utils.playButtonSound(3),this.click_cb(this)))},setButtonEffect:function(t){this.effect=t},setExtendData:function(t){t&&(this.scale=t.scale||1,this.can_click=t.can_click||!1,this.from_type=t.from_type||n.ExhibitionItemType.eNone,this.boold_type=t.boold_type||null,this.click_delay=t.click_delay||0,this.hide_star=t.hide_star||!1)},setUnitData:function(t){if(this.id=t,this.root_wnd){t=t||0;var e=Utils.getUnitConfig(t);if(null==e){this.head_icon_nd.active=!1,this.stars_container_nd.active=!1,this.level_lb.string="";var i=s.getItemQualityBG(0),n=s.getCommonIcomPath(i);this.loadRes(n,function(t){this.background_sp.spriteFrame=t}.bind(this)),this.comp_type_nd&&(this.comp_type_nd.active=!1)}else{this.head_icon_nd.active=!0,this.stars_container_nd.active=!0;var a=e.monster3;if(a){var o=Utils.getUnitConfig(a);if(o){var l=s.getHeadRes(o.head_icon);this.loadRes(l,function(t){this.head_icon_sp.spriteFrame=t}.bind(this));i=s.getItemQualityBG(o.star),n=s.getCommonIcomPath(i);this.loadRes(n,function(t){this.background_sp.spriteFrame=t}.bind(this));var r=s.getHeroCampRes(o.camp_type);n=s.getUIIconPath("common",r);this.loadRes(n,function(t){this.comp_type_sp.spriteFrame=t}.bind(this)),this.updateStars(o.star),this.level_lb.string=o.lev.toString()}}}}},setHeadImg:function(t){var e=s.getHeadRes(t);this.loadRes(e,function(t){this.head_icon_sp.spriteFrame=t}.bind(this))},setQualityImg:function(t){var e=s.getItemQualityBG(t),i=s.getCommonIcomPath(e);this.loadRes(i,function(t){this.background_sp.spriteFrame=t}.bind(this))},setCampImg:function(t){var e=s.getHeroCampRes(t),i=s.getUIIconPath("common",e);this.loadRes(i,function(t){this.comp_type_sp.spriteFrame=t}.bind(this))},setLev:function(t){this.level_lb.string=t.toString()},init:function(){this.setRootScale(1),this.cur_pos=null,this.setPosition(0,0),this.setData(null),this.setExtendData({}),this.record_res_id=null,this.showChipIcon(!1),this.showRedPoint(!1),this.bgImg&&(this.bgImg.node.active=!1),this.barNode&&(this.barNode.active=!1),this.lock_icon&&(this.lock_icon.node.active=!1),this.showLockIcon(!1),this.setSelected(!1),this.hireHero&&(this.hireHero.node.active=!1),this.showStrTips(!1),this.showHelpImg(!1),this.fight_nd&&(this.fight_nd.active=!1),this.str_tips_obj=null,this.cur_visible=!1,this.id=null,this.is_allow_select=!0,this.is_ui_select=!1,this.percent=null,this.percent_lab=null,this.effect=!0,this.addCallBack(null),this.addTouchCb(null),this.special_nd&&(this.special_nd.active=!1),this.root_wnd_cb&&(this.root_wnd_cb=null),this.head_icon_nd&&(this.head_icon_nd.active=!0),this.root_wnd&&Utils.setChildUnEnabled(this.root_wnd,!1)},setData:function(t){if(this.data&&this.item_update_event&&(this.data.unbind(this.item_update_event),this.item_update_event=null),this.data=t,this.root_wnd){if(t)this.head_icon_nd.active=!0,this.stars_container_nd.active=!0;else{this.head_icon_nd.active=!1,this.head_icon_sp.spriteFrame=null,this.stars_container_nd.active=!1,this.level_lb.string="",this.comp_type_sp.spriteFrame=null;var e=this.record_res_id=s.getItemQualityBG(0),i=s.getCommonIcomPath(e);this.loadRes(i,function(t){this.background_sp.spriteFrame=t}.bind(this)),this.special_nd.active&&(this.special_nd.active=!1)}this.setRootScale(this.scale),this.updateWidget(t)}this.data&&this.data.UPDATE_PARTNER_ATTR&&this.addVoBindEvent()},updateWidget:function(e){if(e){var i=e;if("number"==typeof e){if(!(i=Config.partner_data.data_partner_base[i]))return}else e.data&&(i=e.data);if(i&&void 0!==i.bid){var o=i.star||i.init_star;this.root_wnd.name="hero_"+i.bid,this.record_head_id=null;var l=null;if(0===i.bid)this.default_path?l=this.default_path:i.icon&&(l=s.getIconPath("item",i.icon));else{var r=this.findUseSkin(e);if(null!=r&&0!=r){var c=Config.partner_skin_data.data_skin_info[r];c&&(l=s.getHeadRes(c.head_id))}else{var _=i.bid+"_"+o,h=gdata("partner_data","data_partner_star",_);if(h){var d=h.head_id;this.record_head_id&&this.record_head_id===d||(this.record_head_id=d,l=s.getHeadRes(this.record_head_id))}}}l&&this.loadRes(l,function(t){this.root_wnd&&this.root_wnd.isValid&&(this.head_icon_sp.spriteFrame=t)}.bind(this));var u,m=s.getItemQualityBG(o-1);if(!this.record_res_id||this.record_res_id!=m){this.record_res_id=m;var f=s.getCommonIcomPath(m);this.loadRes(f,function(t){this.root_wnd&&this.root_wnd.isValid&&(this.background_sp.spriteFrame=t)}.bind(this))}var p=Config.partner_data.data_partner_base[i.bid];if(p&&(u=p.camp_type),0==i.bid&&i.camp_type&&(u=i.camp_type),0===u)this.comp_type_nd.active=!1;else if(u&&this.comp_type_nd){this.comp_type_nd.active=!0;var g=s.getHeroCampRes(u);f=s.getUIIconPath("common",g);this.loadRes(f,function(t){this.root_wnd&&this.root_wnd.isValid&&(this.comp_type_sp.spriteFrame=t)}.bind(this))}if(null!=this.chip_status&&this.showChipIcon(this.chip_status),this.hide_star?this.stars_container_nd.active=!1:(this.stars_container_nd.active=!0,this.updateStars(i.star)),i.lev?this.level_lb.string=i.lev:this.level_lb.string="",this.setHeadUnEnabled(!0),null!=this.red_status?this.showRedPoint(this.red_status):this.showRedPoint(!1),this.fight_nd.active=!1,this.bgImg&&(this.bgImg.node.active=!1),this.barNode&&(this.barNode.active=!1),this.lock_icon&&(this.lock_icon.node.active=!1),this.from_type==n.ExhibitionItemType.eHeroBag){if(this.setSelected(!1),this.showRedPoint(!1),a.getInstance().isCheckHeroRedPointByHeroVo(i)){var v=a.getInstance().checkSingleHeroRedPoint(i);this.showRedPoint(v)}this.fight_nd.active=this.data.isFormDrama()}else if(this.from_type==n.ExhibitionItemType.eHeroChange)this.lock_icon&&(this.lock_icon.node.destroy(),this.lock_icon=null),this.lock_label&&(this.lock_label.node.destroy(),this.lock_label=null),this.showLockIcon(i.is_locked||!1,i.lock_str),this.setSelected(1==i.is_ui_select);else if(this.from_type==n.ExhibitionItemType.ePokedex){this.showRedPoint(!1);var b=this.model.getHadHeroStarBybid(i.bid);(!b||b<i.star)&&this.setHeadUnEnabled(!1)}else if(this.from_type==n.ExhibitionItemType.eFormFight)this.setSelected(i.is_ui_select);else if(this.from_type==n.ExhibitionItemType.eHeroSelect)this.setSelected(i.is_ui_select),this.showLockIcon(i.is_ui_lock);else if(this.from_type==n.ExhibitionItemType.eUpStar)this.setGrayHead(i.head_gray);else if(this.from_type==n.ExhibitionItemType.eHeroReset)i.is_ui_lock||this.setSelected(i.is_ui_select),this.showLockIcon(i.is_ui_lock);else if(this.from_type==n.ExhibitionItemType.eExpeditFight){var w=100;if(1==this.boold_type){var y=t("heroexpedit_controller"),C=i.partner_id;i.partner_id>1e5&&(C=i.partner_id-1e5),w=y.getInstance().getModel().getHeroBloodById(C,i.rid,i.srv_id);1==y.getInstance().getModel().getHireHero(C,i.rid,i.srv_id)&&null!=i.is_used?(this.hireHero?this.hireHero.node.active=!0:this.hireHero=Utils.createImage(this.root_wnd,null,20,-63,cc.v2(0,0)),this.loadRes(s.getUIIconPath("heroexpedit","txt_heroexpedit_1"),function(t){this.hireHero.spriteFrame=t}.bind(this))):this.hireHero&&(this.hireHero.node.active=!1)}else w=i.blood||0;this.showProgressbar(w),w<=0?this.showStrTips(!0,Utils.TI18N("\u5df2\u9635\u4ea1"),{c3b:new cc.Color(255,255,255,255)}):this.showStrTips(!1),this.setSelected(1==i.is_ui_select)}else if(this.from_type==n.ExhibitionItemType.eEndLessHero)this.setSelected(1==i.is_ui_select),i.is_endless?this.showHelpImg(!0):this.showHelpImg(!1),null!=i.hp_per&&(this.showProgressbar(i.hp_per),i.hp_per<=0?this.showStrTips(!0,Utils.TI18N("\u5df2\u9635\u4ea1"),{c3b:new cc.Color(255,255,255,255)}):this.showStrTips(!1));else if(this.from_type==n.ExhibitionItemType.eHeroFuse){var k=i.need_count||0,S=i.total_count||0,T=cc.js.formatStr("%s/%s",S,k);1===i.cur_redpoint?this.showRedPoint(!0):this.showRedPoint(!1),this.showProgressbar(S/k*100,T),this.setSelected(1==i.is_ui_select)}else this.from_type==n.ExhibitionItemType.eVoyage?this.showStrTips(i.in_task,Utils.TI18N("\u4efb\u52a1\u4e2d")):(this.setSelected(this.is_ui_select),null!=this.percent&&this.showProgressbar(this.percent,this.percent_lab),this.str_tips_obj&&this.showStrTips(this.str_tips_obj.status,this.str_tips_obj.str,this.str_tips_obj.color))}}else this.setSelected(!1)},unBindEvent:function(){this.data&&this.item_update_event&&(this.data.unbind(this.item_update_event),this.item_update_event=null)},updateStars:function(t){var e,i="",n=1;if(this.special_nd.active=!1,this.stars_container_nd.width=0,this.stars_container_nd.removeAllChildren(),t>0&&t<=5)i="common_90074";else if(t>5&&t<=9)t-=5,i="common_90075";else if(t>9){var a;e=t-10,t=1,i="common_90073",n=1.2,this.special_nd.active=!0,a=e>0?s.getUIIconPath("common","common_90084"):s.getUIIconPath("common","common_90076"),this.loadRes(a,function(t){this.special_sp.spriteFrame=t}.bind(this))}for(var o=0;o<t;o++){var l=cc.instantiate(this.star_item_nd);l.scale=n;var r=l.getComponent(cc.Sprite),c=s.getCommonIcomPath(i);if(this.loadRes(c,function(t,e){t.spriteFrame=e}.bind(this,r)),this.stars_container_nd.addChild(l),e){var _=new cc.Node;_.y=-1;var h=_.addComponent(cc.Label);h.string=e,h.fontSize=15,h.lineHeight=16,h.horizontalAlign=cc.macro.TextAlignment.CENTER,h.verticalAlign=cc.macro.TextAlignment.CENTER,_.addComponent(cc.LabelOutline).color=new cc.color(0,0,0),l.addChild(_)}}},setHeadUnEnabled:function(t){var e=cc.Material.getBuiltinMaterial("2d-sprite");t||(e=cc.Material.getBuiltinMaterial("2d-gray-sprite")),this.head_icon_sp&&this.head_icon_sp.setMaterial(0,e),this.comp_type_sp&&this.comp_type_sp.setMaterial(0,e)},setSelected:function(t){this.is_allow_select&&(this.is_ui_select=t,null!=this.root_wnd&&(this.select_item_nd.active=!!t))},setRootPosition:function(t){t&&(this.root_wnd?this.setPosition(t.x,t.y):this.cur_pos=t)},setRootScale:function(t){t&&(this.scale=t,this.root_wnd&&(this.root_wnd.scale=t))},getWorldPos:function(){return this.root_wnd?this.root_wnd.convertToWorldSpaceAR(cc.v2(0,0)):null},updagePositon:function(t){t&&this.root_wnd&&this.root_wnd.setPosition(t)},addVoBindEvent:function(){if(this.data&&this.data.id){if(this.item_update_event)return;this.item_update_event=this.data.bind(this.data.UPDATE_PARTNER_ATTR,function(t){this.root_wnd&&this.setData(t)}.bind(this))}},setDefaultHead:function(t){t&&(this.default_path=t)},setGrayHead:function(t){var e=cc.Material.getBuiltinMaterial("2d-sprite");t&&(e=cc.Material.getBuiltinMaterial("2d-gray-sprite")),this.head_icon_sp.setMaterial(0,e)},showLockIcon:function(t,e){var i=this;if(0!=t||i.lock_icon){if(!i.lock_icon){var n=s.getUIIconPath("common","common_90009");cc.size(this.root_wnd.width,this.root_wnd.height);i.lock_icon=Utils.createImage(i.root_wnd,n,0,0,cc.v2(.5,.5),!0,0,!1),this.loadRes(n,function(t){i.lock_icon.spriteFrame=t}.bind(this))}e&&(i.lock_label||(i.lock_label=Utils.createLabel(22,Config.color_data.data_color16[1],Config.color_data.data_color4[9],size.width/2,22,"",this.root_wnd,2,cc.v2(.5,0))),i.lock_label.string=e),i.lock_icon.node.active=t,i.setHeadUnEnabled(!t),i.partner_type,i.lock_label&&(i.lock_label.node.active=t)}},showHelpImg:function(t){if(0!=t||this.help_img){if(!this.help_img){var e=s.getCommonIcomPath("txt_cn_common_90014");this.help_img=Utils.createImage(this.root_wnd,e,-this.root_wnd.width/2+20,-this.root_wnd.height/2+20,cc.v2(.5,.5),!0,0,!1),this.loadRes(e,function(t){this.help_img.spriteFrame=t}.bind(this))}this.help_img.node.active=t}},showProgressbar:function(t,e){if(this.percent=t,this.percent_lab=e,this.root_wnd){var i=cc.size(118,15);if(this.bgImg&&(this.bgImg.node.active=!0),this.barNode&&(this.barNode.active=!0),!this.comp_bar){var n=s.getCommonIcomPath("common_90005"),a=s.getCommonIcomPath("common_90006");this.bgImg=Utils.createImage(this.root_wnd,null,0,-this.root_wnd.height/2-i.height/2-2,cc.v2(.5,.5),!0,0,!0),this.bgImg.node.setContentSize(i.width+2,i.height+2),this.loadRes(n,function(t){this.bgImg.spriteFrame=t}.bind(this)),this.barNode=new cc.Node,this.barNode.setAnchorPoint(cc.v2(.5,.5)),this.barNode.setContentSize(i),this.barNode.setPosition(0,-this.root_wnd.height/2-i.height/2-2),this.root_wnd.addChild(this.barNode);var o=this.barNode.addComponent(cc.Sprite);o.type=cc.Sprite.Type.SLICED,o.sizeMode=cc.Sprite.SizeMode.CUSTOM,this.loadRes(a,function(t){o.spriteFrame=t}.bind(this));var l=this.barNode.addComponent(cc.ProgressBar);l.barSprite=o,l.mode=cc.ProgressBar.Mode.HORIZONTAL,l.totalLength=i.width,this.comp_bar=l}if(this.comp_bar_label&&(this.comp_bar_label.string=""),e){if(!this.comp_bar_label){var r=new cc.Color(255,255,255,255),c=new cc.Color(0,0,0,255);i=cc.size(118,19);this.comp_bar_label=Utils.createLabel(18,r,c,i.width/2,0,"",this.comp_bar.node,2,cc.v2(.5,.5))}this.comp_bar_label.string=e}this.comp_bar.progress=t/100}},showStrTips:function(t,e,i){if(this.str_tips_obj={status:t,str:e,color:i},this.root_wnd)if(t){if(null==this.lay_tips){this.lay_tips=new cc.Node,this.lay_tips.setAnchorPoint(cc.v2(.5,.5));var s=this.root_wnd.getContentSize();this.lay_tips.setContentSize(s),this.lay_tips.setPosition(0,0);var n=this.lay_tips.addComponent(cc.Graphics);n.clear(),n.fillColor=cc.color(0,0,0,150),n.rect(-s.width/2,-s.height/2,s.width,s.height),n.fill();var a=new cc.Color(255,255,255,255),o=new cc.Color(132,0,0,255);i&&(a=i.c3b||a,o=i.enable||o);Utils.createLabel(26,a,o,0,0,e,this.lay_tips,1,cc.v2(.5,.5));this.root_wnd.addChild(this.lay_tips)}this.lay_tips.active=!0}else this.lay_tips&&(this.lay_tips.active=!1)},findUseSkin:function(t){if(t.ext_data){var e=t.ext_data||{};for(var i in e){var s=e[i];if(5==s.key)return s.val}}if(null!=t.ext){var n=t.ext||{};for(var a in n){var o=n[a];if(5==o.key)return o.val}}return t.use_skin?t.use_skin:0},getData:function(){return this.data||{}},showRedPoint:function(t){this.red_status=t,this.red_icon_nd&&(this.red_icon_nd.active=!!t)},showChipIcon:function(t){this.chip_status=t,this.chip_icon_nd&&(this.chip_icon_nd.active=t)}});cc._RF.pop()},{hero_calculate:"hero_calculate",hero_const:"hero_const",hero_controller:"hero_controller",heroexpedit_controller:"heroexpedit_controller",pathtool:"pathtool"}],hero_get_item:[function(t,e,i){"use strict";cc._RF.push(e,"b808ex5yHJDupFLz45cp5O3","hero_get_item");cc.Class({extends:ViewClass,properties:{bid_info:null,index:null,finish_cb:null},ctor:function(){this.bid_info=arguments[0],this.index=arguments[1],this.finish_cb=arguments[2],this.prefabPath=PathTool.getPrefabPath("partnersummon","hero_get_item"),this.initConfig(),this.initWindRoot()},initConfig:function(){this.bid_info&&(this.item_config=Utils.getItemConfig(this.bid_info.base_id))},initWindRoot:function(){LoaderManager.getInstance().loadRes(this.prefabPath,function(t){this.root_wnd=t,this.finish_cb&&this.finish_cb(this.index,this),this.initWidgets()}.bind(this))},initWidgets:function(){this.star_item_nd=this.seekChild("star_item"),this.stars_container_nd=this.seekChild("stars_container"),this.head_icon_sp=this.seekChild("head_icon",cc.Sprite),this.comp_type_sp=this.seekChild("comp_type",cc.Sprite),this.background_sp=this.seekChild("background",cc.Sprite),this.effect_sk=this.seekChild("effect",sp.Skeleton),this.updateWidgets()},updateWidgets:function(){if(this.item_config&&null!=this.root_wnd){for(var t=0;t<this.item_config.eqm_jie-1;t++){var e=cc.instantiate(this.star_item_nd);this.stars_container_nd.addChild(e)}var i=PathTool.getItemRes(this.item_config.icon);this.loadRes(i,function(t){this.head_icon_sp&&(this.head_icon_sp.spriteFrame=t)}.bind(this));var s=PathTool.getHeroCampRes(this.item_config.lev),n=PathTool.getCommonIcomPath(s);this.loadRes(n,function(t){this.comp_type_sp&&(this.comp_type_sp.spriteFrame=t)}.bind(this));var a=PathTool.getItemQualityBG(this.item_config.quality);n=PathTool.getCommonIcomPath(a);this.loadRes(n,function(t){this.background_sp&&(this.background_sp.spriteFrame=t)}.bind(this))}},playShowAction:function(t){this.root_wnd.scale=1.2,this.root_wnd.opacity=0;var e=cc.fadeIn(.1),i=cc.scaleTo(.1,1),s=cc.delayTime(.1*t||0),n=cc.callFunc(function(){this.showEffect()}.bind(this)),a=cc.sequence(s,n,cc.spawn(e,i));this.root_wnd.runAction(a)},showEffect:function(){var t=PathTool.getEffectRes(156),e=PathTool.getSpinePath(t);this.loadRes(e,function(t){if(this.effect_sk&&(this.effect_sk.skeletonData=t,this.effect_sk.setAnimation(0,"action3",!1),this.item_config&&this.item_config.is_effect&&1==this.item_config.is_effect)){var e=PlayerAction.action_2;this.item_config.quality>=4&&(e=PlayerAction.action_1),this.startUpdate(1,function(){this.effect_sk&&this.effect_sk.setAnimation(0,e,!0)}.bind(this),200)}}.bind(this))},deleteMe:function(){this.effect_sk&&(this.effect_sk.skeletonData=null,this.effect_sk.setToSetupPose(),this.effect_sk.clearTracks(),this.effect_sk=null),this._super()}});cc._RF.pop()},{}],hero_library_info_window:[function(t,e,i){"use strict";cc._RF.push(e,"8426eoT96BA1buBZtQ44tHm","hero_library_info_window");var s=t("pathtool"),n=t("hero_controller"),a=t("hero_const"),o=t("skill_item");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("hero","hero_library_info_window"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Full},initConfig:function(){this.select_index=0,this.max_index=2,this.skill_item_list={},this.skill_container_size=cc.size(580,130),this.ctrl=n.getInstance(),this.model=this.ctrl.getModel()},openCallBack:function(){this.main_container=this.seekChild("main_container"),this.close_btn=this.seekChild("close_btn"),this.background_nd=this.seekChild("background"),this.background_nd.scale=FIT_SCALE,this.loadRes(s.getBigBg("hero/hero_draw_bg"),function(t){this.background_nd.getComponent(cc.Sprite).spriteFrame=t}.bind(this)),this.hero_name_bg_nd=this.seekChild(this.main_container,"hero_name_bg"),this.hero_draw_icon_sp=this.seekChild(this.main_container,"hero_draw_icon",cc.Sprite),this.hero_name_lb=this.seekChild(this.hero_name_bg_nd,"hero_name",cc.Label),this.title_name_lb=this.seekChild(this.hero_name_bg_nd,"title_name",cc.Label),this.title_bg_nd=this.seekChild(this.hero_name_bg_nd,"title_bg"),this.box_6_nd=this.seekChild(this.main_container,"box_6"),this.attr_btn=this.seekChild(this.box_6_nd,"attr_btn"),this.story_btn=this.seekChild(this.box_6_nd,"story_btn"),this.left_btn_nd=this.seekChild(this.box_6_nd,"left_btn"),this.left_btn=this.seekChild(this.box_6_nd,"left_btn",cc.Button),this.right_btn_nd=this.seekChild(this.box_6_nd,"right_btn"),this.right_btn=this.seekChild(this.box_6_nd,"right_btn",cc.Button),this.light_1_sp=this.seekChild(this.box_6_nd,"light_1",cc.Sprite),this.light_2_sp=this.seekChild(this.box_6_nd,"light_2",cc.Sprite),this.page_view_nd=this.seekChild(this.box_6_nd,"pageview"),this.page_view_pv=this.seekChild(this.box_6_nd,"pageview",cc.PageView);var t=this.seekChild(this.page_view_nd,"view"),e=this.seekChild(t,"content"),i=this.seekChild(e,"page_1"),n=this.seekChild(e,"page_2");this.skill_panel_nd=this.seekChild(i,"skill_panel"),this.attr_name_lb=this.seekChild(this.skill_panel_nd,"attr_name",cc.Label),this.type_name_lb=this.seekChild(this.skill_panel_nd,"type_name",cc.Label),this.item_content=this.seekChild(this.skill_panel_nd,"content"),this.voice_panel_nd=this.seekChild(n,"voice_panel"),this.richlabel_rt=this.seekChild(this.voice_panel_nd,"richlabel",cc.RichText),this.voice_btn_nd=this.seekChild(this.voice_panel_nd,"voice_btn"),this.adaptationScreen()},adaptationScreen:function(){},registerEvent:function(){Utils.onTouchEnd(this.close_btn,function(){this.ctrl.openHeroLibraryInfoWindow(!1)}.bind(this),2),Utils.onTouchEnd(this.attr_btn,function(){this.onClickAttrBtn()}.bind(this),1),Utils.onTouchEnd(this.story_btn,function(){this.onClickStoryBtn()}.bind(this),1),Utils.onTouchEnd(this.left_btn_nd,function(){this.onClickLeftBtn()}.bind(this),1),Utils.onTouchEnd(this.right_btn_nd,function(){this.onClickRightBtn()}.bind(this),1),Utils.onTouchEnd(this.voice_btn_nd,function(){this.onClickVoiceBtn()}.bind(this),1),this.page_view_pv.node.on("page-turning",function(){var t=this.page_view_pv.getCurrentPageIndex();this.setBtnVisable(t)},this)},onClickAttrBtn:function(){if(null!=this.partner_config){var t=gdata("partner_data","data_partner_pokedex",[this.partner_config.bid]);if(t&&t[0]){var e=t[0].star||1;this.ctrl.openHeroInfoWindowByBidStar(this.partner_config.bid,e,function(){this.setVisible(!0)}.bind(this))}this.setVisible(!1)}},onClickStoryBtn:function(){if(null!=this.partner_config&&null!=this.library_config)if(null!=this.library_config.story&&""!=this.library_config.story){var t=cc.js.formatStr("%s %s",this.library_config.title,this.partner_config.name),e=this.library_config.story;this.ctrl.openHeroLibraryStoryPanel(!0,t,e)}else message(Utils.TI18N("\u8be5\u82f1\u96c4\u6682\u65e0\u4f20\u8bb0"))},onClickVoiceBtn:function(){if(this.partner_config&&this.library_config&&this.partner_config.voice&&""!=this.partner_config.voice){var t=this.partner_config.voice,e=this.partner_config.voice_time;this.ctrl.onPlayHeroVoice(t,e)}},onClickLeftBtn:function(){var t=this.page_view_pv.getCurrentPageIndex()-1;this.page_view_pv.scrollToPage(t),this.setBtnVisable(t)},onClickRightBtn:function(){var t=this.page_view_pv.getCurrentPageIndex()+1;this.page_view_pv.scrollToPage(t),this.setBtnVisable(t)},setBtnVisable:function(t){t<1?(Utils.setGreyButton(this.left_btn,!0),Utils.setGreyButton(this.right_btn,!1),this.light_1_sp.node.x=-10,this.light_2_sp.node.x=10):(Utils.setGreyButton(this.left_btn,!1),Utils.setGreyButton(this.right_btn,!0),this.light_1_sp.node.x=10,this.light_2_sp.node.x=-10)},openRootWnd:function(t,e){var i=gdata("partner_data","data_partner_base",[t]);e=gdata("partner_data","data_partner_library",[t]);this.partner_config=i,this.library_config=e,this.updateHeroInfo(),this.attr_name_lb.string=cc.js.formatStr("%s\uff1a%s%s",Utils.TI18N("\u5c5e\u6027"),String(a.CampAttrName[this.partner_config.camp_type]),String(a.CareerName[this.partner_config.type])),this.type_name_lb.string=cc.js.formatStr("%s\uff1a%s",Utils.TI18N("\u5b9a\u4f4d"),this.partner_config.hero_pos),this.richlabel_rt.string="  "+this.library_config.voice_str,this.setBtnVisable(0),this.initSkill(),this.partner_config.voice&&""!=this.partner_config.voice&&(this.voice_btn_nd.active=!0)},updateHeroInfo:function(){if(this.partner_config&&this.library_config){var t=this.partner_config.draw_res,e=s.getIconPath("herodraw/herodrawres",t);if(this.hero_draw_icon_sp&&this.loadRes(e,function(t){this.hero_draw_icon_sp.spriteFrame=t}.bind(this)),0==this.library_config.scale?this.hero_draw_icon_sp.node.scale=1:this.hero_draw_icon_sp.node.scale=this.library_config.scale/100,this.library_config.draw_offset&&null!=Utils.next(this.library_config.draw_offset)){var i=this.hero_draw_icon_sp.node.getPosition(),n=this.library_config.draw_offset[0][0]||0,a=this.library_config.draw_offset[0][1]||0;this.hero_draw_icon_sp.node.setPosition(i.x+n,i.y+a)}this.hero_name_lb.string=this.partner_config.name,this.library_config.title&&""!=this.library_config.title?this.title_name_lb.string=this.library_config.title:this.title_bg_nd.active=!1}},initSkill:function(){if(this.partner_config.bid){var t=this.partner_config.bid,e=Config.partner_data.data_partner_max_star[t]||this.partner_config.init_star,i=Utils.getNorKey(t,e),s=gdata("partner_data","data_partner_star",[i]);if(null!=s){var n=[];for(var a in s.skills){var l=s.skills[a];1!=l[0]&&n.push(l)}for(var r in this.skill_item_list)this.skill_item_list[r]&&this.skill_item_list[r].setVisible(!1);var c=0;for(var r in n){var _=n[r];gdata("skill_data","data_get_skill",[_[1]])?(null==this.skill_item_list[r]&&(this.skill_item_list[r]=new o(!0,!0,!0,1,!0),this.skill_item_list[r].setParent(this.item_content),this.skill_item_list[r].setShowTips(!0)),this.skill_item_list[r].setData([_[1]]),this.skill_item_list[r].setVisible(!0),this.skill_item_list[r].setPosition(cc.v2(-68*(n.length-1)+136*c,0)),c+=1):debug(cc.js.formatStr("\u6280\u80fd\u8868id: %s \u6ca1\u53d1\u73b0",String(_.skill_bid)))}}}},closeCallBack:function(){if(this.ctrl.openHeroLibraryInfoWindow(!1),this.skill_item_list){for(var t in this.skill_item_list)this.skill_item_list[t]&&(this.skill_item_list[t].deleteMe(),this.skill_item_list[t]=null);this.skill_item_list=null}}});cc._RF.pop()},{hero_const:"hero_const",hero_controller:"hero_controller",pathtool:"pathtool",skill_item:"skill_item"}],hero_library_main_item:[function(t,e,i){"use strict";cc._RF.push(e,"c9a350IWHpCkqtiW49jAlPN","hero_library_main_item");var s=t("pathtool");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("hero","hero_library_main_item")},initConfig:function(){},initPanel:function(){this.main_panel=this.seekChild("main_panel"),this.hero_icon_sp=this.seekChild("hero_icon",cc.Sprite),this.camp_icon_sp=this.seekChild("camp_icon",cc.Sprite),this.profession_icon_sp=this.seekChild("profession_icon",cc.Sprite),this.name_lb=this.seekChild("name",cc.Label),this.size=this.root_wnd.getContentSize()},registerEvent:function(){Utils.onTouchEnd(this.root_wnd,function(){this.callback&&this.callback()}.bind(this),1)},addCallBack:function(t){this.callback=t},setData:function(t){this.config=t,this.root_wnd&&this.onShow()},onShow:function(){if(null!=this.config){var t=s.getBigBg("partnercard_"+this.config.bid,null,"partnercard");null!=this.record_res_id&&this.record_res_id==t||(this.record_res_id=t,this.loadRes(t,function(t){this.hero_icon_sp.spriteFrame=t}.bind(this)));var e=s.getCommonIcomPath(s.getHeroCampRes(this.config.camp_type));null!=this.record_camp_res&&this.record_camp_res==e||(this.record_camp_res=e,this.loadRes(e,function(t){this.camp_icon_sp.spriteFrame=t}.bind(this)));var i=this.config.type||4,n=s.getPartnerTypeIcon(i);null!=this.record_type_res&&this.record_type_res==n||(this.record_type_res=n,this.loadRes(n,function(t){this.profession_icon_sp.spriteFrame=t}.bind(this))),this.name_lb.string=this.config.name,this.timer=gcore.Timer.set(function(){var t=this.profession_icon_sp.node.getContentSize(),e=this.name_lb.node.getContentSize(),i=t.width+5+e.width,s=.5*(this.size.width-i);this.profession_icon_sp.node.x=-this.size.width/2+s+.5*t.width,this.name_lb.node.x=this.profession_icon_sp.node.x+.5*t.width+.5*e.width+5}.bind(this),60,1)}},onHide:function(){},onDelete:function(){this.timer&&(gcore.Timer.del(this.timer),this.timer=null)}});cc._RF.pop()},{pathtool:"pathtool"}],hero_library_main_window:[function(t,e,i){"use strict";cc._RF.push(e,"2ca6c1AqP5AU4gvZAEw+2Jo","hero_library_main_window");var s=t("pathtool"),n=t("hero_controller"),a=t("hero_const"),o=t("hero_library_main_item");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("hero","hero_library_main_window"),this.viewTag=SCENE_TAG.ui,this.win_type=WinType.Full},initConfig:function(){this.ctrl=n.getInstance(),this.model=this.ctrl.getModel(),this.hero_library_list={},this.select_camp=0,this.col=3,this.item_width=220,this.item_height=335,this.cacheList={},this.cacheMaxSize=0,this.time_show_index=0,this.first_title_height=50,this.title_height=80,this.career_info_list={},this.node_list=[]},openCallBack:function(){this.main_container=this.seekChild("main_container"),this.lay_scrollview_nd=this.seekChild(this.main_container,"lay_scrollview"),this.centre_box_1_nd=this.seekChild(this.main_container,"centre_box_1"),this.border_left_box_2_nd=this.seekChild(this.main_container,"border_left_box_2"),this.border_right_box_2_nd=this.seekChild(this.main_container,"border_right_box_2"),this.top_box_4_nd=this.seekChild(this.main_container,"top_box_4"),this.bottom_box_5_nd=this.seekChild(this.main_container,"bottom_box_5");var t=this.seekChild(this.bottom_box_5_nd,"camp_node");this.camp_btn_list={};for(var e=0;e<6;e++)this.camp_btn_list[e]=this.seekChild(t,"camp_btn"+e);this.img_select_nd=this.seekChild(t,"img_select");var i=this.camp_btn_list[0].getPosition();this.img_select_nd.setPosition(i.x,i.y),this.close_btn=this.seekChild(this.bottom_box_5_nd,"close_btn"),this.background_nd=this.seekChild("background"),this.background_nd.scale=FIT_SCALE,this.loadRes(s.getBigBg("hero/hero_bag_bg"),function(t){this.background_nd.getComponent(cc.Sprite).spriteFrame=t}.bind(this)),this.adaptationScreen()},registerEvent:function(){Utils.onTouchEnd(this.close_btn,function(){this.ctrl.openHeroLibraryMainWindow(!1)}.bind(this),2);var t=function(t,e){Utils.onTouchEnd(t,function(){this.onClickBtnShowByIndex(e)}.bind(this),2)}.bind(this);for(var e in this.camp_btn_list){t(this.camp_btn_list[e],e)}},adaptationScreen:function(){},onClickBtnShowByIndex:function(t,e){if(this.img_select_nd&&this.camp_btn_list[t]){var i=this.camp_btn_list[t].getPosition();this.img_select_nd.setPosition(i.x-.5,i.y+1)}this.updateHeroList(t,e)},openRootWnd:function(t){this.onClickBtnShowByIndex(0,!0)},updateCareerUI:function(t,e,i){for(var n in this.career_info_list){var o=this.career_info_list[n];o&&(o.desk&&(o.desk.node.active=!1),o.bg.node.active=!1)}i=i||0;var l=function(e){var n=t[e],o=n.career_type||a.CareerName.eMagician,l=n.pos_y||0,r=a.CareerName[o],c=-l,_=-l-25;if(1==e&&(_=-l),null==this.career_info_list[e]){var h={};if(1!=e){var d=s.getUIIconPath("herolibrary","hero_library_box_5");h.desk=Utils.createImage(this.scrollview_container_nd,null,0,c,cc.v2(.5,.5),!0,0,!0),this.loadRes(d,function(t){h.desk.spriteFrame=t}.bind(this)),h.desk.node.setContentSize(cc.size(this.scrollview_size.width,103)),h.desk.type=cc.Sprite.Type.SLICED,h.desk.sizeMode=cc.Sprite.SizeMode.CUSTOM,this.node_list.push(h.desk)}d=s.getUIIconPath("herolibrary","hero_library_18");h.bg=Utils.createImage(this.scrollview_container_nd,null,i,_,cc.v2(0,1),!0,0,!0),this.loadRes(d,function(t){h.bg.spriteFrame=t}.bind(this)),h.bg.node.setContentSize(cc.size(232,48)),h.bg.type=cc.Sprite.Type.SLICED,h.bg.sizeMode=cc.Sprite.SizeMode.CUSTOM,this.node_list.push(h.bg);d=s.getPartnerTypeIcon(o);h.career_icon=Utils.createImage(h.bg.node,null,50,-27,cc.v2(0,.5)),this.loadRes(d,function(t){h.career_icon.spriteFrame=t}.bind(this)),this.node_list.push(h.career_icon),h.label=Utils.createLabel(24,new cc.Color(100,50,35,255),null,88,-27,r,h.bg.node,null,cc.v2(0,.5)),this.career_info_list[e]=h,this.node_list.push(h.label)}else{(h=this.career_info_list[e]).desk&&(h.desk.node.active=!0,h.desk.node.y=c),h.bg.node.active=!0,h.bg.node.y=_;d=s.getPartnerTypeIcon(o);this.loadRes(d,function(t){h.career_icon.spriteFrame=t}.bind(this)),h.label.string=r}}.bind(this);for(var n in t)0!=n&&l(n)},updateHeroList:function(t,e){if(t=t||0,e||t!=this.select_camp){if(!this.list_view_sv){var i=this.lay_scrollview_nd.getContentSize();this.createLibraryScrollView(i,.5*i.width,.5*i.height)}this.list_view_sv.stopAutoScroll(),this.list_view_sv.scrollToTop(0),this.select_camp=t;var s=Config.partner_data.data_partner_base||{},n=[];for(var a in s){var o=s[a];0!=t&&t!=o.camp_type||n.push(o)}n.sort(Utils.tableCommonSorter([["type",!1],["init_star",!0],["camp_type",!1],["sort_order",!1]]));var l=0,r=-this.scrollview_size.width/2,c=function(t){var e=t%this.col;return 0==e&&(l+=this.item_height),{x:r+this.item_width*e+.5*this.item_width,y:l-.5*this.item_height}}.bind(this),_=[];_[0]={};var h=null;for(var d in this.hero_library_list=[],this.hero_library_list[0]={},n){o=n[d];if(null==h&&(h=o.type,l=this.first_title_height,_.push({career_type:h,pos_y:0})),h!=o.type){var u=this.col-(this.hero_library_list.length-1)%this.col;if(u<this.col&&0!=u)for(d=1;d<=u;d++){var m=c(this.hero_library_list.length-1);this.hero_library_list.push({x:m.x,y:m.y})}h=o.type,_.push({career_type:h,pos_y:l}),l+=this.title_height}m=c(this.hero_library_list.length-1);this.hero_library_list.push({config:o,x:m.x,y:m.y})}var f=null;f=this.hero_library_list.length-1>0?l:0,this.updateCareerUI(_,f,r),this.reloadData(f)}},numberOfCells:function(){return this.hero_library_list.length-1},updateCellByIndex:function(t,e){t.index=e;var i=this.hero_library_list[e];i.config?(t.setActive(!0),t.setData(i.config)):t.setActive(!1)},onCellTouched:function(t){var e=t.index,i=this.hero_library_list[e];if(i&&i.config){var s=i.config.draw_res,n=gdata("partner_data","data_partner_library",[i.config.bid]);if(s&&n&&""!=s)this.ctrl.openHeroLibraryInfoWindow(!0,i.config.bid);else{message(Utils.TI18N("\u753b\u5e08\u6b63\u5feb\u9a6c\u52a0\u97ad\u5730\u5236\u4f5c\u8be5\u7acb\u7ed8\u4e2d\u54df"));var a=gdata("partner_data","data_partner_pokedex",[i.config.bid]);if(a&&a[0]){var o=a[0].star||1;this.ctrl.openHeroInfoWindowByBidStar(i.config.bid,o)}}}},createLibraryScrollView:function(t,e,i){this.scrollview_size=t,this.list_view_sv=this.seekChild(this.lay_scrollview_nd,"list_view",cc.ScrollView),this.scrollview_container_nd=this.seekChild(this.list_view_sv.node,"content"),this.cacheMaxSize=(Math.ceil(t.height/this.item_height)+1)*this.col,this.list_view_sv.node.on("scrolling",function(){this.checkOverShowByVertical()},this)},checkOverShowByVertical:function(){if(this.cellList){for(var t=-this.scrollview_container_nd.y,e=-this.scrollview_size.height+t,i=Math.ceil((this.cellList.length-1)/this.col),s=1,n=1;n<=i;n++){var a=1+(n-1)*this.col;if(s=n,(l=this.cellList[a])&&l.y-.5*this.item_height<=t)break}var o=i;if(e<0)for(n=s;n<=i;n++){var l;a=1+(n-1)*this.col;if((l=this.cellList[a])&&l.y+.5*this.item_height<e){o=n-1;break}}var r=this.numberOfCells();for(n=1;n<=i;n++)if(n>=s&&n<=o)for(var c=1;c<=this.col;c++){a=(n-1)*this.col+c;this.activeCellIdx[a]||a<=r&&(this.updateCellAtIndex(a),this.activeCellIdx[a]=!0)}else for(c=1;c<=this.col;c++){(a=(n-1)*this.col+c)<=r&&(this.activeCellIdx[a]=!1)}}},reloadData:function(t){for(var e in this.cellList=[],this.cellList[0]={},this.activeCellIdx={},this.cacheList)this.cacheList[e].setPosition(-1e3,0);t=Math.max(t,this.scrollview_size.height);this.container_size=cc.size(this.scrollview_size.width,t),this.scrollview_container_nd.setContentSize(this.container_size),this.list_view_sv.scrollToTop(0);var i=this.numberOfCells();if(0!=i){for(var s=1;s<=i;s++){var n=this.hero_library_list[s];if(null!=n){var a=null;s<=this.time_show_index&&(a=this.getCacheCellByIndex(s));var o={cell:a,x:n.x,y:-n.y};this.cellList.push(o)}}var l=this.cacheMaxSize-this.col,r=i<l&&i||l,c=function(t){gcore.Timer.set(function(){this.time_show_index<t&&(this.time_show_index=t),this.updateCellAtIndex(t),this.time_show_index==r&&(this.time_show_index=9999)}.bind(this),t/60,1),this.activeCellIdx[s]=!0}.bind(this);for(s=1;s<=r;s++)c(s)}},getCacheCellByIndex:function(t){var e=(t-1)%this.cacheMaxSize+1;if(this.cacheList[e])return this.cacheList[e];var i=new o;return i.show(),i.addCallBack(function(){this.onCellTouched(i)}.bind(this)),i.setPosition(-1e3,0),i.setAnchorPoint(cc.v2(.5,.5)),this.cacheList[e]=i,i.setParent(this.scrollview_container_nd),i},updateCellAtIndex:function(t){if(!(t>this.time_show_index)&&this.cellList[t]){var e=this.cellList[t];null==e.cell&&(e.cell=this.getCacheCellByIndex(t)),e.cell.setPosition(e.x,e.y),this.updateCellByIndex(e.cell,t)}},closeCallBack:function(){for(var t in this.cacheList){var e=this.cacheList[t];e.deleteMe&&(e.deleteMe(),e=null)}for(var i in this.cacheList=null,this.node_list){var s=this.node_list[i];s&&(s instanceof cc.Node?(s.destroy(),s=null):(s.node.destroy(),s=null))}this.node_list=null,this.career_info_list=null,this.ctrl.openHeroLibraryMainWindow(!1)}});cc._RF.pop()},{hero_const:"hero_const",hero_controller:"hero_controller",hero_library_main_item:"hero_library_main_item",pathtool:"pathtool"}],hero_library_story_window:[function(t,e,i){"use strict";cc._RF.push(e,"86528AGjEVLd7iqtIyjnAaA","hero_library_story_window");var s=t("pathtool"),n=t("hero_controller");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("hero","hero_library_story_panel"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Mini},initConfig:function(){},openCallBack:function(){this.background=this.seekChild("background"),this.main_container=this.seekChild("main_container"),this.attr_name_lb=this.seekChild("attr_name",cc.Label),this.content_scrollview=this.seekChild("content_scrollview"),this.content_scrollview_sv=this.seekChild("content_scrollview",cc.ScrollView),this.content_scrollview_size=this.content_scrollview.getContentSize(),this.content_nd=this.seekChild(this.content_scrollview,"content"),this.rich_label_rt=this.seekChild(this.content_nd,"rich_label",cc.RichText),this.background.scale=FIT_SCALE},registerEvent:function(){Utils.onTouchEnd(this.background,function(){n.getInstance().openHeroLibraryStoryPanel(!1)}.bind(this),1)},openRootWnd:function(t){null==t.name&&null==t.content||(this.attr_name_lb.string=t.name||"",this.rich_label_rt.string=t.content||"",this.timer=gcore.Timer.set(function(){var t=this.rich_label_rt.node.getContentSize();t.height<this.content_scrollview_size.height&&(this.content_scrollview_sv.vertical=!1);var e=Math.max(this.content_scrollview_size.height,t.height);this.content_nd.setContentSize(cc.size(this.content_scrollview_size.width,e))}.bind(this),60,1))},closeCallBack:function(){n.getInstance().openHeroLibraryStoryPanel(!1),this.timer&&(gcore.Timer.del(this.timer),this.timer=null)}});cc._RF.pop()},{hero_controller:"hero_controller",pathtool:"pathtool"}],hero_look_draw_window:[function(t,e,i){"use strict";cc._RF.push(e,"81c4coKEsZO2oS03rFKyxwq","hero_look_draw_window");var s=t("pathtool"),n=t("role_controller"),a=t("hero_const");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("hero","hero_look_draw_window"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Full},initConfig:function(){this.ctrl=t("hero_controller").getInstance(),this.model=this.ctrl.getModel(),this.max_scale=1.3,this.min_scale=.7;var e=Config.partner_data.data_partner_const.vertical_zoom;e&&(e.val[0]&&(this.min_scale=e.val[0]),e.val[1]&&(this.max_scale=e.val[1])),this.slider_percent=.5,this.scale_percent=.5,this.must_scale=1,this.touch_count=0,this.original_y=0,this.shard_preview_status=!1},openCallBack:function(){this.background_nd=this.seekChild("background"),this.background_nd.scale=FIT_SCALE,this.loadRes(s.getBigBg("hero/hero_draw_bg"),function(t){this.background_nd.getComponent(cc.Sprite).spriteFrame=t}.bind(this)),this.main_container=this.seekChild("main_container"),this.hero_draw_icon_sp=this.seekChild(this.main_container,"hero_draw_icon",cc.Sprite),this.hero_draw_icon_pos=this.hero_draw_icon_sp.node.getPosition(),this.slider_sl=this.seekChild("slider",cc.Slider),this.slider_img_nd=this.seekChild("slider_img"),this.name_lb=this.seekChild("name",cc.Label),this.delete_btn=this.seekChild("delete_btn"),this.add_btn=this.seekChild("add_btn"),this.close_btn=this.seekChild("close_btn"),this.bottom_lay=this.seekChild("bottom_lay"),this.top_lay=this.seekChild("top_lay"),this.story_btn=this.seekChild("story_btn"),this.shard_preview_btn=this.seekChild("shard_preview_btn"),this.shard_handle_panel=this.seekChild("shard_handle_panel"),this.confirm_btn=this.seekChild(this.shard_handle_panel,"confirm_btn"),this.cancel_btn=this.seekChild(this.shard_handle_panel,"cancel_btn"),this.erweima_container=this.seekChild(this.shard_handle_panel,"erweima_container"),this.erweima_img_sp=this.seekChild(this.erweima_container,"img",cc.Sprite),this.logo_container=this.seekChild(this.shard_handle_panel,"logo_container"),this.logo_img_sp=this.seekChild(this.logo_container,"logo_img",cc.Sprite)},registerEvent:function(){Utils.onTouchEnd(this.close_btn,function(){this.ctrl.openHeroLookDrawWindow(!1)}.bind(this),1),Utils.onTouchEnd(this.delete_btn,function(){this.onDeleteBtn()}.bind(this),1),Utils.onTouchEnd(this.add_btn,function(){this.onAddBtn()}.bind(this),1),Utils.onTouchEnd(this.story_btn,function(){this.onClickStoryBtn()}.bind(this),1),Utils.onTouchEnd(this.shard_preview_btn,function(){this.enterShardStatus(!0)}.bind(this),1),Utils.onTouchEnd(this.cancel_btn,function(){this.share_type==a.ShareType.eHeroInfoShare?this.enterShardStatus(!1):this.share_type==a.ShareType.eLibraryInfoShare&&this.ctrl.openHeroLookDrawWindow(!1)}.bind(this),1),Utils.onTouchEnd(this.confirm_btn,function(){this.shardErweimaImg()}.bind(this),1),this.slider_sl.node.on("slide",function(){this.slider_percent=this.slider_sl.progress,this.setIconScale()},this),this.background_nd.on(cc.Node.EventType.TOUCH_START,function(t){},this),this.background_nd.on(cc.Node.EventType.TOUCH_MOVE,function(t){var e=t.getTouches();if(1==e.length){var i=e[0].getLocation();this.onMovePos(i),this.touch_count<1&&(this.touch_count=1)}else this.touch_count<2&&(this.touch_count=2)},this),this.background_nd.on(cc.Node.EventType.TOUCH_END,function(t){var e=t.getTouches();if(1==this.touch_count){var i=e[0].getLocation();this.onEndPos(i)}},this)},openRootWnd:function(t){var e=t.share_type||a.ShareType.eHeroInfoShare,i=Config.partner_data.data_partner_base[t.bid],n=gdata("partner_data","data_partner_library",[t.bid]);this.must_scale=1,n&&0!=n.scale&&(this.must_scale=n.scale/100),this.partner_config=i,this.library_config=n;var o=t.draw_res_id||"jinglingwangzi",l=s.getIconPath("herodraw/herodrawres",o);this.hero_draw_icon_sp&&this.loadRes(l,function(t){this.hero_draw_icon_sp.spriteFrame=t}.bind(this)),this.slider_sl.progress=this.slider_percent,this.hero_draw_icon_sp.node.scale=this.must_scale;var r=t.name||"";this.name_lb.string=r,e==a.ShareType.eHeroInfoShare?this.enterShardStatus(!1):e==a.ShareType.eLibraryInfoShare&&this.enterShardStatus(!0),this.share_type=e},enterShardStatus:function(t){},downErweimaImg:function(){USE_SDK&&SDK.download_qrcode_png(function(t){t&&(this.erweima_img_sp.spriteFrame=spriteFrame)}.bind(this))},shardErweimaImg:function(){this.changeShardStatus(!1);var t="sy_gameshard_image";Utils.getRandomSaveName&&(t=Utils.getRandomSaveName()),n.getInstance().getApkData()?SDK.CaptureScreenSaveImg(t,function(t){1==t?this.changeShardStatus(!0):(message(Utils.TI18N("\u4fdd\u5b58\u5931\u8d25")),this.changeShardStatus(!0))}.bind(this)):gcore.Timer.set(function(){this.changeShardStatus(!0)}.bind(this),1e3,1)},changeShardStatus:function(t){this.cancel_btn.active=t,this.confirm_btn.active=t,this.add_btn.active=t,this.delete_btn.active=t,this.slider_sl.node.active=t,this.slider_img_nd.active=t,0==t?(this.erweima_container.y=-610,this.name_lb.node.y=-590):(this.erweima_container.y=-515,this.name_lb.node.y=-490)},onMovePos:function(t){if(t)if(this.start_x&&this.start_y){var e=(s=this.main_container.convertToNodeSpaceAR(t)).x-this.start_x,i=s.y-this.start_y;this.hero_draw_icon_sp.node.setPosition(this.hero_draw_icon_pos.x+e,this.hero_draw_icon_pos.y+i)}else{var s=this.main_container.convertToNodeSpaceAR(t);this.start_x=s.x,this.start_y=s.y}},onEndPos:function(t){if(t&&null!=this.start_x&&null!=this.start_y){var e=this.main_container.convertToNodeSpaceAR(t),i=e.x-this.start_x,s=e.y-this.start_y;this.hero_draw_icon_pos=cc.v2(this.hero_draw_icon_pos.x+i,this.hero_draw_icon_pos.y+s),this.start_x=null,this.start_y=null}},onDeleteBtn:function(){this.slider_percent=this.slider_percent-.01,this.slider_percent<=0&&(this.slider_percent=0),this.slider_sl.progress=this.slider_percent,this.setIconScale()},onAddBtn:function(){this.slider_percent=this.slider_percent+.01,this.slider_percent>=1&&(this.slider_percent=1),this.slider_sl.progress=this.slider_percent,this.setIconScale()},onClickStoryBtn:function(){if(this.partner_config&&this.library_config)if(null!=this.library_config.story&&""!=this.library_config.story){var t=cc.js.formatStr("%s %s",this.library_config.title,this.partner_config.name),e=this.library_config.story;this.ctrl.openHeroLibraryStoryPanel(!0,t,e)}else message(Utils.TI18N("\u8be5\u82f1\u96c4\u6682\u65e0\u4f20\u8bb0"))},setIconScale:function(){var t=null;if(this.slider_percent>this.scale_percent){var e=this.max_scale-1;t=1+(this.slider_percent-this.scale_percent)*e*2}else if(this.slider_percent<this.scale_percent){e=1-this.min_scale;t=this.min_scale+this.slider_percent*e*2}else t=1;this.hero_draw_icon_sp.node.scale=t*this.must_scale},closeCallBack:function(){this.ctrl.openHeroLookDrawWindow(!1)}});cc._RF.pop()},{hero_const:"hero_const",hero_controller:"hero_controller",pathtool:"pathtool",role_controller:"role_controller"}],hero_main_equip_panel:[function(t,e,i){"use strict";cc._RF.push(e,"19cc2I1HTpHmLN+J0DQ/jAX","hero_main_equip_panel");var s=t("pathtool"),n=t("hero_event"),a=t("tips_const"),o=t("hero_controller"),l=t("hero_calculate"),r=t("hero_const");t("goods_vo"),cc.Class({extends:BasePanel,ctor:function(){this.rleasePrefab=!1,this.prefabPath=s.getPrefabPath("hero","hero_main_tab_equip_panel"),this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){this.hero_vo=null,this.equip_icon_name_list={1:"hero_info_7",2:"hero_info_10",3:"hero_info_9",4:"hero_info_8",5:"hero_info_11",6:"hero_info_11"};var t=Config.partner_data.data_partner_const.artifact_one.val,e=Config.partner_data.data_partner_const.artifact_two.val;this.artifact_lock_list={1:t,2:e}},initPanel:function(){this.key_up_btn_nd=this.seekChild("key_up_btn"),this.btn_red_nd=this.seekChild("btn_red"),this.discharge_btn_nd=this.seekChild("discharge_btn"),this.key_up_btn_nd.active=!1,this.discharge_btn_nd.active=!1,this.img_lock={},this.lab_lock={},this.img_box={},this.red_box={},this.img_lock[1]=this.seekChild("img_lock5"),this.img_lock[2]=this.seekChild("img_lock6"),this.lab_lock[1]=this.seekChild(this.img_lock[1],"lab_lock5",cc.Label),this.lab_lock[2]=this.seekChild(this.img_lock[2],"lab_lock6",cc.Label),this.img_box[1]=this.seekChild("artifacts_bg_1",cc.Sprite),this.img_box[2]=this.seekChild("artifacts_bg_2",cc.Sprite),this.red_box[1]=this.seekChild("red_5"),this.red_box[2]=this.seekChild("red_6"),this.equip_items={};for(var t=1;t<=6;t++){var e=this.equip_items[t]=ItemsPool.getInstance().getItem("backpack_item");e.setParent(this.seekChild("equip"+t)),e.setExtendData({effect:!1,scale:.8}),e.addCallBack(this.selectEquipByIndex.bind(this,t));var i=s.getUIIconPath("hero",this.equip_icon_name_list[t]);e.setEmptyIconPath(i),e.show()}this.key_up_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickKeyUpBtn,this),this.discharge_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickDischargeBtn,this)},registerEvent:function(){this.addGlobalEvent(n.Equip_Update_Event,function(t){this.hero_vo&&t.partner_id==this.hero_vo.partner_id&&this.updateHerovo(t)}.bind(this)),this.addGlobalEvent(n.Equip_RedPoint_Event,function(){this.hero_vo&&(this.updateRedPoint(),this.updateOneKeyBtnStatus())},this),this.addGlobalEvent(n.Artifact_Update_Event,function(t){this.hero_vo&&t.partner_id==this.hero_vo.partner_id&&this.updateHerovo(t)},this),this.addGlobalEvent(n.Hero_Data_Update,function(t){this.hero_vo&&t&&t.partner_id==this.hero_vo.partner_id&&this.updateArtifactInfo(this.hero_vo)},this)},onShow:function(t){this.updateWidgets()},onHide:function(){},onDelete:function(){for(var t in this.equip_items)this.equip_items[t].deleteMe(),this.equip_items[t]=null;this.equip_items=null},updateHerovo:function(t){t&&(this.hero_vo=t),this.root_wnd&&this.updateWidgets()},onClickKeyUpBtn:function(){this.hero_vo&&this.ctrl.sender11010(this.hero_vo.partner_id,0)},onClickDischargeBtn:function(){this.hero_vo&&this.ctrl.sender11011(this.hero_vo.partner_id,0)},updateWidgets:function(){this.updateHeroInfo()},updateHeroInfo:function(){var t={1:!0,2:!0,3:!0,4:!0},e=this.model.getHeroEquipList(this.hero_vo.partner_id);for(var i in e){var s=e[i];s&&this.equip_items[s.type]&&(this.equip_items[s.type].setData(s),t[s.type]&&delete t[s.type])}for(var n in t){this.equip_items[n].setData({undata:!0})}this.updateRedPoint(),this.updateArtifactInfo(this.hero_vo),this.updateOneKeyBtnStatus()},selectEquipByIndex:function(e,i){if(this.hero_vo)if(e>=5){var s=e-4,n=this.artifact_lock_list[s];if(n)if("lev"==n[0]){if(this.hero_vo.lev<n[1])return void message(cc.js.formatStr(Utils.TI18N("\u82f1\u96c4%s\u7ea7\u89e3\u9501"),n[1]))}else if("star"==n[0]&&this.hero_vo.star<n[1])return void message(cc.js.formatStr(Utils.TI18N("\u82f1\u96c4%s\u661f\u89e3\u9501"),n[1]));var l=this.hero_vo.artifact_list[s];if(l&&null!=Utils.next(l)){var r=t("partner_const");this.ctrl.openArtifactTipsWindow(!0,l,r.ArtifactTips.partner,this.hero_vo.partner_id,s)}else this.ctrl.openArtifactListWindow(!0,s,this.hero_vo.partner_id)}else{var c=e;if(this.hero_vo.eqm_list[c])t("tips_controller").getInstance().showEquipTips(this.hero_vo.eqm_list[c],a.eqmTips.partner,this.hero_vo);else o.getInstance().openEquipPanel(!0,c,this.hero_vo.partner_id,null)}},updateArtifactInfo:function(t){for(var e in this.lock_list={},this.artifact_lock_list){var i=this.artifact_lock_list[e];this.img_lock[e].active=!1,this.lab_lock[e].string="";var s=!0,n=this.equip_items[Number(e)+4];if("lev"==i[0])if(this.img_box[e].node.active=!1,t.lev>=i[1])s=!0,this.img_box[e].node.active=!0;else{var a=Config.partner_data.data_partner_max_lev[this.hero_vo.bid];a&&a>=i[1]?(this.img_lock[e].active=!0,this.lab_lock[e].string=i[1]+Utils.TI18N("\u7ea7\u89e3\u9501"),n.setVisible(!0),this.img_box[e].node.active=!0):(this.img_lock[e].active=!1,n.setVisible(!1))}else if("star"==i[0]){Config.partner_data.data_partner_max_star[this.hero_vo.bid]<i[1]?(this.img_lock[e].active=!1,this.lab_lock[e].node.active=!1,this.img_box[e].node.active=!1,n&&n.setVisible(!1)):(this.img_box[e].node.active=!0,this.img_box[e].red_point&&(this.img_box[e].red_point.active=!1),n&&n.setVisible(!0),t.star>=i[1]?(s=!1,this.img_lock[e].active=!1,this.lab_lock[e].node.active=!1):(this.img_lock[e].active=!0,this.lab_lock[e].node.active=!0,this.lab_lock[e].string=i[1]+Utils.TI18N("\u661f\u89e3\u9501")))}this.lock_list[e]=s}if(t.artifact_list)for(e=1;e<=2;e++){n=this.equip_items[e+4];var o=t.artifact_list[e];o?(n.setData(o),n.empty_icon&&(n.empty_icon.node.active=!1),n.equip_vo=o):(n.setData({undata:!0}),n.empty_icon&&(n.empty_icon.node.active=!0),n.equip_vo=null)}this.updateArtifactRedPoint()},updateArtifactRedPoint:function(){if(this.lock_list)for(var t in this.artifact_lock_list)if(this.lock_list[t])this.red_box[t].active=!1;else{var e=this.hero_vo.artifact_list[t],i=l.getInstance().checkSingleArtifactRedPoint(e);this.red_box[t].active=i||!1}},updateRedPoint:function(){var t=!1;for(var e in r.EquipPosList){var i=this.updateEachEquipRedPoint(r.EquipPosList[e]);t||(t=i)}this.btn_red_nd.active=!!t,this.is_btn_redpoint=t},updateOneKeyBtnStatus:function(){this.hero_vo&&this.hero_vo.eqm_list?this.is_btn_redpoint||Utils.getArrLen(this.hero_vo.eqm_list)<=0?(this.key_up_btn_nd.active=!0,this.discharge_btn_nd.active=!1):(this.key_up_btn_nd.active=!1,this.discharge_btn_nd.active=!0):(this.key_up_btn_nd.active=!1,this.discharge_btn_nd.active=!1)},updateEachEquipRedPoint:function(t){var e,i=this.model.getHeroEquipList(this.hero_vo.partner_id);if(null!=i){var s=this.equip_items[t];e=l.getInstance().checkSingleHeroEachPosEquipRedPoint(t,i[t]),s.setRedStatus(e)}return e}});cc._RF.pop()},{goods_vo:"goods_vo",hero_calculate:"hero_calculate",hero_const:"hero_const",hero_controller:"hero_controller",hero_event:"hero_event",partner_const:"partner_const",pathtool:"pathtool",tips_const:"tips_const",tips_controller:"tips_controller"}],hero_main_info_window:[function(t,e,i){"use strict";cc._RF.push(e,"93167wGBMpPqIG9aJXvsB7Q","hero_main_info_window");var s=t("pathtool"),n=t("hero_const"),a=t("baserole"),o=t("hero_event"),l=t("hero_calculate"),r=t("mainui_controller"),c=t("guide_event");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("hero","hero_main_info_window"),this.viewTag=SCENE_TAG.ui,this.win_type=WinType.Full,this.rleasePrefab=!1,this.ctrl=arguments[0],this.model=this.ctrl.getModel();var e=t("action_controller");e.getInstance().action_operate&&e.getInstance().action_operate.setVisible(!1);var i=t("stronger_controller");i.getInstance().main_win&&i.getInstance().main_win.setVisible(!1)},initConfig:function(){this.role_vo=null,this.hero_list=[],this.setting=null,this.cur_tap=1},openCallBack:function(){this.background_sp=this.seekChild("background",cc.Sprite),this.main_container_nd=this.seekChild("main_container"),this.tab_container=this.seekChild("tab_container"),this.equip_container_nd=this.seekChild("equip_container"),this.comment_btn_nd=this.seekChild("comment_btn"),this.lock_btn_nd=this.seekChild("lock_btn"),this.share_btn_nd=this.seekChild("share_btn"),this.close_btn_nd=this.seekChild("close_btn"),this.left_btn_nd=this.seekChild("left_btn"),this.right_btn_nd=this.seekChild("right_btn"),this.power_num_nd=this.seekChild("power_num"),this.power_num_cs=this.power_num_nd.getComponent("CusRichText"),this.draw_btn_nd=this.seekChild("draw_btn"),this.skin_btn_nd=this.seekChild("skin_btn"),this.hero_info_20_nd=this.seekChild("hero_info_20"),this.star_node_nd=this.seekChild("star_node"),this.camp_icon_sp=this.seekChild("camp_icon",cc.Sprite),this.name_lb=this.seekChild("name",cc.Label),this.mode_node_nd=this.seekChild("mode_node"),this.star_item_nd=this.seekChild("star_item"),this.hero_camp_bg_sp=this.seekChild("hero_camp_bg",cc.Sprite),this.up_lev_act_nd=this.seekChild("up_lev_act"),this.up_lev_efc_sk=this.seekChild("up_lev_efc",sp.Skeleton),this.share_btn_nd=this.seekChild("share_btn"),this.lock_btn_nd=this.seekChild("lock_btn"),this.comment_btn_nd=this.seekChild("comment_btn"),this.lock_icon_sp=this.seekChild("lock_icon",cc.Sprite),this.background=this.seekChild("background"),this.background.scale=this.background.scale*FIT_SCALE,this.share_panel_nd=this.seekChild("share_panel"),this.share_btns={};for(var e=1;e<=3;e++){var i=this.share_btns[e]=this.seekChild(this.share_panel_nd,"share_btn_"+e);i.share_tag=e,i.on(cc.Node.EventType.TOUCH_END,this.onClickChannelBtn,this)}this.attr_keys=["atk","hp","def","speed"],this.attr_lbs={};for(var s=0;s<4;s++)this.attr_lbs[this.attr_keys[s]]=this.seekChild(this.up_lev_act_nd,"attr_"+s,cc.Label);this.btn_taps={};for(var n=1;n<=3;n++){this.btn_taps[n]={};var o=this.seekChild("tab_btn_"+n);this.btn_taps[n].tab_nd=o,this.btn_taps[n].select_img=this.seekChild(o,"select_img"),this.btn_taps[n].normal_img=this.seekChild(o,"normal_img"),this.btn_taps[n].red_img=this.seekChild(o,"red_point"),this.btn_taps[n].red_img.active=!1,o.tab_tag=n,o.on(cc.Node.EventType.TOUCH_END,this.onClickTabBtn,this)}this.hero_model=new a,this.hero_model.setParent(this.mode_node_nd);var l=t("hero_main_equip_panel");this.equip_panel=new l(this.ctrl),this.equip_panel.setParent(this.equip_container_nd),this.equip_panel.show();var r=t("hero_mian_train_panel");this.train_panel=new r(this.ctrl),this.train_panel.setParent(this.tab_container);var c=t("hero_main_upgrade_star_panel");this.up_star_panel=new c(this.ctrl),this.up_star_panel.setParent(this.tab_container);var _=t("hero_main_talent_panel");this.talent_panel=new _(this.ctrl),this.talent_panel.setParent(this.tab_container),this.up_lev_act_nd.active=!1,this.close_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickCloseBtn,this),this.left_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickLeftBtn,this),this.right_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickRightBtn,this),this.share_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickShareBtn,this),this.lock_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickLockBtn,this),this.comment_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickCommentBtn,this),this.share_panel_nd.on(cc.Node.EventType.TOUCH_END,this.onClickSharePanel,this),this.draw_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickDrawBtn,this),this.skin_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickSkinBtn,this)},registerEvent:function(){this.addGlobalEvent(o.Hero_Data_Update,function(t){t&&t.partner_id==this.hero_vo.partner_id&&this.updateHeroInfo(t)}.bind(this)),this.addGlobalEvent(o.Equip_Update_Event,function(t){this.hero_vo&&t.partner_id==this.hero_vo.partner_id&&this.updateHeroInfo(t)}.bind(this)),this.addGlobalEvent(o.Hero_Level_Up_Success_Event,function(){this.hero_vo&&this.showLevelUpAction()}.bind(this)),this.addGlobalEvent(o.Hero_Lock_Event,function(){this.hero_vo&&this.show_model_type!=n.BagTab.eBagPokedex&&this.setLock()}.bind(this)),this.addGlobalEvent(o.Hero_Get_Talent_Event,function(t){if(t&&this.hero_vo)for(var e=0;e<t.length;++e){var i=t[e];if(i.partner_id==this.hero_vo.partner_id){this.hero_vo=Utils.deepCopy1(this.model.getHeroById(i.partner_id)),this.updatePageRedPoint();break}}}.bind(this))},openRootWnd:function(t){this.hero_vo=Utils.deepCopy1(t.hero_vo),this.hero_list=t.hero_list||[],this.setting=t.setting,this.callback=this.setting.callback,this.show_model_type=this.setting.show_model_type||n.BagTab.eBagHero,r.getInstance().changeHeroStatus(!0),this.playHeroAnim=!0,this.updateWidget(),window.TASK_TIPS&&gcore.GlobalEvent.fire(c.TaskNextStep,"hero_30402"),this.show_model_type==n.BagTab.eBagPokedex&&(this.skin_btn_nd.active=!1)},closeCallBack:function(){this.equip_panel&&this.equip_panel.deleteMe(),this.train_panel&&this.train_panel.deleteMe(),this.up_star_panel&&this.up_star_panel.deleteMe(),this.talent_panel&&this.talent_panel.deleteMe(),this.hero_model&&this.hero_model.deleteMe(),this.ctrl.openHeroMainInfoWindow(!1),this.callback&&(this.callback(),this.callback=null);var e=t("action_controller");e.getInstance().action_operate&&e.getInstance().action_operate.setVisible(!0);var i=t("stronger_controller");i.getInstance().main_win&&i.getInstance().main_win.setVisible(!0),gcore.GlobalEvent.fire(c.CloseTaskEffect),r.getInstance().changeHeroStatus(!1)},checkOpenByconfig:function(t){if(t&&this.hero_vo&&"star"==t.pos_limit[0]){var e=this.hero_vo.star>=t.pos_limit[1];return e?{is_open:e}:{is_open:e,tip:t.pos_limit[1]+Utils.TI18N("\u661f\u5f00\u542f")}}},onClickTabBtn:function(t){Utils.playButtonSound(ButtonSound.Normal),t.target.tab_tag!==this.cur_tap&&t.target.tab_tag>0&&(this.cur_tap=t.target.tab_tag,this.updateTab())},updateWidget:function(e){if(this.hero_vo){var i=null;this.hero_vo.use_skin&&0!=this.hero_vo.use_skin&&(i=Config.partner_skin_data.data_skin_info[this.hero_vo.use_skin]);var a=this.hero_vo.camp_type||n.CampType.eWater,o=null;o=i&&i.hero_info_bg_res&&""!=i.hero_info_bg_res?s.getUIIconPath("bigbg/hero",i.hero_info_bg_res):s.getUIIconPath("bigbg/hero",n.CampBgRes[a]),this.bg_res&&this.bg_res===o||(this.loadRes(o,function(t){this.background_sp.spriteFrame=t,gcore.Timer.set(function(){this.main_container_nd.active=!0,this.updateSpine()}.bind(this),100,1)}.bind(this)),this.bg_res=o);var l=null;i&&i.hero_camp_res&&""!=i.hero_camp_res?"null"==i.hero_camp_res?this.hero_camp_bg_sp.node.active=!1:(l=s.getUIIconPath("bigbg/hero",i.hero_camp_res),this.hero_camp_bg_sp.node.active=!0):(this.hero_camp_bg_sp.node.active=!0,l=s.getUIIconPath("bigbg/hero",n.CampBottomBgRes[a])),this.loadRes(l,function(t){this.hero_camp_bg_sp.spriteFrame=t}.bind(this)),this.name_lb.string=this.hero_vo.name;var r=s.getHeroCampRes(this.hero_vo.camp_type),c=s.getUIIconPath("common",r);this.loadRes(c,function(t){this.camp_icon_sp.spriteFrame=t}.bind(this)),this.power_num_cs.setNum(this.hero_vo.power),this.updateStars(this.hero_vo.star),this.playHeroAnim&&(this.updateSpine(),this.playHeroAnim=!1);var _=0;for(var h in this.hero_list)if(this.hero_list[h].partner_id===this.hero_vo.partner_id){_=parseInt(h);break}if(0==_?(this.left_btn_nd.active=!1,this.hero_list.length<=1&&(this.right_btn_nd.active=!1)):_==this.hero_list.length-1?this.right_btn_nd.active=!1:(this.left_btn_nd.active=!0,this.right_btn_nd.active=!0),this.show_model_type==n.BagTab.eBagHero){var d=this.model.isMaxStarHero(this.hero_vo.bid,this.hero_vo.star);this.is_show_up_star=!d,this.setLock(),this.updateEquipPanel(),this.hero_vo.star>=6?this.is_show_talent=!0:this.is_show_talent=!1}else this.share_btn_nd.active=!1,this.lock_btn_nd.active=!1;if(this.is_show_up_star?this.btn_taps[2].tab_nd.active=!0:(2==this.cur_tap&&(this.cur_tap=1),this.btn_taps[2].tab_nd.active=!1),this.is_show_talent?this.btn_taps[3].tab_nd.active=!0:(3==this.cur_tap&&(this.cur_tap=1),this.btn_taps[3].tab_nd.active=!1),this.hero_vo.draw_res?this.draw_btn_nd.active=!0:this.draw_btn_nd.active=!1,this.updateTab(),this.show_model_type==n.BagTab.eBagHero)if(this.model.isOpenTanlentByHerovo(this.hero_vo)&&!this.hero_vo.ishaveTalentData()&&this.ctrl.sender11099([{partner_id:this.hero_vo.partner_id}]),Config.partner_skin_data.data_partner_bid_info[this.hero_vo.bid]){this.skin_btn_nd.active=!0;var u=Config.partner_skin_data.data_const.skin_open;if(u&&"lev"==u.val[0]){var m=t("role_controller").getInstance().getRoleVo();m&&m.lev<u.val[1]&&(this.skin_btn_nd.active=!1)}}else this.skin_btn_nd.active=!1}},updateEquipPanel:function(){this.equip_panel.updateHerovo(this.hero_vo)},setLock:function(){var t="hero_info_6";this.hero_vo.dic_locks[n.LockType.eHeroLock]&&(t="hero_info_5");var e=s.getUIIconPath("hero",t);this.loadRes(e,function(t){this.lock_icon_sp.spriteFrame=t}.bind(this))},updateStars:function(t){var e,i="",n=1;this.star_node_nd.destroyAllChildren(),this.star_node_nd.width=0,t>0&&t<=5?i="common_90074":t>5&&t<=9?(t-=5,i="common_90075"):t>9&&(e=t-10,t=1,i="common_90073",n=1.2);for(var a=0;a<t;a++){var o=cc.instantiate(this.star_item_nd);o.scale=n;var l=o.getComponent(cc.Sprite),r=s.getUIIconPath("common",i);if(this.loadRes(r,function(t,e){t.spriteFrame=e}.bind(this,l)),this.star_node_nd.addChild(o),e){var c=new cc.Node;c.y=-1;var _=c.addComponent(cc.Label);_.string=e,_.fontSize=15,_.lineHeight=16,_.horizontalAlign=cc.macro.TextAlignment.CENTER,_.verticalAlign=cc.macro.TextAlignment.CENTER,c.addComponent(cc.LabelOutline).color=new cc.color(0,0,0),o.addChild(c)}}},updateSpine:function(){if(this.hero_model.setData(a.type.partner,this.hero_vo,PlayerAction.show,!0,1,{skin_id:this.hero_vo.use_skin}),0!=this.hero_vo.use_skin){var t=Config.partner_skin_data.data_skin_info[this.hero_vo.use_skin];t&&"null"==t.hero_camp_res?this.hero_info_20_nd.active=!1:this.hero_info_20_nd.active=!0}else this.hero_info_20_nd.active=!0},onClickCloseBtn:function(){Utils.playButtonSound(ButtonSound.Close),this.ctrl.openHeroMainInfoWindow(!1)},updateTab:function(){if(this.show_model_type==n.BagTab.eBagPokedex){for(var t in this.btn_taps)this.btn_taps[t].tab_nd.active=!1;this.train_panel.show(this.hero_vo),this.up_star_panel.hide(),this.equip_panel.hide(),this.talent_panel.hide()}else{var e=[];for(var i in 1===this.cur_tap?(e=[2,3],this.train_panel.show(this.hero_vo),this.up_star_panel.root_wnd&&this.up_star_panel.hide(),this.talent_panel.root_wnd&&this.talent_panel.hide()):2===this.cur_tap?(e=[1,3],this.train_panel.hide(),this.talent_panel.root_wnd&&this.talent_panel.hide(),this.up_star_panel.show(this.hero_vo)):3===this.cur_tap&&(e=[1,2],this.train_panel.hide(),this.up_star_panel.root_wnd&&this.up_star_panel.hide(),this.talent_panel.show(this.hero_vo)),this.btn_taps[this.cur_tap].select_img.active=!0,this.btn_taps[this.cur_tap].normal_img.active=!1,e){var s=e[i];this.btn_taps[s].select_img.active=!1,this.btn_taps[s].normal_img.active=!0}this.updatePageRedPoint()}},updateTabShow:function(){},onClickRightBtn:function(){Utils.playButtonSound(ButtonSound.Normal),this.getNextVoByDis(1)},onClickLeftBtn:function(){Utils.playButtonSound(ButtonSound.Normal),this.getNextVoByDis(-1)},updateHeroInfo:function(t){if(t)this.hero_vo&&t&&(this.hero_vo.partner_id==t.partner_id&&this.hero_vo.star!=t.star?6!=t.star&&10!=t.star||(this.playHeroAnim=!0):this.hero_vo.partner_id!=t.partner_id&&(this.playHeroAnim=!0)),this.hero_vo=Utils.deepCopy1(t);else if(!this.hero_vo)return;this.updateWidget(),this.train_panel.updateHerovo(this.hero_vo),this.show_model_type==n.BagTab.eBagHero&&(this.up_star_panel.updateHerovo(this.hero_vo),this.equip_panel.updateHeroInfo(),this.talent_panel.updateHeroInfo(this.hero_vo))},getNextVoByDis:function(t){if(this.hero_vo){var e=null;for(var i in this.hero_list)this.hero_list[i].partner_id==this.hero_vo.partner_id&&(e=i);if(e>=0){var s=parseInt(e)+t;if(s<0)return void(this.left_btn_nd.active=!1);if(s>this.hero_list.length-1)return void(this.right_btn_nd.active=!1);this.right_btn_nd.active=!0,this.left_btn_nd.active=!0,this.updateHeroInfo(this.hero_list[s])}}},showLevelUpAction:function(){if(this.hero_vo){for(var t=0;t<4;t++){var e=Config.attr_data.data_key_to_name[this.attr_keys[t]],i=this.attr_keys[t]+"2",s=e+" +"+Math.ceil(this.hero_vo[i]/1e3);this.attr_lbs[this.attr_keys[t]].string=s}this.up_lev_act_nd.active=!0,this.up_lev_act_nd.y=200,this.up_lev_act_nd.opacity=10,this.up_lev_act_nd.stopAllActions();var n=cc.moveTo(1,cc.v2(0,280)),a=cc.fadeIn(.2);n.easing(cc.easeSineOut());var o=cc.spawn(n,a),l=cc.sequence(o,cc.callFunc(function(){this.up_lev_act_nd.active=!1}.bind(this)));this.up_lev_act_nd.runAction(l),this.showLevelUpEffect(!0)}},showLevelUpEffect:function(t){if(t){var e=s.getEffectRes(185),i=s.getSpinePath(e);this.loadRes(i,function(t){this.up_lev_efc_sk.skeletonData=t,this.up_lev_efc_sk.setAnimation(0,"action")}.bind(this)),Utils.playEffectSound(AUDIO_TYPE.COMMON,"c_levelup")}},onClickShareBtn:function(){Utils.playButtonSound(ButtonSound.Normal),this.share_panel_nd&&!this.share_panel_nd.active&&(this.share_panel_nd.active=!0)},onClickLockBtn:function(){Utils.playButtonSound(ButtonSound.Normal);var t=this.hero_vo.dic_locks[n.LockType.eHeroLock]||0;0===t?t=1:1===t&&(t=0),this.ctrl.sender11015(this.hero_vo.partner_id,t)},onClickCommentBtn:function(){Utils.playButtonSound(ButtonSound.Normal),t("pokedex_controller").getInstance().openCommentWindow(!0,this.hero_vo)},onClickChannelBtn:function(e){Utils.playButtonSound(ButtonSound.Normal);var i=t("chat_const"),s=null;switch(e.target.share_tag){case 1:s=i.Channel.Cross;break;case 2:s=i.Channel.World;break;case 3:s=i.Channel.Gang}s&&this.ctrl.sender11060(s,this.hero_vo.partner_id)},onClickSharePanel:function(){Utils.playButtonSound(ButtonSound.Normal),this.share_panel_nd.active&&(this.share_panel_nd.active=!1)},onClickDrawBtn:function(){if(this.hero_vo){var t=this.hero_vo.draw_res,e=this.hero_vo.name;if(null==t){var i=Config.partner_data.data_partner_base[this.hero_vo.bid];i&&(t=i.draw_res,e=i.name)}t&&""!=t&&this.ctrl.openHeroLookDrawWindow(!0,t,e,this.hero_vo.bid)}},onClickSkinBtn:function(){this.hero_vo&&this.ctrl.openHeroSkinWindow(!0,this.hero_vo)},updatePageRedPoint:function(){if(this.show_model_type==n.BagTab.eBagHero)for(var t in this.btn_taps){var e=this.btn_taps[t];if(e.tab_nd.active)if(t==this.cur_tap)e.red_img.active=!1;else{var i=!1;t==n.MainInfoTab.eMainTrain?i=l.getInstance().checkSingleHeroLevelUpRedPoint(this.hero_vo):t==n.MainInfoTab.eMainUpgradeStar?i=l.getInstance().checkSingleHeroUpgradeStarRedPoint(this.hero_vo):t==n.MainInfoTab.eMainTalent&&(i=l.getInstance().checkSingleHeroTalentSkillRedPoint(this.hero_vo)),e.red_img.active=i}}}});cc._RF.pop()},{action_controller:"action_controller",baserole:"baserole",chat_const:"chat_const",guide_event:"guide_event",hero_calculate:"hero_calculate",hero_const:"hero_const",hero_event:"hero_event",hero_main_equip_panel:"hero_main_equip_panel",hero_main_talent_panel:"hero_main_talent_panel",hero_main_upgrade_star_panel:"hero_main_upgrade_star_panel",hero_mian_train_panel:"hero_mian_train_panel",mainui_controller:"mainui_controller",pathtool:"pathtool",pokedex_controller:"pokedex_controller",role_controller:"role_controller",stronger_controller:"stronger_controller"}],hero_main_talent_panel:[function(t,e,i){"use strict";cc._RF.push(e,"d915bHeVG9G+rHrmfBww5nf","hero_main_talent_panel");var s=t("hero_event"),n=t("hero_calculate"),a=t("backpack_event"),o=t("backpack_const"),l=t("hero_const"),r=t("hero_vo");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=PathTool.getPrefabPath("hero","hero_main_tab_talent_panel"),this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){this.talent_pos_cfg=Config.partner_skill_data.data_partner_skill_pos},initPanel:function(){this.up_btn_nd=this.seekChild("up_btn"),this.up_btn_txt=this.seekChild("up_btn_txt",cc.Label),this.shop_btn_nd=this.seekChild("shop_btn"),this.tip_bnt_nd=this.seekChild("tip_bnt");this.skill_bnts={};for(var t=1;t<=2;t++){var e=this.skill_bnts[t]={},i=e.btn_nd=this.seekChild("skill_btn_"+t);i.skill_tag=t,e.lev_bg_nd=this.seekChild(i,"lev_bg"),e.lev_lb=this.seekChild(i,"lev",cc.Label),e.red_con_nd=this.seekChild(i,"red_con"),e.skill_icon_nd=this.seekChild(i,"skill_icon"),e.skill_icon_sp=this.seekChild(i,"skill_icon",cc.Sprite),e.add_icon_nd=this.seekChild(i,"add_icon"),e.tip_nd=this.seekChild(i,"tip_nd"),e.tip_title_lb=this.seekChild(i,"tip_title",cc.Label),e.lock_icon_nd=this.seekChild(i,"lock_icon"),e.add_icon_nd=this.seekChild(i,"add_icon"),e.btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickSkillBnt,this)}this.tip_bnt_nd.on(cc.Node.EventType.TOUCH_END,this.onClickTipBtn,this),this.up_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickUpBtn,this),this.shop_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickShopBtn,this)},registerEvent:function(){this.addGlobalEvent(a.ADD_GOODS,function(t,e){if(t!=o.Bag_Code.EQUIPS)for(var i in e){var s=e[i];if(Utils.getItemConfig(s.base_id)){this.checkSkillLevelUpRedpoint();break}if(s.base_id==this.model.talent_skill_cost_id){this.checkSkillLevelUpRedpoint();break}}}.bind(this)),this.addGlobalEvent(a.DELETE_GOODS,function(t,e){if(t!=o.Bag_Code.EQUIPS)for(var i in e){var s=e[i];if(Utils.getItemConfig(s.base_id)){this.checkSkillLevelUpRedpoint();break}if(s.base_id==this.model.talent_skill_cost_id){this.checkSkillLevelUpRedpoint();break}}}.bind(this)),this.addGlobalEvent(a.MODIFY_GOODS_NUM,function(t,e){if(t!=o.Bag_Code.EQUIPS)for(var i in e){var s=e[i];if(Utils.getItemConfig(s.base_id)){this.checkSkillLevelUpRedpoint();break}if(s.base_id==this.model.talent_skill_cost_id){this.checkSkillLevelUpRedpoint();break}}}.bind(this)),this.addGlobalEvent(s.Hero_Forget_Talent_Event,function(t){t&&this.hero_vo&&t.partner_id==this.hero_vo.partner_id&&(this.hero_vo=t,this.updateWidget())}.bind(this)),this.addGlobalEvent(s.Hero_Level_Up_Talent_Event,function(t){t&&this.hero_vo&&t.partner_id==this.hero_vo.partner_id&&(this.hero_vo=t,this.updateWidget())}.bind(this)),this.addGlobalEvent(s.Hero_Get_Talent_Event,function(t){if(t&&this.hero_vo)for(var e=0;e<t.length;++e){var i=t[e];i.partner_id==this.hero_vo.partner_id&&(this.hero_vo=Utils.deepCopy1(this.model.getHeroById(i.partner_id)),this.updateWidget())}}.bind(this)),this.addGlobalEvent(s.Hero_Learn_Talent_Event,function(t){t&&this.hero_vo&&t.partner_id==this.hero_vo.partner_id&&(this.hero_vo=t,this.updateWidget())}.bind(this))},onShow:function(t){this.hero_vo=t,this.hero_vo.is_open_talent&&(this.hero_vo.is_open_talent=null,this.hero_vo.fire(r.UPDATE_Partner_ATTR,this.hero_vo),n.getInstance().checkHeroRedPointByRedPointType(l.RedPointType.eRPTalent)),this.updateWidget()},onHide:function(){},onDelete:function(){},updateHeroInfo:function(t){this.hero_vo=t,this.root_wnd&&this.updateWidget()},onClickSkillBnt:function(t){if(Utils.playButtonSound(1),this.hero_vo.ishaveTalentData()){var e=t.target.skill_tag;this.checkOpenByIndex(e,!0)&&(this.hero_vo.talent_skill_list[e]?this.ctrl.openHeroTalentSkillLevelUpPanel(!0,this.hero_vo,this.hero_vo.talent_skill_list[e],e):this.ctrl.openHeroTalentSkillLearnPanel(!0,this.hero_vo,e))}},updateWidget:function(){if(null!=this.hero_vo.talent_skill_list){var t=this.hero_vo.talent_skill_list;for(var e in this.talent_pos_cfg){var i=this.talent_pos_cfg[e];if(this.checkOpenByIndex(i.pos)){var s=t[i.pos];if(s){this.skill_bnts[i.pos].add_icon_nd.active=!1,this.skill_bnts[i.pos].skill_icon_nd.active=!0;var n=gdata("skill_data","data_get_skill",s);if(n){var a=PathTool.getIconPath("skillicon",n.icon);this.loadRes(a,function(t,e){this.skill_bnts[t].skill_icon_sp.spriteFrame=e}.bind(this,i.pos)),this.skill_bnts[i.pos].tip_nd.active=!0,this.skill_bnts[i.pos].tip_title_lb.string=n.name,this.skill_bnts[i.pos].lev_bg_nd.active=!0,this.skill_bnts[i.pos].lev_lb.string=n.level}}else this.skill_bnts[i.pos].lev_bg_nd.active=!1,this.skill_bnts[i.pos].tip_nd.active=!1,this.skill_bnts[i.pos].add_icon_nd.active=!0,this.skill_bnts[i.pos].skill_icon_nd.active=!1;this.skill_bnts[i.pos].lock_icon_nd.active=!1}else this.skill_bnts[i.pos].lock_icon_nd.active=!0,this.skill_bnts[i.pos].add_icon_nd.active=!1,this.skill_bnts[i.pos].tip_title_lb.string=Utils.TI18N(i.pos_limit[1]+"\u661f\u5f00\u542f"),this.skill_bnts[i.pos].tip_nd.active=!0,this.skill_bnts[i.pos].lev_bg_nd.active=!1,this.skill_bnts[i.pos].skill_icon_nd.active=!1}this.checkSkillLevelUpRedpoint()}},checkOpenByIndex:function(t,e){if(t){var i=this.talent_pos_cfg[t];if(i){if("star"==i.pos_limit[0]){if(this.hero_vo.star>=i.pos_limit[1])return!0;e&&message(Utils.TI18N(i.pos_limit[1]+"\u661f\u5f00\u542f"))}return!1}}},onClickTipBtn:function(e){Utils.playButtonSound(3);var i=Config.partner_skill_data.data_partner_skill_const.skill_rule,s=e.touch.getLocation();t("tips_controller").getInstance().showCommonTips(i.desc,s)},onClickUpBtn:function(){this.ctrl.openArtifactSkillWindow(!0,2)},onClickShopBtn:function(){var e=t("mall_controller"),i=t("mall_const");e.getInstance().openMallPanel(!0,i.MallType.SkillShop)},checkSkillLevelUpRedpoint:function(){if(this.hero_vo.talent_skill_list)for(var t in this.talent_pos_cfg){var e=this.talent_pos_cfg[t];if(this.hero_vo.talent_skill_list[e.pos]){var i=n.getInstance().checkSingleTalentSkillLevel(this.hero_vo.talent_skill_list[e.pos]);this.skill_bnts[t].red_con_nd.active=i}else this.skill_bnts[t].red_con_nd.active=!1}}});cc._RF.pop()},{backpack_const:"backpack_const",backpack_event:"backpack_event",hero_calculate:"hero_calculate",hero_const:"hero_const",hero_event:"hero_event",hero_vo:"hero_vo",mall_const:"mall_const",mall_controller:"mall_controller",tips_controller:"tips_controller"}],hero_main_upgrade_star_panel:[function(t,e,i){"use strict";cc._RF.push(e,"08322PJCvtAc7tvTp5Kb7PD","hero_main_upgrade_star_panel");var s=t("pathtool"),n=t("hero_const"),a=t("hero_calculate"),o=t("hero_event");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("hero","hero_main_tab_upgrade_star_panel"),this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){this.need_heros={},this.hero_item_cache=[],this.selcet_hero_data={}},initPanel:function(){this.left_star_node=this.seekChild("left_star_node"),this.right_star_node=this.seekChild("right_star_node"),this.left_skill_item_nd=this.seekChild("left_skill_item"),this.right_skill_item_nd=this.seekChild("right_skill_item"),this.skill_arrow_nd=this.seekChild("skill_arrow"),this.skill_container_nd=this.seekChild("skill_container"),this.attr_container_nd=this.seekChild("attr_container"),this.star_arrow_nd=this.seekChild("star_arrow"),this.attr_ori_pos=this.attr_container_nd.x,this.hero_item_container_nd=this.seekChild("hero_item_container"),this.up_btn_nd=this.seekChild("up_btn"),this.btn_title_nd=this.seekChild("btn_title"),this.btn_title_lb=this.seekChild("btn_title",cc.Label),this.btn_item_nd=this.seekChild("btn_item"),this.item_icon_sp=this.seekChild("item_icon",cc.Sprite),this.item_txt_lb=this.seekChild("item_txt",cc.Label),this.fuse_btn_nd=this.seekChild("fuse_btn"),this.item_num_nd=this.seekChild("item_num"),this.item_num_icon_sp=this.seekChild("item_num_icon",cc.Sprite),this.item_have_lb=this.seekChild("item_have",cc.Label),this.btn_red_nd=this.seekChild("btn_red"),this.left_stars={},this.right_stars={};for(var e=0;e<5;e++)this.left_stars[e]=this.left_star_node.getChildByName("star_item_"+e),this.right_stars[e]=this.right_star_node.getChildByName("star_item_"+e);this.common_9005_nd=this.seekChild("common_9005");var i=t("skill_item");this.max_skill_item=new i,this.max_skill_item.setParent(this.skill_arrow_nd),this.max_skill_item.setScale(.8),this.left_skill_item=new i,this.left_skill_item.setParent(this.left_skill_item_nd),this.left_skill_item.setScale(.8),this.left_skill_item.setShowTips(!0),this.right_skill_item=new i,this.right_skill_item.setParent(this.right_skill_item_nd),this.right_skill_item.setScale(.8),this.right_skill_item.setShowTips(!0),this.attri_items={};for(var s=0;s<3;s++)this.attri_items[s]={},this.attri_items[s].item_nd=this.seekChild("param"+(s+1)),this.attri_items[s].key_nd=this.seekChild(this.attri_items[s].item_nd,"key"),this.attri_items[s].left_nd=this.seekChild(this.attri_items[s].item_nd,"left"),this.attri_items[s].right_nd=this.seekChild(this.attri_items[s].item_nd,"right"),this.attri_items[s].arrow_nd=this.seekChild(this.attri_items[s].item_nd,"arrow_icon");this.up_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickUpBtn,this)},registerEvent:function(){this.addGlobalEvent(o.Del_Hero_Event,function(){this.updateWidgets()},this),this.fuse_btn_nd.on(cc.Node.EventType.TOUCH_END,function(){this.hero_vo&&t("hero_controller").getInstance().openHeroUpgradeStarFuseWindow(!0,this.hero_vo)},this)},onShow:function(t){t&&(this.hero_vo=t,this.updateWidgets())},updateHerovo:function(t){this.hero_vo=t,this.root_wnd&&this.updateWidgets()},onHide:function(){},onDelete:function(){for(var t in this.selcet_hero_data){var e=this.selcet_hero_data[t];for(var i in e)e[i].is_ui_select=!1,e[i].is_ui_lock=!1}for(var s in this.max_skill_item&&this.max_skill_item.deleteMe(),this.left_skill_item&&this.left_skill_item.deleteMe(),this.right_skill_item&&this.right_skill_item.deleteMe(),this.need_hero_items)this.need_hero_items[s]&&(this.need_hero_items[s].getRootWnd(function(t){t.nameLabel.node.destroy(),t.nameLabel=null}.bind(this)),this.need_hero_items[s].deleteMe(),this.need_hero_items[s]=null)},updateWidgets:function(){if(this.root_wnd&&this.hero_vo){var e=this.hero_vo.bid+"_"+this.hero_vo.star,i=this.hero_vo.bid+"_"+(this.hero_vo.star+1);this.cur_star_cfg=gdata("partner_data","data_partner_star",e),this.next_star_cfg=gdata("partner_data","data_partner_star",i),this.next_star_cfg,this.updageStars(),this.updagetAttrs();var n=this.getDifferenceSkill();for(var o in this.max_skill_item.setVisible(!1),this.left_skill_item.setVisible(!1),this.right_skill_item.setVisible(!1),1==n.length?(this.max_skill_item.setVisible(!0),this.max_skill_item.setData(n[0])):2==n.length&&(this.left_skill_item.setVisible(!0),this.right_skill_item.setVisible(!0),this.left_skill_item.setData(n[0]),this.right_skill_item.setData(n[1])),this.hero_vo.star>=this.model.hero_info_upgrade_star_param&&this.hero_vo.star<this.model.hero_info_upgrade_star_param3?0==n.length?(this.skill_container_nd.active=!1,this.attr_container_nd.x=this.star_arrow_nd.x):(this.skill_container_nd.active=!0,this.attr_container_nd.anchorX=0,this.attr_container_nd.x=this.attr_ori_pos):(this.skill_container_nd.active=!1,this.attr_container_nd.x=this.star_arrow_nd.x),this.selcet_hero_data){var l=this.selcet_hero_data[o];for(var r in l)l[r].is_ui_select=!1}for(var r in this.selcet_hero_data={},this.hero_need_data=[],this.need_hero_items={},this.need_heros)this.need_heros[r].setVisible(!1),this.hero_item_cache.push(this.need_heros[r]),delete this.need_heros[r];if(this.fuse_btn_nd.active=!0,this.btn_item_nd.active=!1,this.item_num_nd.active=!1,this.btn_title_nd.active=!0,this.is_item_enough=!0,this.next_star_cfg)if(this.hero_vo.star>=this.model.hero_info_upgrade_star_param){if(this.next_star_cfg.other_expend){this.btn_item_nd.active=!0,this.item_num_nd.active=!0,this.btn_title_nd.active=!1;var c=t("backpack_controller"),_=gdata("item_data","data_unit1",this.next_star_cfg.other_expend[0][0]),h=c.getInstance().getModel().getBackPackItemNumByBid(_.id);h>=this.next_star_cfg.other_expend[0][1]?this.is_item_enough=!0:this.is_item_enough=!1;var d=Utils.getMoneyString(h)+"/"+this.next_star_cfg.other_expend[0][1];this.item_have_lb.string=d;var u=Utils.TI18N(this.next_star_cfg.other_expend[0][1]+"\u5347\u661f"),m=s.getIconPath("item",_.icon);this.item_txt_lb.string=u,this.loadRes(m,function(t){this.item_icon_sp.spriteFrame=t,this.item_num_icon_sp.spriteFrame=t}.bind(this))}else this.btn_title_lb.string=Utils.TI18N("\u5347\u661f");this.fuse_btn_nd.active=!1,this.common_9005_nd.active=!0}else this.btn_title_lb.string=Utils.TI18N("\u5347\u661f"),this.fuse_btn_nd.active=!0,this.common_9005_nd.active=!1;else this.btn_title_nd.active=!0,this.btn_item_nd.active=!1,this.btn_title_lb.stirng=Utils.TI18N("\u5df2\u6ee1\u7ea7");var f=a.getInstance().checkSingleHeroUpgradeStarRedPoint(this.hero_vo);this.btn_red_nd.active=!!f,this.updateNeedHerosInfo(),this.updateCenterRedpoint()}},updateNeedHerosInfo:function(){var t=this;if(this.next_star_cfg){var e=0;this.hero_need_data=[],this.need_index_type={};for(var i=0;i<this.next_star_cfg.expend2.length;i++){this.selcet_hero_data[e]||(this.selcet_hero_data[e]=[]),this.need_index_type[e]=1;var a=this.next_star_cfg.expend2[i];this.hero_need_data.push(this.getHeroData(a[0],null,a[1],a[2],this.selcet_hero_data[e].length,e)),e++}for(i=0;i<this.next_star_cfg.expend3.length;i++){this.selcet_hero_data[e]||(this.selcet_hero_data[e]=[]),this.need_index_type[e]=2;a=this.next_star_cfg.expend3[i];this.hero_need_data.push(this.getHeroData(null,a[0],a[1],a[2],this.selcet_hero_data[e].length,e)),e++}for(var o=function(e){r=106*e,c=null,t.need_hero_items[e]?c=t.need_hero_items[e]:(t.hero_item_cache.length>0?(c=t.hero_item_cache.shift()).setVisible(!0):((c=ItemsPool.getInstance().getItem("hero_exhibition_item")).setParent(t.hero_item_container_nd),c.setScale(.8),c.setExtendData({from_type:n.ExhibitionItemType.eUpStar,scale:.8})),t.need_hero_items[e]=c,c.setPosition(r,0),_=t.model.getRandomHeroHeadByQuality(t.hero_need_data[e].star),h=s.getIconPath("item",_),c.setDefaultHead(h),c.addCallBack(t.onClickHeroItem.bind(t)),t.need_heros[e]=c,c.need_index=e),c.setData(t.hero_need_data[e]),c.show(),c.getRootWnd(function(t){var i,s=this.hero_need_data[e];if(i=s.bid?Config.partner_data.data_partner_base[s.bid].name:s.star+"\u661f\u82f1\u96c4",null==t.nameLabel){var n=(new cc.Node).addComponent(cc.Label);n.node.y=-t.height/2-25,n.node.color=new cc.Color(100,50,35),n.fontSize=22,n.lineHeight=23,n.horizontalAlign=cc.macro.TextAlignment.CENTER,n.verticalAlign=cc.macro.TextAlignment.CENTER,t.nameLabel=n,t.addChild(n.node)}t.nameLabel.string=Utils.TI18N(i)}.bind(t))},l=0;l<this.hero_need_data.length;l++){var r,c,_,h;o(l)}}},onClickHeroItem:function(t){this.ctrl.openHeroUpgradeStarSelectPanel(!0,t.data,this.selcet_hero_data,2,null,this.updateNeedHero.bind(this,t.need_index),this.hero_vo)},getHeroData:function(t,e,i,s,n,a){var o={};if(o.star=i,o.count=s||0,o.lev=cc.js.formatStr("%s/%s",n||0,s),o.need_index=a,o.select_count=n,o.head_gray=!(n>0),t){var l=Config.partner_data.data_partner_base[t];if(!l)return null;o.bid=t,o.camp_type=l.camp_type}else o.bid=0,o.camp_type=e;return o},updagetAttrs:function(){if(this.next_star_cfg)for(var t=this.next_star_cfg.attr_show,e=0;e<3;e++){var i=this.attri_items[e];t[e]?(i.item_nd.active=!0,t[e][0]&&(i.key_nd.active=!0,i.key_nd.getComponent(cc.Label).string=t[e][0]),t[e][1]?(i.left_nd.active=!0,i.left_nd.getComponent(cc.Label).string=t[e][1]):(i.left_nd.active=!1,i.arrow_nd.active=!1),t[e][2]?(i.right_nd.active=!0,i.right_nd.getComponent(cc.Label).string=t[e][2]):i.right_nd.active=!1):i.item_nd.active=!1}},updageStars:function(){for(var t=this.hero_vo.star,e=this.hero_vo.star+1,i=this.getStarInfo(t),n=this.getStarInfo(e),a=0;a<5;a++){if(a<i.star_num){this.left_stars[a].active=!0,this.left_stars[a].scale=i.star_scale;var o=this.left_stars[a].getComponent(cc.Sprite),l=s.getUIIconPath("common",i.star_res);if(this.loadRes(l,function(t,e){t.spriteFrame=e}.bind(this,o)),i.star_label){var r=this.left_stars[a].starNum;if(null==r){var c=new cc.Node;c.y=-1;var _=c.addComponent(cc.Label);_.fontSize=15,_.lineHeight=16,_.horizontalAlign=cc.macro.TextAlignment.CENTER,_.verticalAlign=cc.macro.TextAlignment.CENTER,c.addComponent(cc.LabelOutline).color=new cc.color(0,0,0),this.left_stars[a].addChild(c),this.left_stars[a].starNum=_,r=this.left_stars[a].starNum}r.string=i.star_label}}else this.left_stars[a].active=!1;if(a<n.star_num){this.right_stars[a].active=!0,this.right_stars[a].scale=n.star_scale;o=this.right_stars[a].getComponent(cc.Sprite),l=s.getUIIconPath("common",n.star_res);if(this.loadRes(l,function(t,e){t.spriteFrame=e}.bind(this,o)),n.star_label){var h=this.right_stars[a].starNum;if(null==h){var d=new cc.Node;d.y=-1;var u=d.addComponent(cc.Label);u.fontSize=15,u.horizontalAlign=cc.macro.TextAlignment.CENTER,u.verticalAlign=cc.macro.TextAlignment.CENTER,d.addComponent(cc.LabelOutline).color=new cc.color(0,0,0),this.right_stars[a].addChild(d),this.right_stars[a].starNum=u,h=this.right_stars[a].starNum}h.string=n.star_label}}else this.right_stars[a].active=!1}},getStarInfo:function(t){var e={},i="",s=1;return t>0&&t<=5?i="common_90074":t>5&&t<=9?(t-=5,i="common_90075"):t>9&&(i="common_90073",s=1.2,t-10&&(e.star_label=t-10),t=1),e.star_num=t,e.star_scale=s,e.star_res=i,e},getDifferenceSkill:function(){var t=[];if(!this.next_star_cfg&&this.cur_star_cfg&&this.cur_star_cfg.skills.length>0)return t.push(this.cur_star_cfg.skills[0][1]),t;if(this.cur_star_cfg&&this.next_star_cfg)for(var e in this.cur_star_cfg.skills)if(this.cur_star_cfg.skills[e][1]!==this.next_star_cfg.skills[e][1])return t.push(this.cur_star_cfg.skills[e][1]),t.push(this.next_star_cfg.skills[e][1]),t;return t},updateNeedHero:function(t,e){this.selcet_hero_data=e,this.updateNeedHerosInfo(),this.updateCenterRedpoint()},onClickUpBtn:function(){if(this.isHeroEnough()&&this.is_item_enough){var t=this.getNeedHeroInfo();this.ctrl.sender11005(this.hero_vo.partner_id,t.hero_list,t.random_list)}else message(Utils.TI18N("\u6240\u9700\u6750\u6599\u4e0d\u8db3"));this.model.setUpgradeStarUpdateRecord(!1)},isHeroEnough:function(){for(var t in this.hero_need_data)if(this.hero_need_data[t].select_count<this.hero_need_data[t].count)return!1;return!0},getNeedHeroInfo:function(){var t=[],e=[];for(var i in this.need_index_type){var s=this.selcet_hero_data[i];for(var n in s){var a={};a.partner_id=s[n].partner_id,1===this.need_index_type[i]?t.push(a):e.push(a)}}return{hero_list:t,random_list:e}},updateCenterRedpoint:function(){for(var t=!0,e=0;e<this.hero_need_data.length;++e){var i=!1,s=this.hero_need_data[e];s.count!=s.select_count&&(t=!1,i=this.haveCanSelect(this.hero_need_data[e])),this.need_hero_items[e].showRedPoint(i)}t&&this.is_item_enough?this.btn_red_nd.active=!0:this.btn_red_nd.active=!1},haveCanSelect:function(t){var e=Utils.deepCopy(this.model.getAllHeroArray());if(this.hero_list=[],0===t.bid)for(var i=0;i<e.length;++i)e[i].camp_type!==t.camp_type&&0!==t.camp_type||e[i].star===t.star&&this.hero_vo&&e[i].partner_id!==this.hero_vo.partner_id&&(this.isOtherSelect(e[i])||this.hero_list.push(e[i]));else for(i=0;i<e.length;++i)e[i].bid===t.bid&&this.hero_vo&&e[i].partner_id!==this.hero_vo.partner_id&&e[i].star===t.star&&(this.isOtherSelect(e[i])||this.hero_list.push(e[i]));for(i=0;i<this.hero_list.length;++i)for(var s in this.selcet_hero_data)for(var n=0;n<this.selcet_hero_data[s].length;++n)this.selcet_hero_data[s][n].partner_id!=this.hero_list[i].partner_id||(this.hero_list[i].is_ui_select=!0);var a=0;for(i=0;i<this.hero_list.length;++i)this.hero_list[i].is_ui_select||a++;return a>=t.count},isOtherSelect:function(t){for(var e in this.selcet_hero_data)for(var i=0;i<this.selcet_hero_data[e].length;++i){var s=this.selcet_hero_data[e][i];if(t.partner_id===s.partner_id)return!0}return!1}});cc._RF.pop()},{backpack_controller:"backpack_controller",hero_calculate:"hero_calculate",hero_const:"hero_const",hero_controller:"hero_controller",hero_event:"hero_event",pathtool:"pathtool",skill_item:"skill_item"}],hero_mian_train_panel:[function(t,e,i){"use strict";cc._RF.push(e,"81bc21RL0dO6aZkpTB659BZ","hero_mian_train_panel");var s=t("pathtool"),n=t("hero_calculate"),a=t("hero_const"),o=t("backpack_controller"),l=t("role_controller"),r=(t("role_event"),t("backpack_const")),c=t("backpack_event"),_=t("hero_event");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("hero","hero_main_tab_train_panel"),this.rleasePrefab=!1,this.ctrl=arguments[0],this.model=this.ctrl.getModel(),this.role_vo=l.getInstance().getRoleVo()},initConfig:function(){this.attr_list={0:"atk",1:"hp",2:"def",3:"speed"},this.skill_items={},this.skill_item_cache=[],this.updateTimer=0,this.updateInterval=.2,this.totalCount=0},initPanel:function(){this.advanced_node=this.seekChild("advanced_node"),this.upgrade_nd=this.seekChild("upgrade"),this.max_level_nd=this.seekChild("max_level"),this.lev_btn_title_lb=this.seekChild("lev_btn_title",cc.Label),this.btn_red_nd=this.seekChild("btn_red"),this.item_icon1_sp=this.seekChild("item_icon1",cc.Sprite),this.item_icon2_sp=this.seekChild("item_icon2",cc.Sprite),this.level_up_cost1_lb=this.seekChild("level_up_cost1",cc.Label),this.level_up_cost2_lb=this.seekChild("level_up_cost2",cc.Label),this.level_up_cost1_ol=this.seekChild("level_up_cost1",cc.LabelOutline),this.level_up_cost2_ol=this.seekChild("level_up_cost2",cc.LabelOutline),this.level_lb=this.seekChild("level",cc.Label),this.profession_icon_sp=this.seekChild("profession_icon",cc.Sprite),this.profession_name_lb=this.seekChild("profession_name",cc.Label),this.look_btn_nd=this.seekChild("look_btn"),this.level_up_btn_nd=this.seekChild("level_up_btn"),this.skill_container_nd=this.seekChild("skill_container"),this.advanced_icons={};for(var t=1;t<=6;t++)this.advanced_icons[t]=this.seekChild(this.advanced_node,"advanced_icon_"+t),this.advanced_icons[t].active=!1;this.attr_item={};for(var e=0;e<4;e++)this.attr_item[e]={},this.attr_item[e].attr_icon_sp=this.seekChild("attr_icon"+(e+1),cc.Sprite),this.attr_item[e].attr_label_lb=this.seekChild("attr_label"+(e+1),cc.Label);this.level_up_btn_nd.on(cc.Node.EventType.TOUCH_START,this.upBtnStart,this),this.level_up_btn_nd.on(cc.Node.EventType.TOUCH_CANCEL,this.upBtnEnd,this),this.level_up_btn_nd.on(cc.Node.EventType.TOUCH_END,this.upBtnEnd,this),this.look_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickLookBtn,this)},upBtnStart:function(){this.startUpdate()},upBtnEnd:function(){this.stopUpdate(),this.totalCount<this.updateInterval&&this.leveUp(),this.totalCount=0,this.updateTimer=0},update:function(t){if(0==this.level_up_btn_nd.active||2==this.lev_status)return this.totalCount=0,this.updateTimer=0,this.stopUpdate(),void(2==this.lev_status&&this.leveUp());this.updateTimer+=t,this.totalCount+=t,this.updateTimer>=this.updateInterval&&(this.updateTimer=0,this.leveUp())},registerEvent:function(){this.addGlobalEvent(c.ADD_GOODS,function(t,e){if(t!=r.Bag_Code.EQUIPS)for(var i in e){e[i].base_id==this.model.upgrade_star_cost_id&&(this.hero_vo.red_point[a.RedPointType.eRPLevelUp]=null,this.updateLevelUpRedPoint())}}.bind(this)),this.addGlobalEvent(c.DELETE_GOODS,function(t,e){if(t!=r.Bag_Code.EQUIPS)for(var i in e){e[i].base_id==this.model.upgrade_star_cost_id&&(this.hero_vo.red_point[a.RedPointType.eRPLevelUp]=null,this.updateLevelUpRedPoint())}}.bind(this)),this.addGlobalEvent(c.MODIFY_GOODS_NUM,function(t,e){if(t!=r.Bag_Code.EQUIPS)for(var i in e){e[i].base_id==this.model.upgrade_star_cost_id&&(this.hero_vo.red_point[a.RedPointType.eRPLevelUp]=null,this.updateLevelUpRedPoint())}}.bind(this)),this.role_assets_event=this.role_vo.bind(EventId.UPDATE_ROLE_ATTRIBUTE,function(t,e){this.hero_vo&&(1==n.getInstance().getHeroShowLevelStatus(this.hero_vo)&&("coin"!=t&&"hero_exp"!=t||(this.updateCostInfo(),this.updateLevelUpRedPoint())))}.bind(this)),this.addGlobalEvent(_.Hero_Data_Update,function(t){this.hero_vo&&t&&t.partner_id==this.hero_vo.partner_id&&(this.updateHerovo(t),this.setUpdateRedPointInfo())},this)},onShow:function(t){t&&(this.hero_vo=t,this.updateWidgets())},updateHerovo:function(t){this.hero_vo=t,this.root_wnd&&(this.limit_lev_max=null,this.updateWidgets())},onHide:function(){},onDelete:function(){for(var t in this.skill_items)this.skill_items[t].deleteMe(),this.skill_items[t]=null;this.skill_items=null,this.stopUpdate(),this.role_assets_event&&(this.role_vo.unbind(this.role_assets_event),this.role_assets_event=null)},updateWidgets:function(){var t=this.hero_vo.bid+"_"+this.hero_vo.star;this.star_cfg=gdata("partner_data","data_partner_star",t),this.cur_break_cfg=Config.partner_data.data_partner_brach[this.hero_vo.type+"_"+this.hero_vo.break_id+"_"+this.hero_vo.break_lev];var e=Config.partner_data.data_partner_brach[this.hero_vo.type+"_"+this.hero_vo.break_id+"_"+(this.hero_vo.break_lev+1)];if(this.cur_break_cfg){this.level_up_btn_nd.active=!0,this.max_level_nd.active=!1,this.upgrade_nd.active=!0,this.btn_red_nd.active=!1,this.lev_btn_title_lb.string=Utils.TI18N(Lang.LEVEL_UP);var i=this.cur_break_cfg.lev_max;if(this.limit_lev_max=i,this.lev_status=0,e)if(e.limit)if(this.hero_vo.lev>=this.cur_break_cfg.lev_max)n.getInstance().isEnoughCondition(e.limit,this.hero_vo)?(this.level_up_btn_nd.active=!0,this.lev_btn_title_lb.string=Utils.TI18N(Lang.BREAK_UP),this.lev_status=2):(this.level_up_btn_nd.active=!1,this.lev_status=0),this.upgrade_nd.active=!1,this.max_level_nd.active=!0;else this.lev_status=1,this.updateCostInfo();else this.level_up_btn_nd.active=!0,this.hero_vo.lev>=this.cur_break_cfg.lev_max?(this.lev_btn_title_lb.string=Utils.TI18N(Lang.BREAK_UP),this.lev_status=2):(this.lev_status=1,this.updateCostInfo());else this.star_cfg&&i<this.star_cfg.lev_max&&(i=this.star_cfg.lev_max),this.limit_lev_max=i,this.hero_vo.lev>=i?(this.max_level_nd.active=!0,this.upgrade_nd.active=!1,this.level_up_btn_nd.active=!1,this.lev_status=0):(this.max_level_nd.active=!1,this.upgrade_nd.active=!0,this.lev_status=1,this.updateCostInfo());for(var o in this.advanced_icons)this.advanced_icons[o].active=!1;for(var l=this.model.getHeroMaxBreakCountByInitStar(this.hero_vo.star),r=this.hero_vo.break_lev,c=1;c<=l;c++){this.advanced_icons[c].active=!0;var _=s.getUIIconPath("hero","hero_info_1");c>r&&(_=s.getUIIconPath("hero","hero_info_2"));var h=this.advanced_icons[c].getComponent(cc.Sprite);this.loadRes(_,function(t,e){t.spriteFrame=e}.bind(this,h))}this.level_lb.string=cc.js.formatStr("%s/%s",this.hero_vo.lev,i);var d=this.hero_vo.type||4,u=s.getUIIconPath("common","common_900"+(45+d)),m=a.CareerName[d]||Utils.TI18N("\u65e0");this.loadRes(u,function(t){this.profession_icon_sp.spriteFrame=t}.bind(this)),this.profession_name_lb.string=Utils.TI18N(m),this.updateAttrt(),this.updateSkills(),this.updateLevelUpRedPoint()}},updateCostInfo:function(){if(this.hero_vo&&this.limit_lev_max){var t=this.limit_lev_max,e=1;this.hero_vo.lev<60&&(e=10);for(var i=this.hero_vo.lev,n={},a=1;a<=e;++a){var l=this.hero_vo.lev+a-1;if(l>=t)break;var r=Config.partner_data.data_partner_lev[l];if(r){var c=w(r.expend||[]),_=c.is_enough,h=c.cur_cost_list;if(!_){1==a&&(n=h);break}n=h,i=l}}this.setLevName(this.hero_vo,i-this.hero_vo.lev+1),this.need_items=[];var d=Config.partner_data.data_partner_lev[this.hero_vo.lev];if(d&&d.expend&&this.lev_status)for(var u=0;u<d.expend.length;++u){var m=d.expend[u],f=gdata("item_data","data_unit1",m[0],!1),p=s.getIconPath("item",f.icon);this.loadRes(p,function(t,e){this["item_icon"+(parseInt(t)+1)+"_sp"].spriteFrame=e}.bind(this,u));var g=n[m[0]];this["level_up_cost"+(parseInt(u)+1)+"_lb"].string=g;var v;v=o.getInstance().getModel().getItemNumByBid(m[0]);var b=new cc.Color(0,0,0,255);v<g&&(b=new cc.Color(199,12,12,255),this.need_items.push(m[0])),this["level_up_cost"+(parseInt(u)+1)+"_ol"].color=b}}function w(t){for(var e={},i=!0,s=0;s<t.length;++s){var a=t[s];null==n[a[0]]&&(n[a[0]]=0),e[a[0]]=n[a[0]]+a[1],o.getInstance().getModel().getItemNumByBid(a[0])<e[a[0]]&&(i=!1)}return{is_enough:i,cur_cost_list:e}}},setLevName:function(t,e){t&&(this.lev_btn_title_lb.string=e>1?Utils.TI18N(cc.js.formatStr(Utils.TI18N("\u5347%s\u7ea7"),e)):Utils.TI18N("\u5347 \u7ea7"))},updateUpLevelUse:function(){},setUpdateRedPointInfo:function(){this.hero_vo.red_point[a.RedPointType.eRPLevelUp]=null,this.updateLevelUpRedPoint()},updateLevelUpRedPoint:function(){var t=n.getInstance().checkSingleHeroLevelUpRedPoint(this.hero_vo);this.btn_red_nd.active=!!t},updateAttrt:function(){for(var t in this.attr_list){var e=this.attr_item[t].attr_label_lb,i=this.hero_vo[this.attr_list[t]];e.string=i}},updateSkills:function(){if(this.star_cfg){for(var e in this.skill_items)this.skill_item_cache.push(this.skill_items[e]),this.skill_items[e].setVisible(!1),delete this.skill_items[e];this.skill_container_nd.width=104*(this.star_cfg.skills.length-1);for(var i=1;i<this.star_cfg.skills.length;i++){var s=104*(i-.5);if(this.skill_item_cache.length>0)this.skill_items[i]=this.skill_item_cache.shift(),this.skill_items[i].setVisible(!0);else{var n=t("skill_item");this.skill_items[i]=new n,this.skill_items[i].setParent(this.skill_container_nd),this.skill_items[i].setScale(.8),this.skill_items[i].setShowTips(!0)}var a=!1;this.star_cfg.skills[i][0]>this.cur_break_cfg.skill_num&&(a=!0),this.skill_items[i].showUnEnabled(a),this.skill_items[i].setPosition(cc.v2(s,0)),this.skill_items[i].setData(this.star_cfg.skills[i][1])}}},onClickLevelUpBtn:function(){this.leveUp()},leveUp:function(){if(this.hero_vo)if(1===this.lev_status)if(this.need_items.length>0){var t=gdata("item_data","data_unit1",this.need_items[0],!1);message(Utils.TI18N(t.name+"\u4e0d\u8db3")),o.getInstance().openTipsSource(!0,this.need_items[0])}else this.ctrl.sender11003(this.hero_vo.id);else 2===this.lev_status&&this.ctrl.openHeroBreakPanel(!0,this.hero_vo)},onClickLookBtn:function(){this.hero_vo&&this.ctrl.openHeroTipsAttrPanel(!0,this.hero_vo,!0)}});cc._RF.pop()},{backpack_const:"backpack_const",backpack_controller:"backpack_controller",backpack_event:"backpack_event",hero_calculate:"hero_calculate",hero_const:"hero_const",hero_event:"hero_event",pathtool:"pathtool",role_controller:"role_controller",role_event:"role_event",skill_item:"skill_item"}],hero_model:[function(t,e,i){"use strict";cc._RF.push(e,"cab3eqqKGZLUJgBvXKUXy/7","hero_model");var s=t("hero_const"),n=t("partner_const"),a=t("hero_event"),o=t("partner_calculate"),l=t("hero_calculate"),r=t("hero_controller"),c=t("backpack_controller");cc.Class({extends:BaseClass,ctor:function(){this.ctrl=arguments[0]},properties:{},initConfig:function(){this.hero_list={},this.hero_bid_list={},this.hero_array=[],this.is_init=!0,this.hero_max_count=0,this.buy_num=0,this.hero_skin_list=null,this.dic_pokedex_info=null,this.dic_pokedex_bid={},this.dic_fuse_info=null,this.dic_had_hero_info={},this.pos_list={},this.expedit_list=null,this.use_formation_type=1,this.use_hallows_id=0,this.is_equip_redpoint_bag_update=!0,this.is_equip_redpoint_hero_update=!0,this.is_delay_redpoint_update={},this.upgrade_star_cost_id=10001,this.is_upgradestar_redpoint_bag_update=!0,this.is_upgradestar_redpoint_hero_update=!0,this.is_redpoint_form=!1,this.is_redpoint_hallows=!1,this.record_login_lev=0,this.artifact_lucky=0,this.artifact_lucky_red=!1,this.hero_info_upgrade_star_param=6,this.hero_info_upgrade_star_param2=10,this.hero_info_upgrade_star_param3=11,this.hero_info_talent_skill_param=Config.partner_skill_data.data_partner_skill_const.skill_slot.val,this.talent_skill_cost_id=10450,this.dic_hero_talent_skill_learn_redpoint={},this.is_need_update_talent_redpoint=!0},setHeroMaxCount:function(t){"number"==typeof t&&(this.hero_max_count=t)},getHeroMaxCount:function(){return{max_count:this.hero_max_count||0,have_coutn:this.hero_array.length}},setHeroBuyNum:function(t){this.buy_num=Number(t)},getHeroBuyNum:function(){return this.buy_num||0},updateHeroList:function(t,e,i){if(t){for(var s in t)this.updateHeroVo(t[s],i);e&&(l.getInstance().clearAllStarFuseRedpointRecord(),gcore.GlobalEvent.fire(a.Hero_Data_Add,t)),this.is_init=!1}},updateHeroVo:function(e,i){if(e){e.id=e.partner_id;var n=e.partner_bid||e.bid;!n&&this.hero_list[e.id]&&(n=this.hero_list[e.id].bid);var o=Config.partner_data.data_partner_base[n];if(o){var r=!1,c=this.hero_list[e.id];if(!c){r=!0;var _=t("hero_vo");for(var h in c=this.hero_list[e.id]=new _,o)"skills"!==h&&(e[h]=o[h]);var d=t("role_controller").getInstance().getRoleVo();d&&(e.rid=d.rid,e.srv_id=d.srv_id)}var u=null,m=0;r||(!i&&c.power<e.power&&GlobalMessageMgr.getInstance().showPowerMove(e.power-c.power,null,c.power),e.star&&c.star<e.star?(m=1,u=Utils.deepCopy(c),c.star==this.hero_info_talent_skill_param[1]-1&&(c.is_open_talent=!0)):e.break_lev&&c.break_lev<e.break_lev&&(m=2,u=Utils.deepCopy(c)));var f=e.star||o.init_star;this.dic_had_hero_info[n]?this.dic_had_hero_info[n]<f&&(this.dic_had_hero_info[n]=f):this.dic_had_hero_info[n]=f,c.updateHeroVo(e),r?(this.hero_array.push(c),this.hero_bid_list[c.bid]||(this.hero_bid_list[c.bid]=[]),this.hero_bid_list[c.bid].push(c)):(1==m&&u?(this.ctrl.openHeroUpgradeStarExhibitionPanel(!0,u,c),l.getInstance().clearAllHeroRecordByRedPointType(s.RedPointType.eRPStar)):2==m&&u&&this.ctrl.openBreakExhibitionWindow(!0,u,c),gcore.GlobalEvent.fire(a.Hero_Data_Update,c)),l.getInstance().checkHeroRedPointByRedPointType(s.RedPointType.eRPLevelUp),cc.log("updateHeroVo")}}},getHeroById:function(t){if(this.hero_list&&t&&"number"==typeof t)return this.hero_list[t]||{}},delHeroDataList:function(t){if(t){for(var e in cc.log("delHeroDataList"),t){var i=t[e],s=this.hero_list[i.partner_id].bid;delete this.hero_list[t[e].partner_id];var n=this.hero_bid_list[s];if(n)for(var o=0;o<n.length;++o){n[o].partner_id==i.partner_id&&n.splice(o,1)}}for(var e in this.hero_array=[],this.hero_list)this.hero_array.push(this.hero_list[e]);l.getInstance().clearAllStarFuseRedpointRecord(),this.is_upgradestar_redpoint_hero_update=!0,this.checkUpgradeStarRedPointUpdate(),gcore.GlobalEvent.fire(a.Del_Hero_Event,t)}},updateHeroVoTalent:function(t,e){for(var i=!1,s=0;s<t.length;++s){var n=t[s];this.hero_list[n.partner_id]&&(this.hero_list[n.partner_id].updateSkill(n.dower_skill),i||this.hero_list[n.partner_id].isFormDrama()&&(i=!0))}i&&!e&&l.getInstance().checkAllHeroRedPoint()},getHeroList:function(){return this.hero_list||{}},getAllHeroArray:function(){return this.hero_array},getHeroListByCamp:function(t){if("number"==typeof t){var e=[];for(var i in this.hero_array)t!==s.CampType.eNone&&t!==this.hero_array[i].camp_type||e.push(this.hero_array[i]);var n=this.getHeroSortFunc();return e.sort(n)}},getDeepHeroListByCamp:function(t){if("number"==typeof t){var e=[];for(var i in this.hero_array)t!==s.CampType.eNone&&t!==this.hero_array[i].camp_type||e.push(this.hero_array[i]);var n=this.getHeroSortFunc();return Utils.deepCopy(e.sort(n))}},getRestHeroListByCamp:function(t){if("number"==typeof t){var e=[];for(var i in this.hero_array)t!==s.CampType.eNone&&t!==this.hero_array[i].camp_type||e.push(this.hero_array[i]);var n=Utils.deepCopy(e);for(var i in n){var a=n[i];(a.is_in_form>0||a.is_lock)&&(a.is_ui_lock=!0)}return n.sort(function(t,e){return!t.is_ui_lock&&!e.is_ui_lock||t.is_ui_lock&&e.is_ui_lock?t.star===e.star?t.power==e.power?t.lev==e.lev?e.sort_order-t.sort_order:t.lev-e.lev:t.power-e.power:t.star-e.star:t.is_ui_lock?1:-1})}},setHadHeroInfo:function(t){if(t)for(var e in t)this.dic_had_hero_info[t[e].partner_id]=t[e].max_star},getHeroPokedexList:function(t){if(!this.dic_pokedex_info){for(var e in this.dic_pokedex_info={},s.CampType)"eNone"!==e&&(this.dic_pokedex_info[s.CampType[e]]=[]);var i=Config.partner_data.data_partner_pokedex;if(i)for(var n in i){Config.partner_data.data_partner_base[n];for(var a in i[n]){var o=n+"_"+i[n][a].star,l=this.getHeroPokedexByBid(o);l&&this.dic_pokedex_info[l.camp_type].push(l)}}var r=function(t,e){return t.star===e.star?t.bid-e.bid:t.star-e.star};for(var c in this.dic_pokedex_info)this.dic_pokedex_info[c].sort(r)}return this.dic_pokedex_info[t]},getHeroPokedexByBid:function(t){if(this.dic_pokedex_bid[t])return this.dic_pokedex_bid[t];var e=gdata("partner_data","data_partner_show",t);if(!e)return null;var i=Config.partner_data.data_partner_base[e.bid];if(i){var s=this.getHeroMaxBreakCountByInitStar(e.star);return e.hp_max=e.hp,e.power=o.calculatePower(e),e.camp_type=i.camp_type,e.name=i.name,e.init_star=i.init_star,e.type=i.type,e.break_id=i.break_id,e.break_lev=s,e.partner_id=10*e.bid+e.star,e.is_pokedex=!0,this.dic_pokedex_bid[t]=e,this.dic_pokedex_bid[t]}return null},getHeroMaxBreakCountByInitStar:function(t){if(!this.dic_max_break){var e=Config.partner_data.data_partner_const.advanced_limit.val;for(var i in this.dic_max_break={},e)this.dic_max_break[e[i][0]]=e[i][1]}return this.dic_max_break[t]||0},getRandomHeroHeadByQuality:function(t){if(!this.dic_random_hero_head){var e=Config.partner_data.data_partner_const.random_hero_icon.val;for(var i in this.dic_random_hero_head={},e){var s=gdata("item_data","data_unit5",e[i][1]);s&&(this.dic_random_hero_head[e[i][0]]=s.icon)}}return(t=t||0)>5&&(t=5),this.dic_random_hero_head[t]},getHadHeroInfo:function(){return this.dic_had_hero_info||{}},getHadHeroStarBybid:function(t){return this.dic_had_hero_info&&this.dic_had_hero_info[t]?this.dic_had_hero_info[t]:null},isOpenTanlentByHerovo:function(t){return!!(t[this.hero_info_talent_skill_param[0]]&&t[this.hero_info_talent_skill_param[0]]>=this.hero_info_talent_skill_param[1])},setFormList:function(t){var e=t.type>=0?t.type:n.Fun_Form.Drama;if(this.pos_list[e])for(var i in this.pos_list[e]){(a=this.getHeroById(this.pos_list[e][i].id))&&a.updateFormPos&&a.updateFormPos(0,e)}for(var s in this.pos_list[e]={},t.pos_info){var a;this.pos_list[e][t.pos_info[s].pos]=t.pos_info[s],(a=this.getHeroById(t.pos_info[s].id))&&a.updateFormPos&&a.updateFormPos(t.pos_info[s].pos,e)}if(e==n.Fun_Form.Drama){this.form_power=t.power||0,this.use_formation_type=t.formation_type,this.use_hallows_id=t.hallows_id;var o=l.getInstance();RedMgr.getInstance().addCalHandler(o.checkAllHeroRedPoint.bind(o),RedIds.HeroAll);var c=[];for(var _ in this.pos_list[e]){var h=this.pos_list[e][_];c.push({partner_id:h.id})}r.getInstance().sender11099(c)}},getMaxFight:function(){if(this.hero_array){this.hero_array.sort(Utils.tableUpperSorter(["power"]));var t=this.hero_array[0];if(t)return t.power}return 0},getTopLevHeroInfoByBid:function(t){if(t){var e=this.hero_bid_list[t];return e?(e.sort(Utils.tableUpperSorter(["lev","power"])),e[0]):null}},getExpeditHeroData:function(){for(var t=this.getAllHeroArray(),e=[],i=0;i<t.length;i++){var s={};s.power=t[i].power,s.name=t[i].name,s.bid=t[i].bid,s.index=i,s.rid=t[i].rid,s.srv_id=t[i].srv_id,s.id=t[i].id,s.star=t[i].star,s.lev=t[i].lev,s.use_skin=t[i].use_skin,e.push(s)}return e.sort(function(t,e){return e.power<t.power}),e},getMyPosList:function(){return this.pos_list[n.Fun_Form.Drama]||{}},getHeroSortFunc:function(){return function(t,e){return t.star===e.star?t.power==e.power?t.lev==e.lev?t.sort_order-e.sort_order:e.lev-t.lev:e.power-t.power:e.star-t.star}},isMaxStarHero:function(t,e){if(!t||!e)return!1;var i=Config.partner_data.data_partner_max_star[t];return!!(i&&e>=i)||e>=this.hero_info_upgrade_star_param&&e==this.hero_info_upgrade_star_param2&&!this.checkOpenStar11()},getStarFuseList:function(t){t=t||0;var e=[],i=Config.partner_data.data_partner_fuse_star;if(i){for(var s in i){var n=i[s],a=Config.partner_data.data_partner_base[s];for(var o in n){var l=n[o].star,r=gdata("partner_data","data_partner_star",s+"_"+l);if(a&&(a.camp_type==t||0===t)&&a&&r&&r.expend1.length>0){var c={};c.base_config=a,c.star_config=r,c.camp_type=a.camp_type,c.bid=s,c.star=l,e.push(c)}}}return e}},getMockHeroVoByBid:function(t){var e=Config.partner_data.data_partner_base[t],i=Config.partner_data.data_partner_attr[t];if(e&&i){var s=Utils.deepCopy(e);for(var n in s.star=e.init_star,s.break_lev=0,i){var a=i[n];s[n]||(s[n]=a)}return s.hp=i.hp_max,s.power=o.calculatePower(s),s}},updateHeroEquipList:function(t){var e=t.partner_id;if(e&&this.hero_list[e]){var i=this.hero_list[e];i.power<t.power&&GlobalMessageMgr.getInstance().showPowerMove(t.power-i.power,null,i.power),this.hero_list[e].updateHeroVo(t)}},getHeroEquipList:function(t){if(this.hero_list[t])return this.hero_list[t].eqm_list},getArtifactLuckyRedStatus:function(){return this.artifact_lucky_red},setArtifactLucky:function(t){this.artifact_lucky=t,RedMgr.getInstance().addCalHandler(this.updateArtifactLuckyRed.bind(this))},getArtifactLucky:function(){return this.artifact_lucky||0},updateArtifactLuckyRed:function(){var e=0,i=Config.partner_artifact_data.data_artifact_const.change_condition;i&&null!=i.val&&(e=i.val),this.artifact_lucky>=e?this.artifact_lucky_red=!0:this.artifact_lucky_red=!1,gcore.GlobalEvent.fire(a.Artifact_Lucky_Red_Event);var s=t("scene_const");t("mainscene_controller").getInstance().setBuildRedStatus(s.CenterSceneBuild.mall,this.artifact_lucky_red)},updatePartnerArtifactList:function(t){var e=t.partner_id||0;if(this.hero_list[e]){var i=this.hero_list[e];i&&(i.power<t.power&&GlobalMessageMgr.getInstance().showPowerMove(t.power-i.power,null,i.power),this.hero_list[e].updateHeroVo(t),gcore.GlobalEvent.fire(a.Artifact_Update_Event,i))}},getPartnerArtifactList:function(t){return this.hero_list[t]&&this.hero_list[t].artifact_list||[]},setLockByPartnerid:function(t,e){this.hero_list[t]&&(this.hero_list[t].is_lock=e||0)},getHeroListByMatchInfo:function(t,e,i){var s=0,n=(i=i||{},{}),a=function(t,e,a){i[t]||(n[e]||(n[e]=0),n[e]<a&&(n[e]=n[e]+1,s+=1,i[t]=1))};for(var o in this.hero_list){var l=this.hero_list[o];if(t&&t[l.bid]&&t[l.bid][l.star]){var r=cc.js.formatStr("%s%s",l.bid,l.star);a(l.partner_id,r,t[l.bid][l.star])}if(e)if(e[0]&&e[0][l.star]){r=cc.js.formatStr("_%s%s",0,l.star);a(l.partner_id,r,e[0][l.star])}else if(e[l.camp_type]&&e[l.camp_type][l.star]){r=cc.js.formatStr("_%s%s",l.camp_type,l.star);a(l.partner_id,r,e[l.camp_type][l.star])}}return s},checkLevelRedPointUpdate:function(){l.getInstance().clearAllHeroRecordByRedPointType(s.RedPointType.eRPLevelUp,!0)},checkUnlockFormRedPoint:function(){},setEquipUpdateRecord:function(t){this.is_equip_redpoint_bag_update=t,this.is_equip_redpoint_hero_update=t},checkEquipRedPointUpdate:function(){this.is_equip_redpoint_bag_update&&this.is_equip_redpoint_hero_update&&(l.getInstance().clearAllHeroRecordByRedPointType(s.RedPointType.eRPEquip),gcore.GlobalEvent.fire(a.Equip_RedPoint_Event))},setUpgradeStarUpdateRecord:function(t){this.is_upgradestar_redpoint_bag_update=t,this.is_upgradestar_redpoint_hero_update=t},checkUpgradeStarRedPointUpdate:function(){this.is_upgradestar_redpoint_bag_update&&this.is_upgradestar_redpoint_hero_update&&l.getInstance().clearAllHeroRecordByRedPointType(s.RedPointType.eRPStar)},checkUnlockHallowsRedPoint:function(){},checkOpenStar11:function(){var e=Config.partner_data.data_partner_const.staropen11_world_lev;if(e&&("world_lev"==e.val[0]&&(t("role_controller").getInstance().getModel().getWorldLev()||0)<e.val[1]))return!1;return!0},setUpdateTalentRedpoint:function(){this.is_need_update_talent_redpoint=!0},getTalentRedpointRecord:function(){if(this.is_need_update_talent_redpoint){var t,e=Config.partner_skill_data.data_partner_skill_learn;if(e)for(var i in e){var s=e[i];this.dic_hero_talent_skill_learn_redpoint[s.id]=null,t=!0;for(var n=0;n<s.expend.length;++n){var a=s.expend[n];if(c.getInstance().getModel().getItemNumByBid(a[0])<a[1]){t=!1;break}}t&&(this.dic_hero_talent_skill_learn_redpoint[s.id]=s.id)}}return this.is_need_update_talent_redpoint=!1,Utils.next(this.dic_hero_talent_skill_learn_redpoint)||(this.dic_hero_talent_skill_learn_redpoint={}),this.dic_hero_talent_skill_learn_redpoint},checkTalentRedPointUpdate:function(){this.is_delay_redpoint_update[s.RedPointType.eRPTalent]||(this.is_delay_redpoint_update[s.RedPointType.eRPTalent]=!0,l.getInstance().clearAllHeroRecordByRedPointType(s.RedPointType.eRPTalent,!0))},updateHeroVoDetailedInfo:function(t){if(t&&this.hero_list[t.partner_id]){for(var e in cc.log(this.hero_list[t.partner_id],t),t){var i=t[e];this.hero_list[t.partner_id][e]=i}this.hero_list[t.partner_id].is_had_detailed=!0,gcore.GlobalEvent.fire(a.Hero_Vo_Detailed_info,this.hero_list[t.partner_id])}},initHeroSkin:function(e){if(e){if(this.hero_skin_list){var i=null;for(var s in e.partner_skins){var n=e.partner_skins[s];if(null==this.hero_skin_list[n.id]){i=n.id;break}}if(i){var o=Config.partner_skin_data.data_skin_info[i];if(o){var l={};l.partner_bid=o.bid,l.is_chips=1,l.init_star=5,l.status=1,l.show_type=t("partnersummon_const").Gain_Show_Type.Skin_show,l.skin_id=i,t("partnersummon_controller").getInstance().openSummonGainShowWindow(!0,[l],null,2)}}}for(var r in this.hero_skin_list={},e.partner_skins){var c=e.partner_skins[r];this.hero_skin_list[c.id]=c.end_time}gcore.GlobalEvent.fire(a.Hero_Skin_Info_Event,e)}},getHeroSkinInfoBySkinID:function(t){if(this.hero_skin_list&&null!=this.hero_skin_list[t])return this.hero_skin_list[t]},isUnlockHeroSkin:function(t,e){return!(!this.hero_skin_list||null==this.hero_skin_list[t])&&!(e&&this.hero_skin_list[t]>0)}});cc._RF.pop()},{backpack_controller:"backpack_controller",hero_calculate:"hero_calculate",hero_const:"hero_const",hero_controller:"hero_controller",hero_event:"hero_event",hero_vo:"hero_vo",mainscene_controller:"mainscene_controller",partner_calculate:"partner_calculate",partner_const:"partner_const",partnersummon_const:"partnersummon_const",partnersummon_controller:"partnersummon_controller",role_controller:"role_controller",scene_const:"scene_const"}],hero_reset_offer_window:[function(t,e,i){"use strict";cc._RF.push(e,"ed032FmFzlI45Gw11hNRwG9","hero_reset_offer_window");var s=t("pathtool"),n=t("hero_event"),a=t("hero_const"),o=t("commonalert");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("hero","hero_reset_offer_panel"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Full,this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){this.is_show_tips=!1},openCallBack:function(){this.des_txt_lb=this.seekChild("des_txt",cc.RichText),this.list_view_nd=this.seekChild("list_view"),this.cancel_btn_nd=this.seekChild("cancel_btn"),this.confirm_btn_nd=this.seekChild("confirm_btn"),this.close_btn_nd=this.seekChild("close_btn"),this.win_title_lb=this.seekChild("win_title",cc.Label),this.cancel_btn_nd.on(cc.Node.EventType.TOUCH_END,function(){Utils.playButtonSound(1),this.onClickCancelBtn()},this),this.confirm_btn_nd.on(cc.Node.EventType.TOUCH_END,function(){Utils.playButtonSound(1),this.onClickConfirBtn()},this),this.close_btn_nd.on(cc.Node.EventType.TOUCH_END,function(){Utils.playButtonSound(2),this.onClickCloseBtn()},this),this.des_txt_lb.string=Utils.TI18N(Lang.OFFET_DES),this.initListView()},registerEvent:function(){this.addGlobalEvent(n.Hero_Reset_Look_Event,function(t){t&&this.setItemsData(t)}.bind(this))},openRootWnd:function(t){this.reset_type=t.reset_type,this.is_show_tips=t.is_show_tips,t.reset_type==a.ResetType.eHeroReset?(this.des_txt_lb.string=Utils.TI18N("\u732e\u796d\u82f1\u96c4\u53ef\u83b7\u5f97\u6750\u6599\uff0c\u82e5\u82f1\u96c4\u6709\u8fdb\u884c\u5347\u7ea7\u3001\u8fdb\u9636\u3001\u5347\u661f\u57f9\u517b\uff0c\u4e5f\u4f1a100%\u8fd4\u8fd8\u6240\u6d88\u8017\u7684\u8fdb\u9636\u77f3\u3001\u91d1\u5e01\u548c\u82f1\u96c4\u7ecf\u9a8c\u3002\u672c\u6b21\u732e\u796d\u6240\u5f97\u5982\u4e0b\uff1a"),this.win_title_lb.string=Utils.TI18N("\u82f1\u96c4\u732e\u796d"),t.item_list&&this.ctrl.sender11075(t.item_list)):t.reset_type==a.ResetType.eChipReset&&(this.des_txt_lb.string=Utils.TI18N(t.dec),this.setItemsData(t.item_list),this.win_title_lb.string=Utils.TI18N("\u788e\u7247\u732e\u796d")),t.callback&&(this.close_cb=t.callback)},closeCallBack:function(){this.item_scrollview&&(this.item_scrollview.deleteMe(),this.item_scrollview=null),this.ctrl.openHeroResetOfferPanel(!1)},updateWidgets:function(){},initListView:function(){var e=t("common_scrollview"),i=cc.size(this.list_view_nd.width,this.list_view_nd.height);this.item_scrollview=new e,this.item_scrollview.createScroll(this.list_view_nd,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,i,{item_class:"backpack_item",start_x:0,space_x:4,start_y:0,space_y:0,item_width:150,item_height:136,col:4,once_num:5,need_dynamic:!0},cc.v2(.5,.5))},onClickCancelBtn:function(){this.onClickCloseBtn()},onClickConfirBtn:function(){this.onClickCloseBtn(),this.reset_type==a.ResetType.eHeroReset?this.onHeroComfirm():this.reset_type==a.ResetType.eChipReset&&this.onChipComfirm()},onClickCloseBtn:function(){this.ctrl.openHeroResetOfferPanel(!1)},setItemsData:function(t){var e=[];for(var i in t){var s={};s.bid=t[i].id,s.num=t[i].num,e.push(s)}this.item_scrollview.setData(e,null,{is_show_tips:!0,is_other:!1})},onHeroComfirm:function(){if(this.is_show_tips){var t=Utils.TI18N("\u672c\u6b21\u732e\u796d\u542b\u67095\u661f\u6216\u4ee5\u4e0a\u82f1\u96c4\uff0c\u662f\u5426\u786e\u8ba4\u732e\u796d\uff1f"),e={};e.title=Utils.TI18N("\u82f1\u96c4\u732e\u796d"),e.delayS=10;o.show(t,Utils.TI18N("\u786e\u5b9a"),function(){this.close_cb&&this.close_cb()}.bind(this),Utils.TI18N("\u53d6\u6d88"),null,null,null,e)}else this.close_cb&&this.close_cb()},onChipComfirm:function(){if(this.is_show_tips){var e=Utils.TI18N("\u672c\u6b21\u732e\u796d\u7684\u788e\u7247\u6ee1\u8db3\u53ec\u5524\u82f1\u96c4\u8981\u6c42\uff0c\u732e\u796d\u540e\u53ef\u80fd\u4f1a\u5931\u53bb\u53ec\u5524\u7684\u673a\u4f1a\uff0c\u662f\u5426\u7ee7\u7eed\uff1f"),i={};i.title=Utils.TI18N("\u788e\u7247\u732e\u796d"),i.delayS=5,i.extend_str=Utils.TI18N("<on click='handler'><u>\u524d\u5f80\u53ec\u5524\u82f1\u96c4</u></on>"),i.callFunc=function(){var e=t("backpack_controller"),i=t("backpack_const");e.getInstance().openMainWindow(!0,i.item_tab_type.HERO),s.close()}.bind(this);var s=o.show(e,Utils.TI18N("\u786e\u5b9a"),function(){this.close_cb&&this.close_cb()}.bind(this),Utils.TI18N("\u53d6\u6d88"),null,null,null,i)}else this.close_cb&&this.close_cb()}});cc._RF.pop()},{backpack_const:"backpack_const",backpack_controller:"backpack_controller",common_scrollview:"common_scrollview",commonalert:"commonalert",hero_const:"hero_const",hero_event:"hero_event",pathtool:"pathtool"}],hero_reset_window:[function(t,e,i){"use strict";function s(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}cc._RF.push(e,"7daa2efbh5I7Jx/f+dWAmsi","hero_reset_window");var n=t("pathtool"),a=t("hero_const"),o=t("hero_event"),l=t("mall_controller"),r=t("mall_const"),c=t("backpack_controller"),_=t("backpack_const"),h=t("backpack_event");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=n.getPrefabPath("hero","hero_reset_window"),this.viewTag=SCENE_TAG.ui,this.win_type=WinType.Full,this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){this.cur_camp=0,this.select_heros=[],this.select_max_count=10,this.is_send_proto=!1},openCallBack:function(){var t,e=this;this.main_panel_nd=this.seekChild("main_container"),this.close_btn_nd=this.seekChild("close_btn"),this.camp_node_nd=this.seekChild("camp_node"),this.img_select_nd=this.seekChild("img_select"),this.hero_list_nd=this.seekChild("hero_list"),this.no_vedio_image_nd=this.seekChild("no_vedio_image"),this.tips_lb=this.seekChild(this.no_vedio_image_nd,"no_vedio_label",cc.Label),this.putin_btn_nd=this.seekChild("putin_btn"),this.disband_btn_nd=this.seekChild("disband_btn"),this.partner_btn_nd=this.seekChild("partner_btn"),this.tip_btn_nd=this.seekChild("tip_btn"),this.look_btn_nd=this.seekChild("look_btn"),this.hero_count_lb=this.seekChild("hero_count",cc.Label),this.input_count_lb=this.seekChild("input_count",cc.Label),this.tab_container_nd=this.seekChild("tab_container"),this.hero_tab=this.seekChild("hero_xianji"),this.debris_tab=this.seekChild("debris_xianji"),this.resolve_count_lb=this.seekChild(this.debris_tab,"resolve_count",cc.EditBox),this.redu_btn=this.seekChild(this.debris_tab,"redu_btn",cc.Button),this.add_btn=this.seekChild(this.debris_tab,"add_btn",cc.Button),this.max_btn=this.seekChild(this.debris_tab,"max_btn",cc.Button),this.debris_btn=this.seekChild(this.debris_tab,"debris_btn",cc.Button),this.redu_lb=this.redu_btn.node.getChildByName("Label").getComponent(cc.LabelOutline),this.add_lb=this.add_btn.node.getChildByName("Label").getComponent(cc.LabelOutline),this.max_lb=this.max_btn.node.getChildByName("Label").getComponent(cc.LabelOutline),this.resolve_count_lb.node.on("text-changed",function(t){this.selectChipIndex&&-1!=this.selectChipIndex?t.string.length>1&&"0"==t.string[0]?t.string=t.string.slice(1,t.string.length):(Number(t.string)>this.chipMaxNum&&(t.string=this.chipMaxNum),this.checkBtnState()):t.string="0"},this),this.redu_btn.node.on("click",this.onClickBtnRedu,this),this.add_btn.node.on("click",this.onClickBtnAdd,this),this.max_btn.node.on("click",this.onClickBtnMax,this),this.debris_btn.node.on("click",this.onDisbandChip,this);var i=(s(t={},1,Utils.TI18N("\u82f1\u96c4\u732e\u796d")),s(t,2,Utils.TI18N("\u788e\u7247\u732e\u796d")),t);this.tab_list={};for(var a=function(t){var s={};s.tab_btn=e.tab_container_nd.getChildByName("toggle"+t),s.index=t,s.toggle=s.tab_btn.getComponent(cc.Toggle),s.tab_btn.getChildByName("title").getComponent(cc.Label).string=i[t],s.tab_btn.on("toggle",function(){Utils.playButtonSound(1),this.changeSelectedTab(t)},e),e.tab_list[t]=s},o=1;o<=2;++o)a(o);this.input_count_lb.string=Utils.TI18N("\u5df2\u653e\u5165\u82f1\u96c4:0/"+this.select_max_count);var l=this.seekChild("bg",cc.Sprite);l.node.scale=2*FIT_SCALE,this.loadRes(n.getBigBg("hero/hero_reset_bg"),function(t){l.spriteFrame=t}.bind(this)),this.reset_effect=this.seekChild("play_effect1",sp.Skeleton),this.reset_effect.setCompleteListener(this.onAnimaFinish.bind(this));var r=n.getSpinePath("E24121","action");this.loadRes(r,function(t){this.reset_effect.skeletonData=t,this.reset_effect.setAnimation(0,PlayerAction.action_1,!0)}.bind(this)),this.camp_btns={};for(var c=0;c<6;c++){this.camp_btns[c]=this.camp_node_nd.getChildByName("camp_btn"+c),this.camp_btns[c].camp_tag=c;this.camp_btns[c].getComponent(cc.Sprite);this.camp_btns[c].on(cc.Node.EventType.TOUCH_END,this.didClickCamp,this)}this.close_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickCloseBtn,this),this.putin_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickPutinBtn,this),this.disband_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickDisbandBtn,this),this.partner_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickPartnerBtn,this),this.tip_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickTipBtn,this),this.look_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickLookBtn,this),this.initHeroList()},registerEvent:function(){this.addGlobalEvent(o.Del_Hero_Event,function(t){this.select_heros=[],this.updateCamp(),this.input_count_lb.string=Utils.TI18N("\u5df2\u653e\u5165\u82f1\u96c4:0/"+this.select_max_count),this.is_send_proto=!1}.bind(this)),this.addGlobalEvent(h.ADD_GOODS,function(t,e){if(t==_.Bag_Code.BACKPACK&&e&&null!=Utils.next(e)&&this.select_index==a.SacrificeType.eChipSacrifice){var i=!1;for(var s in e){var n=e[s];if(n.config&&n.config.sub_type==_.item_tab_type.HERO){i=!0;break}}i&&this.chipListCamp()}}.bind(this)),this.addGlobalEvent(h.DELETE_GOODS,function(t,e){if(this.is_send_proto=!1,t==_.Bag_Code.BACKPACK&&e&&null!=Utils.next(e)&&this.select_index==a.SacrificeType.eChipSacrifice){var i=!1;for(var s in e){var n=e[s];if(_.item_tab_type.HERO==n.config.sub_type){i=!0;break}}i&&this.chipListCamp()}}.bind(this)),this.addGlobalEvent(h.MODIFY_GOODS_NUM,function(t,e){if(this.is_send_proto=!1,t==_.Bag_Code.BACKPACK&&e&&null!=Utils.next(e)&&this.select_index==a.SacrificeType.eChipSacrifice){var i=!1;for(var s in e){var n=e[s];if(n.config&&_.item_tab_type.HERO==n.config.sub_type){i=!0;break}}i&&this.chipListCamp()}}.bind(this))},openRootWnd:function(t){this.select_index=t||a.SacrificeType.eHeroSacrifice,this.tab_list[this.select_index].toggle.check(),this.select_index==a.SacrificeType.eHeroSacrifice&&this.changeSelectedTab(this.select_index)},closeCallBack:function(){this.item_scrollview&&this.item_scrollview.deleteMe(),this.ctrl.openHeroResetWindow(!1)},updateWidgets:function(){this.updateCamp()},didClickCamp:function(t){var e=t.target.camp_tag;e!==this.cur_camp&&(this.cur_camp=e,this.img_select_nd.parent=this.camp_btns[e],this.select_index==a.SacrificeType.eHeroSacrifice?this.updateCamp():this.select_index==a.SacrificeType.eChipSacrifice&&this.chipListCamp())},onClickCloseBtn:function(t){Utils.playButtonSound(2),this.ctrl.openHeroResetWindow(!1)},initHeroList:function(){var e=t("common_scrollview"),i=cc.size(this.hero_list_nd.width,this.hero_list_nd.height);this.item_scrollview=new e,this.item_scrollview.createScroll(this.hero_list_nd,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,i,{item_class:"hero_exhibition_item",start_x:0,space_x:0,start_y:4,space_y:0,item_width:125,item_height:122,col:5,once_num:5,need_dynamic:!0},cc.v2(.5,.5))},updateCamp:function(){this.cur_role_list=Utils.deepCopy(this.model.getRestHeroListByCamp(this.cur_camp)),this.hero_count_lb.string=Utils.TI18N("\u53ef\u732e\u796d\u82f1\u96c4:"+this.cur_role_list.length),this.cur_role_list.length>0?this.no_vedio_image_nd.active=!1:(this.no_vedio_image_nd.active=!0,this.tips_lb.string="\u6682\u65e0\u53ef\u732e\u796d\u82f1\u96c4");for(var t=0;t<this.cur_role_list.length;++t)for(var e=0;e<this.select_heros.length;++e)if(this.select_heros[e].partner_id===this.cur_role_list[t].partner_id){this.cur_role_list[t].is_ui_select=!0;break}this.item_scrollview.addEndCallBack(function(){for(var t=this.item_scrollview.getItemList(),e=0;e<t.length;++e){t[e].showChipIcon(!1)}}.bind(this)),this.item_scrollview.space_y=0,this.item_scrollview.setData(this.cur_role_list,this.onClickHeroExhibiton.bind(this),{scale:.9,can_click:!0,from_type:a.ExhibitionItemType.eHeroReset}),this.input_count_lb.string=Utils.TI18N("\u5df2\u653e\u5165\u82f1\u96c4:0/"+this.select_max_count)},onClickHeroExhibiton:function(t){this.is_send_proto||(t.data.checkHeroLockTips(!0)||this.selectHero(t.data))},selectHero:function(t){if(t){var e=-1;for(var i in this.select_heros)if(this.select_heros[i].partner_id==t.partner_id){e=i;break}if(e>-1){var s=this.getListIndex(t.partner_id);this.cur_role_list[s]&&(this.cur_role_list[s].is_ui_select=!1,this.item_scrollview.updateItemData(s,this.cur_role_list[s])),this.select_heros.splice(e,1)}else if(this.select_heros.length<this.select_max_count){this.select_heros.push(t);s=this.getListIndex(t.partner_id);this.cur_role_list[s]&&(this.cur_role_list[s].is_ui_select=!0,this.item_scrollview.updateItemData(s,this.cur_role_list[s]))}else message(Utils.TI18N("\u6bcf\u6b21\u6700\u591a\u53ef\u732e\u796d"+this.select_max_count+"\u4e2a\u82f1\u96c4"));this.input_count_lb.string=Utils.TI18N("\u5df2\u653e\u5165\u82f1\u96c4:"+this.select_heros.length+"/"+this.select_max_count)}},getListIndex:function(t){for(var e in this.cur_role_list)if(this.cur_role_list[e].partner_id===t)return e;return-1},onClickPutinBtn:function(){if(Utils.playButtonSound(1),this.select_heros.length>=this.select_max_count)message(Utils.TI18N("\u6bcf\u6b21\u6700\u591a\u53ef\u732e\u796d"+this.select_max_count+"\u4e2a\u82f1\u96c4"));else{for(var t=0,e=[];this.select_heros.length<this.select_max_count&&t!=this.cur_role_list.length;){var i=this.checkHero(t);i&&(this.select_heros.push(i),e.push(i)),t++}for(var s in e){var n=this.getListIndex(e[s].partner_id);this.cur_role_list[n]&&(this.cur_role_list[n].is_ui_select=!0,this.item_scrollview.updateItemData(n,this.cur_role_list[n]))}this.input_count_lb.string=Utils.TI18N("\u5df2\u653e\u5165\u82f1\u96c4:"+this.select_heros.length+"/"+this.select_max_count),0==this.select_heros.length&&message(Utils.TI18N("\u6682\u65e0\u53ef\u653e\u5165\u7684\u82f1\u96c4"))}},checkHero:function(t){if(this.cur_role_list[t]){var e=!1;for(var i in this.select_heros)if(this.cur_role_list[t].partner_id===this.select_heros[i].partner_id){e=!0;break}if(!e&&this.cur_role_list[t].star<4&&this.cur_role_list[t].is_in_form<=0)return this.cur_role_list[t]}return null},onClickDisbandBtn:function(t){if(Utils.playButtonSound(1),!this.is_send_proto)if(this.select_heros.length>0){this.hero_list_info=[];for(var e=!1,i=0;i<this.select_heros.length;++i){var s={},n=this.select_heros[i];s.partner_id=n.partner_id,n.star>=5&&(e=!0),this.hero_list_info.push(s)}this.hero_list_info.length>0&&this.ctrl.openHeroResetOfferPanel(!0,this.hero_list_info,e,this.onCloseOfferPanel.bind(this),a.ResetType.eHeroReset)}else message(Utils.TI18N("\u6ca1\u6709\u9009\u4e2d\u82f1\u96c4"))},onCloseOfferPanel:function(){this.is_send_proto||(this.reset_effect.setAnimation(0,PlayerAction.action_2,!1),this.playEffect(),this.is_send_proto=!0,Utils.delayRun(this.main_panel_nd,1.2,function(){this.ctrl.sender11076(this.hero_list_info)}.bind(this)))},onAnimaFinish:function(t){t&&t.animation&&t.animation.name==PlayerAction.action_2&&this.reset_effect.setAnimation(0,PlayerAction.action_1,!0)},requestReset:function(){this.ctrl.sender11076(this.hero_list_info)},onClickPartnerBtn:function(){Utils.playButtonSound(1),l.getInstance().openMallPanel(!0,r.MallType.Recovery)},onClickTipBtn:function(e){Utils.playButtonSound(1);var i=Config.partner_data.data_partner_const.game_rule1.desc;t("tips_controller").getInstance().showCommonTips(i,e.touch.getLocation())},onClickLookBtn:function(){if(Utils.playButtonSound(1),this.select_heros.length>0){for(var t=[],e=0;e<this.select_heros.length;++e){var i={};i.partner_id=this.select_heros[e].partner_id,t.push(i)}t.length>0&&this.ctrl.openHeroResetReturnPanel(!0,t)}else message(Utils.TI18N("\u6ca1\u6709\u9009\u4e2d\u82f1\u96c4"))},changeSelectedTab:function(t){this.select_index=t,this.cur_camp=0,this.img_select_nd.parent=this.camp_btns[0],this.show_list=[],this.select_heros=[],t==a.SacrificeType.eHeroSacrifice?(this.hero_tab.active=!0,this.debris_tab.active=!1,this.look_btn_nd.active=!0,this.updateCamp()):t==a.SacrificeType.eChipSacrifice&&(this.hero_tab.active=!1,this.debris_tab.active=!0,this.hero_count_lb.string=Utils.TI18N("\u9009\u62e9\u4e00\u79cd\u788e\u7247\u540e,\u8bf7\u518d\u9009\u62e9\u6570\u91cf"),this.look_btn_nd.active=!1,this.selectChipIndex=-1,this.chipListCamp(),this.buttonReset())},buttonReset:function(){this.resolve_count_lb.string="0",this.checkBtnState()},chipListCamp:function(){var t;if(-1!=this.selectChipIndex){var e=this.selectChipIndex;t=this.show_list[e].id,this.selectChipIndex=-1}var i=this.getChipListByCamp(this.cur_camp);if(this.show_list=Utils.deepCopy(i),this.show_list.length>0?this.no_vedio_image_nd.active=!1:(this.no_vedio_image_nd.active=!0,this.tips_lb.string="\u6682\u65e0\u53ef\u732e\u796d\u788e\u7247"),null!=t){for(var s=0;s<this.show_list.length;++s)if(this.show_list[s].id==t){this.selectChipIndex=s,this.show_list[s].is_ui_select=!0,this.chipMaxNum=this.show_list[s].total_count;break}this.buttonReset()}this.item_scrollview.addEndCallBack(function(){for(var t=this.item_scrollview.getItemList(),e=0;e<t.length;++e){t[e].showChipIcon(!0)}}.bind(this)),this.item_scrollview.space_y=10,this.item_scrollview.setData(this.show_list,this.selectChip.bind(this),{scale:.9,can_click:!0,from_type:a.ExhibitionItemType.eHeroFuse})},getChipListByCamp:function(t){for(var e=c.getInstance().getModel().getAllBackPackArray(_.item_tab_type.HERO)||[],i=[],s=Config.partner_data.data_get_compound_info,n=0;n<e.length;++n){var a=e[n],o=a.config;if(o&&(0==t||t==o.lev)){var l={};l.id=a.id,l.bid=0,l.need_count=s[a.base_id].num,l.base_id=o.id,l.star=o.eqm_jie,l.camp_type=o.lev,l.icon=o.icon,l.total_count=a.quantity,l.quality=a.quality,l.config=o;var r=c.getInstance().getModel().checkHeroChipRedPoint(a);l.sort_order=r?1:0,a.quantity>0&&i.push(l),this.select_chip_data&&this.select_chip_data.id==l.id&&l}}var h=Utils.tableCommonSorter([["sort_order",!0],["quality",!0],["base_id",!1]]);return i.sort(h),i},selectChip:function(t){if(!this.is_send_proto&&t){null!=this.selectChipIndex&&this.selectChipIndex>-1&&this.show_list[this.selectChipIndex].base_id!=t.getData().base_id&&(this.show_list[this.selectChipIndex].is_ui_select=!this.show_list[this.selectChipIndex].is_ui_select,this.item_scrollview.updateItemData(this.selectChipIndex,this.show_list[this.selectChipIndex]));for(var e=-1,i=0;i<this.show_list.length;++i)if(this.show_list[i].base_id==t.getData().base_id){this.show_list[i].is_ui_select=!this.show_list[i].is_ui_select,this.item_scrollview.updateItemData(i,this.show_list[i]),this.show_list[i].is_ui_select&&(e=i);break}if(this.selectChipIndex=e,-1==e)this.buttonReset();else{var s=t.getData().total_count;this.setChipCount(s)}}},setChipCount:function(t){this.chipMaxNum=t,this.resolve_count_lb.string="1",this.max_btn.interactable=!0,this.max_btn.enableAutoGrayEffect=!1,this.max_lb.enabled=!0,this.checkBtnState()},onClickBtnMax:function(){this.resolve_count_lb.string=this.chipMaxNum,this.checkBtnState()},onClickBtnAdd:function(){var t=Number(this.resolve_count_lb.string);t+=1,this.resolve_count_lb.string=t,this.checkBtnState()},onClickBtnRedu:function(){var t=Number(this.resolve_count_lb.string);t-=1,this.resolve_count_lb.string=t,this.checkBtnState()},checkBtnState:function(){var t=Number(this.resolve_count_lb.string);-1==this.selectChipIndex?(this.redu_btn.interactable=!1,this.redu_btn.enableAutoGrayEffect=!0,this.add_btn.interactable=!1,this.add_btn.enableAutoGrayEffect=!0,this.max_btn.interactable=!1,this.max_btn.enableAutoGrayEffect=!0,this.redu_lb.enabled=!1,this.add_lb.enabled=!1,this.max_lb.enabled=!1):t<=0?(this.redu_btn.interactable=!1,this.redu_btn.enableAutoGrayEffect=!0,this.redu_lb.enabled=!1,this.add_btn.interactable=!0,this.add_btn.enableAutoGrayEffect=!1,this.add_lb.enabled=!0):t>=this.chipMaxNum?(this.redu_btn.interactable=!0,this.redu_btn.enableAutoGrayEffect=!1,this.redu_lb.enabled=!1,this.add_btn.interactable=!1,this.add_btn.enableAutoGrayEffect=!0,this.add_lb.enabled=!1):(this.redu_btn.interactable=!0,this.redu_btn.enableAutoGrayEffect=!1,this.redu_lb.enabled=!0,this.add_btn.interactable=!0,this.add_btn.enableAutoGrayEffect=!1,this.add_lb.enabled=!0)},onDisbandChip:function(){if(Utils.playButtonSound(1),!this.is_send_proto)if(-1!=this.selectChipIndex){var t=Number(this.resolve_count_lb.string);if(t<=0)message(Utils.TI18N("\u6ca1\u6709\u653e\u5165\u82f1\u96c4\u788e\u7247"));else if(t>this.chipMaxNum)message(Utils.TI18N("\u8d85\u8fc7\u5df2\u62e5\u6709\u788e\u7247\u4e0a\u9650"));else{for(var e=this.show_list[this.selectChipIndex],i=e.config,s=1==e.sort_order,n=_.getWhiteQualityColorStr(i.quality),o=[],l=0;l<i.value.length;++l){var r=i.value[l],h=r[0],d=r[1]||0;d*=t,null!=h&&o.push({id:h,num:d})}var u={id:e.id,bid:e.base_id,num:t};if(o.length){var m=cc.js.formatStr("\u672c\u6b21\u5206\u89e3 <color=#289b14>%s</color> \u4e2a<color=%s>\u3010%s\u3011</color>\u53ef\u83b7\u5f97\u4ee5\u4e0b\u8d44\u6e90:",t,n,i.name);this.ctrl.openHeroResetOfferPanel(!0,o,s,function(){this.reset_effect.setAnimation(0,PlayerAction.action_2,!1),this.playEffect(),this.is_send_proto=!0,Utils.delayRun(this.main_panel_nd,1.2,function(){c.getInstance().sender10522(_.Bag_Code.BACKPACK,[u])}.bind(this))}.bind(this),a.ResetType.eChipReset,m)}}}else message(Utils.TI18N("\u6ca1\u6709\u9009\u4e2d\u82f1\u96c4\u788e\u7247"))},playEffect:function(){if(null==this.play_effect2){this.play_effect2=this.seekChild("play_effect2",sp.Skeleton);var t=n.getSpinePath("E24122","action");this.loadRes(t,function(t){this.play_effect2.skeletonData=t,this.play_effect2.setAnimation(0,PlayerAction.action,!1)}.bind(this))}else this.play_effect2.setAnimation(0,PlayerAction.action,!1)}});cc._RF.pop()},{backpack_const:"backpack_const",backpack_controller:"backpack_controller",backpack_event:"backpack_event",common_scrollview:"common_scrollview",hero_const:"hero_const",hero_event:"hero_event",mall_const:"mall_const",mall_controller:"mall_controller",pathtool:"pathtool",tips_controller:"tips_controller"}],hero_rest_return_window:[function(t,e,i){"use strict";cc._RF.push(e,"88f92gEiC9G+5RYn7UoMP16","hero_rest_return_window");var s=t("pathtool"),n=t("hero_event");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("hero","hero_reset_return_panel"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Full,this.ctrl=arguments[0]},initConfig:function(){},openCallBack:function(){this.list_view_nd=this.seekChild("list_view"),this.mask_bg_nd=this.seekChild("mask_bg"),this.close_btn_nd=this.seekChild("close_btn"),this.confirm_btn_nd=this.seekChild("confirm_btn"),this.initListView(),this.mask_bg_nd.on(cc.Node.EventType.TOUCH_END,this.onClickCloseBtn,this),this.close_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickCloseBtn,this),this.confirm_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickCloseBtn,this)},registerEvent:function(){this.addGlobalEvent(n.Hero_Reset_Look_Event,function(t){t&&this.setItemsData(t)}.bind(this))},openRootWnd:function(t){t.item_list&&this.ctrl.sender11075(t.item_list)},closeCallBack:function(){},initListView:function(){var e=t("common_scrollview"),i=cc.size(this.list_view_nd.width,this.list_view_nd.height);this.item_scrollview=new e,this.item_scrollview.createScroll(this.list_view_nd,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,i,{item_class:"backpack_item",start_x:0,space_x:4,start_y:0,space_y:0,item_width:150,item_height:136,col:4,once_num:5,need_dynamic:!0},cc.v2(.5,.5))},setItemsData:function(t){var e=[];for(var i in t){var s={};s.bid=t[i].id,s.num=t[i].num,e.push(s)}this.item_scrollview.setData(e,null,{is_show_tips:!0,is_other:!1})},onClickCloseBtn:function(){this.ctrl.openHeroResetReturnPanel(!1)}});cc._RF.pop()},{common_scrollview:"common_scrollview",hero_event:"hero_event",pathtool:"pathtool"}],hero_skin_tips_window:[function(t,e,i){"use strict";cc._RF.push(e,"f9218sqGm1KHYM7KHtf+aLL","hero_skin_tips_window");var s=t("pathtool"),n=t("partner_const"),a=t("baserole"),o=t("backpack_const"),l=t("backpack_controller");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("hero","hero_skin_tips_panel"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Tips,this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){this.attr_item_list={}},openCallBack:function(){this.background=this.root_wnd.getChildByName("background"),this.main_panel=this.root_wnd.getChildByName("main_panel"),this.main_panel_size=this.main_panel.getContentSize(),this.bg=this.main_panel.getChildByName("bg"),this.bg_size=this.bg.getContentSize(),this.container=this.main_panel.getChildByName("container"),this.station_img=this.container.getChildByName("station_img").getComponent(cc.Sprite),this.model_nodel=this.container.getChildByName("model_nodel"),this.attr_panel=this.container.getChildByName("attr_panel"),this.attr_panel.getChildByName("label").getComponent(cc.Label).string=Utils.TI18N("\u7279\u6b8a\u5c5e\u6027"),this.name=this.container.getChildByName("name").getComponent(cc.Label),this.close_btn=this.container.getChildByName("close_btn"),this.desc_label=this.container.getChildByName("scroll_view").getChildByName("mask").getChildByName("content").getComponent(cc.RichText),this.scroll_view=this.container.getChildByName("scroll_view"),this.scroll_size=this.scroll_view.getContentSize(),this.btn_list={},this.tab_panel=this.container.getChildByName("tab_panel");for(var t=1;t<4;++t){var e=this.tab_panel.getChildByName("tab_btn_"+t);if(e){var i={};i.btn=e,i.label=e.getChildByName("Label").getComponent(cc.Label),this.btn_list[t]=i}}},registerEvent:function(){this.background.on("touchend",this.onClickCloseBtn,this),this.close_btn.on("click",this.onClickCloseBtn,this)},onClickCloseBtn:function(){Utils.playButtonSound(2),this.ctrl.openHeroSkinTipsPanel(!1)},openRootWnd:function(t){var e=t.data,i=t.open_type,s=t.partner;this.cloth_type=i||n.EqmTips.normal,this.data=e,this.partner=s,this.partner&&(this.partner_id=this.partner.partner_id);var a=null;a="number"==typeof e?Utils.getItemConfig(e):e.config?e.config:e,this.item_config=a,null!=this.item_config&&(this.initData(),this.cloth_type==n.EqmTips.backpack&&this.updateBtnList())},initData:function(){this.name.string=this.item_config.name;var t=s.getUIIconPath("bigbg/hero","hero_skin_tips");null!=this.record_station_res&&this.record_station_res==t||(this.record_station_res=t,this.loadRes(t,function(t){this.station_img.spriteFrame=t}.bind(this)));var e=101;this.item_config.client_effect[0]&&(e=this.item_config.client_effect[0][0]||101),this.skin_id=e,this.updateSpine(e);var i=this.updateAttrInfo(e);this.desc_label.string=this.item_config.desc;var a,o=this.desc_label.node.getContentSize(),l=Math.max(o.height,this.scroll_size.height);this.scroll_view.setContentSize(cc.size(this.scroll_size.width,l)),this.cloth_type==n.EqmTips.normal?(this.tab_panel.active=!1,a=this.main_panel_size.height-(i+54),this.container.y=-365+(a+.5*(i+54))):(this.tab_panel.active=!0,a=this.main_panel_size.height-i,this.container.y=-365+(a+.5*i)),this.scroll_view.y=this.scroll_view.y-i,this.tab_panel.y=this.tab_panel.y-i,this.bg.setContentSize(cc.size(this.main_panel_size.width,a)),this.main_panel.setContentSize(cc.size(this.main_panel_size.width,a))},updateSpine:function(t){if(!this.record_spine_skin_id||this.record_spine_skin_id!=t){if(this.record_spine_skin_id=t,!this.spine){this.spine=new a,this.spine.setParent(this.model_nodel),this.spine.setPosition(0,166),this.spine.node.opacity=0,this.spine.showShadowUI(!0);var e=cc.fadeIn(.2);this.spine.node.runAction(e)}this.spine.setData(a.type.skin,t,PlayerAction.show,!0,.72,{scale:1/.7})}},updateAttrInfo:function(t){var e=this,i=Config.partner_skin_data.data_skin_info[t],s=0;if(i){var n=this.attr_panel.getContentSize(),a=.25*-n.width,o=.25*n.width;i.skin_attr.length<=2&&(s=40);for(var l=function(t){var s=i.skin_attr[t],n=0,l=-(20+40*Math.floor(t/2));n=0==t%2?a:o,null==e.attr_item_list[t]?e.attr_item_list[t]=e.createAttrItem(n,l):(e.attr_item_list[t].bg.active=!0,e.attr_item_list[t].key_label.node.active=!0);var r=Utils.commonGetAttrInfoByKeyValue(s[0],s[1]),c=r.res,_=r.attr_name,h=r.attr_val;e.loadRes(c,function(e){this.attr_item_list[t].attr.spriteFrame=e}.bind(e)),e.attr_item_list[t].key_label.string=_+" + "+h},r=0;r<i.skin_attr.length;++r)l(r)}return s},createAttrItem:function(t,e){var i={},n=cc.size(230,35),a=s.getUIIconPath("common","common_90058"),o=new cc.Node;o.setPosition(t,e);var l=o.addComponent(cc.Sprite);l.type=cc.Sprite.Type.SLICED,l.sizeMode=cc.Sprite.SizeMode.CUSTOM,o.setContentSize(n),this.loadRes(a,function(t){l.spriteFrame=t}.bind(this)),this.attr_panel.addChild(o),o.opacity=128,i.bg=o,i.key_label=(new cc.Node).addComponent(cc.Label),i.key_label.fontSize=22,i.key_label.lineHeight=26,i.key_label.node.color=new cc.Color(224,191,152),i.key_label.node.setAnchorPoint(0,.5),i.key_label.node.setPosition(t-n.width/2+40,e-2),this.attr_panel.addChild(i.key_label.node);var r=(new cc.Node).addComponent(cc.Sprite);return r.node.setAnchorPoint(0,.5),r.node.setPosition(t-n.width/2+10,e),i.attr=r,this.attr_panel.addChild(r.node),i},updateBtnList:function(){var t=this;if(this.item_config){for(var e in this.btn_list){var i=this.btn_list[e];i.btn&&(i.btn.active=!1)}var s=this.item_config.tips_btn||[];if(1==Utils.getArrLen(s)){var n=this.btn_list[1],a=this.btn_list[3];n.btn&&a.btn&&(n.btn.x=a.btn.x)}for(var l=function(e){var i=s[e];if(e>2)return"break";var n=t.btn_list[e+1];if(n&&n.btn){var a=o.tips_btn_title[i]||"";n.label.string=a,n.btn.active=!0,n.btn.on("click",function(){this.clickBtn(i)},t)}},r=0;r<s.length;++r){if("break"===l(r))break}}},clickBtn:function(e){if(this.item_config&&this.skin_id){if(e==o.tips_btn_type.source)this.item_config.source.length>0?l.getInstance().openTipsSource(!0,this.data):message(Utils.TI18N("\u6682\u65f6\u6ca1\u6709\u6765\u6e90"));else if(e==o.tips_btn_type.goods_use){var i=this.model.getHeroSkinInfoBySkinID(this.skin_id);if(null!=i&&0==i){var n=Config.partner_skin_data.data_skin_info;if(n&&n[this.skin_id]&&this.item_config.client_effect[0]){var a=this.item_config.client_effect[0][2]||Config.item_data.data_assets_label2id.skin_debris,r=Utils.getItemConfig(a),c=s.getIconPath("item",r.icon),_=this.item_config.client_effect[0][3]||0,h=t("commonalert"),d=cc.js.formatStr(Utils.TI18N("\u5f53\u524d\u60a8\u5df2\u6c38\u4e45\u62e5\u6709\u8be5\u76ae\u80a4\uff0c\u91cd\u590d\u6fc0\u6d3b\u4f7f\u7528\uff0c\u5c06\u8f6c\u5316\u4e3a <img src='%s'/><color=#289b14> %s </color>\uff0c\u662f\u5426\u7ee7\u7eed\u4f7f\u7528\uff1f"),r.icon,_),u=function(){l.getInstance().sender10515(this.data.id||0,1)}.bind(this),m={};m.title=Utils.TI18N("\u4f7f\u7528\u76ae\u80a4"),m.align=cc.macro.TextAlignment.LEFT,m.resArr=[c],h.show(d,Utils.TI18N("\u4f7f\u7528"),u,Utils.TI18N("\u53d6\u6d88"),null,null,null,m)}}else l.getInstance().sender10515(this.data.id||0,1)}this.onClickCloseBtn()}},closeCallBack:function(){this.spine&&(this.spine.deleteMe(),this.spine=null),this.ctrl.openHeroSkinTipsPanel(!1)}});cc._RF.pop()},{backpack_const:"backpack_const",backpack_controller:"backpack_controller",baserole:"baserole",commonalert:"commonalert",partner_const:"partner_const",pathtool:"pathtool"}],hero_skin_window:[function(t,e,i){"use strict";cc._RF.push(e,"0ad81sQHl9CU6uwSVzuqOoK","hero_skin_window");var s=t("pathtool"),n=t("hero_controller"),a=t("common_scrollview_single"),o=t("backpack_const"),l=t("backpack_controller"),r=t("commonalert"),c=t("action_controller"),_=t("mall_const"),h=t("mall_controller"),d=t("baserole"),u=t("hero_event"),m=t("mainui_controller");t("mainui_const"),cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("hero","hero_skin_window"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Full},initConfig:function(){this.can_click_btn=!0,this.ctrl=n.getInstance(),this.model=this.ctrl.getModel(),this.color_1=new cc.Color(100,50,35,255)},openCallBack:function(){this.background=this.seekChild("background",cc.Sprite),this.background.node.scale=FIT_SCALE,this.loadRes(s.getBigBg("hero_draw_bg",null,"hero"),function(t){this.background.spriteFrame=t}.bind(this)),this.main_container=this.seekChild("main_container"),this.hero_name_lb=this.seekChild("hero_name",cc.Label),this.hero_name_lb.string="",this.title_name_lb=this.seekChild("title_name",cc.Label),this.title_name_lb.string="",this.hero_draw_icon_nd=this.seekChild(this.main_container,"hero_draw_icon"),this.hero_draw_icon_sp=this.seekChild(this.main_container,"hero_draw_icon",cc.Sprite),this.hero_draw_icon_x=this.hero_draw_icon_nd.x,this.hero_draw_icon_y=this.hero_draw_icon_nd.y,this.bottom_panel=this.seekChild(this.main_container,"bottom_panel"),this.hero_panel=this.seekChild(this.bottom_panel,"hero_panel"),this.hero_panel_x=this.hero_panel.x,this.hero_panel.x+=2*cc.winSize.width,this.hero_panel.active=!0,this.mode_node=this.seekChild(this.hero_panel,"model_node"),this.hero_panel_bg_nd=this.seekChild(this.hero_panel,"bg"),this.line_nd=this.seekChild(this.hero_panel,"line"),this.name_lb=this.seekChild(this.hero_panel,"name",cc.Label),this.attr_panel=this.seekChild(this.bottom_panel,"attr_panel"),this.attr_panel_x=this.attr_panel.x,this.attr_panel.x+=2*cc.winSize.width,this.attr_panel.active=!0,this.seekChild(this.attr_panel,"time_key",cc.Label).string=Utils.TI18N("\u6709\u6548\u65f6\u95f4:"),this.seekChild(this.attr_panel,"attr_key",cc.Label).string=Utils.TI18N("\u5c5e\u6027\u52a0\u6210:"),this.time_val_lb=this.seekChild(this.attr_panel,"time_val",cc.Label),this.attr_item_list={},this.show_btn=this.seekChild(this.bottom_panel,"show_btn"),this.show_btn_icon_nd=this.seekChild(this.show_btn,"icon"),this.left_btn=this.seekChild(this.bottom_panel,"left_btn"),this.right_btn=this.seekChild(this.bottom_panel,"right_btn"),this.lay_scrollview=this.seekChild(this.bottom_panel,"lay_scrollview")},registerEvent:function(){Utils.onTouchEnd(this.left_btn,function(){this.ctrl.openHeroSkinWindow(!1)}.bind(this),2),Utils.onTouchEnd(this.right_btn,function(){if(this.hero_vo&&this.skin_data_list){var t=this.skin_data_list[this.select_skin_index];t&&t.is_skin_data?this.hero_vo.use_skin!=t.skin_id&&this.ctrl.sender11019(this.hero_vo.partner_id,t.skin_id):0!=this.hero_vo.use_skin&&this.ctrl.sender11019(this.hero_vo.partner_id,0)}}.bind(this),1),Utils.onTouchEnd(this.show_btn,function(){if(this.hero_vo&&this.skin_data_list)if(this.is_show_attr)this.is_show_attr=!1,this.attr_panel.x+=2*cc.winSize.width,this.hero_panel.x=this.hero_panel_x,this.updateHeroInfo(1),this.show_btn_icon_nd&&this.show_btn_icon_nd.setScale(-1);else{this.is_show_attr=!0;var t=this.skin_data_list[this.select_skin_index];this.hero_panel.x+=2*cc.winSize.width,t&&t.is_skin_data?(this.attr_panel.x=this.attr_panel_x,this.updateAttrInfo()):this.attr_panel.x+=2*cc.winSize.width,this.show_btn_icon_nd&&this.show_btn_icon_nd.setScale(1)}}.bind(this),2),this.addGlobalEvent(u.Hero_Skin_Info_Event,function(){if(null!=this.select_skin_index&&this.skin_data_list){for(var t in this.skin_data_list){var e=this.skin_data_list[t];this.model.isUnlockHeroSkin(e.skin_id)?e.is_lock=!1:e.is_lock=!0}null!=this.use_skin_index?(this.updateSkinList(this.use_skin_index),this.use_skin_index=null):this.updateSkinList(this.select_skin_index)}},this)},openRootWnd:function(t){if(t){this.hero_vo=t;var e=Config.partner_skin_data.data_partner_bid_info[this.hero_vo.bid];if(e){var i=Config.partner_data.data_partner_base[this.hero_vo.bid];for(var s in i&&(this.hero_name_lb.string=i.name),this.skin_data_list=[],e){var n=e[s],a={is_skin_data:!0};this.model.isUnlockHeroSkin(n.skin_id)?a.is_lock=!1:a.is_lock=!0,a.skin_id=s,a.config=Config.partner_skin_data.data_skin_info[n.skin_id],this.skin_data_list.push(a)}this.skin_data_list.sort(Utils.tableLowerSorter(["skin_id"])),this.skin_data_list.unshift(this.hero_vo);var o=0,l=this.hero_vo.use_skin||0;if(0!=l)for(var r in this.skin_data_list){this.skin_data_list[r].skin_id==l&&(o=r)}this.is_show_attr=!0,this.updateSkinList(o)}}},updateSkinList:function(t){if(null==this.scroll_view){var e=this.lay_scrollview.getContentSize(),i={start_x:0,space_x:0,start_y:0,space_y:0,item_width:120,item_height:120,row:1,col:1,need_dynamic:!0};this.scroll_view=new a,this.scroll_view.createScroll(this.lay_scrollview,cc.v2(0,0),ScrollViewDir.horizontal,ScrollViewStartPos.top,e,i,cc.v2(.5,.5)),this.scroll_view.registerScriptHandlerSingle(this.createNewCell.bind(this),ScrollViewFuncType.CreateNewCell),this.scroll_view.registerScriptHandlerSingle(this.numberOfCells.bind(this),ScrollViewFuncType.NumberOfCells),this.scroll_view.registerScriptHandlerSingle(this.updateCellByIndex.bind(this),ScrollViewFuncType.UpdateCellByIndex),this.scroll_view.registerScriptHandlerSingle(this.onCellTouched.bind(this),ScrollViewFuncType.OnCellTouched);var s=Math.floor(e.width/i.item_width);this.skin_data_list.length<=s&&this.scroll_view.setClickEnabled(!1)}t=t||0;this.scroll_view.reloadData(t)},createNewCell:function(t,e){var i=ItemsPool.getInstance().getItem("backpack_item");return i.initConfig(!1,1,!1,!0),i.show(),i.setDefaultTip(),i.setQualityBG(o.quality.orange),i.addCallBack(function(){this.onCellTouched(i)}.bind(this)),i},numberOfCells:function(){return this.skin_data_list?this.skin_data_list.length:0},updateCellByIndex:function(t,e){this.startUpdate(100,function(){t.index=e;var i=this.skin_data_list[e];if(i){var n=null;if(i.is_skin_data)n=s.getHeadRes(i.config.head_id),t.setItemIcon(n),i.is_lock?t.setItemIconUnEnabled(!0):t.setItemIconUnEnabled(!1);else{var a=Utils.getNorKey(i.bid,i.star),o=gdata("partner_data","data_partner_star",[a]);o&&(n=s.getHeadRes(o.head_id),t.setItemIcon(n)),t.setItemIconUnEnabled(!1)}null!=this.select_skin_index&&this.select_skin_index==e?t.setSelected(!0):t.setSelected(!1)}}.bind(this),1)},onCellTouched:function(t){if(this.can_click_btn&&null!=t.index){var e=t.index,i=this.skin_data_list[e];i&&(i.is_skin_data&&i.is_lock?this.setLockInfo(i,e):(null!=this.select_cell&&this.select_cell.setSelected(!1),this.select_cell=t,this.select_cell.setSelected(!0),this.updateSelectSkinInfo(e)))}},updateSelectSkinInfo:function(t){if(this.select_skin_index||this.select_skin_index!=t){this.select_skin_index=t;var e=this.skin_data_list[this.select_skin_index],i="";if(e.config)i=e.config.skin_name;else{var s=gdata("partner_data","data_partner_library",[e.bid]);s&&(i=s.title)}this.title_name_lb.string=i,e.is_skin_data?(this.skin_config=e.config,this.is_show_attr?(this.attr_panel.x=this.attr_panel_x,this.updateAttrInfo()):this.attr_panel.x+=2*cc.winSize.width):(this.skin_config=gdata("partner_data","data_partner_library",[e.bid]),this.attr_panel.x+=2*cc.winSize.width),this.updateDrawInfo(),this.is_show_attr||this.updateHeroInfo(2)}},setLockInfo:function(t,e){var i={};for(var s in t.config.item_id_list){i[t.config.item_id_list[s]]=!0}var n=null,a=[],r=l.getInstance().getModel().getBagItemList(o.Bag_Code.BACKPACK)||{};for(var c in r){var _=r[c];if(_&&_.config&&i[_.config.id]){var h={};if(_.config.client_effect[0]&&_.config.client_effect[0][1]?h.time=_.config.client_effect[0][1]:h.time=1,0==h.time){n=_;break}h.item_info=_,a.push(h)}}n?this.useSkinItemByID(n,e):a.length>0?(a.sort(Utils.tableUpperSorter(["time"])),this.useSkinItemByID(a[0].item_info,e)):this.gotoSkinAction(t.config)},useSkinItemByID:function(t,e){if(t.config){var i=o.getWhiteQualityColorStr(t.config.quality),s=cc.js.formatStr(Utils.TI18N("\u5df2\u62e5\u6709\u89e3\u9501\u9053\u5177,\u662f\u5426\u6d88\u8017<div fontcolor=#%s>%s</div>\u89e3\u9501\u8be5\u76ae\u80a4\uff1f"),i,t.config.name),n=function(){this.use_skin_index=e,l.getInstance().sender10515(t.id,1)}.bind(this);r.show(s,Utils.TI18N("\u786e\u5b9a"),n,Utils.TI18N("\u53d6\u6d88"),null,2,null,{title:Utils.TI18N("\u89e3\u9501\u76ae\u80a4")})}},gotoSkinAction:function(t){var e=function(){if(0!=t.action_bid&&c.getInstance().checkActionExistByActionBid(t.action_bid))return Utils.closeAllWindow(),void this.startUpdate(100,function(){c.getInstance().openActionMainPanel(!0,null,t.action_bid)}.bind(this),1);if(null!=t.main_id&&m.getInstance().getFucntionIconVoById(t.main_id))return Utils.closeAllWindow(),void this.startUpdate(100,function(){c.getInstance().openBuySkinWindow(!0)}.bind(this),1);var e=Config.exchange_data.data_shop_list[_.MallType.HeroSkin];1==t.is_shop&&e&&0!=e.sort?h.getInstance().openMallPanel(!0,_.MallType.HeroSkin):message(Utils.TI18N("\u6682\u65e0\u8be5\u76ae\u80a4\u83b7\u53d6\u9014\u5f84"))}.bind(this),i=Utils.TI18N("\u5f53\u524d\u6682\u672a\u62e5\u6709\u8be5\u76ae\u80a4,\u662f\u5426\u524d\u5f80\u83b7\u53d6\uff1f");r.show(i,Utils.TI18N("\u786e\u5b9a"),e,Utils.TI18N("\u53d6\u6d88"),null,null,null,{title:Utils.TI18N("\u89e3\u9501\u76ae\u80a4")})},updateDrawInfo:function(){if(this.skin_config){var t=this.skin_config.draw_res;if(null!=t&&""!=t||(t=this.getDefaultDrawRes()),t){var e=s.getIconPath("herodraw/herodrawres",t);if(this.hero_draw_icon_sp&&this.loadRes(e,function(t){this.hero_draw_icon_sp.spriteFrame=t}.bind(this)),0==this.skin_config.scale?this.hero_draw_icon_nd.scale=1:this.hero_draw_icon_nd.scale=this.skin_config.scale/100,this.skin_config.draw_offset&&null!=Utils.next(this.skin_config.draw_offset)){var i=this.skin_config.draw_offset[0][0]||0,n=this.skin_config.draw_offset[0][1]||0;this.hero_draw_icon_nd.setPosition(this.hero_draw_icon_x+i,this.hero_draw_icon_y+n)}}}},updateAttrInfo:function(){var t=this;if(this.skin_config){var e=this.model.getHeroSkinInfoBySkinID(this.skin_config.skin_id);if(null!=e)if(0==e)this.time_val_lb.string=Utils.TI18N("\u6c38\u4e45"),this.time_val_lb.node.stopAllActions();else{var i=e-gcore.SmartSocket.getTime();i<=0?this.time_val_lb.string=Utils.TI18N("00:00:00"):Utils.commonCountDownTime(this.time_val_lb,i)}var s=cc.size(150,35);for(var n in this.attr_item_list){var a=this.attr_item_list[n];a.bg_sp.node.active=!1,a.key_rt.node.active=!1}var o=function(e){var i=t.skin_config.skin_attr[e],n=200+150*(e-1)+150;null==t.attr_item_list[e]?t.attr_item_list[e]=t.createAttrItem(n,27,s):(t.attr_item_list[e].bg_sp.node.active=!0,t.attr_item_list[e].key_rt.node.active=!0);var a=Utils.commonGetAttrInfoByKeyValue(i[0],i[1]),o=cc.js.formatStr("<img src='%s'/> %s + %s",a.icon,a.attr_name,a.attr_val);t.attr_item_list[e].key_rt.string=o,t.loadRes(a.res,function(t){this.attr_item_list[e].key_rt.spriteFrame=t}.bind(t))};for(var l in this.skin_config.skin_attr)o(l)}},createAttrItem:function(t,e,i){var n={},a=s.getUIIconPath("hero","partner_skin_03");return n.bg_sp=Utils.createImage(this.attr_panel,null,t,e,cc.v2(0,.5),null,0,!0),this.loadRes(a,function(t){n.bg_sp.spriteFrame=t}),n.bg_sp.node.setContentSize(i),n.key_rt=Utils.createRichLabel(22,this.color_1,cc.v2(0,.5),cc.v2(t+10,e),24,380,this.attr_panel,"left"),n},updateHeroInfo:function(t){var e=this.skin_data_list[this.select_skin_index],i=0,s=this.skin_data_list[0];e.is_skin_data&&(gdata("partner_skin_data","data_hero_info",[e.skin_id]),i=e.config.skin_id),this.updateSpine(s,i,t)},updateSpine:function(t,e,i){if(null==this.record_skin_id||this.record_skin_id!=e){this.record_skin_id=e;var s=function(){if(!this.spine){this.spine=new d,this.spine.setParent(this.mode_node),this.spine.setPosition(0,104),this.spine.setData(d.type.partner,t,PlayerAction.show,!0,.45,{skin_id:e}),this.spine.showShadowUI(!0);var i=cc.fadeIn(.2);this.spine.node.runAction(i)}}.bind(this),n=function(){this.spine.node.stopAllActions(),this.spine.node.removeFromParent(),this.spine=null,this.can_click_btn=!0,s()}.bind(this);if(this.spine)if(this.can_click_btn=!1,2==i){var a=cc.fadeOut(.2);this.spine.node.runAction(cc.sequence(a,cc.callFunc(n)))}else n();else s()}},getDefaultModeRes:function(){var t=this.getPartnerConfig()[0],e=this.getPartnerConfig()[1];if(t&&e)return e.res_id},getDefaultDrawRes:function(){var t=this.getPartnerConfig()[0],e=this.getPartnerConfig()[1];if(t&&e)return t.draw_res},getPartnerConfig:function(){if(this.hero_vo){if(null==this.partner_config&&(this.partner_config=Config.partner_data.data_partner_base[this.hero_vo.bid]),this.partner_config&&null==this.star_config){var t=Utils.getNorKey(this.partner_config.bid,this.partner_config.init_star);this.star_config=gdata("partner_data","data_partner_star",[t])}return[this.partner_config,this.star_config]}},closeCallBack:function(){this.scroll_view&&(this.scroll_view.deleteMe(),this.scroll_view=null),this.time_val_lb.node.stopAllActions(),this.ctrl.openHeroSkinWindow()}});cc._RF.pop()},{action_controller:"action_controller",backpack_const:"backpack_const",backpack_controller:"backpack_controller",baserole:"baserole",common_scrollview_single:"common_scrollview_single",commonalert:"commonalert",hero_controller:"hero_controller",hero_event:"hero_event",mainui_const:"mainui_const",mainui_controller:"mainui_controller",mall_const:"mall_const",mall_controller:"mall_controller",pathtool:"pathtool"}],hero_smroom_info_window:[function(t,e,i){"use strict";cc._RF.push(e,"d1eb3R0M45EZJMr6zF/a3sU","hero_smroom_info_window");var s=t("pathtool"),n=t("hero_controller"),a=t("hero_const"),o=t("skill_item");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("hero","hero_smroom_info_window"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Full},initConfig:function(){this.select_index=0,this.max_index=2,this.skill_item_list={},this.skill_container_size=cc.size(580,130),this.ctrl=n.getInstance(),this.model=this.ctrl.getModel(),this.default_item=0},openCallBack:function(){this.main_container=this.seekChild("main_container"),this.close_btn=this.seekChild("close_btn"),this.background_nd=this.seekChild("background"),this.background_nd.scale=FIT_SCALE,this.loadRes(s.getBigBg("hero/hero_draw_bg"),function(t){this.background_nd.getComponent(cc.Sprite).spriteFrame=t}.bind(this)),this.hero_name_bg_nd=this.seekChild(this.main_container,"hero_name_bg"),this.hero_draw_icon_sp=this.seekChild(this.main_container,"hero_draw_icon",cc.Sprite),cc.log("\u8fd9\u91cc\u662f\u7acb\u7ed8\u7ec4\u4ef6\uff1a",this.hero_draw_icon_sp),this.hero_draw=this.hero_draw_icon_sp.node,this.hero_spine=this.seekChild(this.main_container,"hero_spine").getComponent("sp.Skeleton"),console.log("this.hero_spine:",this.hero_spine),this.hero_name_lb=this.seekChild(this.hero_name_bg_nd,"hero_name",cc.Label),this.title_name_lb=this.seekChild(this.hero_name_bg_nd,"title_name",cc.Label),this.title_bg_nd=this.seekChild(this.hero_name_bg_nd,"title_bg"),this.box_6_nd=this.seekChild(this.main_container,"box_6"),this.attr_btn=this.seekChild(this.box_6_nd,"attr_btn"),this.story_btn=this.seekChild(this.box_6_nd,"story_btn"),this.left_btn_nd=this.seekChild(this.box_6_nd,"left_btn"),this.left_btn=this.seekChild(this.box_6_nd,"left_btn",cc.Button),this.right_btn_nd=this.seekChild(this.box_6_nd,"right_btn"),this.right_btn=this.seekChild(this.box_6_nd,"right_btn",cc.Button),this.light_1_sp=this.seekChild(this.box_6_nd,"light_1",cc.Sprite),this.light_2_sp=this.seekChild(this.box_6_nd,"light_2",cc.Sprite),this.page_view_nd=this.seekChild(this.box_6_nd,"pageview"),this.page_view_pv=this.seekChild(this.box_6_nd,"pageview",cc.PageView);var t=this.seekChild(this.page_view_nd,"view"),e=this.seekChild(t,"content"),i=this.seekChild(e,"page_1"),n=this.seekChild(e,"page_2");this.skill_panel_nd=this.seekChild(i,"skill_panel"),this.attr_name_lb=this.seekChild(this.skill_panel_nd,"attr_name",cc.Label),this.type_name_lb=this.seekChild(this.skill_panel_nd,"type_name",cc.Label),this.item_content=this.seekChild(this.skill_panel_nd,"content"),this.voice_panel_nd=this.seekChild(n,"voice_panel"),this.richlabel_rt=this.seekChild(this.voice_panel_nd,"richlabel",cc.RichText),this.voice_btn_nd=this.seekChild(this.voice_panel_nd,"voice_btn"),this.item_0=this.seekChild(this.main_container,"item_0"),this.item_1=this.seekChild(this.main_container,"item_1"),this.item_2=this.seekChild(this.main_container,"item_2"),this.item_3=this.seekChild(this.main_container,"item_3"),this.normal_btn=this.seekChild(this.main_container,"normal"),this.hdress_btn=this.seekChild(this.main_container,"hdress"),this.video_btn=this.seekChild(this.main_container,"video"),cc.log(this.item_0,this.item_1,this.item_2,this.item_3),this.adaptationScreen()},adaptationScreen:function(){},registerEvent:function(){Utils.onTouchEnd(this.close_btn,function(){this.ctrl.openHeroSMRoomInfoWindow(!1)}.bind(this),2),Utils.onTouchEnd(this.attr_btn,function(){this.onClickAttrBtn()}.bind(this),1),Utils.onTouchEnd(this.story_btn,function(){this.onClickStoryBtn()}.bind(this),1),Utils.onTouchEnd(this.left_btn_nd,function(){this.onClickLeftBtn()}.bind(this),1),Utils.onTouchEnd(this.right_btn_nd,function(){this.onClickRightBtn()}.bind(this),1),Utils.onTouchEnd(this.voice_btn_nd,function(){this.onClickVoiceBtn()}.bind(this),1),Utils.onTouchEnd(this.item_0,function(){this.onClickItem(0)}.bind(this),1),Utils.onTouchEnd(this.item_1,function(){this.onClickItem(1)}.bind(this),1),Utils.onTouchEnd(this.item_2,function(){this.onClickItem(2)}.bind(this),1),Utils.onTouchEnd(this.item_3,function(){this.onClickItem(3)}.bind(this),1),Utils.onTouchEnd(this.hero_draw,function(){this.onHeroClick()}.bind(this),1),Utils.onTouchEnd(this.normal_btn,function(){this.onClickNormal()}.bind(this),1),Utils.onTouchEnd(this.hdress_btn,function(){this.onClickHdress()}.bind(this),1),Utils.onTouchEnd(this.hero_spine.node,function(){this.playTouchHero()}.bind(this),1),Utils.onTouchEnd(this.video_btn,function(){this.onClickVideo()}.bind(this),1),this.page_view_pv.node.on("page-turning",function(){var t=this.page_view_pv.getCurrentPageIndex();this.setBtnVisable(t)},this)},onClickItem:function(t){if(t==this.default_item)this.useItem(t);else{var e=this.seekChild(this.main_container,"item_"+this.default_item),i=this.seekChild(e,"item_bg");i.active=!1,e=this.seekChild(this.main_container,"item_"+t),(i=this.seekChild(e,"item_bg")).active=!0,cc.log("SM \u9053\u5177\u88ab\u9009\u62e9\u4e86\uff1a",t),this.default_item=t}},onHeroClick:function(){this.default_item||(this.default_item=0),this.useItem(this.default_item)},useItem:function(t){cc.log("SM \u9053\u5177\u3010"+t+"\u3011\u88ab\u4f7f\u7528\u4e86\u3002")},onClickAttrBtn:function(){if(null!=this.partner_config){var t=gdata("partner_data","data_partner_pokedex",[this.partner_config.bid]);if(t&&t[0]){var e=t[0].star||1;this.ctrl.openHeroInfoWindowByBidStar(this.partner_config.bid,e,function(){this.setVisible(!0)}.bind(this))}this.setVisible(!1)}},onClickStoryBtn:function(){if(null!=this.partner_config&&null!=this.library_config)if(null!=this.library_config.story&&""!=this.library_config.story){var t=cc.js.formatStr("%s %s",this.library_config.title,this.partner_config.name),e=this.library_config.story;this.ctrl.openHeroLibraryStoryPanel(!0,t,e)}else message(Utils.TI18N("\u8be5\u82f1\u96c4\u6682\u65e0\u4f20\u8bb0"))},onClickVoiceBtn:function(){if(this.partner_config&&this.library_config&&this.partner_config.voice&&""!=this.partner_config.voice){var t=this.partner_config.voice,e=this.partner_config.voice_time;this.ctrl.onPlayHeroVoice(t,e)}},onClickLeftBtn:function(){var t=this.page_view_pv.getCurrentPageIndex()-1;this.page_view_pv.scrollToPage(t),this.setBtnVisable(t)},onClickRightBtn:function(){var t=this.page_view_pv.getCurrentPageIndex()+1;this.page_view_pv.scrollToPage(t),this.setBtnVisable(t)},setBtnVisable:function(t){t<1?(Utils.setGreyButton(this.left_btn,!0),Utils.setGreyButton(this.right_btn,!1),this.light_1_sp.node.x=-10,this.light_2_sp.node.x=10):(Utils.setGreyButton(this.left_btn,!1),Utils.setGreyButton(this.right_btn,!0),this.light_1_sp.node.x=10,this.light_2_sp.node.x=-10)},onClickNormal:function(){console.log("Normal click."),this.switch2HeroFullPainting()},onClickHdress:function(){console.log("Hdress click."),this.switch2HeroHAnimation()},onClickVideo:function(){console.log("Video click.")},openRootWnd:function(t,e){cc.log("enter hero_smroom_info_window.js and call openRootWnd!! bid==>",t);var i=gdata("partner_data","data_partner_base",[t]);cc.log(i);e=gdata("partner_data","data_partner_library",[t]);this.partner_config=i,this.library_config=e,this.updateHeroInfo(),this.attr_name_lb.string=cc.js.formatStr("%s\uff1a%s%s",Utils.TI18N("\u5c5e\u6027"),String(a.CampAttrName[this.partner_config.camp_type]),String(a.CareerName[this.partner_config.type])),this.type_name_lb.string=cc.js.formatStr("%s\uff1a%s",Utils.TI18N("\u5b9a\u4f4d"),this.partner_config.hero_pos),this.richlabel_rt.string="  "+this.library_config.voice_str,this.setBtnVisable(0),this.partner_config.voice&&""!=this.partner_config.voice&&(this.voice_btn_nd.active=!0)},updateHeroInfo:function(){this.partner_config&&this.library_config&&(this.updateHeroStanding(),this.updateHeroOtherInfo())},updateHeroStanding:function(){if(this.partner_config&&this.library_config){this.hero_spine.node.active=!1;var t=this.partner_config.draw_res;console.log("this.library_config=>",this.library_config);var e=s.getIconPath("herodraw/herodrawres",t);if(this.hero_draw_icon_sp&&this.loadRes(e,function(t){t&&console.log(e+" load ok.",t),this.hero_draw_icon_sp.spriteFrame=t}.bind(this)),0==this.library_config.scale?this.hero_draw_icon_sp.node.scale=1:this.hero_draw_icon_sp.node.scale=this.library_config.scale/100,this.library_config.draw_offset&&null!=Utils.next(this.library_config.draw_offset)){var i=this.hero_draw_icon_sp.node.getPosition(),n=this.library_config.draw_offset[0][0]||0,a=this.library_config.draw_offset[0][1]||0;this.hero_draw_icon_sp.node.setPosition(i.x+n,i.y+a)}this.hero_draw_icon_sp.node.active=!0}},updateHeroOtherInfo:function(){this.hero_name_lb.string=this.partner_config.name,this.library_config.title&&""!=this.library_config.title?this.title_name_lb.string=this.library_config.title:this.title_bg_nd.active=!1},updateHeroAnimation:function(){if(this.partner_config&&this.library_config){var t=s.getSpinePath(this.library_config.bid,"h01");if(console.log("\u82f1\u96c4H01\u52a8\u753b\u5f62\u8c61\uff1aspine path:=>",t),this.loadRes(t,function(e){e&&console.log(t+" load ok.",e),this.hero_spine.skeletonData=e,this.hero_spine.setAnimation(0,"animation",!0)}.bind(this)),this.library_config.scale?this.hero_spine.node.scale=this.library_config.scale/100:this.hero_spine.node.scale=1,this.library_config.draw_offset&&null!=Utils.next(this.library_config.draw_offset)){var e=this.hero_spine.node.getPosition(),i=this.library_config.draw_offset[0][0]||0,n=this.library_config.draw_offset[0][1]||0;this.hero_spine.node.setPosition(e.x+i,e.y+n)}this.hero_spine.node.active=!0,this.spine_loaded=!0}},switch2HeroFullPainting:function(){this.hero_spine.node.active=!1,this.hero_draw_icon_sp.node.active=!0},switch2HeroHAnimation:function(){this.spine_loaded?(this.hero_draw_icon_sp.node.active=!1,this.hero_spine.node.active=!0):(this.updateHeroAnimation(),this.hero_draw_icon_sp.node.active=!1)},playTouchHero:function(){console.log("\u6478\u6478\u5979"),this.hero_spine.setAnimation(0,"touch",!1),this.hero_spine.setCompleteListener(function(){this.hero_spine.setAnimation(0,"animation",!0)}.bind(this))},switch2HeroHVideo:function(t){},initSkill:function(){if(this.partner_config.bid){var t=this.partner_config.bid,e=Config.partner_data.data_partner_max_star[t]||this.partner_config.init_star,i=Utils.getNorKey(t,e),s=gdata("partner_data","data_partner_star",[i]);if(null!=s){var n=[];for(var a in s.skills){var l=s.skills[a];1!=l[0]&&n.push(l)}for(var r in this.skill_item_list)this.skill_item_list[r]&&this.skill_item_list[r].setVisible(!1);var c=0;for(var r in n){var _=n[r];gdata("skill_data","data_get_skill",[_[1]])?(null==this.skill_item_list[r]&&(this.skill_item_list[r]=new o(!0,!0,!0,1,!0),this.skill_item_list[r].setParent(this.item_content),this.skill_item_list[r].setShowTips(!0)),this.skill_item_list[r].setData([_[1]]),this.skill_item_list[r].setVisible(!0),this.skill_item_list[r].setPosition(cc.v2(-68*(n.length-1)+136*c,0)),c+=1):debug(cc.js.formatStr("\u6280\u80fd\u8868id: %s \u6ca1\u53d1\u73b0",String(_.skill_bid)))}}}},closeCallBack:function(){if(this.ctrl.openHeroSMRoomInfoWindow(!1),this.skill_item_list){for(var t in this.skill_item_list)this.skill_item_list[t]&&(this.skill_item_list[t].deleteMe(),this.skill_item_list[t]=null);this.skill_item_list=null}}});cc._RF.pop()},{hero_const:"hero_const",hero_controller:"hero_controller",pathtool:"pathtool",skill_item:"skill_item"}],hero_smroom_main_item:[function(t,e,i){"use strict";cc._RF.push(e,"66cb4kBrdpDabZXMfN81+71","hero_smroom_main_item");var s=t("pathtool");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("hero","hero_smroom_main_item")},initConfig:function(){},initPanel:function(){this.main_panel=this.seekChild("main_panel"),this.hero_icon_sp=this.seekChild("hero_icon",cc.Sprite),this.camp_icon_sp=this.seekChild("camp_icon",cc.Sprite),this.profession_icon_sp=this.seekChild("profession_icon",cc.Sprite),this.name_lb=this.seekChild("name",cc.Label),this.size=this.root_wnd.getContentSize()},registerEvent:function(){Utils.onTouchEnd(this.root_wnd,function(){this.callback&&this.callback()}.bind(this),1)},addCallBack:function(t){this.callback=t},setData:function(t){this.config=t,this.root_wnd&&this.onShow()},onShow:function(){if(null!=this.config){var t=s.getBigBg("partnercard_"+this.config.bid,null,"partnercard");null!=this.record_res_id&&this.record_res_id==t||(this.record_res_id=t,this.loadRes(t,function(t){this.hero_icon_sp.spriteFrame=t}.bind(this)));var e=s.getCommonIcomPath(s.getHeroCampRes(this.config.camp_type));null!=this.record_camp_res&&this.record_camp_res==e||(this.record_camp_res=e,this.loadRes(e,function(t){this.camp_icon_sp.spriteFrame=t}.bind(this)));var i=this.config.type||4,n=s.getPartnerTypeIcon(i);null!=this.record_type_res&&this.record_type_res==n||(this.record_type_res=n,this.loadRes(n,function(t){this.profession_icon_sp.spriteFrame=t}.bind(this))),this.name_lb.string=this.config.name,this.timer=gcore.Timer.set(function(){var t=this.profession_icon_sp.node.getContentSize(),e=this.name_lb.node.getContentSize(),i=t.width+5+e.width,s=.5*(this.size.width-i);this.profession_icon_sp.node.x=-this.size.width/2+s+.5*t.width,this.name_lb.node.x=this.profession_icon_sp.node.x+.5*t.width+.5*e.width+5}.bind(this),60,1)}},onHide:function(){},onDelete:function(){this.timer&&(gcore.Timer.del(this.timer),this.timer=null)}});cc._RF.pop()},{pathtool:"pathtool"}],hero_smroom_main_window:[function(t,e,i){"use strict";cc._RF.push(e,"c42f4AvXPxN/poBeOwxCA7o","hero_smroom_main_window");var s=t("pathtool"),n=t("hero_controller"),a=t("hero_const"),o=t("hero_smroom_main_item");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("hero","hero_smroom_main_window"),this.viewTag=SCENE_TAG.ui,this.win_type=WinType.Full},initConfig:function(){this.ctrl=n.getInstance(),this.model=this.ctrl.getModel(),this.hero_library_list={},this.select_camp=0,this.col=3,this.item_width=220,this.item_height=335,this.cacheList={},this.cacheMaxSize=0,this.time_show_index=0,this.first_title_height=50,this.title_height=80,this.career_info_list={},this.node_list=[]},openCallBack:function(){this.main_container=this.seekChild("main_container"),this.lay_scrollview_nd=this.seekChild(this.main_container,"lay_scrollview"),this.centre_box_1_nd=this.seekChild(this.main_container,"centre_box_1"),this.border_left_box_2_nd=this.seekChild(this.main_container,"border_left_box_2"),this.border_right_box_2_nd=this.seekChild(this.main_container,"border_right_box_2"),this.top_box_4_nd=this.seekChild(this.main_container,"top_box_4"),this.bottom_box_5_nd=this.seekChild(this.main_container,"bottom_box_5");var t=this.seekChild(this.bottom_box_5_nd,"camp_node");this.camp_btn_list={};for(var e=0;e<6;e++)this.camp_btn_list[e]=this.seekChild(t,"camp_btn"+e);this.img_select_nd=this.seekChild(t,"img_select");var i=this.camp_btn_list[0].getPosition();this.img_select_nd.setPosition(i.x,i.y),this.close_btn=this.seekChild(this.bottom_box_5_nd,"close_btn"),this.background_nd=this.seekChild("background"),this.background_nd.scale=FIT_SCALE,this.loadRes(s.getBigBg("hero/hero_bag_bg"),function(t){this.background_nd.getComponent(cc.Sprite).spriteFrame=t}.bind(this)),this.adaptationScreen()},registerEvent:function(){Utils.onTouchEnd(this.close_btn,function(){this.ctrl.openHeroSMRoomMainWindow(!1)}.bind(this),2);var t=function(t,e){Utils.onTouchEnd(t,function(){this.onClickBtnShowByIndex(e)}.bind(this),2)}.bind(this);for(var e in this.camp_btn_list){t(this.camp_btn_list[e],e)}},adaptationScreen:function(){},onClickBtnShowByIndex:function(t,e){if(this.img_select_nd&&this.camp_btn_list[t]){var i=this.camp_btn_list[t].getPosition();this.img_select_nd.setPosition(i.x-.5,i.y+1)}this.updateHeroList(t,e)},openRootWnd:function(t){this.onClickBtnShowByIndex(0,!0)},updateCareerUI:function(t,e,i){for(var n in this.career_info_list){var o=this.career_info_list[n];o&&(o.desk&&(o.desk.node.active=!1),o.bg.node.active=!1)}i=i||0;var l=function(e){var n=t[e],o=n.career_type||a.CareerName.eMagician,l=n.pos_y||0,r=a.CareerName[o],c=-l,_=-l-25;if(1==e&&(_=-l),null==this.career_info_list[e]){var h={};if(1!=e){var d=s.getUIIconPath("herolibrary","hero_library_box_5");h.desk=Utils.createImage(this.scrollview_container_nd,null,0,c,cc.v2(.5,.5),!0,0,!0),this.loadRes(d,function(t){h.desk.spriteFrame=t}.bind(this)),h.desk.node.setContentSize(cc.size(this.scrollview_size.width,103)),h.desk.type=cc.Sprite.Type.SLICED,h.desk.sizeMode=cc.Sprite.SizeMode.CUSTOM,this.node_list.push(h.desk)}d=s.getUIIconPath("herolibrary","hero_library_18");h.bg=Utils.createImage(this.scrollview_container_nd,null,i,_,cc.v2(0,1),!0,0,!0),this.loadRes(d,function(t){h.bg.spriteFrame=t}.bind(this)),h.bg.node.setContentSize(cc.size(232,48)),h.bg.type=cc.Sprite.Type.SLICED,h.bg.sizeMode=cc.Sprite.SizeMode.CUSTOM,this.node_list.push(h.bg);d=s.getPartnerTypeIcon(o);h.career_icon=Utils.createImage(h.bg.node,null,50,-27,cc.v2(0,.5)),this.loadRes(d,function(t){h.career_icon.spriteFrame=t}.bind(this)),this.node_list.push(h.career_icon),h.label=Utils.createLabel(24,new cc.Color(100,50,35,255),null,88,-27,r,h.bg.node,null,cc.v2(0,.5)),this.career_info_list[e]=h,this.node_list.push(h.label)}else{(h=this.career_info_list[e]).desk&&(h.desk.node.active=!0,h.desk.node.y=c),h.bg.node.active=!0,h.bg.node.y=_;d=s.getPartnerTypeIcon(o);this.loadRes(d,function(t){h.career_icon.spriteFrame=t}.bind(this)),h.label.string=r}}.bind(this);for(var n in t)0!=n&&l(n)},updateHeroList:function(t,e){if(t=t||0,e||t!=this.select_camp){if(!this.list_view_sv){var i=this.lay_scrollview_nd.getContentSize();this.createLibraryScrollView(i,.5*i.width,.5*i.height)}this.list_view_sv.stopAutoScroll(),this.list_view_sv.scrollToTop(0),this.select_camp=t;var s=Config.partner_data.data_partner_base||{},n=Config.hero_love_data.hero_love_list_data||{};0==Object.keys(n)?console.log("\u8c03\u6559\u6240\u8868\u4e0d\u5b58\u5728"):console.log(n);var a=[];for(var o in s)if(-1!=n.indexOf(parseInt(o))){var l=s[o];0!=t&&t!=l.camp_type||(a.push(l),console.log("hero table key:",o,l.name,l.camp_type))}a.sort(Utils.tableCommonSorter([["type",!1],["init_star",!0],["camp_type",!1],["sort_order",!1]]));var r=0,c=-this.scrollview_size.width/2,_=function(t){var e=t%this.col;return 0==e&&(r+=this.item_height),{x:c+this.item_width*e+.5*this.item_width,y:r-.5*this.item_height}}.bind(this),h=[];h[0]={};var d=null;for(var u in this.hero_library_list=[],this.hero_library_list[0]={},a){l=a[u];if(null==d&&(d=l.type,r=this.first_title_height,h.push({career_type:d,pos_y:0})),d!=l.type){var m=this.col-(this.hero_library_list.length-1)%this.col;if(m<this.col&&0!=m)for(u=1;u<=m;u++){var f=_(this.hero_library_list.length-1);this.hero_library_list.push({x:f.x,y:f.y})}d=l.type,h.push({career_type:d,pos_y:r}),r+=this.title_height}f=_(this.hero_library_list.length-1);this.hero_library_list.push({config:l,x:f.x,y:f.y})}var p=null;p=this.hero_library_list.length-1>0?r:0,this.updateCareerUI(h,p,c),this.reloadData(p)}},numberOfCells:function(){return this.hero_library_list.length-1},updateCellByIndex:function(t,e){t.index=e;var i=this.hero_library_list[e];i.config?(t.setActive(!0),t.setData(i.config)):t.setActive(!1)},onCellTouched:function(t){var e=t.index,i=this.hero_library_list[e];if(i&&i.config){var s=i.config.draw_res,n=gdata("partner_data","data_partner_library",[i.config.bid]);if(s&&n&&""!=s)this.ctrl.openHeroSMRoomInfoWindow(!0,i.config.bid);else{message(Utils.TI18N("\u753b\u5e08\u6b63\u5feb\u9a6c\u52a0\u97ad\u5730\u5236\u4f5c\u8be5\u7acb\u7ed8\u4e2d\u54df"));var a=gdata("partner_data","data_partner_pokedex",[i.config.bid]);if(a&&a[0]){var o=a[0].star||1;this.ctrl.openHeroSMRoomInfoWindowByBidStar(i.config.bid,o)}}}},createLibraryScrollView:function(t,e,i){this.scrollview_size=t,this.list_view_sv=this.seekChild(this.lay_scrollview_nd,"list_view",cc.ScrollView),this.scrollview_container_nd=this.seekChild(this.list_view_sv.node,"content"),this.cacheMaxSize=(Math.ceil(t.height/this.item_height)+1)*this.col,this.list_view_sv.node.on("scrolling",function(){this.checkOverShowByVertical()},this)},checkOverShowByVertical:function(){if(this.cellList){for(var t=-this.scrollview_container_nd.y,e=-this.scrollview_size.height+t,i=Math.ceil((this.cellList.length-1)/this.col),s=1,n=1;n<=i;n++){var a=1+(n-1)*this.col;if(s=n,(l=this.cellList[a])&&l.y-.5*this.item_height<=t)break}var o=i;if(e<0)for(n=s;n<=i;n++){var l;a=1+(n-1)*this.col;if((l=this.cellList[a])&&l.y+.5*this.item_height<e){o=n-1;break}}var r=this.numberOfCells();for(n=1;n<=i;n++)if(n>=s&&n<=o)for(var c=1;c<=this.col;c++){a=(n-1)*this.col+c;this.activeCellIdx[a]||a<=r&&(this.updateCellAtIndex(a),this.activeCellIdx[a]=!0)}else for(c=1;c<=this.col;c++){(a=(n-1)*this.col+c)<=r&&(this.activeCellIdx[a]=!1)}}},reloadData:function(t){for(var e in this.cellList=[],this.cellList[0]={},this.activeCellIdx={},this.cacheList)this.cacheList[e].setPosition(-1e3,0);t=Math.max(t,this.scrollview_size.height);this.container_size=cc.size(this.scrollview_size.width,t),this.scrollview_container_nd.setContentSize(this.container_size),this.list_view_sv.scrollToTop(0);var i=this.numberOfCells();if(0!=i){for(var s=1;s<=i;s++){var n=this.hero_library_list[s];if(null!=n){var a=null;s<=this.time_show_index&&(a=this.getCacheCellByIndex(s));var o={cell:a,x:n.x,y:-n.y};this.cellList.push(o)}}var l=this.cacheMaxSize-this.col,r=i<l&&i||l,c=function(t){gcore.Timer.set(function(){this.time_show_index<t&&(this.time_show_index=t),this.updateCellAtIndex(t),this.time_show_index==r&&(this.time_show_index=9999)}.bind(this),t/60,1),this.activeCellIdx[s]=!0}.bind(this);for(s=1;s<=r;s++)c(s)}},getCacheCellByIndex:function(t){var e=(t-1)%this.cacheMaxSize+1;if(this.cacheList[e])return this.cacheList[e];var i=new o;return i.show(),i.addCallBack(function(){this.onCellTouched(i)}.bind(this)),i.setPosition(-1e3,0),i.setAnchorPoint(cc.v2(.5,.5)),this.cacheList[e]=i,i.setParent(this.scrollview_container_nd),i},updateCellAtIndex:function(t){if(!(t>this.time_show_index)&&this.cellList[t]){var e=this.cellList[t];null==e.cell&&(e.cell=this.getCacheCellByIndex(t)),e.cell.setPosition(e.x,e.y),this.updateCellByIndex(e.cell,t)}},closeCallBack:function(){for(var t in this.cacheList){var e=this.cacheList[t];e.deleteMe&&(e.deleteMe(),e=null)}for(var i in this.cacheList=null,this.node_list){var s=this.node_list[i];s&&(s instanceof cc.Node?(s.destroy(),s=null):(s.node.destroy(),s=null))}this.node_list=null,this.career_info_list=null,this.ctrl.openHeroSMRoomMainWindow(!1)}});cc._RF.pop()},{hero_const:"hero_const",hero_controller:"hero_controller",hero_smroom_main_item:"hero_smroom_main_item",pathtool:"pathtool"}],hero_talent_skill_learn_window:[function(t,e,i){"use strict";function s(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}cc._RF.push(e,"b58adq+4SJMyayoWF9DVFKJ","hero_talent_skill_learn_window");var n=t("pathtool"),a=t("hero_const"),o=t("hero_controller"),l=t("skill_item"),r=t("common_scrollview_single"),c=t("backpack_controller");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=n.getPrefabPath("hero","hero_talent_skill_learn_panel"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Mini,this.ctrl=o.getInstance()},initConfig:function(){this.item_list=[]},openCallBack:function(){this.background=this.root_wnd.getChildByName("background"),this.main_container=this.root_wnd.getChildByName("main_container"),this.show_item_node=this.main_container.getChildByName("show_item_node"),this.skill_item=new l,this.skill_item.setParent(this.show_item_node),this.skill_item.setLeveStatus(!1),this.skill_name=this.main_container.getChildByName("skill_name").getComponent(cc.Label),this.skill_desc_lb=this.main_container.getChildByName("skill_desc").getComponent(cc.Label),this.no_vedio_image=this.main_container.getChildByName("no_vedio_image"),this.no_vedio_label=this.main_container.getChildByName("no_vedio_label").getComponent(cc.Label),this.lay_scrollview=this.main_container.getChildByName("lay_scrollview"),this.cost_node=this.main_container.getChildByName("cost_node"),this.select_btn=this.main_container.getChildByName("select_btn")},registerEvent:function(){this.background.on("touchend",this.onClickBtnClose,this),this.select_btn.on("click",this.onClickBtnSelect,this)},onClickBtnClose:function(){Utils.playButtonSound(2),this.ctrl.openHeroTalentSkillLearnPanel(!1)},onClickBtnSelect:function(){this.select_skill_data&&(Utils.playButtonSound(1),1!=this.dic_have_skill_id.order_had&&(this.ctrl.sender11096(this.hero_vo.partner_id,this.pos,this.select_skill_data.config.id),this.onClickBtnClose()))},openRootWnd:function(t){if(t.hero_vo&&t.pos){this.pos=t.pos,this.hero_vo=t.hero_vo;var e=Config.partner_skill_data.data_partner_skill_learn;e&&null!=Utils.next(e)&&(this.no_vedio_image.active=!1,this.no_vedio_label.node.active=!1,this.initSkillData(e))}},initSkillData:function(t){var e;for(var i in this.skill_list=[],this.dic_have_skill_id={},this.hero_vo.talent_skill_list){var n=this.hero_vo.talent_skill_list[i];this.dic_have_skill_id[n]=i}var o=(s(e={},a.CareerType.eMagician,"order_magician"),s(e,a.CareerType.eWarrior,"order_warrior"),s(e,a.CareerType.eTank,"order_tank"),s(e,a.CareerType.eSsistant,"order_ssistant"),e),l=this.ctrl.getModel().getTalentRedpointRecord(),r={},c=Config.partner_skill_data.data_partner_commend_skill[this.hero_vo.bid];if(c)for(var _=0;_<c.length;++_){r[c[_]]=_+1}for(var h in t){var d=t[h],u={};u.config=d,u.order=d.order,c?r[d.id]?u.career_order=r[d.id]:u.career_order=1e3:o[this.hero_vo.type]?u.career_order=d[o[this.hero_vo.type]]:u.career_order=1e3,this.dic_have_skill_id[d.id]?u.order_had=1:u.order_had=2,l[d.id]?u.order_can=1:u.order_can=2,this.skill_list.push(u)}this.updateSkillList()},updateSkillList:function(){if(null==this.list_view){var t=this.lay_scrollview.getContentSize();t.width;this.list_view=new r,this.list_view.createScroll(this.lay_scrollview,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,t,{start_x:0,space_x:0,start_y:0,space_y:0,item_width:152,item_height:158,row:0,col:4,need_dynamic:!0},cc.v2(0,0)),this.list_view.registerScriptHandlerSingle(this.createNewCell.bind(this),ScrollViewFuncType.CreateNewCell),this.list_view.registerScriptHandlerSingle(this.numberOfCells.bind(this),ScrollViewFuncType.NumberOfCells),this.list_view.registerScriptHandlerSingle(this.updateCellByIndex.bind(this),ScrollViewFuncType.UpdateCellByIndex),this.list_view.registerScriptHandlerSingle(this.onCellTouched.bind(this),ScrollViewFuncType.OnCellTouched)}var e=Utils.tableLowerSorter(["order_had","order_can","career_order","order"]);this.skill_list.sort(e);for(var i=null,s=0;s<this.skill_list.length;++s){var n=this.skill_list[s];if(null==i&&1!=n.order_had){i=s;break}}null==i&&(i=0),this.list_view.reloadData(i)},createNewCell:function(t,e){var i=new cc.Node;return i.setContentSize(cc.size(t,e)),i.skill_item=new l,i.skill_item.setLeveStatus(!1),i.skill_item.setPosition(0,11),i.skill_item.setParent(i),i.skill_item.addCallBack(function(){this.onCellTouched(i)}.bind(this)),i},numberOfCells:function(){return this.skill_list?this.skill_list.length:0},updateCellByIndex:function(t,e){t.index=e;var i=this.skill_list[e];if(i){var s=gdata("skill_data","data_get_skill",i.config.id);s&&(t.skill_item.setData(i.config.id),t.skill_item.showName(!0,s.name,null,null,!0),t.skill_item.showRecommondIcon(!1),1==i.order_had?t.skill_item.showRecommondIcon(!0,2):1==i.order_can?t.skill_item.showRecommondIcon(!0,5):1e3!=i.career_order&&t.skill_item.showRecommondIcon(!0,1),this.select_skill_data&&this.select_skill_data.config.id==i.config.id?t.skill_item.setSelected(!0):t.skill_item.setSelected(!1))}},onCellTouched:function(t){var e=t.index,i=this.skill_list[e];this.select_cell&&this.select_cell.skill_item.setSelected(!1),this.select_cell=t,this.select_cell&&this.select_cell.skill_item.setSelected(!0),this.showSkillInfo(i)},showSkillInfo:function(t){if(t){this.select_skill_data=t;var e=gdata("skill_data","data_get_skill",t.config.id);e&&(this.skill_item&&this.skill_item.setData(t.config.id),this.skill_name.string=e.name,this.skill_desc_lb.string=e.des,this.showCostInfo(t))}},showCostInfo:function(t){if(t){for(var e=0;e<this.item_list.length;++e)this.item_list[e];for(var i=-130*t.config.expend.length/2+65,s=0;s<t.config.expend.length;++s){var n=t.config.expend[s],a=n[0],o=n[1];null==this.item_list[s]&&(this.item_list[s]=ItemsPool.getInstance().getItem("backpack_item"),this.item_list[s].setDefaultTip(!0,null,null,1),this.item_list[s].name_size=24,this.item_list[s].name_color="#643223",this.item_list[s].setParent(this.cost_node),this.item_list[s].initConfig(!1,.8,!0,!0,!0),this.item_list[s].show());var l=i+130*s;this.item_list[s].setPosition(l,0);var r=Utils.getItemConfig(a);if(r){this.item_list[s].setData({bid:a,num:o});var _=c.getInstance().getModel().getItemNumByBid(r.id);this.item_list[s].setNeedNum(o,_)}}}},closeCallBack:function(){if(this.list_view){if(this.list_view.cellList.length)for(var t=0;t<this.list_view.cellList.length;++t){var e=this.list_view.cellList[t].cell;e&&e.skill_item&&(e.skill_item.deleteMe(),e.skill_item=null)}this.list_view.deleteMe(),this.list_view=null}this.skill_item&&(this.skill_item.deleteMe(),this.skill_item=null);for(var i=0;i<this.item_list.length;++i)this.item_list[i].deleteMe(),this.item_list[i]=null;this.item_list=null,this.ctrl.openHeroTalentSkillLearnPanel(!1)}});cc._RF.pop()},{backpack_controller:"backpack_controller",common_scrollview_single:"common_scrollview_single",hero_const:"hero_const",hero_controller:"hero_controller",pathtool:"pathtool",skill_item:"skill_item"}],hero_talent_skill_level_up_window:[function(t,e,i){"use strict";cc._RF.push(e,"d249e4asAxDkb4Oxah0lUxF","hero_talent_skill_level_up_window");var s=t("pathtool"),n=t("skill_item"),a=t("backpack_controller"),o=t("hero_controller"),l=t("hero_event"),r=t("commonalert");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("hero","hero_talent_skill_level_up_panel"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Mini,this.is_full_screen=!1,this.ctrl=o.getInstance()},initConfig:function(){this.item_list=[]},openCallBack:function(){this.background=this.root_wnd.getChildByName("background"),this.main_container=this.root_wnd.getChildByName("main_container"),this.title=this.main_container.getChildByName("win_title"),this.title.getComponent(cc.Label).string=Utils.TI18N("\u6280\u80fd\u5347\u7ea7"),this.skill_up_panel=this.main_container.getChildByName("skill_up_panel");var t=this.skill_up_panel.getChildByName("show_item_node");this.skill_up_info={},this.skill_up_info.skill_item=new n,this.skill_up_info.skill_item.setLeveStatus(!1),this.skill_up_info.skill_item.setParent(t),this.skill_up_info.skill_item.setScale(.9),this.skill_up_info.skill_name=this.skill_up_panel.getChildByName("skill_name").getComponent(cc.Label),this.skill_up_info.skill_desc=this.skill_up_panel.getChildByName("desc").getComponent(cc.Label),this.skill_down_panel=this.main_container.getChildByName("skill_down_panel");var e=this.skill_down_panel.getChildByName("show_item_node");this.skill_down_info={},this.skill_down_info.skill_item=new n,this.skill_down_info.skill_item.setLeveStatus(!1),this.skill_down_info.skill_item.setParent(e),this.skill_down_info.skill_item.setScale(.9),this.skill_down_info.skill_name=this.skill_down_panel.getChildByName("skill_name").getComponent(cc.Label),this.skill_down_info.skill_desc=this.skill_down_panel.getChildByName("desc").getComponent(cc.Label),this.box_90025_2=this.main_container.getChildByName("box_90025_2"),this.page_name_1=this.main_container.getChildByName("page_name_1"),this.page_name_1.getComponent(cc.Label).string=Utils.TI18N("\u6280\u80fd\u5347\u7ea7"),this.page_name_2=this.main_container.getChildByName("page_name_2"),this.page_name_2.getComponent(cc.Label).string=Utils.TI18N("\u5347\u7ea7\u6d88\u8017"),this.cost_node=this.main_container.getChildByName("cost_node"),this.left_btn=this.main_container.getChildByName("left_btn"),this.left_btn.getChildByName("label").getComponent(cc.Label).string=Utils.TI18N("\u9057\u5fd8\u6280\u80fd"),this.right_btn=this.main_container.getChildByName("right_btn"),this.right_btn.getChildByName("label").getComponent(cc.Label).string=Utils.TI18N("\u5347 \u7ea7"),this.arrow=this.main_container.getChildByName("Sprite_1"),this.skill_max_label=this.main_container.getChildByName("skill_max_label").getComponent(cc.Label),this.skill_max_label.string=""},registerEvent:function(){this.addGlobalEvent(l.Hero_Level_Up_Talent_Event,function(t){if(t&&this.hero_vo&&t.partner_id==this.hero_vo.partner_id){var e=this.hero_vo.talent_skill_list[this.pos];this.initSkillInfo(e)}}.bind(this)),this.right_btn.on("click",this.onClickBtnRight,this),this.background.on("touchend",this.onClickBtnClose,this),this.left_btn.on("click",this.onClickBtnLeft,this)},onClickBtnRight:function(){this.hero_vo&&this.pos&&(Utils.playButtonSound(1),this.ctrl.sender11097(this.hero_vo.partner_id,this.pos))},onClickBtnLeft:function(){if(this.hero_vo&&this.pos&&this.skill_id){Utils.playButtonSound(1);var t=Config.partner_skill_data.data_partner_skill_back[this.skill_id];if(t){if(0==t.expend.length)return thi.ctrl.sender11098(this.hero_vo.partner_id,this.pos),void this.ctrl.openHeroTalentSkillLevelUpPanel(!1);for(var e=Utils.TI18N("\u9057\u5fd8\u8be5\u6280\u80fd\u9700\u6d88\u8017 "),i=[],n=0;n<t.expend.length;++n){var a=t.expend[n];if(Utils.getItemConfig(a[0])){0!=n&&(e+=", ");var o=StringUtil.parseStr(Utils.TI18N("<img src=%s visible=true scale=0.32 /><div fontColor=#289b14 fontsize= 24>%s</div>")).string,l=s.getIconPath("item","3");i.push(l),e+=cc.js.formatStr(o,"3",a[1])}}if(t.award1.length>0){e+="\n(\u540c\u65f6\u8fd4\u8fd8 ";for(var c=0;c<t.award1.length;++c){var _=t.award1[c],h=Utils.getItemConfig(_[0]);if(h){0!=c&&(e+=", ");var d=h.icon,u=StringUtil.parseStr(Utils.TI18N("<img src=%s visible=true scale=0.32 /><div fontColor=#289b14 fontsize= 24>%s</div>")).string,m=s.getIconPath("item",h.icon);i.push(m),e+=cc.js.formatStr(u,d,_[1])}}e+=")"}r.show(e,Utils.TI18N("\u786e\u5b9a"),function(){this.ctrl.sender11098(this.hero_vo.partner_id,this.pos),this.ctrl.openHeroTalentSkillLevelUpPanel(!1)}.bind(this),Utils.TI18N("\u53d6\u6d88"),null,null,null,{resArr:i})}else this.ctrl.sender11098(self.hero_vo.partner_id,self.pos),this.ctrl.openHeroTalentSkillLevelUpPanel(!1)}},onClickBtnClose:function(){Utils.playButtonSound(2),this.ctrl.openHeroTalentSkillLevelUpPanel(!1)},openRootWnd:function(t){var e=t.hero_vo,i=t.pos,s=t.skill_id;e&&i&&s&&(this.pos=i,this.hero_vo=e,this.initSkillInfo(s))},initSkillInfo:function(t){if(t){var e=Config.partner_skill_data.data_partner_skill_level[t];if(this.skill_id=t,e)this.showSkillInfo(e.id,this.skill_up_info),this.showSkillInfo(e.next_id,this.skill_down_info),this.showCostInfo(e);else{this.showSkillInfo(t,this.skill_up_info),this.box_90025_2.active=!1,this.page_name_2.active=!1,this.arrow.active=!1,this.right_btn.active=!1,this.skill_max_label.string=Utils.TI18N("\u8be5\u6280\u80fd\u5df2\u6ee1\u7ea7"),this.skill_down_panel.active=!1,this.cost_node.active=!1;var i=new cc.Node;this.main_container.addChild(i),i.y=-49.5,this.loadRes(s.getUIIconPath("bigbg/hero","hero_talent_skill_max"),function(t){i.addComponent(cc.Sprite).spriteFrame=t}.bind(this)),this.left_btn.x=0,this.skill_max_label.node.y=-40.5,this.skill_max_label.node.zIndex=2}}},showSkillInfo:function(t,e){var i=gdata("skill_data","data_get_skill",t);i&&(e.skill_item&&(e.skill_item.setData(t),e.skill_item.setShowTips(!0)),e.skill_name.string=i.name,e.skill_desc.string=i.des)},showCostInfo:function(t){var e=this;if(t){for(var i=this,n=0;n<i.item_list.length;++n)i.item_list[n];for(var o=-280*t.expend.length/2+80,l=function(n){var l=t.expend[n],r=o+280*n;null==i.item_list[n]&&(i.item_list[n]={},i.item_list[n].item=ItemsPool.getInstance().getItem("backpack_item"),i.item_list[n].item.setDefaultTip(!0,null,null,1),i.item_list[n].item.setParent(i.cost_node),i.item_list[n].item.initConfig(!1,.8,!0,!0,!1),i.item_list[n].item.show(),i.item_list[n].name=Utils.createLabel(19,new cc.Color(100,50,35),null,r+55,5,"",i.cost_node),i.item_list[n].name.lineHeight=21,i.item_list[n].image=Utils.createImage(i.cost_node,null,r+55,0,cc.v2(0,1),null,null,!0),i.item_list[n].image.node.setContentSize(136,28.8),i.item_list[n].needNum=Utils.createLabel(17,null,null,10,-15,"",i.item_list[n].image.node,null,cc.v2(0,.5)),i.item_list[n].needNum.lineHeight=19,e.loadRes(s.getUIIconPath("common","common_90005"),function(t){i.item_list[n].image.spriteFrame=t}.bind(e))),i.item_list[n].item.setPosition(r,0);var c=Utils.getItemConfig(l[0]);if(c){i.item_list[n].item.setData(c),i.item_list[n].name.string=c.name;var _,h=a.getInstance().getModel().getItemNumByBid(c.id);_=h<l[1]?Config.color_data.data_color16[127]:"#FFFFFF",i.item_list[n].needNum.string=Utils.getMoneyString(h)+"/"+l[1];var d=i.item_list[n].needNum.node.color;d.fromHEX(_),i.item_list[n].needNum.node.color=d}},r=0;r<t.expend.length;++r)l(r)}},closeCallBack:function(){this.skill_up_info&&this.skill_up_info.skill_item&&(this.skill_up_info.skill_item.deleteMe(),this.skill_up_info.skill_item=null),this.skill_up_info=null,this.skill_down_info&&this.skill_down_info.skill_item&&(this.skill_down_info.skill_item.deleteMe(),this.skill_down_info.skill_item=null),this.skill_down_info=null;for(var t=0;t<this.item_list.length;++t)this.item_list[t].item&&(this.item_list[t].item.deleteMe(),this.item_list[t]=null);this.item_list=null,this.ctrl.openHeroTalentSkillLevelUpPanel(!1)}});cc._RF.pop()},{backpack_controller:"backpack_controller",commonalert:"commonalert",hero_controller:"hero_controller",hero_event:"hero_event",pathtool:"pathtool",skill_item:"skill_item"}],hero_tips_attr_window:[function(t,e,i){"use strict";function s(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}cc._RF.push(e,"9d20cAC6OFEBYjjJURkpbJl","hero_tips_attr_window");var n=t("pathtool"),a=t("hero_controller"),o=t("partner_calculate"),l=t("hero_const"),r=t("guildskill_controller"),c=t("hero_event");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=n.getPrefabPath("hero","hero_tips_attr_panel"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Full,this.controller=a.getInstance()},initConfig:function(){var t,e,i,n;this.key_list1=(s(t={},1,"atk"),s(t,2,"hp"),s(t,3,"def"),s(t,4,"speed"),t),this.key_list2=(s(e={},1,"crit_rate"),s(e,2,"crit_ratio"),s(e,3,"hit_magic"),s(e,4,"dodge_magic"),e),this.key_list3=(s(i={},1,"tenacity"),s(i,2,"hit_rate"),s(i,3,"res"),s(i,4,"dodge_rate"),i),this.key_list4=(s(n={},1,"cure"),s(n,2,"be_cure"),s(n,3,"dam"),s(n,4,"dam"),n)},openCallBack:function(){this.background=this.root_wnd.getChildByName("background"),this.container=this.root_wnd.getChildByName("main_panel"),this.panel_bg=this.container.getChildByName("panel_bg"),this.panel_bg_size=this.panel_bg.getContentSize();var t=this.container.getChildByName("bottom_panel");this.bottom_panel=t,this.bottom_panel_y=t.y,this.attr_panel_list={},this.attr_list={};for(var e=1;e<=4;++e){var i=this.container.getChildByName("attr_panel_"+e);this.attr_panel_list[e]=i,this.attr_list[e]={};for(var s="key_list"+e,n=1;n<=4&&(4!=e||4!=n);++n){var a={};a.icon=i.getChildByName("attr_icon"+n),a.key=i.getChildByName("attr_key"+n),a.value=i.getChildByName("attr_label"+n),a.attr_key=this[s][n],this.attr_list[e][n]=a}}this.guild_level_key=t.getChildByName("attr_key1"),this.halidom_level_key=t.getChildByName("attr_key2"),this.guild_level_value=t.getChildByName("attr_label1"),this.halidom_level_value=t.getChildByName("attr_label2"),this.title_name=t.getChildByName("title_name"),this.goto_btn_1=t.getChildByName("goto_btn_1"),this.goto_btn_2=t.getChildByName("goto_btn_2"),this.bottom_btn=t.getChildByName("bottom_btn"),this.is_hide=!1},registerEvent:function(){this.bottom_btn.on("touchend",this.onClickBottomBtn,this),this.background.on("touchend",this.onClickCloseBtn,this),this.addGlobalEvent(c.Hero_Vo_Detailed_info,function(t){t&&t.partner_id==this.hero_vo.partner_id&&this.setData(t)}.bind(this))},openRootWnd:function(t){var e=t.hero_vo,i=t.is_my;if(e){this.is_my=i,this.hero_vo=e,this.is_my?e.is_pokedex?(this.setData(e),this.goto_btn_1.active=!1,this.goto_btn_2.active=!1):e.is_had_detailed?this.setData(e):this.controller.sender11063(e.partner_id):this.setData(e)}},setData:function(t){var e=this;for(var i in this.attr_list){var s=this.attr_list[i],a=function(i){var a=s[i],l=a.attr_key,r=n.getAttrIconByStr(l),c=n.getUIIconPath("common",r);e.loadRes(c,function(t){a.icon.getComponent(cc.Sprite).spriteFrame=t});var _=Config.attr_data.data_key_to_name[l];a.key.getComponent(cc.Label).string=_;var h=t[l]||0;o.isShowPerByStr(l)&&(h=h/10+"%"),a.value.getComponent(cc.Label).string=h};for(var l in s)a(l)}this.setBottomInfo()},onClickBottomBtn:function(){Utils.playButtonSound(1);this.is_hide?(this.is_hide=!1,this.bottom_btn.setRotation(-90),this.panel_bg.setContentSize(this.panel_bg_size),this.bottom_panel.y=this.bottom_panel_y,this.attr_panel_list[3].active=!0,this.attr_panel_list[4].active=!0):(this.is_hide=!0,this.bottom_btn.setRotation(90),this.panel_bg.setContentSize(cc.size(this.panel_bg_size.width,this.panel_bg_size.height-162)),this.bottom_panel.y=this.bottom_panel_y+162,this.attr_panel_list[3].active=!1,this.attr_panel_list[4].active=!1)},setBottomInfo:function(){var t=l.CareerType.eMagician,e=l.CampType.eWater,i=Config.partner_data.data_partner_base[this.hero_vo.bid];i&&(t=i.type,e=i.camp_type);var s=0,n=0,a=0;if(this.hero_vo.ext_data)for(var o=0;o<this.hero_vo.ext_data.length;++o){var c=this.hero_vo.ext_data[o];1==c.id?s=c.val||0:2==c.id?a=c.val||0:3==c.id&&(n=c.val||0)}if(this.is_my&&!this.hero_vo.is_pokedex){var _=r.getInstance().getModel().getCareerSkillLevel(t);-1!=_&&(s=_)}this.guild_level_key.getComponent(cc.Label).string="\u516c\u4f1a\u6280\u80fd\u7b49\u7ea7"+l.CareerName[t],this.halidom_level_key.getComponent(cc.Label).string=l.CampName[e]+"\u4e4b\u5723\u7269\u7b49\u7ea7",this.guild_level_value.getComponent(cc.Label).string="lv."+s,this.halidom_level_value.getComponent(cc.Label).string=0==a&&0==n?"\u672a\u89e3\u9501":"lv."+n+a+"\u9636"},onClickCloseBtn:function(){Utils.playButtonSound(2),this.controller.openHeroTipsAttrPanel(!1)},closeCallBack:function(){this.controller.openHeroTipsAttrPanel(!1)}});cc._RF.pop()},{guildskill_controller:"guildskill_controller",hero_const:"hero_const",hero_controller:"hero_controller",hero_event:"hero_event",partner_calculate:"partner_calculate",pathtool:"pathtool"}],hero_tips_window:[function(t,e,i){"use strict";function s(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}cc._RF.push(e,"976eed+ksRFUbK7+YCPdZ8k","hero_tips_window");var n=t("pathtool"),a=t("hero_controller"),o=t("role_controller"),l=t("backpack_const"),r=t("goods_vo"),c=t("hero_const");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=n.getPrefabPath("hero","hero_tips_panel1"),this.controller=a.getInstance(),this.model=a.getInstance().getModel(),this.role_vo=o.getInstance().getRoleVo(),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Tips},initConfig:function(){var t,e,i;this.itemScale=.8,this.break_icon_list={},this.break_icon_bg_list={},this.attr_list=(s(t={},1,"atk"),s(t,2,"hp"),s(t,3,"def"),s(t,4,"speed"),t),this.skill_item_list={},this.equip_type_list=c.EquipPosList,this.equip_icon_name_list=(s(e={},l.item_type.WEAPON,"hero_info_7"),s(e,l.item_type.SHOE,"hero_info_10"),s(e,l.item_type.CLOTHES,"hero_info_9"),s(e,l.item_type.HAT,"hero_info_8"),s(e,5,"hero_info_11"),s(e,6,"hero_info_11"),e),this.holy_equip_type_list=c.HolyequipmentPosList,this.holy_equip_icon_name_list=(s(i={},l.item_type.GOD_EARRING,"hero_info_25"),s(i,l.item_type.GOD_RING,"hero_info_27"),s(i,l.item_type.GOD_NECKLACE,"hero_info_26"),s(i,l.item_type.GOD_BANGLE,"hero_info_28"),i)},openCallBack:function(){this.background=this.root_wnd.getChildByName("background"),this.main_panel=this.root_wnd.getChildByName("main_panel"),this.top_panel=this.main_panel.getChildByName("top_panel"),this.hero_node=this.top_panel.getChildByName("hero_node"),this.hero_item=ItemsPool.getInstance().getItem("hero_exhibition_item"),this.hero_item.setScale(.8),this.hero_item.setParent(this.hero_node),this.hero_name_lb=this.top_panel.getChildByName("hero_name").getComponent(cc.Label),this.advanced_node=this.top_panel.getChildByName("advanced_node"),this.fight_lb=this.top_panel.getChildByName("power_click").getComponent("CusRichText"),this.comment_btn=this.top_panel.getChildByName("comment_btn"),this.look_btn=this.top_panel.getChildByName("look_btn");var t=this.top_panel.getChildByName("attr_panel");this.attr_icon_list={},this.attr_icon_list[1]=t.getChildByName("attr_icon1"),this.attr_icon_list[2]=t.getChildByName("attr_icon2"),this.attr_icon_list[3]=t.getChildByName("attr_icon3"),this.attr_icon_list[4]=t.getChildByName("attr_icon4"),this.attr_label_list={},this.attr_label_list[1]=t.getChildByName("attr_label1"),this.attr_label_list[2]=t.getChildByName("attr_label2"),this.attr_label_list[3]=t.getChildByName("attr_label3"),this.attr_label_list[4]=t.getChildByName("attr_label4"),this.skill_Layout=this.top_panel.getChildByName("scroll_Layout"),this.equip_panel=this.main_panel.getChildByName("equip_panel"),this.equip_node_list={};for(var e=1;e<=6;++e)this.equip_node_list[e]=this.equip_panel.getChildByName("equip_node"+e);this.holy_equip_node_list={};for(var i=1;i<=4;++i)this.holy_equip_node_list[i]=this.equip_panel.getChildByName("holy_equip_node_"+i)},registerEvent:function(){this.background.on("touchend",this.onClickCloseBtn,this),this.comment_btn.on("touchend",this.onClickCommentBtn,this),this.look_btn.on("touchend",this.onClickLookBtn,this)},openRootWnd:function(t){var e=this;cc.log(t);var i=this;if(t.hero_vo){i.hero_vo=t.hero_vo;var s=t.hero_vo,a=Config.partner_data.data_partner_base[s.bid];if(i.hero_vo.name=i.hero_vo.name||a.name,a){i.hero_item.setData(s),i.hero_item.show(),i.hero_name_lb.string=a.name;var o=s.power||0;i.fight_lb.setNum(o),i.updateAdvanceInfo(s);var l=function(t){var a=i.attr_list[t];if(i.attr_icon_list[t]){var o=n.getAttrIconByStr(a),l=n.getUIIconPath("common",o);e.loadRes(l,function(e){i.attr_icon_list[t].getComponent(cc.Sprite).spriteFrame=e})}if(i.attr_label_list[t]){var r=s[a]||0;i.attr_label_list[t].getComponent(cc.Label).string=r}};for(var r in i.attr_list)l(r);var c=Utils.getNorKey(a.type,a.break_id,s.break_lev),_=Config.partner_data.data_partner_brach[c];i.initSkill(s,_),t.is_hide_equip?i.equip_panel.active=!1:i.updateEquip(s)}}},onClickLookBtn:function(){Utils.playButtonSound(3),this.hero_vo&&this.controller.openHeroTipsAttrPanel(!0,this.hero_vo)},initSkill:function(e,i){var s=Utils.getNorKey(e.bid,e.star),n=gdata("partner_data","data_partner_star",s);if(n){for(var a=[],o=0;o<n.skills.length;++o){var l=n.skills[o];1!=l[0]&&a.push(l)}for(var r=0;r<a.length;++r){var c=a[r];if(Config.skill_data.data_get_skill[c[1]]){var _=new cc.Node;_.setContentSize(88,88),this.skill_Layout.addChild(_);var h=!1;if(c[0]>i.skill_num&&(h=!0),!this.skill_item_list[r]){var d=t("skill_item");this.skill_item_list[r]=new d,this.skill_item_list[r].showUnEnabled(h),this.skill_item_list[r].setParent(_),this.skill_item_list[r].setScale(this.itemScale),this.skill_item_list[r].setShowTips(!0)}this.skill_item_list[r].setData(c[1])}else cc.log("\u6280\u80fd\u8868id:  \u6ca1\u53d1\u73b0",c.skill_bid)}}},updateAdvanceInfo:function(t){var e=this,i=this,s=this.model.getHeroMaxBreakCountByInitStar(t.star),a=t.break_lev;for(var o in i.break_icon_list){i.break_icon_list[o].active=!1}for(var l=1;l<=s;++l)l<=a?(i.break_icon_list[l]?i.break_icon_list[l].active=!0:function(){var t=n.getUIIconPath("tips","tips_12"),s=new cc.Node;e.loadRes(t,function(t){s.addComponent(cc.Sprite).spriteFrame=t}.bind(e)),e.advanced_node.addChild(s),i.break_icon_list[l]=s}(),i.break_icon_bg_list[l]&&(i.break_icon_bg_list[l].active=!1)):(i.break_icon_list[l]&&(i.break_icon_list[l].active=!1),i.break_icon_bg_list[l]?i.break_icon_bg_list[l].active=!0:function(){var t=n.getUIIconPath("tips","tips_13"),s=new cc.Node;e.loadRes(t,function(t){s.addComponent(cc.Sprite).spriteFrame=t}.bind(e)),e.advanced_node.addChild(s),i.break_icon_bg_list[l]=s}())},onClickCloseBtn:function(){Utils.playButtonSound(2),this.controller.openHeroTipsPanel(!1)},onClickCommentBtn:function(){Utils.playButtonSound(1);var e=this;this.hero_vo&&t("pokedex_controller").getInstance().openCommentWindow(!0,this.hero_vo,function(){e.onClickCloseBtn()})},updateEquip:function(t){var e=this,i=this;i.equip_item_list={};var s={};if(null!=t.eqms)for(var a=0;a<t.eqms.length;++a){var o=t.eqms[a];s[o.type]=new r,s[o.type].setBaseId(o.base_id)}else if(null!=t.eqm_list)for(var l in t.eqm_list){var c=t.eqm_list[l];s[l]=c}if(null!=t.artifacts)for(var _=0;_<t.artifacts.length;++_){var h=t.artifacts[_];if(h.artifact_pos<100){var d=h.artifact_pos+4;s[d]=new r,s[d].initAttrData&&s[d].initAttrData(h)}}else if(null!=t.artifact_list)for(var u in t.artifact_list){var m=t.artifact_list[u];s[Number(u)+4]=m}for(var f in i.equip_item_list){var p=i.equip_item_list[f];p.setData(),p.equip_vo=null}for(var g in i.equip_node_list){g=Number(g);var v=i.equip_node_list[g],b=i.equip_type_list[g]||g,w=s[b];if(null==i.equip_item_list[b]){var y=ItemsPool.getInstance().getItem("backpack_item");y.setDefaultTip(),y.setParent(v),y.setPosition(0,0),y.initConfig(!1,this.itemScale,!1,!0),y.show(),i.equip_item_list[b]=y}w?i.equip_item_list[b].setData(w):function(){var t=new cc.Node;v.addChild(t,1),t.scale=e.itemScale;var s=n.getUIIconPath("hero",i.equip_icon_name_list[b]);e.loadRes(s,function(e){t.addComponent(cc.Sprite).spriteFrame=e}.bind(e))}()}},updateTalent:function(t,e,i){if(e&&i){this.talent_skill_item_list}},updateHolyEquip:function(t){},closeCallBack:function(){if(this.hero_item&&(this.hero_item.deleteMe(),this.hero_item=null),this.skill_item_list){for(var t in this.skill_item_list)this.skill_item_list[t].deleteMe();this.skill_item_list=null}if(this.equip_item_list){for(var e in this.equip_item_list)this.equip_item_list[e].deleteMe();this.equip_item_list=null}this.controller.openHeroTipsPanel(!1)}});cc._RF.pop()},{backpack_const:"backpack_const",goods_vo:"goods_vo",hero_const:"hero_const",hero_controller:"hero_controller",pathtool:"pathtool",pokedex_controller:"pokedex_controller",role_controller:"role_controller",skill_item:"skill_item"}],hero_upgrade_star_exhibition_window:[function(t,e,i){"use strict";cc._RF.push(e,"af8579rT9dC17z23PUzP5iy","hero_upgrade_star_exhibition_window");var s=t("pathtool"),n=t("skill_item");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("hero","hero_upgrade_star_exhibition"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Full,this.ctrl=arguments[0]},initConfig:function(){},openCallBack:function(){this.main_container_nd=this.seekChild("main_container"),this.title_container_sk=this.seekChild("title_container",sp.Skeleton),this.left_head_con_nd=this.seekChild("left_head_con"),this.right_head_con_nd=this.seekChild("right_head_con"),this.mask_bg_nd=this.seekChild("mask_bg"),this.mask_bg_nd.scale=FIT_SCALE,this.skills_con_nd=this.seekChild("skills_con"),this.tow_skill_con_nd=this.seekChild("tow_skill_con"),this.left_skill_con_nd=this.seekChild("left_skill_con"),this.right_skill_con_nd=this.seekChild("right_skill_con"),this.no_skill_tip_nd=this.seekChild("no_skill_tip"),this.attr_items={};for(var t=1;t<=5;t++){var e=this.attr_items[t]={},i=this.seekChild(this.main_container_nd,"attr_item_"+t);e.old_val_lb=this.seekChild(i,"old_val",cc.Label),e.new_val_lb=this.seekChild(i,"new_val",cc.Label)}this.left_hero_item=ItemsPool.getInstance().getItem("hero_exhibition_item"),this.left_hero_item.setParent(this.left_head_con_nd),this.left_hero_item.show(),this.right_hero_item=ItemsPool.getInstance().getItem("hero_exhibition_item"),this.right_hero_item.setParent(this.right_head_con_nd),this.right_hero_item.show(),this.mask_bg_nd.on(cc.Node.EventType.TOUCH_END,this.onClickMask,this)},registerEvent:function(){},openRootWnd:function(t){t&&(this.data=t,this.udpateWidgets())},closeCallBack:function(){if(this.left_hero_item&&this.left_hero_item.deleteMe(),this.right_hero_item&&this.right_hero_item.deleteMe(),this.right_skill_item&&this.right_skill_item.deleteMe(),this.lefg_skill_item&&this.lefg_skill_item.deleteMe(),this.skill_items)for(var t in this.skill_items)this.skill_items[t].deleteMe()},udpateWidgets:function(){this.handleEffect(!0),this.updateHead(),this.updateAttrList()},handleEffect:function(t){if(t){var e=PlayerAction.action_5,i=s.getEffectRes(103),n=s.getSpinePath(i,"action");this.loadRes(n,function(t){cc.log(e),cc.log(t),this.title_container_sk.skeletonData=t,this.title_container_sk.setAnimation(0,e,!1)}.bind(this))}},updateHead:function(){var t=this.data.new_vo,e=this.data.old_vo;this.left_hero_item.setData(e),this.right_hero_item.setData(t)},updateAttrList:function(){var t=this.data.old_vo,e=this.data.new_vo,i=t.bid+"_"+t.star,s=e.bid+"_"+e.star,a=gdata("partner_data","data_partner_star",i),o=gdata("partner_data","data_partner_star",s);this.attr_items[1].old_val_lb.string=t.power,this.attr_items[1].new_val_lb.string=e.power;var l=["hp","atk","def","speed"],r=2;for(var c in l){var _=l[c];"hp_max"==_&&(_="hp");var h=Config.attr_data.data_key_to_name[_]+"\uff1a"+t[_],d=e[_];this.attr_items[r].old_val_lb.string=h,this.attr_items[r].new_val_lb.string=d,r++}var u=null,m={},f=0,p={};for(var g in a.skills){p[(v=a.skills[g])[0]]=v[1]}for(var g in o.skills){var v;1!=(v=o.skills[g])[0]&&(p[v[0]]?p[v[0]]!=v[1]&&(u||(u=p[v[0]]),m[v[0]]=v[1],f++):(u||(u=p[v[0]]),m[v[0]]=v[1],f++))}if(f>0)if(1==f&&u){this.tow_skill_con_nd.active=!0;var b=null;for(var g in m)b=m[g];var w=this.lefg_skill_item=new n;w.setScale(.8),w.setParent(this.left_skill_con_nd),w.setData(u);var y=this.right_skill_item=new n;y.setScale(.8),y.setParent(this.right_skill_con_nd),y.setData(b)}else for(var g in this.skill_items={},m){var C=new cc.Node;C.setContentSize(cc.size(119,119)),this.skills_con_nd.addChild(C);var k=this.skill_items[g]=new n;k.setScale(.8),k.setParent(C),k.setData(m[g])}else this.no_skill_tip_nd.active=!0},onClickMask:function(){this.ctrl.openHeroUpgradeStarExhibitionPanel(!1)}});cc._RF.pop()},{pathtool:"pathtool",skill_item:"skill_item"}],hero_upgrade_star_fuse_window:[function(t,e,i){"use strict";cc._RF.push(e,"a68ecDm0gpMlZTTcZLCXXsG","hero_upgrade_star_fuse_window");var s=t("pathtool"),n=t("hero_const"),a=t("baserole"),o=t("hero_event"),l=t("hero_controller"),r=t("hero_calculate");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("hero","hero_upgrade_star_fuse_window"),this.viewTag=SCENE_TAG.ui,this.win_type=WinType.Full,this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){this.attr_list={1:"atk",2:"hp",3:"def",4:"speed"},this.cur_camp=0,this.dic_other_selected={},this.heroBid=0},openCallBack:function(){var t=this;this.camp_node_nd=this.seekChild("camp_node"),this.img_select_nd=this.seekChild("img_select"),this.hero_list_nd=this.seekChild("hero_list"),this.no_vedio_image_nd=this.seekChild("no_vedio_image"),this.synthesis_btn_nd=this.seekChild("synthesis_btn"),this.explain_btn_nd=this.seekChild("explain_btn"),this.star_containder_nd=this.seekChild("star_containder"),this.star_item_nd=this.seekChild("star_item"),this.camp_icon_sp=this.seekChild("camp_icon",cc.Sprite),this.name_lb=this.seekChild("name",cc.Label),this.hero_camp_bg_sp=this.seekChild("hero_camp_bg",cc.Sprite),this.hero_background_sp=this.seekChild("hero_background",cc.Sprite),this.mode_node_nd=this.seekChild("mode_node"),this.level_txt_lb=this.seekChild("level_txt",cc.Label),this.look_btn_nd=this.seekChild("look_btn"),this.btn_red_nd=this.seekChild("btn_red"),this.background=this.seekChild("background"),this.background.scale=FIT_SCALE,this.hero_model=new a,this.hero_model.setParent(this.mode_node_nd),this.camp_btns={};for(var e=0;e<6;e++){this.camp_btns[e]=this.camp_node_nd.getChildByName("camp_btn"+e),this.camp_btns[e].camp_tag=e;this.camp_btns[e].getComponent(cc.Sprite);this.camp_btns[e].on(cc.Node.EventType.TOUCH_END,this.didClickCamp,this)}this.attr_lbs={};for(var i=1;i<=4;i++)this.attr_lbs[i]=this.seekChild("attr_label"+i,cc.Label);this.hero_items={};for(var s=function(e){l=1,e>1&&(l=.8),r=t.seekChild("hero_root_"+e),(c=ItemsPool.getInstance().getItem("hero_exhibition_item")).setParent(r),c.setScale(l),c.setExtendData({from_type:n.ExhibitionItemType.eUpStar,scale:l}),c.show(),c.addCallBack(function(t){this.onClickHeroItem(t,e)}.bind(t)),t.hero_items[e]=c},o=1;o<=4;o++){var l,r,c;s(o)}this.synthesis_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickSynBtn.bind(this),this),this.look_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickLookBtn,this),this.explain_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickExplainBtn,this),this.initHeroList()},registerEvent:function(){this.addGlobalEvent(o.Hero_Data_Add,function(){this.updateWidgets(),this.updateCamp(!0)}.bind(this)),this.addGlobalEvent(o.Del_Hero_Event,function(t){this.updateWidgets(),this.updateCamp(!0)}.bind(this)),this.addGlobalEvent(o.Hero_Data_Update,function(t){this.updateWidgets()}.bind(this))},openRootWnd:function(t){this.hero_vo=t,t&&(this.heroBid=t.bid),this.updateCamp(),this.updateWidgets()},closeCallBack:function(){if(this.cleanSelects(),this.item_scrollview&&this.item_scrollview.deleteMe(),this.item_scrollview=null,this.hero_model&&(this.hero_model.deleteMe(),this.hero_model=null),this.hero_items){for(var t in this.hero_items)this.hero_items[t]&&(this.hero_items[t].deleteMe(),this.hero_items[t]=null);this.hero_items=null}this.ctrl.openHeroUpgradeStarFuseWindow(!1)},cleanSelects:function(){for(var t in this.dic_other_selected){var e=this.dic_other_selected[t];for(var i in e)e[i].is_ui_select=!1,e[i].is_ui_lock=!1}},updateWidgets:function(){if(this.hero_vo||(this.hero_vo=this.fuse_list[0]),this.hero_vo){this.hero_cfg=this.hero_vo.base_config;var t=this.hero_vo.camp_type||n.CampType.eWater,e=s.getUIIconPath("bigbg/hero",n.CampBgRes[t]);this.bg_res&&this.bg_res===e||(this.loadRes(e,function(t){this.hero_background_sp.spriteFrame=t}.bind(this)),this.bg_res=e);var i=s.getUIIconPath("bigbg/hero",n.CampBottomBgRes[t]);this.loadRes(i,function(t){this.hero_camp_bg_sp.spriteFrame=t}.bind(this)),this.hero_model.setData(a.type.partner,this.hero_vo,PlayerAction.show,!0),this.updateStars(this.hero_vo.star),this.name_lb.string=this.hero_cfg.name;var o=s.getHeroCampRes(this.hero_cfg.camp_type),l=s.getUIIconPath("common",o);this.loadRes(l,function(t){this.camp_icon_sp.spriteFrame=t}.bind(this));var r=this.hero_vo.bid+"_"+this.hero_vo.star,c=this.model.getHeroPokedexByBid(r);if(c)for(var _ in this.level_txt_lb.string=Utils.TI18N("\u7b49\u7ea7\uff1a"+c.lev),this.attr_list)this.attr_lbs[_].string=c[this.attr_list[_]];this.updateHeroItems(),this.show_hero_vo=this.model.getHeroPokedexByBid(this.hero_vo.bid+"_"+this.hero_vo.star),this.updateCampRedpoint()}},updateHeroItems:function(){this.dic_other_selected={},this.hero_item_data_list={};var t=this.hero_vo.star_config.expend1,e=this.hero_vo.star_config.expend2,i=this.hero_vo.star_config.expend3,n=this.conditions_list={},a=1;for(var o in t)this.dic_other_selected[a]=[],this.hero_item_data_list[a]=this.getHeroData(t[o][0],t[o][1],t[o][2],null,a),n[a]={},n[a][t[o][0]]={},n[a][t[o][0]][t[o][1]]=t[o][2],a++;for(var o in e)this.dic_other_selected[a]=[],this.hero_item_data_list[a]=this.getHeroData(e[o][0],e[o][1],e[o][2],null,a),n[a]={},n[a][e[o][0]]={},n[a][e[o][0]][e[o][1]]=e[o][2],a++;for(var o in i)this.dic_other_selected[a]=[],this.hero_item_data_list[a]=this.getHeroData(null,i[o][1],i[o][2],i[o][0],a),n[a]={},n[a][i[o][0]]={},n[a][i[o][0]][i[o][1]]=i[o][2],a++;for(var l in this.hero_items){var r=this.hero_item_data_list[l];if(r){if(this.hero_items[l].setVisible(!0),this.hero_items[l].setData(r),0===r.bid){var c=this.model.getRandomHeroHeadByQuality(r.star),_=s.getIconPath("item",c);this.hero_items[l].setDefaultHead(_)}}else this.hero_items[l].setVisible(!1)}this.initHeroListByMatchInfo(n),this.updateCentreHeroItemRedPoint()},getHeroData:function(t,e,i,s,n){var a={};if(a.star=e||0,a.count=i||0,a.need_index=n,a.select_count=this.dic_other_selected[n].length,a.lev=cc.js.formatStr("%s/%s",a.select_count,i),a.head_gray=!0,t){var o=Config.partner_data.data_partner_base[t];if(!o)return null;a.bid=t,a.camp_type=o.camp_type}else a.bid=0,a.camp_type=s;return a.dic_select_list={},a},didClickCamp:function(t){var e=t.target.camp_tag;e!==this.cur_camp&&(this.cur_camp=e,this.img_select_nd.parent=this.camp_btns[e],this.updateCamp())},initHeroList:function(){var e=t("common_scrollview"),i=cc.size(this.hero_list_nd.width,this.hero_list_nd.height);this.item_scrollview=new e,this.item_scrollview.createScroll(this.hero_list_nd,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,i,{item_class:"hero_exhibition_item",start_x:0,space_x:0,start_y:0,space_y:0,item_width:125,item_height:150,col:5,once_num:5,need_dynamic:!0},cc.v2(.5,.5))},onClickHeroExhibiton:function(t){t&&t.data&&(this.hero_vo&&this.hero_vo.bid==t.data.bid||(this.cleanSelects(),this.hero_vo=t.data,this.updateWidgets()))},updateCamp:function(t){this.fuse_list=this.model.getStarFuseList(this.cur_camp),this.fuse_list.length>0?this.no_vedio_image_nd.active=!1:this.no_vedio_image_nd.active=!0;for(var e=0;e<this.fuse_list.length;++e)r.getInstance().checkSingleStarFuseRedPoint(this.fuse_list[e]);if(this.fuse_list.sort(function(t,e){var i=e.total_count/e.need_count,s=t.total_count/t.need_count;return i===s?e.camp_type===t.camp_type?e.star==t.star?t.bid-e.bid:t.star-e.star:t.camp_type-e.camp_type:i-s}),!t){if(this.heroBid){for(var i=0;i<this.fuse_list.length;++i)if(this.fuse_list[i].bid==this.heroBid){this.hero_vo=this.fuse_list[i];break}this.heroBid=0}else{var s=this.fuse_list[0];this.hero_vo&&this.hero_vo.bid==s.bid||(this.hero_vo=s)}this.updateWidgets()}this.item_scrollview.setData(this.fuse_list,this.onClickHeroExhibiton.bind(this),{can_click:!0,from_type:n.ExhibitionItemType.eHeroFuse})},updateStars:function(t){var e="",i=1;this.star_containder_nd.removeAllChildren(),this.star_containder_nd.width=0,t>0&&t<=5?e="common_90074":t>5&&t<=9?(t-=5,e="common_90075"):t>9&&(t=1,e="common_90073",i=1.2);for(var n=0;n<t;n++){var a=cc.instantiate(this.star_item_nd);a.scale=i;var o=a.getComponent(cc.Sprite),l=s.getUIIconPath("common",e);this.loadRes(l,function(t,e){t.spriteFrame=e}.bind(this,o)),this.star_containder_nd.addChild(a)}},onClickHeroItem:function(t,e){cc.log(e),this.ctrl.openHeroUpgradeStarSelectPanel(!0,t.data,this.dic_other_selected,1,1==e,this.updateNeedHero.bind(this))},updateNeedHero:function(t){this.dic_other_selected=t,this.updateSelectInfo(),this.updateCentreHeroItemRedPoint()},updateSelectInfo:function(t){for(var e in this.dic_other_selected){var i=this.hero_item_data_list[e];i.select_count=this.dic_other_selected[e].length,i.lev=cc.js.formatStr("%s/%s",i.select_count,i.count),this.dic_other_selected[e].length>0?i.head_gray=!1:i.head_gray=!0,this.hero_items[e].setData(i)}},isHeroEnough:function(){for(var t in this.hero_item_data_list)if(this.hero_item_data_list[t].select_count<this.hero_item_data_list[t].count)return!1;return!0},getNeedHeroInfo:function(){var t=[],e=[];for(var i in this.hero_item_data_list)if(i>1){var s=this.hero_item_data_list[i],n=this.dic_other_selected[i];for(var a in n){var o={};o.partner_id=n[a].partner_id,0===s.bid?e.push(o):t.push(o)}}return{hero_list:t,random_list:e}},onClickSynBtn:function(){if(this.isHeroEnough()){var t=this.getNeedHeroInfo(),e=this.dic_other_selected[1][0].partner_id;e&&this.ctrl.sender11005(e,t.hero_list,t.random_list)}else message(Utils.TI18N("\u6240\u9700\u6750\u6599\u4e0d\u8db3"))},onClickLookBtn:function(){cc.log(this.hero_vo),l.getInstance().openHeroTipsPanel(!0,this.show_hero_vo,!0)},onClickExplainBtn:function(e){var i=Config.partner_data.data_partner_const.game_rule2.desc;t("tips_controller").getInstance().showCommonTips(i,e.touch.getLocation())},initHeroListByMatchInfo:function(t){this.dic_other_selected,this.hero_item_data_list},updateCampRedpoint:function(){},updateCentreHeroItemRedPoint:function(){var t=!0;for(var e in this.hero_item_data_list){var i=!1,s=this.hero_item_data_list[e];s.count!=s.select_count&&(t=!1,i=this.haveCanSelect(this.hero_item_data_list[e])),this.hero_items[e].showRedPoint(i)}this.btn_red_nd.active=!!t},haveCanSelect:function(t){var e=this.model.getAllHeroArray();if(this.hero_list=[],0===t.bid)for(var i=0;i<e.length;++i)e[i].camp_type!==t.camp_type&&0!==t.camp_type||e[i].star!==t.star||this.cur_hero_vo&&e[i].partner_id===this.cur_hero_vo.partner_id||this.isOtherSelect(e[i])||this.hero_list.push(e[i]);else for(i=0;i<e.length;++i)e[i].bid!==t.bid||this.cur_hero_vo&&e[i].partner_id===this.cur_hero_vo.partner_id||e[i].star===t.star&&(this.isOtherSelect(e[i])||this.hero_list.push(e[i]));for(i=0;i<this.hero_list.length;++i)for(var s in this.dic_other_selected)for(var n in this.dic_other_selected[s])this.dic_other_selected[s][n].partner_id!=this.hero_list[i].partner_id||(this.hero_list[i].is_ui_select=!0);var a=0;for(i=0;i<this.hero_list.length;++i)this.hero_list[i].is_ui_select||a++;return a>=t.count},isOtherSelect:function(t){for(var e in this.dic_other_selected)for(var i in this.dic_other_selected[e]){var s=this.dic_other_selected[e][i];if(t.partner_id===s.partner_id)return!0}return!1}});cc._RF.pop()},{baserole:"baserole",common_scrollview:"common_scrollview",hero_calculate:"hero_calculate",hero_const:"hero_const",hero_controller:"hero_controller",hero_event:"hero_event",pathtool:"pathtool",tips_controller:"tips_controller"}],hero_upgrade_star_select_window:[function(t,e,i){"use strict";cc._RF.push(e,"28243KLQtVHqYePdj9nir5e","hero_upgrade_star_select_window");var s=t("pathtool"),n=t("hero_const");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("hero","hero_upgrade_star_select_panel"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Full,this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){},openCallBack:function(){this.item_container_nd=this.seekChild("item_container"),this.select_btn_nd=this.seekChild("select_btn"),this.no_video_nd=this.seekChild("no_video"),this.select_num_lb=this.seekChild("select_num",cc.Label),this.background_nd=this.seekChild("background"),this.background_nd.scale=FIT_SCALE,this.background_nd.on(cc.Node.EventType.TOUCH_END,this.onClickCloseBtn,this),this.select_btn_nd.on(cc.Node.EventType.TOUCH_END,this.onClickSelectBtn,this)},registerEvent:function(){},openRootWnd:function(t){this.select_hero=t.select_data,this.dic_other_selected=Utils.deepCopy(t.dic_other_selected),this.select_cb=t.select_cb,this.cur_hero_vo=t.cur_hero_vo,this.form_type=t.from_type,this.need_index=this.select_hero.need_index,this.is_master=t.is_master||!1,this.initListView(),this.updateWidget()},closeCallBack:function(){for(var t=0;t<this.hero_list.length;++t)this.hero_list[t]&&(this.hero_list[t]=null);this.item_scrollview&&this.item_scrollview.deleteMe(),this.ctrl.openHeroUpgradeStarSelectPanel(!1)},updateWidget:function(){var t=Utils.deepCopy(this.model.getAllHeroArray());if(this.hero_list=[],0===this.select_hero.bid)for(var e=0;e<t.length;++e)t[e].camp_type!==this.select_hero.camp_type&&0!==this.select_hero.camp_type||t[e].star!==this.select_hero.star||this.cur_hero_vo&&t[e].partner_id===this.cur_hero_vo.partner_id||this.isOtherSelect(t[e])||this.hero_list.push(t[e]);else for(e=0;e<t.length;++e)t[e].bid!==this.select_hero.bid||this.cur_hero_vo&&t[e].partner_id===this.cur_hero_vo.partner_id||t[e].star===this.select_hero.star&&(this.isOtherSelect(t[e])||this.hero_list.push(t[e]));for(e=0;e<this.hero_list.length;++e)for(var i in this.dic_other_selected)for(var s in this.dic_other_selected[i])this.dic_other_selected[i][s].partner_id!=this.hero_list[e].partner_id||(this.hero_list[e].is_ui_select=!0);for(e=0;e<this.hero_list.length;++e)this.is_master&&this.hero_list[e].bid==this.select_hero.bid||(this.hero_list[e].is_in_form||this.hero_list[e].is_lock)&&(this.hero_list[e].is_ui_lock=!0);var a=[];if(this.hero_list.length>0){this.no_video_nd.active=!1;for(var o=[],l=0;l<this.hero_list.length;++l)this.hero_list[l].is_ui_lock?o.push(this.hero_list[l]):a.push(this.hero_list[l]);a=a.concat(o)}else this.no_video_nd.active=!0;this.udpateSelectNum(),this.hero_list=a,this.item_scrollview.setData(this.hero_list,this.onClickHeroExhibiton.bind(this),{can_click:!0,from_type:n.ExhibitionItemType.eHeroSelect})},isOtherSelect:function(t){for(var e in this.dic_other_selected)if(e!=this.need_index)for(var i in this.dic_other_selected[e]){var s=this.dic_other_selected[e][i];if(t.partner_id===s.partner_id)return!0}return!1},initListView:function(){var e=t("common_scrollview"),i=cc.size(this.item_container_nd.width,this.item_container_nd.height);this.item_scrollview=new e,this.item_scrollview.createScroll(this.item_container_nd,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,i,{item_class:"hero_exhibition_item",start_x:0,space_x:4,start_y:0,space_y:0,item_width:150,item_height:136,col:4,once_num:5,need_dynamic:!0},cc.v2(.5,.5))},onClickHeroExhibiton:function(t){if(this.is_master&&t.data.bid==this.select_hero.bid);else if(t.data.checkHeroLockTips(!0))return;if(this.hero_list[t.tmp_index]){if(this.hero_list[t.tmp_index].is_ui_select)this.hero_list[t.tmp_index].is_ui_select=!1;else{if(this.dic_other_selected[this.need_index].length>=this.select_hero.count)return void message(Utils.TI18N("\u9009\u62e9\u6570\u91cf\u5df2\u6ee1"));this.hero_list[t.tmp_index].is_ui_select=!0}t.setSelected(this.hero_list[t.tmp_index].is_ui_select),this.updateSeletInfo(this.hero_list[t.tmp_index])}},onClickCloseBtn:function(){for(var t in this.hero_list)this.hero_list[t].is_ui_select=!1,this.hero_list[t].is_ui_lock=!1;this.ctrl.openHeroUpgradeStarSelectPanel(!1)},updateSeletInfo:function(t){if(t.is_ui_select){var e=!1,i=this.dic_other_selected[this.need_index];for(var s in i)if(i[s].partner_id===t.partner_id){e=!0;break}e||this.dic_other_selected[this.need_index].push(t)}else{i=this.dic_other_selected[this.need_index];for(var s in i)if(i[s].partner_id===t.partner_id){i.splice(s,1);break}}this.udpateSelectNum()},onClickSelectBtn:function(){this.select_cb&&this.select_cb(this.dic_other_selected),this.ctrl.openHeroUpgradeStarSelectPanel(!1)},udpateSelectNum:function(){var t="";this.select_hero.count>1&&(t=this.dic_other_selected[this.need_index].length+"/"+this.select_hero.count),this.select_num_lb.string=t}});cc._RF.pop()},{common_scrollview:"common_scrollview",hero_const:"hero_const",pathtool:"pathtool"}],hero_vo:[function(t,e,i){"use strict";function s(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}cc._RF.push(e,"65e401GrPNMSJBVRQ85LY0j","hero_vo");var n=t("partner_const"),a=t("hero_const"),o=(a=t("hero_const"),t("goods_vo")),l=cc.Class({extends:gcore.BaseEvent,ctor:function(){this.partner_id=0,this.id=0,this.bid=0,this.camp_type=1,this.rare_type=0,this.name="",this.type=0,this.face_id=0,this.lev=0,this.exp=0,this.break_lev=0,this.max_exp=0,this.star_step=0,this.star=0,this.quality=0,this.looks={},this.body_res="",this.res_id="",this.power=0,this.rid=0,this.srv_id="",this.recruit_type=1,this.chips_id=0,this.chips_num=0,this.clothes_id=0,this.other_form=0,this.fetter={},this.fetter_power=0,this.fetter_atk=0,this.fetter_hp=0,this.fetter_speed=0,this.fetter_def=0,this.atk=0,this.def_p=0,this.def_s=0,this.hp=0,this.speed=0,this.def=0,this.hit_rate=0,this.dodge_rate=0,this.crit_rate=0,this.crit_ratio=0,this.hit_magic=0,this.dodge_magic=0,this.group_attr={},this.skills={},this.break_skills={},this.eqm_list={},this.artifact_list={},this.awaken_count=0,this.awaken_skills={},this.form_param=100,this.is_in_form=0,this.dic_in_form={},this.sort_order=0,this.show_order=0,this.order=0,this.is_lock=0,this.dic_locks={},this.red_point={},this.talent_skill_list=null},setAttr:function(t,e){this[t]=e},updateHeroVo:function(t){if(t){for(var e in t)this.setAttr(e,t[e]),"show_order"==e&&(this.sort_order=t[e]),"eqms"==e&&this.updateEqmList(t[e]),"artifacts"==e&&this.updateArtifactList(t[e]),"is_lock"==e&&this.updateLock(t[e]),"dower_skill"==e&&this.updateSkill(t[e]);this.fire(this.UPDATE_PARTNER_ATTR,this)}},updateSkill:function(t){this.talent_skill_list={};for(var e=0;e<t.length;++e){var i=t[e];this.talent_skill_list[i.pos]=i.skill_id}},updateEqmList:function(t){if(t){for(var e in t){var i=t[e],s=this.eqm_list[i.type];s||(this.eqm_list[i.type]=s=new o),s.setBaseId(i.base_id),s.initAttrData(i),s.setEnchantScore(0)}for(var n in this.eqm_list)if(this.eqm_list[n]){var a=this.eqm_list[n],l=!0;for(var r in t)t[r].base_id===a.base_id&&(l=!1);l&&(this.eqm_list[n]=null)}}},updateArtifactList:function(t){var e=t||{},i={};for(var s in e)i[e[s].artifact_pos]=e[s];for(s=1;s<=2;s++){var n=i[s],a=this.artifact_list[s];n&&a?a.initAttrData&&a.initAttrData(n):n&&null==a?((a=new o).setBaseId(n.base_id),a.initAttrData&&a.initAttrData(n),this.artifact_list[s]=a):null==n&&a&&(this.artifact_list[s]=null,a=null)}},updateLock:function(t){for(var e in this.is_lock=0,t){var i=t[e];this.dic_locks[i.lock_type]=i.is_lock,0==this.is_lock&&(this.is_lock=i.is_lock)}},isLock:function(){for(var t in this.dic_locks)if(this.dic_locks[t]>0)return!0;return!1},updateFormPos:function(t,e){for(var i in e=e||n.Fun_Form.Drama,t=t||0,this.is_in_form=0,0==t?delete this.dic_in_form[e]:this.dic_in_form[e]=t,this.dic_in_form){var s=10*i+this.dic_in_form[i];(0==this.is_in_form||this.is_in_form>s)&&(this.is_in_form=s)}this.updateHeroVo("is_in_form",this.is_in_form)},checkHeroLockTips:function(t,e){var i;t?(s(i={},1,a.LockType.eFormLock),s(i,2,a.LockType.eHeroLock),s(i,3,a.LockType.eHeroChangeLock),e=i):e=e||{};for(var o in e){var l=e[o];if(l==a.LockType.eFormLock){if(this.is_in_form>0){var r=Math.floor(this.is_in_form/this.form_param);return r==n.Fun_Form.Drama?message("\u8be5\u82f1\u96c4\u5df2\u4e0a\u9635\uff0c\u8bf7\u524d\u5f80\u82f1\u96c4-\u5e03\u9635\u754c\u9762\u4e0b\u9635"):r==n.Fun_Form.Arena?message("\u8be5\u82f1\u96c4\u5728\u7ade\u6280\u573a\u9632\u5b88\u9635\u5bb9\u4e2d\u5df2\u4e0a\u9635"):r!=n.Fun_Form.EliteMatch&&r!=n.Fun_Form.EliteKingMatch||message("\u8be5\u82f1\u96c4\u5728\u7cbe\u82f1\u8d5b\u9635\u5bb9\u4e2d\u5df2\u4e0a\u9635"),!0}}else if(this.dic_locks[l]&&this.dic_locks[l]>0)return l==a.LockType.eHeroLock?message("\u8be5\u82f1\u96c4\u5df2\u9501\u5b9a\uff0c\u8bf7\u524d\u5f80\u82f1\u96c4\u754c\u9762\u89e3\u9501"):l==a.LockType.eHeroChangeLock&&message("\u8be5\u82f1\u96c4\u8f6c\u6362\u4e2d\uff0c\u8bf7\u524d\u5f80\u5148\u77e5\u5723\u6bbf\u89e3\u9664"),!0}},isFormDrama:function(){if(this.is_in_form>0&&Math.floor(this.is_in_form/this.form_param)==n.Fun_Form.Drama)return!0;return!1},ishaveTalentData:function(){return!!this.talent_skill_list},updateRedPoint:function(t,e){null!=e&&this.red_point[t]!=e&&(this.red_point[t]=e,this.fire(l.UPDATE_Partner_ATTR,this))}});l.prototype.UPDATE_PARTNER_ATTR="UPDATE_PARTNER_ATTR",e.exports=l,cc._RF.pop()},{goods_vo:"goods_vo",hero_const:"hero_const",partner_const:"partner_const"}],heroexpedit_controller:[function(t,e,i){"use strict";cc._RF.push(e,"f7c5aZEqeBGzoV1Dxl18Q+q","heroexpedit_controller");t("login_event");var s=t("hero_controller"),n=t("esecsice_const"),a=t("heroexpedit_event"),o=t("mainui_controller"),l=cc.Class({extends:BaseController,ctor:function(){},initConfig:function(){var e=t("heroexpedit_model");this.model=new e,this.model.initConfig()},getModel:function(){return this.model},registerEvents:function(){null==this.role_event&&(this.role_event=gcore.GlobalEvent.bind(EventId.EVT_ROLE_CREATE_SUCCESS,function(){gcore.GlobalEvent.unbind(this.role_event),this.role_event=null}.bind(this))),null==this.re_link_game_event&&(this.re_link_game_event=gcore.GlobalEvent.bind(EventId.EVT_RE_LINK_GAME,function(){this.openHeroExpeditView(!1),this.openHeroExpeditLevelView(!1),this.openEmpolyPanelView(!1),this.openBrowsePanelView(!1)}.bind(this)))},registerProtocals:function(){this.RegisterProtocal(24400,this.handle24400),this.RegisterProtocal(24401,this.handle24401),this.RegisterProtocal(24402,this.handle24402),this.RegisterProtocal(24403,this.hander24403),this.RegisterProtocal(24404,this.hander24404),this.RegisterProtocal(24405,this.hander24405),this.RegisterProtocal(24406,this.hander24406),this.RegisterProtocal(24407,this.hander24407),this.RegisterProtocal(24408,this.hander24408),this.RegisterProtocal(24409,this.hander24409),this.RegisterProtocal(24410,this.hander24410)},sender24400:function(){this.SendProtocal(24400,{})},handle24400:function(t){this.model.setExpeditData(t),this.grard_id=t.guard_id,gcore.GlobalEvent.fire(a.HeroExpeditViewEvent,t),gcore.GlobalEvent.fire(a.Red_Point_Event)},getGrardID:function(){return this.grard_id||1},sender24401:function(t){var e={};e.id=t,this.SendProtocal(24401,e)},handle24401:function(t){if(t){var e=this.model.getExpeditBoxData(),i=!1;for(var s in e)if(e[s]==t.id){i=!0;break}1==i?this.openBrowsePanelView(!0,t):t.id<=this.grard_id?(this.openHeroExpeditLevelView(!0,t),gcore.GlobalEvent.fire(a.levelMessageEvent,t)):message(Utils.TI18N("\u5148\u901a\u5173\u524d\u7f6e\u5173\u5361"))}},sender24402:function(t){var e={};e.id=t,this.SendProtocal(24402,e)},handle24402:function(t){(message(t.msg),1==t.code)&&(this.model.getExpeditData().reward.push({reward_id:t.id}),gcore.GlobalEvent.fire(a.Get_Box_Event,t.id))},sender24403:function(t,e,i){var s={};s.formation_type=t,s.pos_info=e,s.hallows_id=i,this.SendProtocal(24403,s)},hander24403:function(t){message(t.msg),1==t.code&&s.getInstance().openFormGoFightPanel(!1)},sender24404:function(){this.SendProtocal(24404,{})},hander24404:function(t){this.model.setPartnerMessage(t.list),gcore.GlobalEvent.fire(a.EmployEvent)},sender24405:function(){this.SendProtocal(24405,{})},hander24405:function(t){this.model.setHeroSendRedPoint(t.list.length),gcore.GlobalEvent.fire(a.EmploySendEvent,t)},sender24406:function(){this.SendProtocal(24406,{})},hander24406:function(t){this.model.setEmployPartner(t.list)},sender24407:function(t){var e={};e.id=t,this.SendProtocal(24407,e)},hander24407:function(t){message(t.msg),1==t.code&&gcore.GlobalEvent.fire(a.EmploySendEvent_Success,t.id)},sender24409:function(){this.SendProtocal(24409,{})},hander24409:function(t){this.model.setHeroBloodById(t)},sender24410:function(){this.SendProtocal(24410,{})},hander24410:function(t){this.model.setLevelRedPoint(t.is_show)},sender24408:function(t,e,i){var s={};s.rid=t,s.srv_id=e,s.id=i,this.SendProtocal(24408,s)},hander24408:function(t){message(t.msg)},openHeroExpeditView:function(t){if(1==t){var e=Config.dailyplay_data.data_exerciseactivity[n.execsice_index.heroexpedit];if(null==e)return void message(Utils.TI18N("\u8fdc\u5f81\u6570\u636e\u5f02\u5e38"));if(0==(t=o.getInstance().checkIsOpenByActivate(e.activate)))return void message(e.lock_desc);this.heroExpeditView||(this.heroExpeditView=Utils.createClass("heroexpedit_window",this)),this.heroExpeditView&&0==this.heroExpeditView.isOpen()&&this.heroExpeditView.open()}else this.heroExpeditView&&(this.heroExpeditView.close(),this.heroExpeditView=null)},openHeroExpeditLevelView:function(t,e){1==t?(this.heroExpeditLevelView||(this.heroExpeditLevelView=Utils.createClass("heroexpedit_level_window",this)),this.heroExpeditLevelView&&0==this.heroExpeditLevelView.isOpen()&&this.heroExpeditLevelView.open(e)):this.heroExpeditLevelView&&(this.heroExpeditLevelView.close(),this.heroExpeditLevelView=null)},openEmpolyPanelView:function(t){1==t?(this.empolyPanelView||(this.empolyPanelView=Utils.createClass("empoly_window",this)),this.empolyPanelView&&0==this.empolyPanelView.isOpen()&&this.empolyPanelView.open()):this.empolyPanelView&&(this.empolyPanelView.close(),this.empolyPanelView=null)},openBrowsePanelView:function(t,e){1==t&&e?(this.browsePanelView||(this.browsePanelView=Utils.createClass("browse_window",this)),this.browsePanelView&&0==this.browsePanelView.isOpen()&&this.browsePanelView.open(e)):this.browsePanelView&&(this.browsePanelView.close(),this.browsePanelView=null)},__delete:function(){}});e.exports=l,cc._RF.pop()},{esecsice_const:"esecsice_const",hero_controller:"hero_controller",heroexpedit_event:"heroexpedit_event",heroexpedit_model:"heroexpedit_model",login_event:"login_event",mainui_controller:"mainui_controller"}],heroexpedit_event:[function(t,e,i){"use strict";cc._RF.push(e,"b37e5n4HzBM1KtIRWOZgaOi","heroexpedit_event");var s={EmployEvent:"HeroExpeditEvent.EmployEvent",EmploySendEvent:"HeroExpeditEvent.EmploySendEvent",levelMessageEvent:"HeroExpeditEvent.levelMessageEvent",EmploySendEvent_Success:"HeroExpeditEvent.EmploySendEvent_Success",HeroExpeditViewEvent:"HeroExpeditEvent.HeroExpeditViewEvent",Get_Box_Event:"HeroExpeditEvent.Get_Box_Event",Red_Point_Event:"HeroExpeditEvent.Red_Point_Event"};e.exports=s,cc._RF.pop()},{}],heroexpedit_level_window:[function(t,e,i){"use strict";cc._RF.push(e,"264f5s4vpRMBZlM3fqX4KCC","heroexpedit_level_window");var s=t("pathtool"),n=t("hero_const"),a=t("playerhead"),o=t("hero_controller"),l=t("partner_const"),r=t("heroexpedit_event"),c=t("common_scrollview");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("heroexpedit","level_message"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Tips,this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){this.reward_list=[]},openCallBack:function(){this.background=this.root_wnd.getChildByName("background"),this.background.scale=FIT_SCALE,this.main_container=this.root_wnd.getChildByName("main_container"),this.text_level_msg=this.main_container.getChildByName("Image_6").getChildByName("Text_7").getComponent(cc.Label),this.text_level_msg.string=Utils.TI18N(""),this.main_container.getChildByName("reward").getChildByName("Text_17_0").getComponent(cc.Label).string=Utils.TI18N("\u5956\u52b1"),this.reward_panel=this.main_container.getChildByName("reward").getChildByName("reward_panel"),this.main_container.getChildByName("enemy").getChildByName("Text_17").string=Utils.TI18N("\u654c\u65b9\u9635\u5bb9"),this.enemy_panel=this.main_container.getChildByName("enemy").getChildByName("enemy_panel"),this.btn_fight=this.main_container.getChildByName("btn_fight"),this.btn_fight.getChildByName("Text_6").getComponent(cc.Label).string=Utils.TI18N("\u6218\u6597"),this.text_name=this.main_container.getChildByName("text_name").getComponent(cc.Label),this.text_fight_power=this.main_container.getChildByName("text_fight_power").getComponent(cc.Label),this.data&&this.fightMessage(this.data)},fightMessage:function(t){if(this.root_wnd&&t){if(this.text_level_msg.string=Utils.TI18N("\u7b2c")+Config.expedition_data.data_sign_info[t.id].floor+Utils.TI18N("\u5173"),this.my_head=new a,this.my_head.setAnchorPoint(.5,.5),this.my_head.setPosition(166-this.main_container.width/2,541-this.main_container.height/2),this.my_head.setLev(t.lev),this.my_head.setParent(this.main_container),this.my_head.setHeadRes(t.face),this.my_head.show(),this.text_name.string=t.name,this.text_fight_power.string=t.power,t.rewards){var e=t.rewards.length,i=[];i=2==e?[166,423]:[166,296,423];for(var s=0;s<e;s++)this.reward_list[s]||(this.reward_list[s]=ItemsPool.getInstance().getItem("backpack_item"),this.reward_list[s].setParent(this.reward_panel),this.reward_list[s].initConfig(null,.9),this.reward_list[s].show()),this.reward_list[s]&&(this.reward_list[s].setPosition(i[s],55),25==t.rewards[s].bid&&1==t.is_holiday?this.reward_list[s].holidHeroExpeditTag(!0,"\u9650\u65f6\u63d0\u5347"):this.reward_list[s].holidHeroExpeditTag(!1),this.reward_list[s].setDefaultTip(),this.reward_list[s].setData({bid:t.rewards[s].bid,num:t.rewards[s].num}))}var o=this.enemy_panel.getContentSize();this.enemy_list=new c,this.enemy_list.createScroll(this.enemy_panel,cc.v2(-5,10),ScrollViewDir.horizontal,ScrollViewStartPos.top,o,{item_class:"hero_exhibition_item",start_x:0,space_x:0,start_y:4,space_y:0,item_width:119,item_height:119,row:1,col:1}),this.enemy_list.setClickEnabled(!1);var l=[];for(var s in t.guards){var r=t.guards[s],_={};_.bid=r.bid,_.star=r.star,_.blood=r.hp_per,_.lev=r.lev,l.push(_)}this.enemy_list.setData(l,null,{scale:.8,can_click:!1,from_type:n.ExhibitionItemType.eExpeditFight})}},registerEvent:function(){this.addGlobalEvent(r.levelMessageEvent,function(t){t&&(this.data=t,this.fightMessage(t))}.bind(this)),Utils.onTouchEnd(this.btn_fight,function(){this.ctrl.openHeroExpeditLevelView(!1),o.getInstance().openFormGoFightPanel(!0,l.Fun_Form.Expedit_Fight),this.ctrl.sender24404()}.bind(this),1),Utils.onTouchEnd(this.background,function(){this.ctrl.openHeroExpeditLevelView(!1)}.bind(this),2)},openRootWnd:function(t){t&&(this.data=t,this.fightMessage(t))},closeCallBack:function(){if(this.reward_list&&null!=Utils.next(this.reward_list||[]))for(var t in this.reward_list)this.reward_list[t].deleteMe&&this.reward_list[t].deleteMe();this.data=null,this.my_head&&(this.my_head.deleteMe(),this.my_head=null),this.enemy_list&&(this.enemy_list.deleteMe(),this.enemy_list=null),this.ctrl.openHeroExpeditLevelView(!1)}});cc._RF.pop()},{common_scrollview:"common_scrollview",hero_const:"hero_const",hero_controller:"hero_controller",heroexpedit_event:"heroexpedit_event",partner_const:"partner_const",pathtool:"pathtool",playerhead:"playerhead"}],heroexpedit_model:[function(t,e,i){"use strict";cc._RF.push(e,"b8c23UwNytK6oKjkXgsjzI7","heroexpedit_model");var s=t("mainui_controller"),n=t("role_controller"),a=t("heroexpedit_event"),o=t("esecsice_const"),l=t("mainui_const");cc.Class({extends:BaseClass,ctor:function(){this.ctrl=arguments[0]},properties:{},initConfig:function(){this.levelRedPointStatus=0,this.sendRedPointStatus=0},setEmployPartner:function(t){this.employPartner=t},getEmployPartner:function(){return this.employPartner||{}},setPartnerMessage:function(t){this.partnerMessage=t},getPartnerMessage:function(){return this.partnerMessage||{}},setExpeditData:function(t){t&&(this.expeditData=t,this.guard_id=t.guard_id,this.updateRedPoint())},updateRedPoint:function(){RedMgr.getInstance().addCalHandler(this.checkRed.bind(this),RedIds.Heroexpedit)},checkRed:function(){var e=this.checkRedStatus(),i=t("scene_const");s.getInstance().setBtnRedPoint(l.btn_index.esecsice,{bid:i.RedPointType.heroexpedit,status:e})},getExpeditData:function(){return this.expeditData||{}},setLevelRedPoint:function(t){this.levelRedPointStatus=t},setHeroSendRedPoint:function(t){t=0==t?1:0,this.sendRedPointStatus=t,gcore.GlobalEvent.fire(a.Red_Point_Event)},getHeroSendRedPoint:function(){return 1==this.sendRedPointStatus},checkRedStatus:function(){var t=Config.dailyplay_data.data_exerciseactivity;if(0==s.getInstance().checkIsOpenByActivate(t[o.execsice_index.heroexpedit].activate))return!1;return!(this.levelRedPointStatus+this.sendRedPointStatus<=0)},getExpeditBoxData:function(){var t=[],e=Config.expedition_data.data_sign_info;for(var i in e)2==e[i].type&&t.push(i);return t},setHeroBloodById:function(t){this.HeroBloodData=[],this.hireHeroData=[],this.hireHeroIsUsedData=[],this.setExpeditEmployData(t.list);var e=n.getInstance().getRoleVo(),i=0,s="";for(var a in e&&(i=e.rid,s=e.srv_id),t.p_list){var o=Utils.getNorKey(i,s,t.p_list[a].id);this.HeroBloodData[o]=t.p_list[a].hp_per}if(null!=Utils.next(t.list))for(var l in t.list){o=Utils.getNorKey(t.list[l].rid,t.list[l].srv_id,t.list[l].id);this.hireHeroData[o]=!0,this.HeroBloodData[o]=t.list[l].hp_per,this.hireHeroIsUsedData[o]=t.list[l].is_used}},getHeroBloodById:function(t,e,i){if(!this.HeroBloodData)return 100;if(!t||"number"!=typeof t)return 100;e=e||0,i=i||"";var s=Utils.getNorKey(e,i,t);return null==this.HeroBloodData[s]?100:this.HeroBloodData[s]},getHireHero:function(t,e,i){if(!this.hireHeroData)return!1;if(!t||"number"!=typeof t)return!1;e=e||0,i=i||"";var s=Utils.getNorKey(e,i,t);return this.hireHeroData[s]||!1},getHireHeroIsUsed:function(t,e,i){if(!this.hireHeroIsUsedData)return 0;if(!t||"number"!=typeof t)return 0;e=e||0,i=i||"";var s=Utils.getNorKey(e,i,t);return this.hireHeroIsUsedData[s]||0},setExpeditEmployData:function(t){this.expeditEmployData=t},getExpeditEmployData:function(){return this.expeditEmployData||{}},__delete:function(){}});cc._RF.pop()},{esecsice_const:"esecsice_const",heroexpedit_event:"heroexpedit_event",mainui_const:"mainui_const",mainui_controller:"mainui_controller",role_controller:"role_controller",scene_const:"scene_const"}],heroexpedit_window:[function(t,e,i){"use strict";cc._RF.push(e,"93d9aNnNEhEVpVXXZpmV+Mk","heroexpedit_window");var s=t("pathtool"),n=t("mall_controller"),a=t("mall_const"),o=t("heroexpedit_event");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("heroexpedit","hero_expedit_window"),this.viewTag=SCENE_TAG.ui,this.win_type=WinType.Full,this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){this.map_center=360,this.sign_info=Config.expedition_data.data_sign_info,this.point_num=Config.expedition_data.data_sign_info_length,this.box_num=5,this.box_index=0,this.box_list={},this.point_list={},this.facial_list={},this.point_img_list={},this.play_effect={},this.mouseDown=!1},openCallBack:function(){this.main_container=this.root_wnd.getChildByName("main_container"),this.bigBg=this.root_wnd.getChildByName("bigBg"),this.bigBg.scale=FIT_SCALE,this.expedit_bg=this.bigBg.getChildByName("bg"),this.expedit_bg_sp=this.bigBg.getChildByName("bg").getComponent(cc.Sprite),this.close_btn=this.main_container.getChildByName("btn_return"),this.map_layer=this.bigBg.getChildByName("map_layer"),this.btn_employ=this.main_container.getChildByName("btn_employ"),this.btn_employ.getChildByName("Text_1").getComponent(cc.Label).string=Utils.TI18N("\u597d\u53cb\u52a9\u9635"),this.btn_shop=this.main_container.getChildByName("btn_shop"),this.btn_shop.getChildByName("Text_1_0").getComponent(cc.Label).string=Utils.TI18N("\u8fdc\u5f81\u5546\u5e97"),this.btn_rule=this.main_container.getChildByName("btn_rule"),this.get_reward_bg=this.main_container.getChildByName("get_reward_bg"),this.get_reward_bg.getChildByName("Image_2").getChildByName("Text_2").getComponent(cc.Label).string=Utils.TI18N("\u4eca\u65e5\u5df2\u83b7\u53d6\u5956\u52b1\uff1a"),this.expedit_img_1=this.get_reward_bg.getChildByName("expedit_img_1").getComponent(cc.Sprite),this.expedit_img_2=this.get_reward_bg.getChildByName("expedit_img_2").getComponent(cc.Sprite),this.expedit_reward=[];for(var t=[72,33],e=0;e<2;e++)this.expedit_reward[e]=Utils.createRichLabel(24,new cc.Color(255,246,199,255),cc.v2(0,.5),cc.v2(0,0),30,250),this.expedit_reward[e].horizontalAlign=cc.macro.TextAlignment.LEFT,this.get_reward_bg.addChild(this.expedit_reward[e].node),this.expedit_reward[e].node.setPosition(60,t[e])},registerEvent:function(){this.addGlobalEvent(o.HeroExpeditViewEvent,function(t){if(t){for(var e in t.rewards){var i=Utils.getItemConfig(t.rewards[e].bid),n=s.getItemRes(i.icon),a=cc.js.formatStr("%d",t.rewards[e].num);this.expedit_reward[e].string=a,0==e&&this.expedit_img_1?this.loadRes(n,function(t){this.expedit_img_1.spriteFrame=t}.bind(this)):1==e&&this.expedit_img_2&&this.loadRes(n,function(t){this.expedit_img_2.spriteFrame=t}.bind(this))}if(this.point_list[t.guard_id]){this.point_img_list[t.guard_id].setMaterial(0,cc.Material.getBuiltinMaterial("2d-sprite"));var o=t.guard_id,l=this.model.getExpeditBoxData(),r=!1;for(var c in l)if(l[c]==t.guard_id-1){r=!0;break}if((o-=1==r?2:1)<=0&&(o=1),this.facial_list[t.guard_id]){n=s.getUIIconPath("heroexpedit","heroexpedit_8");this.loadRes(n,function(e){this.facial_list[t.guard_id].spriteFrame=e}.bind(this))}else{this.point_list[t.guard_id].setContentSize(cc.size(38,100)),this.facial_list[t.guard_id]=Utils.createImage(this.point_list[t.guard_id],null,-19,40,cc.v2(0,0),!1);var n=s.getUIIconPath("heroexpedit","heroexpedit_8");this.loadRes(n,function(e){this.facial_list[t.guard_id].spriteFrame=e}.bind(this))}if(this.facial_list[o]){n=s.getUIIconPath("heroexpedit","heroexpedit_7");this.loadRes(n,function(t){this.facial_list[o].spriteFrame=t}.bind(this))}if(t.guard_id==this.point_num-1){n=s.getUIIconPath("heroexpedit","heroexpedit_8");this.loadRes(n,function(e){this.facial_list[t.guard_id].spriteFrame=e}.bind(this))}}if(t.guard_id>this.point_num&&this.facial_list[this.point_num-1]){n=s.getUIIconPath("heroexpedit","heroexpedit_7");this.loadRes(n,function(t){this.facial_list[this.point_num-1].spriteFrame=t}.bind(this))}var _=this.model.getExpeditBoxData(),h=0;for(var e in _)if(_[e]==t.guard_id-1)for(var c in h=1,t.reward)if(t.reward[c].reward_id==t.guard_id-1){h=2;break}this.boxInfo={pos_status:h,guard_id:t.guard_id-1},this.checkBoxStatus(h,t.guard_id-1)}}.bind(this)),this.addGlobalEvent(o.Get_Box_Event,function(t){this.checkBoxStatus(2,t)}.bind(this)),this.addGlobalEvent(o.EmploySendEvent,function(t){var e=this.model.getHeroSendRedPoint();Utils.addRedPointToNodeByStatus(this.btn_employ,e)}.bind(this)),Utils.onTouchEnd(this.close_btn,function(){this.ctrl.openHeroExpeditView(!1)}.bind(this),2),Utils.onTouchEnd(this.btn_employ,function(){this.ctrl.openEmpolyPanelView(!0)}.bind(this),1),Utils.onTouchEnd(this.btn_shop,function(){n.getInstance().openMallPanel(!0,a.MallType.ScoreShop)}.bind(this),1),this.btn_rule.on(cc.Node.EventType.TOUCH_END,function(e){Utils.playButtonSound(1);var i=Config.expedition_data.data_const.game_rule,s=e.touch.getLocation();t("tips_controller").getInstance().showCommonTips(i.desc,s,null,null,500)},this)},checkBoxStatus:function(t,e){if(!(e<=0)){var i=this.model.getExpeditBoxData(),s=0;for(var n in i)if(i[n]==e){s=parseInt(n)+1;break}this.updateTaskList(t,s)}},setBorder:function(t){var e=this.expedit_bg.x+t;return e>=this.move_pos&&(e=this.move_pos),e<=-this.expedit_bg.width*FIT_SCALE+2*this.map_center*FIT_SCALE&&(e=-this.expedit_bg.width*FIT_SCALE+2*this.map_center*FIT_SCALE),e},setVisible:function(t){this._super(t),t&&this.boxInfo&&null!=this.boxInfo.pos_status&&null!=this.boxInfo.guard_id&&(this.checkBoxStatus(this.boxInfo.pos_status,this.boxInfo.guard_id),this.boxInfo=null)},updateTaskList:function(t,e){var i=PlayerAction.action_2;if(0==t?i=PlayerAction.action_1:1==t?i=PlayerAction.action_2:2==t&&(i=PlayerAction.action_3),this.play_effect[e]&&(this.play_effect[e].setToSetupPose(),this.play_effect[e].clearTracks(),this.play_effect[e]=null),this.box_list[e]&&null==this.play_effect[e]){var n=new cc.Node;n.setContentSize(cc.size(62,44)),n.setAnchorPoint(.5,.5),n.setPosition(this.box_list[e].x,this.box_list[e].y),this.expedit_bg.addChild(n,0),this.play_effect[e]=n.addComponent(sp.Skeleton);var a=s.getSpinePath("E51087","action");this.loadRes(a,function(t){this.play_effect[e].skeletonData=t,this.play_effect[e].setAnimation(0,i,!0)}.bind(this))}},register_event:function(){this.map_layer.on(cc.Node.EventType.TOUCH_START,function(t){this.touch_point=null,this.expedit_bg.stopAllActions(),this.mouseDown=!0},this),this.map_layer.on(cc.Node.EventType.TOUCH_MOVE,function(t){if(this.mouseDown){var e=t.getTouches();this.touch_point=e[0].getDelta();var i=this.setBorder(this.touch_point.x);this.expedit_bg.x=i}},this),this.map_layer.on(cc.Node.EventType.TOUCH_END,function(t){this.mouseDown=!1},this)},openRootWnd:function(t){var e=this.model.getExpeditData();(e||null!=Utils.next(e))&&this.loadRes(s.getBigBg("heroexpedit_bg",null,"heroexpedit"),function(t){this.expedit_bg_sp.spriteFrame=t,this.move_pos=0,e.guard_id=e.guard_id||1,e.guard_id<=3&&(this.expedit_bg.x=this.move_pos)}.bind(this));var i=this.model.getHeroSendRedPoint();Utils.addRedPointToNodeByStatus(this.btn_employ,i),this.register_event(),this.createBoxOrPoint()},createBoxOrPoint:function(){var t=[0,0,0,0,0,0,0],e=this.model.getExpeditBoxData(),i=this.model.getExpeditData();if(i&&null!=Utils.next(i)){if(null!=Utils.next(i))for(var n in e)for(var a in i.guard_id>=e[n]&&(t[n]=1),i.reward)e[n]==i.reward[a].reward_id&&(t[n]=2);for(var o=1;o<=this.point_num;o++)gcore.Timer.set(function(e){if(1==this.sign_info[e].type){this.point_list[e]=new cc.Node,this.point_list[e].setAnchorPoint(.5,0),this.point_list[e].setPosition(this.sign_info[e].pos[0][0],this.sign_info[e].pos[0][1]),this.expedit_bg.addChild(this.point_list[e]);var n=this.point_list[e].addComponent(cc.Button);n.transition=cc.Button.Transition.SCALE,n.zoomScale=.9,this.point_img_list[e]=Utils.createImage(this.point_list[e],null,-19,0,cc.v2(0,0),!1);var a=s.getUIIconPath("heroexpedit","heroexpedit_6");if(this.loadRes(a,function(t){this.point_img_list[e].spriteFrame=t}.bind(this)),e==i.guard_id){if(!this.facial_list[e]){this.point_list[e].setContentSize(cc.size(38,100)),this.facial_list[e]=Utils.createImage(this.point_list[e],null,-19,40,cc.v2(0,0),!1);a=s.getUIIconPath("heroexpedit","heroexpedit_8");this.loadRes(a,function(t){this.facial_list[e].spriteFrame=t}.bind(this))}}else if(e<i.guard_id){if(!this.facial_list[e]){this.point_list[e].setContentSize(cc.size(38,100)),this.facial_list[e]=Utils.createImage(this.point_list[e],null,-19,40,cc.v2(0,0),!1);a=s.getUIIconPath("heroexpedit","heroexpedit_7");this.loadRes(a,function(t){this.facial_list[e].spriteFrame=t}.bind(this))}}else this.point_img_list[e].setMaterial(0,cc.Material.getBuiltinMaterial("2d-gray-sprite")),this.point_list[e].setContentSize(cc.size(38,40));Utils.onTouchEnd(this.point_list[e],function(t){this.ctrl.sender24401(t)}.bind(this,e),1)}else 2==this.sign_info[e].type&&(this.box_index=this.box_index+1,this.box_list[this.box_index]=new cc.Node,Utils.onTouchEnd(this.box_list[this.box_index],function(t){this.ctrl.getGrardID()>=t?this.ctrl.sender24402(t):this.ctrl.sender24401(t)}.bind(this,e),1),this.box_list[this.box_index].setContentSize(cc.size(100,100)),this.box_list[this.box_index].setAnchorPoint(.5,.5),this.box_list[this.box_index].setPosition(this.sign_info[e].pos[0][0],this.sign_info[e].pos[0][1]),this.expedit_bg.addChild(this.box_list[this.box_index]),this.updateTaskList(t[this.box_index-1],this.box_index))}.bind(this,o),2*o/60,1);this.ctrl.sender24400()}},closeCallBack:function(){if(this.play_effect&&null!=Utils.next(this.play_effect||[]))for(var t=1;t<=this.box_num;t++)this.play_effect[t]&&(this.play_effect[t].setToSetupPose(),this.play_effect[t].clearTracks(),this.play_effect[t]=null);this.map_center=null,this.sign_info=null,this.point_num=null,this.box_num=null,this.box_index=null,this.box_list=null,this.point_list=null,this.facial_list=null,this.point_img_list=null,this.play_effect=null,this.mouseDown=null,this.ctrl.openHeroExpeditView(!1)}});cc._RF.pop()},{heroexpedit_event:"heroexpedit_event",mall_const:"mall_const",mall_controller:"mall_controller",pathtool:"pathtool",tips_controller:"tips_controller"}],honor_yueka_panel:[function(t,e,i){"use strict";cc._RF.push(e,"209b4GmNiZKIYwz7bslKNLz","honor_yueka_panel");var s=t("pathtool"),n=t("welfare_controller"),a=t("welfare_event"),o=t("timetool");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("welfare","yueka_panel")},initConfig:function(){this.ctrl=n.getInstance(),this.card_data=Config.charge_data.data_constant,this.card2_add_count=this.card_data.month_card2_sun.val,this.item_bid_1=this.card_data.month_card2_items.val[0][0],this.item_num_1=this.card_data.month_card2_items.val[0][1],this.add_get_day_1=this.card_data.month_card2_cont_day.val,this.current_day=0},initPanel:function(){this.main_container=this.seekChild("main_container");var t=this.seekChild(this.main_container,"bg",cc.Sprite),e=s.getBigBg("txt_cn_welfare_yueka_bg2",null,"welfare");this.loadRes(e,function(e){t.spriteFrame=e}.bind(this)),this.btn_1_nd=this.seekChild(this.main_container,"btn_1"),this.seekChild(this.btn_1_nd,"Text_1",cc.Label).string=Utils.TI18N("\u5145\u503c\u6fc0\u6d3b"),this.bar_pb=this.seekChild(this.main_container,"bar",cc.ProgressBar),this.bar_pb.progress=0,this.current_change_lb=this.seekChild("current_change",cc.Label),this.btn_rule_nd=this.seekChild("btn_rule"),this.btn_rule_nd.active=!1,this.image_get_nd=this.seekChild("image_get"),this.image_get_nd.active=!1,this.seekChild("Text_3").active=!1,this.text_day_lb=this.seekChild(this.image_get_nd,"text_day",cc.Label),this.text_day_lb.string="",this.text_time_lb=this.seekChild(this.image_get_nd,"text_time",cc.Label),this.btn_get_nd=this.seekChild(this.image_get_nd,"btn_get"),this.btn_get_btn=this.seekChild(this.image_get_nd,"btn_get",cc.Button),this.btn_get_lb=this.seekChild(this.btn_get_nd,"Text_4",cc.Label),this.btn_get_lo=this.seekChild(this.btn_get_nd,"Text_4",cc.LabelOutline),this.btn_get_lb.string="\u9886\u53d6";var i=this.seekChild(this.main_container,"Image_1_0");this.text_1_rt=this.seekChild(i,"text_1",cc.RichText),this.text_2_rt=this.seekChild(this.main_container,"text_2",cc.RichText),this.text_3_rt=this.seekChild(this.main_container,"text_3",cc.RichText),this.text_1_rt.string=cc.js.formatStr(Utils.TI18N("<outline width=1 color=#110800>\u4efb\u610f\u7d2f\u8ba1\u5145\u503c\u8fbe\u5230</outline><color=#ffb502> %d\u5143 </c><outline width=1,color=#110800>\u5373\u53ef\u6fc0\u6d3b</outline>"),this.card2_add_count);var n=Utils.getItemConfig(this.card_data.month_card2_return.val[0][0]);this.text_2_rt.string=cc.js.formatStr(Utils.TI18N("<outline width=1 color=#110800>\u5145\u503c\u9001\u8d85\u503c\u6708\u5361,</outline><outline width=1 color=#000000><color=#ffb502 > \u8fd4\u8fd8%d </c></outline><img src=%s visible=true scale=0.30 />"),this.card_data.month_card2_return.val[0][1],s.getItemRes(n.icon));n=Utils.getItemConfig(this.item_bid_1);this.text_3_rt.string=cc.js.formatStr(Utils.TI18N("<outline width=1 color=#110800>\u6bcf\u65e5\u53ef\u9886\u53d6</outline><color=#ffb502 ><outline width=1 color=#000000> %d</outline> </c><img src=%s visible=true scale=0.30 /><outline width=1 color=#110800>\u6301\u7eed </outline><color=#ffb502 ><outline width=1 color=#000000>%d\u5929</outline></c>"),this.item_num_1,s.getItemRes(n.icon),this.add_get_day_1)},registerEvent:function(){this.addGlobalEvent(a.Update_Yueka,function(t){var e=100,i=100,s=null,n=null,a=0,l=0,r=0;if(0==t.card2_is_reward)this.image_get_nd.active=!1,this.btn_1_nd.active=!0,e=this.card2_add_count,i=t.card2_acc;else if(1==t.card2_is_reward||2==t.card2_is_reward){s=this.item_bid_1,n=this.item_num_1,l=t.card2_days,a=this.add_get_day_1,r=t.card2_end_time,this.current_day=l,this.image_get_nd.active=!0,this.btn_1_nd.active=!1,1==t.card2_is_reward?(Utils.setGreyButton(this.btn_get_btn,!1),this.btn_get_lb.string=Utils.TI18N("\u9886\u53d6"),this.btn_get_lo.enabled=!0):2==t.card2_is_reward&&(Utils.setGreyButton(this.btn_get_btn,!0),this.btn_get_lb.string=Utils.TI18N("\u5df2\u9886\u53d6"),this.btn_get_lo.enabled=!1);var c=r-86400*a,_=cc.js.formatStr("%s - %s",o.getMD2(c),o.getMD2(r-1));this.text_time_lb.string=_}this.bar_pb.progress=i/e;_=cc.js.formatStr(Utils.TI18N("\u5f53\u524d\u5145\u503c\uff1a%d / %d"),i,e);this.current_change_lb.string=_,s&&n&&(this.reward_item||(this.reward_item=ItemsPool.getInstance().getItem("backpack_item"),this.reward_item.initConfig(null,1,!1,!0),this.reward_item.show(),this.reward_item.setPosition(-260,0),this.reward_item.setParent(this.image_get_nd)),this.reward_item&&this.reward_item.setData({bid:s,num:n})),this.text_day_lb.string=this.current_day},this),this.addGlobalEvent(a.Update_Get_Yueka,function(t){2==t&&(Utils.setGreyButton(this.btn_get_btn,!0),this.btn_get_lb.string=Utils.TI18N("\u5df2\u9886\u53d6"),this.btn_get_lo.enabled=!1,this.current_day=this.current_day+1,this.text_day_lb.string=this.current_day)},this),Utils.onTouchEnd(this.btn_1_nd,function(){t("vip_controller").getInstance().openVipMainWindow(!0,VIPTABCONST.CHARGE)}.bind(this),1),Utils.onTouchEnd(this.btn_get_nd,function(){this.ctrl.sender16706(2)}.bind(this),1),this.ctrl.sender16705()},onShow:function(t){},setVisibleStatus:function(t){t=t||!1,this.setVisible(t)},onHide:function(){},onDelete:function(){this.reward_item&&(this.reward_item.deleteMe(),this.reward_item=null)}});cc._RF.pop()},{pathtool:"pathtool",timetool:"timetool",vip_controller:"vip_controller",welfare_controller:"welfare_controller",welfare_event:"welfare_event"}],invitecode_controller:[function(t,e,i){"use strict";cc._RF.push(e,"b4d29m3uRlAvKK7Kusktn0z","invitecode_controller");var s=t("invitecode_event"),n=cc.Class({extends:BaseController,ctor:function(){},initConfig:function(){var e=t("invitecode_model");this.model=new e,this.model.initConfig()},getModel:function(){return this.model},registerEvents:function(){},registerProtocals:function(){this.RegisterProtocal(19800,this.handle19800),this.RegisterProtocal(19801,this.handle19801),this.RegisterProtocal(19802,this.handle19802),this.RegisterProtocal(19803,this.handle19803),this.RegisterProtocal(19804,this.handle19804),this.RegisterProtocal(19805,this.handle19805),this.RegisterProtocal(19807,this.handle19807)},requestProto:function(){this.sender19800(),this.sender19804(),this.sender19802()},sender19800:function(){this.SendProtocal(19800,{})},handle19800:function(t){this.model.setInviteCode(t.code),gcore.GlobalEvent.fire(s.Get_InviteCode_Event)},sender19801:function(t){var e={};e.code=t,this.SendProtocal(19801,e)},handle19801:function(t){message(t.msg),gcore.GlobalEvent.fire(s.BindCode_Invite_Event,t)},sender19804:function(){this.SendProtocal(19804,{})},handle19804:function(t){this.model.setInviteCodeTeskData(t.list),gcore.GlobalEvent.fire(s.InviteCode_My_Event)},getInviteCodeRepoint:function(e){if(null!=Utils.next(e)){var i=!1;if(SHOW_SINGLE_INVICODE)for(var s in e)if(e[s]&&e[s].num>e[s].had){i=!0;break}var n=t("welfare_const");t("welfare_controller").getInstance().setWelfareStatus(n.WelfareIcon.invicode,i)}},sender19805:function(t){var e={};e.id=t,this.SendProtocal(19805,e)},handle19805:function(t){message(t.msg),1==t.code&&(this.model.setUpdataInviteCodeTeskData(t),gcore.GlobalEvent.fire(s.InviteCode_My_Event))},sender19802:function(){this.SendProtocal(19802,{})},handle19802:function(t){this.model.setAlreadyFriendData(t.list),gcore.GlobalEvent.fire(s.InviteCode_BindRole_Event)},handle19803:function(t){this.model.setUpdataAlreadyFriendData(t),gcore.GlobalEvent.fire(s.InviteCode_BindRole_Updata_Event)},sender19807:function(){this.SendProtocal(19807,{})},handle19807:function(t){this.model.addFriendChatData(t)}});e.exports=n,cc._RF.pop()},{invitecode_event:"invitecode_event",invitecode_model:"invitecode_model",welfare_const:"welfare_const",welfare_controller:"welfare_controller"}],invitecode_event:[function(t,e,i){"use strict";cc._RF.push(e,"d14c6chsuBJqZP5HwvRng7e","invitecode_event"),e.exports={InviteCode_My_Event:"InviteCode_My_Event",InviteCode_BindRole_Event:"InviteCode_BindRole_Event",InviteCode_BindRole_Updata_Event:"InviteCode_BindRole_Updata_Event",BindCode_Invite_Event:"BindCode_Invite_Event",Get_InviteCode_Event:"Get_InviteCode_Event"},cc._RF.pop()},{}],invitecode_friend_item:[function(t,e,i){"use strict";cc._RF.push(e,"58c93Xnzn1Onq6wYanxiRGx","invitecode_friend_item");var s=t("pathtool"),n=t("playerhead"),a=t("functiontool"),o=t("chat_const");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("invitecode","invitecode_friend_item")},initConfig:function(){},initPanel:function(){this.main_container=this.seekChild("main_container"),this.btn_chat=this.seekChild("btn_chat"),this.power_text_lb=this.seekChild("power_text",cc.Label),this.power_text_lb.string="0",this.name_text_lb=this.seekChild("name_text",cc.Label),this.name_text_lb.string="",this.player_head=new n,this.player_head.setParent(this.main_container),this.player_head.show(),this.player_head.setScale(1),this.player_head.setPosition(67,62),this.vip_num_cr=this.seekChild("vip_num").getComponent("CusRichText")},registerEvent:function(){Utils.onTouchEnd(this.btn_chat,function(){this.data&&t("chat_controller").getInstance().openChatPanel(o.Channel.Friend,"friend",this.data)}.bind(this),1),this.player_head&&this.player_head.addCallBack(function(){if(this.data){var e=t("role_controller").getInstance().getRoleVo(),i=this.data.rid,s=this.data.srv_id;if(e.rid==i&&e.srv_id==s)return;var n={rid:i,srv_id:s};t("chat_controller").getInstance().openFriendInfo(n)}}.bind(this))},setData:function(t){this.data=t,this.root_wnd&&this.onShow()},onShow:function(t){if(null!=this.data){var e=this.data;this.vip_num_cr.setNum(e.vip||0),this.player_head.setHeadRes(e.face_id),this.player_head.setLev(e.lev),this.power_text_lb.string=e.power;var i=a.getServerName(e.srv_id),s=cc.js.formatStr("[%s]%s",i,e.name);this.name_text_lb.string=s}},onHide:function(){},onDelete:function(){}});cc._RF.pop()},{chat_const:"chat_const",chat_controller:"chat_controller",functiontool:"functiontool",pathtool:"pathtool",playerhead:"playerhead",role_controller:"role_controller"}],invitecode_friend_panel:[function(t,e,i){"use strict";cc._RF.push(e,"e04e3eu/r5D0IHLVHJmCgx2","invitecode_friend_panel");var s=t("pathtool"),n=t("invitecode_friend_item"),a=t("invitecode_event"),o=t("common_scrollview");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("invitecode","invitecode_friend_panel")},initConfig:function(){this.ctrl=t("invitecode_controller").getInstance()},initPanel:function(){this.main_container=this.seekChild("main_container"),this.empty_bg_sp=this.seekChild("empty_bg",cc.Sprite),this.empty_bg_sp.node.active=!1;var t=this.seekChild(this.main_container,"good_cons"),e=t.getContentSize(),i=cc.size(e.width,e.height),s={item_class:n,start_x:16,space_x:0,start_y:0,space_y:3,item_width:690,item_height:117,row:0,col:1,need_dynamic:!0};this.order_scrollview=new o,this.order_scrollview.createScroll(t,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,i,s,cc.v2(.5,.5))},registerEvent:function(){this.addGlobalEvent(a.InviteCode_BindRole_Updata_Event,function(){this.empty_bg_sp.node&&(this.empty_bg_sp.node.active=!1);var t=this.ctrl.getModel().getAlreadyFriendData();this.order_scrollview&&this.order_scrollview.setData(t)},this)},onShow:function(t){this.setFriendList()},setFriendList:function(){if(this.order_scrollview){var t=this.ctrl.getModel().getAlreadyFriendData();0==t.length?(this.empty_bg_sp.node.active=!0,this.loadRes(s.getUIIconPath("bigbg","bigbg_3"),function(t){this.empty_bg_sp.spriteFrame=t}.bind(this))):(this.empty_bg_sp.node.active=!1,this.order_scrollview.setData(t))}},setVisibleStatus:function(t){this.setVisible(t)},onHide:function(){},onDelete:function(){this.order_scrollview&&(this.order_scrollview.deleteMe(),this.order_scrollview=null)}});cc._RF.pop()},{common_scrollview:"common_scrollview",invitecode_controller:"invitecode_controller",invitecode_event:"invitecode_event",invitecode_friend_item:"invitecode_friend_item",pathtool:"pathtool"}],invitecode_model:[function(t,e,i){"use strict";function s(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}cc._RF.push(e,"a712ebQpLNBfIaH5FFoxrI+","invitecode_model");cc.Class({extends:BaseClass,ctor:function(){},properties:{},initConfig:function(){this.teskData={},this.friend_data={},this.friend_chat_data={}},setInviteCode:function(t){this.invite_code=t},getInviteCode:function(){return this.invite_code||"\u83b7\u53d6\u63a8\u8350\u7801\u5931\u8d25"},setInviteCodeTeskData:function(t){for(var e in t){var i=t[e];this.teskData[i.id]=i}this.checkoutInviteRedPoint()},setUpdataInviteCodeTeskData:function(t){if(this.teskData&&this.teskData[t.id]){var e={};e.id=t.id,e.had=t.had,e.num=t.num,this.teskData[t.id]=e}this.checkoutInviteRedPoint()},checkoutInviteRedPoint:function(){var e=!1;if(this.teskData)for(var i in this.teskData){var s=this.teskData[i];if(s.num>s.had){e=!0;break}}this.invite_redpoint=e;var n=t("welfare_const");t("welfare_controller").getInstance().setWelfareStatus(n.WelfareIcon.invicode,e)},getInviteCodeFinishData:function(t){return this.teskData&&this.teskData[t]?this.teskData[t]:{}},getInviteCodeTeskData:function(){var t=[];for(var e in Config.invite_code_data.data_tesk_list){var i=Config.invite_code_data.data_tesk_list[e];i.status=0,null!=this.teskData[i.id]&&(this.teskData[i.id].had>=i.num?i.status=2:i.status=1),t.push(i)}return this.setSortItem(t),t},setSortItem:function(t){var e,i=(s(e={},0,2),s(e,1,1),s(e,2,3),e);t.sort(function(t,e){return t.status!=e.status?i[t.status]&&i[e.status]?i[t.status]-i[e.status]:1:t.id-e.id})},setFriendChatData:function(){if(this.friend_data)for(var t in this.friend_data){var e=this.friend_data[t],i=Utils.getNorKey(e.rid,e.srv_id);this.friend_chat_data[i]=e}},addFriendChatData:function(t){if(t&&null!=Utils.next(t)){var e=Utils.getNorKey(t.rid,t.srv_id);null==this.friend_chat_data[e]&&(this.friend_chat_data[e]=t)}},getFriendChatData:function(t,e){if(this.friend_chat_data){var i=Utils.getNorKey(t,e);return this.friend_chat_data[i]||null}return null},setAlreadyFriendData:function(t){for(var e in t){var i=t[e],s=Utils.getNorKey(i.rid,i.srv_id);this.friend_data[s]=i}this.setFriendChatData()},getAlreadyFriendData:function(){if(!this.friend_data||null==Utils.next(this.friend_data))return[];var t=[];for(var e in this.friend_data)t.push(this.friend_data[e]);return t},setUpdataAlreadyFriendData:function(t){if(this.friend_data&&t){for(var e in this.friend_data){var i=this.friend_data[e],s=Utils.getNorKey(i.rid,i.srv_id);this.friend_data[s]=i}s=Utils.getNorKey(t.rid,t.srv_id);this.friend_data[s]=t,this.setFriendChatData()}},getFirendNum:function(){return this.getAlreadyFriendData().length||0},inviteRedPoint:function(){return!!this.invite_redpoint&&this.invite_redpoint}});cc._RF.pop()},{welfare_const:"welfare_const",welfare_controller:"welfare_controller"}],invitecode_my_item:[function(t,e,i){"use strict";cc._RF.push(e,"4becay08NxDb5s4K4ghmoRI","invitecode_my_item");var s=t("pathtool");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("invitecode","invitecode_my_item")},initConfig:function(){this.ctrl=t("invitecode_controller").getInstance(),this.tesk_list=Config.invite_code_data.data_tesk_list,this.item_list={}},initPanel:function(){this.btn_get=this.seekChild("btn_get"),this.btn_get.active=!1,this.btn_goto=this.seekChild("btn_goto"),this.btn_goto.active=!1,this.has_spr=this.seekChild("has_spr"),this.has_spr.active=!1,this.tesk_num_lb=this.seekChild("tesk_num",cc.Label),this.title_name_lb=this.seekChild("title_name",cc.Label),this.title_name_lb.string="",this.good_cons=this.seekChild("good_cons")},registerEvent:function(){Utils.onTouchEnd(this.btn_get,function(){this.data&&this.ctrl.sender19805(this.data.id)}.bind(this),1),Utils.onTouchEnd(this.btn_goto,function(){message(Utils.TI18N("\u60a8\u9080\u8bf7\u7684\u7528\u6237\u8fd8\u672a\u8fbe\u6210\u76ee\u6807\u54e6~~~"))}.bind(this),1)},setData:function(t){this.data=t,this.root_wnd&&this.onShow()},onShow:function(){if(null!=this.data){var t=this.data;this.tesk_list[t.id]&&(this.title_name_lb.string=this.tesk_list[t.id].desc||"");var e=this.ctrl.getModel().getInviteCodeFinishData(t.id);if(e&&Utils.next(e)){this.btn_goto.active=!1;var i=e.num||0,s=cc.js.formatStr("(%s/%s)",i,t.num);this.tesk_num_lb.string=s,i>(e.had||0)?(this.has_spr.active=!1,this.btn_get.active=!0):(this.has_spr.active=!0,this.btn_get.active=!1)}else{this.has_spr.active=!1,this.btn_goto.active=!0;s=cc.js.formatStr("(%s/%s)",0,t.num);this.tesk_num_lb.string=s}var n=0;if(this.tesk_list[t.id])for(var a in this.tesk_list[t.id].items){var o=this.tesk_list[t.id].items[a];if(!this.item_list[a]){var l=ItemsPool.getInstance().getItem("backpack_item");l.initConfig(!1,.7,!1,!0),l.show(),l.setParent(this.good_cons),l.setPosition(100*n+60,50),this.item_list[a]=l,n+=1}this.item_list[a].setData({bid:o[0],num:o[1]})}}},onHide:function(){},onDelete:function(){if(this.item_list){for(var t in this.item_list)this.item_list[t].deleteMe(),this.item_list[t]=null;this.item_list=null}}});cc._RF.pop()},{invitecode_controller:"invitecode_controller",pathtool:"pathtool"}],invitecode_my_panel:[function(t,e,i){"use strict";cc._RF.push(e,"f62fcjDKj9CMIt203CHWBoo","invitecode_my_panel");var s=t("pathtool"),n=t("invitecode_my_item"),a=t("invitecode_event"),o=t("common_scrollview");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("invitecode","invitecode_my_panel")},initConfig:function(){this.ctrl=t("invitecode_controller").getInstance()},initPanel:function(){this.main_container=this.seekChild("main_container");var t=this.seekChild(this.main_container,"good_cons"),e=t.getContentSize(),i=cc.size(e.width,e.height),s={item_class:n,start_x:16,space_x:0,start_y:0,space_y:3,item_width:690,item_height:147,row:0,col:1,need_dynamic:!0};this.order_scrollview=new o,this.order_scrollview.createScroll(t,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,i,s,cc.v2(.5,.5))},registerEvent:function(){this.addGlobalEvent(a.InviteCode_My_Event,function(){this.getTeskData()},this)},getTeskData:function(){var t=this.ctrl.getModel().getInviteCodeTeskData();this.order_scrollview&&null!=Utils.next(t)&&this.order_scrollview.setData(t)},setVisibleStatus:function(t){this.setVisible(t)},onShow:function(t){this.getTeskData()},onHide:function(){},onDelete:function(){this.order_scrollview&&(this.order_scrollview.deleteMe(),this.order_scrollview=null)}});cc._RF.pop()},{common_scrollview:"common_scrollview",invitecode_controller:"invitecode_controller",invitecode_event:"invitecode_event",invitecode_my_item:"invitecode_my_item",pathtool:"pathtool"}],invitecode_panel:[function(t,e,i){"use strict";cc._RF.push(e,"f288aA7kZBKlZ0MFyn+KAh5","invitecode_panel");var s=t("pathtool"),n=t("invitecode_event"),a=(t("role_controller"),t("playerhead"));cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("welfare","invitecode_panel")},initConfig:function(){this.ctrl=t("invitecode_controller").getInstance(),this.cur_index=null,this.view_list={}},initPanel:function(){this.main_container=this.seekChild("main_container"),this.bg_sp=this.seekChild("bg",cc.Sprite),this.loadRes(s.getBigBg("action/action_invitecode"),function(t){this.bg_sp.spriteFrame=t}.bind(this)),this.btn_tips_nd=this.seekChild("btn_tips"),this.btn_copy_nd=this.seekChild("btn_copy"),this.btn_shard_nd=this.seekChild("btn_shard");var t=this.seekChild("Image_17");this.invite_code_lb=this.seekChild(t,"invite_code",cc.Label),this.invite_code_lb.string="",this.text_invitecode_lb=this.seekChild("text_invitecode",cc.Label),this.text_invitecode_lb.string="",this.tab_tilte={};for(var e=[Utils.TI18N("\u6211\u7684\u63a8\u8350\u7801"),Utils.TI18N("\u5df2\u63a8\u8350\u597d\u53cb")],i=1;i<=2;i++){var n={};n.btn=this.seekChild("tab_"+i),n.normal=this.seekChild(n.btn,"normal"),n.select=this.seekChild(n.btn,"select"),n.title=this.seekChild(n.btn,"title",cc.Label),n.select.active=!1,n.title.node.color=new cc.Color(207,181,147,255),n.title.string=e[i-1],n.index=i,n.redpoint=this.seekChild(n.btn,"redpoint"),n.redpoint.active=!1,this.tab_tilte[i]=n}this.tabChangeView(1),this.edit_box=this.seekChild("edit",cc.EditBox)},registerEvent:function(){var e=this;this.addGlobalEvent(n.Get_InviteCode_Event,function(){this.getInviteCodeData()},this),this.addGlobalEvent(n.InviteCode_BindRole_Event,function(){this.getAlreadyFriendNum()},this),this.addGlobalEvent(n.InviteCode_BindRole_Updata_Event,function(){this.getAlreadyFriendNum()},this),this.btn_tips_nd.on(cc.Node.EventType.TOUCH_END,function(e){Utils.playButtonSound(1);var i=e.touch.getLocation(),s=StringUtil.parse(Config.invite_code_data.data_const.tips.desc);t("tips_controller").getInstance().showCommonTips(s,i,null,null,500)}),Utils.onTouchEnd(this.btn_copy_nd,function(){this.copyCode()}.bind(this),1),Utils.onTouchEnd(this.btn_shard_nd,function(){this.setShardGame()}.bind(this),1);var i=function(){var t=e.tab_tilte[s];Utils.onTouchEnd(t.btn,function(){this.tabChangeView(t.index)}.bind(e),1)};for(var s in this.tab_tilte)i();this.addGlobalEvent(n.InviteCode_My_Event,function(){var e=t("invitecode_controller").getInstance().getModel().inviteRedPoint();this.tab_tilte[1]&&this.tab_tilte[1].redpoint&&(this.tab_tilte[1].redpoint.active=e)},this),this.edit_box.node.on("editing-did-ended",function(t){this.edit_box.string=this.invite_code},this),this.edit_box.node.on("text-changed",function(t){this.edit_box.string=this.invite_code},this)},tabChangeView:function(t){t=t||1,this.cur_index!=t&&(null!=this.cur_tab&&(this.cur_tab.select.active=!1,this.cur_tab.title.node.color=new cc.Color(207,181,147,255)),this.cur_index=t,this.cur_tab=this.tab_tilte[this.cur_index],null!=this.cur_tab&&(this.cur_tab.select.active=!0,this.cur_tab.title.node.color=new cc.Color(255,237,214,255)),null!=this.pre_panel&&this.pre_panel.setVisibleStatus&&this.pre_panel.setVisibleStatus(!1),this.pre_panel=this.createSubPanel(this.cur_index),null!=this.pre_panel&&this.pre_panel.setVisibleStatus&&this.pre_panel.setVisibleStatus(!0))},createSubPanel:function(t){var e=this.view_list[t];return null==e&&(1==t?e=Utils.createClass("invitecode_my_panel"):2==t&&(e=Utils.createClass("invitecode_friend_panel")),e.setParent(this.main_container),e.setPosition(-360,-404),e.show(),this.view_list[t]=e),e},getInviteCodeData:function(){var t=this.ctrl.getModel().getInviteCode();t?(this.invite_code_lb.string=t,this.invite_code=t,this.edit_box.string=t):message(Utils.TI18N("\u83b7\u53d6\u9080\u8bf7\u7801\u5931\u8d25"))},getAlreadyFriendNum:function(){if(this.text_invitecode_lb){var t=this.ctrl.getModel().getFirendNum(),e=cc.js.formatStr(Utils.TI18N("\u5df2\u9080\u8bf7\u597d\u53cb\uff1a%s\u4eba"),t||0);this.text_invitecode_lb.string=e}},setShardGame:function(){if(!this.poste_picture){var e=t("viewmanager").getInstance().getSceneNode(SCENE_TAG.loading);this.poste_picture=Utils.createImage(e,null,0,0,cc.v2(.5,.5)),this.poste_picture.type=cc.Sprite.Type.SIMPLE,this.poste_picture.sizeMode=cc.Sprite.SizeMode.CUSTOM,this.poste_picture.node.setContentSize(720,1280),this.poste_picture.node.scale=FIT_SCALE,this.layout=new cc.Node,this.layout.setParent(this.poste_picture.node),this.layout.setPosition(0,0);var i=t("role_controller").getInstance().getRoleVo();t("role_controller").getInstance().getApkData();this.head=new a,this.head.show(),this.head.setPosition(-258,-573),this.head.setHeadRes(i.face_id),this.head.setParent(this.layout);Utils.createLabel(30,new cc.Color(185,238,255,255),new cc.Color(0,0,0,255),-200,-550,Utils.TI18N(i.name),this.layout,2,cc.v2(0,.5));var n=Utils.createLabel(30,new cc.Color(185,238,255,255),new cc.Color(0,0,0,255),310,-550,Utils.TI18N("\u670d\u52a1\u5668: "+i.srv_id),this.layout,2,cc.v2(1,.5)),o=t("login_controller").getInstance().getModel().getLoginData();o&&(n.string=Utils.TI18N("\u670d\u52a1\u5668\uff1a"+o.srv_name));var l=Utils.createLabel(26,new cc.Color(185,238,255,255),new cc.Color(0,0,0,255),-200,-600,Utils.TI18N("\u6211\u7684\u5206\u4eab\u7801: "),this.layout,2,cc.v2(0,.5)),r=t("invitecode_controller").getInstance().getModel().getInviteCode();l.string=cc.js.formatStr(Utils.TI18N("\u6211\u7684\u5206\u4eab\u7801: %s"),r),this.loadRes(s.getIconPath("welfare/welfare_banner","txt_cn_welfare_bg2"),function(t){this.poste_picture.spriteFrame=t;var e=Utils.createImage(this.poste_picture.node,null,0,500,cc.v2(.5,.5));this.loadRes(s.getLogoRes(),function(t){e.spriteFrame=t}.bind(this)),e.type=cc.Sprite.Type.SIMPLE,e.sizeMode=cc.Sprite.SizeMode.CUSTOM,this.time_2&&(gcore.Timer.del(this.time_2),this.time_2=null),this.time_2=gcore.Timer.set(function(){var t=Utils.createImage(this.poste_picture.node,null,0,500,cc.v2(.5,.5));this.loadRes(s.getLogoRes(),function(e){t.spriteFrame=e}.bind(this)),t.type=cc.Sprite.Type.SIMPLE,t.sizeMode=cc.Sprite.SizeMode.CUSTOM}.bind(this),100,1);Utils.createImage(this.poste_picture.node,null,-145,-145,cc.v2(.5,.5));USE_SDK&&SDK.download_qrcode_png(function(t){t&&(this.erweima_img_sp.spriteFrame=spriteFrame)}.bind(this));this.time_1&&(gcore.Timer.del(this.time_1),this.time_1=null),this.time_1=gcore.Timer.set(function(){this.poste_picture&&(this.poste_picture.node.removeFromParent(),this.poste_picture=null),this.head&&(this.head.deleteMe(),this.head=null)}.bind(this),1e3,1)}.bind(this))}},copyCode:function(){this.ctrl.getModel().getInviteCode()?message(Utils.TI18N("\u590d\u5236\u5931\u8d25")):message(Utils.TI18N("\u590d\u5236\u63a8\u8350\u7801\u5931\u8d25"))},setVisibleStatus:function(t){t=t||!1,this.setVisible(t),1==t&&this.ctrl.requestProto()},onShow:function(t){this.getInviteCodeData()},onHide:function(){},onDelete:function(){for(var t in this.poste_picture&&(this.poste_picture.node.removeFromParent(),this.poste_picture=null,this.layout=null),this.head&&(this.head.deleteMe(),this.head=null),this.time_1&&(gcore.Timer.del(this.time_1),this.time_1=null),this.time_2&&(gcore.Timer.del(this.time_2),this.time_2=null),this.view_list)this.view_list[t].deleteMe(),this.view_list[t]=null;this.view_list=null}});cc._RF.pop()},{invitecode_controller:"invitecode_controller",invitecode_event:"invitecode_event",login_controller:"login_controller",pathtool:"pathtool",playerhead:"playerhead",role_controller:"role_controller",tips_controller:"tips_controller",viewmanager:"viewmanager"}],item_exhibition_list_panel:[function(t,e,i){"use strict";cc._RF.push(e,"29198iYUfhPR6/98M4YkzvQ","item_exhibition_list_panel");t("pathtool");var s=t("mainui_const");cc.Class({extends:BaseClass,ctor:function(){},setParent:function(t){this.parent=t,this.createItemName()},registerEvent:function(){},show:function(t){if(t){this.data=t;var e=t.show_type||s.item_exhibition_type.item_type;e==s.item_exhibition_type.item_type?this.showItemUI(t):e==s.item_exhibition_type.partner_type?this.showPartnerUI(t):console.log(Utils.TI18N("ItemExhibitionList\u7c7b\u578b\u51fa\u9519:%s"),e.toString())}},createItemName:function(){this.parent&&(this.item_name_label=Utils.createLabel(24,new cc.Color(255,232,255,255),null,0,0,"",this.parent,null,cc.v2(.5,.5)))},showItemUI:function(e){var i=e.bid||e.base_id;if(null!=e&&null!=i){var s=Utils.getItemConfig(i)||{};if(null!=s){if(null==this.item){this.item=Utils.createClass("backpack_item");var n=t("backpack_controller"),a=t("backpack_const"),o=n.getInstance().getModel().getBackPackItemById(e.id);s.type==a.item_type.ARTIFACTCHIPS&&o?(this.item.initConfig(!0),this.item.addCallBack(function(){var e=t("hero_controller"),i=t("partner_const");e.getInstance().openArtifactTipsWindow(!0,o,i.ArtifactTips.normal)}.bind(this))):this.item.initConfig(!0,1,!1,!0),this.item.setParent(this.parent),this.item.show()}this.item.setData({bid:e.bid,num:e.num});var l,r;if(l=s.quality,r=s.name,null!=l&&null!=r&&this.item_name_label){var c=(a=t("backpack_const")).quality_color(l),_=this.item_name_label.node.color;_.fromHEX(c),this.item_name_label.node.color=_,this.item_name_label.string=r,this.item_name_label.node.active=!0}}}},showPartnerUI:function(e){if(e.bid){var i=Config.partner_data.data_partner_base[e.bid];if(i){var s=null;null==this.item&&(this.item=ItemsPool.getInstance().getItem("hero_exhibition_item"),this.item.addCallBack(function(){t("hero_controller").getInstance().openHeroTipsPanelByBid(e.bid)}),this.item.setParent(this.parent),this.item.show(),this.item.setData(e));s=e.star||i.init_star;if((s-=1)>5&&(s=5),this.item_name_label){var n=t("backpack_const").quality_color(s),a=this.item_name_label.node.color;a.fromHEX(n),this.item_name_label.node.color=a,this.item_name_label.string=i.name,this.item_name_label.node.active=!0}}}},hide:function(){},addCallBack:function(t){},setPosition:function(t,e){this.item&&this.item.setPosition(t,e),this.item_name_label&&this.item_name_label.node.setPosition(t,e-80)},deleteMe:function(){this.item&&this.item.deleteMe(),this.item_name_label&&this.item_name_label.node.destroy(),this.item=null}});cc._RF.pop()},{backpack_const:"backpack_const",backpack_controller:"backpack_controller",hero_controller:"hero_controller",mainui_const:"mainui_const",partner_const:"partner_const",pathtool:"pathtool"}],item_exhibition_window:[function(t,e,i){"use strict";cc._RF.push(e,"a55ce9JrYlBopIlwl6eeOCc","item_exhibition_window");var s=t("pathtool"),n=t("action_controller"),a=t("mainui_event"),o=t("mainui_const"),l=t("seerpalace_controller");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("mainui","item_exhibition_view"),this.viewTag=SCENE_TAG.dialogue},initConfig:function(){this.controller=t("mainui_controller").getInstance(),this.open_type=o.item_open_type.normal,this.start_y=20,this.space=40,this.col=4,this.cache_list={}},openCallBack:function(){this.background=this.seekChild("background"),this.background.scale=FIT_SCALE,this.confirm_btn=this.seekChild("confirm_btn"),this.close_btn=this.seekChild("close_btn"),this.close_btn_label=this.close_btn.getChildByName("label").getComponent(cc.Label),this.fun_btn=this.seekChild("fun_btn"),this.fun_btn_label=this.fun_btn.getChildByName("label").getComponent(cc.Label),this.skeleton=this.seekChild("title_container",sp.Skeleton),this.scroll_view=this.seekChild("scroll_view").getComponent(cc.ScrollView),this.content=this.seekChild("content"),this.notice_label=this.seekChild("notice_label",cc.Label),this.scroll_height=this.content.height,this.scroll_width=this.content.width},registerEvent:function(){Utils.onTouchEnd(this.background,function(){this.open_type&&this.open_type!=o.item_open_type.normal||this.onClickClose()}.bind(this),1),Utils.onTouchEnd(this.confirm_btn,function(){this.onClickClose()}.bind(this),1),Utils.onTouchEnd(this.close_btn,function(){this.onClickClose()}.bind(this),2),Utils.onTouchEnd(this.fun_btn,function(){this.onClickFunBtn()}.bind(this),2)},onClickClose:function(){this.controller.openGetItemView(!1),n.getInstance().checkOpenActionLimitGiftMainWindow()},onClickFunBtn:function(){if(this.open_type==o.item_open_type.seerpalace){var t=l.getInstance().getModel().getLastSummonGroupId();null!=t&&0!=t&&l.getInstance().requestSeerpalaceSummon(t),this.onClickClose()}},openRootWnd:function(t){this.create_hanlder&&(this.stopUpdate(this.create_hanlder),this.create_hanlder=null),this.start_y=20,this.render_list=t.list;t.source;this.extend=t.extend,this.open_type=t.open_type,this.open_type==o.item_open_type.normal?(this.close_btn.active=!1,this.fun_btn.active=!1,this.confirm_btn.active=!0):this.open_type==o.item_open_type.seerpalace&&(this.close_btn.active=!0,this.fun_btn.active=!0,this.confirm_btn.active=!1,this.close_btn_label.string=Utils.TI18N("\u786e\u5b9a"),this.fun_btn_label.string=Utils.TI18N("\u518d\u6b21\u53ec\u5524")),this.handleEffect(),this.updateData()},handleEffect:function(){var t=s.getSpinePath("E51020");this.loadRes(t,function(t){this.skeleton.skeletonData=t,this.skeleton.setAnimation(0,PlayerAction.action_3,!1)}.bind(this))},updateData:function(){for(var t in this.cache_list)this.cache_list[t]&&(this.cache_list[t].deleteMe(),this.cache_list[t]=null);this.cache_list={};var e=this.render_list.length;this.row=Math.ceil(e/this.col);var i=this.start_y+(this.space+120)*this.row;this.max_height=Math.max(i,this.scroll_height),this.content.height=this.max_height,this.scroll_view.scrollToTop(0),e>=this.col&&(e=this.col);var s=120*e+(e-1)*this.space;this.start_x=.5*(this.scroll_width-s),1==this.row?this.start_y=.5*this.max_height:this.start_y=this.max_height-this.start_y-60,null==this.create_hanlder&&(this.create_hanlder=this.startUpdate(this.render_list.length,this.creatItem.bind(this)))},creatItem:function(t){if(null==this.cache_list[t]){var e=this.start_x+60+t%this.col*(120+this.space),i=this.start_y-Math.floor(t/this.col)*(120+this.space),s=Utils.createClass("item_exhibition_list_panel");s.setParent(this.content),s.show(this.render_list[t]),s.setPosition(e,i),this.cache_list[t]=s}},closeCallBack:function(){if(this.cache_list)for(var t in this.cache_list)this.cache_list[t].deleteMe(),this.cache_list[t]=null;gcore.GlobalEvent.fire(a.CLOSE_ITEM_VIEW,this.extend),this.controller.openGetItemView(!1)}});cc._RF.pop()},{action_controller:"action_controller",mainui_const:"mainui_const",mainui_controller:"mainui_controller",mainui_event:"mainui_event",pathtool:"pathtool",seerpalace_controller:"seerpalace_controller"}],item_sell_panel_window:[function(t,e,i){"use strict";cc._RF.push(e,"311587vmrtMHYj4nUdq9X8s","item_sell_panel_window");var s=t("pathtool"),n=t("backpack_const");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("backpack","item_sell_panel"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Tips,this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){this.cur_number=1,this.init_number=1},openCallBack:function(){this.background=this.root_wnd.getChildByName("background"),this.main_panel=this.root_wnd.getChildByName("main_panel"),this.text_name=this.main_panel.getChildByName("text_name").getComponent(cc.Label),this.text_name.string="",this.btn_redu=this.main_panel.getChildByName("btn_redu"),this.btn_add=this.main_panel.getChildByName("btn_add"),this.comp_num=this.main_panel.getChildByName("Image_2").getChildByName("comp_num").getComponent(cc.Label),this.comp_num.string="",this.btn_comp=this.main_panel.getChildByName("btn_comp"),this.btn_comp.getChildByName("Text_1").getComponent(cc.Label).string=Utils.TI18N("\u51fa\u552e"),this.goods_item=ItemsPool.getInstance().getItem("backpack_item"),this.goods_item.initConfig(!0,1,!1),this.goods_item.setParent(this.main_panel),this.goods_item.show(),this.goods_item.setPosition(0,80);var t=this.main_panel.getChildByName("cost_bg_2014").getPosition();this.cost_label=Utils.createRichLabel(26,new cc.Color(255,255,255,255),cc.v2(.5,.5),cc.v2(t.x,t.y),36),this.cost_label.string="",this.main_panel.addChild(this.cost_label.node)},registerEvent:function(){Utils.onTouchEnd(this.background,function(){this.ctrl.openItemSellPanel(!1)}.bind(this),2),Utils.onTouchEnd(this.btn_redu,function(){this.cur_number=this.cur_number-1,this.cur_number<this.init_number&&(this.setTouchEnable_Add(!1),this.setTouchEnable_Redu(!1)),this.cur_number<=1&&(this.setTouchEnable_Add(!1),this.setTouchEnable_Redu(!0)),this.cur_number<=0&&(this.cur_number=0),this.comp_num.string=this.cur_number,this.setCostInfo(this.cur_number)}.bind(this),1),Utils.onTouchEnd(this.btn_add,function(){this.cur_number=this.cur_number+1,this.cur_number>1&&(this.setTouchEnable_Add(!1),this.setTouchEnable_Redu(!1)),this.cur_number>=this.init_number&&(this.setTouchEnable_Add(!0),this.setTouchEnable_Redu(!1)),this.cur_number>this.init_number&&(this.cur_number=this.init_number),this.comp_num.string=this.cur_number,this.setCostInfo(this.cur_number)}.bind(this),1),Utils.onTouchEnd(this.btn_comp,function(){this.goods_vo&&(this.cur_number<0||(this.ctrl.sender10522(this.bag_type,[{id:this.goods_vo.id,bid:this.goods_vo.base_id,num:this.cur_number}]),this.ctrl.openItemSellPanel(!1)))}.bind(this),1)},setTouchEnable_Add:function(t){this.btn_add.getComponent(cc.Button).interactable=!t,this.btn_add.getComponent(cc.Button).enableAutoGrayEffect=t},setTouchEnable_Redu:function(t){this.btn_redu.getComponent(cc.Button).interactable=!t,this.btn_redu.getComponent(cc.Button).enableAutoGrayEffect=t},openRootWnd:function(t){t&&(this.bag_type=t[1]||n.Bag_Code.BACKPACK,this.goods_vo=t[0],this.item_config=t[0].config,this.setBaseInfo(this.cur_number))},setBaseInfo:function(){if(this.item_config){this.goods_item.setData(this.goods_vo),this.text_name.string=this.item_config.name;var t=this.model.getPackItemNumByBid(this.bag_type,this.item_config.id);this.cur_number=t,this.init_number=this.cur_number,this.comp_num.string=this.cur_number,this.setTouchEnable_Add(!0),this.setCostInfo(this.cur_number)}},setCostInfo:function(t){if(this.item_config){var e=this.item_config.value[0][0],i=this.item_config.value[0][1],n=this.cur_number*i,a=s.getItemRes(e),o=cc.js.formatStr("<img src='%s'/><color=#FFF6DD>%s</color>",e,n);this.cost_label.string=o,this.loadRes(a,function(t){this.cost_label.spriteFrame=t}.bind(this))}},closeCallBack:function(){this.goods_item&&this.goods_item.deleteMe(),this.goods_item=null,this.ctrl.openItemSellPanel(!1)}});cc._RF.pop()},{backpack_const:"backpack_const",pathtool:"pathtool"}],itemspool:[function(t,e,i){"use strict";cc._RF.push(e,"af379MpFlpO14jSJfyQDfdn","itemspool"),window.ItemsPool=cc.Class({extends:cc.Component,properties:{_hero_cache:[],_backpack_cache:[]},getItem:function(e){{if("hero_exhibition_item"==e)return this._hero_cache.length>0?this._hero_cache.pop():new(t("hero_exhibition_item"));if("backpack_item"==e){return this._backpack_cache.length>0?this._backpack_cache.pop():new(t("backpack_item"))}}},cacheItem:function(e){if(e.root_wnd){var i=t("backpack_item"),s=t("hero_exhibition_item");e.setParent(ViewManager.getInstance().getSceneNode()),e.init(),e.hide(),e instanceof i?this._backpack_cache.push(e):e instanceof s&&this._hero_cache.push(e)}else e=null}}),ItemsPool.getInstance=function(){return ItemsPool.instance||(ItemsPool.instance=new ItemsPool),ItemsPool.instance},e.exports=ItemsPool,cc._RF.pop()},{backpack_item:"backpack_item",hero_exhibition_item:"hero_exhibition_item"}],jszip:[function(t,e,i){(function(s,n){"use strict";function a(t){"@babel/helpers - typeof";return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}cc._RF.push(e,"dc8beFTPrhMpIoqZjF+VLaB","jszip"),function(t){if("object"===(void 0===i?"undefined":a(i))&&void 0!==e)e.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{("undefined"!=typeof window?window:void 0!==s?s:"undefined"!=typeof self?self:this).JSZip=t()}}(function(){return function e(i,s,n){function a(l,r){if(!s[l]){if(!i[l]){var c="function"==typeof t&&t;if(!r&&c)return c(l,!0);if(o)return o(l,!0);var _=new Error("Cannot find module '"+l+"'");throw _.code="MODULE_NOT_FOUND",_}var h=s[l]={exports:{}};i[l][0].call(h.exports,function(t){var e=i[l][1][t];return a(e||t)},h,h.exports,e,i,s,n)}return s[l].exports}for(var o="function"==typeof t&&t,l=0;l<n.length;l++)a(n[l]);return a}({1:[function(t,e,i){var s=t("./dataReader");function n(t){if(t){this.data=t,this.length=this.data.length,this.index=0,this.zero=0;for(var e=0;e<this.data.length;e++)t[e]=255&t[e]}}n.prototype=new s,n.prototype.byteAt=function(t){return this.data[this.zero+t]},n.prototype.lastIndexOfSignature=function(t){for(var e=t.charCodeAt(0),i=t.charCodeAt(1),s=t.charCodeAt(2),n=t.charCodeAt(3),a=this.length-4;a>=0;--a)if(this.data[a]===e&&this.data[a+1]===i&&this.data[a+2]===s&&this.data[a+3]===n)return a-this.zero;return-1},n.prototype.readData=function(t){if(this.checkOffset(t),0===t)return[];var e=this.data.slice(this.zero+this.index,this.zero+this.index+t);return this.index+=t,e},e.exports=n},{"./dataReader":6}],2:[function(t,e,i){var s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";i.encode=function(t,e){for(var i,n,a,o,l,r,c,_="",h=0;h<t.length;)o=(i=t.charCodeAt(h++))>>2,l=(3&i)<<4|(n=t.charCodeAt(h++))>>4,r=(15&n)<<2|(a=t.charCodeAt(h++))>>6,c=63&a,isNaN(n)?r=c=64:isNaN(a)&&(c=64),_=_+s.charAt(o)+s.charAt(l)+s.charAt(r)+s.charAt(c);return _},i.decode=function(t,e){var i,n,a,o,l,r,c="",_=0;for(t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");_<t.length;)i=s.indexOf(t.charAt(_++))<<2|(o=s.indexOf(t.charAt(_++)))>>4,n=(15&o)<<4|(l=s.indexOf(t.charAt(_++)))>>2,a=(3&l)<<6|(r=s.indexOf(t.charAt(_++))),c+=String.fromCharCode(i),64!=l&&(c+=String.fromCharCode(n)),64!=r&&(c+=String.fromCharCode(a));return c}},{}],3:[function(t,e,i){function s(){this.compressedSize=0,this.uncompressedSize=0,this.crc32=0,this.compressionMethod=null,this.compressedContent=null}s.prototype={getContent:function(){return null},getCompressedContent:function(){return null}},e.exports=s},{}],4:[function(t,e,i){i.STORE={magic:"\0\0",compress:function(t,e){return t},uncompress:function(t){return t},compressInputType:null,uncompressInputType:null},i.DEFLATE=t("./flate")},{"./flate":9}],5:[function(t,e,i){var s=t("./utils"),n=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];e.exports=function(t,e){if(void 0===t||!t.length)return 0;var i="string"!==s.getTypeOf(t);void 0===e&&(e=0);var a=0;e^=-1;for(var o=0,l=t.length;o<l;o++)a=i?t[o]:t.charCodeAt(o),e=e>>>8^n[255&(e^a)];return-1^e}},{"./utils":22}],6:[function(t,e,i){var s=t("./utils");function n(t){this.data=null,this.length=0,this.index=0,this.zero=0}n.prototype={checkOffset:function(t){this.checkIndex(this.index+t)},checkIndex:function(t){if(this.length<this.zero+t||t<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+t+"). Corrupted zip ?")},setIndex:function(t){this.checkIndex(t),this.index=t},skip:function(t){this.setIndex(this.index+t)},byteAt:function(t){},readInt:function(t){var e,i=0;for(this.checkOffset(t),e=this.index+t-1;e>=this.index;e--)i=(i<<8)+this.byteAt(e);return this.index+=t,i},readString:function(t){return s.transformTo("string",this.readData(t))},readData:function(t){},lastIndexOfSignature:function(t){},readDate:function(){var t=this.readInt(4);return new Date(1980+(t>>25&127),(t>>21&15)-1,t>>16&31,t>>11&31,t>>5&63,(31&t)<<1)}},e.exports=n},{"./utils":22}],7:[function(t,e,i){i.base64=!1,i.binary=!1,i.dir=!1,i.createFolders=!1,i.date=null,i.compression=null,i.compressionOptions=null,i.comment=null,i.unixPermissions=null,i.dosPermissions=null},{}],8:[function(t,e,i){var s=t("./utils");i.string2binary=function(t){return s.string2binary(t)},i.string2Uint8Array=function(t){return s.transformTo("uint8array",t)},i.uint8Array2String=function(t){return s.transformTo("string",t)},i.string2Blob=function(t){var e=s.transformTo("arraybuffer",t);return s.arrayBuffer2Blob(e)},i.arrayBuffer2Blob=function(t){return s.arrayBuffer2Blob(t)},i.transformTo=function(t,e){return s.transformTo(t,e)},i.getTypeOf=function(t){return s.getTypeOf(t)},i.checkSupport=function(t){return s.checkSupport(t)},i.MAX_VALUE_16BITS=s.MAX_VALUE_16BITS,i.MAX_VALUE_32BITS=s.MAX_VALUE_32BITS,i.pretty=function(t){return s.pretty(t)},i.findCompression=function(t){return s.findCompression(t)},i.isRegExp=function(t){return s.isRegExp(t)}},{"./utils":22}],9:[function(t,e,i){var s="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,n=t("pako");i.uncompressInputType=s?"uint8array":"array",i.compressInputType=s?"uint8array":"array",i.magic="\b\0",i.compress=function(t,e){return n.deflateRaw(t,{level:e.level||-1})},i.uncompress=function(t){return n.inflateRaw(t)}},{pako:25}],10:[function(t,e,i){var s=t("./base64");function n(t,e){if(!(this instanceof n))return new n(t,e);this.files={},this.comment=null,this.root="",t&&this.load(t,e),this.clone=function(){var t=new n;for(var e in this)"function"!=typeof this[e]&&(t[e]=this[e]);return t}}n.prototype=t("./object"),n.prototype.load=t("./load"),n.support=t("./support"),n.defaults=t("./defaults"),n.utils=t("./deprecatedPublicUtils"),n.base64={encode:function(t){return s.encode(t)},decode:function(t){return s.decode(t)}},n.compressions=t("./compressions"),e.exports=n},{"./base64":2,"./compressions":4,"./defaults":7,"./deprecatedPublicUtils":8,"./load":11,"./object":14,"./support":18}],11:[function(t,e,i){var s=t("./base64"),n=t("./utf8"),a=t("./utils"),o=t("./zipEntries");e.exports=function(t,e){var i,l,r,c;for((e=a.extend(e||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:n.utf8decode})).base64&&(t=s.decode(t)),i=(l=new o(t,e)).files,r=0;r<i.length;r++)c=i[r],this.file(c.fileNameStr,c.decompressed,{binary:!0,optimizedBinaryString:!0,date:c.date,dir:c.dir,comment:c.fileCommentStr.length?c.fileCommentStr:null,unixPermissions:c.unixPermissions,dosPermissions:c.dosPermissions,createFolders:e.createFolders});return l.zipComment.length&&(this.comment=l.zipComment),this}},{"./base64":2,"./utf8":21,"./utils":22,"./zipEntries":23}],12:[function(t,e,i){(function(t){e.exports=function(e,i){return new t(e,i)},e.exports.test=function(e){return t.isBuffer(e)}}).call(this,void 0!==n?n:void 0)},{}],13:[function(t,e,i){var s=t("./uint8ArrayReader");function n(t){this.data=t,this.length=this.data.length,this.index=0,this.zero=0}n.prototype=new s,n.prototype.readData=function(t){this.checkOffset(t);var e=this.data.slice(this.zero+this.index,this.zero+this.index+t);return this.index+=t,e},e.exports=n},{"./uint8ArrayReader":19}],14:[function(t,e,i){var s=t("./support"),n=t("./utils"),a=t("./crc32"),o=t("./signature"),l=t("./defaults"),r=t("./base64"),c=t("./compressions"),_=t("./compressedObject"),h=t("./nodeBuffer"),d=t("./utf8"),u=t("./stringWriter"),m=t("./uint8ArrayWriter"),f=function(t){if(t._data instanceof _&&(t._data=t._data.getContent(),t.options.binary=!0,t.options.base64=!1,"uint8array"===n.getTypeOf(t._data))){var e=t._data;t._data=new Uint8Array(e.length),0!==e.length&&t._data.set(e,0)}return t._data},p=function(t){var e=f(t);return"string"===n.getTypeOf(e)?!t.options.binary&&s.nodebuffer?h(e,"utf-8"):t.asBinary():e},g=function(t){var e=f(this);return null===e||void 0===e?"":(this.options.base64&&(e=r.decode(e)),e=t&&this.options.binary?x.utf8decode(e):n.transformTo("string",e),t||this.options.binary||(e=n.transformTo("string",x.utf8encode(e))),e)},v=function(t,e,i){this.name=t,this.dir=i.dir,this.date=i.date,this.comment=i.comment,this.unixPermissions=i.unixPermissions,this.dosPermissions=i.dosPermissions,this._data=e,this.options=i,this._initialMetadata={dir:i.dir,date:i.date}};v.prototype={asText:function(){return g.call(this,!0)},asBinary:function(){return g.call(this,!1)},asNodeBuffer:function(){var t=p(this);return n.transformTo("nodebuffer",t)},asUint8Array:function(){var t=p(this);return n.transformTo("uint8array",t)},asArrayBuffer:function(){return this.asUint8Array().buffer}};var b=function(t,e){var i,s="";for(i=0;i<e;i++)s+=String.fromCharCode(255&t),t>>>=8;return s},w=function(t){return!0!==(t=t||{}).base64||null!==t.binary&&void 0!==t.binary||(t.binary=!0),(t=n.extend(t,l)).date=t.date||new Date,null!==t.compression&&(t.compression=t.compression.toUpperCase()),t},y=function(t,e,i){var s,a=n.getTypeOf(e);if("string"==typeof(i=w(i)).unixPermissions&&(i.unixPermissions=parseInt(i.unixPermissions,8)),i.unixPermissions&&16384&i.unixPermissions&&(i.dir=!0),i.dosPermissions&&16&i.dosPermissions&&(i.dir=!0),i.dir&&(t=k(t)),i.createFolders&&(s=C(t))&&S.call(this,s,!0),i.dir||null===e||void 0===e)i.base64=!1,i.binary=!1,e=null,a=null;else if("string"===a)i.binary&&!i.base64&&!0!==i.optimizedBinaryString&&(e=n.string2binary(e));else{if(i.base64=!1,i.binary=!0,!(a||e instanceof _))throw new Error("The data of '"+t+"' is in an unsupported format !");"arraybuffer"===a&&(e=n.transformTo("uint8array",e))}var o=new v(t,e,i);return this.files[t]=o,o},C=function(t){"/"==t.slice(-1)&&(t=t.substring(0,t.length-1));var e=t.lastIndexOf("/");return e>0?t.substring(0,e):""},k=function(t){return"/"!=t.slice(-1)&&(t+="/"),t},S=function(t,e){return e=void 0!==e&&e,t=k(t),this.files[t]||y.call(this,t,null,{dir:!0,createFolders:e}),this.files[t]},T=function(t,e,i){var s,o=new _;return t._data instanceof _?(o.uncompressedSize=t._data.uncompressedSize,o.crc32=t._data.crc32,0===o.uncompressedSize||t.dir?(e=c.STORE,o.compressedContent="",o.crc32=0):t._data.compressionMethod===e.magic?o.compressedContent=t._data.getCompressedContent():(s=t._data.getContent(),o.compressedContent=e.compress(n.transformTo(e.compressInputType,s),i))):((s=p(t))&&0!==s.length&&!t.dir||(e=c.STORE,s=""),o.uncompressedSize=s.length,o.crc32=a(s),o.compressedContent=e.compress(n.transformTo(e.compressInputType,s),i)),o.compressedSize=o.compressedContent.length,o.compressionMethod=e.magic,o},I=function(t,e){var i=t;return t||(i=e?16893:33204),(65535&i)<<16},E=function(t,e){return 63&(t||0)},B=function(t,e,i,s,l,r){i.compressedContent;var c,_,h,u,m=r!==d.utf8encode,f=n.transformTo("string",r(e.name)),p=n.transformTo("string",d.utf8encode(e.name)),g=e.comment||"",v=n.transformTo("string",r(g)),w=n.transformTo("string",d.utf8encode(g)),y=p.length!==e.name.length,C=w.length!==g.length,k=e.options,S="",T="",B="";h=e._initialMetadata.dir!==e.dir?e.dir:k.dir,u=e._initialMetadata.date!==e.date?e.date:k.date;var x=0,P=0;h&&(x|=16),"UNIX"===l?(P=798,x|=I(e.unixPermissions,h)):(P=20,x|=E(e.dosPermissions)),c=u.getHours(),c<<=6,c|=u.getMinutes(),c<<=5,c|=u.getSeconds()/2,_=u.getFullYear()-1980,_<<=4,_|=u.getMonth()+1,_<<=5,_|=u.getDate(),y&&(T=b(1,1)+b(a(f),4)+p,S+="up"+b(T.length,2)+T),C&&(B=b(1,1)+b(this.crc32(v),4)+w,S+="uc"+b(B.length,2)+B);var R="";return R+="\n\0",R+=m||!y&&!C?"\0\0":"\0\b",R+=i.compressionMethod,R+=b(c,2),R+=b(_,2),R+=b(i.crc32,4),R+=b(i.compressedSize,4),R+=b(i.uncompressedSize,4),R+=b(f.length,2),R+=b(S.length,2),{fileRecord:o.LOCAL_FILE_HEADER+R+f+S,dirRecord:o.CENTRAL_FILE_HEADER+b(P,2)+R+b(v.length,2)+"\0\0\0\0"+b(x,4)+b(s,4)+f+S+v,compressedObject:i}},x={load:function(t,e){throw new Error("Load method is not defined. Is the file jszip-load.js included ?")},filter:function(t){var e,i,s,a,o=[];for(e in this.files)this.files.hasOwnProperty(e)&&(s=this.files[e],a=new v(s.name,s._data,n.extend(s.options)),i=e.slice(this.root.length,e.length),e.slice(0,this.root.length)===this.root&&t(i,a)&&o.push(a));return o},file:function(t,e,i){if(1===arguments.length){if(n.isRegExp(t)){var s=t;return this.filter(function(t,e){return!e.dir&&s.test(t)})}return this.filter(function(e,i){return!i.dir&&e===t})[0]||null}return t=this.root+t,y.call(this,t,e,i),this},folder:function(t){if(!t)return this;if(n.isRegExp(t))return this.filter(function(e,i){return i.dir&&t.test(e)});var e=this.root+t,i=S.call(this,e),s=this.clone();return s.root=i.name,s},remove:function(t){t=this.root+t;var e=this.files[t];if(e||("/"!=t.slice(-1)&&(t+="/"),e=this.files[t]),e&&!e.dir)delete this.files[t];else for(var i=this.filter(function(e,i){return i.name.slice(0,t.length)===t}),s=0;s<i.length;s++)delete this.files[i[s].name];return this},generate:function(t){t=n.extend(t||{},{base64:!0,compression:"STORE",compressionOptions:null,type:"base64",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:d.utf8encode}),n.checkSupport(t.type),"darwin"!==t.platform&&"freebsd"!==t.platform&&"linux"!==t.platform&&"sunos"!==t.platform||(t.platform="UNIX"),"win32"===t.platform&&(t.platform="DOS");var e,i,s=[],a=0,l=0,_=n.transformTo("string",t.encodeFileName(t.comment||this.comment||""));for(var h in this.files)if(this.files.hasOwnProperty(h)){var f=this.files[h],p=f.options.compression||t.compression.toUpperCase(),g=c[p];if(!g)throw new Error(p+" is not a valid compression method !");var v=f.options.compressionOptions||t.compressionOptions||{},w=T.call(this,f,g,v),y=B.call(this,h,f,w,a,t.platform,t.encodeFileName);a+=y.fileRecord.length+w.compressedSize,l+=y.dirRecord.length,s.push(y)}var C;C=o.CENTRAL_DIRECTORY_END+"\0\0\0\0"+b(s.length,2)+b(s.length,2)+b(l,4)+b(a,4)+b(_.length,2)+_;var k=t.type.toLowerCase();for(e="uint8array"===k||"arraybuffer"===k||"blob"===k||"nodebuffer"===k?new m(a+l+C.length):new u(a+l+C.length),i=0;i<s.length;i++)e.append(s[i].fileRecord),e.append(s[i].compressedObject.compressedContent);for(i=0;i<s.length;i++)e.append(s[i].dirRecord);e.append(C);var S=e.finalize();switch(t.type.toLowerCase()){case"uint8array":case"arraybuffer":case"nodebuffer":return n.transformTo(t.type.toLowerCase(),S);case"blob":return n.arrayBuffer2Blob(n.transformTo("arraybuffer",S),t.mimeType);case"base64":return t.base64?r.encode(S):S;default:return S}},crc32:function(t,e){return a(t,e)},utf8encode:function(t){return n.transformTo("string",d.utf8encode(t))},utf8decode:function(t){return d.utf8decode(t)}};e.exports=x},{"./base64":2,"./compressedObject":3,"./compressions":4,"./crc32":5,"./defaults":7,"./nodeBuffer":12,"./signature":15,"./stringWriter":17,"./support":18,"./uint8ArrayWriter":20,"./utf8":21,"./utils":22}],15:[function(t,e,i){i.LOCAL_FILE_HEADER="PK\x03\x04",i.CENTRAL_FILE_HEADER="PK\x01\x02",i.CENTRAL_DIRECTORY_END="PK\x05\x06",i.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x06\x07",i.ZIP64_CENTRAL_DIRECTORY_END="PK\x06\x06",i.DATA_DESCRIPTOR="PK\x07\b"},{}],16:[function(t,e,i){var s=t("./dataReader"),n=t("./utils");function a(t,e){this.data=t,e||(this.data=n.string2binary(this.data)),this.length=this.data.length,this.index=0,this.zero=0}a.prototype=new s,a.prototype.byteAt=function(t){return this.data.charCodeAt(this.zero+t)},a.prototype.lastIndexOfSignature=function(t){return this.data.lastIndexOf(t)-this.zero},a.prototype.readData=function(t){this.checkOffset(t);var e=this.data.slice(this.zero+this.index,this.zero+this.index+t);return this.index+=t,e},e.exports=a},{"./dataReader":6,"./utils":22}],17:[function(t,e,i){var s=t("./utils"),n=function(){this.data=[]};n.prototype={append:function(t){t=s.transformTo("string",t),this.data.push(t)},finalize:function(){return this.data.join("")}},e.exports=n},{"./utils":22}],18:[function(t,e,i){(function(t){if(i.base64=!0,i.array=!0,i.string=!0,i.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,i.nodebuffer=void 0!==t,i.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)i.blob=!1;else{var e=new ArrayBuffer(0);try{i.blob=0===new Blob([e],{type:"application/zip"}).size}catch(t){try{var s=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder);s.append(e),i.blob=0===s.getBlob("application/zip").size}catch(t){i.blob=!1}}}}).call(this,void 0!==n?n:void 0)},{}],19:[function(t,e,i){var s=t("./arrayReader");function n(t){t&&(this.data=t,this.length=this.data.length,this.index=0,this.zero=0)}n.prototype=new s,n.prototype.readData=function(t){if(this.checkOffset(t),0===t)return new Uint8Array(0);var e=this.data.subarray(this.zero+this.index,this.zero+this.index+t);return this.index+=t,e},e.exports=n},{"./arrayReader":1}],20:[function(t,e,i){var s=t("./utils"),n=function(t){this.data=new Uint8Array(t),this.index=0};n.prototype={append:function(t){0!==t.length&&(t=s.transformTo("uint8array",t),this.data.set(t,this.index),this.index+=t.length)},finalize:function(){return this.data}},e.exports=n},{"./utils":22}],21:[function(t,e,i){for(var s=t("./utils"),n=t("./support"),a=t("./nodeBuffer"),o=new Array(256),l=0;l<256;l++)o[l]=l>=252?6:l>=248?5:l>=240?4:l>=224?3:l>=192?2:1;o[254]=o[254]=1;var r=function(t){var e,i,s,a,o,l=t.length,r=0;for(a=0;a<l;a++)55296==(64512&(i=t.charCodeAt(a)))&&a+1<l&&56320==(64512&(s=t.charCodeAt(a+1)))&&(i=65536+(i-55296<<10)+(s-56320),a++),r+=i<128?1:i<2048?2:i<65536?3:4;for(e=n.uint8array?new Uint8Array(r):new Array(r),o=0,a=0;o<r;a++)55296==(64512&(i=t.charCodeAt(a)))&&a+1<l&&56320==(64512&(s=t.charCodeAt(a+1)))&&(i=65536+(i-55296<<10)+(s-56320),a++),i<128?e[o++]=i:i<2048?(e[o++]=192|i>>>6,e[o++]=128|63&i):i<65536?(e[o++]=224|i>>>12,e[o++]=128|i>>>6&63,e[o++]=128|63&i):(e[o++]=240|i>>>18,e[o++]=128|i>>>12&63,e[o++]=128|i>>>6&63,e[o++]=128|63&i);return e},c=function(t,e){var i;for((e=e||t.length)>t.length&&(e=t.length),i=e-1;i>=0&&128==(192&t[i]);)i--;return i<0?e:0===i?e:i+o[t[i]]>e?i:e},_=function(t){var e,i,n,a,l=t.length,r=new Array(2*l);for(i=0,e=0;e<l;)if((n=t[e++])<128)r[i++]=n;else if((a=o[n])>4)r[i++]=65533,e+=a-1;else{for(n&=2===a?31:3===a?15:7;a>1&&e<l;)n=n<<6|63&t[e++],a--;a>1?r[i++]=65533:n<65536?r[i++]=n:(n-=65536,r[i++]=55296|n>>10&1023,r[i++]=56320|1023&n)}return r.length!==i&&(r.subarray?r=r.subarray(0,i):r.length=i),s.applyFromCharCode(r)};i.utf8encode=function(t){return n.nodebuffer?a(t,"utf-8"):r(t)},i.utf8decode=function(t){if(n.nodebuffer)return s.transformTo("nodebuffer",t).toString("utf-8");for(var e=[],i=0,a=(t=s.transformTo(n.uint8array?"uint8array":"array",t)).length;i<a;){var o=c(t,Math.min(i+65536,a));n.uint8array?e.push(_(t.subarray(i,o))):e.push(_(t.slice(i,o))),i=o}return e.join("")}},{"./nodeBuffer":12,"./support":18,"./utils":22}],22:[function(t,e,i){var s=t("./support"),n=t("./compressions"),a=t("./nodeBuffer");function o(t){return t}function l(t,e){for(var i=0;i<t.length;++i)e[i]=255&t.charCodeAt(i);return e}function r(t){var e=65536,s=[],n=t.length,o=i.getTypeOf(t),l=0,r=!0;try{switch(o){case"uint8array":String.fromCharCode.apply(null,new Uint8Array(0));break;case"nodebuffer":String.fromCharCode.apply(null,a(0))}}catch(t){r=!1}if(!r){for(var c="",_=0;_<t.length;_++)c+=String.fromCharCode(t[_]);return c}for(;l<n&&e>1;)try{"array"===o||"nodebuffer"===o?s.push(String.fromCharCode.apply(null,t.slice(l,Math.min(l+e,n)))):s.push(String.fromCharCode.apply(null,t.subarray(l,Math.min(l+e,n)))),l+=e}catch(t){e=Math.floor(e/2)}return s.join("")}function c(t,e){for(var i=0;i<t.length;i++)e[i]=t[i];return e}i.string2binary=function(t){for(var e="",i=0;i<t.length;i++)e+=String.fromCharCode(255&t.charCodeAt(i));return e},i.arrayBuffer2Blob=function(t,e){i.checkSupport("blob"),e=e||"application/zip";try{return new Blob([t],{type:e})}catch(i){try{var s=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder);return s.append(t),s.getBlob(e)}catch(t){throw new Error("Bug : can't construct the Blob.")}}},i.applyFromCharCode=r;var _={};_.string={string:o,array:function(t){return l(t,new Array(t.length))},arraybuffer:function(t){return _.string.uint8array(t).buffer},uint8array:function(t){return l(t,new Uint8Array(t.length))},nodebuffer:function(t){return l(t,a(t.length))}},_.array={string:r,array:o,arraybuffer:function(t){return new Uint8Array(t).buffer},uint8array:function(t){return new Uint8Array(t)},nodebuffer:function(t){return a(t)}},_.arraybuffer={string:function(t){return r(new Uint8Array(t))},array:function(t){return c(new Uint8Array(t),new Array(t.byteLength))},arraybuffer:o,uint8array:function(t){return new Uint8Array(t)},nodebuffer:function(t){return a(new Uint8Array(t))}},_.uint8array={string:r,array:function(t){return c(t,new Array(t.length))},arraybuffer:function(t){return t.buffer},uint8array:o,nodebuffer:function(t){return a(t)}},_.nodebuffer={string:r,array:function(t){return c(t,new Array(t.length))},arraybuffer:function(t){return _.nodebuffer.uint8array(t).buffer},uint8array:function(t){return c(t,new Uint8Array(t.length))},nodebuffer:o},i.transformTo=function(t,e){if(e||(e=""),!t)return e;i.checkSupport(t);var s=i.getTypeOf(e);return _[s][t](e)},i.getTypeOf=function(t){return"string"==typeof t?"string":"[object Array]"===Object.prototype.toString.call(t)?"array":s.nodebuffer&&a.test(t)?"nodebuffer":s.uint8array&&t instanceof Uint8Array?"uint8array":s.arraybuffer&&t instanceof ArrayBuffer?"arraybuffer":void 0},i.checkSupport=function(t){if(!s[t.toLowerCase()])throw new Error(t+" is not supported by this browser")},i.MAX_VALUE_16BITS=65535,i.MAX_VALUE_32BITS=-1,i.pretty=function(t){var e,i,s="";for(i=0;i<(t||"").length;i++)s+="\\x"+((e=t.charCodeAt(i))<16?"0":"")+e.toString(16).toUpperCase();return s},i.findCompression=function(t){for(var e in n)if(n.hasOwnProperty(e)&&n[e].magic===t)return n[e];return null},i.isRegExp=function(t){return"[object RegExp]"===Object.prototype.toString.call(t)},i.extend=function(){var t,e,i={};for(t=0;t<arguments.length;t++)for(e in arguments[t])arguments[t].hasOwnProperty(e)&&void 0===i[e]&&(i[e]=arguments[t][e]);return i}},{"./compressions":4,"./nodeBuffer":12,"./support":18}],23:[function(t,e,i){var s=t("./stringReader"),n=t("./nodeBufferReader"),a=t("./uint8ArrayReader"),o=t("./arrayReader"),l=t("./utils"),r=t("./signature"),c=t("./zipEntry"),_=t("./support");t("./object");function h(t,e){this.files=[],this.loadOptions=e,t&&this.load(t)}h.prototype={checkSignature:function(t){var e=this.reader.readString(4);if(e!==t)throw new Error("Corrupted zip or bug : unexpected signature ("+l.pretty(e)+", expected "+l.pretty(t)+")")},isSignature:function(t,e){var i=this.reader.index;this.reader.setIndex(t);var s=this.reader.readString(4)===e;return this.reader.setIndex(i),s},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var t=this.reader.readData(this.zipCommentLength),e=_.uint8array?"uint8array":"array",i=l.transformTo(e,t);this.zipComment=this.loadOptions.decodeFileName(i)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.versionMadeBy=this.reader.readString(2),this.versionNeeded=this.reader.readInt(2),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var t,e,i,s=this.zip64EndOfCentralSize-44;0<s;)t=this.reader.readInt(2),e=this.reader.readInt(4),i=this.reader.readString(e),this.zip64ExtensibleData[t]={id:t,length:e,value:i}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var t,e;for(t=0;t<this.files.length;t++)e=this.files[t],this.reader.setIndex(e.localHeaderOffset),this.checkSignature(r.LOCAL_FILE_HEADER),e.readLocalPart(this.reader),e.handleUTF8(),e.processAttributes()},readCentralDir:function(){var t;for(this.reader.setIndex(this.centralDirOffset);this.reader.readString(4)===r.CENTRAL_FILE_HEADER;)(t=new c({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(t);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var t=this.reader.lastIndexOfSignature(r.CENTRAL_DIRECTORY_END);if(t<0)throw!this.isSignature(0,r.LOCAL_FILE_HEADER)?new Error("Can't find end of central directory : is this a zip file ? If it is, see http://stuk.github.io/jszip/documentation/howto/read_zip.html"):new Error("Corrupted zip : can't find end of central directory");this.reader.setIndex(t);var e=t;if(this.checkSignature(r.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===l.MAX_VALUE_16BITS||this.diskWithCentralDirStart===l.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===l.MAX_VALUE_16BITS||this.centralDirRecords===l.MAX_VALUE_16BITS||this.centralDirSize===l.MAX_VALUE_32BITS||this.centralDirOffset===l.MAX_VALUE_32BITS){if(this.zip64=!0,(t=this.reader.lastIndexOfSignature(r.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip : can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(t),this.checkSignature(r.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,r.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(r.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip : can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(r.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var i=this.centralDirOffset+this.centralDirSize;this.zip64&&(i+=20,i+=12+this.zip64EndOfCentralSize);var s=e-i;if(s>0)this.isSignature(e,r.CENTRAL_FILE_HEADER)||(this.reader.zero=s);else if(s<0)throw new Error("Corrupted zip: missing "+Math.abs(s)+" bytes.")},prepareReader:function(t){var e=l.getTypeOf(t);if(l.checkSupport(e),"string"!==e||_.uint8array)if("nodebuffer"===e)this.reader=new n(t);else if(_.uint8array)this.reader=new a(l.transformTo("uint8array",t));else{if(!_.array)throw new Error("Unexpected error: unsupported type '"+e+"'");this.reader=new o(l.transformTo("array",t))}else this.reader=new s(t,this.loadOptions.optimizedBinaryString)},load:function(t){this.prepareReader(t),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},e.exports=h},{"./arrayReader":1,"./nodeBufferReader":13,"./object":14,"./signature":15,"./stringReader":16,"./support":18,"./uint8ArrayReader":19,"./utils":22,"./zipEntry":24}],24:[function(t,e,i){var s=t("./stringReader"),n=t("./utils"),a=t("./compressedObject"),o=t("./object"),l=t("./support");function r(t,e){this.options=t,this.loadOptions=e}r.prototype={isEncrypted:function(){return 1==(1&this.bitFlag)},useUTF8:function(){return 2048==(2048&this.bitFlag)},prepareCompressedContent:function(t,e,i){return function(){var s=t.index;t.setIndex(e);var n=t.readData(i);return t.setIndex(s),n}},prepareContent:function(t,e,i,s,a){return function(){var t=n.transformTo(s.uncompressInputType,this.getCompressedContent()),e=s.uncompress(t);if(e.length!==a)throw new Error("Bug : uncompressed data size mismatch");return e}},readLocalPart:function(t){var e,i;if(t.skip(22),this.fileNameLength=t.readInt(2),i=t.readInt(2),this.fileName=t.readData(this.fileNameLength),t.skip(i),-1==this.compressedSize||-1==this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough informations from the central directory (compressedSize == -1 || uncompressedSize == -1)");if(null===(e=n.findCompression(this.compressionMethod)))throw new Error("Corrupted zip : compression "+n.pretty(this.compressionMethod)+" unknown (inner file : "+n.transformTo("string",this.fileName)+")");if(this.decompressed=new a,this.decompressed.compressedSize=this.compressedSize,this.decompressed.uncompressedSize=this.uncompressedSize,this.decompressed.crc32=this.crc32,this.decompressed.compressionMethod=this.compressionMethod,this.decompressed.getCompressedContent=this.prepareCompressedContent(t,t.index,this.compressedSize,e),this.decompressed.getContent=this.prepareContent(t,t.index,this.compressedSize,e,this.uncompressedSize),this.loadOptions.checkCRC32&&(this.decompressed=n.transformTo("string",this.decompressed.getContent()),o.crc32(this.decompressed)!==this.crc32))throw new Error("Corrupted zip : CRC32 mismatch")},readCentralPart:function(t){if(this.versionMadeBy=t.readInt(2),this.versionNeeded=t.readInt(2),this.bitFlag=t.readInt(2),this.compressionMethod=t.readString(2),this.date=t.readDate(),this.crc32=t.readInt(4),this.compressedSize=t.readInt(4),this.uncompressedSize=t.readInt(4),this.fileNameLength=t.readInt(2),this.extraFieldsLength=t.readInt(2),this.fileCommentLength=t.readInt(2),this.diskNumberStart=t.readInt(2),this.internalFileAttributes=t.readInt(2),this.externalFileAttributes=t.readInt(4),this.localHeaderOffset=t.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");this.fileName=t.readData(this.fileNameLength),this.readExtraFields(t),this.parseZIP64ExtraField(t),this.fileComment=t.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var t=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0===t&&(this.dosPermissions=63&this.externalFileAttributes),3===t&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(t){if(this.extraFields[1]){var e=new s(this.extraFields[1].value);this.uncompressedSize===n.MAX_VALUE_32BITS&&(this.uncompressedSize=e.readInt(8)),this.compressedSize===n.MAX_VALUE_32BITS&&(this.compressedSize=e.readInt(8)),this.localHeaderOffset===n.MAX_VALUE_32BITS&&(this.localHeaderOffset=e.readInt(8)),this.diskNumberStart===n.MAX_VALUE_32BITS&&(this.diskNumberStart=e.readInt(4))}},readExtraFields:function(t){var e,i,s,n=t.index;for(this.extraFields=this.extraFields||{};t.index<n+this.extraFieldsLength;)e=t.readInt(2),i=t.readInt(2),s=t.readString(i),this.extraFields[e]={id:e,length:i,value:s}},handleUTF8:function(){var t=l.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=o.utf8decode(this.fileName),this.fileCommentStr=o.utf8decode(this.fileComment);else{var e=this.findExtraFieldUnicodePath();if(null!==e)this.fileNameStr=e;else{var i=n.transformTo(t,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(i)}var s=this.findExtraFieldUnicodeComment();if(null!==s)this.fileCommentStr=s;else{var a=n.transformTo(t,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(a)}}},findExtraFieldUnicodePath:function(){var t=this.extraFields[28789];if(t){var e=new s(t.value);return 1!==e.readInt(1)?null:o.crc32(this.fileName)!==e.readInt(4)?null:o.utf8decode(e.readString(t.length-5))}return null},findExtraFieldUnicodeComment:function(){var t=this.extraFields[25461];if(t){var e=new s(t.value);return 1!==e.readInt(1)?null:o.crc32(this.fileComment)!==e.readInt(4)?null:o.utf8decode(e.readString(t.length-5))}return null}},e.exports=r},{"./compressedObject":3,"./object":14,"./stringReader":16,"./support":18,"./utils":22}],25:[function(t,e,i){var s={};(0,t("./lib/utils/common").assign)(s,t("./lib/deflate"),t("./lib/inflate"),t("./lib/zlib/constants")),e.exports=s},{"./lib/deflate":26,"./lib/inflate":27,"./lib/utils/common":28,"./lib/zlib/constants":31}],26:[function(t,e,i){var s=t("./zlib/deflate"),n=t("./utils/common"),a=t("./utils/strings"),o=t("./zlib/messages"),l=t("./zlib/zstream"),r=Object.prototype.toString,c=0,_=-1,h=0,d=8;function u(t){if(!(this instanceof u))return new u(t);this.options=n.assign({level:_,method:d,chunkSize:16384,windowBits:15,memLevel:8,strategy:h,to:""},t||{});var e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var i=s.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(i!==c)throw new Error(o[i]);e.header&&s.deflateSetHeader(this.strm,e.header)}function m(t,e){var i=new u(e);if(i.push(t,!0),i.err)throw i.msg;return i.result}u.prototype.push=function(t,e){var i,o,l=this.strm,_=this.options.chunkSize;if(this.ended)return!1;o=e===~~e?e:!0===e?4:0,"string"==typeof t?l.input=a.string2buf(t):"[object ArrayBuffer]"===r.call(t)?l.input=new Uint8Array(t):l.input=t,l.next_in=0,l.avail_in=l.input.length;do{if(0===l.avail_out&&(l.output=new n.Buf8(_),l.next_out=0,l.avail_out=_),1!==(i=s.deflate(l,o))&&i!==c)return this.onEnd(i),this.ended=!0,!1;0!==l.avail_out&&(0!==l.avail_in||4!==o&&2!==o)||("string"===this.options.to?this.onData(a.buf2binstring(n.shrinkBuf(l.output,l.next_out))):this.onData(n.shrinkBuf(l.output,l.next_out)))}while((l.avail_in>0||0===l.avail_out)&&1!==i);return 4===o?(i=s.deflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===c):2!==o||(this.onEnd(c),l.avail_out=0,!0)},u.prototype.onData=function(t){this.chunks.push(t)},u.prototype.onEnd=function(t){t===c&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=n.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},i.Deflate=u,i.deflate=m,i.deflateRaw=function(t,e){return(e=e||{}).raw=!0,m(t,e)},i.gzip=function(t,e){return(e=e||{}).gzip=!0,m(t,e)}},{"./utils/common":28,"./utils/strings":29,"./zlib/deflate":33,"./zlib/messages":38,"./zlib/zstream":40}],27:[function(t,e,i){var s=t("./zlib/inflate"),n=t("./utils/common"),a=t("./utils/strings"),o=t("./zlib/constants"),l=t("./zlib/messages"),r=t("./zlib/zstream"),c=t("./zlib/gzheader"),_=Object.prototype.toString;function h(t){if(!(this instanceof h))return new h(t);this.options=n.assign({chunkSize:16384,windowBits:0,to:""},t||{});var e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,0===e.windowBits&&(e.windowBits=-15)),!(e.windowBits>=0&&e.windowBits<16)||t&&t.windowBits||(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&0==(15&e.windowBits)&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new r,this.strm.avail_out=0;var i=s.inflateInit2(this.strm,e.windowBits);if(i!==o.Z_OK)throw new Error(l[i]);this.header=new c,s.inflateGetHeader(this.strm,this.header)}function d(t,e){var i=new h(e);if(i.push(t,!0),i.err)throw i.msg;return i.result}h.prototype.push=function(t,e){var i,l,r,c,h,d=this.strm,u=this.options.chunkSize,m=!1;if(this.ended)return!1;l=e===~~e?e:!0===e?o.Z_FINISH:o.Z_NO_FLUSH,"string"==typeof t?d.input=a.binstring2buf(t):"[object ArrayBuffer]"===_.call(t)?d.input=new Uint8Array(t):d.input=t,d.next_in=0,d.avail_in=d.input.length;do{if(0===d.avail_out&&(d.output=new n.Buf8(u),d.next_out=0,d.avail_out=u),(i=s.inflate(d,o.Z_NO_FLUSH))===o.Z_BUF_ERROR&&!0===m&&(i=o.Z_OK,m=!1),i!==o.Z_STREAM_END&&i!==o.Z_OK)return this.onEnd(i),this.ended=!0,!1;d.next_out&&(0!==d.avail_out&&i!==o.Z_STREAM_END&&(0!==d.avail_in||l!==o.Z_FINISH&&l!==o.Z_SYNC_FLUSH)||("string"===this.options.to?(r=a.utf8border(d.output,d.next_out),c=d.next_out-r,h=a.buf2string(d.output,r),d.next_out=c,d.avail_out=u-c,c&&n.arraySet(d.output,d.output,r,c,0),this.onData(h)):this.onData(n.shrinkBuf(d.output,d.next_out)))),0===d.avail_in&&0===d.avail_out&&(m=!0)}while((d.avail_in>0||0===d.avail_out)&&i!==o.Z_STREAM_END);return i===o.Z_STREAM_END&&(l=o.Z_FINISH),l===o.Z_FINISH?(i=s.inflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===o.Z_OK):l!==o.Z_SYNC_FLUSH||(this.onEnd(o.Z_OK),d.avail_out=0,!0)},h.prototype.onData=function(t){this.chunks.push(t)},h.prototype.onEnd=function(t){t===o.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=n.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},i.Inflate=h,i.inflate=d,i.inflateRaw=function(t,e){return(e=e||{}).raw=!0,d(t,e)},i.ungzip=d},{"./utils/common":28,"./utils/strings":29,"./zlib/constants":31,"./zlib/gzheader":34,"./zlib/inflate":36,"./zlib/messages":38,"./zlib/zstream":40}],28:[function(t,e,i){var s="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;i.assign=function(t){for(var e=Array.prototype.slice.call(arguments,1);e.length;){var i=e.shift();if(i){if("object"!==a(i))throw new TypeError(i+"must be non-object");for(var s in i)i.hasOwnProperty(s)&&(t[s]=i[s])}}return t},i.shrinkBuf=function(t,e){return t.length===e?t:t.subarray?t.subarray(0,e):(t.length=e,t)};var n={arraySet:function(t,e,i,s,n){if(e.subarray&&t.subarray)t.set(e.subarray(i,i+s),n);else for(var a=0;a<s;a++)t[n+a]=e[i+a]},flattenChunks:function(t){var e,i,s,n,a,o;for(s=0,e=0,i=t.length;e<i;e++)s+=t[e].length;for(o=new Uint8Array(s),n=0,e=0,i=t.length;e<i;e++)a=t[e],o.set(a,n),n+=a.length;return o}},o={arraySet:function(t,e,i,s,n){for(var a=0;a<s;a++)t[n+a]=e[i+a]},flattenChunks:function(t){return[].concat.apply([],t)}};i.setTyped=function(t){t?(i.Buf8=Uint8Array,i.Buf16=Uint16Array,i.Buf32=Int32Array,i.assign(i,n)):(i.Buf8=Array,i.Buf16=Array,i.Buf32=Array,i.assign(i,o))},i.setTyped(s)},{}],29:[function(t,e,i){var s=t("./common"),n=!0,a=!0;try{String.fromCharCode.apply(null,[0])}catch(t){n=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){a=!1}for(var o=new s.Buf8(256),l=0;l<256;l++)o[l]=l>=252?6:l>=248?5:l>=240?4:l>=224?3:l>=192?2:1;function r(t,e){if(e<65537&&(t.subarray&&a||!t.subarray&&n))return String.fromCharCode.apply(null,s.shrinkBuf(t,e));for(var i="",o=0;o<e;o++)i+=String.fromCharCode(t[o]);return i}o[254]=o[254]=1,i.string2buf=function(t){var e,i,n,a,o,l=t.length,r=0;for(a=0;a<l;a++)55296==(64512&(i=t.charCodeAt(a)))&&a+1<l&&56320==(64512&(n=t.charCodeAt(a+1)))&&(i=65536+(i-55296<<10)+(n-56320),a++),r+=i<128?1:i<2048?2:i<65536?3:4;for(e=new s.Buf8(r),o=0,a=0;o<r;a++)55296==(64512&(i=t.charCodeAt(a)))&&a+1<l&&56320==(64512&(n=t.charCodeAt(a+1)))&&(i=65536+(i-55296<<10)+(n-56320),a++),i<128?e[o++]=i:i<2048?(e[o++]=192|i>>>6,e[o++]=128|63&i):i<65536?(e[o++]=224|i>>>12,e[o++]=128|i>>>6&63,e[o++]=128|63&i):(e[o++]=240|i>>>18,e[o++]=128|i>>>12&63,e[o++]=128|i>>>6&63,e[o++]=128|63&i);return e},i.buf2binstring=function(t){return r(t,t.length)},i.binstring2buf=function(t){for(var e=new s.Buf8(t.length),i=0,n=e.length;i<n;i++)e[i]=t.charCodeAt(i);return e},i.buf2string=function(t,e){var i,s,n,a,l=e||t.length,c=new Array(2*l);for(s=0,i=0;i<l;)if((n=t[i++])<128)c[s++]=n;else if((a=o[n])>4)c[s++]=65533,i+=a-1;else{for(n&=2===a?31:3===a?15:7;a>1&&i<l;)n=n<<6|63&t[i++],a--;a>1?c[s++]=65533:n<65536?c[s++]=n:(n-=65536,c[s++]=55296|n>>10&1023,c[s++]=56320|1023&n)}return r(c,s)},i.utf8border=function(t,e){var i;for((e=e||t.length)>t.length&&(e=t.length),i=e-1;i>=0&&128==(192&t[i]);)i--;return i<0?e:0===i?e:i+o[t[i]]>e?i:e}},{"./common":28}],30:[function(t,e,i){e.exports=function(t,e,i,s){for(var n=65535&t|0,a=t>>>16&65535|0,o=0;0!==i;){i-=o=i>2e3?2e3:i;do{a=a+(n=n+e[s++]|0)|0}while(--o);n%=65521,a%=65521}return n|a<<16|0}},{}],31:[function(t,e,i){e.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],32:[function(t,e,i){var s=function(){for(var t,e=[],i=0;i<256;i++){t=i;for(var s=0;s<8;s++)t=1&t?3988292384^t>>>1:t>>>1;e[i]=t}return e}();e.exports=function(t,e,i,n){var a=s,o=n+i;t^=-1;for(var l=n;l<o;l++)t=t>>>8^a[255&(t^e[l])];return-1^t}},{}],33:[function(t,e,i){var s,n=t("../utils/common"),a=t("./trees"),o=t("./adler32"),l=t("./crc32"),r=t("./messages"),c=0,_=1,h=3,d=4,u=5,m=0,f=1,p=-2,g=-3,v=-5,b=-1,w=1,y=2,C=3,k=4,S=0,T=2,I=8,E=9,B=15,x=8,P=286,R=30,N=19,U=2*P+1,A=15,D=3,L=258,F=L+D+1,M=32,G=42,H=69,O=73,V=91,W=103,z=113,q=666,j=1,K=2,Y=3,Z=4,Q=3;function J(t,e){return t.msg=r[e],e}function X(t){return(t<<1)-(t>4?9:0)}function $(t){for(var e=t.length;--e>=0;)t[e]=0}function tt(t){var e=t.state,i=e.pending;i>t.avail_out&&(i=t.avail_out),0!==i&&(n.arraySet(t.output,e.pending_buf,e.pending_out,i,t.next_out),t.next_out+=i,e.pending_out+=i,t.total_out+=i,t.avail_out-=i,e.pending-=i,0===e.pending&&(e.pending_out=0))}function et(t,e){a._tr_flush_block(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,tt(t.strm)}function it(t,e){t.pending_buf[t.pending++]=e}function st(t,e){t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e}function nt(t,e,i,s){var a=t.avail_in;return a>s&&(a=s),0===a?0:(t.avail_in-=a,n.arraySet(e,t.input,t.next_in,a,i),1===t.state.wrap?t.adler=o(t.adler,e,a,i):2===t.state.wrap&&(t.adler=l(t.adler,e,a,i)),t.next_in+=a,t.total_in+=a,a)}function at(t,e){var i,s,n=t.max_chain_length,a=t.strstart,o=t.prev_length,l=t.nice_match,r=t.strstart>t.w_size-F?t.strstart-(t.w_size-F):0,c=t.window,_=t.w_mask,h=t.prev,d=t.strstart+L,u=c[a+o-1],m=c[a+o];t.prev_length>=t.good_match&&(n>>=2),l>t.lookahead&&(l=t.lookahead);do{if(c[(i=e)+o]===m&&c[i+o-1]===u&&c[i]===c[a]&&c[++i]===c[a+1]){a+=2,i++;do{}while(c[++a]===c[++i]&&c[++a]===c[++i]&&c[++a]===c[++i]&&c[++a]===c[++i]&&c[++a]===c[++i]&&c[++a]===c[++i]&&c[++a]===c[++i]&&c[++a]===c[++i]&&a<d);if(s=L-(d-a),a=d-L,s>o){if(t.match_start=e,o=s,s>=l)break;u=c[a+o-1],m=c[a+o]}}}while((e=h[e&_])>r&&0!=--n);return o<=t.lookahead?o:t.lookahead}function ot(t){var e,i,s,a,o,l=t.w_size;do{if(a=t.window_size-t.lookahead-t.strstart,t.strstart>=l+(l-F)){n.arraySet(t.window,t.window,l,l,0),t.match_start-=l,t.strstart-=l,t.block_start-=l,e=i=t.hash_size;do{s=t.head[--e],t.head[e]=s>=l?s-l:0}while(--i);e=i=l;do{s=t.prev[--e],t.prev[e]=s>=l?s-l:0}while(--i);a+=l}if(0===t.strm.avail_in)break;if(i=nt(t.strm,t.window,t.strstart+t.lookahead,a),t.lookahead+=i,t.lookahead+t.insert>=D)for(o=t.strstart-t.insert,t.ins_h=t.window[o],t.ins_h=(t.ins_h<<t.hash_shift^t.window[o+1])&t.hash_mask;t.insert&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[o+D-1])&t.hash_mask,t.prev[o&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=o,o++,t.insert--,!(t.lookahead+t.insert<D)););}while(t.lookahead<F&&0!==t.strm.avail_in)}function lt(t,e){for(var i,s;;){if(t.lookahead<F){if(ot(t),t.lookahead<F&&e===c)return j;if(0===t.lookahead)break}if(i=0,t.lookahead>=D&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+D-1])&t.hash_mask,i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==i&&t.strstart-i<=t.w_size-F&&(t.match_length=at(t,i)),t.match_length>=D)if(s=a._tr_tally(t,t.strstart-t.match_start,t.match_length-D),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=D){t.match_length--;do{t.strstart++,t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+D-1])&t.hash_mask,i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart}while(0!=--t.match_length);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+1])&t.hash_mask;else s=a._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(s&&(et(t,!1),0===t.strm.avail_out))return j}return t.insert=t.strstart<D-1?t.strstart:D-1,e===d?(et(t,!0),0===t.strm.avail_out?Y:Z):t.last_lit&&(et(t,!1),0===t.strm.avail_out)?j:K}function rt(t,e){for(var i,s,n;;){if(t.lookahead<F){if(ot(t),t.lookahead<F&&e===c)return j;if(0===t.lookahead)break}if(i=0,t.lookahead>=D&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+D-1])&t.hash_mask,i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=D-1,0!==i&&t.prev_length<t.max_lazy_match&&t.strstart-i<=t.w_size-F&&(t.match_length=at(t,i),t.match_length<=5&&(t.strategy===w||t.match_length===D&&t.strstart-t.match_start>4096)&&(t.match_length=D-1)),t.prev_length>=D&&t.match_length<=t.prev_length){n=t.strstart+t.lookahead-D,s=a._tr_tally(t,t.strstart-1-t.prev_match,t.prev_length-D),t.lookahead-=t.prev_length-1,t.prev_length-=2;do{++t.strstart<=n&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+D-1])&t.hash_mask,i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart)}while(0!=--t.prev_length);if(t.match_available=0,t.match_length=D-1,t.strstart++,s&&(et(t,!1),0===t.strm.avail_out))return j}else if(t.match_available){if((s=a._tr_tally(t,0,t.window[t.strstart-1]))&&et(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return j}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(s=a._tr_tally(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<D-1?t.strstart:D-1,e===d?(et(t,!0),0===t.strm.avail_out?Y:Z):t.last_lit&&(et(t,!1),0===t.strm.avail_out)?j:K}function ct(t,e){for(var i,s,n,o,l=t.window;;){if(t.lookahead<=L){if(ot(t),t.lookahead<=L&&e===c)return j;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=D&&t.strstart>0&&(s=l[n=t.strstart-1])===l[++n]&&s===l[++n]&&s===l[++n]){o=t.strstart+L;do{}while(s===l[++n]&&s===l[++n]&&s===l[++n]&&s===l[++n]&&s===l[++n]&&s===l[++n]&&s===l[++n]&&s===l[++n]&&n<o);t.match_length=L-(o-n),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=D?(i=a._tr_tally(t,1,t.match_length-D),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(i=a._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),i&&(et(t,!1),0===t.strm.avail_out))return j}return t.insert=0,e===d?(et(t,!0),0===t.strm.avail_out?Y:Z):t.last_lit&&(et(t,!1),0===t.strm.avail_out)?j:K}function _t(t,e){for(var i;;){if(0===t.lookahead&&(ot(t),0===t.lookahead)){if(e===c)return j;break}if(t.match_length=0,i=a._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,i&&(et(t,!1),0===t.strm.avail_out))return j}return t.insert=0,e===d?(et(t,!0),0===t.strm.avail_out?Y:Z):t.last_lit&&(et(t,!1),0===t.strm.avail_out)?j:K}function ht(t,e,i,s,n){this.good_length=t,this.max_lazy=e,this.nice_length=i,this.max_chain=s,this.func=n}function dt(t){t.window_size=2*t.w_size,$(t.head),t.max_lazy_match=s[t.level].max_lazy,t.good_match=s[t.level].good_length,t.nice_match=s[t.level].nice_length,t.max_chain_length=s[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=D-1,t.match_available=0,t.ins_h=0}function ut(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=I,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new n.Buf16(2*U),this.dyn_dtree=new n.Buf16(2*(2*R+1)),this.bl_tree=new n.Buf16(2*(2*N+1)),$(this.dyn_ltree),$(this.dyn_dtree),$(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new n.Buf16(A+1),this.heap=new n.Buf16(2*P+1),$(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new n.Buf16(2*P+1),$(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function mt(t){var e;return t&&t.state?(t.total_in=t.total_out=0,t.data_type=T,(e=t.state).pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?G:z,t.adler=2===e.wrap?0:1,e.last_flush=c,a._tr_init(e),m):J(t,p)}function ft(t){var e=mt(t);return e===m&&dt(t.state),e}function pt(t,e,i,s,a,o){if(!t)return p;var l=1;if(e===b&&(e=6),s<0?(l=0,s=-s):s>15&&(l=2,s-=16),a<1||a>E||i!==I||s<8||s>15||e<0||e>9||o<0||o>k)return J(t,p);8===s&&(s=9);var r=new ut;return t.state=r,r.strm=t,r.wrap=l,r.gzhead=null,r.w_bits=s,r.w_size=1<<r.w_bits,r.w_mask=r.w_size-1,r.hash_bits=a+7,r.hash_size=1<<r.hash_bits,r.hash_mask=r.hash_size-1,r.hash_shift=~~((r.hash_bits+D-1)/D),r.window=new n.Buf8(2*r.w_size),r.head=new n.Buf16(r.hash_size),r.prev=new n.Buf16(r.w_size),r.lit_bufsize=1<<a+6,r.pending_buf_size=4*r.lit_bufsize,r.pending_buf=new n.Buf8(r.pending_buf_size),r.d_buf=r.lit_bufsize>>1,r.l_buf=3*r.lit_bufsize,r.level=e,r.strategy=o,r.method=i,ft(t)}s=[new ht(0,0,0,0,function(t,e){var i=65535;for(i>t.pending_buf_size-5&&(i=t.pending_buf_size-5);;){if(t.lookahead<=1){if(ot(t),0===t.lookahead&&e===c)return j;if(0===t.lookahead)break}t.strstart+=t.lookahead,t.lookahead=0;var s=t.block_start+i;if((0===t.strstart||t.strstart>=s)&&(t.lookahead=t.strstart-s,t.strstart=s,et(t,!1),0===t.strm.avail_out))return j;if(t.strstart-t.block_start>=t.w_size-F&&(et(t,!1),0===t.strm.avail_out))return j}return t.insert=0,e===d?(et(t,!0),0===t.strm.avail_out?Y:Z):(t.strstart>t.block_start&&(et(t,!1),t.strm.avail_out),j)}),new ht(4,4,8,4,lt),new ht(4,5,16,8,lt),new ht(4,6,32,32,lt),new ht(4,4,16,16,rt),new ht(8,16,32,32,rt),new ht(8,16,128,128,rt),new ht(8,32,128,256,rt),new ht(32,128,258,1024,rt),new ht(32,258,258,4096,rt)],i.deflateInit=function(t,e){return pt(t,e,I,B,x,S)},i.deflateInit2=pt,i.deflateReset=ft,i.deflateResetKeep=mt,i.deflateSetHeader=function(t,e){return t&&t.state?2!==t.state.wrap?p:(t.state.gzhead=e,m):p},i.deflate=function(t,e){var i,n,o,r;if(!t||!t.state||e>u||e<0)return t?J(t,p):p;if(n=t.state,!t.output||!t.input&&0!==t.avail_in||n.status===q&&e!==d)return J(t,0===t.avail_out?v:p);if(n.strm=t,i=n.last_flush,n.last_flush=e,n.status===G)if(2===n.wrap)t.adler=0,it(n,31),it(n,139),it(n,8),n.gzhead?(it(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),it(n,255&n.gzhead.time),it(n,n.gzhead.time>>8&255),it(n,n.gzhead.time>>16&255),it(n,n.gzhead.time>>24&255),it(n,9===n.level?2:n.strategy>=y||n.level<2?4:0),it(n,255&n.gzhead.os),n.gzhead.extra&&n.gzhead.extra.length&&(it(n,255&n.gzhead.extra.length),it(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(t.adler=l(t.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=H):(it(n,0),it(n,0),it(n,0),it(n,0),it(n,0),it(n,9===n.level?2:n.strategy>=y||n.level<2?4:0),it(n,Q),n.status=z);else{var g=I+(n.w_bits-8<<4)<<8;g|=(n.strategy>=y||n.level<2?0:n.level<6?1:6===n.level?2:3)<<6,0!==n.strstart&&(g|=M),g+=31-g%31,n.status=z,st(n,g),0!==n.strstart&&(st(n,t.adler>>>16),st(n,65535&t.adler)),t.adler=1}if(n.status===H)if(n.gzhead.extra){for(o=n.pending;n.gzindex<(65535&n.gzhead.extra.length)&&(n.pending!==n.pending_buf_size||(n.gzhead.hcrc&&n.pending>o&&(t.adler=l(t.adler,n.pending_buf,n.pending-o,o)),tt(t),o=n.pending,n.pending!==n.pending_buf_size));)it(n,255&n.gzhead.extra[n.gzindex]),n.gzindex++;n.gzhead.hcrc&&n.pending>o&&(t.adler=l(t.adler,n.pending_buf,n.pending-o,o)),n.gzindex===n.gzhead.extra.length&&(n.gzindex=0,n.status=O)}else n.status=O;if(n.status===O)if(n.gzhead.name){o=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>o&&(t.adler=l(t.adler,n.pending_buf,n.pending-o,o)),tt(t),o=n.pending,n.pending===n.pending_buf_size)){r=1;break}r=n.gzindex<n.gzhead.name.length?255&n.gzhead.name.charCodeAt(n.gzindex++):0,it(n,r)}while(0!==r);n.gzhead.hcrc&&n.pending>o&&(t.adler=l(t.adler,n.pending_buf,n.pending-o,o)),0===r&&(n.gzindex=0,n.status=V)}else n.status=V;if(n.status===V)if(n.gzhead.comment){o=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>o&&(t.adler=l(t.adler,n.pending_buf,n.pending-o,o)),tt(t),o=n.pending,n.pending===n.pending_buf_size)){r=1;break}r=n.gzindex<n.gzhead.comment.length?255&n.gzhead.comment.charCodeAt(n.gzindex++):0,it(n,r)}while(0!==r);n.gzhead.hcrc&&n.pending>o&&(t.adler=l(t.adler,n.pending_buf,n.pending-o,o)),0===r&&(n.status=W)}else n.status=W;if(n.status===W&&(n.gzhead.hcrc?(n.pending+2>n.pending_buf_size&&tt(t),n.pending+2<=n.pending_buf_size&&(it(n,255&t.adler),it(n,t.adler>>8&255),t.adler=0,n.status=z)):n.status=z),0!==n.pending){if(tt(t),0===t.avail_out)return n.last_flush=-1,m}else if(0===t.avail_in&&X(e)<=X(i)&&e!==d)return J(t,v);if(n.status===q&&0!==t.avail_in)return J(t,v);if(0!==t.avail_in||0!==n.lookahead||e!==c&&n.status!==q){var b=n.strategy===y?_t(n,e):n.strategy===C?ct(n,e):s[n.level].func(n,e);if(b!==Y&&b!==Z||(n.status=q),b===j||b===Y)return 0===t.avail_out&&(n.last_flush=-1),m;if(b===K&&(e===_?a._tr_align(n):e!==u&&(a._tr_stored_block(n,0,0,!1),e===h&&($(n.head),0===n.lookahead&&(n.strstart=0,n.block_start=0,n.insert=0))),tt(t),0===t.avail_out))return n.last_flush=-1,m}return e!==d?m:n.wrap<=0?f:(2===n.wrap?(it(n,255&t.adler),it(n,t.adler>>8&255),it(n,t.adler>>16&255),it(n,t.adler>>24&255),it(n,255&t.total_in),it(n,t.total_in>>8&255),it(n,t.total_in>>16&255),it(n,t.total_in>>24&255)):(st(n,t.adler>>>16),st(n,65535&t.adler)),tt(t),n.wrap>0&&(n.wrap=-n.wrap),0!==n.pending?m:f)},i.deflateEnd=function(t){var e;return t&&t.state?(e=t.state.status)!==G&&e!==H&&e!==O&&e!==V&&e!==W&&e!==z&&e!==q?J(t,p):(t.state=null,e===z?J(t,g):m):p},i.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":28,"./adler32":30,"./crc32":32,"./messages":38,"./trees":39}],34:[function(t,e,i){e.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],35:[function(t,e,i){e.exports=function(t,e){var i,s,n,a,o,l,r,c,_,h,d,u,m,f,p,g,v,b,w,y,C,k,S,T,I;i=t.state,s=t.next_in,T=t.input,n=s+(t.avail_in-5),a=t.next_out,I=t.output,o=a-(e-t.avail_out),l=a+(t.avail_out-257),r=i.dmax,c=i.wsize,_=i.whave,h=i.wnext,d=i.window,u=i.hold,m=i.bits,f=i.lencode,p=i.distcode,g=(1<<i.lenbits)-1,v=(1<<i.distbits)-1;t:do{m<15&&(u+=T[s++]<<m,m+=8,u+=T[s++]<<m,m+=8),b=f[u&g];e:for(;;){if(u>>>=w=b>>>24,m-=w,0===(w=b>>>16&255))I[a++]=65535&b;else{if(!(16&w)){if(0==(64&w)){b=f[(65535&b)+(u&(1<<w)-1)];continue e}if(32&w){i.mode=12;break t}t.msg="invalid literal/length code",i.mode=30;break t}y=65535&b,(w&=15)&&(m<w&&(u+=T[s++]<<m,m+=8),y+=u&(1<<w)-1,u>>>=w,m-=w),m<15&&(u+=T[s++]<<m,m+=8,u+=T[s++]<<m,m+=8),b=p[u&v];i:for(;;){if(u>>>=w=b>>>24,m-=w,!(16&(w=b>>>16&255))){if(0==(64&w)){b=p[(65535&b)+(u&(1<<w)-1)];continue i}t.msg="invalid distance code",i.mode=30;break t}if(C=65535&b,m<(w&=15)&&(u+=T[s++]<<m,(m+=8)<w&&(u+=T[s++]<<m,m+=8)),(C+=u&(1<<w)-1)>r){t.msg="invalid distance too far back",i.mode=30;break t}if(u>>>=w,m-=w,C>(w=a-o)){if((w=C-w)>_&&i.sane){t.msg="invalid distance too far back",i.mode=30;break t}if(k=0,S=d,0===h){if(k+=c-w,w<y){y-=w;do{I[a++]=d[k++]}while(--w);k=a-C,S=I}}else if(h<w){if(k+=c+h-w,(w-=h)<y){y-=w;do{I[a++]=d[k++]}while(--w);if(k=0,h<y){y-=w=h;do{I[a++]=d[k++]}while(--w);k=a-C,S=I}}}else if(k+=h-w,w<y){y-=w;do{I[a++]=d[k++]}while(--w);k=a-C,S=I}for(;y>2;)I[a++]=S[k++],I[a++]=S[k++],I[a++]=S[k++],y-=3;y&&(I[a++]=S[k++],y>1&&(I[a++]=S[k++]))}else{k=a-C;do{I[a++]=I[k++],I[a++]=I[k++],I[a++]=I[k++],y-=3}while(y>2);y&&(I[a++]=I[k++],y>1&&(I[a++]=I[k++]))}break}}break}}while(s<n&&a<l);s-=y=m>>3,u&=(1<<(m-=y<<3))-1,t.next_in=s,t.next_out=a,t.avail_in=s<n?n-s+5:5-(s-n),t.avail_out=a<l?l-a+257:257-(a-l),i.hold=u,i.bits=m}},{}],36:[function(t,e,i){var s=t("../utils/common"),n=t("./adler32"),a=t("./crc32"),o=t("./inffast"),l=t("./inftrees"),r=0,c=1,_=2,h=4,d=5,u=6,m=0,f=1,p=2,g=-2,v=-3,b=-4,w=-5,y=8,C=1,k=2,S=3,T=4,I=5,E=6,B=7,x=8,P=9,R=10,N=11,U=12,A=13,D=14,L=15,F=16,M=17,G=18,H=19,O=20,V=21,W=22,z=23,q=24,j=25,K=26,Y=27,Z=28,Q=29,J=30,X=31,$=32,tt=852,et=592,it=15;function st(t){return(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24)}function nt(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new s.Buf16(320),this.work=new s.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function at(t){var e;return t&&t.state?(e=t.state,t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=1&e.wrap),e.mode=C,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new s.Buf32(tt),e.distcode=e.distdyn=new s.Buf32(et),e.sane=1,e.back=-1,m):g}function ot(t){var e;return t&&t.state?((e=t.state).wsize=0,e.whave=0,e.wnext=0,at(t)):g}function lt(t,e){var i,s;return t&&t.state?(s=t.state,e<0?(i=0,e=-e):(i=1+(e>>4),e<48&&(e&=15)),e&&(e<8||e>15)?g:(null!==s.window&&s.wbits!==e&&(s.window=null),s.wrap=i,s.wbits=e,ot(t))):g}function rt(t,e){var i,s;return t?(s=new nt,t.state=s,s.window=null,(i=lt(t,e))!==m&&(t.state=null),i):g}var ct,_t,ht=!0;function dt(t){if(ht){var e;for(ct=new s.Buf32(512),_t=new s.Buf32(32),e=0;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(l(c,t.lens,0,288,ct,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;l(_,t.lens,0,32,_t,0,t.work,{bits:5}),ht=!1}t.lencode=ct,t.lenbits=9,t.distcode=_t,t.distbits=5}function ut(t,e,i,n){var a,o=t.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new s.Buf8(o.wsize)),n>=o.wsize?(s.arraySet(o.window,e,i-o.wsize,o.wsize,0),o.wnext=0,o.whave=o.wsize):((a=o.wsize-o.wnext)>n&&(a=n),s.arraySet(o.window,e,i-n,a,o.wnext),(n-=a)?(s.arraySet(o.window,e,i-n,n,0),o.wnext=n,o.whave=o.wsize):(o.wnext+=a,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=a))),0}i.inflateReset=ot,i.inflateReset2=lt,i.inflateResetKeep=at,i.inflateInit=function(t){return rt(t,it)},i.inflateInit2=rt,i.inflate=function(t,e){var i,tt,et,it,nt,at,ot,lt,rt,ct,_t,ht,mt,ft,pt,gt,vt,bt,wt,yt,Ct,kt,St,Tt,It=0,Et=new s.Buf8(4),Bt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!t||!t.state||!t.output||!t.input&&0!==t.avail_in)return g;(i=t.state).mode===U&&(i.mode=A),nt=t.next_out,et=t.output,ot=t.avail_out,it=t.next_in,tt=t.input,at=t.avail_in,lt=i.hold,rt=i.bits,ct=at,_t=ot,kt=m;t:for(;;)switch(i.mode){case C:if(0===i.wrap){i.mode=A;break}for(;rt<16;){if(0===at)break t;at--,lt+=tt[it++]<<rt,rt+=8}if(2&i.wrap&&35615===lt){i.check=0,Et[0]=255&lt,Et[1]=lt>>>8&255,i.check=a(i.check,Et,2,0),lt=0,rt=0,i.mode=k;break}if(i.flags=0,i.head&&(i.head.done=!1),!(1&i.wrap)||(((255&lt)<<8)+(lt>>8))%31){t.msg="incorrect header check",i.mode=J;break}if((15&lt)!==y){t.msg="unknown compression method",i.mode=J;break}if(rt-=4,Ct=8+(15&(lt>>>=4)),0===i.wbits)i.wbits=Ct;else if(Ct>i.wbits){t.msg="invalid window size",i.mode=J;break}i.dmax=1<<Ct,t.adler=i.check=1,i.mode=512&lt?R:U,lt=0,rt=0;break;case k:for(;rt<16;){if(0===at)break t;at--,lt+=tt[it++]<<rt,rt+=8}if(i.flags=lt,(255&i.flags)!==y){t.msg="unknown compression method",i.mode=J;break}if(57344&i.flags){t.msg="unknown header flags set",i.mode=J;break}i.head&&(i.head.text=lt>>8&1),512&i.flags&&(Et[0]=255&lt,Et[1]=lt>>>8&255,i.check=a(i.check,Et,2,0)),lt=0,rt=0,i.mode=S;case S:for(;rt<32;){if(0===at)break t;at--,lt+=tt[it++]<<rt,rt+=8}i.head&&(i.head.time=lt),512&i.flags&&(Et[0]=255&lt,Et[1]=lt>>>8&255,Et[2]=lt>>>16&255,Et[3]=lt>>>24&255,i.check=a(i.check,Et,4,0)),lt=0,rt=0,i.mode=T;case T:for(;rt<16;){if(0===at)break t;at--,lt+=tt[it++]<<rt,rt+=8}i.head&&(i.head.xflags=255&lt,i.head.os=lt>>8),512&i.flags&&(Et[0]=255&lt,Et[1]=lt>>>8&255,i.check=a(i.check,Et,2,0)),lt=0,rt=0,i.mode=I;case I:if(1024&i.flags){for(;rt<16;){if(0===at)break t;at--,lt+=tt[it++]<<rt,rt+=8}i.length=lt,i.head&&(i.head.extra_len=lt),512&i.flags&&(Et[0]=255&lt,Et[1]=lt>>>8&255,i.check=a(i.check,Et,2,0)),lt=0,rt=0}else i.head&&(i.head.extra=null);i.mode=E;case E:if(1024&i.flags&&((ht=i.length)>at&&(ht=at),ht&&(i.head&&(Ct=i.head.extra_len-i.length,i.head.extra||(i.head.extra=new Array(i.head.extra_len)),s.arraySet(i.head.extra,tt,it,ht,Ct)),512&i.flags&&(i.check=a(i.check,tt,ht,it)),at-=ht,it+=ht,i.length-=ht),i.length))break t;i.length=0,i.mode=B;case B:if(2048&i.flags){if(0===at)break t;ht=0;do{Ct=tt[it+ht++],i.head&&Ct&&i.length<65536&&(i.head.name+=String.fromCharCode(Ct))}while(Ct&&ht<at);if(512&i.flags&&(i.check=a(i.check,tt,ht,it)),at-=ht,it+=ht,Ct)break t}else i.head&&(i.head.name=null);i.length=0,i.mode=x;case x:if(4096&i.flags){if(0===at)break t;ht=0;do{Ct=tt[it+ht++],i.head&&Ct&&i.length<65536&&(i.head.comment+=String.fromCharCode(Ct))}while(Ct&&ht<at);if(512&i.flags&&(i.check=a(i.check,tt,ht,it)),at-=ht,it+=ht,Ct)break t}else i.head&&(i.head.comment=null);i.mode=P;case P:if(512&i.flags){for(;rt<16;){if(0===at)break t;at--,lt+=tt[it++]<<rt,rt+=8}if(lt!==(65535&i.check)){t.msg="header crc mismatch",i.mode=J;break}lt=0,rt=0}i.head&&(i.head.hcrc=i.flags>>9&1,i.head.done=!0),t.adler=i.check=0,i.mode=U;break;case R:for(;rt<32;){if(0===at)break t;at--,lt+=tt[it++]<<rt,rt+=8}t.adler=i.check=st(lt),lt=0,rt=0,i.mode=N;case N:if(0===i.havedict)return t.next_out=nt,t.avail_out=ot,t.next_in=it,t.avail_in=at,i.hold=lt,i.bits=rt,p;t.adler=i.check=1,i.mode=U;case U:if(e===d||e===u)break t;case A:if(i.last){lt>>>=7&rt,rt-=7&rt,i.mode=Y;break}for(;rt<3;){if(0===at)break t;at--,lt+=tt[it++]<<rt,rt+=8}switch(i.last=1&lt,rt-=1,3&(lt>>>=1)){case 0:i.mode=D;break;case 1:if(dt(i),i.mode=O,e===u){lt>>>=2,rt-=2;break t}break;case 2:i.mode=M;break;case 3:t.msg="invalid block type",i.mode=J}lt>>>=2,rt-=2;break;case D:for(lt>>>=7&rt,rt-=7&rt;rt<32;){if(0===at)break t;at--,lt+=tt[it++]<<rt,rt+=8}if((65535&lt)!=(lt>>>16^65535)){t.msg="invalid stored block lengths",i.mode=J;break}if(i.length=65535&lt,lt=0,rt=0,i.mode=L,e===u)break t;case L:i.mode=F;case F:if(ht=i.length){if(ht>at&&(ht=at),ht>ot&&(ht=ot),0===ht)break t;s.arraySet(et,tt,it,ht,nt),at-=ht,it+=ht,ot-=ht,nt+=ht,i.length-=ht;break}i.mode=U;break;case M:for(;rt<14;){if(0===at)break t;at--,lt+=tt[it++]<<rt,rt+=8}if(i.nlen=257+(31&lt),lt>>>=5,rt-=5,i.ndist=1+(31&lt),lt>>>=5,rt-=5,i.ncode=4+(15&lt),lt>>>=4,rt-=4,i.nlen>286||i.ndist>30){t.msg="too many length or distance symbols",i.mode=J;break}i.have=0,i.mode=G;case G:for(;i.have<i.ncode;){for(;rt<3;){if(0===at)break t;at--,lt+=tt[it++]<<rt,rt+=8}i.lens[Bt[i.have++]]=7&lt,lt>>>=3,rt-=3}for(;i.have<19;)i.lens[Bt[i.have++]]=0;if(i.lencode=i.lendyn,i.lenbits=7,St={bits:i.lenbits},kt=l(r,i.lens,0,19,i.lencode,0,i.work,St),i.lenbits=St.bits,kt){t.msg="invalid code lengths set",i.mode=J;break}i.have=0,i.mode=H;case H:for(;i.have<i.nlen+i.ndist;){for(;gt=(It=i.lencode[lt&(1<<i.lenbits)-1])>>>16&255,vt=65535&It,!((pt=It>>>24)<=rt);){if(0===at)break t;at--,lt+=tt[it++]<<rt,rt+=8}if(vt<16)lt>>>=pt,rt-=pt,i.lens[i.have++]=vt;else{if(16===vt){for(Tt=pt+2;rt<Tt;){if(0===at)break t;at--,lt+=tt[it++]<<rt,rt+=8}if(lt>>>=pt,rt-=pt,0===i.have){t.msg="invalid bit length repeat",i.mode=J;break}Ct=i.lens[i.have-1],ht=3+(3&lt),lt>>>=2,rt-=2}else if(17===vt){for(Tt=pt+3;rt<Tt;){if(0===at)break t;at--,lt+=tt[it++]<<rt,rt+=8}rt-=pt,Ct=0,ht=3+(7&(lt>>>=pt)),lt>>>=3,rt-=3}else{for(Tt=pt+7;rt<Tt;){if(0===at)break t;at--,lt+=tt[it++]<<rt,rt+=8}rt-=pt,Ct=0,ht=11+(127&(lt>>>=pt)),lt>>>=7,rt-=7}if(i.have+ht>i.nlen+i.ndist){t.msg="invalid bit length repeat",i.mode=J;break}for(;ht--;)i.lens[i.have++]=Ct}}if(i.mode===J)break;if(0===i.lens[256]){t.msg="invalid code -- missing end-of-block",i.mode=J;break}if(i.lenbits=9,St={bits:i.lenbits},kt=l(c,i.lens,0,i.nlen,i.lencode,0,i.work,St),i.lenbits=St.bits,kt){t.msg="invalid literal/lengths set",i.mode=J;break}if(i.distbits=6,i.distcode=i.distdyn,St={bits:i.distbits},kt=l(_,i.lens,i.nlen,i.ndist,i.distcode,0,i.work,St),i.distbits=St.bits,kt){t.msg="invalid distances set",i.mode=J;break}if(i.mode=O,e===u)break t;case O:i.mode=V;case V:if(at>=6&&ot>=258){t.next_out=nt,t.avail_out=ot,t.next_in=it,t.avail_in=at,i.hold=lt,i.bits=rt,o(t,_t),nt=t.next_out,et=t.output,ot=t.avail_out,it=t.next_in,tt=t.input,at=t.avail_in,lt=i.hold,rt=i.bits,i.mode===U&&(i.back=-1);break}for(i.back=0;gt=(It=i.lencode[lt&(1<<i.lenbits)-1])>>>16&255,vt=65535&It,!((pt=It>>>24)<=rt);){if(0===at)break t;at--,lt+=tt[it++]<<rt,rt+=8}if(gt&&0==(240&gt)){for(bt=pt,wt=gt,yt=vt;gt=(It=i.lencode[yt+((lt&(1<<bt+wt)-1)>>bt)])>>>16&255,vt=65535&It,!(bt+(pt=It>>>24)<=rt);){if(0===at)break t;at--,lt+=tt[it++]<<rt,rt+=8}lt>>>=bt,rt-=bt,i.back+=bt}if(lt>>>=pt,rt-=pt,i.back+=pt,i.length=vt,0===gt){i.mode=K;break}if(32&gt){i.back=-1,i.mode=U;break}if(64&gt){t.msg="invalid literal/length code",i.mode=J;break}i.extra=15&gt,i.mode=W;case W:if(i.extra){for(Tt=i.extra;rt<Tt;){if(0===at)break t;at--,lt+=tt[it++]<<rt,rt+=8}i.length+=lt&(1<<i.extra)-1,lt>>>=i.extra,rt-=i.extra,i.back+=i.extra}i.was=i.length,i.mode=z;case z:for(;gt=(It=i.distcode[lt&(1<<i.distbits)-1])>>>16&255,vt=65535&It,!((pt=It>>>24)<=rt);){if(0===at)break t;at--,lt+=tt[it++]<<rt,rt+=8}if(0==(240&gt)){for(bt=pt,wt=gt,yt=vt;gt=(It=i.distcode[yt+((lt&(1<<bt+wt)-1)>>bt)])>>>16&255,vt=65535&It,!(bt+(pt=It>>>24)<=rt);){if(0===at)break t;at--,lt+=tt[it++]<<rt,rt+=8}lt>>>=bt,rt-=bt,i.back+=bt}if(lt>>>=pt,rt-=pt,i.back+=pt,64&gt){t.msg="invalid distance code",i.mode=J;break}i.offset=vt,i.extra=15&gt,i.mode=q;case q:if(i.extra){for(Tt=i.extra;rt<Tt;){if(0===at)break t;at--,lt+=tt[it++]<<rt,rt+=8}i.offset+=lt&(1<<i.extra)-1,lt>>>=i.extra,rt-=i.extra,i.back+=i.extra}if(i.offset>i.dmax){t.msg="invalid distance too far back",i.mode=J;break}i.mode=j;case j:if(0===ot)break t;if(ht=_t-ot,i.offset>ht){if((ht=i.offset-ht)>i.whave&&i.sane){t.msg="invalid distance too far back",i.mode=J;break}ht>i.wnext?(ht-=i.wnext,mt=i.wsize-ht):mt=i.wnext-ht,ht>i.length&&(ht=i.length),ft=i.window}else ft=et,mt=nt-i.offset,ht=i.length;ht>ot&&(ht=ot),ot-=ht,i.length-=ht;do{et[nt++]=ft[mt++]}while(--ht);0===i.length&&(i.mode=V);break;case K:if(0===ot)break t;et[nt++]=i.length,ot--,i.mode=V;break;case Y:if(i.wrap){for(;rt<32;){if(0===at)break t;at--,lt|=tt[it++]<<rt,rt+=8}if(_t-=ot,t.total_out+=_t,i.total+=_t,_t&&(t.adler=i.check=i.flags?a(i.check,et,_t,nt-_t):n(i.check,et,_t,nt-_t)),_t=ot,(i.flags?lt:st(lt))!==i.check){t.msg="incorrect data check",i.mode=J;break}lt=0,rt=0}i.mode=Z;case Z:if(i.wrap&&i.flags){for(;rt<32;){if(0===at)break t;at--,lt+=tt[it++]<<rt,rt+=8}if(lt!==(4294967295&i.total)){t.msg="incorrect length check",i.mode=J;break}lt=0,rt=0}i.mode=Q;case Q:kt=f;break t;case J:kt=v;break t;case X:return b;case $:default:return g}return t.next_out=nt,t.avail_out=ot,t.next_in=it,t.avail_in=at,i.hold=lt,i.bits=rt,(i.wsize||_t!==t.avail_out&&i.mode<J&&(i.mode<Y||e!==h))&&ut(t,t.output,t.next_out,_t-t.avail_out)?(i.mode=X,b):(ct-=t.avail_in,_t-=t.avail_out,t.total_in+=ct,t.total_out+=_t,i.total+=_t,i.wrap&&_t&&(t.adler=i.check=i.flags?a(i.check,et,_t,t.next_out-_t):n(i.check,et,_t,t.next_out-_t)),t.data_type=i.bits+(i.last?64:0)+(i.mode===U?128:0)+(i.mode===O||i.mode===L?256:0),(0===ct&&0===_t||e===h)&&kt===m&&(kt=w),kt)},i.inflateEnd=function(t){if(!t||!t.state)return g;var e=t.state;return e.window&&(e.window=null),t.state=null,m},i.inflateGetHeader=function(t,e){var i;return t&&t.state?0==(2&(i=t.state).wrap)?g:(i.head=e,e.done=!1,m):g},i.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":28,"./adler32":30,"./crc32":32,"./inffast":35,"./inftrees":37}],37:[function(t,e,i){var s=t("../utils/common"),n=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],a=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],o=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],l=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];e.exports=function(t,e,i,r,c,_,h,d){var u,m,f,p,g,v,b,w,y,C=d.bits,k=0,S=0,T=0,I=0,E=0,B=0,x=0,P=0,R=0,N=0,U=null,A=0,D=new s.Buf16(16),L=new s.Buf16(16),F=null,M=0;for(k=0;k<=15;k++)D[k]=0;for(S=0;S<r;S++)D[e[i+S]]++;for(E=C,I=15;I>=1&&0===D[I];I--);if(E>I&&(E=I),0===I)return c[_++]=20971520,c[_++]=20971520,d.bits=1,0;for(T=1;T<I&&0===D[T];T++);for(E<T&&(E=T),P=1,k=1;k<=15;k++)if(P<<=1,(P-=D[k])<0)return-1;if(P>0&&(0===t||1!==I))return-1;for(L[1]=0,k=1;k<15;k++)L[k+1]=L[k]+D[k];for(S=0;S<r;S++)0!==e[i+S]&&(h[L[e[i+S]]++]=S);if(0===t?(U=F=h,v=19):1===t?(U=n,A-=257,F=a,M-=257,v=256):(U=o,F=l,v=-1),N=0,S=0,k=T,g=_,B=E,x=0,f=-1,p=(R=1<<E)-1,1===t&&R>852||2===t&&R>592)return 1;for(;;){0,b=k-x,h[S]<v?(w=0,y=h[S]):h[S]>v?(w=F[M+h[S]],y=U[A+h[S]]):(w=96,y=0),u=1<<k-x,T=m=1<<B;do{c[g+(N>>x)+(m-=u)]=b<<24|w<<16|y|0}while(0!==m);for(u=1<<k-1;N&u;)u>>=1;if(0!==u?(N&=u-1,N+=u):N=0,S++,0==--D[k]){if(k===I)break;k=e[i+h[S]]}if(k>E&&(N&p)!==f){for(0===x&&(x=E),g+=T,P=1<<(B=k-x);B+x<I&&!((P-=D[B+x])<=0);)B++,P<<=1;if(R+=1<<B,1===t&&R>852||2===t&&R>592)return 1;c[f=N&p]=E<<24|B<<16|g-_|0}}return 0!==N&&(c[g+N]=k-x<<24|64<<16|0),d.bits=E,0}},{"../utils/common":28}],38:[function(t,e,i){e.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],39:[function(t,e,i){var s=t("../utils/common"),n=4,a=0,o=1,l=2;function r(t){for(var e=t.length;--e>=0;)t[e]=0}var c=0,_=1,h=2,d=29,u=256,m=u+1+d,f=30,p=19,g=2*m+1,v=15,b=16,w=7,y=256,C=16,k=17,S=18,T=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],I=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],E=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],B=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],x=new Array(2*(m+2));r(x);var P=new Array(2*f);r(P);var R=new Array(512);r(R);var N=new Array(256);r(N);var U=new Array(d);r(U);var A,D,L,F=new Array(f);function M(t,e,i,s,n){this.static_tree=t,this.extra_bits=e,this.extra_base=i,this.elems=s,this.max_length=n,this.has_stree=t&&t.length}function G(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}function H(t){return t<256?R[t]:R[256+(t>>>7)]}function O(t,e){t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255}function V(t,e,i){t.bi_valid>b-i?(t.bi_buf|=e<<t.bi_valid&65535,O(t,t.bi_buf),t.bi_buf=e>>b-t.bi_valid,t.bi_valid+=i-b):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=i)}function W(t,e,i){V(t,i[2*e],i[2*e+1])}function z(t,e){var i=0;do{i|=1&t,t>>>=1,i<<=1}while(--e>0);return i>>>1}function q(t){16===t.bi_valid?(O(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)}function j(t,e){var i,s,n,a,o,l,r=e.dyn_tree,c=e.max_code,_=e.stat_desc.static_tree,h=e.stat_desc.has_stree,d=e.stat_desc.extra_bits,u=e.stat_desc.extra_base,m=e.stat_desc.max_length,f=0;for(a=0;a<=v;a++)t.bl_count[a]=0;for(r[2*t.heap[t.heap_max]+1]=0,i=t.heap_max+1;i<g;i++)(a=r[2*r[2*(s=t.heap[i])+1]+1]+1)>m&&(a=m,f++),r[2*s+1]=a,s>c||(t.bl_count[a]++,o=0,s>=u&&(o=d[s-u]),l=r[2*s],t.opt_len+=l*(a+o),h&&(t.static_len+=l*(_[2*s+1]+o)));if(0!==f){do{for(a=m-1;0===t.bl_count[a];)a--;t.bl_count[a]--,t.bl_count[a+1]+=2,t.bl_count[m]--,f-=2}while(f>0);for(a=m;0!==a;a--)for(s=t.bl_count[a];0!==s;)(n=t.heap[--i])>c||(r[2*n+1]!==a&&(t.opt_len+=(a-r[2*n+1])*r[2*n],r[2*n+1]=a),s--)}}function K(t,e,i){var s,n,a=new Array(v+1),o=0;for(s=1;s<=v;s++)a[s]=o=o+i[s-1]<<1;for(n=0;n<=e;n++){var l=t[2*n+1];0!==l&&(t[2*n]=z(a[l]++,l))}}function Y(){var t,e,i,s,n,a=new Array(v+1);for(i=0,s=0;s<d-1;s++)for(U[s]=i,t=0;t<1<<T[s];t++)N[i++]=s;for(N[i-1]=s,n=0,s=0;s<16;s++)for(F[s]=n,t=0;t<1<<I[s];t++)R[n++]=s;for(n>>=7;s<f;s++)for(F[s]=n<<7,t=0;t<1<<I[s]-7;t++)R[256+n++]=s;for(e=0;e<=v;e++)a[e]=0;for(t=0;t<=143;)x[2*t+1]=8,t++,a[8]++;for(;t<=255;)x[2*t+1]=9,t++,a[9]++;for(;t<=279;)x[2*t+1]=7,t++,a[7]++;for(;t<=287;)x[2*t+1]=8,t++,a[8]++;for(K(x,m+1,a),t=0;t<f;t++)P[2*t+1]=5,P[2*t]=z(t,5);A=new M(x,T,u+1,m,v),D=new M(P,I,0,f,v),L=new M(new Array(0),E,0,p,w)}function Z(t){var e;for(e=0;e<m;e++)t.dyn_ltree[2*e]=0;for(e=0;e<f;e++)t.dyn_dtree[2*e]=0;for(e=0;e<p;e++)t.bl_tree[2*e]=0;t.dyn_ltree[2*y]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0}function Q(t){t.bi_valid>8?O(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0}function J(t,e,i,n){Q(t),n&&(O(t,i),O(t,~i)),s.arraySet(t.pending_buf,t.window,e,i,t.pending),t.pending+=i}function X(t,e,i,s){var n=2*e,a=2*i;return t[n]<t[a]||t[n]===t[a]&&s[e]<=s[i]}function $(t,e,i){for(var s=t.heap[i],n=i<<1;n<=t.heap_len&&(n<t.heap_len&&X(e,t.heap[n+1],t.heap[n],t.depth)&&n++,!X(e,s,t.heap[n],t.depth));)t.heap[i]=t.heap[n],i=n,n<<=1;t.heap[i]=s}function tt(t,e,i){var s,n,a,o,l=0;if(0!==t.last_lit)do{s=t.pending_buf[t.d_buf+2*l]<<8|t.pending_buf[t.d_buf+2*l+1],n=t.pending_buf[t.l_buf+l],l++,0===s?W(t,n,e):(W(t,(a=N[n])+u+1,e),0!==(o=T[a])&&V(t,n-=U[a],o),W(t,a=H(--s),i),0!==(o=I[a])&&V(t,s-=F[a],o))}while(l<t.last_lit);W(t,y,e)}function et(t,e){var i,s,n,a=e.dyn_tree,o=e.stat_desc.static_tree,l=e.stat_desc.has_stree,r=e.stat_desc.elems,c=-1;for(t.heap_len=0,t.heap_max=g,i=0;i<r;i++)0!==a[2*i]?(t.heap[++t.heap_len]=c=i,t.depth[i]=0):a[2*i+1]=0;for(;t.heap_len<2;)a[2*(n=t.heap[++t.heap_len]=c<2?++c:0)]=1,t.depth[n]=0,t.opt_len--,l&&(t.static_len-=o[2*n+1]);for(e.max_code=c,i=t.heap_len>>1;i>=1;i--)$(t,a,i);n=r;do{i=t.heap[1],t.heap[1]=t.heap[t.heap_len--],$(t,a,1),s=t.heap[1],t.heap[--t.heap_max]=i,t.heap[--t.heap_max]=s,a[2*n]=a[2*i]+a[2*s],t.depth[n]=(t.depth[i]>=t.depth[s]?t.depth[i]:t.depth[s])+1,a[2*i+1]=a[2*s+1]=n,t.heap[1]=n++,$(t,a,1)}while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],j(t,e),K(a,c,t.bl_count)}function it(t,e,i){var s,n,a=-1,o=e[1],l=0,r=7,c=4;for(0===o&&(r=138,c=3),e[2*(i+1)+1]=65535,s=0;s<=i;s++)n=o,o=e[2*(s+1)+1],++l<r&&n===o||(l<c?t.bl_tree[2*n]+=l:0!==n?(n!==a&&t.bl_tree[2*n]++,t.bl_tree[2*C]++):l<=10?t.bl_tree[2*k]++:t.bl_tree[2*S]++,l=0,a=n,0===o?(r=138,c=3):n===o?(r=6,c=3):(r=7,c=4))}function st(t,e,i){var s,n,a=-1,o=e[1],l=0,r=7,c=4;for(0===o&&(r=138,c=3),s=0;s<=i;s++)if(n=o,o=e[2*(s+1)+1],!(++l<r&&n===o)){if(l<c)do{W(t,n,t.bl_tree)}while(0!=--l);else 0!==n?(n!==a&&(W(t,n,t.bl_tree),l--),W(t,C,t.bl_tree),V(t,l-3,2)):l<=10?(W(t,k,t.bl_tree),V(t,l-3,3)):(W(t,S,t.bl_tree),V(t,l-11,7));l=0,a=n,0===o?(r=138,c=3):n===o?(r=6,c=3):(r=7,c=4)}}function nt(t){var e;for(it(t,t.dyn_ltree,t.l_desc.max_code),it(t,t.dyn_dtree,t.d_desc.max_code),et(t,t.bl_desc),e=p-1;e>=3&&0===t.bl_tree[2*B[e]+1];e--);return t.opt_len+=3*(e+1)+5+5+4,e}function at(t,e,i,s){var n;for(V(t,e-257,5),V(t,i-1,5),V(t,s-4,4),n=0;n<s;n++)V(t,t.bl_tree[2*B[n]+1],3);st(t,t.dyn_ltree,e-1),st(t,t.dyn_dtree,i-1)}function ot(t){var e,i=4093624447;for(e=0;e<=31;e++,i>>>=1)if(1&i&&0!==t.dyn_ltree[2*e])return a;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return o;for(e=32;e<u;e++)if(0!==t.dyn_ltree[2*e])return o;return a}r(F);var lt=!1;function rt(t,e,i,s){V(t,(c<<1)+(s?1:0),3),J(t,e,i,!0)}i._tr_init=function(t){lt||(Y(),lt=!0),t.l_desc=new G(t.dyn_ltree,A),t.d_desc=new G(t.dyn_dtree,D),t.bl_desc=new G(t.bl_tree,L),t.bi_buf=0,t.bi_valid=0,Z(t)},i._tr_stored_block=rt,i._tr_flush_block=function(t,e,i,s){var a,o,r=0;t.level>0?(t.strm.data_type===l&&(t.strm.data_type=ot(t)),et(t,t.l_desc),et(t,t.d_desc),r=nt(t),a=t.opt_len+3+7>>>3,(o=t.static_len+3+7>>>3)<=a&&(a=o)):a=o=i+5,i+4<=a&&-1!==e?rt(t,e,i,s):t.strategy===n||o===a?(V(t,(_<<1)+(s?1:0),3),tt(t,x,P)):(V(t,(h<<1)+(s?1:0),3),at(t,t.l_desc.max_code+1,t.d_desc.max_code+1,r+1),tt(t,t.dyn_ltree,t.dyn_dtree)),Z(t),s&&Q(t)},i._tr_tally=function(t,e,i){return t.pending_buf[t.d_buf+2*t.last_lit]=e>>>8&255,t.pending_buf[t.d_buf+2*t.last_lit+1]=255&e,t.pending_buf[t.l_buf+t.last_lit]=255&i,t.last_lit++,0===e?t.dyn_ltree[2*i]++:(t.matches++,e--,t.dyn_ltree[2*(N[i]+u+1)]++,t.dyn_dtree[2*H(e)]++),t.last_lit===t.lit_bufsize-1},i._tr_align=function(t){V(t,_<<1,3),W(t,y,x),q(t)}},{"../utils/common":28}],40:[function(t,e,i){e.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}]},{},[10])(10)}),cc._RF.pop()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},t("buffer").Buffer)},{"../utils/common":void 0,"./adler32":void 0,"./arrayReader":void 0,"./base64":void 0,"./common":void 0,"./compressedObject":void 0,"./compressions":void 0,"./crc32":void 0,"./dataReader":void 0,"./defaults":void 0,"./deprecatedPublicUtils":void 0,"./flate":void 0,"./inffast":void 0,"./inftrees":void 0,"./lib/deflate":void 0,"./lib/inflate":void 0,"./lib/utils/common":void 0,"./lib/zlib/constants":void 0,"./load":void 0,"./messages":void 0,"./nodeBuffer":void 0,"./nodeBufferReader":void 0,"./object":void 0,"./signature":void 0,"./stringReader":void 0,"./stringWriter":void 0,"./support":void 0,"./trees":void 0,"./uint8ArrayReader":void 0,"./uint8ArrayWriter":void 0,"./utf8":void 0,"./utils":void 0,"./utils/common":void 0,"./utils/strings":void 0,"./zipEntries":void 0,"./zipEntry":void 0,"./zlib/constants":void 0,"./zlib/deflate":void 0,"./zlib/gzheader":void 0,"./zlib/inflate":void 0,"./zlib/messages":void 0,"./zlib/zstream":void 0,buffer:2,pako:"pako"}],jump_controller:[function(t,e,i){"use strict";cc._RF.push(e,"8d4f6LDscFE25cnhl6m7rJp","jump_controller");var s=cc.Class({extends:BaseController,ctor:function(){},initConfig:function(){},registerEvents:function(){},registerProtocals:function(){},jumpViewByEvtData:function(e){if(e&&e[0]){var i=Number(e[0]);if(1==i)(s=t("partnersummon_controller")).getInstance().openPartnerSummonWindow(!0);else if(2==i){var s=t("partnersummon_controller");if(e&&Utils.next(e)){var n=e[1],a=e[2];if("star"==n)if(a<=5)s.getInstance().openPartnerSummonWindow(!0);else t("hero_controller").getInstance().openHeroUpgradeStarFuseWindow(!0);else if("lev"==n){var o=t("mainui_controller"),l=t("mainui_const");o.getInstance().changeMainUIStatus(l.btn_index.partner)}else s.getInstance().openPartnerSummonWindow(!0)}else s.getInstance().openPartnerSummonWindow(!0)}else if(3==i){o=t("mainui_controller"),l=t("mainui_const");o.getInstance().changeMainUIStatus(l.btn_index.main_scene,l.sub_type.arena_call)}else if(4==i){var r=t("friend_controller"),c=t("friend_const");r.getInstance().openFriendWindow(!0,c.Type.MyFriend)}else if(5==i){o=t("mainui_controller"),l=t("mainui_const");o.getInstance().changeMainUIStatus(l.btn_index.drama_scene)}else if(6==i){t("mall_controller").getInstance().openVarietyStoreWindows(!0)}else if(7==i){var _=e[1]||VIPTABCONST.VIP,h=e[2];t("vip_controller").getInstance().openVipMainWindow(!0,_,h)}else if(8==i){h=e[1],o=t("mainui_controller"),l=t("mainui_const");o.getInstance().changeMainUIStatus(l.btn_index.backpack,h)}else if(9==i){var d=t("chat_const"),u=t("chat_controller"),m=e[1]||d.Channel.World;u.getInstance().openChatPanel(m)}else if(10==i){u=t("chat_controller"),d=t("chat_const");u.getInstance().openChatPanel(d.Channel.Friend,"friend")}else if(11==i){t("battle_drama_controller").getInstance().openDramBattleQuickView(!0)}else if(12==i){o=t("mainui_controller"),l=t("mainui_const");o.getInstance().changeMainUIStatus(l.btn_index.main_scene,l.sub_type.startower)}else if(13==i){if((v=t("role_controller")).getInstance().getRoleVo().isHasGuild()){t("guild_controller").getInstance().openGuildDonateWindow(!0)}else{o=t("mainui_controller"),l=t("mainui_const");o.getInstance().changeMainUIStatus(l.btn_index.guild)}}else if(14==i){o=t("mainui_controller"),l=t("mainui_const");o.getInstance().changeMainUIStatus(l.btn_index.guild)}else if(15==i){var f=e[1],p=e[2];t("mall_controller").getInstance().openMallPanel(!0,f,p)}else if(16==i){t("stronger_controller").getInstance().openMainWin(!0)}else if(17==i){o=t("mainui_controller"),l=t("mainui_const");o.getInstance().changeMainUIStatus(l.btn_index.main_scene,l.sub_type.dungeonstone)}else if(18==i){t("voyage_controller").getInstance().openVoyageMainWindow(!0)}else if(19==i){h=e[1],o=t("mainui_controller"),l=t("mainui_const");o.getInstance().changeMainUIStatus(l.btn_index.partner,h)}else if(20==i){o=t("mainui_controller"),l=t("mainui_const");o.getInstance().changeMainUIStatus(l.btn_index.hallows)}else if(21==i);else if(22==i){t("hero_controller").getInstance().openHeroResetWindow(!0)}else if(23==i){t("hero_controller").getInstance().openHeroUpgradeStarFuseWindow(!0)}else if(24==i){h=e[1],o=t("mainui_controller"),l=t("mainui_const");o.getInstance().changeMainUIStatus(l.btn_index.main_scene,l.sub_type.seerpalace,h)}else if(25==i){o=t("mainui_controller"),l=t("mainui_const");o.getInstance().changeMainUIStatus(l.btn_index.main_scene,l.sub_type.expedit_fight)}else if(26==i){o=t("mainui_controller"),l=t("mainui_const");var g=t("forgehouse_const");h=e[1]||g.Tab_Index.Equip;o.getInstance().changeMainUIStatus(l.btn_index.main_scene,l.sub_type.forge_house,h)}else if(27==i){o=t("mainui_controller"),l=t("mainui_const");o.getInstance().changeMainUIStatus(l.btn_index.main_scene,l.sub_type.primuswar)}else if(28==i);else if(29==i);else if(30==i){t("hero_controller").getInstance().openFormMainWindow(!0)}else if(31==i){var v=t("role_controller");o=t("mainui_controller");if(v.getInstance().getRoleVo().isHasGuild()){var b=t("battle_const");o.getInstance().requestOpenBattleRelevanceWindow(b.Fight_Type.GuildDun)}else{l=t("mainui_const");o.getInstance().changeMainUIStatus(l.btn_index.guild)}}else if(32==i){if((v=t("role_controller")).getInstance().getRoleVo().isHasGuild()){t("guildskill_controller").getInstance().openGuildSkillMainWindow(!0)}else{o=t("mainui_controller"),l=t("mainui_const");o.getInstance().changeMainUIStatus(l.btn_index.guild)}}else if(33==i){if((v=t("role_controller")).getInstance().getRoleVo().isHasGuild()){t("redbag_controller").getInstance().openMainView(!0)}else{o=t("mainui_controller"),l=t("mainui_const");o.getInstance().changeMainUIStatus(l.btn_index.guild)}}else if(34==i){o=t("mainui_controller"),l=t("mainui_const");o.getInstance().changeMainUIStatus(l.btn_index.main_scene,l.sub_type.adventure)}else if(35==i){t("exchange_controller").getInstance().openExchangeMainView(!0)}else if(36==i){o=t("mainui_controller"),l=t("mainui_const");o.getInstance().changeMainUIStatus(l.btn_index.main_scene,l.sub_type.champion_call)}else if(37==i);else if(38==i){var w=t("welfare_controller"),y=t("action_const");w.getInstance().openMainWindow(!0,y.ActionSpecialID.invest)}else if(39==i){w=t("welfare_controller"),y=t("action_const");w.getInstance().openMainWindow(!0,y.ActionSpecialID.growfund)}else if(40==i){t("action_controller").getInstance().openLuckyTreasureWin(!0)}else if(41==i){h=e[1];t("task_controller").getInstance().openTaskMainWindow(!0,h)}else if(42==i);else if(43==i){o=t("mainui_controller"),l=t("mainui_const");o.getInstance().changeMainUIStatus(l.btn_index.main_scene,l.sub_type.endless)}else if(44==i){w=t("welfare_controller");var C=t("welfare_const");w.getInstance().openMainWindow(!0,C.WelfareIcon.supre_yueka)}else if(45==i){var k=e[1];o=t("mainui_controller"),l=t("mainui_const");o.getInstance().changeMainUIStatus(l.btn_index.main_scene,l.sub_type.wonderful,k)}else if(46==i){t("battle_drama_controller").getInstance().openDramaRewardWindow(!0)}}},__delete:function(){}});e.exports=s,cc._RF.pop()},{action_const:"action_const",action_controller:"action_controller",battle_const:"battle_const",battle_drama_controller:"battle_drama_controller",chat_const:"chat_const",chat_controller:"chat_controller",exchange_controller:"exchange_controller",forgehouse_const:"forgehouse_const",friend_const:"friend_const",friend_controller:"friend_controller",guild_controller:"guild_controller",guildskill_controller:"guildskill_controller",hero_controller:"hero_controller",mainui_const:"mainui_const",mainui_controller:"mainui_controller",mall_controller:"mall_controller",partnersummon_controller:"partnersummon_controller",redbag_controller:"redbag_controller",role_controller:"role_controller",stronger_controller:"stronger_controller",task_controller:"task_controller",vip_controller:"vip_controller",voyage_controller:"voyage_controller",welfare_const:"welfare_const",welfare_controller:"welfare_controller"}],ladder_award_item:[function(t,e,i){"use strict";cc._RF.push(e,"ceb35vn7VZDHaBEWrCDFXp4","ladder_award_item");var s=t("pathtool");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("ladder","ladder_award_item")},initConfig:function(){this.size=cc.size(608,124)},initPanel:function(){this.container=this.seekChild("container"),this.rank_label_lb=this.seekChild("rank_label",cc.Label),this.image=this.seekChild("image"),this.good_con=this.seekChild("good_con"),this.good_con_size=this.good_con.getContentSize()},registerEvent:function(){},onShow:function(t){},onHide:function(){},onDelete:function(){}});cc._RF.pop()},{pathtool:"pathtool"}],ladder_award_window:[function(t,e,i){"use strict";cc._RF.push(e,"4650ey0MFlH0brrxF4CZKih","ladder_award_window");var s=t("pathtool"),n=t("common_scrollview"),a=t("ladder_controller");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("ladder","ladder_award_window"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Big},initConfig:function(){this.ctrl=a.getInstance(),this.model=this.ctrl.getModel(),this.color_1=new cc.Color(169,95,15,255),this.color_2=new cc.Color(336,144,3,255)},openCallBack:function(){this.background=this.seekChild("background"),this.background.scale=FIT_SCALE,this.main_container=this.seekChild("main_container"),this.seekChild("win_title",cc.Label).string=Utils.TI18N("\u6392\u540d\u5956\u52b1"),this.seekChild("range_label",cc.Label).string=Utils.TI18N("\u540d\u6b21"),this.seekChild("reward_label",cc.Label).string=Utils.TI18N("\u5956\u52b1"),this.close_btn=this.seekChild("close_btn");var t=this.seekChild("my_rank");this.seekChild(t,"award_title",cc.Label).string=Utils.TI18N("\u4fdd\u6301\u6392\u540d\u53ef\u83b7\u5f97\u5956\u52b1:"),this.seekChild(t,"rank_title",cc.Label).string=Utils.TI18N("\u6211\u7684\u6392\u540d:"),this.rank_label_lb=this.seekChild(t,"rank_label",cc.Label),this.seekChild(t,"tips_label",cc.Label).string=Utils.TI18N("\u5956\u52b1\u5c06\u5728\u5468\u65e523:00\u901a\u8fc7\u90ae\u4ef6\u53d1\u653e"),this.good_con=this.seekChild("good_con"),this.item_list=this.seekChild(this.main_container,"item_list");var e=this.item_list.getContentSize(),i=cc.size(e.width,e.height-8),s={item_class:LadderAwardItem,start_x:0,space_x:0,start_y:0,space_y:0,item_width:600,item_height:124,row:0,col:1,need_dynamic:!0};this.award_scrollview=new n,this.award_scrollview.createScroll(this.item_list,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,i,s,cc.v2(.5,.5))},registerEvent:function(){Utils.onTouchEnd(this.close_btn,function(){this.ctrl.openLadderAwardWindow(!1)}.bind(this),2),Utils.onTouchEnd(this.background,function(){this.ctrl.openLadderAwardWindow(!1)}.bind(this),2)},openRootWnd:function(t){this.setData()},setData:function(){var t=Config.sky_ladder_data.data_award;if(t){var e=[];for(var i in t){var s=t[i],n=Utils.deepCopy(s);e.push(n)}e.sort(Utils.tableLowerSorter(["min"])),this.award_scrollview.setData(e);var a=this.model.getLadderMyBaseInfo();!a.rank||a.rank<=0?(this.rank_label_lb.string=Utils.TI18N("\u672a\u4e0a\u699c"),this.rank_label_lb.node.color=this.color_1):(this.rank_label_lb.string=a.rank,this.rank_label_lb.node.color=this.color_2);var o={};for(var l in o){var r=o[l];null!=a.rank&&a.rank>=r.min&&a.rank<=r.max&&(o=r.reward)}}},closeCallBack:function(){this.ctrl.openLadderAwardWindow(!1),this.award_scrollview&&(this.award_scrollview.deleteMe(),this.award_scrollview=null)}});cc._RF.pop()},{common_scrollview:"common_scrollview",ladder_controller:"ladder_controller",pathtool:"pathtool"}],ladder_battle_result_window:[function(t,e,i){"use strict";cc._RF.push(e,"9b4d3d8QspGtp3MclnASBFG","ladder_battle_result_window");var s=t("pathtool"),n=t("ladder_controller"),a=t("playerhead"),o=t("battle_controller"),l=t("role_controller"),r=t("battle_event");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("ladder","ladder_battle_result_window"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Tips},initConfig:function(){this.item_list={},this.ctrl=n.getInstance(),this.model=this.ctrl.getModel(),this.role_vo=l.getInstance().getRoleVo()},openCallBack:function(){this.background=this.seekChild("background"),this.background.scale=FIT_SCALE,this.container=this.seekChild("container"),this.seekChild(this.container,"get_title",cc.Label).string=Utils.TI18N("\u83b7\\n\u5f97\\n\u5956\\n\u52b1"),this.success_bg=this.seekChild(this.container,"success_bg"),this.fail_bg=this.seekChild(this.container,"fail_bg"),this.confirm_btn=this.seekChild(this.container,"confirm_btn"),this.time_lb=this.seekChild(this.container,"time_label",cc.Label),this.left_time=3,this.time_lb.string=Utils.TI18N("3\u79d2\u540e\u5173\u95ed"),this.harm_btn=this.seekChild(this.container,"harm_btn"),this.harm_btn.active=!1,this.top_head=new a,this.top_head.show(),this.top_head.setScale(.8),this.top_head.setPosition(153,377),this.top_head.setParent(this.top_head),this.top_name_lb=this.seekChild(this.container,"top_name",cc.Label),this.top_result_rt=this.seekChild(this.container,"top_result",cc.RichText),this.bottom_head=new a,this.bottom_head.show(),this.bottom_head.setScale(.8),this.bottom_head.setParent(this.container),this.bottom_name_lb=this.seekChild(this.container,"bottom_name",cc.Label),this.bottom_result_rt=this.seekChild(this.container,"bottom_result",cc.RichText),this.title_container=this.seekChild("title_container"),this.title_width=this.title_container.getContentSize().width,this.title_height=this.title_container.getContentSize().height},registerEvent:function(){Utils.onTouchEnd(this.background,function(){this.ctrl.openLadderBattleResultWindow(!1)}.bind(this),2),Utils.onTouchEnd(this.confirm_btn,function(){this.ctrl.openLadderBattleResultWindow(!1)}.bind(this),2),Utils.onTouchEnd(this.harm_btn,function(){this.data&&o.getInstance().openBattleHarmInfoView(!0,this.data)}.bind(this),1)},openRootWnd:function(t){Utils.playButtonSound("c_arenasettlement"),null!=t&&(this.data=t,this.setBaseInfo(),this.setRewardsList(),this.success_bg.active=1==t.result,this.fail_bg.active=2==t.result,this.handleEffect(!0),this.openCloseWindowTimer(!0),t.hurt_statistics&&(this.harm_btn.active=!0))},setBaseInfo:function(){if(null!=this.data){this.top_head.setHeadRes(this.role_vo.face_id),this.top_name_lb.string=this.role_vo.name,this.top_head.setLev(this.role_vo.lev),this.bottom_head.setHeadRes(this.data.def_face),this.bottom_name_lb.string=this.data.def_name,this.bottom_head.setLev(this.data.def_lev);var t="",e=s.getUIIconPath("common","common_1086"),i=s.getUIIconPath("common","common_1087"),n=this.data.atk_rank;n=n&&0!=n?String(n):Utils.TI18N("\u6682\u65e0"),0==this.data.atk_change_rank?t=cc.js.formatStr(Utils.TI18N("\u6392\u540d\uff1a%s"),n):this.data.atk_change_rank>0?(t+=cc.js.formatStr("\u6392\u540d:<color=#14ff32>%s</c><img src='%s'/>",n,e),1==this.data.is_change_best_rank&&(t+=cc.js.formatStr("    <img src='%s' />",s.getUIIconPath("ladder","txt_cn_ladder_highest")))):t=cc.js.formatStr(Utils.TI18N("\u6392\u540d:<color=#ff5050>%s</c><img src='%s'/>"),n,i),this.top_result_rt.string=t;var a="",o=this.data.def_rank;o=o&&0!=o?String(o):Utils.TI18N("\u6682\u65e0"),a=0==this.data.def_change_rank?cc.js.formatStr(Utils.TI18N("\u6392\u540d\uff1a%s"),o):this.data.def_change_rank>1?cc.js.formatStr(Utils.TI18N("\u6392\u540d:<color=#14ff32>%s</c><img src='%s'/>"),o,e):cc.js.formatStr(Utils.TI18N("\u6392\u540d:<color=#ff5050>%s</c><img src='%s'/>"),o,i),this.bottom_result_rt.string=a}},setRewardsList:function(){if(null!=this.data&&null!=this.data.reward&&null!=Utils.next(this.data.reward))this.data.reward.length},handleEffect:function(t){if(0==t)this.special_sk&&(this.special_sk.setToSetupPose(),this.special_sk.clearTracks());else{var e=103,i=PlayerAction.action_2;if(2==this.data.result&&(e=104,i=PlayerAction.action,this.title_container.y=912),this.special_sk){var n=cc.js.formatStr("spine/%s/action.atlas",s.getEffectRes(e));this.loadRes(n,function(t){this.special_sk.skeletonData=t,this.special_sk.setAnimation(1,i,!0)}.bind(this))}}},openCloseWindowTimer:function(t){t?null==this.close_timer&&(this.close_timer=gcore.Timer.set(function(){this.left_time=this.left_time-1,this.left_time>0?this.time_lb.string=cc.js.formatStr(Utils.TI18N("%s\u79d2\u540e\u5173\u95ed"),this.left_time):(gcore.Timer.del(this.close_timer),this.close_timer=null,this.ctrl.openLadderBattleResultWindow(!1))}.bind(this),1e3,-1)):null!=this.close_timer&&(gcore.Timer.del(this.close_timer),this.close_timer=null)},closeCallBack:function(){if(this.top_head&&(this.top_head.deleteMe(),this.top_head=null),this.bottom_head&&(this.bottom_head.deleteMe(),this.bottom_head=null),this.handleEffect(!1),this.openCloseWindowTimer(!1),this.item_list){for(var t in this.item_list){var e=this.item_list[t];e&&(e.deleteMe(),e=null)}this.item_list=null}gcore.GlobalEvent.fire(r.CLOSE_RESULT_VIEW),this.ctrl.openLadderBattleResultWindow(!1)}});cc._RF.pop()},{battle_controller:"battle_controller",battle_event:"battle_event",ladder_controller:"ladder_controller",pathtool:"pathtool",playerhead:"playerhead",role_controller:"role_controller"}],ladder_const:[function(t,e,i){"use strict";cc._RF.push(e,"867eaKrOABKILI7IXJLVK5j","ladder_const");var s={RedType:{TopThree:1,BattleLog:2,Challenge:3}};e.exports=s,cc._RF.pop()},{}],ladder_controller:[function(t,e,i){"use strict";cc._RF.push(e,"af0cdKpdsRCIILDfb8oxAqH","ladder_controller");var s=t("ladder_event"),n=t("battle_controller"),a=t("battle_const"),o=t("commonalert"),l=t("role_controller"),r=cc.Class({extends:BaseController,ctor:function(){},initConfig:function(){var e=t("ladder_model");this.model=new e,this.model.initConfig()},getModel:function(){return this.model},registerEvents:function(){},registerProtocals:function(){this.RegisterProtocal(24300,this.handle24300),this.RegisterProtocal(24301,this.handle24301),this.RegisterProtocal(24302,this.handle24302),this.RegisterProtocal(24303,this.handle24303),this.RegisterProtocal(24304,this.handle24304),this.RegisterProtocal(24305,this.handle24305),this.RegisterProtocal(24306,this.handle24306),this.RegisterProtocal(24307,this.handle24307),this.RegisterProtocal(24308,this.handle24308),this.RegisterProtocal(24309,this.handle24309),this.RegisterProtocal(24310,this.handle24310),this.RegisterProtocal(24311,this.handle24311),this.RegisterProtocal(24312,this.handle24312),this.RegisterProtocal(24313,this.handle24313),this.RegisterProtocal(24314,this.handle24314),this.RegisterProtocal(24315,this.handle24315),this.RegisterProtocal(24316,this.handle24316),this.RegisterProtocal(24317,this.handle24317),this.RegisterProtocal(24318,this.handle24318)},requestLadderMyBaseInfo:function(){this.SendProtocal(24300,{})},requestLadderEnemyListData:function(){this.SendProtocal(24301,{})},requestLadderEnemyData:function(t,e){var i={};i.rid=t,i.srv_id=e,this.SendProtocal(24302,i)},requestChallengeEnemy:function(t,e){var i={};i.rid=t,i.srv_id=e,this.SendProtocal(24303,i)},requestRefreshEnemyList:function(){this.SendProtocal(24304,{})},requestBuyChallengeCount:function(){this.SendProtocal(24305,{})},requestQuickChallenge:function(){this.SendProtocal(24306,{})},requestTopThreeRoleData:function(){this.SendProtocal(24308,{})},requestLadderRankData:function(){this.SendProtocal(24309,{})},requestMyLogData:function(){this.SendProtocal(24310,{})},requestGodLogData:function(){this.SendProtocal(24311,{})},requestLadderIsOpen:function(){this.SendProtocal(24312,{})},requestCleanCDTime:function(){this.SendProtocal(24315,{})},requestCheckRoleInfo:function(t,e,i){var s={};s.rid=t,s.srv_id=e,s.pos=i,this.SendProtocal(24316,s)},requestShareVideo:function(t,e,i,s){var n={};n.replay_id=t,n.srv_id=e,n.channel=i,n.target_name=s,this.SendProtocal(24316,n)},handle24300:function(t){t&&this.model.setLadderMyBaseInfo(t),gcore.GlobalEvent.fire(s.UpdateLadderMyBaseInfo)},handle24301:function(t){t&&(0==t.type?this.model.setLadderEnemyListData(t.f_list):this.model.updateLadderEnemyListData(t.f_list),gcore.GlobalEvent.fire(s.UpdateAllLadderEnemyList))},handle24302:function(t){t&&gcore.GlobalEvent.fire(s.GetLadderEnemyData,t)},handle24303:function(t){message(t.msg),this.openLadderRoleInfoWindow(!1)},handle24304:function(t){message(t.msg)},handle24305:function(t){message(t.msg),1==t.code&&null!=this._temp_rid&&null!=this._temp_srv_id?(this.requestChallengeEnemy(this._temp_rid,this._temp_srv_id),this._temp_rid=null,this._temp_srv_id=null):1==t.code&&this._temp_quick_flag&&(this.requestQuickChallenge(),this._temp_quick_flag=null)},handle24306:function(t){message(t.msg)},handle24307:function(t){n.getInstance().openFinishView(!0,a.Fight_Type.LadderWar,t)},handle24308:function(t){t&&t.rank_list&&gcore.GlobalEvent.fire(s.UpdateLadderTopThreeRoleData,t.rank_list)},handle24309:function(t){t&&gcore.GlobalEvent.fire(s.UpdateLadderRankData,t)},handle24310:function(t){t&&gcore.GlobalEvent.fire(s.UpdateLadderMyLogData,t)},handle24311:function(t){t&&gcore.GlobalEvent.fire(s.UpdateLadderGodLogData,t)},handle24312:function(t){t&&(this.model.setLadderOpenStatus(t.code),gcore.GlobalEvent.fire(s.UpdateLadderOpenStatus))},handle24313:function(t){null!=t.code&&(this._login_flag||1!=t.code?this.model.updateLadderRedStatus(LadderConst.RedType.TopThree,!1):(this._login_flag=!0,this.model.updateLadderRedStatus(LadderConst.RedType.TopThree,!0)))},handle24314:function(t){null!=t.code&&gcore.GlobalEvent.fire(LadderConst.RedType.BattleLog,1==t.code)},handle24315:function(t){message(t.msg)},handle24316:function(t){message(t.msg)},handle24317:function(t){null!=t.code&&gcore.GlobalEvent.fire(LadderConst.RedType.Challenge,1==t.code)},handle24318:function(t){message(t.msg)},checkJoinLadderBattle:function(t,e,i){if(this.model.getLeftChallengeCount()>0)i?this.requestQuickChallenge():this.requestChallengeEnemy(t,e);else if(this.model.getTodayLeftBuyCount()>0){var s=this.model.getTodayBuyCount(),n=Config.sky_ladder_data.data_buy_num[s+1];if(n)if(i){var a=PathTool.getItemRes(3),l=cc.js.formatStr(Utils.TI18N("\u6311\u6218\u6b21\u6570\u4e0d\u8db3\uff0c\u662f\u5426\u6d88\u8017<img src='%s'/>%d\u8d2d\u4e70\u4e00\u6b21\u6311\u6218\u6b21\u6570\u5e76\u4e14\u8fdb\u884c\u4e00\u952e\u6311\u6218\uff1f"),3,n.cost);o.show(l,Utils.TI18N("\u786e\u5b9a"),function(){this._temp_quick_flag=!0,this.requestBuyChallengeCount()}.bind(this),Utils.TI18N("\u53d6\u6d88"),null,2,null,{resArr:[a]})}else{var r=PathTool.getItemRes(3),c=string.format(TI18N("\u6311\u6218\u6b21\u6570\u4e0d\u8db3\uff0c\u662f\u5426\u6d88\u8017<img src='%s'/>%d\u8d2d\u4e70\u4e00\u6b21\u6311\u6218\u6b21\u6570\u5e76\u4e14\u8fdb\u5165\u6218\u6597\uff1f"),3,n.cost);o.show(c,Utils.TI18N("\u786e\u5b9a"),function(){this._temp_rid=t,this._temp_srv_id=e,this.requestBuyChallengeCount(),this.openLadderRoleInfoWindow(!1)}.bind(this),Utils.TI18N("\u53d6\u6d88"),null,2,null,{resArr:[r]})}}else message(Utils.TI18N("\u6311\u6218\u6b21\u6570\u4e0d\u8db3")),this.openLadderRoleInfoWindow(!1)},openMainWindow:function(t){if(t){var e=l.getInstance().getRoleVo(),i=Config.sky_ladder_data.data.const.join_min_lev;if(e.lev<i.val)return void message(i.desc);null==this.ladder_main_window&&(this.ladder_main_window=Utils.createClass("ladder_main_window")),this.ladder_main_window.open()}else this.ladder_main_window&&(this.ladder_main_window.close(),this.ladder_main_window=null)},openLadderShopWindow:function(t){t?(null==this.ladder_shop_window&&(this.ladder_shop_window=Utils.createClass("ladder_shop_window")),this.ladder_shop_window.open()):this.ladder_shop_window&&(this.ladder_shop_window.close(),this.ladder_shop_window=null)},openLadderRoleInfoWindow:function(t,e){t?(null==this.ladder_role_info_window&&(this.ladder_role_info_window=Utils.createClass("ladder_role_info_window")),this.ladder_role_info_window.open(e)):this.ladder_role_info_window&&(this.ladder_role_info_window.close(),this.ladder_role_info_window=null)},openLadderLogWindow:function(t){t?(null==this.ladder_log_window&&(this.ladder_log_window=Utils.createClass("ladder_log_window")),this.ladder_log_window.open()):this.ladder_log_window&&(this.ladder_log_window.close(),this.ladder_log_window=null)},openLadderAwardWindow:function(t){t?(null==this.ladder_award_window&&(this.ladder_award_window=Utils.createClass("ladder_award_window")),this.ladder_award_window.open()):this.ladder_award_window&&(this.ladder_award_window.close(),this.ladder_award_window=null)},openLadderRankWindow:function(t){t?(null==this.ladder_rank_window&&(this.ladder_rank_window=Utils.createClass("ladder_rank_window")),this.ladder_rank_window.open()):this.ladder_rank_window&&(this.ladder_rank_window.close(),this.ladder_rank_window=null)},openLadderTopThreeWindow:function(t){t?(null==this.ladder_top_three_window&&(this.ladder_top_three_window=Utils.createClass("ladder_top_three_window")),this.ladder_top_three_window.open()):this.ladder_top_three_window&&(this.ladder_top_three_window.close(),this.ladder_top_three_window=null)},openLadderBattleResultWindow:function(t,e){t?(null==this.ladder_result_window&&(this.ladder_result_window=Utils.createClass("ladder_battle_result_window")),this.ladder_result_window.open(e)):this.ladder_result_window&&(this.ladder_result_window.close(),this.ladder_result_window=null)}});e.exports=r,cc._RF.pop()},{battle_const:"battle_const",battle_controller:"battle_controller",commonalert:"commonalert",ladder_event:"ladder_event",ladder_model:"ladder_model",role_controller:"role_controller"}],ladder_event:[function(t,e,i){"use strict";cc._RF.push(e,"a2c48e+50VKyKtvCUIPjyAg","ladder_event"),e.exports={UpdateLadderMyBaseInfo:"UpdateLadderMyBaseInfo",UpdateAllLadderEnemyList:"UpdateAllLadderEnemyList",GetLadderEnemyData:"GetLadderEnemyData",UpdateLadderTopThreeRoleData:"UpdateLadderTopThreeRoleData",UpdateLadderRankData:"UpdateLadderRankData",UpdateLadderMyLogData:"UpdateLadderMyLogData",UpdateLadderGodLogData:"UpdateLadderGodLogData",UpdateLadderOpenStatus:"UpdateLadderOpenStatus",UpdateLadderRedStatus:"UpdateLadderRedStatus"},cc._RF.pop()},{}],ladder_god_log_item:[function(t,e,i){"use strict";cc._RF.push(e,"603671dokBHXocRsNE6d/aX","ladder_god_log_item");var s=t("pathtool"),n=t("playerhead"),a=t("battle_controller"),o=t("role_controller"),l=t("chat_controller"),r=t("timetool");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("ladder","ladder_god_log_item")},initConfig:function(){},initPanel:function(){this.container=this.seekChild("container"),this.time_lb=this.seekChild("time_label",cc.Label),this.rank_lb_1=this.seekChild("rank_label_1",cc.Label),this.name_lb_1=this.seekChild("name_label_1",cc.Label),this.rank_lb_2=this.seekChild("rank_label_2",cc.Label),this.name_lb_2=this.seekChild("name_label_2",cc.Label),this.btn_watch=this.seekChild("btn_watch"),this.role_head_1=new n,this.role_head_1.show(),this.role_head_1.setScale(.8),this.role_head_1.setPosition(60,88),this.role_head_1.setParent(this.container),this.role_head_1.addCallBack(function(){this._onClickRoleHead(1)}.bind(this)),this.role_head_2=new n,this.role_head_2.show(),this.role_head_2.setScale(.8),this.role_head_2.setPosition(480,88),this.role_head_2.setParent(this.container),this.role_head_2.addCallBack(function(){this._onClickRoleHead(2)}.bind(this))},registerEvent:function(){Utils.onTouchEnd(this.btn_watch,function(){this.data&&this.data.replay_id&&this.data.atk_srv_id&&a.getInstance().csRecordBattle(this.data.replay_id,this.data.atk_srv_id)}.bind(this),1)},setData:function(t){this.data=t,this.root_wnd&&this.onShow()},onShow:function(t){null!=this.data&&(data=this.data,this.time_lb.string=r.getYMDHMS(data.time||0),this.role_head_1.setHeadRes(data.atk_face),this.rank_label_1.string=cc.js.formatStr(Utils.TI18N("\u6392\u540d\uff1a%s"),data.atk_rank||0),this.name_lb_1.string=Utils.transformNameByServ(data.atk_name,data.atk_srv_id),this.role_head_2.setHeadRes(data.def_face),this.rank_label_2.string=cc.js.formatStr(Utils.TI18N("\u6392\u540d\uff1a%s"),data.def_rank||0),this.name_lb_2.string=Utils.transformNameByServ(data.def_name,data.def_srv_id),1==data.ret?(this.role_head_1.showBattleResultIcon(1),this.role_head_2.showBattleResultIcon(0)):(this.role_head_1.showBattleResultIcon(0),this.role_head_2.showBattleResultIcon(1)))},_onClickRoleHead:function(t){var e=o.getInstance().getRoleVo();if(this.data){var i="",s="";if(1==t?(i=this.data.atk_rid,s=this.data.atk_srv_id):2==t&&(i=this.data.def_rid,s=this.data.def_srv_id),i&&s)if("robot"==s)message(Utils.TI18N("\u795e\u79d8\u4eba\u592a\u9ad8\u51b7\uff0c\u4e0d\u7ed9\u67e5\u770b"));else if(e.rid==i&&e.srv_id==s)message(Utils.TI18N("\u4f60\u4e0d\u8ba4\u8bc6\u4f60\u81ea\u5df1\u4e86\u4e48\uff1f"));else{var n={rid:i,srv_id:s};l.getInstance().openFriendInfo(n,cc.v2(0,0))}}},setExtendData:function(t){this.replay_srv_id=t},onHide:function(){},onDelete:function(){this.role_head_1&&(this.role_head_1.deleteMe(),this.role_head_1=null),this.role_head_2&&(this.role_head_2.deleteMe(),this.role_head_2=null)}});cc._RF.pop()},{battle_controller:"battle_controller",chat_controller:"chat_controller",pathtool:"pathtool",playerhead:"playerhead",role_controller:"role_controller",timetool:"timetool"}],ladder_log_window:[function(t,e,i){"use strict";cc._RF.push(e,"47272aCneFEl4gtkzbpdD9W","ladder_log_window");var s=t("pathtool"),n=t("common_scrollview"),a=t("ladder_controller"),o=t("ladder_god_log_item"),l=t("ladder_my_log_item"),r=t("role_controller"),c=t("chat_const"),_=t("ladder_event");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("ladder","ladder_log_window"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Big},initConfig:function(){this.tab_list={},this.color=new cc.Color(245,224,185,255),this.color_1=new cc.Color(245,224,185,255),this.color_2=new cc.Color(105,55,5,255),this.ctrl=a.getInstance(),this.model=this.ctrl.getModel()},openCallBack:function(){this.background=this.seekChild("background"),this.background.scale=FIT_SCALE;var t=this.seekChild("container");this.seekChild("win_title").string=Utils.TI18N("\u6218 \u62a5"),this.title_bg=this.seekChild("title_bg"),this.seekChild(this.title_bg,"title_bg",cc.Label).string=Utils.TI18N("\u5bf9\u624b"),this.seekChild(this.title_bg,"more_title",cc.Label).string=Utils.TI18N("\u8be6\u7ec6"),this.share_panel=this.seekChild("share_panel"),this.share_panel.active=!1;var e=this.seekChild("share_bg");this.share_bg=e,this.btn_guild=this.seekChild(e,"btn_guild"),this.btn_world=this.seekChild(e,"btn_world"),this.btn_cross=this.seekChild(e,"btn_cross"),this.seekChild(e,"guild_label",cc.Label).string=Utils.TI18N("\u516c\u4f1a\u9891\u9053"),this.seekChild(e,"world_label",cc.Label).string=Utils.TI18N("\u4e16\u754c\u9891\u9053"),this.seekChild(e,"cross_label",cc.Label).string=Utils.TI18N("\u8de8\u670d\u9891\u9053");for(var i=this.seekChild(t,"tab_container"),s=1;s<=2;s++){var a={},r=this.seekChild(i,"tab_btn_"+s);if(r){var c=r.getChildByName("title").getComponent(cc.Label);1==s?c.string=Utils.TI18N("\u6211\u7684\u8bb0\u5f55"):2==s&&(c.string=Utils.TI18N("\u5927\u795e\u98ce\u91c7")),c.node.color=this.color;var _=r.getChildByName("tips");a.tab_btn=r,a.tab_btn_sp=r.getComponent(cc.Sprite),a.label=c,a.index=s,a.tips=_,this.tab_list[s]=a}}this.close_btn=this.seekChild("close_btn"),this.confirm_btn=this.seekChild("confirm_btn"),this.no_log_label=this.seekChild("no_log_label",cc.Label),this.no_log_image=this.seekChild("no_log_image"),this.my_log_panel=this.seekChild("my_log_panel"),this.god_log_panel=this.seekChild("god_log_panel"),this.no_log_label.string=Utils.TI18N("\u6682\u65e0\u6218\u62a5");var h=this.my_log_panel.getContentSize(),d=cc.size(h.width,h.height-8),u={item_class:l,start_x:0,space_x:0,start_y:-5,space_y:-5,item_width:612,item_height:135,row:0,col:1,need_dynamic:!0};this.my_log_scrollview=new n,this.my_log_scrollview.createScroll(this.my_log_panel,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,d,u,cc.v2(.5,.5));h=this.my_log_panel.getContentSize(),d=cc.size(h.width,h.height-8),u={item_class:o,start_x:0,space_x:0,start_y:-5,space_y:-5,item_width:612,item_height:153,row:0,col:1,need_dynamic:!0};this.god_log_scrollview=new n,this.god_log_scrollview.createScroll(this.my_log_panel,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,d,u,cc.v2(.5,.5))},registerEvent:function(){var t=this;Utils.onTouchEnd(this.close_btn,function(){this.ctrl.openLadderLogWindow(!1)}.bind(this),2),Utils.onTouchEnd(this.background,function(){this.ctrl.openLadderLogWindow(!1)}.bind(this),2),Utils.onTouchEnd(this.share_panel,function(){this.share_panel.active=!1}.bind(this),1),Utils.onTouchEnd(this.btn_world,function(){null!=this.replay_id&&this.def_name&&null!=this.share_srv_id&&this.ctrl.requestShareVideo(this.replay_id,this.share_srv_id,c.Channel.World,this.def_name),this.share_panel.active=!1}.bind(this),1),Utils.onTouchEnd(this.btn_guild,function(){var t=r.getInstance().getRoleVo();t&&0!=t.gid&&""!=t.gsrv_id?null!=this.replay_id&&this.def_name&&null!=this.share_srv_id&&this.ctrl.requestShareVideo(this.replay_id,this.share_srv_id,c.Channel.Gang,this.def_name):message(Utils.TI18N("\u6682\u65e0\u516c\u4f1a"))}.bind(this),1),Utils.onTouchEnd(this.btn_cross,function(){null!=this.replay_id&&this.def_name&&null!=this.share_srv_id&&this.ctrl.requestShareVideo(this.replay_id,this.share_srv_id,c.Channel.Gang,this.def_name),this.share_panel.active=!1}.bind(this),1);var e=function(e){var i=t.tab_list[e];i.tab_btn&&i.tab_btn.on(cc.Node.EventType.TOUCH_END,function(){Utils.playButtonSound(1),this.changeSelectedTab(i.index)},t)};for(var i in this.tab_list)e(i);this.addGlobalEvent(_.UpdateLadderMyLogData,function(t){this.my_log_replay_srv_id=t.replay_srv_id,t.log_list&&this.setMyLogData(t.log_list)},this),this.addGlobalEvent(_.UpdateLadderGodLogData,function(t){this.god_log_replay_srv_id=t.replay_srv_id,t.log_list&&this.setGodLogData(t.log_list)},this)},openRootWnd:function(t){t=t||1,this.changeSelectedTab(t)},changeSelectedTab:function(t){null!=this.tab_object&&this.tab_object.index==t||(this.tab_object&&(this.loadRes(s.getUIIconPath("common","common_2023"),function(t){this.tab_object.tab_btn_sp.spriteFrame=t}.bind(this)),this.tab_object.label.node.color=this.color_1,this.tab_object=null),this.tab_object=this.tab_list[t],this.tab_object&&(this.loadRes(s.getUIIconPath("common","common_2021"),function(t){this.tab_object.tab_btn_sp.spriteFrame=t}.bind(this)),this.tab_object.label.node.color=this.color_2),this.__ctor__.title_bg.active=1==t,this.my_log_scrollview.setRootVisible(1==t),this.god_log_scrollview.setRootVisible(2==t),null!=(1==t&&this.myLogData&&Utils.next(this.myLogData))||2==t&&this.godLogData&&null!=Utils.next(this.godLogData)?(this.no_log_image.active=!1,this.no_log_label.node.active=!1):(this.no_log_image.active=!0,this.no_log_label.node.active=!0),1!=t||this.init_my_log?2!=t||this.init_god_log||(this.ctrl.requestGodLogData(),this.init_god_log=!0):(this.ctrl.requestMyLogData(),this.init_my_log=!0))},setMyLogData:function(t){if(null!=this.tab_object&&1==this.tab_object.index)if(this.myLogData=t,t&&null!=Utils.next(t)){this.my_log_scrollview.setRootVisible(!0),this.no_log_image.active=!1,this.no_log_label.node.active=!1;var e={};e.callback=function(t,e,i,s){this.replay_id=e,this.def_name=i,this.share_srv_id=s;var n=this.share_panel.convertToNodeSpaceAR(t);n&&(this.share_bg.setPosition(cc.v2(n.x-32,n.y+70)),this.share_panel.active=!0)}.bind(this),e.replay_srv_id=this.my_log_replay_srv_id,this.my_log_scrollview.setData(t,null,e)}else this.my_log_scrollview.setRootVisible(!1),this.no_log_image.active=!0,this.no_log_label.active=!0},setGodLogData:function(t){null!=this.tab_object&&2==this.tab_object.index&&(this.godLogData=t,t&&null!=Utils.next(t)?(this.god_log_scrollview.setRootVisible(!0),this.no_log_image.active=!1,this.no_log_label.active=!1,this.god_log_scrollview.setData(t,null,this.god_log_replay_srv_id)):(this.god_log_scrollview.setRootVisible(!1),this.no_log_image.active=!0,this.no_log_label.active=!0))},closeCallBack:function(){this.model.updateLadderRedStatus(LadderConst.RedType.BattleLog,!1),this.my_log_scrollview&&(this.my_log_scrollview.deleteMe(),this.my_log_scrollview=null),this.god_log_scrollview&&(this.god_log_scrollview.deleteMe(),this.god_log_scrollview=null),this.ctrl.openLadderLogWindow(!1)}});cc._RF.pop()},{chat_const:"chat_const",common_scrollview:"common_scrollview",ladder_controller:"ladder_controller",ladder_event:"ladder_event",ladder_god_log_item:"ladder_god_log_item",ladder_my_log_item:"ladder_my_log_item",pathtool:"pathtool",role_controller:"role_controller"}],ladder_main_window:[function(t,e,i){"use strict";cc._RF.push(e,"e7e11Sjh5FGaaMKEg8kuLGU","ladder_main_window");var s=t("pathtool"),n=t("role_controller"),a=t("ladder_controller"),o=t("ladder_role_item"),l=t("timetool"),r=t("mainui_controller"),c=t("commonalert"),_=t("ladder_const"),h=t("ladder_event");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("ladder","ladder_main_window")},initConfig:function(){this.role_vo=n.getInstance().getRoleVo(),this.role_panels={},this.role_items={},this.ctrl=a.getInstance(),this.model=this.ctrl.getModel(),this.white_color=new cc.Color(255,255,255,255),this.color_1=new cc.Color(71,132,37,255)},openCallBack:function(){var t=this.seekChild("background");t.scale=FIT_SCALE,this.loadRes(s.getBigBg("bigbg_58"),function(e){t.getComponent(cc.Sprite).spriteFrame=e}.bind(this)),this.main_container=this.seekChild("main_container"),this.top_panel=this.seekChild(this.main_container,"top_panel"),this.seekChild(this.top_panel,"win_title",cc.Label).string=Utils.TI18N("\u5929\u68af\u4e89\u9738"),this.btn_rule=this.seekChild(this.top_panel,"btn_rule"),this.btn_role=this.seekChild(this.top_panel,"btn_role"),this.btn_log=this.seekChild(this.top_panel,"btn_log"),this.btn_rank=this.seekChild(this.top_panel,"btn_rank"),this.btn_award=this.seekChild(this.top_panel,"btn_award"),this.btn_shop=this.seekChild(this.top_panel,"btn_shop"),this.bottom_panel=this.seekChild(this.main_container,"bottom_panel");this.seekChild(this.bottom_panel,"black_bg");this.seekChild(this.bottom_panel,"count_title",cc.Label).string=Utils.TI18N("\u6311\u6218\u6b21\u6570:"),this.count_label_lb=this.seekChild(this.bottom_panel,"count_label",cc.Label),this.seekChild(this.main_container,"tips_label",cc.Label).string=Utils.TI18N("\u5feb\u901f\u6311\u6218\u6392\u540d\u4e0d\u53d8"),this.time_title_lb=this.seekChild(this.bottom_panel,"time_title",cc.Label),this.time_title_lb.string=Utils.TI18N("\u8ddd\u79bb\u7ed3\u675f\uff1a"),this.time_label_lb=this.seekChild(this.bottom_panel,"time_label",cc.Label);var e=this.seekChild(this.main_container,"score_bg");this.score_label_lb=this.seekChild(e,"score_label",cc.Label),this.score_label_lb.string=this.role_vo.sky_coin;var i=this.seekChild(this.main_container,"rank_bg");this.seekChild(i,"rank_title",cc.Label).string=Utils.TI18N("\u6392\u540d:"),this.rank_label_lb=this.seekChild(i,"rank_label",cc.Label),this.close_btn=this.seekChild(this.main_container,"close_btn"),this.refresh_btn=this.seekChild(this.main_container,"refresh_btn"),this.refresh_btn._can_touch=!0,this.refresh_btn_label_lb=this.seekChild(this.refresh_btn,"label",cc.Label),this.refresh_btn_label_lo=this.seekChild(this.refresh_btn,"label",cc.LabelOutline),this.refresh_btn_label_lb.string=Utils.TI18N("\u5237\u65b0"),this.challenge_btn=this.seekChild(this.main_container,"challenge_btn"),this.challenge_btn_label_lb=this.seekChild(this.challenge_btn,"label",cc.Label),this.challenge_btn_label_lb.string=Utils.TI18N("\u4e00\u952e\u6311\u6218"),this.add_btn=this.seekChild(this.bottom_panel,"add_btn");for(var n=1;n<=5;n++){var a=this.seekChild(this.main_container,"role_pos_"+n);this.role_panels[n]=a}this.role_panel_size=this.role_panels[1].getContentSize()},registerEvent:function(){Utils.onTouchEnd(this.close_btn,function(){this.ctrl.openMainWindow(!1)}.bind(this),1),Utils.onTouchEnd(this.btn_rule,function(){r.getInstance().openCommonExplainView(!0,Config.sky_ladder_data.data_explain)}.bind(this),1),Utils.onTouchEnd(this.btn_role,function(){this.ctrl.openLadderTopThreeWindow(!0)}.bind(this),1),Utils.onTouchEnd(this.btn_log,function(){this.ctrl.openLadderLogWindow(!0)}.bind(this),1),Utils.onTouchEnd(this.btn_rank,function(){this.ctrl.openLadderRankWindow(!0)}.bind(this),1),Utils.onTouchEnd(this.btn_award,function(){this.ctrl.openLadderAwardWindow(!0)}.bind(this),1),Utils.onTouchEnd(this.btn_shop,function(){this.ctrl.openLadderShopWindow(!0)}.bind(this),1),Utils.onTouchEnd(this.add_btn,function(){if(!this.model.getLadderIsOpen()){var t=Config.sky_ladder_data.data_const.close_text;t&&message(cc.js.formatStr(Utils.TI18N("\u6bcf%s\u5929\u68af\u4e89\u9738"),t.desc))}if(this.myBaseInfo){var e=this.myBaseInfo.buy_combat_num||0,i=Config.sky_ladder_data.data_buy_num[e+1];if(i)if(this.role_vo.vip_lev>=i.vip){var n=s.getItemRes(Config.ItemData.data_assets_label2id.gold),a=cc.js.formatStr(Utils.TI18N("\u786e\u5b9a\u6d88\u8017<img src='%s'/>%s\u589e\u52a0\u4e00\u6b21\u6311\u6218\u6b21\u6570\u5417\uff1f"),Config.ItemData.data_assets_label2id.gold,i.cost);c.show(a,Utils.TI18N("\u786e\u5b9a"),function(){this.ctrl.requestBuyChallengeCount()}.bind(this),Utils.TI18N("\u53d6\u6d88"),null,2,null,{resArr:[n]})}else message(Utils.TI18N("\u63d0\u5347VIP\u7b49\u7ea7\u53ef\u589e\u52a0\u8d2d\u4e70\u6b21\u6570"));else message(Utils.TI18N("\u5f53\u524d\u5df2\u7ecf\u8d2d\u4e70\u8fbe\u5230\u4e0a\u9650"))}}.bind(this),1),Utils.onTouchEnd(this.refresh_btn,function(){if(this.model.getLadderIsOpen())this.ctrl.requestRefreshEnemyList();else{var t=Config.sky_ladder_data.data_const.clost_text;t&&message(cc.js.formatStr(Utils.TI18N("\u6bcf%s\u5929\u68af\u4e89\u9738"),t.desc))}}.bind(this),1),Utils.onTouchEnd(this.challenge_btn,function(){if(this.model.getLadderIsOpen()){var t=function(){this.ctrl.checkJoinLadderBattle(null,null,!0)}.bind(this),e=Utils.TI18N("\u4e00\u952e\u6311\u6218\u5c06\u76f4\u63a5\u83b7\u5f97\u5956\u52b1\uff0c\u662f\u5426\u7ee7\u7eed\uff1f\n\n\n                          <size=22>(\u6d88\u8017\u4e00\u6b21\u6311\u6218\u6b21\u6570)</size>");c.show(e,Utils.TI18N("\u786e\u5b9a"),t,Utils.TI18N("\u53d6\u6d88"),null,2,null)}else{var i=Config.sky_ladder_data.data_const.close_text;i&&message(cc.js.formatStr(Utils.TI18N("\u6bcf%s\u5929\u68af\u4e89\u9738"),i.desc))}}.bind(this),1),this.addGlobalEvent(h.UpdateLadderMyBaseInfo,function(){this.refreshMyBaseInfo()},this),this.addGlobalEvent(h.UpdateAllLadderEnemyList,function(){this.refreshRoleList()},this),null!=this.role_vo&&null==this.role_assets_event&&(this.role_assets_event=this.role_vo.bind(EventId.UPDATE_ROLE_ATTRIBUTE,function(t,e){"sky_coin"==t&&(this.score_label_lb.string=e)}.bind(this))),this.addGlobalEvent(h.UpdateLadderOpenStatus,function(){this.refreshMyBaseInfo()},this),this.addGlobalEvent(h.UpdateLadderRedStatus,function(){this.refrehsBtnRedStatus(bid,status)},this)},openRootWnd:function(t){this.ctrl.requestLadderMyBaseInfo(),this.ctrl.requestLadderEnemyListData(),this.refrehsBtnRedStatus()},refreshRoleList:function(){var t=this.model.getLadderEnemyListData();cc.log("enemy_datas==",t);this.list_index=1,this.startUpdate(5,function(){var e=this.list_index,i=this.role_items[e];if(!i){i=new o;var s=this.role_panels[e];i.setPosition(cc.v2(this.role_panel_size.width/2,this.role_panel_size.height-140)),i.setParent(s),this.role_items[e]=i}var n=t[e];n&&null!=Utils.next(n)?(i.setData(n),i.setVisible(!0)):i.setVisible(!1),this.list_index+=1}.bind(this),200)},refreshMyBaseInfo:function(){this.myBaseInfo=this.model.getLadderMyBaseInfo();var t=this.model.getLadderIsOpen();this.count_label_lb.string=this.myBaseInfo.can_combat_num||0,this.left_buy_count||(this.left_buy_count=Utils.createRichLabel(20,this.white_color,cc.v2(.5,.5),cc.v2(590,10)),this.left_buy_count.setParent(this.bottom_panel));var e=this.model.getTodayLeftBuyCount();this.left_buy_count.string=cc.js.formatStr(Utils.TI18N("<color=#fff8bf><outline=2 color=#000000>(\u5269\u4f59\u8d2d\u4e70\u6b21\u6570:</outline></c><color=#39e522><outline=2 color=#000000>%d</outline></c><color=#fff8bf><outline=2 color=#000000>)</outline></c>",e)),t&&this.myBaseInfo.rank&&0!=this.myBaseInfo.rank?this.rank_label_lb.string=this.myBaseInfo.rank:this.rank_label_lb.string=Utils.TI18N("\u6682\u65e0"),this.ref_time=this.myBaseInfo.ref_time||0,this.combat_time=this.myBaseInfo.combat_time||0;var i=gcore.SmartSocket.getTime(),s=this.combat_time-i;if(s<0&&(s=0),t)this.time_label_lb.node.active=!0,this.time_title_lb.node.active=!0,this.time_label_lb.string=l.getTimeFormat(s),this.join_text&&(this.join_text.node.active=!1),this.openLadderTimer(!0);else{this.time_label_lb.node.active=!1,this.time_title_lb.node.active=!1,this.join_text||(this.join_text=Utils.createRichLabel(22,this.white_color,cc.v2(.5,.5),cc.v2(346,38.5)),this.join_text.setParent(this.bottom_panel)),this.join_text.node.active=!0;var n=Config.sky_ladder_data.data_const.arena_rank;n&&(this.join_text.string=cc.js.formatStr(Utils.TI18N("color=#fff8bf><outline=2 color=#000000>\u53c2\u8d5b\u6761\u4ef6:\u7ade\u6280\u573a\u6392\u540d\u524d</outline></c>color=#39e522><outline=2 color=#000000>%d</outline></c>color=#fff8bf><outline=2 color=#000000>\u540d</outline></c>",n.val)))}var a=this.ref_time-i;a<=0&&0==this.refresh_btn._can_touch?(this.refresh_btn._can_touch=!0,this.refresh_btn_label_lb.string=Utils.TI18N("\u5237\u65b0"),this.refresh_btn_label_lo.enabled=!0):a>0&&1==this.refresh_btn._can_touch&&(this.refresh_btn._can_touch=!1,this.refresh_btn_label_lb.string=cc.js.formatStr(Utils.TI18N("%s\u79d2"),a),this.refresh_btn_label_lo.enabled=!1)},openLadderTimer:function(t){1==t?null==this.ladder_timer&&(this.ladder_timer=gcore.Timer.set(function(){var t=gcore.SmartSocket.getTime(),e=this.combat_time-t,i=this.ref_time-t;e<=0&&i<=0&&(gcore.Timer.del(this.ladder_timer),this.ladder_timer=null),e<0&&(e=0),e<=0?(this.time_label_lb.node.active=!1,this.time_title_lb.node.active=!1,this.join_text&&(this.join_text.node.active=!0)):(this.time_label_lb.node.active=!0,this.time_title_lb.node.active=!0,this.time_label_lb.string=l.getTimeFormat(e)),i<=0?(0==this.refresh_btn._can_touch&&(this.refresh_btn._can_touch=!0),this.refresh_btn_label_lb.string=Utils.TI18N("\u5237\u65b0")):i>0&&(1==this.refresh_btn._can_touch&&(this.refresh_btn._can_touch=!1,this.refresh_btn_label_lo.enabled=!1),this.refresh_btn_label_lb.string=cc.js.formatStr(Utils.TI18N("%s\u79d2"),i))}.bind(this),1e3,1)):null!=this.ladder_timer&&(gcore.Timer.del(this.ladder_timer),this.ladder_timer=null)},refrehsBtnRedStatus:function(t,e){if(t==_.RedType.TopThree)Utils.addRedPointToNodeByStatus(this.btn_role,e);else if(t==_.RedType.BattleLog)Utils.addRedPointToNodeByStatus(this.btn_log,e);else{var i=this.model.checkRedIsShowByRedType(_.RedType.TopThree);Utils.addRedPointToNodeByStatus(this.btn_role,i);var s=this.model.checkRedIsShowByRedType(_.RedType.BattleLog);Utils.addRedPointToNodeByStatus(this.btn_log,s)}},closeCallBack:function(){for(var t in this.role_vo&&(this.role_assets_event&&(this.role_vo.unbind(this.role_assets_event),this.role_assets_event=null),this.role_vo=null),this.role_items){var e=this.role_items[t];e&&(e.deleteMe(),e=null)}this.role_items=null,this.openLadderTimer(!1),this.ctrl.openMainWindow(!1)}});cc._RF.pop()},{commonalert:"commonalert",ladder_const:"ladder_const",ladder_controller:"ladder_controller",ladder_event:"ladder_event",ladder_role_item:"ladder_role_item",mainui_controller:"mainui_controller",pathtool:"pathtool",role_controller:"role_controller",timetool:"timetool"}],ladder_model:[function(t,e,i){"use strict";cc._RF.push(e,"50728I/mu9Dq5gNFyfCbUPi","ladder_model");var s=t("role_controller"),n=t("mainscene_controller"),a=t("scene_const"),o=t("ladder_event");cc.Class({extends:BaseClass,ctor:function(){},properties:{},initConfig:function(){this.myBaseInfo={},this.enemyListData=[],this.ladderOpenStatus=0,this.guildwar_red_list={}},setLadderMyBaseInfo:function(t){this.myBaseInfo=t},getLadderMyBaseInfo:function(){return this.myBaseInfo},getLeftChallengeCount:function(){return this.myBaseInfo&&this.myBaseInfo.can_combat_num||0},getTodayBuyCount:function(){return this.myBaseInfo&&this.myBaseInfo.buy_combat_num||0},getTodayLeftBuyCount:function(){var t=s.getInstance().getRoleVo(),e=this.myBaseInfo.buy_combat_num||0,i=0;for(var n in Config.sky_ladder_data.data_buy_num){Config.sky_ladder_data.data_buy_num[n].vip<=t.vip_lev&&(i+=1)}var a=i-e;return a<0&&(a=0),a},setLadderEnemyListData:function(t){this.enemyListData=t||{}},updateLadderEnemyListData:function(t){for(var e in t=t||{}){var i=t[e];for(var s in this.enemyListData){var n=this.enemyListData[s];if(i.idx==n.idx){for(var a in i)n[a]=i[a];break}}}},getLadderEnemyListData:function(){return this.enemyListData},getLadderEnemyDataByIndex:function(t){var e={};for(var i in this.enemyListData){var s=this.enemyListData[i];if(s.idx==t){e=s;break}}return e},setLadderOpenStatus:function(t){this.ladderOpenStatus=t},getLadderIsOpen:function(){return this.ladderOpenStatus&&1==this.ladderOpenStatus},getLadderOpenStatus:function(t){t=t||!1;var e=s.getInstance().getRoleVo(),i=i.sky_ladder_data.data_const.join_min_lev;return i&&i.val<=e.lev?{bool:!1}:(t||message(i.desc),{bool:!1,desc:i.desc})},updateLadderRedStatus:function(t,e){RedMgr.getInstance().addCalHandler(function(){if(this.guildwar_red_list[t]!=e){this.guildwar_red_list[t]=e;var i=this.checkLadderRedStatus();n.getInstance().setBuildRedStatus(a.CenterSceneBuild.ladder,{bid:CrossgroundConst.Red_Type.ladder,status:i}),gcore.GlobalEvent.fire(o.UpdateLadderRedStatus,t,e)}}.bind(this),RedIds.Ladder)},checkRedIsShowByRedType:function(t){return this.guildwar_red_list[t]||!1},checkLadderRedStatus:function(){for(var t in this.guildwar_red_list){if(1==this.guildwar_red_list[t])return!0}return!1}});cc._RF.pop()},{ladder_event:"ladder_event",mainscene_controller:"mainscene_controller",role_controller:"role_controller",scene_const:"scene_const"}],ladder_my_log_item:[function(t,e,i){"use strict";cc._RF.push(e,"06c27QUBw5DyrE7nlemnzWn","ladder_my_log_item");var s=t("pathtool"),n=t("playerhead"),a=t("chat_controller"),o=t("role_controller"),l=t("battle_controller"),r=t("timetool");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("ladder","ladder_my_log_item")},initConfig:function(){this.color_1=new cc.Color(36,144,3,255),this.color_2=new cc.Color(217,80,20,255)},initPanel:function(){this.container=this.seekChild("container"),this.attk_lb=this.seekChild("attk_label",cc.Label),this.name_lb=this.seekChild("name_label",cc.Label),this.defend_lb=this.seekChild("defend_label",cc.Label),this.time_lb=this.seekChild("time_label",cc.Label),this.btn_share=this.seekChild("btn_share"),this.btn_watch=this.seekChild("btn_watch"),this.rank_lb=this.seekChild("rank_lb",cc.RichText),this.my_head=new n,this.my_head.setScale(.7),this.my_head.setPosition(60,85),this.my_head.show(),this.my_head.setParent(this.container),this.my_head.addCallBack(function(){if(this.data)if("robot"==this.data.srv_id)message(Utils.TI18N("\u795e\u79d8\u4eba\u592a\u9ad8\u51b7\uff0c\u4e0d\u7ed9\u67e5\u770b"));else{var t={rid:this.data.rid,srv_id:this.data.srv_id};a.getInstance().openFriendInfo(t,cc.v2(0,0))}}.bind(this))},registerEvent:function(){Utils.onTouchEnd(this.btn_share,function(){if(this._onShareCallBack&&this.data){var t=this.data.srv_id;if(1==this.data.type)t=o.getInstance().getRoleVo().srv_id;this._onShareCallBack(world_pos,this.data.replay_id,this.data.name,t)}}.bind(this),1),Utils.onTouchEnd(this.btn_share,function(){if(this.data&&null!=this.replay_srv_id){var t=this.replay_srv_id;2==this.data.type&&(t=this.data.srv_id),l.getInstance().csRecordBattle(this.data.replay_id,t)}}.bind(this),1)},setData:function(t){this.data=t,this.root_wnd&&this.onShow()},onShow:function(t){if(null!=this.data){var e=this.data;this.my_head.setHeadRes(e.face),this.attk_lb.string=e.power||0,this.name_lb.string=Utils.transformNameByServ(e.name,e.srv_id);var i=r.getYMDHMS(e.time);i=i.substring(2),this.time_lb.string=i,1==e.type&&1==e.ret?(this.defend_lb.node.color=this.color_1,this.defend_lb.string=Utils.TI18N("\u8fdb\u653b\u6210\u529f")):1==e.type&&2==e.ret?(this.defend_lb.node.color=this.color_2,this.defend_lb.string=Utils.TI18N("\u8fdb\u653b\u5931\u8d25")):2==e.type&&1==e.ret?(this.defend_lb.node.color=this.color_1,this.defend_lb.string=Utils.TI18N("\u9632\u5b88\u6210\u529f")):2==e.type&&2==e.ret&&(this.defend_lb.node.color=this.color_2,this.defend_lb.string=Utils.TI18N("\u9632\u5b88\u5931\u8d25")),0==e.rank_type?this.rank_lb.string=Utils.TI18N("\u6392\u540d\u4fdd\u6301\u4e0d\u53d8"):1==e.rank_type?this.rank_lb.string=cc.js.formatStr(Utils.TI18N("\u6392\u540d\u5347\u81f3<color=#249003>%d</c>\u540d"),e.rank||0):2==e.rank_type&&(!e.rank||e.rank<=0?this.rank_lb.string=Utils.TI18N("\u6392\u540d\u964d\u81f3<color=#D95014>1000\u540d\u5916</c>"):this.rank_lb.string=cc.js.formatStr(Utils.TI18N("\u6392\u540d\u964d\u81f3<color=#D95014>%d</c>\u540d"),e.rank||0))}},setExtendData:function(t){this._onShareCallBack=t.callback,this.replay_srv_id=t.replay_srv_id},onHide:function(){},onDelete:function(){this.my_head&&(this.my_head.deleteMe(),this.my_head=null)}});cc._RF.pop()},{battle_controller:"battle_controller",chat_controller:"chat_controller",pathtool:"pathtool",playerhead:"playerhead",role_controller:"role_controller",timetool:"timetool"}],ladder_rank_window:[function(t,e,i){"use strict";cc._RF.push(e,"b87eeQcmM5AvYJNW92A50p4","ladder_rank_window");var s=t("playerhead"),n=(t("common_scrollview"),t("ladder_controller")),a=t("pathtool");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=a.getPrefabPath("ladder","ladder_rank_window"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Big},initConfig:function(){this.ctrl=n.getInstance(),this.model=this.ctrl.getModel()},openCallBack:function(){this.background=this.seekChild("background"),this.background.scale=FIT_SCALE,this.main_panel=this.seekChild("main_container"),this.close_btn=this.seekChild("close_btn");var t=this.seekChild("title_con");this.seekChild(t,"title_label",cc.Label).string=Utils.TI18N("\u6392\u884c\u699c"),this.no_log_image_nd=this.seekChild(this.main_panel,"no_log_image"),this.no_log_image_nd.active=!1,this.rank_panel=this.seekChild("rank_panel"),this.my_rank=this.seekChild(this.main_panel,"my_rank"),this.seekChild(this.my_rank,"title",cc.Label).string=Utils.TI18N("\u6211\u7684\u6392\u540d"),this.no_rank_label_nd=this.seekChild(this.my_rank,"no_rank_label"),this.no_rank_label_nd.active=!1,this.my_rank_id_nd=this.seekChild(this.my_rank,"rank_id"),this.my_name_lb=this.seekChild(this.my_rank,"my_name_label",cc.Label),this.my_attk_lb=this.seekChild(this.my_rank,"my_attk_label",cc.Label),this.my_guild_lb=this.seekChild(this.my_rank,"my_guild_label",cc.Label),this.best_rank_lb=this.seekChild(this.my_rank,"best_rank_label",cc.Label),this.my_head=new s,this.my_head.setScale(.8),this.my_head.setPosition(150,66),this.my_head.setParent(this.my_rank),this.my_head.show();var e=this.rank_panel.getContentSize(),i=cc.size(e.width,e.height-4),n={item_class:LadderRankItem,start_x:5,space_x:0,start_y:0,space_y:0,item_width:612,item_height:112,row:0,col:1,need_dynamic:!0};this.order_scrollview=new CommonScrollView,this.order_scrollview.createScroll(this.rank_panel,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,i,n,cc.v2(.5,.5))},registerEvent:function(){Utils.onTouchEnd(this.close_btn,function(){this.ctrl.openLadderRankWindow(!1)}.bind(this),2),Utils.onTouchEnd(this.background,function(){this.ctrl.openLadderRankWindow(!1)}.bind(this),2)},openRootWnd:function(t){},closeCallBack:function(){}});cc._RF.pop()},{common_scrollview:"common_scrollview",ladder_controller:"ladder_controller",pathtool:"pathtool",playerhead:"playerhead"}],ladder_role_info_window:[function(t,e,i){"use strict";cc._RF.push(e,"9630a1/70NFzr+0WgbTuTUI","ladder_role_info_window");var s=t("pathtool"),n=t("ladder_controller"),a=t("playerhead"),o=t("hero_controller"),l=t("partner_const"),r=t("ladder_event"),c=t("hero_vo");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("ladder","ladder_role_info"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Big},initConfig:function(){this.item_list={},this.ctrl=n.getInstance(),this.model=this.ctrl.getModel()},openCallBack:function(){this.background=this.seekChild("background"),this.background.scale=FIT_SCALE,this.main_panel=this.seekChild("main_panel"),this.close_btn=this.seekChild(this.main_panel,"close_btn"),this.challenge_btn=this.seekChild(this.main_panel,"challenge_btn"),this.seekChild(this.challenge_btn,"label",cc.Label).string=Utils.TI18N("\u6311\u6218"),this.black_btn=this.seekChild(this.main_panel,"black_btn"),this.seekChild(this.black_btn,"label",cc.Label).string=Utils.TI18N("\u9632\u5b88\u9635\u5bb9"),this.title_container=this.seekChild(this.main_panel,"title_container"),this.seekChild(this.title_container,"title_label",cc.Label).string=Utils.TI18N("\u6311\u6218\u5bf9\u624b"),this.info_con=this.seekChild(this.main_panel,"info_con"),this.name_lb=this.seekChild(this.info_con,"name",cc.Label),this.seekChild(this.info_con,"rank_title",cc.Label).string=Utils.TI18N("\u6392\u540d"),this.rank_lb=this.seekChild(this.info_con,"rank",cc.Label),this.rank_lb.string=Utils.TI18N("\u6682\u65e0"),this.seekChild(this.info_con,"guild_title",cc.Label).string=Utils.TI18N("\u516c\u4f1a\uff1a"),this.guild_lb=this.seekChild(this.info_con,"guild",cc.Label),this.guild_lb.string=Utils.TI18N("\u6682\u65e0"),this.head=new a,this.head.show(),this.head.setPosition(10,-5),this.head.setParent(this.head),this.main_container=this.seekChild(this.main_panel,"main_container"),this.seekChild(this.main_container,"fight_title",cc.Label).string=Utils.TI18N("\u6218\u6597\u9635\u5bb9")},registerEvent:function(){Utils.onTouchEnd(this.background,function(){this.ctrl.openLadderRoleInfoWindow(!1)}.bind(this),2),Utils.onTouchEnd(this.close_btn,function(){this.ctrl.openLadderRoleInfoWindow(!1)}.bind(this),2),Utils.onTouchEnd(this.black_btn,function(){o.getInstance().openFormMainWindow(!0,l.Fun_Form.Ladder)}.bind(this),1),Utils.onTouchEnd(this.challenge_btn,function(){this.data&&this.data.rid&&this.data.srv_id&&this.ctrl.checkJoinLadderBattle(this.data.rid,this.data.srv_id)}.bind(this),1),this.addGlobalEvent(r.GetLadderEnemyData,function(t){this.setData(t)}.bind(this))},openRootWnd:function(t){t&&null!=t.rid&&null!=t.srv_id&&this.ctrl.requestLadderEnemyData(t.rid,t.srv_id)},setData:function(t){this.data=t,this.name_lb.string=Utils.transformNameByServ(t.name,t.srv_id),this.head.setHeadRes(t.face),t.gname&&""!=t.gname&&(this.guild_lb.string=t.gname);var e=Config.avatar_data.data_avatar[t.avatar_id||0];if(e){var i=e.res_id||1,n=s.getUIIconPath("headcircle","txt_cn_headcircle_"+i);this.head.setFrameRes(n)}this.head.setLev(t.lev),this.rank_lb.string=cc.js.formatStr(Utils.TI18N("%s\u540d"),t.rank||0),this.head.setSex(t.sex,cc.v2(70,4)),this.createPartnerList(t.p_list)},createPartnerList:function(t){var e=[];for(var i in t){var s=t[i],n=new c,a=Utils.deepCopy(s);a.use_skin=a.quality,a.partner_id=s.id,n.updateHeroVo(a),e.push(n)}e.length},closeCallBack:function(){this.head&&(this.head.deleteMe(),this.head=null),this.ctrl.openLadderRoleInfoWindow(!1)}});cc._RF.pop()},{hero_controller:"hero_controller",hero_vo:"hero_vo",ladder_controller:"ladder_controller",ladder_event:"ladder_event",partner_const:"partner_const",pathtool:"pathtool",playerhead:"playerhead"}],ladder_role_item:[function(t,e,i){"use strict";cc._RF.push(e,"d51aaEGqqRNJ6PZWsjI/TDo","ladder_role_item");var s=t("pathtool"),n=t("ladder_controller"),a=t("baserole");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("ladder","ladder_role_item")},initConfig:function(){this.ctrl=n.getInstance(),this.model=this.ctrl.getModel()},initPanel:function(){this.size=cc.size(243,280),this.container=this.seekChild("container"),this.touch_layer=this.seekChild("touch_layer"),this.image_line_sp=this.seekChild("image_line",cc.Sprite),this.rank_label_lb=this.seekChild("rank_label",cc.Label),this.name_label_lb=this.seekChild("name_label",cc.Label),this.attk_label_lb=this.seekChild("attk_label",cc.Label),this.atk_icon_nd=this.seekChild("atk_icon"),this.pos_role_nd=this.seekChild("pos_role"),this.attk_image=this.seekChild("attk_image"),this.rank_bg=this.seekChild("rank_bg")},registerEvent:function(){Utils.onTouchEnd(this.touch_layer,function(){if(this.model.getLadderIsOpen())this.ctrl.openLadderRoleInfoWindow(!0,this.data);else{var t=Config.sky_ladder_data.data_const.close_text;t&&message(cc.js.formatStr(Utils.TI18N("\u6bcf%s\u5929\u68af\u4e89\u9738"),t.desc))}}.bind(this),1)},setData:function(t){this.data=t,this.root_wnd&&this.onShow()},onShow:function(){if(null!=this.data){var t=this.data,e=this.model.getLadderIsOpen();t.rank&&0!=t.rank?this.rank_label_lb.string=cc.js.formatStr(Utils.TI18N("\u7b2c%s\u540d"),t.rank):this.rank_label_lb.string=Utils.TI18N("\u672a\u4e0a\u699c");var i=this.rank_label_lb.node.getContentSize();if(this.rank_label_lb._forceUpdateRenderData(),this.rank_bg.setContentSize(cc.size(i.width+10,30)),e){this.name_label_lb.string=Utils.transformNameByServ(t.name,t.srv_id),this.attk_label_lb.string=t.power||0,this.attk_label_lb._forceUpdateRenderData();var s=this.attk_label_lb.node.getContentSize();this.attk_image.active=!0,this.atk_icon_nd.active=!0,this.atk_icon_nd.x=121-s.width/2}else{this.name_label_lb.string=Utils.TI18N("\u865a\u4f4d\u4ee5\u5f85");var n=Config.sky_ladder_data.data_const.close_text;n&&(this.attk_label.string=n.desc),this.attk_image.active=!1,this.atk_icon_nd.active=!1}this.role_spine&&t.look&&this.role_spine.setData(a.type.role,t.look,PlayerAction.show,!0,.7),t.look&&null==this.role_spine&&(this.role_spine=new a,this.role_spine.setParent(this.pos_role),this.role_spine.setPosition(0,130),this.role_spine.setAnchorPoint(.5,0),this.role_spine.setData(a.type.role,t.look,PlayerAction.show,!0,.7));var o=this.getRoleBoxResPath(t.rank);o?(this.loadRes(o,function(t){this.image_line_sp.spriteFrame=t}.bind(this)),this.image_line_sp.node.active=!0):this.image_line_sp.node.active=!1}},getRoleBoxResPath:function(t){var e=null,i=Config.sky_ladder_data.data_const.role_box,n=0;if(i&&null!=i.val)for(var a in i.val){var o=i.val[a];t>=o[0]&&(t<=o[0]||0==o[1])&&(n=a)}return 1==n?e=s.getUIIconPath("ladder","ladder_1019"):2==n?e=s.getUIIconPath("ladder","ladder_1018"):3==n?e=s.getUIIconPath("ladder","ladder_1017"):4==n&&(e=s.getUIIconPath("ladder","ladder_1016")),e},onHide:function(){},onDelete:function(){this.role_spine&&(this.role_spine.deleteMe(),this.role_spine=null)}});cc._RF.pop()},{baserole:"baserole",ladder_controller:"ladder_controller",pathtool:"pathtool"}],ladder_shop_window:[function(t,e,i){"use strict";cc._RF.push(e,"d5526cIWjlM6rRgDcGZbIJG","ladder_shop_window");var s=t("pathtool"),n=t("role_controller"),a=t("common_scrollview"),o=t("mall_item"),l=t("mall_controller"),r=t("mall_const"),c=t("ladder_controller"),_=t("mall_event");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("ladder","ladder_shop_window"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Big},initConfig:function(){this.role_vo=n.getInstance().getRoleVo(),this.ctrl=c.getInstance(),this.model=this.ctrl.getModel()},openCallBack:function(){this.background=this.seekChild("background"),this.background&&(this.background.scale=FIT_SCALE),this.container=this.seekChild("container"),this.seekChild(this.container,"win_title",cc.Label).string=Utils.TI18N("\u79ef\u5206\u5546\u5e97"),this.close_btn=this.seekChild("close_btn"),this.list_panel=this.seekChild("list_panel"),this.res_label=this.seekChild("res_label",cc.Label),this.res_label.string=this.role_vo.sky_coin;var t=this.list_panel.getContentSize(),e=cc.size(t.width,t.height),i={item_class:o,start_x:5,space_x:0,start_y:0,space_y:2,item_width:306,item_height:143,row:0,col:2,need_dynamic:!0};this.item_scroll_view=new a,this.item_scroll_view.createScroll(this.list_panel,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,e,i,cc.v2(.5,.5))},registerEvent:function(){Utils.onTouchEnd(this.close_btn,function(){this.ctrl.openLadderShopWindow(!1)}.bind(this),2),Utils.onTouchEnd(this.background,function(){this.ctrl.openLadderShopWindow(!1)}.bind(this),2),this.addGlobalEvent(_.Open_View_Event,function(t){var e=this.getConfig(t);this.item_scroll_view.setData(e,function(t){l.getInstance().openMallBuyWindow(!0,t.getData())}.bind(this))},this),this.role_vo&&null==this.role_assets_event&&(this.role_assets_event=this.role_vo.bind(EventId.UPDATE_ROLE_ATTRIBUTE,function(t,e){"sky_coin"==t&&(this.res_label.string=e)}.bind(this)))},openRootWnd:function(t){l.getInstance().sender13401(r.MallType.Ladder)},getConfig:function(t){var e=[],i=Config.exchange_data.data_shop_exchage_ladder;if(i){var s=Utils.deepCopy(t.item_list);for(var n in i){var a=i[n];if(s&&null!=Utils.next(s||{}))for(var o in s){var l=s[o];a.id==l.item_id?null!=l.ext[0].val&&(a.has_buy=l.ext[0].val,s.splice(o,1)):a.has_buy=0}else a.has_buy=0;e.push(a)}}return e.sort(function(t,e){return t.limit_count&&t.limit_count>0&&t.has_buy>=t.limit_count&&(!e.limit_count||0==e.limit_count||e.has_buy<e.limit_count)?1:e.limit_count&&e.limit_count>0&&e.has_buy>=e.limit_count&&(!t.limit_count||0==t.limit_count||t.has_buy<t.limit_count)?-1:t.order-e.order}),e},closeCallBack:function(){this.item_scroll_view&&(this.item_scroll_view.deleteMe(),this.item_scroll_view=null),null!=this.role_vo&&this.role_assets_event&&(this.role_vo.unbind(this.role_assets_event),this.role_assets_event=null),this.ctrl.openLadderShopWindow(!1)}});cc._RF.pop()},{common_scrollview:"common_scrollview",ladder_controller:"ladder_controller",mall_const:"mall_const",mall_controller:"mall_controller",mall_event:"mall_event",mall_item:"mall_item",pathtool:"pathtool",role_controller:"role_controller"}],ladder_top_three_window:[function(t,e,i){"use strict";cc._RF.push(e,"89234ljtEdJ+p+0ojnwtmdf","ladder_top_three_window");var s=t("pathtool"),n=t("ladder_controller"),a=t("ladder_event"),o=t("role_event"),l=t("role_controller"),r=t("friend_controller"),c=t("ladder_const");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("ladder","ladder_top_three_window"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Big},initConfig:function(){this.state_list={},this.ctrl=n.getInstance(),this.model=this.ctrl.getModel()},openCallBack:function(){this.background=this.seekChild("background"),this.background.scale=FIT_SCALE;var t=this.seekChild("main_container");this.seekChild(t,"title_label",cc.Label).string=Utils.TI18N("\u82f1\u96c4\u6bbf"),this.seekChild(t,"tips_label",cc.Label).string=Utils.TI18N("*\u6bcf\u65e5\u70b9\u8d5e\u53ef\u83b7\u5929\u68af\u79ef\u5206\u5956\u52b1"),this.close_btn=this.seekChild("close_btn");for(var e=1;e<=3;e++){var i=this.seekChild(t,"statue_"+e),s=i.getChildByName("desc").getComponent(cc.Label);s.string=Utils.TI18N("\u865a\u4f4d\u4ee5\u5f85");var n={};n.model=i.getChildByName("model"),n.role_name=i.getChildByName("role_name").getComponent(cc.Label),n.guild_name=i.getChildByName("guild_name").getComponent(cc.Label),n.worship_btn=i.getChildByName("worship_btn").getComponent(cc.Button),n.label=i.getChildByName("label").getComponent(cc.Label),n.btn_check=i.getChildByName("btn_check").getComponent(cc.Button),n.desc=s,n.worship_num=0,this.state_list[e]=n}},registerEvent:function(){var t=this;Utils.onTouchEnd(this.close_btn,function(){this.ctrl.openLadderTopThreeWindow(!1)}.bind(this),2),Utils.onTouchEnd(this.background,function(){this.ctrl.openLadderTopThreeWindow(!1)}.bind(this),2);for(var e=function(e){var i=t.state_list[e];i&&i.worship_btn&&i.worship_btn.node.on("click",function(){this._onClickBtnWorship(e)}.bind(t)),i&&i.btn_check&&i.btn_check.node.on("click",function(){this._onClickBtnCheck(e)}.bind(t))},i=1;i<=3;i++)e(i);this.addGlobalEvent(a.UpdateLadderTopThreeRoleData,function(t){this.setData(t)},this),this.addGlobalEvent(o.WorshipOtherRole,function(t,e,i){if(null!=i&&this.state_data[i]){var s=this.state_list[i];s.worship_num=s.worship_num+1,s.label.string=s.worship_num,Utils.setGreyButton(s.worship_btn)}},this)},openRootWnd:function(t){this.ctrl.requestTopThreeRoleData()},_onClickBtnWorship:function(t){var e=this.getRoleDataByRank(t);if(e){var i=e.rid,s=e.srv_id;l.getInstance().sender10316(i,s,t,WorshipType.ladder)}},_onClickBtnCheck:function(t){var e=this.getRoleDataByRank(t);if(e){var i=e.rid,s=e.srv_id;r.getInstance().openFriendCheckPanel(!0,{srv_id:s,rid:i})}},setData:function(t){t=t||{},this.data=t;for(var e=1;e<=3;e++){var i=this.state_list[e],s=this.getRoleDataByRank(e);if(s){i.model.x=5e3,i.role_name.node.x=5e3,i.guild_name.node.x=5e3,i.worship_btn.node.x=5e3,i.desc.node.x=5e3,i.role_name.string=s.name;var n=s.gname;n&&""!=n||(n=Utils.TI18N("\u6682\u65e0")),i.guild_name.string=cc.js.formatStr(Utils.TI18N("\u516c\u4f1a:%s"),n),i.label.string=s.worship,i.worship_num=s.worship,s.worship_status}}},getRoleDataByRank:function(t){this.data=this.data||{};var e=null;for(var i in this.data){var s=this.data[i];if(s.rank==t){e=s;break}}return e},closeCallBack:function(){this.model.updateLadderRedStatus(c.RedType.TopThree,!1),this.ctrl.openLadderTopThreeWindow(!1)}});cc._RF.pop()},{friend_controller:"friend_controller",ladder_const:"ladder_const",ladder_controller:"ladder_controller",ladder_event:"ladder_event",pathtool:"pathtool",role_controller:"role_controller",role_event:"role_event"}],lang:[function(t,e,i){"use strict";cc._RF.push(e,"bfd5fq7j15BQ46eFI5xmCsu","lang"),window.Lang={CHAT_CROSS_DES:"\u7b49\u7ea7\u4e0d\u8db350\u7ea7",CHAT_Gang_DES:"\u60a8\u6682\u65f6\u6ca1\u6709\u52a0\u5165\u516c\u4f1a",FREE_RECRUIT:"<color=#35ff14><outline=2, color=#000000>%s</outline></color><color=#ffffff><outline=2, color=#000000>\u540e\u514d\u8d39</outline></color>",SCORE_RECRUIT:"\u6d88\u8017%d\u70b9\u79ef\u5206\u53ef\u8fdb\u884c\u79ef\u5206\u53ec\u5524\uff0c\u5fc5\u51fa5\u661f\u4f20\u8bf4\u82f1\u96c4",DIAMOND_CONSUME:"\u662f\u5426\u4f7f\u7528<img src=%s visible=true scale=1 /><div fontColor=#289b14 fontsize= 26>%s</div><div fontColor=#764519>(\u62e5\u6709:</div><div fontColor=#289b14 fontsize= 26>%s</div><div fontColor=#764519>)\n</div>",BUY_DES:"<div fontColor=#764519>\u8d2d\u4e70</div><div fontColor=#289b14 fontsize= 26>%s</div><div fontColor=#764519></div><div fontColor=#d95014 fontsize= 26>%s</div><div fontColor=#764519>(\u540c\u65f6\u9644\u8d60</div><div fontColor=#289b14 fontsize= 26>%s</div><div fontColor=#764519>\u6b21\u62db\u52df)</div>",GET_WAYS:"\u83b7\u53d6\u9014\u5f84",ITEM_HAVE:"\u62e5\u6709%s\u4e2a",COMPASS:"\u901a\u5173",LOCK:"\u89e3\u9501",LEV_LOCK:"\u7ea7\u89e3\u9501",GUILD:"\u516c\u4f1a",NOT_GUILD:"\u5c1a\u672a\u52a0\u5165\u516c\u4f1a",GOTO:"\u524d\u5f80",NO_OPEN:"\u672a\u5f00\u542f",COMMON_HERO:"\u4e0d\u80fd\u540c\u65f6\u4e0a\u96352\u4e2a\u76f8\u540c\u82f1\u96c4",NOT_POS:"\u6ca1\u6709\u4e0a\u9635\u4f4d\u7f6e",FULL_POS:"\u4e0a\u9635\u4eba\u6570\u5df2\u6ee1",MINIMUM_NUM:"\u81f3\u5c11\u9700\u8981\u4e0a\u9635\u4e00\u4e2a\u82f1\u96c4",NO_HERO:"\u6ca1\u6709\u82f1\u96c4",LEVEL_UP:"\u5347\u7ea7",BREAK_UP:"\u8fdb\u9636",OFFET_DES:"\u732e\u796d\u82f1\u96c4\u53ef\u83b7\u5f97\u6750\u6599\uff0c\u82e5\u82f1\u96c4\u6709\u8fdb\u884c\u5347\u7ea7\u3001\u8fdb\u9636\u3001\u5347\u661f\u57f9\u517b\uff0c\u4e5f\u4f1a100%\u8fd4\u8fd8\u6240\u6d88\u8017\u7684\u8fdb\u9636\u77f3\u3001\u91d1\u5e01\u548c\u82f1\u96c4\u7ecf\u9a8c\u3002\u672c\u6b21\u732e\u796d\u6240\u5f97\u5982\u4e0b\uff1a",LOADING_DESC_1:"\u526f\u672c\u63a8\u56fe\u5173\u5361\u8d8a\u9ad8\uff0c\u83b7\u53d6\u89d2\u8272\u7ecf\u9a8c\u3001\u91d1\u5e01\u3001\u82f1\u96c4\u7ecf\u9a8c\u6548\u7387\u8d8a\u9ad8",LOADING_DESC_2:"\u82f1\u96c4\u5347\u661f\u3001\u8fdb\u9636\u53ef\u5927\u5e45\u63d0\u9ad8\u82f1\u96c4\u5c5e\u6027\u6210\u957f\uff0c\u5347\u7ea7\u5c5e\u6027\u52a0\u6210\u63d0\u9ad8",LOADING_DESC_3:"\u52a0\u5165\u516c\u4f1a\uff0c\u4e00\u8d77\u6253Boss\u53ef\u4ee5\u8d5a\u53d6\u5927\u91cf\u516c\u4f1a\u8d21\u732e",LOADING_DESC_4:"\u6218\u6597\u4e0d\u505c\uff01\u5373\u4f7f\u79bb\u7ebf\u4e5f\u4f1a\u4e0d\u65ad\u83b7\u5f97\u7ecf\u9a8c\u3001\u91d1\u5e01\u3001\u82f1\u96c4\u788e\u7247\u7b49\u6302\u673a\u5956\u52b1",LOADING_DESC_5:"\u5feb\u901f\u4f5c\u6218\u53ef\u4ee5\u7acb\u5373\u83b7\u5f97\u5927\u91cf\u89d2\u8272\u7ecf\u9a8c\u548c\u8d44\u6e90",LOADING_DESC_6:"\u6311\u6218\u7ade\u6280\u573a\u62ff\u7ade\u6280\u5956\u676f\uff0c\u73cd\u8d35\u82f1\u96c4\u3001\u5148\u77e5\u6c34\u6676\u8d85\u503c\u5151\u6362",LOADING_DESC_7:"\u6e38\u620f\u600e\u4e48\u73a9\uff1f\u63a8\u56fe\u3001\u722c\u5854\u3001\u6253Boss\u3001\u517b\u82f1\u96c4\u73a9\u7ade\u6280\uff0c\u611f\u53d7\u6210\u957f\u7684\u4e50\u8da3",LOADING_DESC_8:"\u4e0d\u77e5\u9053\u505a\u4ec0\u4e48\uff1f\u65e5\u5e38\u4efb\u52a1\u70b9\u4e00\u70b9",LOADING_DESC_9:"\u5148\u77e5\u53ec\u5524\u5927\u6982\u7387\u53ef\u83b7\u5f97\u9ad8\u661f\u82f1\u96c4",LOADING_DESC_10:"\u8bd5\u7ec3\u5854\u53ef\u4ee5\u83b7\u5f97\u5927\u91cf\u82f1\u96c4\u8fdb\u9636\u6750\u6599\uff0c\u5e2e\u52a9\u82f1\u96c4\u66f4\u5feb\u6210\u957f",LOADING_DESC_11:"\u795e\u754c\u5192\u9669\u6bcf2\u5929\u91cd\u7f6e1\u6b21\uff0c\u4e0d\u8981\u5fd8\u4e86\u5662",LOADING_DESC_12:"\u7cbe\u7075\u5546\u5e97\u53ef\u83b7\u5f97\u5404\u79cd\u6298\u6263\u7269\u54c1\uff0c\u53ec\u5524\u5377\u3001\u5148\u77e5\u6c34\u6676\u3001\u8fdb\u9636\u77f3\u5e94\u6709\u5c3d\u6709",LOADING_DESC_13:"\u4e0d\u77e5\u9053\u5982\u4f55\u63d0\u5347\uff1f\u70b9\u4e00\u4e0b\u5267\u60c5\u6218\u6597\u754c\u9762\u7684\u82f1\u96c4\u53d8\u5f3a\u6309\u94ae\u5427~"},cc._RF.pop()},{}],lev_upgrade_window:[function(t,e,i){"use strict";cc._RF.push(e,"20f19O9c3dDjLtZbLnHaT1+","lev_upgrade_window");var s=t("pathtool"),n=t("action_controller"),a=t("levupgrade_controller"),o=t("story_event");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("levupgrade","lev_upgrade_window"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Tips,this.ctrl=a.getInstance()},initConfig:function(){this.lev_list=[],this.can_touch=!1,this.auto_limit_time=5,this.item_list=[]},openCallBack:function(){this.background=this.root_wnd.getChildByName("background"),this.main_container=this.root_wnd.getChildByName("main_container"),this.back_panel=this.main_container.getChildByName("back_panel"),this.title_container=this.main_container.getChildByName("title_container"),this.play_effect=this.title_container.getChildByName("action").getComponent(sp.Skeleton),this.title_width=this.title_container.getContentSize().width,this.title_height=this.title_container.getContentSize().height;var t=this.main_container.getChildByName("item_1");if(t){t.getChildByName("title").getComponent(cc.Label).string="\u5192\u9669\u8005\u7b49\u7ea7";var e={};e.last_lev=t.getChildByName("last_lev"),e.now_lev=t.getChildByName("now_lev"),this.lev_list.push(e)}this.award_container=this.main_container.getChildByName("award_container"),this.award_container.getChildByName("award_title").getComponent(cc.Label).string="\u5347\u7ea7\u5956\u52b1",this.extend_container=this.main_container.getChildByName("extend_container"),this.extend_panel=this.extend_container.getChildByName("extend_panel"),this.extend_icon=this.extend_panel.getChildByName("icon"),this.extend_title=this.extend_panel.getChildByName("title"),this.extend_desc=this.extend_panel.getChildByName("desc"),this.extend_ext_desc=this.extend_panel.getChildByName("ext_desc"),this.extend_panel.getChildByName("extend_title").getComponent(cc.Label).string="\u529f\u80fd\u9884\u544a"},registerEvent:function(){this.background.on("touchend",function(){Utils.playButtonSound(2),1==this.can_touch&&this.onClickClose()},this)},openRootWnd:function(t){Utils.playButtonSound("c_get"),this.handleEffect(),this.starTimeTicket();var e=t.old_lev||0,i=t.lev||0,s=Config.role_data.data_role_attr[i];if(s){var n=this.lev_list[0];n.last_lev.getComponent(cc.Label).string=e,n.now_lev.getComponent(cc.Label).string=i,this.award_data=[];for(var a=e+1;a<=i;++a){var o=Config.role_data.data_role_attr[a];if(o&&o.reward)for(var l=0;l<o.reward.length;++l){var r=o.reward[l];this.checkAddAwardData(r)}}this.setAwardInfo(),this.setExtendInfo(s)}},handleEffect:function(){if(this.play_effect){var t=s.getSpinePath(s.getEffectRes(274),"action");this.loadRes(t,function(t){this.play_effect.skeletonData=t,this.play_effect.setAnimation(0,"action2",!1)}.bind(this))}},starTimeTicket:function(){var t=this;t.cut_time=0,null==t.time_ticket&&(t.time_ticket=gcore.Timer.set(function(){t.cut_time=t.cut_time+.5,t.cut_time>.5&&(t.can_touch=!0),t.cut_time>=t.auto_limit_time&&(gcore.Timer.del(this.time_ticket),this.time_ticket=null,t.onClickClose())}.bind(this),500,-1))},checkAddAwardData:function(t){if(this.award_data=this.award_data||[],null!=Utils.next(this.award_data))for(var e=0;e<this.award_data.length;++e){var i=this.award_data[e];i[0]&&t[0]&&(i[0]==t[0]?i[1]=i[1]+t[1]:this.award_data.push(t))}else this.award_data.push(t)},setAwardInfo:function(){if(null!=this.award_data){for(var t=0;t<this.item_list.length;++t){this.item_list[t].setVisible(!1)}if(this.award_data&&null!=Utils.next(this.award_data)){for(var e=this.award_container.getContentSize(),i=0;i<this.award_data.length;++i){var s=this.award_data[i],n=this.item_list[i];if(null==n){var a=s[0],o=s[1];(n=ItemsPool.getInstance().getItem("backpack_item")).setParent(this.award_container),n.setData({bid:a,num:o}),this.item_list[i]=n}var l=0+140*(i+1-1);n.show(),n.setPosition(l,e.height/2-25)}this.award_container.active=!0}else this.award_container.active=!1}},onClickClose:function(){this.ctrl.openMainWindow(!1),n.getInstance().checkOpenActionLimitGiftMainWindow()},setExtendInfo:function(t){if(null!=t){var e=this;if(""==t.icon){e.back_panel.setContentSize(cc.size(SCREEN_WIDTH,349));var i=this.main_container.height-349;this.main_container.height-=i,e.extend_container.active=!1}else{e.back_panel.setContentSize(cc.size(SCREEN_WIDTH,519));var n=s.getUIIconPath("bigbg/battledrama",t.icon);this.loadRes(n,function(t){e.extend_icon.getComponent(cc.Sprite).spriteFrame=t}.bind(this)),e.extend_title.getComponent(cc.Label).string=t.title,e.extend_desc.getComponent(cc.Label).string=t.desc,e.extend_ext_desc.getComponent(cc.Label).string=t.ext_desc}}},closeCallBack:function(){this.play_effect.skeletonData=null,this.time_ticket&&(gcore.Timer.del(this.time_ticket),this.time_ticket=null);for(var t=0;t<this.item_list.length;++t)this.item_list[t].deleteMe(),this.item_list[t]=null;gcore.GlobalEvent.fire(o.PREPARE_PLAY_PLOT),this.ctrl.openMainWindow(!1)}});cc._RF.pop()},{action_controller:"action_controller",levupgrade_controller:"levupgrade_controller",pathtool:"pathtool",story_event:"story_event"}],levupgrade_controller:[function(t,e,i){"use strict";cc._RF.push(e,"4237fFCt5xBi7XHwNZZUSbL","levupgrade_controller");var s=t("story_event"),n=cc.Class({extends:BaseController,ctor:function(){},initConfig:function(){var e=t("levupgrade_model");this.model=new e,this.model.initConfig(),this.wait_list=[]},getModel:function(){return this.model},registerEvents:function(){var t=this;null==t.can_play_drama_event&&(t.can_play_drama_event=gcore.GlobalEvent.bind(s.BATTLE_RESULT_OVER,function(){t.wait_list.length&&t.wait_list.splice(0,1),null==Utils.next(t.wait_list)&&t.cache_data?(t.openMainWindow(!0,t.cache_data),t.cache_data=null):gcore.GlobalEvent.fire(s.PREPARE_PLAY_PLOT)}))},registerProtocals:function(){this.RegisterProtocal(10344,this.handle10344)},handle10344:function(t){this.openMainWindow(!0,t)},waitForOpenLevUpgrade:function(t){this.wait_list&&0==this.wait_list.length&&this.wait_list.push(!0)},openMainWindow:function(e,i){if(e){if(null!=Utils.next(this.wait_list))return void(this.cache_data=i);if(null==this.lev_window){var s=t("lev_upgrade_window");this.lev_window=new s}this.lev_window.open(i)}else this.lev_window&&(this.lev_window.close(),this.lev_window=null)},waitLevupgrade:function(){return null!=this.cache_data||null!=this.lev_window||null!=Utils.next(this.wait_list)},logStatus:function(){cc.log(this.cache_data),cc.log(!!this.lev_window),cc.log(this.wait_list)}});e.exports=n,cc._RF.pop()},{lev_upgrade_window:"lev_upgrade_window",levupgrade_model:"levupgrade_model",story_event:"story_event"}],levupgrade_model:[function(t,e,i){"use strict";cc._RF.push(e,"95f0eIdblJDfoa+Yj2O9b1q","levupgrade_model");cc.Class({extends:BaseClass,ctor:function(){},properties:{},initConfig:function(){}});cc._RF.pop()},{}],limitExercise_const:[function(t,e,i){"use strict";var s;function n(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}cc._RF.push(e,"cd518LFhh1BBYm7o/A+FFe5","limitExercise_const");var a={};a.type=(n(s={},1,"\u964d\u7ea7\u533a"),n(s,2,"\u4fdd\u7ea7\u533a"),n(s,3,"\u5347\u7ea7\u533a"),s),e.exports=a,cc._RF.pop()},{}],limit_exercise_reward_item_panel:[function(t,e,i){"use strict";cc._RF.push(e,"686b29P8C1B7JkrSspv+hEB","limit_exercise_reward_item_panel");var s=t("pathtool");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("limitexercise","reward_item")},initConfig:function(){},initPanel:function(){var t=this.root_wnd.getChildByName("main_container");this.settle_text=t.getChildByName("Image_1_0").getChildByName("Text_2").getComponent(cc.Label),this.settle_text.string="",t.getChildByName("Image_1").getChildByName("Text_1").getComponent(cc.Label).string=Utils.TI18N("\u989d\u5916\u53ef\u80fd\u6389\u843d"),this.item_1=t.getChildByName("item_1"),this.item_1_content=this.item_1.getChildByName("content"),this.item_2=t.getChildByName("item_2"),this.item_2_content=this.item_2.getChildByName("content"),this.box_spr=t.getChildByName("box_spr").getComponent(cc.Sprite),this.data&&this.setData(this.data)},registerEvent:function(){},onShow:function(t){},setData:function(t){if(t&&(this.data=t,this.root_wnd)){var e=t.sort_id||1;this.loadRes(s.getUIIconPath("limitexercise","limitexercise_box"+e),function(t){this.box_spr.spriteFrame=t}.bind(this)),this.settle_text.string=cc.js.formatStr(Utils.TI18N("\u901a\u5173\u7b2c%d\u5173\u540e\u7ed3\u7b97\u5956\u52b1"),t.order_id),this.settleItem(t.reward),this.extraItem(t.show_reward)}},settleItem:function(t){var e={scale:.6,max_count:3,is_center:!0,show_effect_id:263};this.item_settle_list=Utils.commonShowSingleRowItemList(this.item_1,this.item_settle_list,t,e,this.item_1_content)},extraItem:function(t){var e={scale:.6,max_count:2,is_center:!0,show_effect_id:263};this.item_extra_list=Utils.commonShowSingleRowItemList(this.item_2,this.item_extra_list,t,e,this.item_2_content)},onHide:function(){},onDelete:function(){if(this.item_settle_list){for(var t=0;t<this.item_settle_list.length;++t)this.item_settle_list[t]&&(this.item_settle_list[t].deleteMe(),this.item_settle_list[t]=null);this.item_settle_list=null}if(this.item_extra_list){for(var e=0;e<this.item_extra_list.length;++e)this.item_extra_list[e]&&(this.item_extra_list[e].deleteMe(),this.item_extra_list[e]=null);this.item_extra_list=null}}});cc._RF.pop()},{pathtool:"pathtool"}],limitexercise_change_item_panel:[function(t,e,i){"use strict";cc._RF.push(e,"5a834XHoONCcLnoC0HBA/ZW","limitexercise_change_item_panel");var s=t("pathtool"),n=t("limitexercise_controller"),a=t("limitexercise_hero_item_panel");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("limitexercise","limitexercise_change_item"),this.HeightItem=568,this.model=n.getInstance().getModel()},initConfig:function(){this.btn_master={}},initPanel:function(){var t=this,e=this.root_wnd.getChildByName("main_container");this.touch_kuang=e.getChildByName("touch_kuang");for(var i=function(i){var s={};(s.btn=e.getChildByName("btn_master_"+i),s.hero_item=new a(.9),s.hero_item.addCallBack(function(){this.onClickHeroItem(i)}.bind(t)),s.hero_item.setParent(s.btn),s.hero_item.setPosition(-26,-4.5),s.hero_item.show(),s.name=s.btn.getChildByName("name").getComponent(cc.Label),s.name.string="",s.bar=s.btn.getChildByName("bar").getComponent(cc.ProgressBar),s.bar_num=s.btn.getChildByName("bar_num").getComponent(cc.Label),s.bar_num.string="",s.kill_spr=s.btn.getChildByName("kill_spr"),s.kill_spr.zIndex=10,s.kill_spr.active=!1,s.lock_spr=s.btn.getChildByName("lock_spr"),s.lock_spr.zIndex=10,s.lock_spr.active=!1,5==i)&&(s.btn.getChildByName("boss_spr").zIndex=10);s.index=i,t.btn_master[i]=s},s=1;s<=5;++s)i(s);this.data&&(this.setData(this.data),this.setItemIndex())},registerEvent:function(){},onShow:function(t){},onHide:function(){},setData:function(t){this.data=t,t&&this.root_wnd&&this.setGuardData(t)},setGuardData:function(t){var e=this,i=[];for(var s in t)i.push(t[s]);i.sort(function(t,e){return t.sort_id-e.sort_id}),this.data=t;for(var n=function(t){if(e.btn_master[t+1]){var s=e.getHeroHp(i[t].order_id),n=s[0],a=s[1];e.btn_master[t+1].hero_item.root_wnd?(e.btn_master[t+1].hero_item.setHeadImg(i[t].head_id),e.btn_master[t+1].hero_item.setQualityImg(i[t].star),e.btn_master[t+1].hero_item.setLev(i[t].master_lev),Utils.setChildUnEnabled(e.btn_master[t+1].hero_item.root_wnd,0==n)):e.btn_master[t+1].hero_item.getRootWnd(function(){this.btn_master[t+1].hero_item.setHeadImg(i[t].head_id),this.btn_master[t+1].hero_item.setQualityImg(i[t].star),this.btn_master[t+1].hero_item.setLev(i[t].master_lev),Utils.setChildUnEnabled(this.btn_master[t+1].hero_item.root_wnd,0==n)}.bind(e)),e.btn_master[t+1].name.string=i[t].name,e.btn_master[t+1].bar_num.string=n+"%",e.btn_master[t+1].bar.progress=n,e.btn_master[t+1].lock_spr.active=1!=a&&100==n,e.btn_master[t+1].kill_spr.active=0==n}},a=0;a<i.length;++a)n(a)},getHeroHp:function(t){var e=this.model.getCurrentChangeID(),i=this.model.getCurrentBossHp();if(!e||!i)return 0;var s=0,n=!1;return t<e?s=0:t==e?(s=.001*i,n=!0):t>e&&(s=100),[s,n]},addCallBack:function(t){this.callback=t},onClickHeroItem:function(t){this.funcCallBack(this.data,t)},funcCallBack:function(t,e){if(t&&this.callback){var i,s;for(var n in t){var a=t[n];if(a.sort_id==e){i=a.order_type,s=a.order_id;break}}i&&s&&(this.item_index=e,this.callback(this,i,s,e))}},getBtnMaster:function(t){if(this.btn_master[t])return this.btn_master[t].btn},setItemIndex:function(){if(this.data){var t,e=this.model.getCurrentChangeID(),i=this.model.getLimitExerciseData();for(var s in i.order>15*i.round&&(e=i.round_boss),this.data){var n=this.data[s];if(n.order_id==e){t=n.sort_id;break}}t&&this.onClickHeroItem(t)}},onDelete:function(){for(var t in this.btn_master)this.btn_master[t].hero_item&&(this.btn_master[t].hero_item.deleteMe(),this.btn_master[t].hero_item=null)}});cc._RF.pop()},{limitexercise_controller:"limitexercise_controller",limitexercise_hero_item_panel:"limitexercise_hero_item_panel",pathtool:"pathtool"}],limitexercise_change_window:[function(t,e,i){"use strict";cc._RF.push(e,"701d9osPbtPM4uKA0jC/rqE","limitexercise_change_window");var s=t("pathtool"),n=t("limitexercise_event"),a=t("timetool"),o=t("limitExercise_const"),l=t("limitexercise_change_item_panel"),r=t("mainui_controller");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("limitexercise","limitexercise_change_window"),this.win_type=WinType.Full,this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){this.reward_list=Config.holiday_boss_new_data.data_lev_reward_list,this.change_boss_list=Config.holiday_boss_new_data.data_change_boss_list,this.cur_order_type=null,this.cur_order_id=null,this.cur_box_status=null,this.scrollview_bar=null,this.item_list_panel=[],this.pos_interval=[[0,320],[320,1047],[1047,1500]]},openCallBack:function(){var t=this.root_wnd.getChildByName("main_container"),e=t.getChildByName("bg").getComponent(cc.Sprite);e.node.scale=FIT_SCALE;var i=s.getUIIconPath("bigbg/limitexercise","limit_exercise_bg1","jpg");this.loadRes(i,function(t){e.spriteFrame=t}),t.getChildByName("Text_10").getComponent(cc.Label).string=Utils.TI18N("\u672c\u8f6e\u6311\u6218\u5269\u4f59\uff1a"),this.ramain_time=t.getChildByName("ramain_time").getComponent(cc.Label),this.ramain_time.string="",this.level_area_text=t.getChildByName("level_area_text").getComponent(cc.Label),this.level_area_text.string="",this.left_scrollview_pos={};for(var n=1;n<=3;++n){var a=t.getChildByName("sroll_spr_"+n);this.left_scrollview_pos[n]=a.y}this.sroll_main_spr=t.getChildByName("sroll_main_spr"),this.sroll_main_spr.opacity=0,this.level_num=t.getChildByName("level_num").getComponent(cc.Label),this.level_num.string="",t.getChildByName("level_area_text_0_0").getComponent(cc.Label).string=Utils.TI18N("\u96be\u5ea6"),this.item_area=t.getChildByName("item_area"),this.level_msg=t.getChildByName("level_msg"),this.btn_change=this.level_msg.getChildByName("btn_change"),this.btn_change_btn=this.btn_change.getComponent(cc.Button),this.btn_change_text=this.btn_change.getChildByName("Text_4").getComponent(cc.Label),this.btn_change_text.string=Utils.TI18N("\u6311\u6218"),this.change_outline=this.btn_change.getChildByName("Text_4").getComponent(cc.LabelOutline),this.btn_box=this.level_msg.getChildByName("btn_box"),this.box_sprite=this.btn_box.getChildByName("box_sprite").getComponent(cc.Sprite),this.level_msg.getChildByName("Text_8").getComponent(cc.Label).string=Utils.TI18N("\u4e0b\u4e00\u9636\u6bb5\u5956\u52b1"),this.level_text=this.level_msg.getChildByName("level_text").getComponent(cc.Label),this.level_text.string="",this.level_msg.getChildByName("level_tips_text").getComponent(cc.Label).string=Utils.TI18N("\u5173\u5361\u6548\u679c"),this.level_effect_desc=this.level_msg.getChildByName("level_effect_desc").getComponent(cc.Label),this.power=this.level_msg.getChildByName("power").getComponent(cc.Label),this.power.string=Utils.TI18N("\u63a8\u8350\u6218\u529b\uff1a"),this.change_item=this.level_msg.getChildByName("change_item"),this.change_item_content=this.change_item.getChildByName("content"),this.btn_rule=t.getChildByName("btn_rule");var o=t.getChildByName("bottom_panel");o.getChildByName("count_title").getComponent(cc.Label).string=Utils.TI18N("\u6311\u6218\u6b21\u6570:"),this.remain_count=o.getChildByName("remain_count").getComponent(cc.Label),this.remain_count.string="\u5269\u4f59\u8d2d\u4e70\u6b21\u6570\uff1a",this.change_count=o.getChildByName("count_label").getComponent(cc.Label),this.change_count.string="",this.add_btn=o.getChildByName("add_btn"),this.btn_close=o.getChildByName("btn_close"),this.item_scrollview=this.item_area.getComponent(cc.ScrollView),this.item_area.on("scrolling",this.updateSlideShowByVertical,this)},registerEvent:function(){this.btn_change.on("click",function(){var e=t("hero_controller"),i=t("partner_const");e.getInstance().openFormGoFightPanel(!0,i.Fun_Form.LimitExercise)},this),this.btn_box.on("click",function(){1==this.model.getBoxStatus()?this.ctrl.send25412():this.ctrl.openLimitExerciseRewardView(!0)},this),this.btn_rule.on("click",function(){r.getInstance().openCommonExplainView(!0,Config.holiday_boss_new_data.data_explain,Utils.TI18N("\u89c4\u5219\u8bf4\u660e"))},this),this.btn_close.on("click",function(){this.ctrl.openLimitExerciseChangeView(!1),Utils.playButtonSound(2)},this),this.add_btn.on("click",function(){Utils.playButtonSound(1);var e=Config.holiday_boss_new_data.data_const;if(e)if(this.model.getDayBuyCount()>=e.fight_buy_max_count.val)message(Utils.TI18N("\u5df2\u8fbe\u4eca\u65e5\u8d2d\u4e70\u6700\u5927\u503c"));else{var i=t("commonalert"),n=cc.js.formatStr("\u662f\u5426\u82b1\u8d39<img src='%s' scale=0.3 />%s\u8d2d\u4e70\u4e00\u6b21\u6311\u6218\u6b21\u6570\uff1f",Config.item_data.data_assets_label2id.gold,e.action_num_espensive.val),a=s.getItemRes(Config.item_data.data_assets_label2id.gold),o=function(){this.ctrl.send25411()}.bind(this);i.show(n,Utils.TI18N("\u786e\u8ba4"),o,Utils.TI18N("\u53d6\u6d88"),null,2,null,{resArr:[a]})}},this),this.addGlobalEvent(n.LimitExercise_Message_Event,function(t){this.setRoundHero(t.difficulty,t.count),this.remainBuyCount(t.buy_count),this.setCountDownTime(this.ramain_time,t.endtime-gcore.SmartSocket.getTime()),this.levelBoxStatus(t.status,t.order),this.showBossMessageItem(t.difficulty),this.getLevelMessage(t.order_type,t.order)}.bind(this)),this.addGlobalEvent(n.LimitExercise_BuyCount_Event,function(t){if(t){var e=this.model.getCurrentDiff();this.setRoundHero(e,t.count),this.remainBuyCount(t.buy_count)}}.bind(this)),this.addGlobalEvent(n.LimitExercise_GetBox_Event,function(t){t&&1==t.code&&this.levelBoxStatus(2,15)}.bind(this))},openRootWnd:function(t){if(null==this.model.getLimitExerciseData())this.ctrl.send25410();else{var e=this.model.getLimitExerciseData();this.setRoundHero(e.difficulty,e.count),this.remainBuyCount(e.buy_count),this.setCountDownTime(e.endtime-gcore.SmartSocket.getTime()),this.levelBoxStatus(e.status,e.order),this.showBossMessageItem(e.difficulty);var i=this.item_scrollview.content.y,s=this.getCurrentPos(Math.abs(i));this.scrollviewSprintBar(s)}this.ctrl.send25414()},createAreaList:function(){if(0==this.item_list_panel.length)this.timer=this.startUpdate(this.area_list.length,function(t){var e=new l;e.setParent(this.item_scrollview.content),e.show(),e.setPosition(0,t*e.HeightItem),e.setData(this.area_list[t]),e.addCallBack(function(t,e,i,s){this.onCellTouched(t,e,i,s)}.bind(this)),this.item_list_panel.push(e)}.bind(this),100);else for(var t=0;t<this.area_list.length;++t){var e=this.item_list_panel[t];if(!e){var i=new l;i.setParent(this.item_scrollview.content),i.show(),i.setPosition(0,index*i.HeightItem),i.addCallBack(function(t,e,i,s){this.onCellTouched(t,e,i,s)}.bind(this)),this.item_list_panel[t]=i}e.setData(this.area_list[t]),e.setItemIndex()}this.item_scrollview.content.height=568*this.area_list.length},setRoundHero:function(t,e){this.level_num.string=t||1,this.change_count.string=e||0},remainBuyCount:function(t){if(t=t||0,this.remain_count){var e=0,i=Config.holiday_boss_new_data.data_const.fight_buy_max_count;i&&i.val&&((e=i.val-t)<=0&&(e=0),this.remain_count.string="\u5269\u4f59\u8d2d\u4e70\u6b21\u6570\uff1a"+e)}},setCountDownTime:function(t){this.ramain_time&&(this.time_tichet&&(gcore.Timer.del(this.time_tichet),this.time_tichet=null),t>0?(this.setTimeFormatString(t),this.time_tichet=gcore.Timer.set(function(){--t<0?(gcore.Timer.del(this.time_tichet),this.time_tichet=null,this.ramain_time.string="00:00:00"):this.setTimeFormatString(t)}.bind(this),1e3,-1)):this.setTimeFormatString(t))},setTimeFormatString:function(t){this.ramain_time.string=t>0?a.getTimeFormatDay(t):"00:00:00"},levelBoxStatus:function(t,e){if(this.cur_box_status!=t){this.cur_box_status=t;var i=this.getBoxRewardID(e);if(this.loadRes(s.getUIIconPath("limitexercise","limitexercise_box"+i),function(t){this.box_sprite.spriteFrame=t}.bind(this)),1==t){this.box_sprite.node.stopAllActions();var n=cc.rotateTo(.1,10),a=cc.rotateTo(.1,-10),o=cc.rotateTo(.1,0),l=cc.sequence(n,a,n,a,n,a,o,cc.delayTime(1)),r=cc.repeatForever(l);this.box_sprite.node.runAction(r)}else 2==t&&this.box_sprite.node.stopAllActions()}},getBoxRewardID:function(t){var e=this.model.getCurrentDiff(t),i=1;if(this.reward_list[e])for(var s=1;s<=3;++s)t<=this.reward_list[e][1].order_id?i=1:t>this.reward_list[e][1].order_id&&t<=this.reward_list[e][2].order_id?i=2:t>this.reward_list[e][2].order_id&&(i=3);return i},showBossMessageItem:function(t){var e=this.model.getCurrentRound();if(t=t||1,this.item_scrollview&&this.change_boss_list[e]&&this.change_boss_list[e][t]){for(var i in this.area_list=[],this.change_boss_list[e][t]){var s=this.change_boss_list[e][t][i];this.area_list.push(s)}cc.log(this.area_list);var n=this.model.getCurrentType(),a=1;n&&(a=n),this.item_scrollview.content.y=-568*(a-1),this.sroll_main_spr.y=this.left_scrollview_pos[a]}this.createAreaList()},getLevelMessage:function(t,e){if(t=t||1,e=e||this.model.getCurrentChangeID(),this.cur_order_type!=t||this.cur_order_id!=e){var i=this.model.getCurrentRound(),s=this.model.getCurrentDiff();if(i){if(this.level_area_text.string=o.type[t],this.change_boss_list[i]&&this.change_boss_list[i][s]){var n=this.change_boss_list[i][s];if(e>=15&&(e=15),n[t]&&n[t][e]){var a=n[t][e].order_id;this.level_text.string=Utils.TI18N("\u7b2c")+a+Utils.TI18N("\u5173"),a==this.model.getCurrentChangeID()?(this.btn_change_btn.interactable=!0,this.btn_change_btn.enableAutoGrayEffect=!1,this.change_outline.enabled=!0):(this.btn_change_btn.interactable=!1,this.btn_change_btn.enableAutoGrayEffect=!0,this.change_outline.enabled=!1);for(var l="",r=n[t][e].add_skill_decs||[],c=0;c<r.length;++c)l=l+r[c]+"\n";this.level_effect_desc.string=l;var _=n[t][e].power||0;if(this.power.string=Utils.TI18N("\u63a8\u8350\u6218\u529b\uff1a")+_,this.cur_order_type!=t){var h=this.getBoxRewardID(e);if(this.reward_list[s]&&this.reward_list[s][h]){var d=this.reward_list[s][h].reward||[],u={scale:.6,max_count:3,is_center:!0,show_effect_id:263};this.level_item_list=Utils.commonShowSingleRowItemList(this.change_item,this.level_item_list,d,u,this.change_item_content)}}}}this.cur_order_type=t,this.cur_order_id=e}}},onCellTouched:function(t,e,i,n){if(null==this.touch_kuang){this.touch_kuang=new cc.Node;var a=this.touch_kuang.addComponent(cc.Sprite);a.type=cc.Sprite.Type.SLICED,a.sizeMode=cc.Sprite.SizeMode.CUSTOM,this.touch_kuang.setContentSize(110,110),this.item_scrollview.content.addChild(this.touch_kuang,99),this.loadRes(s.getUIIconPath("common","common_90019"),function(t){a.spriteFrame=t}.bind(this))}var o=t.getBtnMaster(n);if(o){var l=o.convertToWorldSpaceAR(cc.v2(0,0)),r=this.item_scrollview.content.convertToNodeSpace(l);this.touch_kuang.setPosition(r.x-25,r.y-4)}this.getLevelMessage(e,i)},updateSlideShowByVertical:function(){var t=this.item_scrollview.content.y;if(this.item_scrollview){var e=this.getCurrentPos(Math.abs(t));this.scrollviewSprintBar(e),this.level_area_text.string=o.type[e]}},getCurrentPos:function(t){var e=1;return t>=this.pos_interval[0][0]&&t<=this.pos_interval[0][1]?e=1:t>=this.pos_interval[1][0]&&t<=this.pos_interval[1][1]?e=2:t>=this.pos_interval[2][0]&&t<=this.pos_interval[2][1]&&(e=3),e},scrollviewSprintBar:function(t){if(this.scrollview_bar!=t){this.scrollview_bar=t,this.sroll_main_spr.stopAllActions();var e=cc.fadeOut(.3),i=cc.fadeIn(.3),s=cc.moveTo(.1,cc.v2(-319,this.left_scrollview_pos[t])),n=cc.scaleTo(.1,1.2),a=cc.scaleTo(.1,1),o=cc.spawn(i,s),l=cc.sequence(e,o,n,a);this.sroll_main_spr.runAction(l)}},setItemIndex:function(){},closeCallBack:function(){if(this.time_tichet&&(gcore.Timer.del(this.time_tichet),this.time_tichet=null),this.timer&&(this.stopUpdate(this.timer),this.timer=null),this.item_list_panel){for(var t=0;t<this.item_list_panel.length;++t)this.item_list_panel[t]&&(this.item_list_panel[t].deleteMe(),this.item_list_panel[t]=null);this.item_list_panel=null}if(this.level_item_list){for(var e=0;e<this.level_item_list.length;++e)this.level_item_list[e]&&(this.level_item_list[e].deleteMe(),this.level_item_list[e]=null);this.level_item_list=null}this.ctrl.openLimitExerciseChangeView(!1)}});cc._RF.pop()},{commonalert:"commonalert",hero_controller:"hero_controller",limitExercise_const:"limitExercise_const",limitexercise_change_item_panel:"limitexercise_change_item_panel",limitexercise_event:"limitexercise_event",mainui_controller:"mainui_controller",partner_const:"partner_const",pathtool:"pathtool",timetool:"timetool"}],limitexercise_controller:[function(t,e,i){"use strict";cc._RF.push(e,"f8a8cOctShCb5V2PuPgXYZN","limitexercise_controller");var s=t("limitexercise_event"),n=cc.Class({extends:BaseController,ctor:function(){},initConfig:function(){var e=t("limitexercise_model");this.model=new e,this.model.initConfig()},getModel:function(){return this.model},registerEvents:function(){},registerProtocals:function(){this.RegisterProtocal(25410,this.handle25410),this.RegisterProtocal(25411,this.handle25411),this.RegisterProtocal(25412,this.handle25412),this.RegisterProtocal(25413,this.handle25413),this.RegisterProtocal(25414,this.handle25414)},send25410:function(){this.SendProtocal(25410,{})},handle25410:function(t){this.model.setLimitExerciseData(t),gcore.GlobalEvent.fire(s.LimitExercise_Message_Event,t)},send25411:function(){this.SendProtocal(25411,{})},handle25411:function(t){message(t.msg),1==t.code&&(this.model.setChangeCount(t.count,t.buy_count),this.touch_buy_change&&1==t.count&&this.send25413(),this.touch_buy_change=null,gcore.GlobalEvent.fire(s.LimitExercise_BuyCount_Event,t))},checkJoinFight:function(){var e=Config.holiday_boss_new_data.data_const;if(e){var i=e.fight_buy_max_count.val,s=this.model.getDayBuyCount(),n=this.model.getReaminCount();if(s>=i&&0==n)message(Utils.TI18N("\u4eca\u65e5\u6b21\u6570\u5df2\u7528\u5b8c~~"));else if(n<=0){var a=t("commonalert"),o=cc.js.formatStr("\u662f\u5426\u82b1\u8d39<img src='%s' scale=0.3 />%s\u8d2d\u4e70\u4e00\u6b21\u6311\u6218\u6b21\u6570\uff1f",Config.item_data.data_assets_label2id.gold,e.action_num_espensive.val),l=PathTool.getItemRes(Config.item_data.data_assets_label2id.gold),r=function(){this.touch_buy_change=!0,this.send25411()}.bind(this);a.show(o,Utils.TI18N("\u786e\u8ba4"),r,Utils.TI18N("\u53d6\u6d88"),null,2,null,{resArr:[l]})}else this.send25413()}},send25412:function(){this.SendProtocal(25412,{})},handle25412:function(t){message(t.msg),gcore.GlobalEvent.fire(s.LimitExercise_GetBox_Event,t)},send25413:function(){this.SendProtocal(25413,{})},handle25413:function(e){(message(e.msg),1==e.code)&&t("hero_controller").getInstance().openFormGoFightPanel(!1)},send25414:function(){this.SendProtocal(25414,{})},handle25414:function(t){this.model.setHeroUseId(t.p_list)},openLimitExerciseChangeView:function(e){if(1==e){if(!this.limit_exercise_view){var i=t("limitexercise_change_window");this.limit_exercise_view=new i(this)}this.limit_exercise_view.open()}else this.limit_exercise_view&&(this.limit_exercise_view.close(),this.limit_exercise_view=null)},openLimitExerciseRewardView:function(e){if(1==e){if(!this.open_reward_view){var i=t("limitexercise_reward_window");this.open_reward_view=new i(this)}this.open_reward_view.open()}else this.open_reward_view&&(this.open_reward_view.close(),this.open_reward_view=null)}});e.exports=n,cc._RF.pop()},{commonalert:"commonalert",hero_controller:"hero_controller",limitexercise_change_window:"limitexercise_change_window",limitexercise_event:"limitexercise_event",limitexercise_model:"limitexercise_model",limitexercise_reward_window:"limitexercise_reward_window"}],limitexercise_event:[function(t,e,i){"use strict";cc._RF.push(e,"2542dkY7vNFoaKwpFATm5Qi","limitexercise_event");var s={LimitExercise_Message_Event:"LimitExerciseEvent.LimitExercise_Message_Event",LimitExercise_GetBox_Event:"LimitExerciseEvent.LimitExercise_GetBox_Event",LimitExercise_BuyCount_Event:"LimitExerciseEvent.LimitExercise_BuyCount_Event"};e.exports=s,cc._RF.pop()},{}],limitexercise_hero_item_panel:[function(t,e,i){"use strict";cc._RF.push(e,"30ae2x2Ci9Ix7MLq2kzW8+N","limitexercise_hero_item_panel");var s=t("pathtool");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("limitexercise","hero_exhibition_item"),this.scale=arguments[0]||1},initConfig:function(){},initPanel:function(){this.root_wnd.scale=this.scale,this.head_icon_sp=this.seekChild("head_icon",cc.Sprite),this.background_sp=this.seekChild("background",cc.Sprite),this.level_lb=this.seekChild("level",cc.Label)},registerEvent:function(){this.root_wnd.on(cc.Node.EventType.TOUCH_END,function(){Utils.playButtonSound(1),this.click_cb&&this.click_cb()},this)},onShow:function(t){},onHide:function(){},setHeadImg:function(t){var e=s.getHeadRes(t);this.loadRes(e,function(t){this.head_icon_sp.spriteFrame=t}.bind(this))},setQualityImg:function(t){var e=s.getItemQualityBG(t),i=s.getCommonIcomPath(e);this.loadRes(i,function(t){this.background_sp.spriteFrame=t}.bind(this))},setLev:function(t){this.level_lb.string=t.toString()},addCallBack:function(t){this.click_cb=t},onDelete:function(){}});cc._RF.pop()},{pathtool:"pathtool"}],limitexercise_model:[function(t,e,i){"use strict";cc._RF.push(e,"bf36fCSxdRFY7OOT091JucG","limitexercise_model");cc.Class({extends:BaseClass,ctor:function(){},properties:{},initConfig:function(){},getCurrentRound:function(){if(this.limitexercise_data&&this.limitexercise_data.round){var t=Config.holiday_boss_new_data.data_round_list;if(t&&t[this.limitexercise_data.round])return t[this.limitexercise_data.round].unit_round}return 1},setLimitExerciseData:function(t){this.limitexercise_data=t},setChangeCount:function(t,e){this.limitexercise_data&&null!=this.limitexercise_data.count&&null!=this.limitexercise_data.buy_count&&(this.limitexercise_data.count=t,this.limitexercise_data.buy_count=e)},setHeroUseId:function(t){this.hero_use_list={};for(var e=0;e<t.length;++e){var i=t[e];this.hero_use_list[i.id]=i.count}},getHeroUseId:function(t){return this.hero_use_list&&this.hero_use_list[t]?this.hero_use_list[t]:0},getCurrentDiff:function(){return this.limitexercise_data&&this.limitexercise_data.difficulty||1},getCurrentChangeID:function(){return this.limitexercise_data&&this.limitexercise_data.order||1},getCurrentBossHp:function(){return this.limitexercise_data?this.limitexercise_data.hp_per||0:null},getBoxStatus:function(){return this.limitexercise_data&&this.limitexercise_data.status||0},getCurrentType:function(){return this.limitexercise_data?this.limitexercise_data.order_type||0:null},getDayBuyCount:function(){return this.limitexercise_data&&this.limitexercise_data.buy_count||0},getReaminCount:function(){return this.limitexercise_data&&this.limitexercise_data.count||0},getLimitExerciseData:function(){return this.limitexercise_data?this.limitexercise_data:null}});cc._RF.pop()},{}],limitexercise_panel:[function(t,e,i){"use strict";cc._RF.push(e,"33039X1X11J/ZivMoWPylF6","limitexercise_panel");var s=t("pathtool"),n=t("limitexercise_controller"),a=t("limitexercise_event"),o=t("limitExercise_const"),l=t("timetool");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("limitexercise","limitexercise_panel"),this.holiday_bid=arguments[0],this.ctrl=n.getInstance()},initConfig:function(){},initPanel:function(){var t=this.getPositionX();this.setPosition(t,-20);var e=this.root_wnd.getChildByName("main_container"),i=e.getChildByName("bg").getComponent(cc.Sprite),n=s.getUIIconPath("bigbg/limitexercise","txt_cn_limit_exercise");this.loadRes(n,function(t){i.spriteFrame=t}.bind(this)),e.getChildByName("Text_1").getComponent(cc.Label).string=Utils.TI18N("\u6d3b\u52a8\u65f6\u95f4\uff1a"),this.btn_change=e.getChildByName("btn_change"),this.btn_change.getChildByName("Text_4").getComponent(cc.Label).string=Utils.TI18N("\u524d\u5f80\u6311\u6218"),e.getChildByName("Text_1_0").getComponent(cc.Label).string=Utils.TI18N("\u5269\u4f59\u6b21\u6570:"),e.getChildByName("Text_2").getComponent(cc.Label).string=Utils.TI18N("\u672c\u8f6e\u5269\u4f59:"),this.round_time=e.getChildByName("round_time").getComponent(cc.Label),this.round_time.string="",e.getChildByName("Text_2_0").getComponent(cc.Label).string=Utils.TI18N("\u6240\u5728\u533a\u57df:"),e.getChildByName("Text_2_0_0").getComponent(cc.Label).string=Utils.TI18N("\u6311\u6218\u6b21\u6570:"),e.getChildByName("Text_2_0_1").getComponent(cc.Label).string=Utils.TI18N("\u51fb\u8d25\u602a\u7269:"),this.aera_text=e.getChildByName("aera_text").getComponent(cc.Label),this.aera_text.string="",this.change_count=e.getChildByName("change_count").getComponent(cc.Label),this.change_count.string="",this.defaet_master=e.getChildByName("defaet_master").getComponent(cc.Label),this.defaet_master.string="",this.item_count=e.getChildByName("item_count").getComponent(cc.Label),this.item_count.string="",this.remain_time=e.getChildByName("remain_time").getComponent(cc.Label),this.remain_time.string="",this.goods_con=e.getChildByName("goods_con"),this.goods_con_content=this.goods_con.getChildByName("content"),this.setData(),this.ctrl.send25410()},registerEvent:function(){this.addGlobalEvent(a.LimitExercise_Message_Event,function(t){t&&this.actionHolidayData(t)}.bind(this)),this.addGlobalEvent(a.LimitExercise_BuyCount_Event,function(t){t&&this.item_count&&(this.item_count.string=t.count||0)}.bind(this)),this.btn_change.on("click",function(){var e=t("mainui_controller"),i=t("battle_const");e.getInstance().requestOpenBattleRelevanceWindow(i.Fight_Type.LimitExercise),Utils.playButtonSound(1)},this)},onShow:function(t){},onHide:function(){},setVisibleStatus:function(t){t=t||!1,this.setVisible(t)},setData:function(){var t=Config.holiday_boss_new_data.data_const;if(t){if(t.action_time){var e=t.action_time.desc||"";this.remain_time.string=e}if(t.action_pre_reward){var i=t.action_pre_reward.val||[],s={scale:.9,max_count:4,is_center:!0,show_effect_id:263};this.item_list=Utils.commonShowSingleRowItemList(this.goods_con,this.item_list,i,s,this.goods_con_content)}}},actionHolidayData:function(t){var e=t.endtime||0;this.setCountDownTime(this.round_time,e-gcore.SmartSocket.getTime()),this.item_count.string=t.count||0,this.aera_text.string=Utils.TI18N(o.type[t.order_type||1]),this.change_count.string=t.round_combat||0,this.defaet_master.string=t.round_boss||0},setCountDownTime:function(t,e){t&&(this.time_tichet&&(gcore.Timer.del(this.time_tichet),this.time_tichet=null),e>0?(this.setTimeFormatString(t,e),this.time_tichet=gcore.Timer.set(function(){--e<0?(gcore.Timer.del(this.time_tichet),this.time_tichet=null,t.string="00:00:00"):this.setTimeFormatString(t,e)}.bind(this),1e3,-1)):this.setTimeFormatString(t,e))},setTimeFormatString:function(t,e){t.string=e>0?l.getTimeFormatDay(e):"00:00:00"},onDelete:function(){if(this.time_tichet&&(gcore.Timer.del(this.time_tichet),this.time_tichet=null),this.item_list){for(var t=0;t<this.item_list.length;++t)this.item_list[t]&&(this.item_list[t].deleteMe(),this.item_list[t]=null);this.item_list=null}}});cc._RF.pop()},{battle_const:"battle_const",limitExercise_const:"limitExercise_const",limitexercise_controller:"limitexercise_controller",limitexercise_event:"limitexercise_event",mainui_controller:"mainui_controller",pathtool:"pathtool",timetool:"timetool"}],limitexercise_reward_window:[function(t,e,i){"use strict";cc._RF.push(e,"c71aey4g2FN4YMVxS+TjXEn","limitexercise_reward_window");var s=t("pathtool"),n=t("limit_exercise_reward_item_panel");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("limitexercise","reward_window"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Mini,this.ctrl=arguments[0]},initConfig:function(){this.length=Config.holiday_boss_new_data.data_lev_reward_list_length,this.lev_reward_list=Config.holiday_boss_new_data.data_lev_reward_list,this.item_list=[],this.item_list_panel=[]},openCallBack:function(){this.background=this.root_wnd.getChildByName("background");var t=this.root_wnd.getChildByName("main_container");t.getChildByName("Image_2").getChildByName("Text_1").getComponent(cc.Label).string=Utils.TI18N("\u5956\u52b1\u8be6\u60c5"),this.name=t.getChildByName("name").getComponent(cc.Label),this.name.string="",this.btn_left=t.getChildByName("btn_left"),this.btn_right=t.getChildByName("btn_right"),t.getChildByName("Text_3").getComponent(cc.Label).string=Utils.TI18N("\u901a\u5173boss\u5173\u5361\u5373\u53ef\u5347\u7ea7\u7ed3\u7b97\u5956\u52b1\uff0c\u5b8c\u6210\u6240\u6709\u5173\u5361\u53ef\u76f4\u63a5\u83b7\u5f97\n\u5f53\u671f\u5956\u52b1\u3002\u82e5\u672a\u5b8c\u6210\u6240\u6709\u5173\u5361\uff0c\u5956\u52b1\u4f1a\u5728\u672c\u671f\u7ed3\u675f\u65f6\u90ae\u4ef6\u53d1\u653e"),this.item_scrollview=t.getChildByName("item_scrollview").getComponent(cc.ScrollView),this.btn_close=t.getChildByName("btn_close")},registerEvent:function(){this.background.on("touchend",function(){this.ctrl.openLimitExerciseRewardView(!1),Utils.playButtonSound(2)},this),this.background.on("touchend",function(){this.ctrl.openLimitExerciseRewardView(!1),Utils.playButtonSound(2)},this),this.btn_close.on("click",function(){this.ctrl.openLimitExerciseRewardView(!1),Utils.playButtonSound(2)},this),this.btn_left.on("click",function(){this.show_minus(),Utils.playButtonSound(3)},this),this.btn_right.on("click",function(){this.show_add(),Utils.playButtonSound(3)},this)},openRootWnd:function(t){this.cur_index=this.ctrl.getModel().getCurrentDiff(),this.dropItem(this.cur_index)},dropItem:function(t){if((t=t||0)>=this.length+1)return this.cur_index=this.length,void message(Utils.TI18N("\u5df2\u7ecf\u662f\u6700\u5927\u7b49\u7ea7\u5566~~~~"));if(t<=0)return this.cur_index=1,void message(Utils.TI18N("\u5df2\u7ecf\u662f\u6700\u5c0f\u7b49\u7ea7\u5566~~~~"));if(this.name.string=Utils.TI18N("\u96be\u5ea6 ")+t,t>=this.length&&(t=this.length),t<=0&&(t=1),this.lev_reward_list[t]){var e=[];for(var i in this.lev_reward_list[t])e.push(this.lev_reward_list[t][i]);if(e.sort(function(t,e){return t.order_id-e.order_id}),0==this.item_list.length)this.item_list=e,this.timer=this.startUpdate(this.item_list.length,function(t){var e=this.createAreaChangeCell();e.setPosition(0,-144*t),e.setData(this.item_list[t]),this.item_list_panel.push(e)}.bind(this),100);else{this.item_list=e;for(var s=0;s<this.item_list.length;++s){var n=this.item_list_panel[s];n||(n=this.createAreaChangeCell(),this.item_list_panel[s]=n),this.item_list_panel[s].setData(this.item_list[s])}}this.item_scrollview.content.height=144*this.item_list.length}},createAreaChangeCell:function(){var t=new n;return t.setParent(this.item_scrollview.content),t.show(),t},show_minus:function(){this.cur_index=this.cur_index-1,this.dropItem(this.cur_index)},show_add:function(){this.cur_index=this.cur_index+1,this.dropItem(this.cur_index)},closeCallBack:function(){if(this.item_list_panel){for(var t=0;t<this.item_list_panel.length;++t)this.item_list_panel[t]&&(this.item_list_panel[t].deleteMe(),this.item_list_panel[t]=null);this.item_list_panel=null}this.timer&&(this.stopUpdate(this.timer),this.timer=null),this.ctrl.openLimitExerciseRewardView(!1)}});cc._RF.pop()},{limit_exercise_reward_item_panel:"limit_exercise_reward_item_panel",pathtool:"pathtool"}],loadermanager:[function(t,e,i){"use strict";cc._RF.push(e,"d22c81wFEpPQq3vcJUA0bsW","loadermanager");t("fileinfo");var s=t("ZipLoader"),n=(t("pathtool"),t("downloadmanager"),t("spine_loading_item"));window.LoaderManager=cc.Class({properties:{resources_list:{default:{}},data_list:{default:{}},reference_key_counter:{default:{}},skeleton_counter:{default:{}},spine_counter:{default:{}},release_sqe:{default:{}},loading_spines:{default:{}},_sprite_frame_cache:{default:{}},_prefab_time:0,is_loading:!1},ctor:function(){this.mainloop_timer=gcore.Timer.set(function(){this.update(1)}.bind(this),1e3,-1)},statics:{instance:null},update:function(t){this._prefab_time+=1,this._prefab_time>=60&&(this.is_loading||(cc.log("\u5f00\u59cb\u91ca\u653e\u6ca1\u7528\u7684\u9884\u8bbe\u8d44\u6e90"),this.clearRes(),this._prefab_time=0))},loadRes:function(t,e){if(null!=t){var i=this.getResInfo(t);switch(i.load_type){case cc.Prefab:this.loadPrefab(i.str_key,e);break;case cc.SpriteAtlas:this.loadAtlas(i.str_key,e);break;case sp.SkeletonData:this.loadSpine(i.str_key,e);break;default:this.loadUsuallyRes(i.str_key,e,i.load_type)}}},releaseRes:function(t){if(null!=t){var e=this.getResInfo(t);switch(e.load_type){case cc.Prefab:this.releasePrefab(e.str_key);break;case cc.SpriteAtlas:this.releaseAtlas(e.str_key);break;case sp.SkeletonData:this.releaseSpine(e.str_key);break;default:this.releaseUsuallyRes(e.str_key,e.load_type)}}},loadUsuallyRes:function(t,e,i){return t.indexOf("ui_res")>-1?(this.is_loading=!0,void cc.loader.loadRes(t,i,function(t,i,s){if(!i&&s){var n=cc.loader.getDependsRecursively(s);for(var a in n)this.countReference(n[a]);e(s)}else cc.error(i,"load usuallyRes faild---\x3e"+t);this.is_loading=!1}.bind(this,t))):this._sprite_frame_cache[t]?void e(this._sprite_frame_cache[t]):this.resources_list[t]&&this.resources_list[t].obj?(this.resources_list[t].count++,void e(this.resources_list[t].obj)):void cc.loader.loadRes(t,i,function(t,i,s){i?cc.error(i,"load usuallyRes faild---\x3e"+t):(this.resources_list[t]||(this.resources_list[t]={},this.resources_list[t].obj=s,this.resources_list[t].count=0),this.resources_list[t].count++,e(s))}.bind(this,t))},releaseUsuallyRes:function(t,e){this._sprite_frame_cache[t]||t.indexOf("ui_res")>-1||this.resources_list[t]&&--this.resources_list[t].count},loadAtlas:function(t,e){var i=cc.loader.getRes(t,cc.SpriteAtlas);if(i)return this.countReference(i),void e(i);cc.loader.loadRes(t,cc.SpriteAtlas,function(t,i,s){if(t)for(var n in cacheAtlas)if(cacheAtlas[n]==t){var a=s.getSpriteFrames();for(var o in a){var l=a[o],r="res/item/"+l.name;this._sprite_frame_cache[r]=l}break}!i&&e?(this.countReference(s),e(s)):cc.error(i,"load preafa faild---\x3e"+t)}.bind(this,t))},releaseAtlas:function(t){var e=cc.loader.getRes(t);e&&this.countReference(e,-1)},loadSpine:function(t,e){if(t)if(window.OUT_SPINE){var i=t.split("/"),s=i.pop(),a=i.pop();new n(a,s,e)}else this.release_sqe[t]&&(delete this.release_sqe[t],this.spine_counter[t]=0),this.loading_spines[t]||(this.loading_spines[t]=!0),cc.loader.loadRes(t,sp.SkeletonData,function(t,i,s){i?(e(),cc.error(i,"load spine faild---\x3e"+t)):(this.spine_counter[t]>0?this.spine_counter[t]+=1:this.spine_counter[t]=1,e(s),this.loading_spines[t]&&delete this.loading_spines[t])}.bind(this,t))},releaseSpine:function(t){},delteSpine:function(t){this.releseSpienRes(t)},releseSpienRes:function(t){if(!this.loading_spines[t]){var e=cc.loader.getRes(t,sp.SkeletonData);cc.loader.getRes(t,cc.SpriteAtlas);if(e){var i=cc.loader.getDependsRecursively(e);for(var s in i){var n=cc.loader.getRes(i[s]);cc.loader.release(n)}cc.loader.release(e)}}},countReference:function(t,e){var i;t&&(e=void 0===e?1:e,i=t,this.reference_key_counter[i]||(this.reference_key_counter[i]=0),this.reference_key_counter[i]+=e)},clearRes:function(){for(var t in this.reference_key_counter)this.reference_key_counter[t]||(this.reference_key_counter[t]=0),this.reference_key_counter[t]<=0&&(cc.loader.release(t),delete this.reference_key_counter[t]);for(var e in this.resources_list)if(this.resources_list[e].count<=0){var i=cc.loader.getDependsRecursively(this.resources_list[e].obj);cc.loader.release(i),delete this.resources_list[e]}},releaseByReferenceKey:function(t){},loadPrefab:function(e,i){if(window.PREFAB_BUILD){var s=e.split("/"),n=s.pop()+"_p",a=s.pop()+"_"+n;cc.loader.loadRes("prefabjs/"+a,cc.JsonAsset,function(e,s,n){var a=new(t(e))(n.json);i(a.node)}.bind(this,a))}else CC_SUPPORT_JIT=!1,this.is_loading=!0,cc.loader.loadRes(e,cc.Prefab,function(t,s){if(CC_SUPPORT_JIT=!0,t)i&&i(),cc.error(t,"load preafa faild---\x3e"+e);else if(i&&!game.preload_loading||"prefab/drama/guide_main_view"==e){var n=cc.loader.getDependsRecursively(s);for(var a in n)this.countReference(n[a]);i(cc.instantiate(s))}this.is_loading=!1}.bind(this))},releasePrefab:function(t){var e=cc.loader.getRes(t),i=cc.loader.getDependsRecursively(e);for(var s in i){e=cc.loader.getRes(i[s]);this.countReference(i[s],-1)}},deleteRes:function(t){this.releaseRes(t)},getResInfo:function(t){var e=t.indexOf("."),i=t.length,s=t.substring(0,e),n=t.substring(e,i),a=this.getAssetsTypeSuffix(n),o={};return o.str_key=s,o.load_type=a,o},getAssetsTypeSuffix:function(t){switch(t){case".jpg":case".png":return cc.SpriteFrame;case".plist":return cc.SpriteAtlas;case".mp3":return cc.AudioClip;case".atlas":return sp.SkeletonData;case".prefab":return cc.Prefab}},initConfigs:function(e){if(window.DEBUG_Data)for(var i=t("modulelist"),n=gcore.SmartSocket.getTime(),a=0,o=0;o<i.data_list.length;o++){var l="https://dev-h5-sszg.shiyuegame.com/data/"+i.data_list[o]+".json?time="+n;cc.loader.load(l,function(t,s,n){a++,s||(Config[t]=n),a==i.data_list.length?e():e(a/i.data_list.length)}.bind(this,i.data_list[o]))}else if(window.DEBUG){var r=(i=t("modulelist")).data_list.length,c=0;for(o=0;o<i.data_list.length;o++){var _="data/"+i.data_list[o];gcore.Timer.set(function(t,s){cc.loader.loadRes(t,cc.JsonAsset,function(t,i,s){Config[t]=s.json,c++,cc.log(t,Config[t]),c==r?e():e(c/r)}.bind(this,i.data_list[s]))}.bind(this,_,o),20*o,1)}}else if("WX_SDK"==PLATFORM_TYPR||"SH_SDK"==PLATFORM_TYPR||"QQ_SDK"==PLATFORM_TYPR)for(r=(i=t("modulelist")).data_list.length,c=0,o=0;o<i.data_list.length;o++){_="data/"+i.data_list[o];gcore.Timer.set(function(t,s){cc.loader.loadRes(t,cc.JsonAsset,function(t,i,s){Config[t]=s.json,c++,cc.log(Config),c==r?e():e(c/r)}.bind(this,i.data_list[s]))}.bind(this,_,o),20*o,1)}else{s.RegisterZipLoader();_=cc.url.raw("resources/data/data.zip");cc.log(_),cc.loader.load(_,function(i,s){var n=t("jszip");if(s=new n(s,{checkCRC32:!1})){var a=0;for(var o in s.files)a++,gcore.Timer.set(function(t,i){cc.log(t),cc.log(t.substring(t.length-4,t.length));var n=JSON.parse(s.files[t].asText()),o=t.substring(0,t.length-5);Config[o]=n,"main_scene_data"==o&&cc.log(JSON.stringify(n)),e(i/66),i>=a&&i>0&&e&&e()}.bind(this,o,a),20*a,1)}}.bind(this))}},initConfigScript:function(t){if(window.USE_MERGE_JSON){var e="src/merge_json"+(window.PACKAGE_VERSION||"")+".js";console.log("___json==>",e),cc.loader.load(e,function(t,e){e&&console.log("\u52a0\u8f7dmerge\u6210\u529f"),t&&(console.log("\u52a0\u8f7dmerge_json\u5931\u8d25"),console.log(t))})}}}),LoaderManager.getInstance=function(){return LoaderManager.instance||(LoaderManager.instance=new LoaderManager),LoaderManager.instance},e.exports=LoaderManager,cc._RF.pop()},{ZipLoader:"ZipLoader",downloadmanager:"downloadmanager",fileinfo:"fileinfo",jszip:"jszip",modulelist:"modulelist",pathtool:"pathtool",spine_loading_item:"spine_loading_item"}],login_controller:[function(t,e,i){"use strict";cc._RF.push(e,"859a9X1XhRJLaXkg0bNqr0N","login_controller");var s=t("login_event"),n=t("role_controller"),a=t("login_platform"),o=cc.Class({extends:BaseController,ctor:function(){},initConfig:function(){this.finish_loading=!1;var e=t("login_model");this.model=new e,this.model.initConfig(),this.enable_relogin=!0},registerEvents:function(){gcore.GlobalEvent.bind(s.LOGIN_EVENT_ACCOUNT_LOGIN_SUCCESS,function(){this.model.requestDefaultServer()}.bind(this)),gcore.GlobalEvent.bind(s.LOGIN_EVENT_DEFSERVER_SUCCESS,function(){}.bind(this)),gcore.GlobalEvent.bind(gcore.GlobalEvent.EVT_SOCKET_CONNECT,function(){this.enable_relogin=!0,this.reconnect_timer&&(gcore.Timer.del(this.reconnect_timer),this.reconnect_timer=null,game.updateWaitingStatus()),USE_SDK?SDK.loginGame():this.login()}.bind(this)),gcore.GlobalEvent.bind(gcore.GlobalEvent.EVT_SOCKET_DISCONNECT,function(){this.reconnectServer()}.bind(this))},registerProtocals:function(){this.RegisterProtocal(1110,this.on1110),this.RegisterProtocal(10310,this.on10310),this.RegisterProtocal(10101,this.on10101),this.RegisterProtocal(10102,this.on10102),this.RegisterProtocal(10103,this.on10103)},getModel:function(){return this.model},openLoginWindow:function(e){if(e&&e.status){var i=t("login_window");null==this.login_window&&(this.login_window=new i),this.login_window.open(e)}else this.login_window&&(this.finish_loading=!1,game.updateLoadingStatus(!0),gcore.GlobalEvent.fire(EventId.LOADING_FINISH),this.login_window.close(),this.login_window=null)},getTestAccount:function(){if(this.login_window)return this.login_window.getTestAccount()},changeLoginWindowIndex:function(t){this.login_window&&this.login_window.changeSubPanel(t)},connectServer:function(t,e,i){if(NO_SOCKET)this.openLoginWindow(!1);else{var s=this.model.getLoginInfo();t=t||s.host,e=e||s.port,i=i||s.ws,cc.log("\u5efa\u7acbsocket\u94fe\u63a5"),cc.log(s),t&&e?gcore.SmartSocket.connect(t,e,i):message("\u670d\u52a1\u5668\u5730\u5740\u4fe1\u606f\u9519\u8bef")}},reconnectServer:function(){!this.reconnect_timer&&this.enable_relogin&&(this.reconnect_timer=gcore.Timer.set(this.connectServer.bind(this),3e3,-1),game.updateWaitingStatus(WaitingStaus.CONNECT))},login:function(){var t=[{key:"account",val:this.model.getLoginInfo().account},{key:"channel",val:CHANNEL},{key:"idfa",val:"windows"}];this.SendProtocal(1110,{args:t})},sdkLogin:function(){var e={},i=this.model.getLoginData().usrName||"",s=this.model.getLoginData().srv_id||"",n=a.getInstance().getTimestamp(),o=a.getInstance().getToken(),l=a.getInstance().getSign(),r=a.getInstance().getChannel();i=r+"_"+i;var c=a.getInstance().getFinalChannel(),_=GAME_NAME,h=GAME_NAME,d=i+"nicaimeiyou"+r+"meiyoufalse",u=t("md5.min")(d);u=u.toLowerCase(),e.args=[{key:"account",val:i},{key:"timestamp",val:n},{key:"enter_srv_id",val:s},{key:"platform",val:PLATFORM_NAME},{key:"device_id",val:"nicai"},{key:"device_type",val:""},{key:"gettui_cid",val:"meiyou"},{key:"idfa",val:"meiyou"},{key:"token",val:o},{key:"channel",val:c},{key:"sign",val:l},{key:"logsign",val:u},{key:"os_ver",os_ver:""},{key:"carrier_name",val:""},{key:"net_type",val:""},{key:"os",val:"os"},{key:"emulator",val:"false"},{key:"app_name",val:_},{key:"package_name",val:h},{key:"package_version",val:"1.0.1"}],this.SendProtocal(1110,e)},cusSDKLogin:function(e){if(e){var i=this.model.getLoginData().srv_id||"",s=e.account,n=e.rawData,a=e.signature,o=e.channel,l=e.package_name,r=e.package_version,c=e.platform,_=e.token||"",h=e.timestamp||"",d=e.sign||"",u=s+""+o,m=t("md5.min")(u);m=m.toLowerCase();var f={};f.args=[{key:"account",val:s},{key:"enter_srv_id",val:i},{key:"platform",val:c},{key:"device_id",val:""},{key:"gettui_cid",val:""},{key:"idfa",val:""},{key:"channel",val:o},{key:"logsign",val:m},{key:"emulator",val:""},{key:"app_name",val:""},{key:"package_name",val:l},{key:"package_version",val:r},{key:"rawData",val:n},{key:"signature",val:a},{key:"token",val:_},{key:"timestamp",val:h},{key:"sign",val:d}],cc.log(f),this.SendProtocal(1110,f)}},cusSDKLogin_2:function(e){if(e){var i=this.model.getLoginData().srv_id||"",s=e.account+""+e.channel,n=t("md5.min")(s),a=[{key:"enter_srv_id",val:i},{key:"device_id",val:""},{key:"gettui_cid",val:""},{key:"idfa",val:""},{key:"logsign",val:n=n.toLowerCase()},{key:"emulator",val:""},{key:"app_name",val:""}],o={};o.args=e.concat(a),cc.log("1110--protocal==>",o),this.SendProtocal(1110,o)}},on1110:function(e){if(cc.log("1110\u767b\u5f55\u6e38\u620f\u8fd4\u56de"),cc.log(e),1==e.code){if(0==this.model.auto_login)return;if(this.model.isSocket)return void gcore.GlobalEvent.fire(s.LOGIN_EVENT_PLAYER_INFO,e);if(0==e.roles.length)this.reqCreateRole();else{var i=this.role=e.roles[0];this.reqLoginRole(i.rid,i.srv_id)}if(("WX_SDK"==PLATFORM_TYPR||"QQ_SDK"==PLATFORM_TYPR)&&USE_SDK){var n=this.model.getLoginInfo();SDK.submitLogin(n.host)}}else 4==e.code?(this.enable_relogin=!1,t("notice_controller").getInstance().openNocticeWindow(!0)):(this.enable_relogin=!1,message(e.msg))},getCurRoleInfo:function(){return this.role},on10310:function(e){this.enable_relogin=!1,gcore.SmartSocket.stopHeart(),this.reconnect_timer&&(gcore.Timer.del(this.reconnect_timer),this.reconnect_timer=null,game.updateWaitingStatus()),1==e.is_show&&message(e.msg),t("guide_controller").getInstance().setGuideMainRootWnd(!1),t("commonalert").showItemApply(Utils.TI18N("\u8be5\u8d26\u53f7\u5df2\u5728\u5176\u4ed6\u5730\u65b9\u767b\u5f55"),null,function(){game.relogin(),"SH_RH"==PLATFORM_TYPR&&SDK.logout()}.bind(this),Utils.TI18N("\u786e\u5b9a"),null,null,Utils.TI18N("\u63d0\u793a"),null,null,!0,null,null,null,null,{off_y:-18,close_off:!0})},reqCreateRole:function(){"SH_RH"==PLATFORM_TYPR||"SH_SDK"==PLATFORM_TYPR?this.SendProtocal(10101,{sex:0,name:"",career:1,playform:CHANNEL}):this.SendProtocal(10101,{sex:0,name:"",career:1,playform:PLATFORM})},on10101:function(t){1==t.code?(IS_SUBMIT&&SDK.sdkSubmitUserData(2,t),"SH_RH"==PLATFORM_TYPR&&"sh"==PLATFORM_NAME&&SDK.createRole(t),"SH_SDK"==PLATFORM_TYPR&&SDK.createRole(t),this.model.setFirstRoleData(t),this.reqLoginRole(t.rid,t.srv_id)):message(t.msg)},reqLoginRole:function(t,e){var i=this.model.getLoginInfo();i.login_rid=t,i.login_srv_id=e,cc.log(n.getInstance().init_role),n.getInstance().init_role?this.SendProtocal(10103,{rid:t,srv_id:e}):this.SendProtocal(10102,{rid:t,srv_id:e})},on10102:function(t){1==t.code?(this.login_window&&this.login_window.showLoading(),game.initConfigs(function(){this.SendProtocal(10300,{})}.bind(this)),n.getInstance().getModel().setWorldLev(t.world_lev||0)):message(t.msg),this.serverListWindow&&this.openServerList(!1)},sender10300:function(){this.SendProtocal(10300,{})},on10103:function(e){1==e.code?(t("role_controller").getInstance().setReconnect(!0),this.SendProtocal(10300,{})):message(e.msg)},openServerList:function(e,i,s){if(e){if(!this.serverListWindow){var n=t("server_list_window");this.serverListWindow=new n}this.serverListWindow.open(i),this.serverListWindow.addCallBack(s)}else this.serverListWindow&&(this.serverListWindow.close(),this.serverListWindow=null)},updateLoading:function(t){this.login_window&&this.login_window.updateLoading(t)},updateSeconLoading:function(t,e){this.login_window&&this.login_window.updateSeconLoading(t,e)},loginPlatformRequest:function(t){var e=this.model.getLoginData();t.usrName!=e.usrName&&(gcore.SysEnv.set("user_name",t.usrName),gcore.SysEnv.set("password",t.password),e.usrName=t.usrName,e.password=t.password),this.loginNewUserRequest(t)},loginNewUserRequest:function(t){var e={code:1};e.accName=t.usrName,e.platform=PLATFORM_NAME,e.msg="",this.loginPlatformResult(e)},loginPlatformResult:function(t){1==t.code&&this.model.requestDefaultServerList(t.accName,t.platform)},sender10312:function(){this.SendProtocal(10312,{})}});e.exports=o,cc._RF.pop()},{commonalert:"commonalert",guide_controller:"guide_controller",login_event:"login_event",login_model:"login_model",login_platform:"login_platform",login_window:"login_window","md5.min":"md5.min",notice_controller:"notice_controller",role_controller:"role_controller",server_list_window:"server_list_window"}],login_event:[function(t,e,i){"use strict";cc._RF.push(e,"61d0ezfs/ZHAIh21xloS8rx","login_event"),e.exports={LOGIN_EVENT_ACCOUNT_LOGIN_SUCCESS:"LOGIN_EVENT_ACCOUNT_LOGIN_SUCCESS",LOGIN_EVENT_DEFSERVER_SUCCESS:"LOGIN_EVENT_DEFSERVER_SUCCESS",LOGIN_EVENT_CUR_SERVER_UPDATE:"LOGIN_EVENT_CUR_SERVER_UPDATE",DEFAULE_SERVER_SUCCESS:"LoginEvent.DEFAULE_SERVER_SUCCESS",LOGIN_EVENT_PLAYER_INFO:"LOGIN_EVENT_PLAYER_INFO"},cc._RF.pop()},{}],login_model:[function(t,e,i){"use strict";var s,n;function a(t){"@babel/helpers - typeof";return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}cc._RF.push(e,"a9e8eXmlbpG26XbXfg4uht+","login_model");var l=t("login_event"),r=t("login_platform"),c=(o(n={},"sh",o({},"1","\u82f1\u96c4\u4e4b\u8def")),o(n,"shmix",(o(s={},"1","\u98ce\u738b\u7ed3\u754c"),o(s,"2","\u9b54\u529b\u9886\u57df"),s)),n),_=cc.Class({ctor:function(){this.server_list=[],this.login_info={},this.isSocket=!1},properties:{},initConfig:function(){this.login_info.ip="",this.login_info.port="",this.login_info.role_count="0",this.login_info.status="0",this.login_info.isNew=!1,this.login_info.isClose=!1,this.login_info.host="",this.login_info.open_time=0,this.login_info.srv_name="",this.login_info.srv_id="",this.login_info.main_srv_id="",this.login_info.rid=0,this.login_info.usrName="",this.login_info.password="",this.login_info.tuijianCareer=0,this.login_info.platform_flag="",this.login_info.usrName=gcore.SysEnv.get("user_name")||"",this.login_info.password=gcore.SysEnv.get("password")||""},getLoginInfo:function(){return this.login_info},requestDefaultServer:function(){var t=this.login_info.account||"",e="",i="srv_id"+this.login_info.usrName;console.log("---\u670d\u52a1\u5668---",i,gcore.SysEnv.get(i)),gcore.SysEnv.get(i)&&(e=gcore.SysEnv.get(i));var s=gcore.SmartSocket.getTime(),n=SERVER_LIST_URL+"?platform="+PLATFORM+"&chanleId="+CHANNEL+"&account="+t+"&srvid="+e+"&start=0&num=1&time="+s,a=SERVER_LIST_URL+"?platform="+PLATFORM+"&chanleId="+CHANNEL+"&account="+t+"&srvid="+e+"&start=0&num=0&time="+s;cc.log(a),cc.loader.load(n,function(t,e){cc.log("\u9ed8\u8ba4\u670d\u52a1\u5668\u5217\u8868");var i=JSON.parse(e);cc.log(i),this.handleDefaultServer(i),cc.loader.load(a,function(t,e){var i=JSON.parse(e);cc.log(i),this.handleAllServer(i)}.bind(this))}.bind(this))},requestDefaultServerList:function(t,e){t=t||this.loginData.usrName||"",e=e||PLATFORM_NAME,this.account=t,this.platform=e;var i="",s="srv_id"+this.login_info.usrName;console.log("---\u670d\u52a1\u5668---",s,gcore.SysEnv.get(s)),gcore.SysEnv.get(s)&&(i=gcore.SysEnv.get(s));r.getInstance().getChannel();var n=r.getInstance().getFinalChannel();n||(n=CHANNEL);var a=gcore.SmartSocket.getTime(),o=SERVER_LIST_URL+"?platform="+e+"&chanleId="+n+"&account="+t+"&srvid="+i+"&start=0&num=1&time="+a,l=SERVER_LIST_URL+"?platform="+e+"&chanleId="+n+"&account="+t+"&srvid="+i+"&start=0&num=0&time="+a;console.log("\u8bf7\u6c42\u670d\u52a1\u5668\u5217\u8868\u94fe\u63a5"+o),cc.loader.load(o,function(i,s){var n=JSON.parse(s);this.handleSDKDefaultServer(n,t,e),cc.log("\u9ed8\u8ba4\u670d\u52a1\u5668\u5217\u8868"),cc.log(n),console.log("\u9ed8\u8ba4\u670d\u52a1\u5668\u5217\u8868",n),1==USE_SDK&&"SH_SDK"==PLATFORM_TYPR&&SDK.dataPlacement(75e3),cc.loader.load(l,function(t,e){var i=JSON.parse(e);this.handleAllServer(i)}.bind(this))}.bind(this))},requestAllDefaultServerList:function(){},handleSDKDefaultServer:function(t,e,i){var s=t.data||t.msg;if("object"==a(s)&&!this.login_info.srv_name){var n=s.default_zone,o=this.convertServerInfo(n);this.setCurServer(o),gcore.GlobalEvent.fire(l.LOGIN_EVENT_DEFSERVER_SUCCESS)}},handleDefaultServer:function(t){var e=t.data||t.msg;if("object"==a(e)&&!this.login_info.srv_name){var i=e.default_zone,s=this.convertServerInfo(i);this.setCurServer(s),gcore.GlobalEvent.fire(l.LOGIN_EVENT_DEFSERVER_SUCCESS)}},handleAllServer:function(t){var e=t.data||t.msg;if("object"==a(e)){this.server_list=[];for(var i=0;i<e.server_list.length;++i){var s=Utils.deepCopy(this.convertServerInfo(e.server_list[i]));this.server_list.push(s)}}},convertServerInfo:function(t){return{srv_name:t.name||t.srv_name,srv_id:t.srv_id||t.platform+"_"+t.zone_id,ip:t.ip||t.host,host:t.host||t.ip,port:t.port,ws:t.ws||"ws",zone_id:t.zone_id,platform:t.platform,main_srv_id:t.main_srv_id,is_close:1==t.maintain,is_try:1==t.first_zone,is_new:1==Number(t.isnew),is_recomed:1==t.recomed,open_time:t.open_time||t.begin_time,roles:t.roles||[],group_num:t.group_num||1,group_id:t.group_id||1}},setCurServer:function(t){this.login_info.ip=t.ip,this.login_info.host=t.host,this.login_info.port=t.port,this.login_info.ws=t.ws,this.login_info.srv_id=t.srv_id,this.login_info.platform=t.platform,this.login_info.zone_id=t.zone_id,this.login_info.srv_name=t.srv_name,this.login_info.open_time=t.open_time,this.login_info.is_close=t.is_close,this.login_info.is_new=t.is_new,gcore.GlobalEvent.fire(l.LOGIN_EVENT_CUR_SERVER_UPDATE)},findServer:function(t){if(t)for(var e in this.server_list)if(this.server_list[e].srv_id==t)return this.server_list[e];return null},getServerList:function(){return this.server_list},getServerInfo:function(t){if(this.server_list[t])return this.server_list[t]},getSvrName:function(t){if(null==this.server_list||null==t)return"";for(var e in this.server_list){var i=this.server_list[e];if(i.srv_id==t)return i.srv_name}return""},setIsSocket:function(t){this.isSocket=t},getLoginData:function(){return this.login_info},checkReloadServerData:function(t){var e=gcore.SmartSocket.getTime();this.check_time=this.check_time||0,e-this.check_time>10&&(this.check_time=e,this.account&&this.platform&&this.requestDefaultServerList(this.account,this.platform))},setFirstRoleData:function(t){this.first_role_data=t},getFirstRoleData:function(){return this.first_role_data},getSrvGroupNameByGroupId:function(t){if(null==t)return"";var e=c[PLATFORM_NAME];return e?e[t]:""}});e.exports=_,cc._RF.pop()},{login_event:"login_event",login_platform:"login_platform"}],login_platform:[function(t,e,i){"use strict";cc._RF.push(e,"62373eGYFxJ6rrnn7YDo5JZ","login_platform");var s=cc.Class({extends:BaseController,ctor:function(){},isLogin:function(){return this.is_logined},login:function(){this.is_logined?this.loginCallback():SDK.sdkLogin()},onLoginInfo:function(t){this.login_info=t,this.is_logined=!0,this.loginCallback()},loginCallback:function(){var e=this.getUID(),i={isTourist:!1};i.usrName=e,i.password="12345678",t("login_controller").getInstance().loginPlatformRequest(i)},onLogout:function(){isSubmit&&SDK.sdkSubmitUserData(5)},getInfo:function(){return this.login_info},getUserNam:function(){},getUID:function(){if(this.login_info)return this.login_info.uid},getTimestamp:function(){if(this.login_info)return this.login_info.timestamp},getToken:function(){if(this.login_info)return this.login_info.token},getChannel:function(){return SDK.getCurrChannel()},getSubChannel:function(){return SDK.getSubChannel()},getSign:function(){if(this.login_info)return this.login_info.sign},onSdkInitFail:function(){},getFinalChannel:function(){var t=this.getChannel(),e=this.getSubChannel();if(t&&e)return t+"_"+e}});e.exports=s,cc._RF.pop()},{login_controller:"login_controller"}],login_window:[function(t,e,i){"use strict";cc._RF.push(e,"97af1We3T1H0bE3BdiOkKUX","login_window");var s=t("pathtool"),n=t("enter_panel"),a=t("user_panel");t("loadermanager"),cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("login","login_window"),this.viewTag=SCENE_TAG.dialogue,this.panel_list=[],this.win_type=WinType.Full,this.mask_max_height=260,this.mask_min_height=160,this.is_move=!1,this.is_touch=!1,this.change_progress=!1},openCallBack:function(){this.background=this.root_wnd.getChildByName("background"),this.background_component=this.background.getComponent(cc.Sprite),this.label_component=this.seekChild("label_version",cc.Label),this.progress_bar_nd=this.seekChild("total_progress_bar"),this.progress_bar=this.progress_bar_nd.getComponent(cc.ProgressBar),this.sco_progress_bar=this.seekChild("sco_progress_bar",cc.ProgressBar),this.container=this.root_wnd.getChildByName("container"),this.mask_bg_nd=this.seekChild("mask_bg"),this.mask_bg_1_nd=this.seekChild("mask_bg_1"),this.progress_con_nd=this.seekChild("progress_con"),this.progress_des_lb=this.seekChild("progress_des",cc.Label),this.progress_num_lb=this.seekChild("progress_num",cc.Label),this.protress_des_lb=this.seekChild("protress_des",cc.Label),this.effect_nd=this.seekChild("effect_node"),this.sp_node=this.seekChild("sp_node"),this.target_node=this.seekChild("targe_node"),this.touch_nd=this.seekChild("touch"),this.touch_nd.on(cc.Node.EventType.TOUCH_END,function(){0==this.is_move&&this.moveEffectNd()},this),this.background.scale*=FIT_SCALE},registerEvent:function(){},openRootWnd:function(){USE_SDK?(SDK.initSDK(),this.changeSubPanel(2)):this.open_params&&this.changeSubPanel(this.open_params.index);var t=document.getElementById("splash");t&&(t.style.display="none")},changeSubPanel:function(t){this.cur_panel&&(this.cur_panel.hide(),this.cur_panel=null),t=t||1;var e=this.panel_list[t];null==e&&(1==t?e=new a:2==t&&(e=this.enter_panel=new n),this.panel_list[t]=e,e.setParent(this.container)),e&&(e.show(),this.cur_panel=e)},closeCallBack:function(){for(var t in this.panel_list){if(this.panel_list.hasOwnProperty(t))this.panel_list[t].deleteMe()}this.cur_panel=null,this.sp_node&&(this.sp_node.destroy(),this.sp_node=null),this.randow_timer&&gcore.Timer.del(this.randow_timer)},showLoading:function(){this.enter_panel.setVisible(!1),this.progress_con_nd.active=!0,this.mask_bg_nd.active=!0,this.mask_bg_1_nd.active=!1,this.mask_bg_nd.height=this.mask_max_height,this.randowTitle(),this.showFirstRoleEffect()},updateLoading:function(t){this.progress_bar.progress=t,t>.52&&!this.change_progress&&(this.progress_des_lb.string=Utils.TI18N("\u52a0\u8f7d\u8d44\u6e90\u6587\u4ef6"),this.change_progress=!0),t>0?(1!=USE_SDK||"SH_SDK"!=PLATFORM_TYPR||IS_LOADING||SDK.dataPlacement(9e4),IS_LOADING=!0):IS_LOADING=!1,t>.7&&(this.is_touch=!0),t>=1&&0==this.is_move&&this.moveEffectNd()},updateSeconLoading:function(t){this.sco_progress_bar.progress=t;var e=Math.ceil(100*t);e>100&&(e=100),this.progress_num_lb.string="["+e+"%]"},onClickRootWnd:function(){SDK.sdkLogin(),SDK.pay()},getTestAccount:function(){if(this.enter_panel)return this.enter_panel.getTestAccount()},randowTitle:function(){this.randow_timer=gcore.Timer.set(function(){var e=t("login_controller").getInstance().getCurRoleInfo(),i=[],s=0;e&&e.lev&&(s=e.lev);for(var n=1;n<14;n++)if(Lang["LOADING_DESC_"+n]){if(LoadingDes[n]&&s<LoadingDes[n])continue;i.push(Lang["LOADING_DESC_"+n])}var a=Math.ceil(10*Math.random())%i.length+1;i[a]&&(this.protress_des_lb.string=i[a])}.bind(this),2e3,-1)},showFirstRoleEffect:function(){var e=t("login_controller").getInstance().getModel().getFirstRoleData();if(cc.log(e),e&&this.effect_nd){this.effect_sk=this.effect_nd.addComponent(sp.Skeleton);this.loadRes("spine/E99998/action.atlas",function(t){this.effect_sk.skeletonData=t,this.effect_sk.setAnimation(1,PlayerAction.action,!0)}.bind(this)),this.get_sp=this.sp_node.addComponent(cc.Sprite),this.target_sp=this.target_node.addComponent(cc.Sprite),this.loadRes(s.getUIIconPath("login2","login2_1018"),function(t){this.get_sp.spriteFrame=t}.bind(this)),this.loadRes(s.getUIIconPath("login2","login2_1019"),function(t){this.target_sp.spriteFrame=t}.bind(this))}},moveEffectNd:function(){if(this.is_touch){this.is_move=!0,this.sp_node.active=!1,this.target_node.active=!1;var t=cc.moveTo(.7,cc.v2(this.effect_nd.x,this.effect_nd.y+500)),e=cc.callFunc(function(){this.effect_nd.active=!1}.bind(this));this.effect_nd.runAction(cc.sequence(t,e))}}});cc._RF.pop()},{enter_panel:"enter_panel",loadermanager:"loadermanager",login_controller:"login_controller",pathtool:"pathtool",user_panel:"user_panel"}],look_controller:[function(t,e,i){"use strict";cc._RF.push(e,"194c8GmGllFW47okY5PMj37","look_controller");var s=t("hero_controller"),n=cc.Class({extends:BaseController,ctor:function(){},initConfig:function(){var e=t("look_model");this.model=new e,this.model.initConfig()},getModel:function(){return this.model},registerEvents:function(){},registerProtocals:function(){this.RegisterProtocal(11061,this.handle11061),this.RegisterProtocal(11062,this.handle11062)},sender11061:function(t,e,i){var s={};s.r_rid=t,s.r_srvid=e,s.partner_id=i,this.SendProtocal(11061,s)},handle11061:function(t){if(message(t.msg),0!=t.bid){var e=Config.partner_data.data_partner_base[t.bid],i=1;e&&(i=e.camp_type),t.camp_type=i,s.getInstance().openHeroTipsPanel(!0,t)}},sender11062:function(t,e){var i={};i.id=t,i.srv_id=e,this.SendProtocal(11062,i)},handle11062:function(t){if(message(t.msg),0!=t.bid){var e=Config.partner_data.data_partner_base[t.bid],i=1;e&&(i=e.camp_type),t.camp_type=i,s.getInstance().openHeroTipsPanel(!0,t)}}});e.exports=n,cc._RF.pop()},{hero_controller:"hero_controller",look_model:"look_model"}],look_model:[function(t,e,i){"use strict";cc._RF.push(e,"b4c51a2dhdESa27QV3qzt5U","look_model");cc.Class({extends:BaseClass,ctor:function(){},properties:{},initConfig:function(){}});cc._RF.pop()},{}],mail_cell:[function(t,e,i){"use strict";cc._RF.push(e,"f0e70yb6slG3bMwfqyKQiET","mail_cell");var s=t("pathtool"),n=t("timetool"),a=cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("mail","mail_item"),this.data=null},initPanel:function(){this.main_container=this.root_wnd.getChildByName("main_container"),this.mail_con=this.main_container.getChildByName("mail_con"),this.icon=this.mail_con.getChildByName("icon").getComponent(cc.Sprite),this.mail_title=this.mail_con.getChildByName("title").getComponent(cc.Label),this.time=this.mail_con.getChildByName("time").getComponent(cc.Label),this.unread=this.mail_con.getChildByName("unread").getComponent(cc.Label),this.unread.string="\u672a\u8bfb",this.notice_con=this.main_container.getChildByName("notice_con"),this.notice_title=this.notice_con.getChildByName("title").getComponent(cc.Label),this.notice_content=this.notice_con.getChildByName("content").getComponent(cc.Label),this.onShow()},registerEvent:function(){null!=this.main_container&&this.main_container.on(cc.Node.EventType.TOUCH_END,function(){null!=this.data&&null!=this.callback&&this.callback(this)},this)},addCallBack:function(t){this.callback=t},setData:function(t){this.data=t,this.onShow()},onShow:function(){if(null!=this.data&&null!=this.root_wnd)if(this.data.status>=0){this.mail_con.active=!0,this.notice_con.active=!1;var t=n.getDayOrHour(gcore.SmartSocket.getTime()-this.data.send_time);this.time.string=t?t+"\u524d":"",this.changeIcon(this.data.status),this.mail_title.string=this.data.subject}else this.data.flag>=0&&(this.mail_con.active=!1,this.notice_con.active=!0,this.notice_title.string=this.data.title,this.notice_content.string=this.data.summary,this.setGray(1==this.data.flag))},changeIcon:function(t){null!=t&&(1==t?(this.setGray(!0),Utils.getArrLen(this.data.assets)>0||Utils.getArrLen(this.data.items)>0?this.loadRes(s.getUIIconPath("mail","mail_icon4"),function(t){this.icon.spriteFrame=t}.bind(this)):0!=Utils.getArrLen(this.data.assets)&&0!=Utils.getArrLen(this.data.items)||this.loadRes(s.getUIIconPath("mail","mail_icon3"),function(t){this.icon.spriteFrame=t}.bind(this))):2==t?(this.setGray(!0),this.loadRes(s.getUIIconPath("mail","mail_icon3"),function(t){this.icon.spriteFrame=t}.bind(this))):0==t&&(this.setGray(!1),Utils.getArrLen(this.data.assets)>0||Utils.getArrLen(this.data.items)>0?this.loadRes(s.getUIIconPath("mail","mail_icon2"),function(t){this.icon.spriteFrame=t}.bind(this)):this.loadRes(s.getUIIconPath("mail","mail_icon1"),function(t){this.icon.spriteFrame=t}.bind(this))))},setGray:function(t){t?(this.root_wnd.opacity=178,this.unread.node.active=!1):(this.root_wnd.opacity=255,this.unread.node.active=!0)},getData:function(){return this.data},updateIconStatus:function(){if(null!=this.data){var t=this.data.status;this.changeIcon(t)}},onHide:function(){},onDelete:function(){}});e.exports=a,cc._RF.pop()},{pathtool:"pathtool",timetool:"timetool"}],mail_controller:[function(t,e,i){"use strict";cc._RF.push(e,"cdcc1o/q79C3rQ5QVTLFu+1","mail_controller");var s=cc.Class({extends:BaseController,ctor:function(){},initConfig:function(){var e=t("mail_model");this.model=new e,this.model.initConfig()},getModel:function(){return this.model},registerEvents:function(){},registerProtocals:function(){this.RegisterProtocal(10800,this.mailListHandler),this.RegisterProtocal(10801,this.getGoodsHandler),this.RegisterProtocal(10802,this.getAllGoodsHandler),this.RegisterProtocal(10803,this.handle10803),this.RegisterProtocal(10804,this.delMailHandler),this.RegisterProtocal(10805,this.readMailHandler)},openMailUI:function(e){if(1==e){if(null==this.mail_ui){var i=t("mail_window");this.mail_ui=new i}this.mail_ui.open()}else this.mail_ui&&(this.mail_ui.close(),this.mail_ui=null)},openMailInfo:function(e,i){if(1==e){if(null==this.mail_info){var s=t("mail_info_window");this.mail_info=new s}this.mail_info.open(),this.mail_info.setData(i)}else this.mail_info&&(this.mail_info.close(),this.mail_info=null)},send10800:function(){this.SendProtocal(10800,{})},mailListHandler:function(t){this.model.initMailList(t.mail)},handle10803:function(t){this.model.addMailItem(t.mail)},deletMailSend:function(t){var e={};e.ids=t,this.SendProtocal(10804,e)},delMailHandler:function(t){message(t.msg),this.model.delMailItem(t.ids)},read:function(t,e){var i={};i.id=t,i.srv_id=e,this.SendProtocal(10805,i)},readMailHandler:function(t){1==t.code&&this.model.readMailItem(t)},getGoods:function(t,e){var i={};i.id=t,i.srv_id=e,this.SendProtocal(10801,i)},getGoodsHandler:function(t){message(t.msg),1==t.code&&this.model.getMailGood(t)},getAllGoods:function(){this.SendProtocal(10802,{})},getAllGoodsHandler:function(t){message(t.msg),null!=t.ids&&null!=Utils.next(t.ids)&&this.model.getAllMailGood(t.ids)},getHasReadNonRewardList:function(){return this.model.getHasReadNonRewardList()},getMailInfoView:function(){return this.mail_info?this.mail_info:null}});e.exports=s,cc._RF.pop()},{mail_info_window:"mail_info_window",mail_model:"mail_model",mail_window:"mail_window"}],mail_event:[function(t,e,i){"use strict";cc._RF.push(e,"ad63fGppwJLgYWPY21W70k+","mail_event"),e.exports={UPDATE_ITEM:"UPDATE_ITEM",UPDATE_NOTICE:"UPDATE_NOTICE",UPDATEREDSTATUS:"UPDATEREDSTATUS",READ_MAIL_INFO:"READ_MAIL_INFO",GET_ITEM_ASSETS:"GET_ITEM_ASSETS"},cc._RF.pop()},{}],mail_info_window:[function(t,e,i){"use strict";cc._RF.push(e,"b97d9TdONJKjZbp53rr1p3g","mail_info_window");var s=t("pathtool"),n=t("timetool"),a=t("mail_controller"),o=t("mail_event"),l=cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("mail","mail_info_window"),this.win_type=WinType.Big,this.data=null,this.ctrl=a.getInstance(),this.model=a.getInstance().getModel(),this.goods_list=[]},openCallBack:function(){this.background=this.root_wnd.getChildByName("background"),this.background.scale=FIT_SCALE,this.main_container=this.root_wnd.getChildByName("main_container"),this.main_panel=this.main_container.getChildByName("main_panel"),this.win_title=this.main_panel.getChildByName("win_title").getComponent(cc.Label),this.win_title.string=Utils.TI18N("\u90ae\u4ef6"),this.title_container=this.main_panel.getChildByName("title_container"),this.title=this.title_container.getChildByName("title").getComponent(cc.Label),this.time=this.title_container.getChildByName("time").getComponent(cc.Label),this.icon=this.title_container.getChildByName("icon").getComponent(cc.Sprite),this.info_container=this.main_panel.getChildByName("info_container"),this.content=this.info_container.getChildByName("ScrollView").getChildByName("view").getChildByName("content").getChildByName("RichText").getComponent(cc.RichText),this.youxiao=this.info_container.getChildByName("youxiao").getComponent(cc.Label),this.goods_container=this.info_container.getChildByName("goods_container"),this.goods_title=this.goods_container.getChildByName("goods_title").getComponent(cc.Label),this.goods_title.string="\u9886\u53d6\u5956\u52b1",this.goods_scroll=this.goods_container.getChildByName("ScrollView"),this.goods_scroll_content=this.goods_scroll.getChildByName("view").getChildByName("content"),this.goods_scroll_size=this.goods_scroll.getContentSize(),this.take_label=this.goods_container.getChildByName("take_label").getComponent(cc.Label),this.take_label.node.active=!1,this.btn=this.main_panel.getChildByName("btn"),this.btn_label=this.btn.getChildByName("Label").getComponent(cc.Label),this.btn_label_lo=this.btn.getChildByName("Label").getComponent(cc.LabelOutline),this.btn_img=this.btn.getComponent(cc.Sprite),this.close_btn=this.main_panel.getChildByName("close_btn"),this.onShow()},createPanel:function(t){this.panel_bg=t,this.panel_bg.setParent(this.main_container)},registerEvent:function(){this.close_btn&&this.close_btn.on(cc.Node.EventType.TOUCH_END,function(){this.ctrl.openMailInfo(!1)}.bind(this)),this.btn&&this.btn.on(cc.Node.EventType.TOUCH_END,function(){if(this.data&&this.data.status&&this.data.assets&&this.data.items)if(Utils.getArrLen(this.data.assets)>0||Utils.getArrLen(this.data.items)>0&&1==this.data.type)this.ctrl.getGoods(this.data.id,this.data.srv_id);else if(Utils.getArrLen(this.data.assets)<=0||Utils.getArrLen(this.data.items)<=0&&1==this.data.type){var t=[{id:this.data.id,srv_id:this.data.srv_id}];this.ctrl.deletMailSend(t),this.ctrl.openMailInfo(!1)}},this),this.background&&this.background.on(cc.Node.EventType.TOUCH_END,function(){this.ctrl.openMailInfo(!1)},this),this.addGlobalEvent(o.GET_ITEM_ASSETS,function(t){this.data&&(t==Utils.getNorKey(this.data.id||0,this.data.srv_id||"")&&this.removeAsset(t))},this)},setData:function(t){this.data=t,this.onShow()},onShow:function(){if(null!=this.data&&null!=this.root_wnd){var t=this.data,e=t.content;e=(e=(e=(e=e.replace(/&lt/g,"<")).replace(/&gt/g,">")).replace(/&#039/g,"'")).replace(/&quot/g,'"'),e=StringUtil.parseStr(e).string;var i=Config.color_data.data_color16[58];if(this.content.string="<color="+i+">"+e+"</c>",null!=t.status){this.title.string=t.subject,this.time.active=!0,this.youxiao.active=!0,t.assets&&t.items&&(Utils.getArrLen(t.assets)>0||Utils.getArrLen(t.items)>0&&1==t.type?(this.btn.active=!0,this.changeButtonStatus(!0),this.goods_container.active=!0,this.createGoodsList()):Utils.getArrLen(t.assets)<=0||Utils.getArrLen(t.items)<=0&&1==t.type?(this.btn.active=!0,this.changeButtonStatus(!1),this.goods_container.active=!1):(this.btn.active=!1,this.goods_container.active=!1));var s=n.getDayOrHour(gcore.SmartSocket.getTime()-this.data.send_time);this.time.string=null!=s?s+"\u524d":"",s=n.getDayOrHour(t.time_out-gcore.SmartSocket.getTime()),this.youxiao.string=null!=s?"\u6709\u6548\u671f"+s:"",this.changeIcon(t.status),this.ctrl.read(t.id,t.srv_id)}else null!=t.flag&&(this.title.string=t.title,this.btn.active=!1,this.goods_container.active=!1,this.time.node.active=!1,this.youxiao.node.active=!1,this.changeIcon(t.flag),this.ctrl.readNotice(t.id))}},removeAsset:function(){if(this.goods_list){for(var t in this.goods_list)null!=this.goods_list[t]&&(this.goods_list[t].deleteMe(),this.goods_list[t]=null);this.goods_list=null}this.goods_container.active=!1,this.data.assets={},this.data.status=2,this.data.items={},this.changeIcon(this.data.status),this.changeButtonStatus(!1)},createGoodsList:function(){if(2!=this.data.status){var t=[];for(var e in this.data.assets){var i=this.data.assets[e];null!=Utils.deepCopy(Utils.getItemConfig(i.label||i.base_id)).id&&t.push(this.data.assets[e])}for(var e in this.data.items){i=this.data.items[e];null!=Utils.deepCopy(Utils.getItemConfig(i.label||i.base_id)).id&&t.push(this.data.items[e])}this.data.items.length>0&&(this.take_label.string="\u5360\u7528\u80cc\u5305\u7a7a\u95f4\uff1a"+this.data.items.length,this.take_label.node.active=!0);var s=Math.max((BackPackItem.Width+10)*t.length,this.goods_scroll_size.width);this.goods_scroll_content.setContentSize(cc.size(s,this.goods_scroll_size.height));for(var n=0;n<t.length;n++){i=t[n];var a=Utils.deepCopy(Utils.getItemConfig(i.label||i.base_id));if(a.bid=i.label||i.base_id,null!=a.id){a.num=i.val||i.quantity;var o=ItemsPool.getInstance().getItem("backpack_item");o.setParent(this.goods_scroll_content),o.initConfig(!1,1,!1,!1),s>this.goods_scroll_size.width?o.setPosition(n*(BackPackItem.Width+8)-s/2+BackPackItem.Width/2,0):o.setPosition(n*(BackPackItem.Width+8)-(t.length-1)*BackPackItem.Width/2,0),o.show(),o.setData(a),this.goods_list[n]=o}}}},changeButtonStatus:function(t){1==t?(this.loadRes(s.getCommonIcomPath("common_1017"),function(t){this.btn_img.spriteFrame=t}.bind(this)),this.btn_label.string="\u9886\u53d6",this.btn_label_lo.color=new cc.Color(108,43,0,255)):(this.btn_label.string="\u5220\u9664",this.btn_label_lo.color=new cc.Color(43,97,13,255),this.loadRes(s.getCommonIcomPath("common_1018"),function(t){this.btn_img.spriteFrame=t}.bind(this)))},changeIcon:function(t){null!=t&&(1==t?this.data.assets&&this.data.items&&(Utils.getArrLen(this.data.assets)>0||Utils.getArrLen(this.data.items)>0)?this.loadRes(s.getUIIconPath("mail","mail_icon4"),function(t){this.res_object=t,this.icon.spriteFrame=t}.bind(this)):this.loadRes(s.getUIIconPath("mail","mail_icon3"),function(t){this.res_object=t,this.icon.spriteFrame=t}.bind(this)):2==t?this.loadRes(s.getUIIconPath("mail","mail_icon3"),function(t){this.res_object=t,this.icon.spriteFrame=t}.bind(this)):0==t&&(this.data.assets&&this.data.items&&(Utils.getArrLen(this.data.assets)>0||Utils.getArrLen(this.data.items)>0)?this.loadRes(s.getUIIconPath("mail","mail_icon2"),function(t){this.res_object=t,this.icon.spriteFrame=t}.bind(this)):this.loadRes(s.getUIIconPath("mail","mail_icon1"),function(t){this.res_object=t,this.icon.spriteFrame=t}.bind(this))))},close_callback:function(){if(null!=this.goods_list){for(var t in this.goods_list)null!=this.goods_list[t]&&(this.goods_list[t].deleteMe(),this.goods_list[t]=null);this.goods_list=null}this.ctrl.openMailInfo(!1)},onHide:function(){},onDelete:function(){}});e.exports=l,cc._RF.pop()},{mail_controller:"mail_controller",mail_event:"mail_event",pathtool:"pathtool",timetool:"timetool"}],mail_model:[function(t,e,i){"use strict";cc._RF.push(e,"3ceddkww6ZLgYYJdNT1CFO/","mail_model");var s=t("mail_controller"),n=t("mail_event"),a=t("mail_vo"),o=(t("notice_vo"),cc.Class({extends:BaseClass,ctor:function(){this.ctrl=s.getInstance(),this.initConfig()},properties:{},initConfig:function(){this.mail_list={},this.notice_list={},this.red_status_list={}},initMailList:function(t){if(null!=t&&null!=Utils.next(t)){for(var e in t){var i=t[e],s=Utils.getNorKey(i.id,i.srv_id),n=this.mail_list[s];null==n&&(n=new a,this.mail_list[s]=n),n.initAttrData(i)}this.checkMailRedSum()}},checkMailRedSum:function(){var t=0;for(var e in this.mail_list)this.mail_list[e]&&0==this.mail_list[e].status&&(t+=1);this.updateRedStatus(1,t)},addMailItem:function(t){this.initMailList(t),gcore.GlobalEvent.fire(n.UPDATE_ITEM)},delMailItem:function(t){if(null!=t&&null!=Utils.next(t)){for(var e in t){var i=t[e];if(i){var s=Utils.getNorKey(i.id,i.srv_id);this.mail_list[s]=null}}gcore.GlobalEvent.fire(n.UPDATE_ITEM)}},readMailItem:function(t){if(null!=t){var e=Utils.getNorKey(t.id,t.srv_id),i=this.mail_list[e];null!=i&&(i.setReaded(t.read_time),this.checkMailRedSum(),gcore.GlobalEvent.fire(n.READ_MAIL_INFO,e))}},getMailGood:function(t){if(null!=t){var e=Utils.getNorKey(t.id,t.srv_id);this.mail_list[e].removeAssets(),this.checkMailRedSum(),gcore.GlobalEvent.fire(n.GET_ITEM_ASSETS,e)}},getAllMailGood:function(t){if(null!=t&&null!=Utils.next(t)){for(var e in t){var i=t[e],s=Utils.getNorKey(i.id,i.srv_id);this.mail_list[s]&&this.mail_list[s].removeAssets(i.read_time)}this.checkMailRedSum(),gcore.GlobalEvent.fire(n.UPDATE_ITEM)}},getAllMailArray:function(){var t=[];for(var e in this.mail_list){var i=this.mail_list[e];i&&1==i.type&&t.push(i)}return t.length>0&&t.sort(Utils.tableLowerSorter(["status","is_has"])),t},getHasReadNonRewardList:function(){var t=[];for(var e in this.mail_list){var i=this.mail_list[e];if(i&&null!=i.id&&null!=i.srv_id&&(2==i.status||1==i.status&&0==Utils.getArrLen(i.assets)&&0==Utils.getArrLen(i.items))&&1==i.type){var s={};s.id=i.id,s.srv_id=i.srv_id,t.push(s)}}return t},updateRedStatus:function(e,i){if(this.red_status_list[e]!=i){this.red_status_list[e]=i;var s={bid:e,num:i},a=t("mainui_const");t("mainui_controller").getInstance().setFunctionTipsStatus(a.icon.mail,s),gcore.GlobalEvent.fire(n.UPDATEREDSTATUS,e,i)}},getRedSum:function(t){return this.red_status_list[t]}}));e.exports=o,cc._RF.pop()},{mail_controller:"mail_controller",mail_event:"mail_event",mail_vo:"mail_vo",mainui_const:"mainui_const",mainui_controller:"mainui_controller",notice_vo:"notice_vo"}],mail_vo:[function(t,e,i){"use strict";cc._RF.push(e,"e14a3mA4nFMrZt0KhZlRwNx","mail_vo");var s=cc.Class({extends:gcore.BaseEvent,ctor:function(){this.initData()},setContent:function(t){this.mail_count=t},initData:function(){this.id=0,this.srv_id="",this.type=1,this.from_name="",this.subject="",this.content="",this.assets=[],this.items=[],this.send_time=0,this.send_time_order=0,this.read_time=0,this.time_out=0,this.status=0,this.is_has=1},initAttrData:function(t){if(t)for(var e in t){var i=t[e];this.update(e,i),t.send_time&&(this.send_time_order=-t.send_time||0),(t.assets||t.items)&&(t.assets.length>0||t.items.length>0?this.is_has=0:this.is_has=1)}},update:function(t,e){null!=this[t]&&(this[t]=e)},setReaded:function(t){t&&(this.read_time=t),this.status=1},removeAssets:function(t){t&&(this.read_time=t),this.items={},this.assets={},this.status=2}});e.exports=s,cc._RF.pop()},{}],mail_window:[function(t,e,i){"use strict";cc._RF.push(e,"b221e524RJHIreW/2YcvFU5","mail_window");var s=t("pathtool"),n=t("mail_controller"),a=t("common_scrollview"),o=t("mail_cell"),l=t("mail_event"),r=cc.Class({extends:CommonWindowTab,ctor:function(){this.path=s.getPrefabPath("mail","mail_window"),this.model=n.getInstance().getModel(),this.ctrl=n.getInstance(),this.win_type=WinType.Full,this.tab_info_list=[{label:Utils.TI18N("\u90ae\u4ef6"),index:1,status:!0}],this.title_str=Utils.TI18N("\u90ae\u7bb1"),this.scroll_width=624,this.scroll_height=570,this.cur_index=1},initPanel:function(){this.main_container=this.root_wnd.getChildByName("main_container"),null==this.panel&&this.loadRes(this.path,function(t){var e=t;this.createPanel(e)}.bind(this))},createPanel:function(t){this.panel=t,this.panel.setParent(this.container),this.panel_container=this.panel.getChildByName("main_container"),this.scrollCon=this.panel_container.getChildByName("scrollCon"),this.scroll_bg=this.scrollCon.getChildByName("background"),this.del_btn=this.panel_container.getChildByName("del_btn"),this.get_btn=this.panel_container.getChildByName("get_btn"),this.del_btn.active=null==this.del_btn_bool||this.del_btn_bool,this.get_btn.active=null==this.get_btn_bool||this.get_btn_bool;var e=this.scrollCon.getContentSize();this.scroll_con.active=!1;e=cc.size(622,696);var i={item_class:o,start_x:5.5,space_x:0,start_y:0,space_y:2,item_width:610,item_height:124,row:0,col:1,once_num:1,need_dynamic:!0};this.item_scrollview=new a,this.item_scrollview.createScroll(this.scrollCon,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,e,i,cc.v2(.5,.5)),this.del_btn.on(cc.Node.EventType.TOUCH_END,function(t){var e=this.model.getHasReadNonRewardList();n.getInstance().deletMailSend(e)},this),this.get_btn.on(cc.Node.EventType.TOUCH_END,function(t){n.getInstance().getAllGoods()},this),this.selectedTabCallBack(this.cur_index)},registerEvent:function(){null==this.update_list&&(this.update_list=gcore.GlobalEvent.bind(l.UPDATE_ITEM,function(){1==this.cur_index&&this.selectedTabCallBack(this.cur_index)}.bind(this))),this.addGlobalEvent(l.UPDATEREDSTATUS,function(t,e){this.updateRedStatus(t,e)},this),this.addGlobalEvent(l.READ_MAIL_INFO,function(t){if(this.select_cellitem){var e=this.select_cellitem.getData();if(e)Utils.getNorKey(e.id||0,e.srv_id||"")==t&&this.select_cellitem.updateIconStatus()}},this)},selectedTabCallBack:function(t){if(this.cur_index=t,null!=this.panel_container)if(1==t){this.get_btn?this.get_btn.active=!0:this.get_btn_bool=!0,this.del_btn?this.del_btn.active=!0:this.del_btn_bool=!0;for(var e=[],i=this.model.getAllMailArray(),s=0;s<i.length;s++)e.push(i[s]);this.scrollCon.setContentSize(cc.size(622,696)),this.scroll_bg.setContentSize(cc.size(622,711)),this.scrollCon.setPosition(0,32),this.item_scrollview.resetSize(this.scrollCon.getContentSize(),cc.v2(0,0)),this.empty_con.active=0==e.length,this.empty_label.string=Utils.TI18N("\u6682\u65f6\u6ca1\u6709\u90ae\u4ef6"),this.item_scrollview.setData(e,function(t){n.getInstance().openMailInfo(!0,t.getData()),this.select_cellitem=t}.bind(this))}else if(2==t){this.get_btn?this.get_btn.active=!1:this.get_btn_bool=!1,this.del_btn?this.del_btn.active=!1:this.del_btn_bool=!1;e=[];this.scrollCon.setContentSize(cc.size(622,775)),this.scroll_bg.setContentSize(cc.size(622,775)),this.scrollCon.setPosition(0,0),this.item_scrollview.resetSize(cc.size(622,755),cc.v2(0,-28)),this.empty_con.active=0==e.length,this.empty_label.string=Utils.TI18N("\u6682\u65f6\u6ca1\u6709\u516c\u544a"),this.item_scrollview.setData(e,function(t){n.getInstance().openMailInfo(!0,t)})}},openRootWnd:function(t){t=t||1,this.setSelecteTab(t,!0),this.updateRedStatus()},updateRedStatus:function(t,e){if(null==t)for(var i=1;i<=1;i++){var s=this.model.getRedSum(i);null==s&&(s=0),this.setTabTipsII(s,i)}else t=1,e=e||0,this.setTabTipsII(e,t)},closeCallBack:function(){this.update_list&&(gcore.GlobalEvent.unbind(this.update_list),this.update_list=null),this.update_notice&&(gcore.GlobalEvent.unbind(this.update_notice),this.update_notice=null),this.item_scrollview&&this.item_scrollview.DeleteMe(),this.item_scrollview=null,this.ctrl.openMailUI(!1)}});e.exports=r,cc._RF.pop()},{common_scrollview:"common_scrollview",mail_cell:"mail_cell",mail_controller:"mail_controller",mail_event:"mail_event",pathtool:"pathtool"}],mainscene_const:[function(t,e,i){"use strict";var s;function n(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}cc._RF.push(e,"eb205pjgMBMPLHNnk05hb2R","mainscene_const");var a={MainacenBuild:(s={shop:1,mall:2,arena:3,startower:4,summon:5,fuse:6,guild:7,seerpalace:8,video:9,variety:10,escort:11},n(s,"escort",12),n(s,"escort",13),n(s,"escort",14),n(s,"escort",15),n(s,"escort",16),n(s,"smroom",17),s),BuildItemType:{build:1,effect:2,npc:3}};e.exports=a,cc._RF.pop()},{}],mainscene_controller:[function(t,e,i){"use strict";function s(t){"@babel/helpers - typeof";return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}cc._RF.push(e,"8b38cq+Ak1N4La5TaoyW4OH","mainscene_controller");var n=t("mainscene_event"),a=t("battle_drama_event"),o=t("role_controller"),l=t("scene_const"),r=t("battle_const"),c=t("crossshow_controller"),_=cc.Class({extends:BaseController,properties:{build_list_vo:{default:{}},has_init:!1,role_vo:null,time_type:1},ctor:function(){},initConfig:function(){this.model=Utils.createClass("mainscene_model"),this.model.initConfig();var e=t("battle_drama_controller");this.battle_drama_ctrl=e.getInstance()},getModel:function(){return this.model},registerEvents:function(){this.create_role_event=gcore.GlobalEvent.bind(EventId.EVT_ROLE_CREATE_SUCCESS,function(){gcore.GlobalEvent.unbind(this.create_role_event),this.create_role_event=null,this.role_vo=o.getInstance().getRoleVo(),this.creatBuildVo(),this.registerProtocals(),this.role_vo.bind(EventId.UPDATE_ROLE_ATTRIBUTE,function(t,e){"lev"!=t&&"open_day"!=t||this.checkBuildLockStatus()}.bind(this))}.bind(this)),this.update_drama_max_event||(this.update_drama_max_event=gcore.GlobalEvent.bind(a.BattleDrama_Update_Max_Id,function(t){this.update_drama_max_event=null,this.checkBuildLockStatus()}.bind(this))),this.battle_enter_event||(this.battle_enter_event=gcore.GlobalEvent.bind(EventId.ENTER_FIGHT,function(t){t!=r.Fight_Type.Nil&&(Utils.hideAllWindowForBattle(),this.handleSceneStatus(!1))}.bind(this))),this.battle_exit_event||(this.battle_exit_event=gcore.GlobalEvent.bind(EventId.EXIT_FIGHT,function(t){if(t!=r.Fight_Type.Nil){var e=Utils.showAllWindowForBattle();this.handleSceneStatus(e)}}.bind(this)))},registerProtocals:function(){this.RegisterProtocal(20063,this.on20063),this.RegisterProtocal(10304,this.on10304)},requestFightStatus:function(){this.SendProtocal(20063,{})},on20063:function(t){if(this.build_list_vo&&Utils.next(this.build_list_vo)){var e={};for(var i in Config.city_data.data_base)e[i]={};if(t.type_list)for(var s in t.type_list){var n=t.type_list[s],a=this.getBuildIdByCombat(n.combat_type);a&&(e[a][n.combat_type]=!0)}for(var o in e){var l=this.build_list_vo[o];l&&l.setFightStatus(e[o])}}},getBuildIdByCombat:function(e){var i=t("battle_const");return e==i.Fight_Type.Arena?l.CenterSceneBuild.arena:e==i.Fight_Type.StarTower?l.CenterSceneBuild.startower:e==i.Fight_Type.Adventrue||e==i.Fight_Type.ElementWar||e==i.Fight_Type.HeavenWar?l.CenterSceneBuild.adventure:e==i.Fight_Type.LadderWar||e==i.Fight_Type.EliteMatchWar||e==i.Fight_Type.EliteKingMatchWar||e==i.Fight_Type.CrossArenaWar?l.CenterSceneBuild.ladder:void 0},on10304:function(e){this.can_enter=!0,"SH_RH"==PLATFORM_TYPR&&cli_log&&cli_log.log_enter_city&&cli_log.log_enter_city(t("login_controller").getInstance().getModel().getLoginData().usrName)},enterMainScene:function(e){if(this.can_enter)if(0==e)this.handleSceneStatus(!1);else if(this.main_scene)this.handleSceneStatus(!0);else{var i=Config.main_scene_data[1];if(null==this.main_scene){var s=t("mainscene");this.main_scene=new s(i),this._finish_data&&(this.main_scene.getBuildById(this._finish_data.id,this._finish_data.finish_cb),this._finish_data=null)}}},changeMainCityTimeType:function(t){this.main_scene&&this.main_scene.setTimeType(t),this.time_type=t},handleSceneStatus:function(e){this.main_scene&&(this.main_scene_status=e,0==e?(this.main_scene.setVisible(e),this.wait_status_time_ticket&&(gcore.Timer.del(this.wait_status_time_ticket),this.wait_status_time_ticket=null)):null==this.wait_status_time_ticket&&(this.wait_status_time_ticket=gcore.Timer.set(function(){1==this.main_scene_status&&this.main_scene.setVisible(this.main_scene_status),gcore.Timer.del(this.wait_status_time_ticket),this.wait_status_time_ticket=null}.bind(this),100,1))),t("mainui_controller").getInstance().openMainUI(e)},checkBuildLockStatus:function(){var t=this.battle_drama_ctrl.getModel().getDramaData();if(t&&this.role_vo&&this.build_list_vo)for(var e in this.build_list_vo){var i=this.build_list_vo[e];if(i.activate&&i.is_lock){var s=!1;for(var n in i.activate){var a=i.activate[n][0],o=i.activate[n][1],l=0;switch(a){case"dun":l=t.max_dun_id;break;case"lev":l=this.role_vo.lev;break;case"open_day":l=this.role_vo.open_day}if(!(l>=o)){s=!0;break}s=!1}s!==i.is_lock&&i.setLockStatus(s)}}},creatBuildVo:function(){if(this.role_vo){var e=Config.main_scene_data[1];cc.log("enter mainscene_controller.js and call createBuildVo!!!!scene_config=>",e);var i=this.battle_drama_ctrl.getModel().getDramaData();for(var s in e.building_list){var a=e.building_list[s];if(a.type==l.BuildItemType.build){if(12==a.bid||13==a.bid)continue;var r=Config.city_data.data_base[a.bid],c=!1;if(r&&r.activate){for(var _ in r.activate){var h=r.activate[_][0],d=r.activate[_][1],u=0;switch(h){case"dun":u=i.max_dun_id;break;case"lev":u=this.role_vo.lev;break;case"open_day":u=this.role_vo.open_day;break;case"world_lev":var m=o.getInstance().getModel().getWorldLev();m&&(u=m)}if(!(u>=d)){c=!0;break}c=!1}var f=new(t("build_vo"))(a,c,r.activate,r.desc);cc.log(f.config),this.cache_tips_list&&this.cache_tips_list[a.bid]&&(f.setTipsStatus(this.cache_tips_list[a.bid]),this.cache_tips_list[v.bid]=null),this.build_list_vo[a.bid]=f}}}gcore.GlobalEvent.fire(n.CreateBuildVoOver)}},getBuildList:function(){return this.build_list_vo},getBuildVo:function(t){if(this.build_list_vo&&this.build_list_vo[t])return this.build_list_vo[t]},openBuild:function(e,i){switch(e){case l.CenterSceneBuild.shop:t("mall_controller").getInstance().openMallPanel(!0);break;case l.CenterSceneBuild.seerpalace:t("seerpalace_controller").getInstance().openSeerpalaceMainWindow(!0);break;case l.CenterSceneBuild.fuse:t("hero_controller").getInstance().openHeroUpgradeStarFuseWindow(!0);break;case l.CenterSceneBuild.arena:t("arena_controller").getInstance().requestOpenArenWindow(!0,i);break;case l.CenterSceneBuild.summon:t("partnersummon_controller").getInstance().openPartnerSummonWindow(!0);break;case l.CenterSceneBuild.video:break;case l.CenterSceneBuild.startower:var s=t("battle_const");t("mainui_controller").getInstance().requestOpenBattleRelevanceWindow(s.Fight_Type.StarTower);break;case l.CenterSceneBuild.mall:t("forgehouse_controller").getInstance().openForgeHouseView(!0);break;case l.CenterSceneBuild.variety:t("mall_controller").getInstance().openVarietyStoreWindows(!0);break;case l.CenterSceneBuild.guild:t("hero_controller").getInstance().openHeroResetWindow(!0);break;case l.CenterSceneBuild.escort:break;case l.CenterSceneBuild.library:t("hero_controller").getInstance().openHeroLibraryMainWindow(!0);break;case l.CenterSceneBuild.smroom:t("hero_controller").getInstance().openHeroSMRoomMainWindow(!0);break;case l.CenterSceneBuild.adventure:t("adventureactivity_controller").getInstance().openAdventureActivityMainWindow(!0);break;case l.CenterSceneBuild.ladder:break;case l.CenterSceneBuild.crossshow:c.getInstance().openCrossshowMainWindow(!0)}this.relevance_params=null},setBuildRedStatus:function(e,i){if(this.build_list_vo&&this.build_list_vo[e])this.build_list_vo[e].setTipsStatus(i);else if(this.cache_tips_list||(this.cache_tips_list={}),i instanceof Array)for(var n in this.cache_tips_list[e]||(this.cache_tips_list[e]={}),i){var a=i[n];null!=a.bid&&"number"==typeof a.bid&&(this.cache_tips_list[e][a.bid]=a)}else"object"==s(i)?(this.cache_tips_list[e]||(this.cache_tips_list[e]={}),null!=i.bid&&"number"==typeof i.bid&&(this.cache_tips_list[e][i.bid]=i)):this.cache_tips_list[e]=i;t("mainui_controller").getInstance().checkMainSceneIconStatus()},getBuildVoList:function(){return this.build_list_vo},getCenterCityBuildById:function(t,e){this.main_scene?this.main_scene.getBuildById(t,e):this._finish_data={id:t,finish_cb:e}},moveToBuild:function(t){this.main_scene&&this.main_scene.moveToBuild(t)}});e.exports=_,cc._RF.pop()},{adventureactivity_controller:"adventureactivity_controller",arena_controller:"arena_controller",battle_const:"battle_const",battle_drama_controller:"battle_drama_controller",battle_drama_event:"battle_drama_event",build_vo:"build_vo",crossshow_controller:"crossshow_controller",forgehouse_controller:"forgehouse_controller",hero_controller:"hero_controller",login_controller:"login_controller",mainscene:"mainscene",mainscene_event:"mainscene_event",mainui_controller:"mainui_controller",mall_controller:"mall_controller",partnersummon_controller:"partnersummon_controller",role_controller:"role_controller",scene_const:"scene_const",seerpalace_controller:"seerpalace_controller"}],mainscene_event:[function(t,e,i){"use strict";cc._RF.push(e,"3627d/nOalLepSl8C0epIcO","mainscene_event"),e.exports={CreateBuildVoOver:"CreateBuildVoOver"},cc._RF.pop()},{}],mainscene_model:[function(t,e,i){"use strict";cc._RF.push(e,"44043xNpKZHKLBXa8chjpa/","mainscene_model");var s=cc.Class({ctor:function(){},properties:{},initConfig:function(){}});e.exports=s,cc._RF.pop()},{}],mainscene:[function(t,e,i){"use strict";cc._RF.push(e,"693f99CVQFBN5FORw91LWR9","mainscene");var s=t("loadermanager"),n=t("mainscene_controller"),a=t("mainscene_event"),o=t("scene_const"),l=t("build_item"),r=t("guide_controller"),c=cc.Class({extends:BaseClass,properties:{build_list:null,effect_render_list:[],config:null,cur_time_type:1,map_type:null,last_map_res:[],scene_effect:[],get_build_cb:{default:{}},build_items:{default:{}}},ctor:function(){this.config=arguments[0],this.initConfig(),this.createRootWnd(),this.registerEvent(),this.createScene()},initConfig:function(){this.size=cc.size(720,1280),this.layer_num=4,this.map_layer=[],this.speed_list=[.2,0,-.15,0],this.init_x=0,this.init_y=0,this.map_cache=[],this.layer_img_list=["1.png","2.png","3.png","4.png"],this.last_point=null},setTimeType:function(t){var e;e=t>=6&&t<18?1:2,this.cur_time_type!==e&&(this.cur_time_type=e,this.root.active&&this.changeSceneMap())},getTiemType:function(){var t=(new Date).getHours(),e=2;return t>=6&&t<=18&&(e=1),e},createRootWnd:function(){this.root=new cc.Node("base_root"),this.root.setAnchorPoint(0,0);var t=this.scene_scale=1,e=this.width_scale=1;window.FIT_HEIDGHT&&(e=FIT_SCALE),window.FIT_WIDTH&&(t=FIT_SCALE),this.root.setContentSize(SCREEN_WIDTH*e,SCREEN_HEIGHT),this.root.setPosition(.5*-SCREEN_WIDTH*e,.5*-SCREEN_HEIGHT*t),this.root.addComponent(cc.Mask),ViewManager.getInstance().addToSceneNode(this.root,SCENE_TAG.scene),this.root.scale=t,this.rootShowY=this.root.y,this.rootHideY=2*-this.root.height,this.root_wnd=new cc.Node("handle_root"),this.root_wnd.setAnchorPoint(0,0),this.root_wnd.setContentSize(this.size),this.root_wnd.parent=this.root;for(var i=0;i<this.layer_num;i++){var s=new cc.Node("map_layer"+i);s.setAnchorPoint(0,0),s.setContentSize(this.size),this.root_wnd.addChild(s,10-i),this.map_layer[i]={node:s,index:i,sprite:null,frame:null,res:null}}this.init_x=.5*(SCREEN_WIDTH-this.size.width),this.init_y=.5*(SCREEN_HEIGHT-this.size.height),this.updateMainScene(this.init_x,this.init_y),this.playBackgroundMusic()},registerEvent:function(){var t=this;this.root.on(cc.Node.EventType.TOUCH_START,function(e){t.last_point=null;var i=!0,s=!1,n=void 0;try{for(var a,o=t.map_layer[Symbol.iterator]();!(i=(a=o.next()).done);i=!0){var l=a.value;l.node&&l.node.stopAllActions()}}catch(t){s=!0,n=t}finally{try{i||null==o.return||o.return()}finally{if(s)throw n}}t.root_wnd.stopAllActions()},this),this.root.on(cc.Node.EventType.TOUCH_MOVE,function(e){var i=e.getTouches();t.last_point=i[0].getDelta(),t.moveMainScene(t.last_point.x)},this),this.root.on(cc.Node.EventType.TOUCH_END,function(e){if(null!=t.last_point){var i=3*t.last_point.x,s=t.root_wnd.getPosition().x+i,n=t.scaleCheckPoint(s),a=!0,o=!1,l=void 0;try{for(var r,c=t.map_layer[Symbol.iterator]();!(a=(r=c.next()).done);a=!0){var _=r.value;if(_.node){var h=t.speed_list[_.index],d=cc.moveTo(2,(n-t.init_x)*h,0).easing(cc.easeBackOut());_.node.runAction(d)}}}catch(t){o=!0,l=t}finally{try{a||null==c.return||c.return()}finally{if(o)throw l}}var u=cc.moveTo(2,n,t.init_y);t.root_wnd.runAction(u.easing(cc.easeBackOut()))}},this)},setVisible:function(t){t?(this.getTiemType()!==this.cur_time_type&&this.changeSceneMap(),this.root.y=this.rootShowY):this.root.y=this.rootHideY},updateMainScene:function(t,e){e=e||this.init_y;for(var i=0;i<this.map_layer.length;i++){var s=this.map_layer[i],n=this.speed_list[i];s.node.setPosition((t-this.init_x)*n,e-this.init_y)}this.root_wnd.setPosition(t,e)},createScene:function(){this.cur_time_type=this.getTiemType(),this.renderSmallPic(),gcore.Timer.set(function(){this.changeSceneMap()}.bind(this),2e3,1);var t=n.getInstance().getBuildList();cc.log("enter mainscene.js and call createScene:build_list=>",t),Utils.isEmpty(t)&&!this.wait_create_build_event?this.create_build_vo=gcore.GlobalEvent.bind(a.CreateBuildVoOver,function(){this.wait_create_build_event=null,gcore.GlobalEvent.unbind(this.create_build_vo),this.beforeCreateBuild()}.bind(this)):this.beforeCreateBuild(),DownloadManager.getInstance().checkAnimaCache()},mainLoop:function(){if(this.map_cache&&this.map_cache.length>0){var t=this.map_cache.shift();t.res&&s.getInstance().loadRes(t.res,function(e,i){var n=this.map_layer[t.layer];n&&n.node&&(null==n.sprite&&(n.sprite=new cc.Node,n.sprite.setPosition(t.pos),n.sprite.setAnchorPoint(t.ap),3==t.layer&&(1==this.cur_time_type?n.sprite.setScale(4):n.sprite.setScale(1)),n.node.addChild(n.sprite,-1),n.frame=n.sprite.addComponent(cc.Sprite)),n.frame.spriteFrame=i,n.res&&s.getInstance().releaseRes(n.res),n.res=t.res),0==e&&this.small_sprite&&(this.small_sprite.destroy(),this.small_sprite=null,s.getInstance().deleteRes("res/centerscene/preview/centercity_1"))}.bind(this,this.map_cache.length))}this.effect_render_list.length>0&&this.quequeCreateEffect(),0==this.effect_render_list&&0==this.map_cache.length&&(gcore.Timer.del(this.timer),this.timer=null)},renderSmallPic:function(){var t="res/centerscene/preview/centercity_"+this.cur_time_type+".jpg";t&&this.small_path||(s.getInstance().loadRes(t,function(t){this.small_sprite=new cc.Node,this.small_sprite.setPosition(0,0),this.small_sprite.setAnchorPoint(0,0),this.root_wnd.addChild(this.small_sprite,1),this.small_sprite.addComponent(cc.Sprite).spriteFrame=t;var e=this.small_sprite.getContentSize();this.small_sprite.setScale(this.size.width/e.width,this.size.height/e.height)}.bind(this)),this.small_path=t)},renderMapPic:function(){for(var t="res/centerscene/centercity/"+this.map_type,e=0;e<this.layer_img_list.length;e++){var i=cc.v2(0,0),s=cc.v2(0,0),n=t+"/"+this.layer_img_list[e];0==e?i.x=-80:1==e||(2==e?(i.x=59,i.y=472):(i.y=this.size.height,s.y=1)),this.map_cache.push({res:n,layer:e,pos:i,ap:s})}},moveMainScene:function(t){if(!r.getInstance().isInGuide()){t=this.root_wnd.getPosition().x+t;var e=this.scaleCheckPoint(t);this.updateMainScene(e)}},moveToBuild:function(t){if(this.build_items[t]){var e=this.build_items[t].root_wnd.convertToWorldSpaceAR(cc.v2(0,0)),i=this.root_wnd.convertToNodeSpaceAR(e),s=this.scaleCheckPoint(-(i.x-.5*SCREEN_WIDTH));this.updateMainScene(s)}},scaleCheckPoint:function(t){var e=t;return t>0?e=0:t<this.root.width-this.size.width&&(e=this.root.width-this.size.width),e},beforeCreateBuild:function(){var t=n.getInstance().getBuildList();cc.log("enter mainscene.js call beforcCreateBuild: build_list=>",t);var e=Object.keys(t).length,i=0,s=gcore.Timer.set(function(){var n=Object.keys(t)[i],a=t[n];this.createBuildItem(a),i==e-1&&gcore.Timer.del(s),i++}.bind(this),100,e)},createBuildItem:function(t){cc.log("enter mainscene.js:call createBuildItem:",t);var e=new l(t,o.BuildItemType.build),i=t.config.layer;if(this.map_layer[i-1].node.addChild(e.root_wnd,999),this.build_items[t.config.bid]=e,this.get_build_cb[t.config.bid]){var s=this.get_build_cb[t.config.bid];for(var n in s)s[n](e)}},changeSceneMap:function(){this.map_type&&this.map_type===this.cur_time_type||(this.map_type=this.cur_time_type,this.renderSmallPic(),this.renderMapPic(),this.changeSceneEffect(),this.timer||(this.timer=gcore.Timer.set(function(){this.mainLoop()}.bind(this),400,-1)))},changeSceneEffect:function(){for(var t in this.effect_render_list.length>0&&(this.effect_render_list.length=[]),this.scene_effect)this.scene_effect[t].deleteMe();this.analysisEffect()},analysisEffect:function(){if(this.effect_render_list=[],this.config&&this.config.building_list)for(var t in this.config.building_list){var e=this.config.building_list[t];0!=e.dun_id&&this.cur_time_type!=e.dun_id||e.type===o.BuildItemType.build||!e||!e.res||"E54539"!=e.res&&e.res}},quequeCreateEffect:function(){var t=this.effect_render_list.shift(),e=new l(t,t.type);this.map_layer[t.layer-1].node.addChild(e.root_wnd),this.scene_effect.push(e)},playBackgroundMusic:function(){Utils.playMusic(AUDIO_TYPE.SCENE,"s_002",!0)},getBuildById:function(t,e){this.build_items[t]?e(this.build_items[t]):(this.get_build_cb[t]||(this.get_build_cb[t]=[]),this.get_build_cb[t].push(e)),cc.log(this.get_build_cb)}});e.exports=c,cc._RF.pop()},{build_item:"build_item",guide_controller:"guide_controller",loadermanager:"loadermanager",mainscene_controller:"mainscene_controller",mainscene_event:"mainscene_event",scene_const:"scene_const"}],mainui_const:[function(t,e,i){"use strict";var s,n;function a(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}cc._RF.push(e,"08c1f5AK/dGj7q0i/zMwEln","mainui_const");var o={ui_fight_type:{normal:0,main_scene:1,partner:2,backpack:3,drama_scene:4,esecsice:5,guild:6,hallows:7,arena:8,guild_dun:9,star_tower:10,endless:11,dungeon_stone:14,guildwar:17,primusWar:18,ladderwar:19,expedit_fight:20,limit_boss:12,escort:13,godbattle:15,elementWar:25,heavenwar:27},btn_index:{main_scene:0,partner:1,backpack:2,drama_scene:3,esecsice:4,guild:5,hallows:6,boss:991,upgrade:992,recharge:993,assistant:994,gemstone:996},item_exhibition_type:{item_type:1,partner_type:2},icon:{friend:1,mail:2,daily:3,stronger:4,rank:5,vedio:6,festval:908,festval_spring:1101,festval_lover:1102,welfare:12,charge:10,action:13,champion:14,festival:15,escort:17,godbattle:18,godpartner:19,combine:21,guildwar:22,ladder:23,ladder_2:24,download:100,day_first_charge:501,first_charge:502,seven_login:505,limit_gift_entry:506,first_charge_new1:522,direct_gift:1001,seven_rank:108,crossserver_rank:109,icon_firt1:900,icon_firt2:901,icon_firt3:902,icon_firt4:903,icon_firt5:904,icon_charge1:905,icon_charge2:906,day_charge:907,dungeon_double_time:20,seven_goal:503,seven_goal1:1503,seven_goal2:2503,seven_goal3:3503,combine_login:909,lucky_treasure:1002,preferential:1003,other_preferential:1004,certify:110,fund:507,first_charge_new:512,limit_recruit:504,open_server_recharge:513,give_vip:525,one_gift:528,skin:529,shrh_share:9997,shrh_sub:9998,shrh_realname:9999,trigger_gift:526,privilege_shop:527,shwx_collect:9987,shwx_share:9988,shwx_sub:9989},sub_type:(s={arena_call:1,dungeon_auto:2,partner_zhenfa:3,forge_house:4,guild_boss:5,startower:6,partnersummon:7,champion_call:8,endless:9,escort:10,dungeonstone:11},a(s,"endless",12),a(s,"wonderful",13),a(s,"godbattle",14),a(s,"world_boss",15),a(s,"function_icon",16),a(s,"limit_action",17),a(s,"guildwar",18),a(s,"primuswar",19),a(s,"ladderwar",20),a(s,"expedit_fight",21),a(s,"adventure",22),a(s,"eliteMatchWar",23),a(s,"seerpalace",25),a(s,"elementWar",26),s),function_type:{main:1,other:2},first_red_point:(n={},a(n,526,!0),a(n,527,!0),n),item_open_type:{normal:1,seerpalace:2,heavendial:3}};e.exports=o,cc._RF.pop()},{}],mainui_controller:[function(t,e,i){"use strict";function s(t){"@babel/helpers - typeof";return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}cc._RF.push(e,"37f9boahqlPopfky8EPYSid","mainui_controller");var n=t("mainui_const"),a=t("battle_drama_controller"),o=t("mainui_event"),l=t("action_const"),r=t("role_controller"),c=t("battle_event"),_=t("scene_const"),h=t("battle_const"),d=t("arena_const"),u=t("orderaction_const"),m=cc.Class({extends:BaseController,ctor:function(){this.ui_fight_type=n.ui_fight_type.main_scene},initConfig:function(){var e=t("mainui_model");this.model=new e,this.model.initConfig(),this.relevance_ui_last_type=0,this.relevance_battle_type=0,this.relevance_ui_fight_type=0,this.relevance_params=0,this.function_list={},this.cache_tips_list={},this.cache_wait_create_list={},this.cachesBtnRed=[],this.cachesAwardList=[]},getModel:function(){return this.model},registerEvents:function(){null==this.combat_type_back_event&&(this.combat_type_back_event=gcore.GlobalEvent.bind(c.COMBAT_TYPE_BACK,function(t,e){0==e&&this.openRelevanceWindowAtOnce(t)},this)),this.battle_exit_event||(this.battle_exit_event=gcore.GlobalEvent.bind(EventId.EXIT_FIGHT,function(t){this.openRelevanceWindowAtOnce(t)}.bind(this))),this.update_drama_max_event||(this.update_drama_max_event=gcore.GlobalEvent.bind(t("battle_drama_event").BattleDrama_Update_Max_Id,function(t){this.updateMainBtnStatus(t)}.bind(this))),null==this.init_main_event&&(this.init_main_event=gcore.GlobalEvent.bind(EventId.EVT_ROLE_CREATE_SUCCESS,function(){gcore.GlobalEvent.unbind(this.init_main_event),this.init_main_event=null,null==this.role_change_event&&(this.role_vo=r.getInstance().getRoleVo(),null!=this.role_vo&&(this.role_change_event=this.role_vo.bind(EventId.UPDATE_ROLE_ATTRIBUTE,function(t,e){"lev"==t&&(this.checkFunctionByRoleLev(e),IS_SUBMIT&&SDK.sdkSubmitUserData(4))},this)))},this))},registerProtocals:function(){this.RegisterProtocal(12742,this.on12742)},openMainUI:function(e){if(1==e){if(null==this.mainui){var i=t("mainui_view");this.mainui=new i,this.checkFunctionByRoleLev()}if(this.mainui.getHideContainerStatus()||this.mainui.open(),this.function_list)for(var s in this.function_list){var n=this.function_list[s];n&&this.mainui.addIcon(n)}}else this.mainui&&this.mainui.close()},getUIFightType:function(){return this.ui_fight_type},setUIFightType:function(t){this.ui_fight_type=t},checkIsInDramaUIFight:function(){return this.ui_fight_type==n.ui_fight_type.drama_scene},changeMainUIStatus:function(t,e,i){if(this.mainui){if(e==n.sub_type.adventure){var s=Config.city_data.data_base[_.CenterSceneBuild.adventure];if(s&&0==this.checkIsOpenByActivate(s.activate))return void message(s.desc)}this.mainui.changeMainUiStatus(t,e,i)}},requestOpenBattleRelevanceWindow:function(e,i){var s=t("battle_controller"),n=t("battle_const");this.relevance_ui_last_type=this.ui_fight_type,this.relevance_battle_type=e,this.relevance_params=i,this.relevance_ui_fight_type=n.getUIFightByFightType(e),this.setUIFightType(this.relevance_ui_fight_type),s.getInstance().send20060(e)},resetUIFightType:function(){this.relevance_ui_last_type&&(this.ui_fight_type=this.relevance_ui_last_type,this.relevance_ui_last_type=n.ui_fight_type.normal)},openRelevanceWindowAtOnce:function(e){var i=t("battle_const");if(e==i.Fight_Type.WorldBoss||e==i.Fight_Type.SingleBoss){if(this.relevance_battle_type!=i.Fight_Type.WorldBoss&&self.relevance_battle_type!=i.Fight_Type.SingleBoss)return}else if(this.relevance_battle_type!=e)return;e==i.Fight_Type.GuildDun?t("guildboss_controller").getInstance().openMainWindow(!0):e==i.Fight_Type.StarTower?t("startower_controller").getInstance().openMainView(!0):e==i.Fight_Type.Arena?t("arena_controller").getInstance().openArenaLoopMathWindow(!0):e==i.Fight_Type.Endless?t("endless_trail_controller").getInstance().openEndlessMainWindow(!0):e==i.Fight_Type.ExpeditFight?t("heroexpedit_controller").getInstance().openHeroExpeditView(!0):e==i.Fight_Type.PrimusWar?t("primus_controller").getInstance().openPrimusMainWindow(!0):e==i.Fight_Type.DungeonStone?t("stone_dungeon_controller").getInstance().openStoneDungeonView(!0):e==i.Fight_Type.GuildWar?t("guildwar_controller").getInstance().openMainWindow(!0):e==i.Fight_Type.Adventrue?t("adventure_controller").getInstance().openAdventureMainWindow(!0):e==i.Fight_Type.LimitExercise?t("limitexercise_controller").getInstance().openLimitExerciseChangeView(!0):e==i.Fight_Type.ElementWar&&t("element_controller").getInstance().openElementMainWindow(!0)},setBtnRedPoint:function(t,e){"number"==typeof t&&(this.mainui?this.mainui.updateBtnTipsPoint(t,e):this.cachesBtnRed.push([t,e]))},resetCachesRetData:function(){this.cachesBtnRed=[]},getCachesBtnRed:function(){return this.cachesBtnRed},getMainUIIndex:function(){return this.mainui?this.mainui.getMainUIIndex():n.btn_index.main_scene},on12742:function(t){0!=t.asset_list.length&&this.openGetItemView(!0,t.asset_list,t.source)},openGetItemView:function(t,e,i,s,n){if(t){if(e&&e instanceof Array&&e.length>0){if(this.exhibition_view)return void this.cachesAwardList.push({list:e,source:i,extend:s,open_type:n});this.exhibition_view||(this.exhibition_view=Utils.createClass("item_exhibition_window")),this.exhibition_view.open({list:e,source:i,extend:s,open_type:n})}}else if(this.exhibition_view)if(this.cachesAwardList.length>0){var a=this.cachesAwardList[0];this.cachesAwardList.splice(0,1),this.exhibition_view.open({list:a.list,source:a.source,extend:a.extend,open_type:n})}else this.exhibition_view.close(),this.exhibition_view=null},openCommonExplainView:function(t,e,i){if(0==t)null!=this.common_explain&&(this.common_explain.close(),this.common_explain=null);else{if(null==e||null==Utils.next(e))return;null==this.common_explain&&(this.common_explain=Utils.createClass("common_explain_window",this)),this.common_explain&&0==this.common_explain.isOpen()&&this.common_explain.open([e,i])}},iconClickHandle:function(e,i){if(null!=e)if(e==n.icon.welfare)t("welfare_controller").getInstance().openMainWindow(!0);else if(e==n.icon.mail)t("mail_controller").getInstance().openMailUI(!0);else if(e==n.icon.daily)t("task_controller").getInstance().openTaskMainWindow(!0);else if(e==n.icon.friend)t("friend_controller").getInstance().openFriendWindow(!0);else if(e==n.icon.rank)t("rank_controller").getInstance().openMainView(!0);else if(e==n.icon.charge)t("vip_controller").getInstance().openVipMainWindow(!0,VIPTABCONST.CHARGE);else if(e==n.icon.fund)t("welfare_controller").getInstance().openMainWindow(!0,n.icon.fund);else if(e==n.icon.first_charge_new||e==n.icon.first_charge_new1)t("newfirstcharge_controller").getInstance().openNewFirstChargeView(!0);else if(e==n.icon.seven_login)t("action_controller").getInstance().openSevenLoginWin(!0);else if(e==n.icon.action||e==n.icon.festival)t("action_controller").getInstance().openActionMainPanel(!0,e);else if(e==n.icon.day_charge)t("action_controller").getInstance().openActionMainPanel(!0,null,91005);else if(e==n.icon.godpartner)t("action_controller").getInstance().openActionMainPanel(!0,null,93006);else if(e==n.icon.seven_goal||e==n.icon.seven_goal1||e==n.icon.seven_goal2||e==n.icon.seven_goal3)t("action_controller").getInstance().openSevenGoalView(!0);else if(e==n.icon.lucky_treasure)t("action_controller").getInstance().openLuckyTreasureWin(!0);else if(e==n.icon.limit_gift_entry)t("action_controller").getInstance().openActionLimitGiftMainWindow(!0);else if(e==n.icon.day_first_charge)t("daycharge_controller").getInstance().openDayFirstChargeView(!0);else if(e==n.icon.vedio)t("vedio_controller").getInstance().openVedioMainWindow(!0);else if(e==n.icon.guildwar)this.requestOpenBattleRelevanceWindow(h.Fight_Type.GuildWar);else if(e==n.icon.champion)t("mainscene_controller").getInstance().openBuild(_.CenterSceneBuild.arena,d.arena_type.rank);else if(e==n.icon.limit_recruit)t("recruithero_controller").getInstance().openRecruitHeroWindow(!0);else if(e==n.icon.shrh_share)t("welfare_controller").getInstance().openMainWindow(!0,8007);else if(e==n.icon.shrh_sub)t("welfare_controller").getInstance().openMainWindow(!0,8014);else if(e==n.icon.shrh_realname)"SH_RH"==PLATFORM_TYPR&&SDK.realname({apiType:"askShow"});else if(e==u.OrderActionEntranceID.entrance_id)t("orderaction_controller").getInstance().openOrderActionMainView(!0);else if(e==n.icon.give_vip)t("vip_controller").getInstance().openVipAwardWindow(!0);else if(e==n.icon.trigger_gift){if(t("action_controller").getInstance().openTriggerGiftWindow(!0),this.getFunctionIconById(n.icon.trigger_gift)){var s=this.getFunctionIconById(n.icon.trigger_gift).getTipsStatus();s&&this.setFunctionTipsStatus(n.icon.trigger_gift,!s)}}else if(e==n.icon.privilege_shop){if(t("vip_controller").getInstance().openVipMainWindow(!0,VIPTABCONST.PRIVILEGE),this.getFunctionIconById(n.icon.privilege_shop)){var a=this.getFunctionIconById(n.icon.privilege_shop).getTipsStatus();a&&this.setFunctionTipsStatus(n.icon.privilege_shop,!a)}}else if(e==n.icon.open_server_recharge){t("action_controller").getInstance().openActionOpenServerGiftWindow(!0,l.ActionRankCommonType.open_server)}else if(e==n.icon.shwx_share)t("welfare_controller").getInstance().openMainWindow(!0,8101);else if(e==n.icon.shwx_sub)t("welfare_controller").getInstance().openMainWindow(!0,8102);else if(e==n.icon.shwx_collect)t("welfare_controller").getInstance().openMainWindow(!0,8103);else if(e==n.icon.one_gift)this.setFunctionTipsStatus(n.icon.one_gift,!1),t("vip_controller").getInstance().openVipMainWindow(!0,VIPTABCONST.DAILY_GIFT);else if(e==n.icon.skin){t("action_controller").getInstance().openBuySkinWindow(!0)}},checkMainFunctionOpenStatus:function(t,e,i){e=e||n.function_type.main,t=t||0;var s=null,a="",o=!1;return null==(s=e==n.function_type.mian?Config.function_data.data_base[t]:Config.function_data.data_info[t])||null==s.activate?(a=Utils.TI18N("\u914d\u7f6e\u6570\u636e\u5f02\u5e38"),o=!1):(a=s.desc,o=this.checkIsOpenByActivate(s.activate)),i||0!=o||message(a),o},getFunctionIconById:function(t){return this.function_list[t]},setFunctionTipsStatus:function(t,e){if("number"==typeof(t=Number(t))){var i=this.getFunctionIconById(t);if(i)i.setTipsStatus(e);else if(null==this.cache_tips_list&&(this.cache_tips_list={}),"object"==s(e)){if(null==e.bid||"number"!=typeof e.bid)return;null==this.cache_tips_list[t]&&(this.cache_tips_list[t]={}),null!=e.bid&&(this.cache_tips_list[t][e.bid]=e)}else this.cache_tips_list[t]=e;this.checkMainSceneIconStatus()}},checkMainSceneIconStatus:function(){var e=!1;for(var i in this.function_list)if(this.function_list[i]&&1==this.function_list[i].getTipsStatus()){e=!0;break}if(1!=e){var s=t("mainscene_controller").getInstance().getBuildVoList();if(s)for(var i in s)if(1==s[i].getTipsStatus()){e=!0;break}e!=this.main_scene_btn_status&&(this.main_scene_btn_status=e,this.setBtnRedPoint(n.btn_index.main_scene,this.main_scene_btn_status))}else 0==this.main_scene_btn_status&&(this.main_scene_btn_status=!0,this.setBtnRedPoint(n.btn_index.main_scene,this.main_scene_btn_status))},updateMainBtnStatus:function(t){this.mainui?this.mainui.checkUnLockStatus(t):this.max_dun_id=t,this.checkFunctionByDrama(t)},checkFunctionByRoleLev:function(e){if(null!=this.mainui){var i=r.getInstance().getRoleVo();if(null!=i){e=e||i.lev;var s=[];for(var a in Config.function_data.data_info){var l=Config.function_data.data_info[a];if(null==this.function_list[l.id]&&(1==IS_SHOW_CHARGE||0==IS_SHOW_CHARGE&&1==l.is_verifyios)&&1==l.open_type&&l.activate){var c=l.activate[0];if(c&&c[0]&&c[1]){var _=c[0],h=c[1];if("lev"==_&&e>=h)null!=(d=this.createFunctionVo(l))&&(this.function_list[l.id]=d,s.push(d),gcore.GlobalEvent.fire(o.UPDATE_FUNCTION_STATUS,l.id,!0));else if(e>=h)if("shrh_lev"==_&&"SH_RH"==PLATFORM_TYPR){if(l.id==n.icon.shrh_sub&&(1==window.SH_RH_IS_SUBSCRIBE||0==SH_RH_IS_SHOW_SUBSCRIBE))continue;if(l.id==n.icon.shrh_share&&(0==SH_RH_IS_SHOW_SHARE||1==t("welfare_controller").getInstance().getModel().getShareAwardStatus()))continue;if(l.id==n.icon.shrh_realname&&(1==window.SH_RH_IS_REALNAME||0==SH_RH_IS_SHOW_REALNAME))continue;null!=(d=this.createFunctionVo(l))&&(this.function_list[l.id]=d,s.push(d),gcore.GlobalEvent.fire(o.UPDATE_FUNCTION_STATUS,l.id,!0))}else if("shwx_lev"==_&&"SH_SDK"==PLATFORM_TYPR){if(l.id==n.icon.shwx_sub&&1==window.SH_SDK_FOLLOW)continue;if(l.id==n.icon.shwx_share&&1==t("welfare_controller").getInstance().getModel().getShareAwardStatus())continue;if(l.id==n.icon.shwx_collect&&1==t("welfare_controller").getInstance().getModel().getCollectAwardStatus())continue;var d;null!=(d=this.createFunctionVo(l))&&(this.function_list[l.id]=d,s.push(d),gcore.GlobalEvent.fire(o.UPDATE_FUNCTION_STATUS,l.id,!0))}}}}Utils.next(s)&&this.mainui&&this.mainui.addIconList(s),this.checkCacheWaitFunction()}}},checkFunctionByDrama:function(t){var e=[];for(var i in Config.function_data.data_info){var s=Config.function_data.data_info[i];if(null==this.function_list[s.id]&&(1==IS_SHOW_CHARGE||0==IS_SHOW_CHARGE&&1==s.is_verifyios)&&1==s.open_type&&s.activate){var n=s.activate[0];if(n&&n[0]&&n[1]){var a=n[0],l=n[1];if("dun"==a&&t>=l){var r=this.createFunctionVo(s);null!=r&&(this.function_list[s.id]=r,e.push(r),gcore.GlobalEvent.fire(o.UPDATE_FUNCTION_STATUS,s.id,!0))}}}}Utils.next(e)&&this.mainui&&this.mainui.addIconList(e),this.checkCacheWaitFunction()},checkCacheWaitFunction:function(){if(null!=this.cache_wait_create_list&&0!=Utils.getArrLen(this.cache_wait_create_list)){var e=r.getInstance().getRoleVo(),i=a.getInstance().getModel().getDramaData();for(var s in this.cache_wait_create_list){var l=this.cache_wait_create_list[s],c=gdata("function_data","data_info",[s]);if(null==c||null==c.activate)l=null;else{var _=c.activate[0];if(null==_[0]||null==_[1]);else{var h=_[0],d=_[1];if("lev"==h&&e&&e.lev>=d||"dun"==h&&i&&i.max_dun_id>=d){if(null!=(m=this.createFunctionVo(c))){var u=l;m.update(u),this.function_list[s]=m,this.mainui&&this.mainui.addIcon(m),l=null,gcore.GlobalEvent.fire(o.UPDATE_FUNCTION_STATUS,s,!0)}}else if(e&&e.lev>=d)if("shrh_lev"==h&&"SH_RH"==PLATFORM_TYPR){if(c.id==n.icon.shrh_sub&&(1==window.SH_RH_IS_SUBSCRIBE||0==SH_RH_IS_SHOW_SUBSCRIBE))continue;if(c.id==n.icon.shrh_share&&(0==SH_RH_IS_SHOW_SHARE||1==t("welfare_controller").getInstance().getModel().getShareAwardStatus()))continue;if(c.id==n.icon.shrh_realname&&(1==window.SH_RH_IS_REALNAME||0==SH_RH_IS_SHOW_REALNAME))continue;if(null!=(m=this.createFunctionVo(c))){u=l;m.update(u),this.function_list[s]=m,this.mainui&&this.mainui.addIcon(m),l=null,gcore.GlobalEvent.fire(o.UPDATE_FUNCTION_STATUS,s,!0)}}else if("shwx_lev"==h&&"SH_SDK"==PLATFORM_TYPR){if(c.id==n.icon.shwx_sub&&1==window.SH_SDK_FOLLOW)continue;if(c.id==n.icon.shwx_share&&1==t("welfare_controller").getInstance().getModel().getShareAwardStatus())continue;if(c.id==n.icon.shwx_collect&&1==t("welfare_controller").getInstance().getModel().getCollectAwardStatus())continue;var m;if(null!=(m=this.createFunctionVo(c))){u=l;m.update(u),this.function_list[s]=m,this.mainui&&this.mainui.addIcon(m),l=null,gcore.GlobalEvent.fire(o.UPDATE_FUNCTION_STATUS,s,!0)}}}}}}},getFucntionIconVoById:function(t){if(this.function_list&&null!=Utils.next(this.function_list||{})&&this.function_list[t])return this.function_list[t]},createFunctionVo:function(e){if(null!=e){if(e.id==n.icon.action||e.id==n.icon.festival)if(0==t("action_controller").getInstance().checkCanAddWonderful(e.id))return;var i=this.function_list[e.id];return null==i&&(i=Utils.createClass("function_icon_vo",e)),null!=this.cache_wait_create_list[e.id]&&(i.update(this.cache_wait_create_list[e.id]),delete this.cache_wait_create_list[e.id]),null!=this.cache_tips_list[e.id]&&(i.setTipsStatus(this.cache_tips_list[e.id]),this.cache_tips_list[e.id]=null),i}},addFunctionIconById:function(e){if(null!=e){var i=this.function_list[e],s=[];if(arguments.length>1)for(var l=1;l<arguments.length;++l)s.push(arguments[l]);if(i)i.update(s);else{var c=Config.function_data.data_info[e];if(null!=c&&null!=c.activate&&(0!=IS_SHOW_CHARGE||0!=c.is_verifyios)){var _=c.activate[0];if(null!=_&&null!=_[0]&&null!=_[1]){var h=_[0],d=_[1],u=r.getInstance().getRoleVo(),m=a.getInstance().getModel().getDramaData();if("lev"==h&&u&&u.lev>=d||"dun"==h&&m&&m.max_dun_id>=d)(i=this.createFunctionVo(c))&&(i.update(s),this.function_list[e]=i,this.mainui&&this.mainui.addIcon(i),gcore.GlobalEvent.fire(o.UPDATE_FUNCTION_STATUS,e,!0));else if("shrh_lev"==h&&u&&u.lev>=d){if("SH_RH"==PLATFORM_TYPR){if(c.id==n.icon.shrh_sub&&(1==window.SH_RH_IS_SUBSCRIBE||0==SH_RH_IS_SHOW_SUBSCRIBE))return;if(c.id==n.icon.shrh_share&&(0==SH_RH_IS_SHOW_SHARE||1==window.SH_RH_IS_SHARE))return;if(c.id==n.icon.shrh_realname&&(1==window.SH_RH_IS_REALNAME||0==SH_RH_IS_SHOW_REALNAME))return;(i=this.createFunctionVo(c))&&(i.update(s),this.function_list[e]=i,this.mainui&&this.mainui.addIcon(i),gcore.GlobalEvent.fire(o.UPDATE_FUNCTION_STATUS,e,!0))}}else if("shwx_lev"==h&&u&&u.lev>=d){if("SH_SDK"==PLATFORM_TYPR){if(c.id==n.icon.shwx_sub&&1==window.SH_SDK_FOLLOW)return;if(c.id==n.icon.shwx_share&&1==t("welfare_controller").getInstance().getModel().getShareAwardStatus())return;if(c.id==n.icon.shwx_collect&&1==t("welfare_controller").getInstance().getModel().getCollectAwardStatus())return;(i=this.createFunctionVo(c))&&(i.update(s),this.function_list[e]=i,this.mainui&&this.mainui.addIcon(i),gcore.GlobalEvent.fire(o.UPDATE_FUNCTION_STATUS,e,!0))}}else this.cache_wait_create_list[e]=s}}}}},removeFunctionIconById:function(t){t&&(this.function_list[t]&&(this.mainui&&this.mainui.removeIcon(t),this.function_list[t]=null,delete this.cache_wait_create_list[t],gcore.GlobalEvent.fire(o.UPDATE_FUNCTION_STATUS,t,!1)))},checkIsOpenByActivate:function(e){if(null==e||null==Utils.next(e))return!1;for(var i=t("role_controller").getInstance().getRoleVo(),s=t("battle_drama_controller").getInstance().getModel().getDramaData(),n=0;n<e.length;n++){var a=e[n];if(a){var o=a[0],l=a[1],r=0;if("lev"==o&&i?r=i.lev:"open_day"==o&&i?r=i.open_day:"vip_lev"==o&&i?r=i.vip_lev:"dun"==o&&s&&(r=s.max_dun_id),l>r)return!1}}return!0},checkIsInEndlessUIFight:function(){return this.ui_fight_type==n.ui_fight_type.endless},setMainUIBottomStatus:function(t){this.mainui&&this.mainui.setBottomStatus(t)},setMainUITopStatus:function(t){this.mainui&&this.mainui.setTopStatus(t)},getMainUiRoot:function(t){if(t)this.mainui?this.mainui.getRootWnd(t):t(null);else if(this.mainui)return this.mainui.root_wnd},getHideContainerStatus:function(){if(this.mainui&&this.mainui.getHideContainerStatus)return this.mainui.getHideContainerStatus()},getItemExhibtionRoot:function(){if(this.exhibition_view)return this.exhibition_view.root_wnd},showPower:function(t,e){this.mainui&&this.mainui.showPower(t,e)},changeHeroStatus:function(t){this.mainui&&this.mainui.changeHeroStatus(t)},showChatBtn:function(t){this.mainui&&this.mainui.showChatBtn(t)},setMainUIChatBubbleStatus:function(t){this.mainui&&this.mainui.setMainUIChatBubbleStatus(t)},getTaskTipsPanel:function(){if(this.mainui)return this.mainui.getTaskTipsPanel()},onClickPromptTipsItem:function(e){var i=t("prompt_type_const");if(e.type==i.Private_chat){for(var s={},n=0;n<e.list[0].data.arg_uint32.length;++n){var a=e.list[0].data.arg_uint32[n];1==a.key&&(s.rid=a.value)}for(var o=0;o<e.list[0].data.arg_str.length;++o){var l=e.list[0].data.arg_str[o];1==l.key&&(s.srv_id=l.value)}if(null!=Utils.next(s)){var r=t("chat_controller"),c=t("chat_const");r.getInstance().openChatPanel(c.Channel.Friend,"friend",s)}}else if(e.type==i.At_notice){for(var _=null,h=0;h<e.list[0].data.arg_uint32.length;++h){var d=e.list[0].data.arg_uint32[h];2==d.key&&(_=d.value)}(r=t("chat_controller")).getInstance().openChatPanel(null,_,null)}else if(e.type==i.Endless_trail){t("endless_trail_controller").getInstance().openEndlessBuffView(!0)}}});e.exports=m,cc._RF.pop()},{action_const:"action_const",action_controller:"action_controller",adventure_controller:"adventure_controller",arena_const:"arena_const",arena_controller:"arena_controller",battle_const:"battle_const",battle_controller:"battle_controller",battle_drama_controller:"battle_drama_controller",battle_drama_event:"battle_drama_event",battle_event:"battle_event",chat_const:"chat_const",chat_controller:"chat_controller",daycharge_controller:"daycharge_controller",element_controller:"element_controller",endless_trail_controller:"endless_trail_controller",friend_controller:"friend_controller",guildboss_controller:"guildboss_controller",guildwar_controller:"guildwar_controller",heroexpedit_controller:"heroexpedit_controller",limitexercise_controller:"limitexercise_controller",mail_controller:"mail_controller",mainscene_controller:"mainscene_controller",mainui_const:"mainui_const",mainui_event:"mainui_event",mainui_model:"mainui_model",mainui_view:"mainui_view",newfirstcharge_controller:"newfirstcharge_controller",orderaction_const:"orderaction_const",orderaction_controller:"orderaction_controller",primus_controller:"primus_controller",prompt_type_const:"prompt_type_const",rank_controller:"rank_controller",recruithero_controller:"recruithero_controller",role_controller:"role_controller",scene_const:"scene_const",startower_controller:"startower_controller",stone_dungeon_controller:"stone_dungeon_controller",task_controller:"task_controller",vedio_controller:"vedio_controller",vip_controller:"vip_controller",welfare_controller:"welfare_controller"}],mainui_event:[function(t,e,i){"use strict";cc._RF.push(e,"dcd42p1NWdFq7L3AV0jRFZi","mainui_event"),e.exports={CHATPANEL_SIZE_CHANGE:"CHATPANEL_SIZE_CHANGE",SHOW_GOODS:"SHOW_GOODS",ADD_UPDATE_BUFF:"ADD_UPDATE_BUFF",UPDATE_BUFF:"UPDATE_BUFF",Partner_Red:"Partner_Red",CLOSE_ITEM_VIEW:"CLOSE_ITEM_VIEW",UPDATE_FUNCTION_STATUS:"UPDATE_FUNCTION_STATUS",HEAD_UPDATE_WEALTH_EVENT:"HEAD_UPDATE_WEALTH_EVENT",LOADING_ENTER_SCENE:"LOADING_ENTER_SCENE"},cc._RF.pop()},{}],mainui_model:[function(t,e,i){"use strict";cc._RF.push(e,"f301aPNe4BCl5YAwxnjpuBe","mainui_model");var s=cc.Class({ctor:function(){},properties:{},initConfig:function(){}});e.exports=s,cc._RF.pop()},{}],mainui_view:[function(t,e,i){"use strict";function s(t){"@babel/helpers - typeof";return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}cc._RF.push(e,"38ef2+1QgRNDLjp7wanRv/f","mainui_view");var n=t("loadermanager"),a=t("pathtool"),o=t("playerhead"),l=t("mainui_const"),r=t("battle_const"),c=t("role_controller"),_=t("exchange_controller"),h=t("function_icon_vo"),d=t("chat_controller"),u=t("exchange_event"),m=t("login_controller"),f=t("mainui_event"),p=t("prompt_event"),g=t("prompt_controller"),v=cc.Class({extends:BaseClass,ctor:function(){this.rleasePrefab=!1,this.initConfig(),this.createRootWnd()},initConfig:function(){this.bottom_btn_list=[],this.cur_select_index=0,this.render_list=[],this.render_list_dic={},this.function_list={},this.icon_container_list={},this.icon_widget_list={},this.btn_cache_tips={},this.left_off=20,this.right_off=20,this.left_max_sum=7,this.is_in_shrink=!1,this.is_shrink=!1,this.layout_list={}},createRootWnd:function(){this.mainui_controller=t("mainui_controller").getInstance(),this.battle_controller=t("battle_controller").getInstance();var e=a.getPrefabPath("mainui","mainui_view");n.getInstance().loadRes(e,function(t){this.initMainUI(t)}.bind(this))},initMainUI:function(e){var i=this;if(this.root_wnd=e,window.isMobile||(this.root_wnd.getComponent(cc.Widget).enabled=!1),this.root_wnd.setPosition(.5*-SCREEN_WIDTH,.5*-SCREEN_HEIGHT),ViewManager.getInstance().addToSceneNode(this.root_wnd,SCENE_TAG.top),this.root_wnd_cb&&this.root_wnd_cb(this.root_wnd),this.bottom_container=this.root_wnd.getChildByName("bottom_container"),this.btn_con=this.bottom_container.getChildByName("bnt_con"),window.isMobile&&window.FIT_HEIDGHT){var s=this.btn_con.getComponent(cc.Layout),r=(SCREEN_WIDTH*FIT_SCALE-s.paddingLeft-s.paddingRight-663)/6;s.spacingX=r}for(var d=function(t){if(p=i.btn_con.getChildByName("mainui_tab_"+(t+1))){g=p.getChildByName("tips_point"),v=p.getChildByName("normal"),b=p.getChildByName("selected"),w=p.getChildByName("icon"),y=p.getChildByName("notice"),C=p.getPosition().x,k=p.getPosition().y,i.bottom_btn_list[t]={btn:p,index:t,tips_point:g,normal:v,selected:b,icon:w,notice:y,tips_status:!1,init_x:C,init_y:k};var e=Config.function_data.data_base[t+1];e&&e.activate&&(i.bottom_btn_list[t].config=e,i.bottom_btn_list[t].notice&&(i.bottom_btn_list[t].notice.getComponent(cc.Label).string=e.label)),p.on(cc.Node.EventType.TOUCH_END,function(e){this.changeMainUiStatus(t)}.bind(i)),t==l.btn_index.main_scene?i.setMaiuiBtnStatus(t):t==l.btn_index.drama_scene&&(i.bottom_btn_list[t].skeleton=w.getComponent(sp.Skeleton)),0==t&&(i.cur_select_index=t,i.cur_select_btn=i.bottom_btn_list[t],i.cur_select_btn.normal.active=!1,i.cur_select_btn.selected.active=!0,p.y=i.bottom_btn_list[t].init_y+10)}},u=0;u<7;u++){var p,g,v,b,w,y,C,k;d(u)}this.top_container=this.root_wnd.getChildByName("top_container"),this.exp_bar=this.top_container.getChildByName("exp_bar");var S=this.top_container.getChildByName("exp_bar");for(var T in gcore.Timer.set(function(){var t=S.getComponent(cc.Widget);this.exp_bar.width=this.root_wnd.width-t.left}.bind(this),.1),this.fight_con=this.top_container.getChildByName("fight_con"),this.coin_touch=this.top_container.getChildByName("coin_touch"),this.gold_touch=this.top_container.getChildByName("gold_touch"),this.Sprite_8=this.coin_touch.getChildByName("Sprite_8"),this.Sprite_10=this.gold_touch.getChildByName("Sprite_10"),this.coin_redpoint=this.coin_touch.getChildByName("Sprite_8").getChildByName("redPoint"),this.coin_redpoint.active=_.getInstance().getModel().getRedStatus(),this.head_container=this.top_container.getChildByName("head_container"),this.player_head=new o,this.player_head.setParent(this.head_container),this.player_head.show(),this.info_container=this.top_container.getChildByName("info_container"),this.lev_label=this.info_container.getChildByName("lev_label").getComponent(cc.Label),this.name_label=this.info_container.getChildByName("name_label").getComponent(cc.Label),this.coin_label_nd=this.coin_touch.getChildByName("wealth_label_1"),this.gold_label_nd=this.gold_touch.getChildByName("wealth_label_2"),this.coin_label=this.coin_label_nd.getComponent(cc.Label),this.gold_label=this.gold_label_nd.getComponent(cc.Label),this.fight_label=this.fight_con.getChildByName("fight_label").getComponent(cc.Label),this.coin_nd=this.coin_touch.getChildByName("Sprite_2"),this.gold_nd=this.gold_touch.getChildByName("Sprite_4"),this.coin_sp=this.coin_nd.getComponent(cc.Sprite),this.gold_sp=this.gold_nd.getComponent(cc.Sprite),this.hide_container=this.root_wnd.getChildByName("hide_container"),this.handle_btn=this.hide_container.getChildByName("handle_btn"),this.prompt_container=this.hide_container.getChildByName("prompt_container"),this.prompt_tips_layout=this.prompt_container.getChildByName("tips_layout"),this.prompt_bubble_layout=this.prompt_container.getChildByName("bubble_layout"),this.prompt_tips_btn=this.prompt_container.getChildByName("tips_btn"),this.prompt_desc=this.prompt_bubble_layout.getChildByName("desc").getComponent(cc.Label),this.prompt_bubble=this.prompt_bubble_layout.getChildByName("bubble"),this.prompt_bubble_size=this.prompt_bubble.getContentSize(),this.prompt_tips_scroll=this.prompt_tips_layout.getChildByName("tips_scroll"),this.prompt_tips_scroll_size=this.prompt_tips_scroll.getContentSize(),this.count_size_label=this.prompt_tips_layout.getChildByName("count_size_label").getComponent(cc.Label),this.prompt_tips_bg=this.prompt_tips_layout.getChildByName("tips_bg"),this.prompt_tips_bg_size=this.prompt_tips_bg.getContentSize(),this.prompt_tips_btn.active=!1,this.prompt_tips_layout.active=!1,this.prompt_mask=this.hide_container.getChildByName("prompt_mask"),this.hide_container=this.root_wnd.getChildByName("hide_container"),this.handle_btn=this.hide_container.getChildByName("handle_btn"),this.creatorChatBtn(),RedMgr.getInstance().addCalHandler(this.updateChatMsgNum.bind(this)),this.updateHandleBtnShowStatus(),1==USE_SDK&&"SH_SDK"==PLATFORM_TYPR&&this.creatorCustomerServiceBtn(),this.image_2=this.top_container.getChildByName("Image_2"),this.vip_label=this.image_2.getChildByName("vip_label").getComponent("CusRichText"),h.type){var I=h.type[T],E=this.hide_container.getChildByName("icon_container_"+I);if(E){this.icon_container_list[I]=E;I==h.type.right_top_1?(-8,this.top_container.getContentSize().height+15):I==h.type.right_top_2?(-8,this.top_container.getContentSize().height-100):I==h.type.right_bottom_1?(-102,E.y):I==h.type.right_bottom_2&&(320.5,-367);var B=E.getComponent(cc.Widget);B&&(this.icon_widget_list[I]=B)}}if(this.role_vo=c.getInstance().getRoleVo(),n.getInstance().loadRes(a.getItemRes("1"),function(t){this.coin_sp.spriteFrame=t}.bind(this)),n.getInstance().loadRes(a.getItemRes("3"),function(t){this.gold_sp.spriteFrame=t}.bind(this)),this.registerEvent(),this.createChallengeEffect(),this.updateRoleData(),this.max_dun_id=this.mainui_controller.max_dun_id,null!=this.max_dun_id&&this.checkUnLockStatus(this.max_dun_id),this.checkUnLockStatusByLev(),null==this.function_time_ticket&&(this.action_list=t("action_controller").getInstance().getAllActionList(),this.function_time_ticket=gcore.Timer.set(function(){this.functionTimeTicketList()}.bind(this),1e3,-1)),1==USE_SDK&&NEED_ADAPTIVE_SDK[window.PLATFORM_TYPR]&&(this.coin_nd.x=-28,this.coin_label_nd.x=29,this.Sprite_8.x=-60,this.Sprite_10.active=!1),("WX_SDK"==window.PLATFORM_TYPR||"SH_SDK"==window.PLATFORM_TYPR||"QQ_SDK"==PLATFORM_TYPR)&&window.WX_FIT){var x=this.root_wnd.height*window.WX_FIT;cc.log("\u5fae\u4fe1\u5c0f\u6e38\u620f\u9002\u914d\u83dc\u5355\u680f"),console.log("add_val");var P=this.top_container.getComponent(cc.Widget),R=this.icon_container_list[1].getComponent(cc.Widget);P.top+=x,R.top+=x}m.getInstance().updateLoading(1),this.close_login_ticket=gcore.Timer.set(function(){m.getInstance().openLoginWindow(!1),gcore.Timer.del(this.close_login_ticket),IS_LOADING=!1,"SH_RH"==PLATFORM_TYPR||"SH_SDK"==PLATFORM_TYPR?(SDK.submitLogin(),1==USE_SDK&&"SH_SDK"==PLATFORM_TYPR&&SDK.dataPlacement(90500)):1==USE_SDK&&"WX_SDK"==PLATFORM_TYPR&&SDK.loginLog(),gcore.GlobalEvent.fire(f.LOADING_ENTER_SCENE)}.bind(this),200,1),t("backpack_controller").getInstance().getModel().getHeroChipRedPoint();var N=this.mainui_controller.getCachesBtnRed();if(N){for(var U=0;U<N.length;++U)this.updateBtnTipsPoint(N[U][0],N[U][1]);this.mainui_controller.resetCachesRetData()}this.updateShenqi();var A=this.prompt_container.getComponent(cc.Widget);null==this.task_tips_panel?A.bottom=144:A.bottom=334.28,A.updateAlignment()},updateShenqi:function(){var e=this.hide_container.getChildByName("task_container"),i=6;Config.quest_data.data_const&&(i=Config.quest_data.data_const.task_open.val[1]);var s=c.getInstance().getRoleVo();if(null==this.task_tips_panel&&s.lev>=i){var n=t("task_tips_panel");this.task_tips_panel=new n(this),this.task_tips_panel.setParent(e),this.task_tips_panel.show();var a=this.prompt_container.getComponent(cc.Widget);a.bottom=334.28,a.updateAlignment()}},deleteTaskTip:function(){this.task_tips_panel&&(this.task_tips_panel.deleteMe(),this.task_tips_panel=null);var t=this.prompt_container.getComponent(cc.Widget);t.bottom=144,t.updateAlignment()},getTaskTipsPanel:function(){return this.task_tips_panel.root_wnd},createChallengeEffect:function(){var t=this.bottom_btn_list[l.btn_index.drama_scene];null!=t&&n.getInstance().loadRes("spine/E51130/action.atlas",function(e){t.skeleton.skeletonData=e,t.skeleton.setAnimation(0,"action1",!0)}.bind(this))},registerEvent:function(){this.prompt_tips_btn.on("click",function(){this._onClickPromptTips()},this),this.head_container.on(cc.Node.EventType.TOUCH_END,function(t){c.getInstance().openRoleInfoView(!0)},this),this.coin_touch.on(cc.Node.EventType.TOUCH_END,function(t){_.getInstance().openExchangeMainView(!0)},this),this.gold_touch.on(cc.Node.EventType.TOUCH_END,function(e){this.is_hero_panel?t("backpack_controller").getInstance().openTipsSource(!0,Utils.getItemConfig(22)):t("vip_controller").getInstance().openVipMainWindow(!0,VIPTABCONST.CHARGE)},this),this.handle_btn.on(cc.Node.EventType.TOUCH_END,function(t){this.shrinkBtnContainer()}.bind(this)),this.chat_newmsg_event=gcore.GlobalEvent.bind(EventId.CHAT_NEWMSG_FLAG,function(){RedMgr.getInstance().addCalHandler(this.updateChatMsgNum.bind(this))}.bind(this)),this.coin_touch_redpoint=gcore.GlobalEvent.bind(u.Extra_Reward,function(t){this.coin_redpoint.active=_.getInstance().getModel().getRedStatus()}.bind(this)),this.role_vo.bind(EventId.UPDATE_ROLE_ATTRIBUTE,function(t,e){switch(t){case"power":this.updateRolePower();break;case"lev":this.updateRoleLev(),this.checkUnLockStatusByLev(e);break;case"name":this.updateRoleName();break;case"coin":this.updateRoleCoin();break;case"gold":this.updateRoleGold();break;case"face_id":this.player_head.setHeadRes(e);break;case"avatar_base_id":this.player_head.setFrameRes(e);break;case"vip_lev":this.updateRoleVip();break;case"exp":case"exp_max":this.updateRoleExp();break;case"hero_exp":this.updateHeroExp()}},this),this.update_prompt_tips||(this.update_prompt_tips=gcore.GlobalEvent.bind(p.ADD_PROMPT_DATA,function(t){if(this.is_open&&!d.getInstance().isChatOpen()){this.showPromptBubble(t);var e=g.getInstance().getModel().getPromptList();Utils.getArrLen(e)>0&&this.showPromptTips(!0,e)}}.bind(this))),this.remove_prompt_tips||(this.remove_prompt_tips=gcore.GlobalEvent.bind(p.REMOVE_PROMPT_DATA,function(){var t=g.getInstance().getModel().getPromptList();Utils.getArrLen(t)>0?this.showPromptTips(!0,t):this.showPromptTips(!1)}.bind(this))),this.prompt_mask.on("touchend",function(){this.prompt_mask.active=!1,this.prompt_tips_layout.active=!1},this)},open:function(){this.root_wnd&&(this.handleHideContainer(!0),this.checkShowNewPromptBubble())},handleHideContainer:function(t){this.hide_container_status=t,null==this.wait_update&&(this.wait_update=gcore.Timer.set(function(){1==this.hide_container_status&&(this.is_open=this.hide_container_status,this.hide_container.active=this.is_open,this.functionUpdateList(),gcore.Timer.del(this.wait_update),this.wait_update=null)}.bind(this),200,-1))},getHideContainerStatus:function(){return this.hide_container_status},close:function(){this.hide_container&&(this.is_open=!1,this.hide_container_status=!1,this.hide_container.active=!1)},changeMainUiStatus:function(e,i,s){var n=this.bottom_btn_list[e];if(null!=n&&n.is_unlock){if(!this.checkFightClickStatus())if(this.cur_select_index!=e||e==l.btn_index.main_scene){if(this.setMaiuiBtnStatus(e),Utils.closeAllWindow(),e!=l.btn_index.Darma&&(this.battle_controller.requestCutOutBattle(),this.battle_controller.getModel().clearBattleScene(),this.changeBackgroundMusic()),e==l.btn_index.main_scene)t("mainscene_controller").getInstance().enterMainScene(!0);else if(e==l.btn_index.partner){t("hero_controller").getInstance().openHeroBagWindow(!0,i)}else if(e==l.btn_index.backpack){(a=t("backpack_controller").getInstance()).openMainWindow(!0,i)}else if(e==l.btn_index.drama_scene)this.mainui_controller.requestOpenBattleRelevanceWindow(r.Fight_Type.Darma);else if(e==l.btn_index.esecsice)t("esecsice_controller").getInstance().openEsecsiceView(!0);else if(e==l.btn_index.guild){t("guild_controller").getInstance().checkOpenGuildWindow(),t("guildskill_controller").getInstance().getModel().clearGuildSkillIconRed()}else if(e==l.btn_index.hallows){var a=t("hallows_controller").getInstance();if(s){var o=s[0],c=(e=s[1],s[2]);a.openHallowsMainWindow(!0,o,e,c)}else a.openHallowsMainWindow(!0)}this.doChangeBySubType(e,i,s)}else e==l.btn_index.drama_scene&&Utils.closeAllWindow()}else message(n.config.desc)},changeBackgroundMusic:function(){Utils.playMusic(AUDIO_TYPE.SCENE,"s_002",!0)},doChangeBySubType:function(e,i,s){null!=e&&null!=i&&(this.sub_type=i,gcore.Timer.set(function(){if(!this.sub_type||this.sub_type==i)if(e==l.btn_index.main_scene)if(i==l.sub_type.arena_call){var n=t("scene_const"),a=t("arena_const");t("mainscene_controller").getInstance().openBuild(n.CenterSceneBuild.arena,a.arena_type.loop)}else if(i==l.sub_type.champion_call){n=t("scene_const"),a=t("arena_const");t("mainscene_controller").getInstance().openBuild(n.CenterSceneBuild.arena,a.arena_type.rank)}else if(i==l.sub_type.guild_boss)this.role_vo&&0==this.role_vo.gid?message(Utils.TI18N("\u60a8\u6682\u65f6\u8fd8\u6ca1\u6709\u52a0\u5165\u516c\u4f1a")):this.mainui_controller.requestOpenBattleRelevanceWindow(r.Fight_Type.GuildDun);else if(i==l.sub_type.startower)this.mainui_controller.requestOpenBattleRelevanceWindow(r.Fight_Type.StarTower);else if(i==l.sub_type.partnersummon)t("partnersummon_controller").getInstance().openPartnerSummonWindow(!0);else if(i==l.sub_type.escort)this.mainui_controller.requestOpenBattleRelevanceWindow(r.Fight_Type.Escort,s);else if(i==l.sub_type.wonderful){if("number"==typeof s){var o=t("action_const");t("action_controller").getInstance().openActionMainPanel(!0,o.ActionType.Wonderful,s)}}else i==l.sub_type.godbattle?this.mainui_controller.requestOpenBattleRelevanceWindow(r.Fight_Type.Godbattle):i==l.sub_type.world_boss?this.mainui_controller.requestOpenBattleRelevanceWindow(r.Fight_Type.WorldBoss):i==l.sub_type.function_icon?this.mainui_controller.iconClickHandle(s):i==l.sub_type.guildwar?this.mainui_controller.requestOpenBattleRelevanceWindow(r.Fight_Type.GuildWar):i==l.sub_type.ladderwar?this.mainui_controller.requestOpenBattleRelevanceWindow(r.Fight_Type.LadderWar):i==l.sub_type.primuswar?this.mainui_controller.requestOpenBattleRelevanceWindow(r.Fight_Type.PrimusWar):i==l.sub_type.expedit_fight?this.mainui_controller.requestOpenBattleRelevanceWindow(r.Fight_Type.ExpeditFight):i==l.sub_type.endless?this.mainui_controller.requestOpenBattleRelevanceWindow(r.Fight_Type.Endless):i==l.sub_type.dungeonstone?this.mainui_controller.requestOpenBattleRelevanceWindow(r.Fight_Type.DungeonStone,s):i==l.sub_type.seerpalace?s&&"number"==typeof s?t("seerpalace_controller").getInstance().openSeerpalaceMainWindow(!0,s):t("seerpalace_controller").getInstance().openSeerpalaceMainWindow(!0):i==l.sub_type.adventure?t("adventure_controller").getInstance().requestEnterAdventure():i==l.sub_type.forge_house&&(s&&"number"==typeof s?t("forgehouse_controller").getInstance().openForgeHouseView(!0,s):t("forgehouse_controller").getInstance().openForgeHouseView(!0));else if(e==l.btn_index.drama_scene&&i==l.sub_type.dungeon_auto){var c=BattleDramaController.getInstance().getModel(),_=c.getDramaData();if(c&&_){var h=c.getSingleBossData(_.max_dun_id);BattleDramaController.getInstance().openDramBossInfoView(!0,h)}}}.bind(this),200,1))},checkFightClickStatus:function(){var e=t("battle_controller"),i=e.getInstance().getIsClickStatus(),s=e.getInstance().getModel().getCombatType();if(i){var n=t("battle_const"),a=Utils.TI18N("\u6b63\u5728\u89c2\u770b\u5f55\u50cf\u6216\u5207\u78cb\u4e2d\uff0c\u662f\u5426\u9000\u51fa?");s==n.Fight_Type.HeroTestWar&&(a=Utils.TI18N("\u6b63\u5728\u89c2\u770b\u6218\u6597\u6f14\u793a\uff0c\u662f\u5426\u5207\u6362\u754c\u9762?"));var o=function(){e.getInstance().csFightExit()}.bind(this);t("commonalert").show(a,"\u786e\u5b9a",o,"\u53d6\u6d88")}return i},setMaiuiBtnStatus:function(t){if(this.cur_select_index!=t){this.cur_select_btn&&(this.cur_select_index==l.btn_index.drama_scene?this.cur_select_btn.skeleton&&this.cur_select_btn.skeleton.skeletonData&&this.cur_select_btn.skeleton.setAnimation(0,"action1",!0):(this.cur_select_btn.normal.active=!0,this.cur_select_btn.selected.active=!1,this.cur_select_btn.btn.setPosition(this.cur_select_btn.init_x,this.cur_select_btn.init_y))),this.cur_select_index=t;var e=this.bottom_btn_list[t];this.cur_select_btn=e,e&&(this.cur_select_index==l.btn_index.drama_scene?this.cur_select_btn.skeleton&&this.cur_select_btn.skeleton.skeletonData&&this.cur_select_btn.skeleton.setAnimation(0,"action2",!0):(e.normal.active=!1,e.selected.active=!0,e.btn.setPosition(e.init_x,e.init_y+10)));var i=this.getUIFightByIndex(t);this.mainui_controller.setUIFightType(i)}},getUIFightByIndex:function(t){switch(t){case l.btn_index.main_scene:return l.ui_fight_type.main_scene;case l.btn_index.partner:return l.ui_fight_type.partner;case l.btn_index.backpack:return l.ui_fight_type.backpack;case l.btn_index.drama_scene:return l.ui_fight_type.drama_scene;case l.btn_index.esecsice:return l.ui_fight_type.esecsice;case l.btn_index.guild:return l.ui_fight_type.guild;case l.btn_index.hallows:return l.ui_fight_type.hallows;default:return l.ui_fight_type.main_scene}},getMainUIIndex:function(){return this.cur_select_index},updateChatMsgNum:function(){var t=d.getInstance().getModel().getUnreadNum();t>0?(this.chat_red_bg.active=!0,t>99&&(t="+99"),this.chat_red_num.string=t):this.chat_red_bg.active=!1},updateRoleData:function(){this.updateRoleName(),this.updateRoleLev(),this.updateRoleCoin(),this.updateRoleGold(),this.updateRolePower(),this.updateRoleHead(),this.updateRoleVip(),this.updateRoleExp(),this.updateRoleHeadFrame()},updateRoleName:function(){this.name_label.string=this.role_vo.name},updateRoleLev:function(){this.lev_label.string=this.role_vo.lev},updateRoleCoin:function(){this.coin_label.string=Utils.getMoneyString(this.role_vo.coin)},updateRoleGold:function(){this.is_hero_panel||(this.gold_label.string=Utils.getMoneyString(this.role_vo.gold))},updateRolePower:function(){this.fight_label.string=this.role_vo.power},updateRoleHead:function(){this.player_head.setHeadRes(this.role_vo.face_id)},updateRoleHeadFrame:function(){this.player_head.setFrameRes(this.role_vo.avatar_base_id)},updateRoleExp:function(){if(null!=this.role_vo&&null!=this.role_vo.exp&&null!=this.role_vo.exp_max){var t=this.role_vo.exp/this.role_vo.exp_max;this.exp_bar.scaleX=t}},checkUnLockStatus:function(t){if(null!=t){this.max_dun_id=t;for(var e=!1,i=0;i<this.bottom_btn_list.length;++i){var s=this.bottom_btn_list[i];if(s.config&&s.config.activate){var n=s.config.activate[0];"dun"==n[0]&&(e=t>=n[1])!=s.is_unlock&&(s.is_unlock=e,s.notice&&(s.notice.active=!e))}}this.updateShenqi()}},checkUnLockStatusByLev:function(t){if(null!=this.role_vo){for(var e=!1,i=0;i<this.bottom_btn_list.length;++i){var s=this.bottom_btn_list[i];if(s.config&&s.config.activate){var n=s.config.activate[0];"lev"==n[0]&&(e=this.role_vo.lev>=n[1])!=s.is_unlock&&(s.is_unlock=e,s.notice&&(s.notice.active=!e))}}null==this.task_tips_panel&&this.updateShenqi()}},addIconList:function(t){if(null!=t&&null!=Utils.next(t)){for(var e in t){var i=t[e];null!=i&&null!=i.config&&(this.checkIconIn(i.config.id)||(this.render_list_dic[i.config.id]=i,this.render_list.push(i)))}null!=this.render_list&&Utils.next(null!=this.render_list)&&this.render_list.sort(Utils.tableLowerSorter(["pos","sort"])),null==this.add_function_timer&&(this.add_function_timer=gcore.Timer.set(function(){this.createFunctionIcon()}.bind(this),2/60,-1))}},addIcon:function(t){null==t||null==t.config||this.checkIconIn(t.config.id)||(this.render_list_dic[t.config.id]=t,this.render_list.push(t),this.render_list.sort(Utils.tableLowerSorter(["pos","sort"])),null==this.add_function_timer&&(this.add_function_timer=gcore.Timer.set(function(){this.createFunctionIcon()}.bind(this),2/60,-1)))},checkIconIn:function(t){return null!=this.function_list[t]||null!=this.render_list_dic[t]},removeIcon:function(t){var e=gdata("function_data","data_info",[t]);if(null!=e){for(var i in null!=this.function_list[t]&&this.function_list[t].deleteMe&&(this.function_list[t].deleteMe(),this.function_list[t]=null),this.render_list)if(this.render_list[i].config.id==t){this.render_list.splice(i,1);break}if(this.render_list_dic[t]=null,null!=this.layout_list&&null!=this.layout_list[e.type]){for(var i in this.layout_list[e.type]){var s=this.layout_list[e.type][i];if(s&&s.config.id==t){this.layout_list[e.type].splice(i,1);break}}this.updateIconLayout(e.type)}}},createFunctionIcon:function(){if(this.root_wnd)if(null!=this.render_list&&null!=Utils.next(this.render_list)){var t=this.render_list.splice(0,1)[0];null!=t&&(this.render_list_dic[t.config.id]=null,t.config&&0==t.config.is_show||this.addItemToTabArray(t))}else null!=this.add_function_timer&&(gcore.Timer.del(this.add_function_timer),this.add_function_timer=null)},addItemToTabArray:function(t){if(null!=t&&null!=t.config){null==this.layout_list&&(this.layout_list={}),null==this.layout_list[t.config.type]&&(this.layout_list[t.config.type]=[]);var e=!0;for(var i in this.layout_list[t.config.type]){var s=this.layout_list[t.config.type][i];if(s.config.id==t.config.id){s=t,e=!1;break}}t.is_new=e,this.layout_list[t.config.type].push(t),this.layout_list[t.config.type].sort(Utils.tableLowerSorter(["sort"])),this.updateIconLayout(t.config.type)}},updateIconLayout:function(e){if(null!=this.layout_list&&null!=this.layout_list[e]&&null!=Utils.next(this.layout_list[e])){var i=this.getContainerByType(e);if(null!=i){for(var s=Utils.getArrLen(this.layout_list[e]),n=null,a=0;a<s;a++){var o=this.layout_list[e][a];if(o&&o.config){if(null==this.function_list[o.config.id])if(1==o.is_new)o.is_new=!1,(n=new(t("function_icon_panel"))(o)).show(),n.setParent(i),this.function_list[o.config.id]=n;null!=(n=this.function_list[o.config.id])&&this.setIconPosition(n,a,i,e)}}this.root_wnd&&this.updateHandleBtnShowStatus()}}},updateHandleBtnShowStatus:function(){var t=this.layout_list[h.type.right_bottom_1],e=this.layout_list[h.type.right_bottom_2];t||e?(t&&t.length||e&&e.length)&&(this.handle_btn.active=!0):this.handle_btn.active=!1},getContainerByType:function(t){if(null!=this.icon_container_list)return this.icon_container_list[t]},setIconPosition:function(t,e,i,s){i.getContentSize();var n=0,a=0;s==h.type.right_top_1?(n=.5*-t.width-e%this.left_max_sum*(this.left_off+t.width),a=.5*-t.height-Math.floor(e/this.left_max_sum)*(10+t.height)):s==h.type.right_bottom_1?n=.5*-t.width-e%this.left_max_sum*(this.left_off+t.width):s==h.type.right_bottom_2?a=.5*t.height+e*(t.height+this.right_off):s==h.type.right_top_2&&(n=.5*-t.width,a=.5*-t.height-e*(t.height+10)),null!=t.original&&Utils.getNorKey(t.original.x,t.original.y)==Utils.getNorKey(n,a)||(t.setPosition(n,a),t.original=cc.v2(n,a));var o=0;if(s==h.type.right_top_1)o=Math.abs(a-10-.5*t.height);else if(s==h.type.right_top_2){var l=this.layout_list[h.type.right_top_1];if(l){var r=Utils.getArrLen(l),c=.5*t.height-Math.ceil(r/this.left_max_sum)*(10+t.height);o=Math.abs(c-10-.5*t.height)}}if(0!=o&&this.top_2_off_y!=o){this.top_2_off_y=o;var _=this.icon_container_list[h.type.right_top_1],d=this.icon_container_list[h.type.right_top_2];_&&d&&(d.y=_.y-o)}},functionTimeTicketList:function(){if(this.function_list&&null!=Utils.next(this.function_list))for(var t in this.function_list){var e=this.function_list[t];e&&e.data&&e.data.end_time&&e.data.end_time>0&&e.updateTime&&e.updateTime()}if(this.action_list&&null!=Utils.next(this.action_list))for(var i in this.action_list){var s=this.action_list[i];s&&s.updateTime&&s.remain_sec&&s.remain_sec>0&&s.updateTime()}},functionUpdateList:function(){if(this.function_list&&null!=Utils.next(this.function_list))for(var t in this.function_list){var e=this.function_list[t];e&&e.updateIconRes&&e.updateIconRes()}},setBottomStatus:function(t){this.bottom_container&&(this.bottom_container.active=t)},setTopStatus:function(t){this.top_container&&(this.top_container.active=t)},updateRoleVip:function(){this.vip_label.setNum(this.role_vo.vip_lev)},updateBtnTipsPoint:function(t,e){if(this.bottom_btn_list[t]){if(null==e)this.btn_cache_tips[t]=null;else if("object"!=s(e))this.btn_cache_tips[t]=e;else if(null==this.btn_cache_tips[t]&&(this.btn_cache_tips[t]={}),null!=e.bid)this.btn_cache_tips[t][e.bid]=e.status;else for(var i in e)null!=e[i].bid&&(this.btn_cache_tips[t][e[i].bid]=e[i].status);var n=!1;if(this.btn_cache_tips[t])if("object"==s(this.btn_cache_tips[t])){for(var i in this.btn_cache_tips[t])if(1==this.btn_cache_tips[t][i]){n=!0;break}}else n=this.btn_cache_tips[t];var a=this.bottom_btn_list[t];a&&a.tips_status!=n&&(a.tips_status=n,a.tips_point&&(a.tips_point.active=n))}},getRootWnd:function(t){this.root_wnd_cb=t,this.root_wnd&&this.root_wnd_cb(this.root_wnd)},shrinkBtnContainer:function(){if(1!=this.is_in_shrink){this.is_in_shrink=!0;var t=this.icon_container_list[h.type.right_bottom_1],e=this.icon_container_list[h.type.right_bottom_2];this.is_shrink=!this.is_shrink,t.active=!0,e.active=!0;var i=null,s=null,n=null,a=null;1==this.is_shrink?(i=cc.moveBy(.1,cc.v2(100,0)),s=cc.moveBy(.1,cc.v2(0,-100)),n=cc.fadeOut(.1),a=cc.fadeOut(.1)):(i=cc.moveBy(.1,cc.v2(-100,0)),s=cc.moveBy(.1,cc.v2(0,100)),n=cc.fadeIn(.1),a=cc.fadeIn(.1));var o=cc.callFunc(function(){this.is_in_shrink=!1,1==this.is_shrink&&(t.active=!1)}.bind(this)),l=cc.callFunc(function(){1==this.is_shrink&&(e.active=!1)}.bind(this));t.runAction(cc.sequence(cc.spawn(i,n),o)),e.runAction(cc.sequence(cc.spawn(s,a),l))}},showPower:function(t,e){t&&e&&(null==this.power_show_nd?n.getInstance().loadRes(a.getPrefabPath("mainui","power_show"),function(i){if(this.power_show_nd)this.runPowerAction(t,e);else{this.power_show_nd=i,ViewManager.getInstance().addToSceneNode(this.power_show_nd,SCENE_TAG.dialogue),this.power_show_nd.setPosition(.5*-SCREEN_WIDTH,.5*-SCREEN_HEIGHT);var s=this.power_show_nd.getChildByName("container");this.power_show_nd.power_sk=s.getChildByName("ani_con").getComponent(sp.Skeleton);var o=s.getChildByName("txt_con");this.power_show_nd.old_power_rb=o.getChildByName("old_power").getComponent(cc.RichText),cc.sys.browserType==cc.sys.BROWSER_TYPE_IE&&(this.power_show_nd.old_power_rb.lineHeight=60),this.power_show_nd.add_power_lb=o.getChildByName("add_power").getComponent(cc.Label);var l=a.getEffectRes(179),r=a.getSpinePath(l);n.getInstance().loadRes(r,function(i){this.power_show_nd.power_sk.skeletonData=i,this.runPowerAction(t,e)}.bind(this))}}.bind(this)):this.runPowerAction(t,e))},runPowerAction:function(t,e){this.power_show_nd.power_sk.setAnimation(0,"action",!1),this.add_timer&&(gcore.Timer.del(this.add_timer),this.add_timer=null),this.power_show_nd.stopAllActions();var i=e+"",s="";if(cc.sys.browserType==cc.sys.BROWSER_TYPE_IE)s=i;else for(var n in i)s+="<img src='type23_"+i[n]+"'/>";this.calcu_num=0,this.add_timer=gcore.Timer.set(function(t){this.calcu_num+=1,this.calcu_num<5?this.power_show_nd.add_power_lb.string="+"+Math.ceil(.2*this.calcu_num*t):this.power_show_nd.add_power_lb.string="+"+t}.bind(this,t),200,5),this.power_show_nd.old_power_rb.string=s,this.power_show_nd.opacity=255,console.log("\u8f93\u51fa\u5b57\u7b26\u4e32",this.power_show_nd.old_power_rb.string),console.log("\u8f93\u51fa\u5b57\u7b26\u4e32",s);var a=new cc.delayTime(1),o=new cc.fadeOut(1),l=new cc.callFunc(function(){this.add_timer&&(gcore.Timer.del(this.add_timer),this.add_timer=null),this.power_show_nd&&(this.power_show_nd.destroy(),this.power_show_nd=null)}.bind(this)),r=cc.sequence(a,o,l);this.power_show_nd.runAction(r)},updateHeroExp:function(){this.is_hero_panel&&(this.gold_label.string=Utils.getMoneyString(this.role_vo.hero_exp))},changeHeroStatus:function(t){this.is_hero_panel=t,t?(n.getInstance().loadRes(a.getItemRes("22"),function(t){this.gold_sp.spriteFrame=t}.bind(this)),this.gold_label.string=Utils.getMoneyString(this.role_vo.hero_exp)):(n.getInstance().loadRes(a.getItemRes("3"),function(t){this.gold_sp.spriteFrame=t}.bind(this)),this.gold_label.string=Utils.getMoneyString(this.role_vo.gold))},creatorChatBtn:function(){this.chat_btn_nd=new cc.Node("chat_btn");var e=this.chat_btn_nd.addComponent(cc.Widget);e.isAlignBottom=!0,e.bottom=367,this.chat_btn_nd.x=317,ViewManager.getInstance().addToSceneNode(this.chat_btn_nd,SCENE_TAG.top);var i=this.chat_btn_nd.addComponent(cc.Button);i.transition=cc.Button.Transition.SCALE,i.zoomScale=.9,i.duration=.1,n.getInstance().loadRes(a.getUIIconPath("mainui","mainui_chat_main_icon"),function(t){this.chat_btn_nd.addComponent(cc.Sprite).spriteFrame=t}.bind(this)),this.chat_red_bg=new cc.Node("chat_red_bg"),n.getInstance().loadRes(a.getUIIconPath("mainui","mainui_1034"),function(t){this.chat_red_bg.addComponent(cc.Sprite).spriteFrame=t}.bind(this)),this.chat_btn_nd.addChild(this.chat_red_bg),this.chat_red_bg.setPosition(23,25),this.chat_red_bg.active=!1,this.chat_red_num=new cc.Node("chat_red_num").addComponent(cc.Label),this.chat_red_num.fontSize=18,this.chat_red_num.lineHeight=18,this.chat_red_num.horizontalAlign=cc.macro.TextAlignment.CENTER,this.chat_red_num.verticalAlign=cc.macro.TextAlignment.CENTER,this.chat_red_bg.addChild(this.chat_red_num.node);var s=cc.v2(),o=!1;this.chat_btn_nd.on("touchstart",function(t){o=!1,s=t.getLocation()},this),this.chat_btn_nd.on("touchmove",function(t){var e=t.getLocation();o||0==(Math.abs(e.x-s.x)<=30&&Math.abs(e.y-s.y)<=30)&&(o=!0);if(o){if(e=ViewManager.getInstance().getSceneNode(SCENE_TAG.top).convertToNodeSpaceAR(e),!this.checkPosInRect(e))return;this.chat_btn_nd.setPosition(e)}},this),this.chat_btn_nd.on("touchend",function(e){0==o&&(Utils.playButtonSound(1),t("chat_controller").getInstance().openChatPanel(),this.showChatBtn(!1))},this),t("guide_controller").getInstance().isInGuide()&&this.setMainUIChatBubbleStatus(!1)},setMainUIChatBubbleStatus:function(t){this.chat_bubble_status=t,this.chat_btn_nd.stopAllActions(),t?this.root_wnd.runAction(cc.sequence(cc.delayTime(.2),cc.callFunc(function(){1==this.chat_bubble_status&&this.showChatBtn(this.chat_bubble_status)},this))):this.showChatBtn(this.chat_bubble_status)},checkPosInRect:function(t){var e=this.root_wnd.getContentSize(),i=-e.width/2+40,s=e.width/2-40,n=e.height/2-(this.top_container.height+60),a=-e.height/2+(this.bottom_container.height+60);return!(t.x<i)&&(!(t.y<a)&&(!(t.x>s)&&!(t.y>n)))},showChatBtn:function(t){this.chat_btn_nd&&(this.chat_btn_nd.active=t)},checkShowNewPromptBubble:function(){var t=g.getInstance().getModel(),e=t.getNotBubblePrompt();e&&this.showPromptBubble(e);var i=t.getPromptList();Utils.getArrLen(i)>0&&this.showPromptTips(!0,i)},showPromptBubble:function(t){if(t){t.setShowBubbleStatus(!0),this.prompt_bubble_layout.stopAllActions(),this.prompt_tips_btn.active=!0,this.prompt_bubble_layout.active=!0,this.prompt_desc.string=t.name,this.prompt_desc._forceUpdateRenderData();var e=this.prompt_desc.node.getContentSize();this.prompt_bubble.setContentSize(cc.size(e.width+60,this.prompt_bubble_size.height));var i=cc.fadeIn(.7),s=cc.fadeOut(.7);this.prompt_bubble_layout.runAction(cc.sequence(i,s))}},showPromptTips:function(t,e){var i=this;if(cc.log(t,e,"showPromptTips"),1==t&&e&&null!=Utils.next(e)){this.prompt_tips_btn.active=!0,this.prompt_tips_scroll.destroyAllChildren();for(var s=0,o=0;o<e.length;++o){var l=e[o];this.count_size_label.string=l.name,this.count_size_label._forceUpdateRenderData();var r=this.count_size_label.node.getContentSize();s<r.width&&(s=r.width)}s<168&&(s=168),s+=20;var c=Utils.getArrLen(e),_=a.getUIIconPath("mainui","mainui_tips_bg1"),h=Math.max(this.prompt_tips_scroll_size.height,61*c),d=Math.min(61*c,160),u=s+4,m=u+(this.prompt_tips_bg_size.width-this.prompt_tips_scroll_size.width);this.prompt_tips_scroll.setContentSize(cc.size(u,d)),this.prompt_tips_bg.setContentSize(cc.size(m,d+60)),d>160&&this.prompt_tips_scroll.setContentSize(cc.size(u,h));for(var f=function(t){var a=e[t],o=new cc.Node,l=o.addComponent(cc.Sprite);l.type=cc.Sprite.Type.SLICED,l.sizeMode=cc.Sprite.SizeMode.CUSTOM,o.setPosition(u/2,5+61*t),o.setContentSize(cc.size(s,49)),o.setAnchorPoint(.5,0),n.getInstance().loadRes(_,function(t){l.spriteFrame=t}.bind(i)),i.prompt_tips_scroll.addChild(o);var r=(new cc.Node).addComponent(cc.Label);r.node.color=(new cc.Color).fromHEX(Config.color_data.data_color16[175]),r.string=a.name,r.fontSize=22,r.lineHeight=26,r.node.y=24.5,o.addChild(r.node);var c=o.addComponent(cc.Button);c.transition=cc.Button.Transition.SCALE,c.duration=.1,c.zoomScale=.9,o.on("touchend",function(){this.prompt_mask.active=!1,this.mainui_controller.onClickPromptTipsItem(a),this.prompt_tips_layout.active=!1},i)},p=0;p<e.length;++p)f(p)}else this.prompt_tips_btn.active=!1,this.prompt_tips_layout.active=!1,this.prompt_mask&&(this.prompt_mask.active=!1)},_onClickPromptTips:function(){this.prompt_tips_layout.active?(this.prompt_tips_layout.active=!1,this.prompt_mask&&(this.prompt_mask.active=!1)):(this.prompt_tips_layout.active=!0,this.prompt_mask&&(this.prompt_mask.active=!0))},creatorCustomerServiceBtn:function(){this.customer_service&&(this.customer_service.deleteMe(),this.customer_service=null),this.customer_service=Utils.createClass("customer_service_window");var e=t("viewmanager").getInstance().getSceneNode(SCENE_TAG.loading);this.customer_service.setParent(e),this.customer_service.show()}});e.exports=v,cc._RF.pop()},{action_const:"action_const",action_controller:"action_controller",adventure_controller:"adventure_controller",arena_const:"arena_const",backpack_controller:"backpack_controller",battle_const:"battle_const",battle_controller:"battle_controller",chat_controller:"chat_controller",commonalert:"commonalert",esecsice_controller:"esecsice_controller",exchange_controller:"exchange_controller",exchange_event:"exchange_event",forgehouse_controller:"forgehouse_controller",function_icon_panel:"function_icon_panel",function_icon_vo:"function_icon_vo",guide_controller:"guide_controller",guild_controller:"guild_controller",guildskill_controller:"guildskill_controller",hallows_controller:"hallows_controller",hero_controller:"hero_controller",loadermanager:"loadermanager",login_controller:"login_controller",mainscene_controller:"mainscene_controller",mainui_const:"mainui_const",mainui_controller:"mainui_controller",mainui_event:"mainui_event",partnersummon_controller:"partnersummon_controller",pathtool:"pathtool",playerhead:"playerhead",prompt_controller:"prompt_controller",prompt_event:"prompt_event",role_controller:"role_controller",scene_const:"scene_const",seerpalace_controller:"seerpalace_controller",task_tips_panel:"task_tips_panel",viewmanager:"viewmanager",vip_controller:"vip_controller"}],mall_action_window:[function(t,e,i){"use strict";cc._RF.push(e,"d238dS87aRG/IiJ48OB85Gm","mall_action_window");var s=t("pathtool"),n=t("mall_controller"),a=t("mall_event"),o=t("common_scrollview"),l=t("role_controller"),r=t("timetool"),c=t("mall_item"),_=t("mall_const"),h=t("role_event");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("mall","mall_action_window"),this.win_type=WinType.Full,this.ctrl=n.getInstance(),this.role_vo=l.getInstance().getRoleVo()},initConfig:function(){this.tab_list={},this.cur_tab=null},openCallBack:function(){var t=this;t.background=t.root_wnd.getChildByName("background"),null!=t.background&&this.loadRes(s.getUIIconPath("bigbg","bigbg_2","jpg"),function(e){t.background.getComponent(cc.Sprite).spriteFrame=e}.bind(this)),t.background.scale=FIT_SCALE,t.mainContainer=t.root_wnd.getChildByName("main_container"),t.main_panel=t.mainContainer.getChildByName("main_panel"),t.tableContainer=t.main_panel.getChildByName("tab_container");for(var e=1;e<5;++e){var i=t.tableContainer.getChildByName("tab_btn_"+e);i.getChildByName("tab_tips").active=!1,i.getChildByName("red_num").active=!1,i.getChildByName("select_bg").active=!1,i.active=!1,t.tab_list[e]=i}t.container=t.main_panel.getChildByName("container"),t.btn=t.container.getChildByName("btn"),t.btn_label=t.btn.getChildByName("txt"),t.btn.active=!1,t.coin_bg=t.container.getChildByName("Image_50"),t.coin=t.container.getChildByName("coin"),t.count=t.container.getChildByName("count"),t.add_btn=t.container.getChildByName("add_btn"),t.add_btn.active=!1,t.refresh_count=t.container.getChildByName("refresh_count"),t.refresh_count.getComponent(cc.Label).string="",t.tips_btn=t.container.getChildByName("tips_btn"),t.tips_btn.active=!1,t.time=t.container.getChildByName("time").getComponent(cc.Label),t.time.node.active=!1,t.good_cons=t.container.getChildByName("good_cons"),t.winTitle=t.main_panel.getChildByName("win_title"),t.winTitle.getComponent(cc.Label).string="\u6d3b\u52a8\u5546\u57ce",t.close_btn=t.main_panel.getChildByName("close_btn")},registerEvent:function(){var t=this;this.addGlobalEvent(a.Update_Action_event,function(t){this.updateData(t)}.bind(this)),this.addGlobalEvent(a.Buy_Action_Shop_Success_event,function(t){if(this.action_data_list&&this.cur_index&&this.action_data_list[this.cur_index]&&this.action_data_list[this.cur_index].bid==t.bid)for(var e=this.action_data_list[this.cur_index].exchange_list,i=this.common_scrollview.data_list,s=0;s<i.length;++s){var n=i[s];n.index&&e[n.index].aim==t.aim&&(e[n.index].buy_count=t.buy_count,this.common_scrollview&&this.common_scrollview.updateItemData(n.index,this.convertItemInfo(e[n.index])))}}.bind(this)),null==this.role_assets_event&&(this.role_assets_event=this.role_vo.bind(h.UPDATE_ROLE_ACTION_ASSETS,function(t,e){this.action_data_list&&this.cur_index&&this.action_data_list[this.cur_index]&&t==this.action_data_list[this.cur_index].need_id&&(this.count.getComponent(cc.Label).string=e)}.bind(this)));var e=function(e){t.tab_list[e].on("click",function(){this.changeTabView(e,!0)},t)};for(var i in this.tab_list)e(i);this.close_btn.on("click",function(){Utils.playButtonSound(2),this.onCloseBtn()},this)},openRootWnd:function(t){this.first_bid=t,this.ctrl.send16660()},updateData:function(t){if(t&&(!t.holiday_exchanges||null!=Utils.next(t.holiday_exchanges))){this.dic_item_config={},this.action_data_list={},this.cur_index=1,t.holiday_exchanges.sort(function(t,e){return t.bid-e.bid});for(var e=0;e<t.holiday_exchanges.length;++e){var i=t.holiday_exchanges[e],s=e+1;this.tab_list[s]&&(this.tab_list[s].getChildByName("title").getComponent(cc.Label).string=i.exchange_name,this.tab_list[s].active=this,this.first_bid&&this.first_bid==i.bid&&(this.cur_index=s)),i.exchange_list.sort(function(t,e){return t.aim-e.aim}),this.action_data_list[s]=i}this.changeTabView(this.cur_index)}},changeTabView:function(t,e){t=Number(t);if(!e||this.cur_index!=t){if(null!=this.cur_tab&&(this.cur_tab&&this.cur_tab.getChildByName("title").color.fromHEX(Config.color_data.data_color16[2]),this.cur_tab.getChildByName("select_bg").active=!1),this.cur_index=t,this.cur_tab=this.tab_list[t],null!=this.cur_tab)this.cur_tab.getChildByName("title").color.fromHEX(Config.color_data.data_color16[2]),this.cur_tab.getChildByName("select_bg").active=!0;this.tips_btn.active=!1,this.updateScrollviewList(),this.updateInfo()}},updateScrollviewList:function(){if(null==this.common_scrollview){var t=this.good_cons.getContentSize(),e={item_class:c,start_x:4,space_x:0,start_y:5,space_y:0,item_width:306,item_height:147,row:1,col:2,delay:4,once_num:1};this.common_scrollview=new o,this.common_scrollview.createScroll(this.good_cons,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,t,e,cc.v2(0,0))}for(var i=[],s=0;s<this.action_data_list[this.cur_index].exchange_list.length;++s){var n=this.action_data_list[this.cur_index].exchange_list[s];i.push(this.convertItemInfo(n))}this.common_scrollview.setData(i,function(t){this.ctrl.openMallBuyWindow(!0,t)}.bind(this))},convertItemInfo:function(t){return{item_id:t.item_list[0].bid,item_num:t.item_list[0].num,price:t.expend_num,pay_type:t.expend_id,shop_type:_.MallType.ActionShop,aim:t.aim,is_show_limit_label:!1,limit_count:t.limit_buy,name:t.aim_str,has_buy:t.buy_count,bid:this.action_data_list[this.cur_index].bid,lable:t.lable}},updateInfo:function(){var t=this.action_data_list[this.cur_index].need_id,e=Utils.getItemConfig(t);if(e&&0!=t){var i=s.getItemRes(e.icon);null!=this.record_cost_res&&this.record_cost_res==i||this.loadRes(i,function(t){this.coin.getComponent(cc.Sprite).spriteFrame=t}.bind(this)),this.coin_bg.active=!0,this.coin.active=!0,this.count.active=!0}else this.coin_bg.active=!1,this.coin.active=!1,this.count.active=!1;var n=this.role_vo.getActionAssetsNumByBid(t);this.count.getComponent(cc.Label).string=n,this.time.node.active=!0;var a=this.action_data_list[this.cur_index].end_time-gcore.SmartSocket.getTime();a<0&&(a=0),this.setLessTime(a)},setLessTime:function(t){this.time&&(t>0?(this.setTimeFormatString(t),null==this.time_tichet&&(this.time_tichet=gcore.Timer.set(function(){t--,this.setTimeFormatString(t),t<0&&(gcore.Timer.del(this.time_tichet),this.time_tichet=null,this.setTimeFormatString(t))}.bind(this),1e3,-1))):this.setTimeFormatString(t))},setTimeFormatString:function(t){this.rest_time=t,this.time.string=t>0?"\u5269\u4f59\u65f6\u95f4:"+r.getTimeFormatDayIIIIII(t):"\u5269\u4f59\u65f6\u95f4: 0"},onCloseBtn:function(){this.ctrl.openMallActionWindow(!1)},closeCallBack:function(){this.time_tichet&&(gcore.Timer.del(this.time_tichet),this.time_tichet=null),this.common_scrollview&&(this.common_scrollview.deleteMe(),this.common_scrollview=null),this.role_assets_event&&(this.role_vo.unbind(this.role_assets_event),this.role_assets_event=null),this.ctrl.openMallActionWindow(!1)}});cc._RF.pop()},{common_scrollview:"common_scrollview",mall_const:"mall_const",mall_controller:"mall_controller",mall_event:"mall_event",mall_item:"mall_item",pathtool:"pathtool",role_controller:"role_controller",role_event:"role_event",timetool:"timetool"}],mall_buy_window:[function(t,e,i){"use strict";cc._RF.push(e,"8ac90kXE79Ht4zO+F6gRbI6","mall_buy_window");var s=t("mall_controller"),n=t("mall_const"),a=t("backpack_controller"),o=t("role_controller"),l=t("commonalert"),r=cc.Class({extends:BaseView,ctor:function(){this.prefabPath=PathTool.getPrefabPath("mall","mall_buy_panel"),this.ctrl=s.getInstance(),this.is_can_buy_max=!1,this.win_type=WinType.Mini},openCallBack:function(){this.background=this.root_wnd.getChildByName("background"),this.background.scale=FIT_SCALE,this.main_container=this.root_wnd.getChildByName("main_container"),this.title_con=this.main_container.getChildByName("title_con"),this.title_label=this.title_con.getChildByName("title_label").getComponent(cc.Label),this.title_label.string=Utils.TI18N("\u8d2d\u4e70"),this.ok_btn=this.main_container.getChildByName("ok_btn"),this.ok_btn_label=this.ok_btn.getChildByName("Label").getComponent(cc.Label),this.ok_btn_label.string=Utils.TI18N("\u8d2d\u4e70"),this.cancel_btn=this.main_container.getChildByName("cancel_btn"),this.cancel_btn_label=this.cancel_btn.getChildByName("Label").getComponent(cc.Label),this.cancel_btn_label.string=Utils.TI18N("\u53d6\u6d88"),this.close_btn=this.main_container.getChildByName("close_btn"),this.item_con=this.main_container.getChildByName("item_con"),this.name=this.item_con.getChildByName("name").getComponent(cc.Label),this.coin=this.item_con.getChildByName("coin").getComponent(cc.Sprite),this.price=this.item_con.getChildByName("price").getComponent(cc.Label),this.limit=this.item_con.getChildByName("limit").getComponent(cc.Label),this.icon_bg_nd=this.seekChild(this.item_con,"Image_1"),this.goods=this.main_container.getChildByName("goods"),this.goods_item=ItemsPool.getInstance().getItem("backpack_item"),this.goods_item.initConfig(!1,1,!1,!1),this.goods_item.setParent(this.goods),this.goods_item.show(),this.info_con=this.main_container.getChildByName("info_con"),this.slider=this.info_con.getChildByName("slider").getComponent(cc.Slider),this.progress=this.info_con.getChildByName("ProgressBar").getComponent(cc.ProgressBar),this.plus_btn=this.info_con.getChildByName("plus_btn"),this.buy_count=this.info_con.getChildByName("buy_count").getComponent(cc.Label),this.num=1,this.buy_count.string=this.num,this.min_btn=this.info_con.getChildByName("min_btn"),this.max_btn=this.info_con.getChildByName("max_btn"),this.total_price_title_lb=this.seekChild(this.info_con,"total_price_title",cc.Label),this.total_price=this.info_con.getChildByName("total_price").getComponent(cc.Label),this.buy_desc_lb=this.seekChild("buy_desc",cc.Label),this.tips_label=this.seekChild("tips_label"),this.setData(this.data)},registerEvent:function(){this.slider&&this.slider.node.on("slide",function(){this.setCurUseItemInfoByPercent(this.slider.progress),this.progress.progress=this.slider.progress},this),this.close_btn&&this.close_btn.on(cc.Node.EventType.TOUCH_END,function(){this.ctrl.openMallBuyWindow(!1)},this),this.background&&this.background.on(cc.Node.EventType.TOUCH_END,function(){this.ctrl.openMallBuyWindow(!1)},this),this.min_btn&&this.min_btn.on(cc.Node.EventType.TOUCH_END,function(){0!=this.slider.progress&&0!=this.num&&(this.num=this.num-1,this.setCurUseItemInfoByNum(this.num))},this),this.plus_btn&&this.plus_btn.on(cc.Node.EventType.TOUCH_END,function(){1!=this.slider.progress&&(this.num>=this.limit_num-this.data.has_buy||(this.num=this.num+1,this.setCurUseItemInfoByNum(this.num)))},this),this.max_btn&&this.max_btn.on(cc.Node.EventType.TOUCH_END,function(){1!=this.slider.progress&&(this.num>=this.limit_num-this.data.has_buy||(this.num=this.limit_num-this.data.has_buy,this.setCurUseItemInfoByNum(this.num)))},this),this.ok_btn&&this.ok_btn.on(cc.Node.EventType.TOUCH_END,function(){this.data&&(this.ctrl.openMallBuyWindow(!1),2==this.data.shop_type?this.showAlert(this.data):this.data.shop_type==n.MallType.ActionShop?this.ctrl.send16661(this.data.bid,this.data.aim,this.num):this.data.shop_type==n.MallType.SteriousShop?t("action_controller").getInstance().sender16689(this.data.aim,this.num):4!=this.data.shop_type&&2!=this.data.shop_type&&15!=this.data.shop_type?16==this.data.shop_type?this.ctrl.sender13407(this.data.order,this.data.shop_type,1):this.data.shop_type==n.MallType.SkillShop?this.showGoldAlert(this.data):this.ctrl.sender13402(this.data.id,this.num):this.ctrl.sender13407(this.data.order,this.data.shop_type,1))},this),this.cancel_btn&&this.cancel_btn.on(cc.Node.EventType.TOUCH_END,function(){this.ctrl.openMallBuyWindow(!1)},this)},setData:function(t){if(this.data=t,null!=this.root_wnd){var e,i=Utils.getItemConfig(t.item_bid||t.item_id);i.bid=t.item_bid||t.item_id,i=Utils.deepCopy(i),t.item_num&&1!=t.item_num&&(i.num=t.item_num),t.shop_type==n.MallType.FestivalAction?(this.goods_item.setData(t.item_bid,t.quantity||t.num),this.num=t.limit_num-t.has_buy,this.buy_desc_lb.string=Utils.TI18N("\u6d3b\u8dc3\u503c\u8d2d\u4e70\u540e\u4ec5\u589e\u52a0\u8be5\u6d3b\u52a8\u603b\u6d3b\u8dc3\u503c")):t.shop_type==n.MallType.SuitShop?this.goods_item.setData(t.item_bid):t.shop_type==n.MallType.SteriousShop?(this.goods_item.setData({bid:t.item_bid,num:t.num}),this.total_price.node.x=-1e3,this.total_price_title_lb.node.x=-1111,this.ok_btn_label.string=Utils.TI18N("\u5151\u6362"),this.title_label.string=Utils.TI18N("\u5151\u6362"),this.icon_bg_nd.x=-1e3,this.price.node.active=!1,this.coin.node.active=!1,this.limit.node.x=-61):this.goods_item.setData(i),null!=t.name?this.name.string=t.name:this.name.string=i.name,this.limit_num=this.data.limit_num,null!=t.discount&&this.data.discount>0?(this.price.string=t.discount,this.price_val=t.discount):(this.price.string=t.price,this.price_val=t.price),t.shop_type==n.MallType.ActionShop?this.is_can_buy_num=this.ctrl.getModel().checkActionMoenyByType(t.pay_type,this.price_val):this.is_can_buy_num=this.ctrl.getModel().checkMoenyByType(t.pay_type,this.price_val),e="number"==typeof t.pay_type?Utils.getItemConfig(t.pay_type):Utils.getItemConfig(gdata("item_data","data_assets_label2id",[t.pay_type]));var s=PathTool.getItemRes(e.icon);s&&this.loadRes(s,function(t){this.coin.spriteFrame=t}.bind(this)),this.limit_num>0&&t.is_show_limit_label&&null!=t.has_buy?(this.limit.string=cc.js.formatStr("\u9650\u8d2d%s\u4e2a",this.limit_num-t.has_buy),this.is_can_buy_max=!0):(this.limit.string="",t.shop_type!=n.MallType.Recovery&&this.is_can_buy_num<this.limit_num&&(this.limit_num=this.is_can_buy_num,this.is_can_buy_max=!1)),this.setCurUseItemInfoByNum(this.num)}},setCurUseItemInfoByNum:function(t){this.num=t;var e=this.num/(this.limit_num-this.data.has_buy);this.slider.progress=e,this.progress.progress=this.slider.progress,this.buy_count.string=this.num,this.total_price.string=this.num*this.price_val},setCurUseItemInfoByPercent:function(t){this.num=Math.floor(t*(this.limit_num-this.data.has_buy)),this.buy_count.string=this.num,this.total_price.string=this.num*this.price_val},showAlert:function(t){t&&this.ctrl.sender13407(t.order,t.shop_type,1,t)},openRootWnd:function(t){},showGoldAlert:function(t){if(t)if(3!=t.pay_type)this.ctrl.sender13407(t.order,t.shop_type,1);else{var e=t.price;0!=t.discount&&(e=t.discount);var i=o.getInstance().getRoleVo();if(!i)return;if(i.gold>=e){var s=Utils.getItemConfig(t.item_id),n=StringUtil.parseStr("\u662f\u5426\u4f7f\u7528<img src=%s visible=true scale=0.4 /><div fontColor=#289b14 fontsize= 26>%s</div>\u8d2d\u4e70<div fontColor=#289b14 fontsize= 26>%s</div>\uff1f").string,r=[],c=PathTool.getIconPath("item","3");r.push(c);var _=cc.js.formatStr(n,"3",e,s.name);l.show(_,Utils.TI18N("\u786e\u5b9a"),function(){this.ctrl.sender13407(t.order,t.shop_type,1)}.bind(this),Utils.TI18N("\u53d6\u6d88"),null,null,null,{resArr:r})}else{var h=Utils.getItemConfig(t.pay_type);h&&a.getInstance().openTipsSource(!0,h)}}},closeCallBack:function(){this.goods_item&&this.goods_item.deleteMe(),this.goods_item=null,this.ctrl.openMallBuyWindow(!1)}});e.exports=r,cc._RF.pop()},{action_controller:"action_controller",backpack_controller:"backpack_controller",commonalert:"commonalert",mall_const:"mall_const",mall_controller:"mall_controller",role_controller:"role_controller"}],mall_const:[function(t,e,i){"use strict";cc._RF.push(e,"e1234+r1zlOqqsNC8Dmi66s","mall_const");e.exports={MallType:{GodShop:1,Recovery:2,ScoreShop:3,VarietyShop:4,UnionShop:5,ArenaShop:6,BossShop:7,FriendShop:8,SkillShop:9,GuessShop:16,EliteShop:17,HeroSkin:18,Ladder:30,Seerpalace:31,ActionShop:32,FestivalAction:33,SteriousShop:35}},cc._RF.pop()},{}],mall_controller:[function(t,e,i){"use strict";cc._RF.push(e,"a9944mV1I5PI7Oa6YqWCaXh","mall_controller");var s=t("scene_const"),n=t("mall_event"),a=t("mall_const"),o=t("mainscene_controller"),l=t("battle_drama_event"),r=cc.Class({extends:BaseController,ctor:function(){},initConfig:function(){var e=t("mall_model");this.model=new e,this.model.initConfig(),this.is_first_login=!0,this.temp_data=null},getModel:function(){return this.model},setFirstLogin:function(t){this.is_first_login=t},setExchangeBuyData:function(t){this.temp_data=t},registerEvents:function(){null==this.init_role_event&&(this.init_role_event=gcore.GlobalEvent.bind(l.BattleDrama_Top_Update_Data,function(){gcore.GlobalEvent.unbind(this.init_role_event),this.init_role_event=null;var e=t("role_controller");if(this.role_vo=e.getInstance().getRoleVo(),null!=this.role_vo){var i=t("battle_drama_controller").getInstance().getModel().getDramaData(),s=Config.city_data.data_base[1].activate[0][1];if(null!=i.max_dun_id&&i.max_dun_id>=s){var n=Config.exchange_data.data_shop_list[1];null!=n.login_red&&null!=Utils.next(n.login_red)&&this.sender13401(1)}}}.bind(this)))},registerProtocals:function(){this.RegisterProtocal(13401,this.handle13401),this.RegisterProtocal(13402,this.handle13402),this.RegisterProtocal(13403,this.handle13403),this.RegisterProtocal(13404,this.handle13404),this.RegisterProtocal(13405,this.handle13405),this.RegisterProtocal(13407,this.handle13407),this.RegisterProtocal(13419,this.handle13419),this.RegisterProtocal(13420,this.handle13420),this.RegisterProtocal(16660,this.handle16660),this.RegisterProtocal(16661,this.handle16661)},openMallPanel:function(e,i,n){if(1==e){var l=o.getInstance().getBuildVo(s.CenterSceneBuild.shop);if(null!=l&&1==l.is_lock)return void message(l.desc);if(null==this.mall_panel){var r=t("mall_window");this.mall_panel=new r}i=i||a.MallType.GodShop,this.need_bid=n,this.mall_panel.open(i)}else this.mall_panel&&(this.mall_panel.close(),this.mall_panel=null)},getMallRoot:function(){if(this.mall_panel)return this.mall_panel.root_wnd},getMallView:function(){if(this.mall_panel)return this.mall_panel},getNeedBid:function(){return this.need_bid},setNeedBid:function(t){this.need_bid=t},openMallBuyWindow:function(e,i){if(1==e){if(null!=i)if(i.shop_type==a.MallType.Recovery||i.shop_type==a.MallType.ActionShop){if(null==this.mall_buy_win){var s=t("mall_buy_window");this.mall_buy_win=new s}this.mall_buy_win.open(),this.mall_buy_win.setData(i)}else{var n=0;if(n=null!=i.discount&&i.discount>0?i.discount:i.price,this.model.checkMoenyByType(i.pay_type,n)<=0){var o=null;if(null!=(o="number"==typeof i.pay_type?Utils.getItemConfig(i.pay_type):Utils.getItemConfig(gdata("item_data","data_assets_label2id",[i.pay_type]))))if(o.id==gdata("item_data","data_assets_label2id","gold")||o.id==gdata("item_data","data_assets_label2id","red_gold_or_gold"))if(0==IS_SHOW_CHARGE)message(Utils.TI18N("\u94bb\u77f3\u4e0d\u8db3"));else{var l=cc.js.formatStr(Utils.TI18N("%s\u4e0d\u8db3\uff0c\u662f\u5426\u524d\u5f80\u5145\u503c"),o.name);t("commonalert").show(l,Utils.TI18N("\u786e\u5b9a"),function(){t("vip_controller").getInstance().openVipMainWindow(!0,VIPTABCONST.CHARGE)},Utils.TI18N("\u53d6\u6d88"),null,2,null,null,null,!0)}else t("backpack_controller").getInstance().openTipsSource(!0,o.id)}else{if(null==this.mall_buy_win){s=t("mall_buy_window");this.mall_buy_win=new s}this.mall_buy_win.open(),this.mall_buy_win.setData(i)}}}else null!=this.mall_buy_win&&(this.mall_buy_win.close(),this.mall_buy_win=null)},openMallGiftPanel:function(t,e){1==t?(null==this.mall_gift_panel&&(this.mall_gift_panel=new MallGiftPanel),this.mall_gift_panel.open(e)):this.mall_gift_panel&&(this.mall_gift_panel.close(),this.mall_gift_panel=null)},sender13401:function(t){var e={};e.type=t,this.SendProtocal(13401,e)},handle13401:function(t){var e=!1,i=0;if(1==t.code&&1==t.type){var a=gdata("exchange_data","data_shop_list",[1]);if(null!=a&&null!=a.login_red&&null!=Utils.next(a.login_red)){var l=a.login_red.length;for(var r in a.login_red){var c=a.login_red[r],_=c[1],h=c[2];if(null!=t.item_list&&null!=Utils.next(t.item_list))for(var d in t.item_list){var u=t.item_list[d];if(_==u.item_id&&u.ext[0].val<h){e=!0;break}_==u.item_id&&u.ext[0].val>=nul&&(i+=1)}else e=!0}e=i!=l}}o.getInstance().setBuildRedStatus(s.CenterSceneBuild.shop,e&&this.is_first_login),gcore.GlobalEvent.fire(n.Open_View_Event,t)},sender13402:function(t,e){var i={};i.eid=t,i.num=e,this.SendProtocal(13402,i)},handle13402:function(t){message(t.msg),1==t.code&&gcore.GlobalEvent.fire(n.Buy_Success_Event,t)},sender13403:function(t){var e={};e.type=t,this.SendProtocal(13403,e)},handle13403:function(t){message(t.msg),gcore.GlobalEvent.fire(n.Get_Buy_list,t)},handle13404:function(t){gcore.GlobalEvent.fire(n.Frash_tips_event)},sender13405:function(t){var e={};e.type=t,this.SendProtocal(13405,e)},handle13405:function(t){message(t.msg),1==t.code&&gcore.GlobalEvent.fire(n.Get_Buy_list,t)},sender13407:function(t,e,i,s){var n={};n.order=t,n.type=e,n.buy_type=i,this.SendProtocal(13407,n),this.order=s},handle13407:function(e){message(e.msg),1==e.code?gcore.GlobalEvent.fire(n.Buy_One_Success,e,this.order):this.order&&t("backpack_controller").getInstance().openTipsSource(!0,this.order.item_id)},send13419:function(t){var e={};e.num=t,this.SendProtocal(13419,e)},handle13419:function(t){message(t.msg),1==t.code&&null!=this.temp_data&&(this.sender13407(this.temp_data.order,this.temp_data.shop_type,1),this.temp_data=null)},handle13420:function(t){gcore.GlobalEvent.fire(n.Free_Refresh_Data,t)},openVarietyStoreWindows:function(t){1==t?(null==this.variety_store_view&&(this.variety_store_view=Utils.createClass("variety_store_window",this)),this.variety_store_view&&0==this.variety_store_view.isOpen()&&this.variety_store_view.open()):this.variety_store_view&&(this.variety_store_view.close(),this.variety_store_view=null)},openMallActionWindow:function(e,i){if(1==e){if(!this.mall_action_window){var s=t("mall_action_window");this.mall_action_window=new s}this.mall_action_window.open(i)}else this.mall_action_window&&(this.mall_action_window.close(),this.mall_action_window=null)},send16660:function(){this.SendProtocal(16660,{})},handle16660:function(t){message(t.msg),gcore.GlobalEvent.fire(n.Update_Action_event,t)},handle16661:function(t){message(t.msg),1==t.code&&gcore.GlobalEvent.fire(n.Buy_Action_Shop_Success_event,t)},send16661:function(t,e,i){var s={};s.bid=t,s.aim=e,s.num=i,this.SendProtocal(16661,s)},__delete:function(){null!=this.model&&(this.model.DeleteMe(),this.model=null)},getVarietyStoreRoot:function(t){if(t)this.variety_store_view?this.variety_store_view.getRootWnd(t):t(null);else if(this.variety_store_view)return this.variety_store_view.root_wnd}});e.exports=r,cc._RF.pop()},{backpack_controller:"backpack_controller",battle_drama_controller:"battle_drama_controller",battle_drama_event:"battle_drama_event",commonalert:"commonalert",mainscene_controller:"mainscene_controller",mall_action_window:"mall_action_window",mall_buy_window:"mall_buy_window",mall_const:"mall_const",mall_event:"mall_event",mall_model:"mall_model",mall_window:"mall_window",role_controller:"role_controller",scene_const:"scene_const",vip_controller:"vip_controller"}],mall_event:[function(t,e,i){"use strict";cc._RF.push(e,"39dc1j5MdFBvIVB++axLqy2","mall_event"),e.exports={Buy_Equip_Success:"Buy_Equip_Success",Open_View_Event:"Open_View_Event",Buy_Success_Event:"Buy_Success_Event",Get_Buy_list:"Get_Buy_list",Buy_One_Success:"Buy_One_Success",Get_Half_Discount:"Get_Half_Discount",Frash_tips_event:"Frash_tips_event",Score_Buy_List:"Score_Buy_List",Hot_Buy_List:"Hot_Buy_List",Artifact_Buy_List:"Artifact_Buy_List",Artifact_Buy_Success:"Artifact_Buy_Success",Free_Refresh_Data:"Free_Refresh_Data",Update_Action_event:"Update_Action_event",Buy_Action_Shop_Success_event:"Buy_Action_Shop_Success_event"},cc._RF.pop()},{}],mall_item:[function(t,e,i){"use strict";cc._RF.push(e,"70481KJ12hOtZnX0lMjPCYr","mall_item");var s=t("mall_controller"),n=t("mall_event"),a=t("role_controller"),o=cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=PathTool.getPrefabPath("mall","mall_item"),this.ctrl=s.getInstance(),this.size=cc.size(306,143),this.width=306,this.height=143,this.vo=null,this.data=null,this.is_touch=!0,this.role_vo=a.getInstance().getRoleVo()},initPanel:function(){this.main_container=this.root_wnd.getChildByName("main_container"),this.name=this.main_container.getChildByName("name").getComponent(cc.Label),this.coin=this.main_container.getChildByName("count_bg").getChildByName("coin").getComponent(cc.Sprite),this.price=this.main_container.getChildByName("count_bg").getChildByName("price").getComponent(cc.Label),this.good=this.main_container.getChildByName("good"),this.goods_item=ItemsPool.getInstance().getItem("backpack_item"),this.goods_item.initConfig(!1,1,!1,!0),this.goods_item.setParent(this.good),this.goods_item.show(),this.discount=this.main_container.getChildByName("discount"),this.discount_num=this.discount.getChildByName("discount_num").getComponent(cc.Label),this.discount.active=!1,this.discount_label=this.main_container.getChildByName("discount_label").getComponent(cc.RichText),this.sold=this.main_container.getChildByName("sold"),this.sold.active=!1,this.grey=this.main_container.getChildByName("grey"),this.grey.active=!1,this.need_icon=this.main_container.getChildByName("need_icon"),this.need_label=this.main_container.getChildByName("need_label").getComponent(cc.Label),this.need_icon.active=!1,this.need_label.node.active=!1,this.setSellAll(!1),this.setData(this.data)},registerEvent:function(){this.main_container.on(cc.Node.EventType.TOUCH_END,function(){this.is_touch&&(this.vip_limit_flag>0?message(cc.js.formatStr(Utils.TI18N("VIP%s\u4ee5\u4e0a\u53ef\u8d2d\u4e70"),this.vip_limit_flag)):this.rank_limit_flag?message(Utils.TI18N("\u672a\u6ee1\u8db3\u8d2d\u4e70\u6761\u4ef6")):this.limit_glev_status?message(Utils.TI18N("\u8be5\u5546\u54c1\u6682\u672a\u8fbe\u89e3\u9501\u6761\u4ef6\u54e6\uff0c\u8bf7\u52aa\u529b\u63d0\u9ad8\u516c\u4f1a\u7b49\u7ea7")):this.callback&&this.callback(this.data))},this),this.addGlobalEvent(n.Buy_Success_Event,function(t){this.data.id&&t.eid==this.data.id&&null!=Utils.next(t.ext||{})&&(this.data.has_buy=t.ext[0].val,this.discount_label.string=cc.js.formatStr(Utils.TI18N("<color=#452505>%s <color=#289b14>%s/%s</color>\u4e2a</color>"),this.str,this.data.has_buy,this.data.limit_num),this.data.has_buy==this.data.limit_num&&this.setSellAll(!0))}.bind(this)),this.addGlobalEvent(n.Buy_One_Success,function(t){this.data.order&&t.order==this.data.order&&(this.data.has_buy=this.data.has_buy+1,this.discount_label.string=cc.js.formatStr(Utils.TI18N("<color=#452505>%s <color=#289b14>%s/%s</color>\u4e2a</color>"),this.str,this.data.has_buy,this.data.limit_num),(null!=(this.data.limit_count||this.data.limit_num)||this.data.has_buy>=this.data.limit_num)&&this.setSellAll(!0))}.bind(this)),this.role_vo&&null==this.role_update_event&&(this.role_update_event=this.role_vo.bind(EventId.UPDATE_ROLE_ATTRIBUTE,function(t,e){if(("gold"==t||"red_gold"==t||"hero_soul"==t||"arena_cent"==t||"friend_point"==t||"guild"==t)&&0==this.data.limit_day&&0==this.data.limit_month&&0==this.data.limit_week&&0==this.data.limit_count&&4!=this.data.shop_type&&2!=this.data.shop_type)if("red_gold_or_gold"!=this.pay_type)if(this.role_vo[this.pay_type]&&this.role_vo[this.pay_type]<20*this.data.price){var i=Math.floor(this.role_vo[this.pay_type]/this.data.price);this.data.limit_num=i>=1?i:1}else this.data.limit_num=20;else{var s=this.role_vo.gold+this.role_vo.red_gold;if(s&&s<20*this.data.price){i=Math.floor(s/this.data.price);this.data.limit_num=i>=1?i:1}else this.data.limit_num=20}"vip_lev"==t&&this.vip_limit_flag>0&&this.setData(this.data)},this))},setData:function(t){if(this.data=t,null!=this.root_wnd){var e=null;e=null!=t.shop_type?t.shop_type:t.type,this.data=Utils.deepCopy(t);var i,s,n=Utils.getItemConfig(t.item_bid||t.item_id);(n=Utils.deepCopy(n)).bid=t.item_bid||t.item_id,n&&(t.item_num&&1!=t.item_num&&(n.num=t.item_num),this.goods_item.setData(n),this.name.string=n.name),"number"==typeof t.pay_type?(i=Utils.getItemConfig(t.pay_type),s=gdata("item_data","data_assets_id2label",[t.pay_type])):(i=Utils.getItemConfig(gdata("item_data","data_assets_label2id",[t.pay_type])),s=t.pay_type),this.pay_type=s,this.price.string=t.price;var a=PathTool.getItemRes(i.icon);a&&this.loadRes(a,function(t){this.coin.spriteFrame=t}.bind(this)),this.str="";var o=0,l=0,r=0,c=!1;if(this.rank_limit_flag=!1,t.limit_rank&&t.limit_rank>0&&e==MallConst.MallType.Ladder){var _=LadderController.getInstance().getModel().getLadderMyBaseInfo();(_&&0==_.best_rank||_.best_rank>t.limit_rank)&&(l=t.limit_rank,c=!0)}if(this.vip_limit_flag=0,t.limit_vip&&t.limit_vip>0&&this.role_vo&&this.role_vo.vip_lev<t.limit_vip&&(c=!0,r=t.limit_vip),0==c)if(null!=t.limit_count&&t.limit_count>0)this.str="\u9650\u8d2d",o=t.limit_count,c=!0;else if(null!=t.limit_month&&t.limit_month>0)this.str="\u6bcf\u6708\u9650\u8d2d",o=t.limit_month,c=!0;else if(null!=t.limit_week&&t.limit_week>0)this.str="\u6bcf\u5468\u9650\u8d2d",o=t.limit_week,c=!0;else if(null!=t.limit_day&&t.limit_day>0)this.str="\u6bcf\u65e5\u9650\u8d2d",o=t.limit_day,c=!0;else if(4==t.shop_type||2==t.shop_type)o=1,c=!0;else if("red_gold_or_gold"!=s){if(this.role_vo[s]&&this.role_vo[s]<20*t.price)o=(h=Math.floor(this.role_vo[s]/t.price))>=1?h:1;else o=20,c=!1}else{var h,d=this.role_vo.gold+this.role_vo.red_gold;if(null!=d&&d<20*t.price)o=(h=Math.floor(d/t.price))>=1?h:1;else o=20,c=!1}r>0&&c?(this.discount_label.node.active=!0,this.discount_label.string=cc.js.formatStr(Utils.TI18N("<color=#452505><color=#289b14>      VIP%d</color>\u4e13\u5c5e</color>"),r),this.setSellAll(!1),this.vip_limit_flag=r):o>0&&c?(this.discount_label.node.active=!0,this.discount_label.string=cc.js.formatStr(Utils.TI18N("<color=#452505>%s <color=#289b14>%s/%s</color>\u4e2a</color>"),this.str,t.has_buy,o),t.has_buy==o?this.setSellAll(!0):this.setSellAll(!1)):l>0&&c?(this.discount_label.node.active=!0,this.discount_label.string=cc.js.formatStr(Utils.TI18N("<color=#452505><color=#ff1f0e>\u9700\u8fbe\u5230%s\u540d</color></color>"),l),this.setSellAll(!1),this.rank_limit_flag=!0):(this.discount_label.node.active=!1,1==t.has_buy?this.setSellAll(!0):this.setSellAll(!1)),this.data.limit_num=o,this.data.is_show_limit_label=c,null!=t.label&&t.label>0?(this.discount.active=!0,this.discount_num.string=t.label+Utils.TI18N("\u6298")):null!=t.discount_type&&t.discount_type>0?(this.discount.active=!0,this.discount_num.string=t.discount_type+Utils.TI18N("\u6298")):null!=t.lable&&t.lable>0?(this.discount.active=!0,this.discount_num.string=Utils.TI18N("\u8d85\u503c")):this.discount.active=!1,null!=t.discount&&t.discount>0&&(this.price.string=t.discount),10==this.data.type||11==this.data.type||12==this.data.type||13==this.data.type?this.isShowLevLimit(!0,this.data.lev):this.isShowLevLimit(!1),5==this.data.type&&null!=this.data.glev?this.isShowGLevLimit(!0,this.data.glev):this.isShowGLevLimit(!1,0);var u=this.ctrl.getNeedBid();if(null==u||u!=t.item_id&&u!=t.item_bid?(this.need_icon.active=!1,this.need_label.node.active=!1):(this.need_icon.active=!0,this.need_label.node.active=!0),3==this.data.type){var m=this.ctrl.getModel().checkHeroChips(t.item_id);this.showChipTag(m)}else this.showChipTag(!1)}},setSellAll:function(t){null!=this.root_wnd&&(this.sold.active=t,this.grey.active=t,this.is_touch=!t)},showChipTag:function(t){},isShowLevLimit:function(t,e){this.limit_lev_label},isShowGLevLimit:function(t,e){},addCallBack:function(t){this.callback=t},onShow:function(){},onDelete:function(){this.role_update_event&&this.role_vo&&(this.role_vo.unbind(this.role_update_event),this.role_update_event=null,this.role_vo=null),this.goods_item&&(this.goods_item.deleteMe(),this.goods_item=null)}});e.exports=o,cc._RF.pop()},{mall_controller:"mall_controller",mall_event:"mall_event",role_controller:"role_controller"}],mall_model:[function(t,e,i){"use strict";cc._RF.push(e,"45db275SQVGLYz1VNs3b22D","mall_model");var s=t("role_controller"),n=t("backpack_controller"),a=cc.Class({extends:BaseClass,ctor:function(){var e=t("mall_controller");this.ctrl=e.getInstance()},properties:{},initConfig:function(){this.buy_list={},this.shop_list={}},setBuyList:function(t){this.buy_list=t},getBuyList:function(){return this.buy_list},getScoreBuyList:function(t){return this.shop_list[t]&&null!=Utils.next(this.shop_list[t])?this.shop_list[t]:null},checkHeroChips:function(t){var e=!1,i=[];if(null!=i&&null!=Utils.next(i||{})){for(var s in i){var n=i[s],a=PartnerController.getInstance().getModel().getPartnerById(n.id);a&&a.chips_id==t&&(e=!0)}return e}return!1},checkMoenyByType:function(t,e){var i=s.getInstance().getRoleVo(),a=0;if(null!=i){var o=Utils.deepCopy(Config.item_data.data_assets_label2id);if("number"==typeof t)if(t==o.hero_soul){var l=i.hero_soul;a=Math.floor(l/e)}else if(t==o.silver_coin){var r=i.silver_coin;a=Math.floor(r/e)}else if(t==o.red_gold_or_gold){var c=i.red_gold+i.gold;a=Math.floor(c/e)}else if(t==o.arena_guesscent){var _=i.arena_guesscent;a=Math.floor(_/e)}else if(t==o.star_point){var h=i.star_point;a=Math.floor(h/e)}else if(t==o.gold){c=i.gold;a=Math.floor(c/e)}else if(t==o.coin){var d=i.coin;a=Math.floor(d/e)}else{var u=n.getInstance().getModel().getItemNumByBid(t);a=Math.floor(u/e)}else if("gold"==t){var m=i.gold;a=Math.floor(m/e)}else if("red_gold_or_gold"==t){c=i.red_gold+i.gold;a=Math.floor(c/e)}else if("arena_cent"==t){var f=i.arena_cent;a=Math.floor(f/e)}else if("friend_point"==t){var p=i.friend_point;a=Math.floor(p/e)}else if("guild"==t){var g=i.guild;a=Math.floor(g/e)}else if("boss_point"==t){var v=i.boss_point;a=Math.floor(v/e)}else if("arena_guesscent"==t){_=i.arena_guesscent;a=Math.floor(_/e)}else if("star_point"==t){h=i.star_point;a=Math.floor(h/e)}else if("sky_coin"==t){var b=i.sky_coin;a=Math.floor(b/e)}else if("recruithigh_hero"==t){var w=i.recruithigh_hero;a=Math.floor(w/e)}else if("expedition_medal"==t){var y=i.expedition_medal;a=Math.floor(y/e)}else if("coin"==t){d=i.coin;a=Math.floor(d/e)}else if("silver_coin"==t){r=i.silver_coin;a=Math.floor(r/e)}}return a},checkActionMoenyByType:function(t,e){var i=s.getInstance().getRoleVo(),n=0;if(i){var a=i.getActionAssetsNumByBid(t);n=Math.floor(a/e)}return n}});e.exports=a,cc._RF.pop()},{backpack_controller:"backpack_controller",mall_controller:"mall_controller",role_controller:"role_controller"}],mall_son_panel:[function(t,e,i){"use strict";function s(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}cc._RF.push(e,"3e4f97ctNZFJY2Akocnka5f","mall_son_panel");var n=t("pathtool"),a=t("mall_controller"),o=t("role_controller"),l=(t("mall_const"),t("mall_event")),r=t("mall_item"),c=t("common_scrollview"),_=t("backpack_controller"),h=t("timetool"),d=cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=n.getPrefabPath("mall","mall_son_panel"),this.ctrl=a.getInstance(),this.role_vo=o.getInstance().getRoleVo(),this.tab_list=[],this.cur_index=null,this.cur_tab=null,this.data_list=[]},initPanel:function(){this.main_container=this.root_wnd.getChildByName("main_container"),this.tab_container=this.main_container.getChildByName("tab_container");for(var t=1;t<5;t++){var e=this.tab_container.getChildByName(cc.js.formatStr("tab_btn_%s",t));e.label=e.getChildByName("title").getComponent(cc.Label),e.label.node.color=new cc.Color(207,181,147,255),e.btn=e.getComponent(cc.Button),e.btn.interactable=!1,e.index=t,e.is_first=!0,this.tab_list[t]=e}this.refresh_panel=this.main_container.getChildByName("refresh_panel"),this.refresh_panel.active=!1,this.btn_refresh=this.refresh_panel.getChildByName("btn_refresh"),this.refresh_time=this.refresh_panel.getChildByName("refresh_time").getComponent(cc.Label),this.refresh_time.string="";var i=gdata("exchange_data","data_shop_list",[16]),s=this.btn_refresh.getChildByName("Sprite_1").getComponent(cc.Sprite);s.node.setScale(.5,.5);var a=n.getItemRes(Utils.getItemConfig(i.item_bid).icon);a&&this.loadRes(a,function(t){s.spriteFrame=t}.bind(this)),this.btn_refresh.getChildByName("Text_1").getComponent(cc.Label).string=i.cost_list[0][1]+"\u5237\u65b0",this.scrollCon=this.main_container.getChildByName("scrollCon"),this.coin=this.main_container.getChildByName("coin").getComponent(cc.Sprite),this.count=this.main_container.getChildByName("count").getComponent(cc.Label),this.add_btn=this.main_container.getChildByName("add_btn"),this.add_btn.active=!1;var o=cc.size(622,648),l={item_class:r,start_x:4,space_x:0,start_y:3,space_y:2,item_width:306,item_height:143,row:0,col:2,need_dynamic:!0};this.item_scrollview=new c,this.item_scrollview.createScroll(this.scrollCon,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,o,l,cc.v2(.5,.5))},registerEvent:function(){this.add_btn.on(cc.Node.EventType.TOUCH_END,function(){var t=gdata("exchange_data","data_shop_list",[this.cur_tab.type]).item_bid,e=Utils.getItemConfig(t);_.getInstance().openTipsSource(!0,e)},this),this.addGlobalEvent(l.Open_View_Event,function(t){if(4!=this.cur_index){var e=this.getConfig(this.cur_tab.type,t);this.data_list[this.cur_index]=Utils.deepCopy(e),this.item_scrollview.setData(this.data_list[this.cur_index],function(t){this.ctrl.openMallBuyWindow(!0,t)}.bind(this))}}.bind(this)),this.role_vo&&null==this.role_update_lev_event&&(this.role_update_lev_event=this.role_vo.bind(EventId.UPDATE_ROLE_ATTRIBUTE,function(t,e){if("lev"==t)for(var i in this.tab_list)i!=this.cur_index&&this.setTabBtnTouchStatus(this.checkBtnIsOpen(i),i);else if("gsrv_id"==t||"gid"==t)this.setTabBtnTouchStatus(this.checkBtnIsOpen(5),1);else if("gold"==t||"arena_cent"==t||"guild"==t||"hero_soul"==t||"friend_point"==t||"arena_guesscent"==t||"star_point"==t||"expedition_medal"==t){var s=gdata("exchange_data","data_shop_list",[this.cur_tab.type]).item_bid;if(gdata("item_data","data_assets_id2label",[s])==t){var a=n.getItemRes(Utils.getItemConfig(s).icon);a&&this.loadRes(a,function(t){this.coin.spriteFrame=t}.bind(this)),4==this.cur_index?this.count.string=this.role_vo.star_point:1==this.cur_index?this.count.string=this.role_vo.expedition_medal:this.count.string=this.role_vo[gdata("item_data","data_assets_id2label",[s])]}}},this)),this.addGlobalEvent(l.Buy_Success_Event,function(t){if(this.cur_index&&this.data_list&&this.data_list[this.cur_index])for(var e in this.data_list[this.cur_index]){var i=this.data_list[this.cur_index][e];"number"==typeof i&&null!=i&&null!=i.id&&null!=i.has_buy&&i.id==t.eid&&null!=Utils.next(t.ext||{})&&(i.has_buy=t.ext[0].val)}}.bind(this)),this.btn_refresh.on(cc.Node.EventType.TOUCH_END,function(){var t=gdata("exchange_data","data_shop_list",[16]).cost_list;this.role_vo.star_point>=t[0][1]?this.ctrl.sender13405(16):(message(Utils.TI18N("\u63a2\u5b9d\u79ef\u5206\u4e0d\u8db3")),_.getInstance().openTipsSource(!0,18))},this),this.addGlobalEvent(l.Get_Buy_list,function(t){if(16==t.type){for(var e in this.setLessTime(t.refresh_time-gcore.SmartSocket.getTime()),t.item_list)t.item_list[e].shop_type=16;this.data_list[this.cur_index]=Utils.deepCopy(t),this.item_scrollview.setData(this.data_list[this.cur_index].item_list,function(t){this.ctrl.openMallBuyWindow(!0,t)}.bind(this))}}.bind(this))},setLessTime:function(t){if(null!=this.refresh_time)if(this.refresh_time.node.stopAllActions(),t>0){this.setTimeFormatString(t);var e=cc.callFunc(function(){(t-=1)<0?this.refresh_time.node.stopAllActions():this.setTimeFormatString(t)}.bind(this));this.refresh_time.node.runAction(cc.repeatForever(cc.sequence(cc.delayTime(1),e)))}else this.setTimeFormatString(t)},setTimeFormatString:function(t){this.refresh_time.string=t>0?h.getTimeFormat(t):"00:00:00"},setData:function(t){null!=t&&(this.data=t,this.root_wnd&&this.onShow())},onShow:function(){this.setList(this.list),this.openById(this.id)},setCallFun:function(t){this.call_fun=t},setVisibleStatus:function(t){null!=this.root_wnd&&(this.root_wnd.active=t)},onDelete:function(){this.item_scrollview&&this.item_scrollview.deleteMe(),this.item_scrollview=null,this.role_update_lev_event&&this.role_vo&&(this.role_vo.unbind(this.role_update_lev_event),this.role_update_lev_event=null,this.role_vo=null),this.refresh_time&&(this.refresh_time.node.stopAllActions(),this.refresh_time=null)},changeTabView:function(t){if(this.cur_index!=t&&(null!=this.cur_tab&&(this.cur_tab.label.node.color=new cc.Color(207,181,147,255),this.cur_tab.btn.interactable=!0),this.cur_index=t,this.cur_tab=this.tab_list[this.cur_index],this.cur_tab&&(this.cur_tab.label.node.color=new cc.Color(255,237,214,255),this.cur_tab.btn.interactable=!1),this.refresh_panel.active=4==this.cur_index,this.cur_tab.is_first?(this.ctrl.sender13401(this.cur_tab.type),this.cur_tab.is_first=!1):4!=this.cur_index&&this.item_scrollview.setData(this.data_list[this.cur_index],function(t){this.ctrl.openMallBuyWindow(!0,t)}.bind(this)),4==this.cur_index&&(this.item_scrollview.setData([]),this.ctrl.sender13403(16)),e=gdata("exchange_data","data_shop_list",[this.cur_tab.type]).item_bid))if(4==this.cur_index){var e=gdata("exchange_data","data_shop_list",[16]).item_bid;(i=n.getItemRes(Utils.getItemConfig(e).icon))&&(this.loadRes(i,function(t){this.coin.spriteFrame=t}.bind(this)),this.count.string=this.role_vo.star_point)}else{var i;(i=n.getItemRes(Utils.getItemConfig(e).icon))&&(this.loadRes(i,function(t){this.coin.spriteFrame=t}.bind(this)),this.count.string=this.role_vo.star_point),1==this.cur_index?this.count.string=this.role_vo.expedition_medal:this.count.string=Utils.getMoneyString(this.role_vo[gdata("item_data","data_assets_id2label",[e])])}},openById:function(t){if(this.id=t,null!=this.root_wnd)for(var e in this.tab_list){var i=this.tab_list[e];i.type==t&&(this.cur_index=null,this.changeTabView(i.index))}},getConfig:function(t,e){var i=[];5==t?i=Utils.deepCopy(Config.exchange_data.data_shop_exchage_guild):6==t?i=Utils.deepCopy(Config.exchange_data.data_shop_exchage_arena):7==t?i=Utils.deepCopy(Config.exchange_data.data_shop_exchage_boss):8==t?i=Utils.deepCopy(Config.exchange_data.data_shop_exchage_expediton):16==t&&(i=Utils.deepCopy(Config.exchange_data.data_shop_exchage_guess));var s=Utils.deepCopy(e.item_list),n=[];for(var a in i){var o=i[a];if(o.type==this.cur_tab.type){if(s&&Utils.next(s))for(var l in s){var r=s[l];if(o.id==r.item_id){r.ext[0]&&null!=r.ext[0].val&&(o.has_buy=r.ext[0].val,s.splice(l,1));break}o.has_buy=0}else o.has_buy=0;n.push(o)}}return n},checkBtnIsOpen:function(e){if(5==e)return!!(this.role_vo.lev>=gdata("exchange_data","data_shop_exchage_cost","open_guild_lev").val&&this.role_vo.isHasGuild());if(6==e||16==e){var i=t("scene_const"),s=t("mainscene_controller").getInstance().getBuildVo(i.CenterSceneBuild.arena);return!s||!s.is_lock}return 7!=e||this.role_vo.lev>=gdata("exchange_data","data_shop_exchage_cost","open_god_point_lev").val},setTabBtnTouchStatus:function(t,e){var i=this.tab_list[e];i&&(t?(i.getComponent(cc.Sprite).setMaterial(0,cc.Material.getBuiltinMaterial("2d-sprite")),i.getComponent(cc.Button).interactable=t,i.getComponent(cc.Button).enableAutoGrayEffect=!t):i.getComponent(cc.Sprite).setMaterial(0,cc.Material.getBuiltinMaterial("2d-gray-sprite")),i.can_touch=t)},setList:function(t){var e;if(this.list=t,null!=this.root_wnd){var i=(s(e={},5,gdata("exchange_data","data_shop_exchage_cost","open_guild_lev").desc),s(e,16,gdata("exchange_data","data_shop_exchage_cost","open_arena_cent_lev").desc),s(e,6,gdata("exchange_data","data_shop_exchage_cost","open_arena_cent_lev").desc),e);for(var n in this.tab_list){var a=this.tab_list[n];null!=t[n-1]?(a.active=!0,a.label.string=gdata("exchange_data","data_shop_list",[t[n-1]]).name,a.type=t[n-1],a.notice=i[a.type],this.setTabBtnTouchStatus(this.checkBtnIsOpen(a.type),n)):a.active=!1}if(null==this.btn_event){for(var n in this.tab_list){var o=this.tab_list[n];null!=o&&o.on(cc.Node.EventType.TOUCH_END,function(t){var e=t.currentTarget;null!=e.type&&(0==e.can_touch?message(Utils.TI18N(e.notice)):this.changeTabView(e.index))},this)}this.btn_event=!0}}}});e.exports=d,cc._RF.pop()},{backpack_controller:"backpack_controller",common_scrollview:"common_scrollview",mainscene_controller:"mainscene_controller",mall_const:"mall_const",mall_controller:"mall_controller",mall_event:"mall_event",mall_item:"mall_item",pathtool:"pathtool",role_controller:"role_controller",scene_const:"scene_const",timetool:"timetool"}],mall_window:[function(t,e,i){"use strict";cc._RF.push(e,"ddd5fLQNQdDErBfpTr0feoT","mall_window");var s=t("pathtool"),n=t("mall_controller"),a=t("role_controller"),o=t("common_scrollview"),l=t("mall_event"),r=t("mall_const"),c=t("mall_item"),_=t("timetool"),h=t("backpack_controller"),d=t("backpack_event"),u=t("backpack_const"),m=t("commonalert"),f=cc.Class({extends:CommonWindowTab,ctor:function(){this.model=n.getInstance().getModel(),this.ctrl=n.getInstance(),this.win_type=WinType.Full,this.viewTag=SCENE_TAG.ui,this.tab_info_list=[{label:gdata("exchange_data","data_shop_list",1).name,index:1,status:!0,notice:cc.js.formatStr("%s\u7ea7\u5f00\u542f",gdata("exchange_data","data_shop_exchage_cost","open_gold_lev").val),is_first:!0},{label:gdata("exchange_data","data_shop_list",2).name,index:2,status:!0,notice:cc.js.formatStr("%s\u7ea7\u5f00\u542f",gdata("exchange_data","data_shop_exchage_cost","open_hero_soul_lev").val),is_first:!0},{label:gdata("exchange_data","data_shop_list",3).name,index:3,status:!0,notice:cc.js.formatStr("%s\u7ea7\u5f00\u542f",gdata("exchange_data","data_shop_exchage_cost","open_point_lev").val),is_first:!0},{label:gdata("exchange_data","data_shop_list",r.MallType.SkillShop).name,index:4,status:!0,notice:cc.js.formatStr("%s\u7ea7\u5f00\u542f",gdata("exchange_data","data_shop_exchage_cost","open_skill_lev").val),is_first:!0}],this.title_str="\u5546\u57ce",this.tab_list=this.tab_info_list,this.cur_tab=null,this.cur_index=null,this.first_index=null,this.data_list={},this.role_vo=a.getInstance().getRoleVo()},initPanel:function(){null==this.mall_root_wnd&&this.loadRes(s.getPrefabPath("mall","mall_window_2"),function(t){var e=t;this.createMallRootWnd(e)}.bind(this))},createMallRootWnd:function(t){this.mall_root_wnd=t,this.mall_root_wnd.setParent(this.container),this.mall_container=this.mall_root_wnd.getChildByName("container"),this.mall_scroll_con=this.mall_container.getChildByName("scrollCon"),this.btn=this.mall_container.getChildByName("btn"),this.btn.active=!1,this.btn_label=this.seekChild(this.btn,"Label",cc.Label),this.btn_img=this.seekChild(this.btn,"img",cc.Sprite),this.coin=this.mall_container.getChildByName("coin").getComponent(cc.Sprite),this.count=this.mall_container.getChildByName("count").getComponent(cc.Label),this.add_btn=this.mall_container.getChildByName("add_btn"),this.time_rt=this.mall_container.getChildByName("time").getComponent(cc.RichText),this.time_down_text_rt=this.mall_container.getChildByName("time_down_text").getComponent(cc.RichText),this.add_btn.active=!1,this.refresh_count=this.mall_container.getChildByName("refresh_count").getComponent(cc.Label),this.tips_btn=this.mall_container.getChildByName("tips_btn"),this.tips_btn.active=!1,this.good_cons=this.mall_container.getChildByName("good_cons");var e=cc.size(622,705),i={item_class:c,start_x:4,space_x:0,start_y:3,space_y:2,item_width:306,item_height:143,row:0,col:2,need_dynamic:!0};this.item_scrollview=new o,this.item_scrollview.createScroll(this.mall_scroll_con,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,e,i,cc.v2(.5,.5)),this.selectedTabCallBack(this.first_index),this.registerEvent_1()},registerEvent_1:function(){this.add_btn&&this.add_btn.on(cc.Node.EventType.TOUCH_END,function(){var e=gdata("exchange_data","data_shop_list",[this.cur_index]).item_bid,i=Utils.getItemConfig(e);t("backpack_controller").getInstance().openTipsSource(!0,i)},this),this.btn&&this.btn.on(cc.Node.EventType.TOUCH_END,function(){if(4==this.cur_index||2==this.cur_index){var t=this.cur_index,e=function(){this.ctrl.sender13405(t)}.bind(this);if(4==this.cur_index)t=r.MallType.SkillShop,e();else{var i,n,a=Config.exchange_data.data_shop_exchage_cost.soul_reset_cost;a&&(i=a.val[0][0],n=a.val[0][1]);var o=Utils.getItemConfig(i).icon,l=[],c=s.getIconPath("item",o);l.push(c);var _=StringUtil.parseStr("\u662f\u5426\u6d88\u8017<img src=%s scale=0.3 visible=true /><div>%s</div>\u8fdb\u884c\u91cd\u7f6e\uff1f").string,h=cc.js.formatStr(_,o,n);m.show(h,Utils.TI18N("\u786e\u5b9a"),e.bind(this),Utils.TI18N("\u53d6\u6d88"),null,null,null,{resArr:l})}}},this),this.addGlobalEvent(l.Open_View_Event,function(t){if(4!=this.cur_index&&2!=this.cur_index){this.cur_tab.is_first=!1;var e=this.getConfig(this.cur_index,t);this.data_list[this.cur_index]=Utils.deepCopy(e),this.item_scrollview.setData(e,function(t){this.ctrl.openMallBuyWindow(!0,t)})}}.bind(this)),this.addGlobalEvent(l.Get_Buy_list,function(t){if(4==this.cur_index||2==this.cur_index){this.cur_tab.is_first=!1;var e=Utils.TI18N("\u514d\u8d39\u5237\u65b0");if(2==this.cur_index&&t.free_count<=0){var i=gdata("exchange_data","data_shop_exchage_cost","soul_reset_cost");if(i){var n=i.val[0][0],a=i.val[0][1];e=cc.js.formatStr(Utils.TI18N("%s\u91cd\u7f6e"),a),this.loadRes(s.getItemRes(Utils.getItemConfig(n).icon),function(t){this.btn_img.spriteFrame=t}.bind(this))}}for(var o in this.btn_label.string=e,this.setResetCount(t),t.item_list){var l=t.item_list[o];4==this.cur_index?l.shop_type=r.MallType.SkillShop:l.shop_type=this.cur_index}this.data_list[this.cur_index]=Utils.deepCopy(t),4==this.cur_index&&this.setLessTime(this.data_list[this.cur_index].refresh_time-gcore.SmartSocket.getTime()),this.item_scrollview.setData(this.data_list[this.cur_index].item_list,function(t){this.ctrl.openMallBuyWindow(!0,t)}.bind(this))}}.bind(this)),this.role_vo&&null==this.role_update_lev_event&&(this.role_update_lev_event=this.role_vo.bind(EventId.UPDATE_ROLE_ATTRIBUTE,function(t,e){if(null!=this.cur_index&&this.cur_index!=r.MallType.ScoreShop)if("lev"==t)for(var i in this.tab_list)this.setTabBtnTouchStatus(this.checkBtnIsOpen(i),i);else if("gold"==t||"arena_cent"==t||"guild"==t||"hero_soul"==t||"friend_point"==t||"red_gold"==t){var s=gdata("exchange_data","data_shop_list",[this.cur_index]);if(s){var n=s.item_bid;15==n?this.count.string=Utils.getMoneyString(this.role_vo.gold):gdata("item_data","data_assets_id2label",[n])==t&&(this.count.string=Utils.getMoneyString(this.role_vo[gdata("item_data","data_assets_id2label",[n])]))}}},this)),this.addGlobalEvent(l.Frash_tips_event,function(){if(4==this.cur_index||2==this.cur_index){var t=this.cur_index;4==this.cur_index&&(t=r.MallType.SkillShop),this.ctrl.sender13403(t)}}.bind(this)),this.addGlobalEvent(l.Buy_Success_Event,function(t){if(null!=this.cur_index&&null!=this.data_list&&null!=this.data_list[this.cur_index]&&(2!=this.cur_index||4!=this.cur_index))for(var e in this.data_list[this.cur_index]){var i=this.data_list[this.cur_index][e];i.id==t.eid&&null!=Utils.next(t.ext||{})&&(i.has_buy=t.ext[0].val)}}.bind(this)),this.addGlobalEvent(l.Buy_One_Success,function(t){if(null!=this.cur_index&&null!=this.data_list&&null!=this.data_list[this.cur_index]){var e=this.cur_index;for(var i in 4==this.cur_index&&(e=r.MallType.SkillShop),this.data_list[this.cur_index].item_list){var s=this.data_list[this.cur_index].item_list[i];s.shop_type==e&&s.order&&t.order==s.order&&(s.has_buy=1)}}}.bind(this)),this.addGlobalEvent(d.DELETE_GOODS,function(t,e){if(t!=u.Bag_Code.EQUIPS){var i=Config.exchange_data.data_shop_list[r.MallType.SkillShop].item_bid;for(var s in e){if(e[s].base_id==i){this.updateIconInfo(i);break}}}}.bind(this)),this.addGlobalEvent(d.MODIFY_GOODS_NUM,function(t,e){if(t!=u.Bag_Code.EQUIPS){var i=Config.exchange_data.data_shop_list[r.MallType.SkillShop].item_bid;for(var s in e){if(e[s].base_id==i){this.updateIconInfo(i);break}}}}.bind(this)),this.addGlobalEvent(d.ADD_GOODS,function(t,e){if(t!=u.Bag_Code.EQUIPS){var i=Config.exchange_data.data_shop_list[r.MallType.SkillShop].item_bid;for(var s in e){if(e[s].base_id==i){this.updateIconInfo(i);break}}}}.bind(this)),this.tips_btn.on(cc.Node.EventType.TOUCH_END,function(e){var i="";if(2==this.cur_index)(s=gdata("exchange_data","data_shop_exchage_cost","hero_soul_instruction"))&&s.desc&&(i=s.desc);else if(4==this.cur_index){var s;(s=gdata("exchange_data","data_shop_exchage_cost","secret_instruction"))&&s.desc&&(i=s.desc)}Utils.playButtonSound(1);var n=e.touch.getLocation();t("tips_controller").getInstance().showCommonTips(i,n)},this)},setLessTime:function(t){var e=this;e.time_rt&&(this.time_tichet&&(gcore.Timer.del(this.time_tichet),this.time_tichet=null),this.time_rt.node.active=!0,this.time_down_text_rt.node.active=!0,t>0?(e.setTimeFormatString(t),null==this.time_tichet&&(this.time_tichet=gcore.Timer.set(function(){--t<0?(gcore.Timer.del(this.time_tichet),this.time_tichet=null,4==e.cur_index&&e.ctrl.sender13403(r.MallType.SkillShop)):this.setTimeFormatString(t)}.bind(this),1e3,-1))):e.setTimeFormatString(t))},setTimeFormatString:function(t){this.time_rt.string=t>0?"\u514d\u8d39\u5237\u65b0: <color=#249003>"+_.getTimeFormat(t)+"</color>":"\u514d\u8d39\u5237\u65b0: <color=#249003>00:00:00</color>"},updateIconInfo:function(t){t==gdata("item_data","data_assets_label2id","gold")?this.count.string=Utils.getMoneyString(this.role_vo.gold):this.count.string=Utils.getMoneyString(h.getInstance().getModel().getItemNumByBid(t))},openRootWnd:function(t){var e=t=t||1;if(t==r.MallType.SkillShop)e=4;else if(t>4){-1!=gdata("exchange_data","data_shop_list",[3]).subtype.indexOf(t)&&(e=3)}else t==r.MallType.ScoreShop&&(t=8);this.first_index=e,this.sub_type=t,this.ctrl.setFirstLogin(!1),this.setSelecteTab(e)},closeCallBack:function(){this.ctrl.openMallPanel(!1),this.item_scrollview&&(this.item_scrollview.DeleteMe(),this.item_scrollview=null),this.son_panel&&this.son_panel.deleteMe(),this.role_update_lev_event&&(this.role_vo.unbind(this.role_update_lev_event),this.role_update_lev_event=null),this.time_tichet&&(gcore.Timer.del(this.time_tichet),this.time_tichet=null),this.role_vo=null,this.son_panel=null;var e=t("action_controller");e.getInstance().getTreasureView()&&e.getInstance().getTreasureView().setVisible(!0)},selectedTabCallBack:function(e){var i;if(this.cur_index!=e&&null!=this.mall_root_wnd)if(this.first_index=e,3==e?this.sub_type?(i=this.sub_type,this.sub_type=null):i=gdata("exchange_data","data_shop_list",[e]).subtype[0]:this.sub_type=null,this.cur_index=e,this.mall_scroll_con.active=3!=e,this.cur_tab=this.tab_info_list[e-1],null==this.cur_tab&&(e=1,this.cur_index=e,this.cur_tab=this.tab_info_list[e-1]),this.time_rt.node.active=!1,this.time_down_text_rt.node.active=!1,this.tips_btn.active=!1,this.hasSon(e)){if(this.btn.active=!1,this.good_cons.active=!1,this.son_panel)this.son_panel.setVisibleStatus(!0);else{var n=t("mall_son_panel");this.son_panel=new n,this.son_panel.show(),this.son_panel.setParent(this.mall_container)}this.mall_scroll_con.active=!1,this.son_panel.setList(gdata("exchange_data","data_shop_list",[e]).subtype),this.son_panel.openById(i),this.btn.active=!1,this.good_cons.active=!1,this.coin.node.active=!1,this.count.node.active=!1,this.refresh_count.label="",this.add_btn.active=!1}else if(e<=4){if(4!=e&&2!=e)this.btn.active=!1,this.coin.node.active=!0,this.count.node.active=!0,this.refresh_count.label="",this.add_btn.active=!1,this.cur_tab.is_first?this.ctrl.sender13401(e):this.item_scrollview.setData(this.data_list[this.cur_index],function(t){this.ctrl.openMallBuyWindow(!0,t)});else if(this.btn.active=!0,this.coin.node.active=!0,this.count.node.active=!0,this.add_btn.active=!1,2==e&&(this.tips_btn.active=!0),this.cur_tab.is_first){var a=e;4==a&&(a=r.MallType.SkillShop),this.ctrl.sender13403(a)}else{if(4==e){var o=this.data_list[this.cur_index].refresh_time-gcore.SmartSocket.getTime();o>0?this.setLessTime(o):(this.setTimeFormatString(0),this.ctrl.sender13403(r.MallType.SkillShop))}this.setResetCount(this.data_list[this.cur_index]),this.item_scrollview.setData(this.data_list[this.cur_index].item_list,function(t){this.ctrl.openMallBuyWindow(!0,t)}.bind(this))}var l;l=4==e?gdata("exchange_data","data_shop_list",[r.MallType.SkillShop]).item_bid:gdata("exchange_data","data_shop_list",[e]).item_bid;var c=s.getItemRes(Utils.getItemConfig(l).icon);c&&this.loadRes(c,function(t){this.coin.spriteFrame=t}.bind(this)),this.updateIconInfo(l),this.good_cons.active=!0,this.son_panel&&this.son_panel.setVisibleStatus(!1)}},getConfig:function(t,e){var i=[],s=[];1==t&&(i=Utils.deepCopy(Config.exchange_data.data_shop_exchage_gold));var n=[];if(4!=t&&2!=t){s=Utils.deepCopy(e.item_list);for(var a in i){var o=i[a];if(o.type==this.cur_index){if(s&&Utils.next(s))for(var l in s){var r=s[l];if(o.id==r.item_id){r.ext[0]&&null!=r.ext[0].val&&(o.has_buy=r.ext[0].val,s.splice(l,1));break}o.has_buy=0}else o.has_buy=0;n.push(o)}}}return n},hasSon:function(t){var e=gdata("exchange_data","data_shop_list",[t]).subtype;return null!=Utils.next(e)},checkBtnIsOpen:function(t){return 1==t?this.role_vo.lev>=gdata("exchange_data","data_shop_exchage_cost","open_gold_lev").val:2==t?this.role_vo.lev>=gdata("exchange_data","data_shop_exchage_cost","open_hero_soul_lev").val:3==t?this.role_vo.lev>=gdata("exchange_data","data_shop_exchage_cost","open_point_lev").val:4!=t||this.role_vo.lev>=gdata("exchange_data","data_shop_exchage_cost","open_secret_lev").val},setResetCount:function(t){if(t){var e=t.free_count||0,i=Utils.TI18N("\u514d\u8d39\u5237\u65b0");if(this.btn_img.node.active=!1,2==this.cur_index){if(e<=0){var n=Config.exchange_data.data_shop_exchage_cost.soul_reset_cost;if(n){var a=n.val[0][0];i=n.val[0][1]+"\u91cd\u7f6e",this.btn_img.node.active=!0,this.loadRes(s.getItemRes(Utils.getItemConfig(a).icon),function(t){this.btn_img.spriteFrame=t}.bind(this))}}}else if(4==this.cur_index){if(e<=0){var o=Config.exchange_data.data_shop_list[r.MallType.SkillShop];if(o){var l=o.cost_list,c=l[0][0];i=l[0][1]+"\u5237\u65b0",this.btn_img.node.active=!0,this.loadRes(s.getItemRes(Utils.getItemConfig(c).icon),function(t){this.btn_img.spriteFrame=t}.bind(this))}}else{var _=Config.exchange_data.data_shop_exchage_cost.skill_refresh_free;_&&(i=cc.js.formatStr("%s(%s/%s)",Utils.TI18N("\u514d\u8d39\u5237\u65b0"),e,_.val))}var h=Config.exchange_data.data_shop_exchage_cost.skill_refresh_number,d=0;h&&(d=h.val);var u=t.count||0,m=cc.js.formatStr("%s:%s/%s",Utils.TI18N("\u5237\u65b0\u6b21\u6570"),u,d);this.time_down_text_rt.string=m}this.btn_label.string=i}},setTabBtnTouchStatus:function(t,e){}});e.exports=f,cc._RF.pop()},{action_controller:"action_controller",backpack_const:"backpack_const",backpack_controller:"backpack_controller",backpack_event:"backpack_event",common_scrollview:"common_scrollview",commonalert:"commonalert",mall_const:"mall_const",mall_controller:"mall_controller",mall_event:"mall_event",mall_item:"mall_item",mall_son_panel:"mall_son_panel",pathtool:"pathtool",role_controller:"role_controller",timetool:"timetool",tips_controller:"tips_controller"}],"md5.min":[function(t,e,i){"use strict";function s(t){"@babel/helpers - typeof";return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}cc._RF.push(e,"bc345E9rElOS4aTdMru22r1","md5.min"),function(t){function i(t,e){var i=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(i>>16)<<16|65535&i}function n(t,e){return t<<e|t>>>32-e}function a(t,e,s,a,o,l){return i(n(i(i(e,t),i(a,l)),o),s)}function o(t,e,i,s,n,o,l){return a(e&i|~e&s,t,e,n,o,l)}function l(t,e,i,s,n,o,l){return a(e&s|i&~s,t,e,n,o,l)}function r(t,e,i,s,n,o,l){return a(e^i^s,t,e,n,o,l)}function c(t,e,i,s,n,o,l){return a(i^(e|~s),t,e,n,o,l)}function _(t,e){t[e>>5]|=128<<e%32,t[14+(e+64>>>9<<4)]=e;var s,n,a,_,h,d=1732584193,u=-271733879,m=-1732584194,f=271733878;for(s=0;s<t.length;s+=16)n=d,a=u,_=m,h=f,u=c(u=c(u=c(u=c(u=r(u=r(u=r(u=r(u=l(u=l(u=l(u=l(u=o(u=o(u=o(u=o(u,m=o(m,f=o(f,d=o(d,u,m,f,t[s],7,-680876936),u,m,t[s+1],12,-389564586),d,u,t[s+2],17,606105819),f,d,t[s+3],22,-1044525330),m=o(m,f=o(f,d=o(d,u,m,f,t[s+4],7,-176418897),u,m,t[s+5],12,1200080426),d,u,t[s+6],17,-1473231341),f,d,t[s+7],22,-45705983),m=o(m,f=o(f,d=o(d,u,m,f,t[s+8],7,1770035416),u,m,t[s+9],12,-1958414417),d,u,t[s+10],17,-42063),f,d,t[s+11],22,-1990404162),m=o(m,f=o(f,d=o(d,u,m,f,t[s+12],7,1804603682),u,m,t[s+13],12,-40341101),d,u,t[s+14],17,-1502002290),f,d,t[s+15],22,1236535329),m=l(m,f=l(f,d=l(d,u,m,f,t[s+1],5,-165796510),u,m,t[s+6],9,-1069501632),d,u,t[s+11],14,643717713),f,d,t[s],20,-373897302),m=l(m,f=l(f,d=l(d,u,m,f,t[s+5],5,-701558691),u,m,t[s+10],9,38016083),d,u,t[s+15],14,-660478335),f,d,t[s+4],20,-405537848),m=l(m,f=l(f,d=l(d,u,m,f,t[s+9],5,568446438),u,m,t[s+14],9,-1019803690),d,u,t[s+3],14,-187363961),f,d,t[s+8],20,1163531501),m=l(m,f=l(f,d=l(d,u,m,f,t[s+13],5,-1444681467),u,m,t[s+2],9,-51403784),d,u,t[s+7],14,1735328473),f,d,t[s+12],20,-1926607734),m=r(m,f=r(f,d=r(d,u,m,f,t[s+5],4,-378558),u,m,t[s+8],11,-2022574463),d,u,t[s+11],16,1839030562),f,d,t[s+14],23,-35309556),m=r(m,f=r(f,d=r(d,u,m,f,t[s+1],4,-1530992060),u,m,t[s+4],11,1272893353),d,u,t[s+7],16,-155497632),f,d,t[s+10],23,-1094730640),m=r(m,f=r(f,d=r(d,u,m,f,t[s+13],4,681279174),u,m,t[s],11,-358537222),d,u,t[s+3],16,-722521979),f,d,t[s+6],23,76029189),m=r(m,f=r(f,d=r(d,u,m,f,t[s+9],4,-640364487),u,m,t[s+12],11,-421815835),d,u,t[s+15],16,530742520),f,d,t[s+2],23,-995338651),m=c(m,f=c(f,d=c(d,u,m,f,t[s],6,-198630844),u,m,t[s+7],10,1126891415),d,u,t[s+14],15,-1416354905),f,d,t[s+5],21,-57434055),m=c(m,f=c(f,d=c(d,u,m,f,t[s+12],6,1700485571),u,m,t[s+3],10,-1894986606),d,u,t[s+10],15,-1051523),f,d,t[s+1],21,-2054922799),m=c(m,f=c(f,d=c(d,u,m,f,t[s+8],6,1873313359),u,m,t[s+15],10,-30611744),d,u,t[s+6],15,-1560198380),f,d,t[s+13],21,1309151649),m=c(m,f=c(f,d=c(d,u,m,f,t[s+4],6,-145523070),u,m,t[s+11],10,-1120210379),d,u,t[s+2],15,718787259),f,d,t[s+9],21,-343485551),d=i(d,n),u=i(u,a),m=i(m,_),f=i(f,h);return[d,u,m,f]}function h(t){var e,i="",s=32*t.length;for(e=0;e<s;e+=8)i+=String.fromCharCode(t[e>>5]>>>e%32&255);return i}function d(t){var e,i=[];for(i[(t.length>>2)-1]=void 0,e=0;e<i.length;e+=1)i[e]=0;var s=8*t.length;for(e=0;e<s;e+=8)i[e>>5]|=(255&t.charCodeAt(e/8))<<e%32;return i}function u(t){return h(_(d(t),8*t.length))}function m(t,e){var i,s,n=d(t),a=[],o=[];for(a[15]=o[15]=void 0,n.length>16&&(n=_(n,8*t.length)),i=0;i<16;i+=1)a[i]=909522486^n[i],o[i]=1549556828^n[i];return s=_(a.concat(d(e)),512+8*e.length),h(_(o.concat(s),640))}function f(t){var e,i,s="";for(i=0;i<t.length;i+=1)e=t.charCodeAt(i),s+="0123456789abcdef".charAt(e>>>4&15)+"0123456789abcdef".charAt(15&e);return s}function p(t){return unescape(encodeURIComponent(t))}function g(t){return u(p(t))}function v(t){return f(g(t))}function b(t,e){return m(p(t),p(e))}function w(t,e){return f(b(t,e))}function y(t,e,i){return e?i?b(e,t):w(e,t):i?g(t):v(t)}"function"==typeof define&&define.amd?define(function(){return y}):"object"==(void 0===e?"undefined":s(e))&&e.exports?e.exports=y:(void 0).md5=y}(),cc._RF.pop()},{}],merge_json:[function(t,e,i){"use strict";cc._RF.push(e,"fce09XTtRlDkrRmnfeaMAit","merge_json");e.exports=function(){},cc._RF.pop()},{}],modulelist:[function(t,e,i){"use strict";cc._RF.push(e,"cd4d2FEzoFIi4zft6qq4zN8","modulelist");e.exports={module_list:{LoginController:"login_controller",MainSceneController:"mainscene_controller",MainUiController:"mainui_controller",RoleController:"role_controller",BattleController:"battle_controller",MailController:"mail_controller",BackpackController:"backpack_controller",FriendController:"friend_controller",ExchangeController:"exchange_controller",OnlinegiftController:"onlinegift_controller",EsecsiceController:"esecsice_controller",ChatController:"chat_controller",StoneDungeonController:"stone_dungeon_controller",PartnersummonController:"partnersummon_controller",TaskController:"task_controller",GuildController:"guild_controller",HeroController:"hero_controller",GuildskillController:"guildskill_controller",RankController:"rank_controller",RedBagController:"redbag_controller",GuildBossController:"guildboss_controller",HallowsController:"hallows_controller",Battle_dramaController:"battle_drama_controller",VipController:"vip_controller",StartowerController:"startower_controller",WelfareController:"welfare_controller",ArenaController:"arena_controller",EndlessTrailController:"endless_trail_controller",HeroexpeditController:"heroexpedit_controller",PrimusController:"primus_controller",SeerpalaceController:"seerpalace_controller",WorldmapController:"worldmap_controller",ChatItemController:"chat_item_controller",GuildeController:"guide_controller",StoryController:"story_controller",VoyageController:"voyage_controller",ActionController:"action_controller",MallController:"mall_controller",LevupgradeController:"levupgrade_controller",InvitecodeController:"invitecode_controller",LookController:"look_controller",GuildwarController:"guildwar_controller",VedioController:"vedio_controller",AdventureActivityController:"adventureactivity_controller",AdventureController:"adventure_controller",TimesummonController:"timesummon_controller",PromptController:"prompt_controller",NewfirstchargeController:"newfirstcharge_controller",DaychargeController:"daycharge_controller",OrderactionController:"orderaction_controller",LimitexerciseController:"limitexercise_controller"},data_list:["activity_data","adventure_data","arena_champion_data","arena_data","attr_data","avatar_data","battle_act_data","battle_bg_data","boss_data","buff_data","charge_data","checkin_data","city_data","color_data","combat_halo_data","combat_type_data","cross_ground_data","cross_show_data","dailyplay_data","days_rank_data","day_goals_data","dial_data","drama_chat_data","drama_data","dungeon_data","dungeon_scene_data","dungeon_stone_data","effect_data","endless_data","escort_data","exchange_data","expedition_data","face_data","feat_data","formation_data","function_data","gift_data","gm_data","group_control_data","guild_data","guild_dun_data","guild_quest_data","guild_skill_data","guild_war_data","hallows_data","holiday_client_data","holiday_exchange_data","holiday_groupon_data","holiday_war_order_data","honor_data","invite_code_data","item_data","item_product_data","lev_gift_data","loading_desc_data","login_days_data","looks_data","main_scene_data","misc_data","month_fund_data","notice_data","partner_artifact_data","partner_data","partner_eqm_data","partner_field_data","partner_skill_data","power_gift_data","primus_data","privilege_data","quest_data","random_name_data","recommend_data","recruit_award_data","recruit_data","recruit_high_data","recruit_holiday_data","recruit_holiday_elite_data","role_data","shipping_data","skill_data","source_data","star_data","star_gift_data","star_tower_data","stronger_data","unit_data","video_data","vip_data","welfare_data","tri_gift_data","holiday_lanterm_adventure_data","main_quest_data","holiday_boss_new_data","partner_skin_data","hero_love_data"]},cc._RF.pop()},{}],month_item:[function(t,e,i){"use strict";cc._RF.push(e,"c84f0bvD+9Pwo4RqiQR1TK1","month_item");var s=t("pathtool"),n=t("common_scrollview");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("welfare","week_month_panel_item")},initConfig:function(){},initPanel:function(){this.main_container=this.seekChild("main_container"),this.btn_charge_btn=this.seekChild("btn_charge",cc.Button),this.charge_price_lb=this.seekChild(this.btn_charge_btn.node,"Text_4_0",cc.Label),this.text_remain_lb=this.seekChild(this.main_container,"Text_4",cc.Label);var t=this.seekChild(this.main_container,"good_cons"),e=t.getContentSize(),i={item_class:"backpack_item",start_x:0,space_x:0,start_y:0,space_y:0,item_width:.8*BackPackItem.Width,item_height:.8*BackPackItem.Height,row:1,col:1,scale:.8};this.tab_scrollview=new n,this.tab_scrollview.createScroll(t,cc.v2(0,-10),ScrollViewDir.horizontal,ScrollViewStartPos.top,e,i,cc.v2(.5,.5))},registerEvent:function(){this.btn_charge_btn.node.on("click",function(){Utils.playButtonSound(1),this.data.limit_count>0?SDK.pay(this.data.val,1,this.data.charge_id,this.data.gift_name,null,null,null):message(Utils.TI18N("\u8be5\u793c\u5305\u5df2\u552e\u7f44"))},this)},setData:function(t){this.data=t,this.root_wnd&&this.onShow()},addCallBack:function(t){this.callback=t},onShow:function(t){if(null!=this.data){var e=this.data;this.charge_price_lb.string=e.val+Utils.TI18N("\u5143"),e.count<=0?(e.count=0,Utils.setGreyButton(this.btn_charge_btn,!0),this.charge_price_lb.node.color=new cc.Color(255,255,255,255)):(Utils.setGreyButton(this.btn_charge_btn,!1),this.charge_price_lb.node.color=new cc.Color(113,40,4,255)),this.text_remain_lb.string=Utils.TI18N("\u5269\u4f59: ")+e.count;var i=[];for(var s in e.reward){var n=e.reward[s],a=Utils.deepCopy(Utils.getItemConfig(n[0]));a.quantity=n[1],a.bid=a.id,a.num=n[1],i.push(a)}this.tab_scrollview.setData(i),this.tab_scrollview.addEndCallBack(function(){var t=this.tab_scrollview.getItemList();for(var e in t)t[e].setDefaultTip()}.bind(this))}},setExtendData:function(t){this.reward_type=t||1},getData:function(){return this.data},onHide:function(){},onDelete:function(){this.tab_scrollview&&(this.tab_scrollview.deleteMe(),this.tab_scrollview=null)}});cc._RF.pop()},{common_scrollview:"common_scrollview",pathtool:"pathtool"}],month_week_panel:[function(t,e,i){"use strict";cc._RF.push(e,"59cf3yeDqRBPK2A/rSiyWov","month_week_panel");var s=t("pathtool"),n=t("common_scrollview"),a=t("month_item"),o=t("welfare_event"),l=t("timetool"),r=t("action_event"),c=t("welfare_const");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("welfare","week_month_panel")},initConfig:function(){this.ctrl=t("welfare_controller").getInstance(),this.model=this.ctrl.getModel(),this.gift_info=Config.misc_data.data_cycle_gift_info,this.reward_list=Config.misc_data.data_cycle_gift_reward,this.cur_charge_id=0},initPanel:function(){this.main_container=this.seekChild("main_container");var t=this.seekChild("title_con");this.btn_rule=this.seekChild(t,"btn_rule"),this.btn_rule.active=!1,this.sprite_title=this.seekChild(t,"sprite_title",cc.Sprite),this.model.setWeekMonthSortData(),this.ramain_time_lb=this.seekChild("remain_time",cc.Label),this.good_cons=this.seekChild(this.main_container,"good_cons");var e=this.good_cons.getContentSize(),i=cc.size(e.width,e.height),s={item_class:a,start_x:5,space_x:0,start_y:0,space_y:0,item_width:688,item_height:136,row:0,col:1,need_dynamic:!0};this.order_scrollview=new n,this.order_scrollview.createScroll(this.good_cons,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,i,s,cc.v2(.5,.5))},registerEvent:function(){this.addGlobalEvent(o.Updata_Week_Month_Data,function(t){this.getMonthWeekItemInfo(t)},this),this.addGlobalEvent(r.Is_Charge_Event,function(t){if(t&&t.status&&t.charge_id){var e=Config.charge_data.data_charge_data[t.charge_id];e&&1==t.status&&t.charge_id==this.cur_charge_id&&SDK.pay(e.val,1,e.id,e.name,null,null,null)}},this)},onShow:function(t){this.holiday_id=t;var e="txt_cn_welfare_banner6";this.send_holiday_id=1,this.holiday_id==c.WelfareIcon.month&&(e="txt_cn_welfare_banner7",this.send_holiday_id=2);var i=s.getIconPath("welfare/welfare_banner",e);this.loadRes(i,function(t){this.sprite_title.spriteFrame=t}.bind(this)),this.send_holiday_id&&this.ctrl.sender21007(this.send_holiday_id)},getMonthWeekItemInfo:function(t){if(this.setLessTime(t.ref_time-gcore.SmartSocket.getTime()),this.gift_info[t.type]){this.setBuyCount(t.first_gift);var e=[];for(var i in this.gift_info[t.type]){var s=this.gift_info[t.type][i];s.count=s.limit_count-this.getBuyCount(s.charge_id),s.count<=0&&(s.count=0),s.reward=this.getRegisteDayReward(s.charge_id,t.reg_day),e.push(s)}this.sortList(e),this.order_scrollview.setData(e,function(t){this.cur_charge_id=t.getData().charge_id||0}.bind(this))}},getRegisteDayReward:function(t,e){if(this.reward_list[t]){var i=1;for(var s in this.reward_list[t]){var n=this.reward_list[t][s];if(e>=n.min&&e<=n.max){i=n.sort_id;break}}return this.reward_list[t][i].reward}return[]},sortList:function(t){t.sort(function(t,e){return t.count<=0&&e.count>0?1:t.count>0&&e.count<=0?-1:t.charge_id-e.charge_id})},setBuyCount:function(t){if(t&&null!=Utils.next(t))for(var e in this.buyCountData={},t)this.buyCountData[t[e].id]=t[e].count},getBuyCount:function(t){return this.buyCountData&&this.buyCountData[t]?this.buyCountData[t]:0},setLessTime:function(t){if(null!=this.ramain_time_lb)if(this.ramain_time_lb.node.stopAllActions(),t>0){this.setTimeFormatString(t);var e=function(){(t-=1)<0?(this.ramain_time_lb.node.stopAllActions(),this.ramain_time_lb.string="00:00:00"):this.setTimeFormatString(t)}.bind(this);this.ramain_time_lb.node.runAction(cc.repeatForever(cc.sequence(cc.delayTime(1),cc.callFunc(e))))}else this.setTimeFormatString(t)},setTimeFormatString:function(t){t>0?this.ramain_time_lb.string=l.getTimeForFunction(t):(this.ramain_time_lb.node.stopAllActions(),this.ramain_time_lb.string="00:00:00")},setVisibleStatus:function(t){t=t||!1,this.setVisible(t),1==t&&this.send_holiday_id&&this.ctrl.sender21007(this.send_holiday_id)},onHide:function(){},onDelete:function(){this.order_scrollview&&(this.order_scrollview.deleteMe(),this.order_scrollview=null)}});cc._RF.pop()},{action_event:"action_event",common_scrollview:"common_scrollview",month_item:"month_item",pathtool:"pathtool",timetool:"timetool",welfare_const:"welfare_const",welfare_controller:"welfare_controller",welfare_event:"welfare_event"}],newfirstcharge1_window:[function(t,e,i){"use strict";cc._RF.push(e,"bdd33ZaLJVAp5HTRLGTDcyY","newfirstcharge1_window");var s=t("pathtool"),n=t("vip_controller"),a=t("newfirstcharge_event"),o=t("role_controller");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("newfirstcharge","newfirstcharge1_window"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Big,this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){this.effect_list=[],this.cur_node=null,this.item_list={},this.recharge_list={},this.select=(new cc.Color).fromHEX("#AB382B"),this.notSelect=(new cc.Color).fromHEX("#EC9A3B"),this.item_reward_list=[];for(var t=1;t<=3;t++)this.item_reward_list[t]={}},openCallBack:function(){var t=this;this.background=this.root_wnd.getChildByName("background"),this.background.scale=FIT_SCALE;var e=this.seekChild("bg",cc.Sprite);this.loadRes(s.getBigBg("action/txt_cn_action_bigbg_30506"),function(t){e.spriteFrame=t}.bind(this)),this.close_btn=this.seekChild("newfirstcharge_btn_close"),this.btn_recharge=this.seekChild("newfirstcharge_btn_bottom"),this.loadRes(s.getUIIconPath("newfirstcharge","newfirstcharge_btn_bottom"),function(t){this.btn_recharge.getComponent(cc.Sprite).spriteFrame=t}.bind(this)),this.recharge_6_nd=this.seekChild("toggle1"),this.recharge_6_lb=this.seekChild(this.recharge_6_nd,"Label",cc.Label),this.recharge_100_nd=this.seekChild("toggle2"),this.recharge_100_lb=this.seekChild(this.recharge_100_nd,"Label",cc.Label),this.text_rt=this.seekChild("Text",cc.RichText),this.text_rt.string=Utils.TI18N("<color=#643223>\u673a\u4f1a\u4ec5</color><color=#157e22>1</color><color=#643223>\u6b21\uff01\u4ee5\u4e0b\u4ec5\u53ef\u9009\u62e9\u4e00\u4e2a\u5145\u503c\u6863\u4f4d\u83b7\u5f97</color><color=#157e22>\u56db\u500d</color><color=#643223>\u94bb\u77f3\uff01</color>"),this.recharge_6_lb.string=Utils.TI18N("\u9996\u5145\u8d60\u793c"),this.recharge_100_lb.string=Utils.TI18N("100\u5143\u8d60\u793c"),this.tab_view=[this.recharge_6_nd,this.recharge_100_nd],this.remain_charge=this.seekChild("recharge_num",cc.Label),this.remain_charge.string=Utils.TI18N("\u5df2\u7d2f\u5145: ");for(var i=function(e){t.tab_view[e].index=e,t.tab_view[e].on("toggle",function(t){this.changeTabView(e)},t)},n=0;n<this.tab_view.length;++n)i(n);this.model.setFirstRechargeNewData(),this.recharge_info_nd=this.seekChild("rechargeInfo"),this.help_nd=this.seekChild(this.recharge_info_nd,"help");for(var a=1;a<=3;a++){var o=this.recharge_info_nd.getChildByName("item_"+a);if(o){var l={};l.scroll=o.getChildByName("scroll").getChildByName("content"),l.finish_icon=o.getChildByName("finish_icon"),l.finish_icon.active=!1,l.title=o.getChildByName("title").getComponent(cc.Label),l.title.string=Utils.TI18N("\u7b2c")+a+Utils.TI18N("\u5929\u514d\u8d39\u9886"),l.list={},this.item_list[a]=l}}this.btn_label=this.btn_recharge.getChildByName("Label").getComponent(cc.Label),this.btn_label.string=Utils.TI18N("\u524d\u5f80\u5145\u503c");for(var r=this.seekChild("newfirstcharge_effect"),c=function(e){var i={};i.node=r.getChildByName("charge_item_"+e),i.node.active=!1,i.bg=i.node.getComponent(cc.Sprite),i.node.getChildByName("title_img").getChildByName("num").getComponent(cc.Label).string=Utils.TI18N("4\u500d"),i.rmbNum=i.node.getChildByName("layout").getChildByName("rmb").getComponent(cc.Label),i.goldNum=i.node.getChildByName("layout").getChildByName("goldIcon").getChildByName("goldNum").getComponent(cc.Label),i.referral=i.node.getChildByName("referral"),i.referral.active=!1,t.recharge_list[e]=i;var n=i.node.getChildByName("layout").getChildByName("goldIcon").getChildByName("gold").getComponent(cc.Sprite);t.loadRes(s.getItemRes("3"),function(t){n.spriteFrame=t}),i.node.on("click",function(){Utils.playButtonSound(1);var t=Config.charge_data.data_quadruple_rebate[e];SDK.pay(t.val,null,t.charge_id,t.name,t.name)},t)},_=1;_<5;++_)c(_)},registerEvent:function(){this.addGlobalEvent(a.New_First_Charge_Event,function(t){this.updata_charge_data=t;var e=o.getInstance().getRoleVo(),i=cc.js.formatStr(Utils.TI18N("\u5df2\u7d2f\u5145: %d"),Math.floor(.1*e.vip_exp));this.remain_charge.string=i,this.setRedPointTab(),this.updateData(t)}.bind(this)),this.close_btn.on("click",function(){Utils.playButtonSound(2),this.ctrl.openNewFirstChargeView(!1)},this),this.btn_recharge.on("click",function(){var t=this.model.getFirstRechargeData(this.cur_node.index+1);0==this.get_gift_id?(this.setVisible(!1),n.getInstance().openVipMainWindow(!0,VIPTABCONST.CHARGE,null,function(){this.setVisible(!0)}.bind(this))):1==this.get_gift_id?t[this.gift_index]&&this.ctrl.sender21001(t[this.gift_index].id):this.ctrl.openNewFirstChargeView(!1)},this),this.help_nd.on("click",function(e){Utils.playButtonSound(3);var i=Config.holiday_client_data.data_constant.shouchong_rules,s=e.node.convertToWorldSpaceAR(cc.v2(0,0));t("tips_controller").getInstance().showCommonTips(i.desc,s)},this),this.role_vo=o.getInstance().getRoleVo(),null==this.role_assets_event&&(this.role_assets_event=this.role_vo.bind(EventId.UPDATE_ROLE_ATTRIBUTE,function(t,e){"vip_exp"==t&&this.updateData()}.bind(this)))},openRootWnd:function(t){t=t||1,this.tab_view[t-1].getComponent(cc.Toggle).check(),1==t&&this.changeTabView(t-1),this.ctrl.sender21000()},changeTabView:function(t){var e=this.cur_node;if(e)e.getChildByName("Label").color=this.notSelect;else for(var i=0;i<this.tab_view.length;++i)this.tab_view[i].getChildByName("Label").color=this.notSelect;this.cur_node=this.tab_view[t],this.cur_node.getChildByName("Label").color=this.select;var s=this.model.getFirstRechargeData(t+1);this.fillItemList(s),this.updata_charge_data&&this.updateData(this.updata_charge_data)},updateData:function(){for(var t=this,e=[[1,2,3],[4,5,6]],i=[],n=this.cur_node.index,a=0;a<e[n].length;++a){var l=this.model.getFirstBtnStatus(e[n][a]);i[a]=l,this.item_list[parseInt(a)+1].finish_icon.active=2==l}this.gift_index=0;var r=0;this.get_gift_id=10;for(var c=0;c<i.length;++c)r+=i[c],1==i[c]&&(this.get_gift_id=1,this.gift_index=c);if(this.btn_recharge.active=!1,.1*o.getInstance().getRoleVo().vip_exp<6){var _=function(e){var i=Config.charge_data.data_quadruple_rebate[e],n=t.recharge_list[e];n.node.active=!0,n.rmbNum.string=Utils.TI18N(i.val+"\u5143"),n.goldNum.string=i.gold,1==i.star?(n.referral.active=!0,t.loadRes(s.getUIIconPath("newfirstcharge","newfirstcharge_btn_top"),function(t){n.bg.spriteFrame=t}.bind(t))):(n.referral.active=!1,t.loadRes(s.getUIIconPath("newfirstcharge","newfirstcharge_btn_bottom"),function(t){n.bg.spriteFrame=t}.bind(t)))};for(var h in this.recharge_list)_(h)}else{for(var d in this.text_rt.string=Utils.TI18N("<color=#643223>\u7d2f\u5145100\u5143\u53ef\u9886\u53d6\u66f4\u591a\u8c6a\u793c\uff01</color>"),this.recharge_list){this.recharge_list[d].node.active=!1}this.btn_recharge.active=!0,0==r?(this.get_gift_id=0,this.btn_label.string=Utils.TI18N("\u524d\u5f80\u5145\u503c")):1==r||3==r||5==r?this.btn_label.string=Utils.TI18N("\u9886\u53d6\u5956\u52b1"):2==r||4==r?this.btn_label.string=Utils.TI18N("\u660e\u65e5\u518d\u6765"):6==r&&(this.btn_label.string=Utils.TI18N("\u9886\u53d6\u5b8c\u6bd5"))}},setRedPointTab:function(){for(var t=!1,e=1;e<=3;e++){if((s=this.model.getFirstBtnStatus(e))&&1==s){t=!0;break}}Utils.addRedPointToNodeByStatus(this.tab_view[0],t);var i=!1;for(e=4;e<=6;e++){var s;if((s=this.model.getFirstBtnStatus(e))&&1==s){i=!0;break}}Utils.addRedPointToNodeByStatus(this.tab_view[1],i)},fillItemList:function(t){for(var e=this,i=1,n=0;n<t.length;n++){var a=this.item_list[n+1],o=t[n].item_list.length;a.scroll.setContentSize(cc.size(83.3*o+10*(t.length-1),a.scroll.getContentSize().height));for(var l=0;l<o;l++){var r=83.3*(l+1)-41.65+10*l;if(!this.item_reward_list[n+1][l]&&(this.item_reward_list[n+1][l]=ItemsPool.getInstance().getItem("backpack_item"),this.item_reward_list[n+1][l].setParent(a.scroll),this.item_reward_list[n+1][l].setExtendData({scale:.7,is_show_tips:!0}),this.item_reward_list[n+1][l].show(),t[n].effect_list)){var c=(new cc.Node).addComponent(sp.Skeleton);a.scroll.addChild(c.node,6+i),this.effect_list[i-1]=c,c.node.active=!1}this.item_reward_list[n+1][l]&&(this.item_reward_list[n+1][l].setPosition(r,41.65),this.item_reward_list[n+1][l].setData({bid:t[n].item_list[l][0],num:t[n].item_list[l][1]}),this.effect_list[i-1].node.active=!0,this.effect_list[i-1].node.setPosition(r,41.65),t[n].effect_list&&function(){var a="action",o=1;263==t[n].effect_list[0][l]&&(a="action1",o=1.1),e.effect_list[i-1].node.scale=.7*o;var r=i-1;e.loadRes(s.getSpinePath(s.getEffectRes(t[n].effect_list[0][l])),function(t){this.effect_list[r].skeletonData=t,this.effect_list[r].setAnimation(0,a,!0)}.bind(e))}()),i+=1}}},closeCallBack:function(){if(this.item_reward_list){for(var e=1;e<=3;e++){for(var i in this.item_reward_list[e])this.item_reward_list[e][i].deleteMe(),this.item_reward_list[e][i]=null;this.item_reward_list[e]=null}this.item_reward_list=null}if(null!=this.role_vo&&null!=this.role_assets_event&&(this.role_vo.unbind(this.role_assets_event),this.role_assets_event=null),this.effect_list){for(var s=0;s<this.effect_list.length;++s)this.effect_list[s]&&(this.effect_list[s].destroy(),this.effect_list[s]=null);this.effect_list=null}var n=t("guide_event");gcore.GlobalEvent.fire(n.CloseTaskEffect),this.ctrl.openNewFirstChargeView(!1)}});cc._RF.pop()},{guide_event:"guide_event",newfirstcharge_event:"newfirstcharge_event",pathtool:"pathtool",role_controller:"role_controller",tips_controller:"tips_controller",vip_controller:"vip_controller"}],newfirstcharge_controller:[function(t,e,i){"use strict";cc._RF.push(e,"966e4GnW1BIsIjuBPIZS+yw","newfirstcharge_controller");var s=cc.Class({extends:BaseController,ctor:function(){},initConfig:function(){var e=t("newfirstcharge_model");this.model=new e,this.model.initConfig()},getModel:function(){return this.model},registerEvents:function(){},registerProtocals:function(){this.RegisterProtocal(21012,this.handle21012),this.RegisterProtocal(21013,this.handle21013),this.RegisterProtocal(21014,this.handle21014),this.RegisterProtocal(21015,this.handle21015),this.RegisterProtocal(21e3,this.handle21000),this.RegisterProtocal(21001,this.handle21001)},openNewFirstChargeView:function(e){if(1==e){var i=t("mainui_controller"),s=t("mainui_const");if(i.getInstance().getFunctionIconById(s.icon.first_charge_new1)&&(this.new_first_charge_window||(this.new_first_charge_window=Utils.createClass("newfirstcharge1_window",this))),i.getInstance().getFunctionIconById(s.icon.first_charge_new)&&(this.new_first_charge_window||(this.new_first_charge_window=Utils.createClass("newfirstcharge_window",this))),!this.new_first_charge_window)return;var n=1;if(0!=t("role_controller").getInstance().getRoleVo().vip_exp&&(n=2),this.new_first_get_data){for(var a=!1,o=1;o<=3;o++)if(this.new_first_get_data[o-1]&&1==this.new_first_get_data[o-1].status){a=!0,n=1;break}var l=!1;for(o=4;o<=6;o++)if(this.new_first_get_data[o-1]&&1==this.new_first_get_data[o-1].status){l=!0,n=2;break}1==a&&1==l&&(n=1)}this.new_first_charge_window.open(n)}else this.new_first_charge_window&&(this.new_first_charge_window.close(),this.new_first_charge_window=null)},sender21012:function(){this.SendProtocal(21012,{})},handle21012:function(e){this.new_first_get_data=e.first_gift,this.model.setFirstBtnStatus(e.first_gift);var i=t("newfirstcharge_event");gcore.GlobalEvent.fire(i.New_First_Charge_Event,e)},sender21013:function(t){var e={};e.id=t,this.SendProtocal(21013,e)},handle21013:function(t){message(t.msg)},sender21014:function(t){var e={};e.id=t,this.SendProtocal(21014,e)},handle21014:function(t){message(t.msg)},handle21015:function(t){t.open_id&&Utils.next(t.open_id)},sender21000:function(){this.SendProtocal(21e3,{})},handle21000:function(e){this.new_first_get_data=e.first_gift,this.model.setFirstBtnNewStatus(e.first_gift);var i=t("newfirstcharge_event");gcore.GlobalEvent.fire(i.New_First_Charge_Event,e)},sender21001:function(t){var e={};e.id=t,this.SendProtocal(21001,e)},handle21001:function(t){message(t.msg)},getNewFirstChargeView:function(){return this.new_first_charge_window},__delete:function(){}});e.exports=s,cc._RF.pop()},{mainui_const:"mainui_const",mainui_controller:"mainui_controller",newfirstcharge_event:"newfirstcharge_event",newfirstcharge_model:"newfirstcharge_model",role_controller:"role_controller"}],newfirstcharge_event:[function(t,e,i){"use strict";cc._RF.push(e,"a1ec1rUUS5GDKr9banmE1oc","newfirstcharge_event"),e.exports={New_First_Charge_Event:"New_First_Charge"},cc._RF.pop()},{}],newfirstcharge_model:[function(t,e,i){"use strict";cc._RF.push(e,"1d33aGRz4pJsqhcOEoQMKJK","newfirstcharge_model");cc.Class({extends:BaseClass,ctor:function(){},properties:{},initConfig:function(){},setFirstBtnStatus:function(e){if(e&&Utils.next(e)){for(var i in this.newFirstBtnStatus=[],e)this.newFirstBtnStatus[e[i].id]=e[i].status;var s=!1;for(var i in e)if(1==e[i].status){s=!0;break}var n=t("mainui_controller"),a=t("mainui_const");n.getInstance().setFunctionTipsStatus(a.icon.first_charge_new,s)}},getFirstBtnStatus:function(t){return this.newFirstBtnStatus&&this.newFirstBtnStatus[t]||0},setFirstRechargeData:function(){var t=Config.charge_data.data_new_first_charge_data;for(var e in this.firstRewardData1=[],this.firstRewardData2=[],t)1==t[e].fid?this.firstRewardData1.push(t[e]):2==t[e].fid&&this.firstRewardData2.push(t[e]);this.firstRewardData1.sort(function(t,e){return t.id-e.id}),this.firstRewardData2.sort(function(t,e){return t.id-e.id})},getFirstRechargeData:function(t){return this.firstRewardData1&&this.firstRewardData2?1==t?this.firstRewardData1:2==t?this.firstRewardData2:void 0:[]},setFirstBtnNewStatus:function(e){if(e&&Utils.next(e)){this.newFirstBtnStatus={};for(var i=0;i<e.length;++i){var s=e[i];this.newFirstBtnStatus[s.id]=s.status}for(var n=!1,a=0;a<e.length;++a){if(1==e[a].status){n=!0;break}}var o=t("mainui_controller"),l=t("mainui_const");o.getInstance().setFunctionTipsStatus(l.icon.first_charge_new1,n)}},setFirstRechargeNewData:function(){var t=Config.charge_data.data_first_charge_data;for(var e in this.firstRewardData1=[],this.firstRewardData2=[],t){var i=t[e];1==i.fid?this.firstRewardData1.push(i):2==i.fid&&this.firstRewardData2.push(i)}this.firstRewardData1.sort(function(t,e){return t.id-e.id}),this.firstRewardData2.sort(function(t,e){return t.id-e.id})},__delete:function(){}});cc._RF.pop()},{mainui_const:"mainui_const",mainui_controller:"mainui_controller"}],newfirstcharge_window:[function(t,e,i){"use strict";cc._RF.push(e,"91cf6N/J3pL3o29EawKrEAC","newfirstcharge_window");var s=t("pathtool"),n=t("vip_controller"),a=t("newfirstcharge_event");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("newfirstcharge","newfirstcharge_window"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Big,this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){this.cur_index=null,this.item_list=[],this.item_reward_list=[];for(var t=1;t<=3;t++)this.item_reward_list[t]={}},openCallBack:function(){this.background=this.root_wnd.getChildByName("background"),this.background.scale=FIT_SCALE,this.main_container=this.root_wnd.getChildByName("main_container");var t=this.main_container.getChildByName("container"),e=t.getChildByName("bg").getComponent(cc.Sprite);this.loadRes(s.getBigBg("txt_cn_action_bigbg_3",null,"action"),function(t){e.spriteFrame=t}.bind(this)),this.close_btn=t.getChildByName("close_btn"),this.title_img=t.getChildByName("title_img"),this.remain_charge=t.getChildByName("remain_charge").getComponent(cc.Label),this.remain_charge.string=Utils.TI18N("\u5df2\u7d2f\u5145: "),this.btn_recharge=t.getChildByName("btn"),this.btn_label=this.btn_recharge.getChildByName("label").getComponent(cc.Label),this.btn_label.string=Utils.TI18N("\u524d\u5f80\u5145\u503c"),this.Sprite_2=t.getChildByName("Sprite_2").getComponent(cc.Sprite),this.Sprite_2_0=t.getChildByName("Sprite_2_0").getComponent(cc.Sprite),this.Sprite_2_1=t.getChildByName("Sprite_2_1").getComponent(cc.Sprite);var i=s.getItemRes(3);this.loadRes(i,function(t){this.Sprite_2.spriteFrame=t,this.Sprite_2_0.spriteFrame=t,this.Sprite_2_1.spriteFrame=t}.bind(this)),this.model.setFirstRechargeData();for(var n=1;n<=3;n++){var a=t.getChildByName("item_"+n);if(a){var o={};o.scroll=a.getChildByName("scroll").getChildByName("content"),o.finish_icon=a.getChildByName("finish_icon"),o.finish_icon.active=!1,o.title=a.getChildByName("title").getComponent(cc.Label),o.title.string=Utils.TI18N("\u7b2c")+n+Utils.TI18N("\u5929\u514d\u8d39\u9886"),o.list={},this.item_list[n]=o}}this.tab_view=[];for(n=1;n<=2;n++){(l={}).btn=t.getChildByName("btn_grade_"+n),l.normal=l.btn.getChildByName("normal"),l.select=l.btn.getChildByName("select"),l.select.active=!1,l.title=l.btn.getChildByName("title"),l.title.color=new cc.Color(255,255,255,255),l.titleOutLine=l.btn.getChildByName("title").getComponent(cc.LabelOutline),l.titleOutLine.color=new cc.Color(113,0,66,255),l.title_barner=t.getChildByName("title_img_"+n),l.title_barner.scale=2,l.title_barner.active=!1,this.loadRes(s.getUIIconPath("newfirstcharge","txt_cn_newfirstcharge_"+n),function(t,e){t.getComponent(cc.Sprite).spriteFrame=e}.bind(this,l.title_barner)),l.index=n,this.tab_view[n]=l}this.tab_get_hero={};for(n=1;n<=3;n++){var l;(l={}).btn=t.getChildByName("btn_"+n),l.title=l.btn.getChildByName("Text_1"),l.get=t.getChildByName("get_"+n),l.get.active=!1,l.index=n,this.tab_get_hero[n]=l}},registerEvent:function(){for(var e in Utils.onTouchEnd(this.close_btn,function(){this.ctrl.openNewFirstChargeView(!1)}.bind(this),2),Utils.onTouchEnd(this.btn_recharge,function(){var t=this.model.getFirstRechargeData(this.cur_index);0==this.get_gift_id?(this.ctrl.openNewFirstChargeView(!1),n.getInstance().openVipMainWindow(!0,VIPTABCONST.DAILY_GIFT)):1==this.get_gift_id?t[this.gift_index]&&this.ctrl.sender21013(t[this.gift_index].id):this.ctrl.openNewFirstChargeView(!1)}.bind(this),1),this.tab_view)Utils.onTouchEnd(this.tab_view[e].btn,function(t){this.changeTabView(t.index)}.bind(this,this.tab_view[e]),1);for(var i in this.tab_get_hero)Utils.onTouchEnd(this.tab_get_hero[i].btn,function(e){if(e.index&&this.updata_charge_data)if(1==this.updata_charge_data.choosen_status){var i=Config.partner_data.data_partner_base[[20501,30506,10505][e.index-1]];if(i){var s=cc.js.formatStr(Utils.TI18N("<color=#643223>\u662f\u5426\u786e\u5b9a\u9009\u62e9</color> <color=#bc3f0e fontsize=26>%s</color> <color=#643223>\u4f5c\u4e3a\u5956\u52b1\uff1f\n</color> <color=#643223>  \u786e\u5b9a\u540e\u5176\u5b83\u82f1\u96c4\u5c06\u4e0d\u53ef\u9886\u53d6</color>"),i.name);t("commonalert").show(s,Utils.TI18N("\u786e\u5b9a"),function(){this.ctrl.sender21014(e.index)}.bind(this),Utils.TI18N("\u53d6\u6d88"))}}else this.ctrl.sender21014(e.index)}.bind(this,this.tab_get_hero[i]),1);this.addGlobalEvent(a.New_First_Charge_Event,function(e){this.updata_charge_data=e,null!=e.choosen_status&&null!=e.has_choosen_id&&this.getChooseHeroStatus(e.choosen_status,e.has_choosen_id);var i=t("role_controller").getInstance().getRoleVo(),s=cc.js.formatStr(Utils.TI18N("\u5df2\u7d2f\u5145: %d"),Math.floor(.1*i.vip_exp));this.remain_charge.string=s,this.setRedPointTab(),this.updateData(e)}.bind(this))},setRedPointTab:function(){for(var t=!1,e=1;e<=3;e++){if((s=this.model.getFirstBtnStatus(e))&&1==s){t=!0;break}}Utils.addRedPointToNodeByStatus(this.tab_view[1].btn,t);var i=!1;for(e=4;e<=6;e++){var s;if((s=this.model.getFirstBtnStatus(e))&&1==s){i=!0;break}}Utils.addRedPointToNodeByStatus(this.tab_view[2].btn,i)},changeTabView:function(t){if(t=t||0,this.cur_index!=t){null!=this.tab_index&&(this.tab_index.normal.active=!0,this.tab_index.select.active=!1,this.tab_index.titleOutLine.color=new cc.Color(113,0,66,255),this.tab_index.title_barner.active=!1),this.tab_index=this.tab_view[t],null!=this.tab_index&&(this.tab_index.normal.active=!1,this.tab_index.select.active=!0,this.tab_index.titleOutLine.color=new cc.Color(196,90,20,255),this.tab_index.title_barner.active=!0),this.cur_index=t;var e=this.model.getFirstRechargeData(t);this.fillItemList(e),this.updata_charge_data&&this.updateData(this.updata_charge_data)}},fillItemList:function(t){for(var e=0;e<t.length;e++){var i=this.item_list[e+1],s=t[e].item_list.length;i.scroll.setContentSize(cc.size(95.2*s,i.scroll.getContentSize().height));for(var n=0;n<s;n++){var a=95.2*(n+1)-47.6;this.item_reward_list[e+1][n]||(this.item_reward_list[e+1][n]=ItemsPool.getInstance().getItem("backpack_item"),this.item_reward_list[e+1][n].setParent(i.scroll),this.item_reward_list[e+1][n].setExtendData({scale:.8,is_show_tips:!0}),this.item_reward_list[e+1][n].show()),this.item_reward_list[e+1][n]&&(this.item_reward_list[e+1][n].setPosition(a,47.6),this.item_reward_list[e+1][n].setData({bid:t[e].item_list[n][0],num:t[e].item_list[n][1]}),cc.log(t[e],"list[i]")),1}}},getChooseHeroStatus:function(t,e){for(var i=1;i<=3;i++)0==t?(this.tab_get_hero[i].get.active=!1,this.tab_get_hero[i].btn.active=!0,this.tab_get_hero[i].btn.getComponent(cc.Button).interactable=!1,this.tab_get_hero[i].btn.getComponent(cc.Button).enableAutoGrayEffect=!0,this.tab_get_hero[i].title.color=new cc.Color(255,255,255,255)):1==t?(this.tab_get_hero[i].get.active=!1,this.tab_get_hero[i].btn.active=!0,this.tab_get_hero[i].btn.getComponent(cc.Button).interactable=!0,this.tab_get_hero[i].btn.getComponent(cc.Button).enableAutoGrayEffect=!1,this.tab_get_hero[i].title.color=new cc.Color(37,85,5,255)):2==t&&(this.tab_get_hero[i].btn.active=!1,i==e&&(this.tab_get_hero[i].get.active=!0))},updateData:function(t){if(null!=t){var e=[[1,2,3],[4,5,6]],i=[];for(var s in e[this.cur_index-1]){var n=this.model.getFirstBtnStatus(e[this.cur_index-1][s]);i[s]=n,this.item_list[parseInt(s)+1].finish_icon.active=2==n}this.gift_index=0;var a=0;for(var s in this.get_gift_id=10,i)a+=i[s],1==i[s]&&(this.get_gift_id=1,this.gift_index=s);0==a?(this.get_gift_id=0,this.btn_label.string=Utils.TI18N("\u524d\u5f80\u5145\u503c")):1==a||3==a||5==a?this.btn_label.string=Utils.TI18N("\u9886\u53d6\u5956\u52b1"):2==a||4==a?this.btn_label.string=Utils.TI18N("\u660e\u65e5\u518d\u6765"):6==a&&(this.btn_label.string=Utils.TI18N("\u9886\u53d6\u5b8c\u6bd5"))}},openRootWnd:function(t){t=t||1,this.changeTabView(t),this.ctrl.sender21012()},closeCallBack:function(){for(var t=1;t<=3;t++){for(var e in this.item_reward_list[t])this.item_reward_list[t][e].deleteMe();this.item_reward_list[t]=null}this.item_reward_list=[],this.ctrl.openNewFirstChargeView(!1)}});cc._RF.pop()},{commonalert:"commonalert",newfirstcharge_event:"newfirstcharge_event",pathtool:"pathtool",role_controller:"role_controller",vip_controller:"vip_controller"}],notice_controller:[function(t,e,i){"use strict";cc._RF.push(e,"cdcc9c2Y+ZPJ7InR6fVqYIY","notice_controller");var s=cc.Class({extends:BaseController,ctor:function(){},initConfig:function(){var e=t("notice_model");this.model=new e,this.model.initConfig()},getModel:function(){return this.model},registerEvents:function(){},registerProtocals:function(){this.RegisterProtocal(10810,this.on10810)},sender10810:function(t,e,i){var s={};s.issue_type=t,s.title=e,s.content=i,this.SendProtocal(10810,s)},on10810:function(t){message(t.msg)},openBugPanel:function(e){if(e){if(Log.info("=====aaaaaaa"),!this.bug_panel){var i=t("bug_panel");this.bug_panel=new i}this.bug_panel.open()}else this.bug_panel&&(this.bug_panel.close(),this.bug_panel=null)},openNocticeWindow:function(e,i){if(e){if(!this.notice_view){var s=t("notice_window");this.notice_view=new s}this.notice_view.open(i)}else this.notice_view&&(this.notice_view.close(),this.notice_view=null)},get_notice_url:function(e,i){var s=t("login_controller").getInstance().getModel().getLoginInfo(),n=s&&s.host||i.host,a=window.CHANNEL,o=Math.ceil(Date.now()/1e3);return cc.js.formatStr("https://%s/api.php/local/local/notice/?channel=%s&time=%s",n,a,o)},setNoticeContent:function(t){this.notice_content=t},getNoticeContent:function(){return this.notice_content}});e.exports=s,cc._RF.pop()},{bug_panel:"bug_panel",login_controller:"login_controller",notice_model:"notice_model",notice_window:"notice_window"}],notice_model:[function(t,e,i){"use strict";cc._RF.push(e,"b6d82QkmbhCjbsaS3A2XRPn","notice_model");cc.Class({extends:BaseClass,ctor:function(){},properties:{},initConfig:function(){}});cc._RF.pop()},{}],notice_panel:[function(t,e,i){"use strict";cc._RF.push(e,"5c685tZb5BISb0muzSIY7g8","notice_panel");var s=t("pathtool");t("welfare_const"),cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("welfare","notice_panel")},initConfig:function(){this.ctrl=t("notice_controller").getInstance(),this.dengluMgr=t("login_controller").getInstance().getModel(),this.node_list=[],this.color=new cc.Color(100,50,35,255)},initPanel:function(){this.main_container=this.seekChild("main_container"),this.title_lab=this.seekChild("title_lab",cc.Label),this.qq_lab=this.seekChild("qq_lab",cc.Label),this.qq_lab.string="",this.notice_scroll=this.seekChild("notice_scroll"),this.notice_scroll_sv=this.seekChild("notice_scroll",cc.ScrollView),this.scroll_content=this.seekChild(this.notice_scroll,"content"),this.container_size=this.notice_scroll.getContentSize()},registerEvent:function(){},setMessage:function(){if(this.notice_content=this.ctrl.getNoticeContent(),null==this.notice_content){var t=this.dengluMgr.getLoginInfo(),e=(this.dengluMgr.getSvrName(t.srv_id),t.open_time,this.ctrl.get_notice_url(0,t));e&&DownloadManager.getInstance().downloadText(e,function(t,e){StringUtil.parseStr(e);if(null==t&&null!=e){var i=e;i=(i=i.replace(/\r\n/g,"\\r\\n")).replace(/\t/g,"");var s=JSON.parse(i);if(s.data&&s.data[0]){this.notice_content=StringUtil.parseStr(s.data[0].content).string;var n=this.notice_content.split("|");this.addNoticeContent(n),this.ctrl.setNoticeContent(this.notice_content)}}else cc.log("status==>",t,"responseText==>",e)}.bind(this))}else{var i=this.notice_content.split("|");this.addNoticeContent(i)}},addNoticeContent:function(t){if(null!=t&&0!=t.length){this.main_container.stopAllActions();var e=-80;this.title_lab.string=t.shift()||"",this.list_index=0;var i=0;this.startUpdate(t.length,function(){var s=this.list_index,n=t[s],a=this.createSubContent(2,20,n,this.container_size.width-4,0);this.node_list.push(a),e=e+a.node.getContentSize().height+3,cc.log(e);var o=Math.max(e,this.container_size.height);this.scroll_content.setContentSize(this.container_size.width,o+80),a.node.y=i-a.node.getContentSize().height+5,i=a.node.y,this.list_index+=1}.bind(this),100),this.notice_scroll_sv.scrollToTop(.5)}},createSubContent:function(t,e,i,s,n){var a=Utils.createRichLabel(24,this.color,cc.v2(0,0),cc.v2(0,0),30,s,this.scroll_content);return a.string=i,a.horizontalAlign=cc.macro.TextAlignment.LEFT,a.node.setPosition(t,e),a},onShow:function(t){this.setMessage()},setVisibleStatus:function(t){this.setVisible(t)},onHide:function(){},onDelete:function(){if(this.node_list){for(var t in this.node_list){var e=this.node_list[t];e instanceof cc.Node?(e.destroy(),e=null):(e.node.destroy(),e=null)}this.node_list=null}this.main_container&&this.main_container.stopAllActions()}});cc._RF.pop()},{login_controller:"login_controller",notice_controller:"notice_controller",pathtool:"pathtool",welfare_const:"welfare_const"}],notice_vo:[function(t,e,i){"use strict";cc._RF.push(e,"639a9n6/iVBuJozqb5YM7Ai","notice_vo");cc.Class({extends:gcore.BaseEvent,ctor:function(){this.id=0,this.type=1,this.title="",this.summary="",this.content="",this.start_time=0,this.end_time=0,this.flag=0},initAttrData:function(t){if(t)for(var e in t){var i=t[e];this.update(e,i)}},update:function(t,e){null!=this[t]&&(this[t]=e)},setReaded:function(){this.flag=1}});cc._RF.pop()},{}],notice_window:[function(t,e,i){"use strict";cc._RF.push(e,"9bda9GV+WtBX5XNrhN0Uvfl","notice_window");var s=t("pathtool");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("notice","notice_window"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Mini},initConfig:function(){this.ctrl=t("notice_controller").getInstance(),this.dengluMgr=t("login_controller").getInstance().getModel(),this.node_list=[],this.color=new cc.Color(100,50,35,255)},openCallBack:function(){this.seekChild("background").scale=FIT_SCALE,this.main_panel=this.seekChild("main_panel"),this.close_btn=this.seekChild("close_btn"),this.ok_btn=this.seekChild("ok_btn"),this.container=this.seekChild("container"),this.txt_container=this.seekChild("txt_container"),this.txt_title_lb=this.seekChild(this.txt_container,"txt_title",cc.Label),this.notice_scroll=this.seekChild("notice_scroll"),this.notice_scroll_sv=this.seekChild("notice_scroll",cc.ScrollView),this.scroll_content=this.seekChild(this.notice_scroll,"content"),this.container_size=this.notice_scroll.getContentSize(),this.web_view=this.seekChild(this.container,"web_view",cc.WebView)},registerEvent:function(){Utils.onTouchEnd(this.close_btn,function(){this.ctrl.openNocticeWindow(!1)}.bind(this),2),Utils.onTouchEnd(this.ok_btn,function(){this.ctrl.openNocticeWindow(!1)}.bind(this),2)},layoutWebView:function(){if(cc.WebView&&this.url&&""!=this.url){var t=new cc.Node;this.web_view=t.addComponent(cc.WebView),t.setAnchorPoint(.5,.5),t.setPosition(this.container_size.width/2,this.container_size.height/2),t.setContentSize(this.container_size.width,this.container_size.height),t.active=!1,this.txt_container.addChild(t,99)}},openRootWnd:function(t){this.url=t,this.setMessage(t)},setMessage:function(t){if(null!=this.web_view&&(this.web_view.node.active=!1),null!=t)this.setWebViewUrl(t);else if(this.ok_btn.active=!0,this.notice_content=this.ctrl.getNoticeContent(),null==this.notice_content){var e=this.dengluMgr.getLoginInfo(),i=(this.dengluMgr.getSvrName(e.srv_id),e.open_time,this.ctrl.get_notice_url(0,e));i&&DownloadManager.getInstance().downloadText(i,function(t,e){StringUtil.parseStr(e);if(null==t&&null!=e){var i=e;i=(i=i.replace(/\r\n/g,"\\r\\n")).replace(/\t/g,"");var s=JSON.parse(i);if(s.data&&s.data[0]){this.notice_content=StringUtil.parseStr(s.data[0].content).string;var n=this.notice_content.split("|");this.addNoticeContent(n),this.ctrl.setNoticeContent(this.notice_content)}}else cc.log("status==>",t,"responseText==>",e)}.bind(this))}else{var s=this.notice_content.split("|");this.addNoticeContent(s)}},setWebViewUrl:function(t){this.web_view&&(this.web_view&&(this.web_view.node.active=!0),this.web_view.url=t,this.ok_btn.active=!1)},addNoticeContent:function(t){if(null!=t&&0!=t.length){this.main_panel.stopAllActions();var e=-80;this.txt_title_lb.string=t.shift()||"",this.list_index=0;var i=0;this.startUpdate(t.length,function(){var s=this.list_index,n=t[s],a=this.createSubContent(2,20,n,this.container_size.width-4,0);this.node_list.push(a),e=e+a.node.getContentSize().height+3;var o=Math.max(e,this.container_size.height);this.scroll_content.setContentSize(this.container_size.width,o+80),a.node.y=i-a.node.getContentSize().height+5,i=a.node.y,this.list_index+=1}.bind(this),100),this.notice_scroll_sv.scrollToTop(1)}},createSubContent:function(t,e,i,s,n){var a=Utils.createRichLabel(22,this.color,cc.v2(0,0),cc.v2(0,0),30,s,this.scroll_content);return a.string=i,a.horizontalAlign=cc.macro.TextAlignment.LEFT,a.node.setPosition(t,e),a},closeCallBack:function(){if(this.url=null,this.node_list){for(var t in this.node_list){var e=this.node_list[t];e instanceof cc.Node?(e.destroy(),e=null):(e.node.destroy(),e=null)}this.node_list=null}this.main_panel.stopAllActions(),this.ctrl.openNocticeWindow(!1)}});cc._RF.pop()},{login_controller:"login_controller",notice_controller:"notice_controller",pathtool:"pathtool"}],onlinegift_controller:[function(t,e,i){"use strict";cc._RF.push(e,"9e7dbz2w61LkJmixigusZkE","onlinegift_controller");var s=t("onlinegift_event"),n=cc.Class({extends:BaseController,ctor:function(){},initConfig:function(){var e=t("onlinegift_model");this.model=new e,this.model.initConfig()},getModel:function(){return this.model},registerEvents:function(){this.init_role_event||(this.init_role_event=gcore.GlobalEvent.bind(EventId.EVT_ROLE_CREATE_SUCCESS,function(){gcore.GlobalEvent.unbind(this.init_role_event),this.init_role_event=null}.bind(this)))},registerProtocals:function(){this.RegisterProtocal(10926,this.on10926),this.RegisterProtocal(10927,this.on10927)},send10926:function(){this.SendProtocal(10926,{})},on10926:function(t){this.model.updateData(t),gcore.GlobalEvent.fire(s.Get_Data,t)},send10927:function(t){this.SendProtocal(10927,{time:t})},on10927:function(t){message(t.msg),1==t.code&&gcore.GlobalEvent.fire(s.Update_Data,t.time)},openOnlineGiftView:function(e){if(e){if(!this.onlinegiftView){var i=t("onlinegift_window");this.onlinegiftView=new i}this.onlinegiftView.open()}else this.onlinegiftView&&(this.onlinegiftView.close(),this.onlinegiftView=null)}});e.exports=n,cc._RF.pop()},{onlinegift_event:"onlinegift_event",onlinegift_model:"onlinegift_model",onlinegift_window:"onlinegift_window"}],onlinegift_event:[function(t,e,i){"use strict";cc._RF.push(e,"0c491VF35NMpZO/Tod+GEO7","onlinegift_event"),e.exports={Get_Data:"OnlineGiftEvent.Get_Data",Update_Data:"OnlineGiftEvent.Updata_Data"},cc._RF.pop()},{}],onlinegift_model:[function(t,e,i){"use strict";cc._RF.push(e,"b2864ANkINGppMlczILWQs5","onlinegift_model");cc.Class({extends:BaseClass,ctor:function(){this.onlinegift_data=[],this.online_time=0},properties:{},initConfig:function(){},updateData:function(t){this.online_time=t.time,this.onlinegift_data=t.list},getOnlineGiftData:function(){return this.onlinegift_data},getOnlineTime:function(){return this.online_time}});cc._RF.pop()},{}],onlinegift_window:[function(t,e,i){"use strict";cc._RF.push(e,"985de82FfdLXKVGAcr8CD9R","onlinegift_window");var s=t("pathtool"),n=t("onlinegift_controller"),a=t("timetool");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("onlinegift","onlinegift_windows"),this.viewTag=SCENE_TAG.dialogue},initConfig:function(){this.item_list={}},openCallBack:function(){this.background=this.seekChild(this.root_wnd,"background"),this.bg=this.seekChild(this.root_wnd,"bg",cc.Sprite),this.textTime=this.seekChild(this.bg.node,"textTime",cc.Label),this.content=this.seekChild(this.bg.node,"content"),this.loadRes(s.getBigBg("action/txt_cn_online_gift"),function(t){this.bg.spriteFrame=t}.bind(this));var t=0;for(var e in Config.misc_data.data_get_time_items){var i=Config.misc_data.data_get_time_items[e],n=ItemsPool.getInstance().getItem("backpack_item");n.setParent(this.content),n.initConfig(null,.9,!1,!1),n.setData({bid:i.items[0][0],num:i.items[0][1]}),n.show(),n.config=i;var a=i.index-1;t=-(125*parseInt(a/4)+55),n.setPosition(a%4*124+62,t),this.item_list[i.index]=n}this.content.height=55-t},registerEvent:function(){this.background.on(cc.Node.EventType.TOUCH_END,function(t){n.getInstance().openOnlineGiftView(!1)},this);var e=t("onlinegift_event");this.addGlobalEvent(e.Get_Data,function(t){this.updateData(t)}.bind(this)),this.addGlobalEvent(e.Update_Data,function(t){for(var e in this.item_list){var i=this.item_list[e];if(i&&i.config.time==t){i.setExtendTag(!0,Utils.TI18N("\u5df2\u9886\u53d6")),i.showItemEffect(!1);break}}}.bind(this))},openRootWnd:function(t){n.getInstance().send10926()},updateData:function(t){var e=this,i=n.getInstance().getModel().getOnlineGiftData(),s=n.getInstance().getModel().getOnlineTime(),o={};for(var l in i)o[i[l].time]=i[l];Log.info(i,o);var r=0,c=function(t){h=e.item_list[t],d=h.config.time;var i=h.config.index;o[d]?(h.setExtendTag(!0,Utils.TI18N("\u5df2\u9886\u53d6")),h.setItemIconUnEnabled(!0),h.showItemEffect(!1),h.addCallBack(function(t){n.getInstance().send10927(i)}.bind(e)),h.is_show_tips=!1):s>=d?(h.showItemEffect(!0,263,PlayerAction.action_1,!0,1.1),h.addCallBack(function(t){n.getInstance().send10927(i)}.bind(e)),h.is_show_tips=!1):(r=r||h.config.time-s,h.showItemEffect(!1),h.is_show_tips=!0)};for(var _ in this.item_list){var h,d;c(_)}this.textTime.string="",r>0?(this.ref_time=r,this.timer&&(gcore.Timer.del(this.timer),this.timer=null),this.setLessTime()):this.textTime.string=a.getTimeFormat(0)},setLessTime:function(){if(cc.isValid(this.textTime)&&this.ref_time){this.ref_time-=1;var t=this.ref_time;t>0?(this.textTime.string=a.getTimeFormat(t),this.timer=gcore.Timer.set(function(){this.timer&&(gcore.Timer.del(this.timer),this.timer=null),this.setLessTime()}.bind(this),1e3,1)):this.textTime.string=""}},closeCallBack:function(){for(var t in this.item_list)this.item_list[t].deleteMe();this.item_list=null,this.timer&&(gcore.Timer.del(this.timer),this.timer=null),n.getInstance().openOnlineGiftView(!1)}});cc._RF.pop()},{onlinegift_controller:"onlinegift_controller",onlinegift_event:"onlinegift_event",pathtool:"pathtool",timetool:"timetool"}],orderaction_const:[function(t,e,i){"use strict";var s;function n(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}cc._RF.push(e,"f033axbyJpHBpAi/Tx0XYkI","orderaction_const");var a={OrderActionEntranceID:{entrance_id:609},OrderActionView:{reward_panel:1,tesk_panel:2,advance_card:3},ColorConst:(s={},n(s,1,new cc.Color(113,40,4,255)),n(s,2,new cc.Color(255,244,215,255)),n(s,3,new cc.Color(0,0,0,255)),n(s,4,new cc.Color(255,243,210,255)),n(s,5,new cc.Color(92,23,16,255)),n(s,6,new cc.Color(51,29,0,255)),n(s,7,new cc.Color(207,181,147,255)),n(s,8,new cc.Color(255,237,214,255)),n(s,9,new cc.Color(100,50,35,255)),n(s,10,new cc.Color(255,224,185,255)),n(s,11,new cc.Color(245,226,202,255)),s)};e.exports=a,cc._RF.pop()},{}],orderaction_controller:[function(t,e,i){"use strict";cc._RF.push(e,"6541bIuL31FMKqBIio91fSt","orderaction_controller");var s=t("orderaction_event"),n=cc.Class({extends:BaseController,ctor:function(){},initConfig:function(){var e=t("orderaction_model");this.model=new e,this.model.initConfig()},getModel:function(){return this.model},registerEvents:function(){},registerProtocals:function(){this.RegisterProtocal(25300,this.handle25300),this.RegisterProtocal(25301,this.handle25301),this.RegisterProtocal(25303,this.handle25303),this.RegisterProtocal(25304,this.handle25304),this.RegisterProtocal(25305,this.handle25305),this.RegisterProtocal(25306,this.handle25306),this.RegisterProtocal(25307,this.handle25307),this.RegisterProtocal(25308,this.handle25308),this.RegisterProtocal(25309,this.handle25309)},send25300:function(){this.SendProtocal(25300,{})},handle25300:function(t){this.model.setCurPeriod(t.period),this.model.setCurDay(t.cur_day),this.model.setRMBStatus(t.rmb_status),this.model.setExtraStatus(t.exp_status),this.model.setCurLev(t.lev),this.model.setCurExp(t.exp),this.model.setInitTaskData(t.list),gcore.GlobalEvent.fire(s.OrderAction_Init_Event,t)},handle25301:function(t){this.model.updataTeskData(t),gcore.GlobalEvent.fire(s.OrderAction_TaskGet_Event)},send25302:function(t){var e={};e.id=t,this.SendProtocal(25302,e)},send25303:function(){this.SendProtocal(25303,{})},handle25303:function(t){this.model.setLevShowData(t.reward_list),gcore.GlobalEvent.fire(s.OrderAction_LevReward_Event,t.lev)},send25304:function(t){var e={};e.id=t,this.SendProtocal(25304,e)},handle25304:function(t){message(t.msg)},handle25305:function(t){this.model.setCurExp(t.exp),this.model.setCurLev(t.lev),gcore.GlobalEvent.fire(s.OrderAction_Updata_LevExp_Event,t)},send25306:function(){this.SendProtocal(25306,{})},handle25306:function(t){this.model.setRMBStatus(t.rmb_status),this.model.setExtraStatus(t.exp_status),this.model.setGiftStatus(t.list),gcore.GlobalEvent.fire(s.OrderAction_BuyGiftCard_Event)},send25307:function(t){var e={};e.id=t,this.SendProtocal(25307,e)},handle25307:function(t){message(t.msg),1==t.flag&&this.openBuyLevView(!1)},send25308:function(){this.SendProtocal(25308,{})},handle25308:function(t){message(t.msg)},send25309:function(){this.SendProtocal(25309,{})},handle25309:function(t){gcore.GlobalEvent.fire(s.OrderAction_IsPopWarn_Event,t)},openOrderActionMainView:function(t){1==t?(this.order_action_view||(this.order_action_view=Utils.createClass("orderaction_main_window",this)),this.order_action_view&&0==this.order_action_view.isOpen()&&this.order_action_view.open()):this.order_action_view&&(this.order_action_view.close(),this.order_action_view=null)},getOrderActionMainRoot:function(){return this.order_action_view?this.order_action_view:null},openBuyLevView:function(t){1==t?(this.buy_lev_view||(this.buy_lev_view=Utils.createClass("buy_lev_window",this)),this.buy_lev_view&&0==this.buy_lev_view.isOpen()&&this.buy_lev_view.open()):this.buy_lev_view&&(this.buy_lev_view.close(),this.buy_lev_view=null)},openUntieRewardView:function(t){1==t?(this.untie_reward_view||(this.untie_reward_view=Utils.createClass("untie_reward_1_window",this)),this.untie_reward_view&&0==this.untie_reward_view.isOpen()&&this.untie_reward_view.open()):this.untie_reward_view&&(this.untie_reward_view.close(),this.untie_reward_view=null)},openEndWarnView:function(t,e){1==t?(this.end_warn_view||(this.end_warn_view=Utils.createClass("orderaction_end_warn_window",this)),this.end_warn_view&&0==this.end_warn_view.isOpen()&&this.end_warn_view.open(e)):this.end_warn_view&&(this.end_warn_view.close(),this.end_warn_view=null)},openBuyCardView:function(t){1==t?(this.buy_card_view||(this.buy_card_view=Utils.createClass("untie_reward_window",this)),this.buy_card_view&&0==this.buy_card_view.isOpen()&&this.buy_card_view.open()):this.buy_card_view&&(this.buy_card_view.close(),this.buy_card_view=null)}});e.exports=n,cc._RF.pop()},{orderaction_event:"orderaction_event",orderaction_model:"orderaction_model"}],orderaction_end_warn_window:[function(t,e,i){"use strict";cc._RF.push(e,"5811eBvZb5M6ouY2b/2devZ","orderaction_end_warn_window");var s=t("pathtool");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("orderaction","orderaction_end_warn_window"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Mini,this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){},openCallBack:function(){this.background=this.root_wnd.getChildByName("background"),this.background.scale=FIT_SCALE;var t=this.root_wnd.getChildByName("main_container");t.getChildByName("Image_16").getChildByName("Text_15").getComponent(cc.Label).string=Utils.TI18N("\u6d3b\u52a8\u63d0\u9192"),this.btn_close=t.getChildByName("btn_close"),this.btn_ok=t.getChildByName("btn_ok"),this.btn_ok.getChildByName("Text_14").getComponent(cc.Label).string=Utils.TI18N("\u6211\u77e5\u9053\u4e86"),t.getChildByName("desc_text").getComponent(cc.Label).string=Utils.TI18N("              \u7f24\u7eb7\u76db\u590f\u6d3b\u52a8\u5c06\u4e8e          \u540e\u7ed3\u675f\n\u6d3b\u52a8\u7ed3\u675f\u540e\uff0c\u7d2f\u79ef\u7b49\u7ea7\u3001\u4efb\u52a1\u8fdb\u5ea6\u53ca\u7ecf\u9a8c\u5c06\u4f1a\u6e05\n\u9664\uff0c\u8bf7\u53ca\u65f6\u5b8c\u6210\u8bd5\u70bc\u4efb\u52a1\uff0c\u9886\u53d6\u76f8\u5e94\u5956\u52b1\uff0c\u4ee5\u514d\n\u9519\u8fc7\u5956\u52b1\u54e6\uff01"),this.reamin_day=t.getChildByName("reamin_day").getComponent(cc.Label)},registerEvent:function(){Utils.onTouchEnd(this.background,function(){this.ctrl.openEndWarnView(!1)}.bind(this),2),Utils.onTouchEnd(this.btn_close,function(){this.ctrl.openEndWarnView(!1)}.bind(this),2),Utils.onTouchEnd(this.btn_ok,function(){this.ctrl.openEndWarnView(!1)}.bind(this),1)},openRootWnd:function(t){var e="",i=30-(t=t||0);i<=0?(i=0,e=Utils.TI18N("\u4eca\u5929")):e=i+Utils.TI18N("\u5929"),this.reamin_day.string=e},closeCallBack:function(){this.ctrl.openEndWarnView(!1)}});cc._RF.pop()},{pathtool:"pathtool"}],orderaction_event:[function(t,e,i){"use strict";cc._RF.push(e,"9fef7eJv0VJ2aE5UGQabf22","orderaction_event"),e.exports={OrderAction_Init_Event:"OrderAction_Init_Event",OrderAction_TaskGet_Event:"OrderAction_TaskGet_Event",OrderAction_LevReward_Event:"OrderAction_LevReward_Event",OrderAction_Updata_LevExp_Event:"OrderAction_Updata_LevExp_Event",OrderAction_BuyGiftCard_Event:"OrderAction_BuyGiftCard_Event",OrderAction_IsPopWarn_Event:"OrderAction_IsPopWarn_Event"},cc._RF.pop()},{}],orderaction_main_window:[function(t,e,i){"use strict";cc._RF.push(e,"0604eN4gjNJHZSzKSX9PRpD","orderaction_main_window");var s=t("pathtool"),n=t("orderaction_const"),a=t("orderaction_event"),o=t("action_controller"),l=t("commonalert");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("orderaction","orderaction_main_window1"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Big,this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){this.tab_view={},this.tab_panel_list={},this.cur_index=null,this.cur_box_status=null},openCallBack:function(){this.background=this.root_wnd.getChildByName("background"),this.background.scale=FIT_SCALE,this.main_container=this.root_wnd.getChildByName("main_container"),this.btn_untie_reward=this.main_container.getChildByName("btn_untie_reward"),this.btn_open_lock=this.main_container.getChildByName("btn_open_lock"),this.btn_open_lock_label=this.btn_open_lock.getChildByName("name").getComponent(cc.Label),this.btn_open_lock_bg=this.btn_open_lock.getComponent(cc.Sprite),this.btn_open_lock_label.string="",this.btn_buy_lev=this.main_container.getChildByName("btn_buy_lev"),this.btn_buy_lev.getChildByName("Text_2").getComponent(cc.Label).string=Utils.TI18N("\u8d2d\u4e70\u7b49\u7ea7");for(var t=this.main_container.getChildByName("tab_view"),e=[Utils.TI18N("\u5956\u52b1"),Utils.TI18N("\u4efb\u52a1")],i=1;i<=2;i++){var s={};s.btn_tab_view=t.getChildByName("tab_"+i),s.normal=s.btn_tab_view.getChildByName("normal"),s.select=s.btn_tab_view.getChildByName("select"),s.select.active=!1,s.name=s.btn_tab_view.getChildByName("name").getComponent(cc.Label),s.name.string=e[i-1],s.icon=s.btn_tab_view.getChildByName("icon"),s.icon.opacity=178,s.index=i,this.tab_view[i]=s}this.bar_bg=this.main_container.getChildByName("bar_bg"),this.bar=this.bar_bg.getChildByName("bar").getComponent(cc.ProgressBar),this.bar.progress=0,this.bar_num=this.bar_bg.getChildByName("bar_num").getComponent(cc.Label),this.bar_num.string="",this.bar_num_line=this.bar_bg.getChildByName("bar_num").getComponent(cc.LabelOutline),this.banner_botton=this.main_container.getChildByName("banner_botton").getComponent(cc.Sprite),this.time_text_bg=this.main_container.getChildByName("Text_4").getComponent(cc.Label),this.time_text_bg.string=Utils.TI18N("\u6d3b\u52a8\u5269\u4f59\u65f6\u95f4:"),this.time_text=this.main_container.getChildByName("time_text").getComponent(cc.Label),this.time_text.string="",this.all_get=this.main_container.getChildByName("all_get"),this.all_get.getChildByName("Text_6").getComponent(cc.Label).string=Utils.TI18N("\u4e00\u952e\u9886\u53d6"),this.advance_card_buy=this.main_container.getChildByName("advance_card_buy"),this.advance_card_buy_btn=this.main_container.getChildByName("advance_card_buy").getComponent(cc.Button),this.advance_card_buy_label=this.advance_card_buy.getChildByName("Text").getComponent(cc.Label),this.advance_card_buy_label.string="",this.advance_card_buy.active=!1,this.tabMainPeriodView_3(),this.btn_rule=this.main_container.getChildByName("btn_rule"),this.btn_close=this.main_container.getChildByName("btn_close")},tabMainPeriodView_3:function(){this.level_num=this.main_container.getChildByName("level_num").getComponent(cc.Label),this.level_num_line=this.main_container.getChildByName("level_num").getComponent(cc.LabelOutline),this.level_num.string="",this.main_container.getChildByName("Text_21").getComponent(cc.Label).string=Utils.TI18N("\u6218\u4ee4\u7b49\u7ea7");var t=this.main_container.getChildByName("Text_21").getComponent(cc.LabelOutline),e=Utils.createRichLabel(20,new cc.Color(255,255,255,255),cc.v2(0,.5),cc.v2(-110,316),30,400);e.horizontalAlign=cc.macro.TextAlignment.LEFT,this.main_container.addChild(e.node);var i=this.main_container.getChildByName("Image_1").getChildByName("Text_1").getComponent(cc.Label);this.activity_time=this.main_container.getChildByName("activity_time").getComponent(cc.Label),this.activity_time.string="",this.activity_time_line=this.main_container.getChildByName("activity_time").getComponent(cc.LabelOutline),this.activity_time_line.enabled=!1,this.title_barner=this.main_container.getChildByName("title_barner").getComponent(cc.Sprite);var n=s.getBigBg("orderaction/orderaction_banner3"),a=s.getBigBg("orderaction/orderaction_banner1"),o=cc.js.formatStr(Utils.TI18N("\u901a\u8fc7<color=#ffd200>\u5b8c\u6210\u4efb\u52a1</color>\u63d0\u5347\u7b49\u7ea7\uff0c\u9886\u53d6\u5956\u52b1")),l=this.model.getCurPeriod(),r=new cc.Color(8,47,96,255),c=Utils.TI18N("\u7f24\u7eb7\u76db\u590f");2==l&&(n=s.getBigBg("orderaction/orderaction_top6"),a=s.getBigBg("orderaction/orderaction_buttom6"),this.title_barner.node.setPosition(cc.v2(8,195)),this.title_barner.node.setContentSize(cc.size(671,303)),this.banner_botton.node.setContentSize(cc.size(720,94)),o=cc.js.formatStr(Utils.TI18N(" <outline=2,color=#7f3a18>\u901a\u8fc7<color=#ffd200>\u5b8c\u6210\u4efb\u52a1</color>\u63d0\u5347\u7b49\u7ea7\uff0c\u9886\u53d6\u5956\u52b1</outline>")),r=new cc.Color(127,58,24,255),c=Utils.TI18N("\u82b1\u706b\u6620\u79cb"),this.activity_time_line.enabled=!0,this.activity_time.node.color=new cc.Color(255,255,255,255)),e.string=o,this.bar_num_line.color=r,t.color=r,this.level_num_line.color=r,this.activity_time_line.color=r,i.string=c,this.loadRes(n,function(t){this.title_barner.spriteFrame=t}.bind(this)),this.loadRes(a,function(t){this.banner_botton.spriteFrame=t}.bind(this)),this.btn_untie_reward.getChildByName("Text_3").getComponent(cc.Label).string=Utils.TI18N("\u989d\u5916\u7ecf\u9a8c\u5305")},registerEvent:function(){for(var e in this.addGlobalEvent(a.OrderAction_Init_Event,function(t){this.tabChargeView(1,t.period),this.setBasicInitData(t),this.updateBoxStatus(),this.getTaskRedPoint();var e=t.end_time-gcore.SmartSocket.getTime();if(o.getInstance().getModel().setCountDownTime(this.time_text,e),this.activity_time){var i=Config.holiday_war_order_data.data_constant;i&&i.action_time&&(this.activity_time.string=Utils.TI18N("\u6d3b\u52a8\u65f6\u95f4\uff1a")+i.action_time.desc)}}.bind(this)),this.addGlobalEvent(a.OrderAction_TaskGet_Event,function(){this.getTaskRedPoint()}.bind(this)),this.addGlobalEvent(a.OrderAction_LevReward_Event,function(){this.statusTabRewardRedPoint()}.bind(this)),this.addGlobalEvent(a.OrderAction_Updata_LevExp_Event,function(t){this.setBasicInitData(t),this.model.setRewardLevRedPoint(),this.statusTabRewardRedPoint()}.bind(this)),this.addGlobalEvent(a.OrderAction_IsPopWarn_Event,function(t){if(t){30-t.cur_day!=7&&30-t.cur_day!=3&&30-t.cur_day!=0||1==t.is_pop&&this.ctrl.openEndWarnView(!0,t.cur_day)}}.bind(this)),this.addGlobalEvent(a.OrderAction_BuyGiftCard_Event,function(){this.updateBoxStatus(),1==this.model.getGiftStatus()?(this.advance_card_buy_btn.interactable=!1,this.advance_card_buy_btn.enableAutoGrayEffect=!0,this.advance_card_buy_label.node.getComponent(cc.LabelOutline).enabled=!1,this.btn_open_lock_label.string=Utils.TI18N("\u5956\u52b1\u603b\u89c8"),this.btn_open_lock_label.node.color=n.ColorConst[1],this.btn_open_lock_bg&&this.loadRes(s.getUIIconPath("common","common_1027"),function(t){this.btn_open_lock_bg.spriteFrame=t}.bind(this))):(this.advance_card_buy_btn.interactable=!0,this.advance_card_buy_btn.enableAutoGrayEffect=!1,this.advance_card_buy_label.node.getComponent(cc.LabelOutline).enabled=!0,this.btn_open_lock_label.string=Utils.TI18N("\u89e3\u9501\u9886\u53d6"))}.bind(this)),Utils.onTouchEnd(this.btn_buy_lev,function(){var t=this.model.getCurPeriod();Config.holiday_war_order_data.data_lev_reward_list[t]&&(this.model.getCurLev()>=40?message(Utils.TI18N("\u60a8\u5df2\u6ee1\u7ea7\uff0c\u65e0\u6cd5\u8d2d\u4e70~~~")):this.ctrl.openBuyLevView(!0))}.bind(this),1),Utils.onTouchEnd(this.btn_untie_reward,function(){1==this.model.getGiftStatus()?this.ctrl.send25308():this.ctrl.openBuyCardView(!0)}.bind(this),1),this.tab_view)Utils.onTouchEnd(this.tab_view[e].btn_tab_view,function(t){this.model.getCurDay();var e=this.model.getCurPeriod();this.tabChargeView(t.index,e)}.bind(this,this.tab_view[e]),3);Utils.onTouchEnd(this.btn_open_lock,function(){this.model.getCurDay();1==this.model.getGiftStatus()?this.ctrl.openUntieRewardView(!0):this.ctrl.openBuyCardView(!0)}.bind(this),1),Utils.onTouchEnd(this.btn_close,function(){this.ctrl.openOrderActionMainView(!1)}.bind(this),2),Utils.onTouchEnd(this.background,function(){this.ctrl.openOrderActionMainView(!1)}.bind(this),2),this.btn_rule.on(cc.Node.EventType.TOUCH_END,function(e){var i=Config.holiday_war_order_data.data_constant,s=this.model.getCurPeriod(),n=i.action_rule;2==s?n=i.action_rule1:3==s?n=i.action_rule2:4==s&&(n=i.action_rule3);var a=e.touch.getLocation();t("tips_controller").getInstance().showCommonTips(n.desc,a)}.bind(this)),Utils.onTouchEnd(this.all_get,function(){this.ctrl.send25304(0)}.bind(this),1),Utils.onTouchEnd(this.advance_card_buy,function(){this.changeWarn()}.bind(this),1)},setAmendBuyPrice:function(t){var e=Config.charge_data.data_charge_data,i=Config.holiday_war_order_data.data_advance_card_list;if(i&&i[t]&&i[t][1]){var s=i[t][1].charge_id||null;if(s){var n=cc.js.formatStr(Utils.TI18N("\uffe5%d\u8d2d\u4e70"),e[s].val);this.advance_card_buy_label.string=n}}},loadTitleBarner:function(t){t=t||1;n.ColorConst[3];this.bar_num_line.color=this.color_bar_outline,this.time_text_bg.node.y=191,this.time_text.node.y=191;var e=this.main_container.getChildByName("title_barner").getComponent(cc.Sprite),i=s.getBigBg("txt_cn_orderaction_title",null,"orderaction");this.banner_botton.node.active=!1,this.loadRes(i,function(t){e.spriteFrame=t}.bind(this))},tabChargeView:function(t,e){t=t||1,this.cur_index!=t&&(this.cur_index=t,this.setButtonShowORHide(t),3!=t&&this.tabHeadTitle(t),null!=this.cur_panel&&this.cur_panel.setVisibleStatus&&this.cur_panel.setVisibleStatus(!1),this.cur_panel=this.createTabViewPanel(this.cur_index,e),null!=this.cur_panel&&this.cur_panel.setVisibleStatus&&this.cur_panel.setVisibleStatus(!0))},tabHeadTitle:function(t){null!=this.cur_herd_title&&(this.cur_herd_title.select.active=!1,this.cur_herd_title.icon.opacity=178,this.cur_herd_title.name.node.color=n.ColorConst[7]),this.cur_herd_title=this.tab_view[t],null!=this.cur_herd_title&&(this.cur_herd_title.select.active=!0,this.cur_herd_title.icon.opacity=255,this.cur_herd_title.name.node.color=n.ColorConst[8])},createTabViewPanel:function(e,i){var s=this.tab_panel_list[e];if(null==s){if(e==n.OrderActionView.reward_panel)s=new(t("orderaction_reward_panel"))(i);else if(e==n.OrderActionView.tesk_panel){s=new(t("orderaction_tesk_panel"))(i)}else n.OrderActionView.advance_card;this.main_container.getContentSize();if(s){s.setPosition(-326,-370),s.setParent(this.main_container),s.show()}this.tab_panel_list[e]=s,this.all_get&&(this.all_get.zIndex=30),this.btn_buy_lev&&(this.btn_buy_lev.zIndex=31),this.btn_open_lock&&(this.btn_open_lock.zIndex=32)}return s},updateBoxStatus:function(){var t=0,e=this.model.getRMBStatus(),i=this.model.getExtraStatus();if(0==e?t=0:1==e&&(0==i?t=1:1==i&&(t=2)),this.cur_box_status!=t){this.cur_box_status=t;var n=PlayerAction.action_1;0==t?n=PlayerAction.action_1:1==t?n=PlayerAction.action_2:2==t&&(n=PlayerAction.action_3),this.box_effect&&(this.box_effect.clearTracks(),this.box_effect.node.removeFromParent(),this.box_effect.node.destroy(),this.box_effect=null),this.btn_untie_reward&&null==this.box_effect&&(this.box_effect=Utils.createEffectSpine(s.getEffectRes(110),cc.v2(0,-18),cc.v2(.5,.5),!0,n),this.btn_untie_reward.addChild(this.box_effect.node))}},getTaskRedPoint:function(){var t=this.model.getTaskRedPoint();Utils.addRedPointToNodeByStatus(this.tab_view[2].btn_tab_view,t)},statusTabRewardRedPoint:function(){var t=this.model.getRewardLevRedPoint();Utils.addRedPointToNodeByStatus(this.tab_view[1].btn_tab_view,t),Utils.addRedPointToNodeByStatus(this.all_get,t,9,6)},changeWarn:function(){var t=this.model.getCurDay(),e=Config.charge_data.data_charge_data,i=Config.holiday_war_order_data.data_advance_card_list,s=this.model.getCurPeriod();if(i&&i[s]&&i[s][1]){var n=null;if(t>=25&&(n=30==t?Utils.TI18N("\u6d3b\u52a8\u5c06\u5728\u4eca\u5929\u7ed3\u675f\uff0c\u662f\u5426\u786e\u8ba4\u5145\u503c"):cc.js.formatStr(Utils.TI18N("\u6d3b\u52a8\u5c06\u5728 %d \u5929\u540e\u7ed3\u675f\uff0c\u662f\u5426\u786e\u8ba4\u5145\u503c"),30-t)),n)l.show(n,Utils.TI18N("\u786e\u5b9a"),function(){var t=i[s][1].charge_id||null;t&&e[t]&&SDK.pay(e[t].val,1,e[t].id,e[t].name)},Utils.TI18N("\u53d6\u6d88"));else{var a=i[s][1].charge_id||null;a&&e[a]&&SDK.pay(e[a].val,1,e[a].id,e[a].name)}}},setBasicInitData:function(t){if(t){var e=t.lev||0,i=this.model.getCurPeriod();if(this.level_num&&(this.level_num.string=e),Config.holiday_war_order_data.data_lev_reward_list[i]){var s=e+1;if(s>=Object.keys(Config.holiday_war_order_data.data_lev_reward_list[i]).length&&(s=Object.keys(Config.holiday_war_order_data.data_lev_reward_list[i]).length),Config.holiday_war_order_data.data_lev_reward_list[i][s]){var n=Config.holiday_war_order_data.data_lev_reward_list[i][s].exp||0;if(0==t.lev)this.bar.progress=t.exp/n,this.bar_num.string=t.exp+"/"+n;else{var a=Config.holiday_war_order_data.data_lev_reward_list[i][e].exp||0,o=(t.exp-a)/(n-a);this.bar.progress=o,this.bar_num.string=t.exp+"/"+n}}}}},setButtonShowORHide:function(t){t=t||1,this.time_text_bg.node.active=1==t,this.time_text.node.active=1==t,this.all_get.active=1==t,this.advance_card_buy.active=3==t},openRootWnd:function(t){this.ctrl.send25309(),this.ctrl.send25300(),this.ctrl.send25303(),this.ctrl.send25306(),this.model.initTaskData()},closeCallBack:function(){if(this.time_text&&this.time_text.node.stopAllActions(),this.box_effect&&(this.box_effect.clearTracks(),this.box_effect.node.removeFromParent(),this.box_effect.node.destroy(),this.box_effect=null),this.tab_panel_list){for(var t in this.tab_panel_list)this.tab_panel_list[t]&&this.tab_panel_list[t].deleteMe&&this.tab_panel_list[t].deleteMe();this.tab_panel_list=null}this.ctrl.openOrderActionMainView(!1)}});cc._RF.pop()},{action_controller:"action_controller",commonalert:"commonalert",orderaction_const:"orderaction_const",orderaction_event:"orderaction_event",orderaction_reward_panel:"orderaction_reward_panel",orderaction_tesk_panel:"orderaction_tesk_panel",pathtool:"pathtool",tips_controller:"tips_controller"}],orderaction_model:[function(t,e,i){"use strict";function s(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}cc._RF.push(e,"a6f6cwAUcBJA5bjNkBvfgpF","orderaction_model");var n=t("mainui_controller"),a=t("orderaction_const");cc.Class({extends:BaseClass,ctor:function(){},properties:{},initConfig:function(){this.initTaskData()},initTaskData:function(){this.day_task_list=[],this.week_task_list=[],this.period_task_list=[]},setTaskInduct:function(t,e,i){if(1==i){var s=Config.holiday_war_order_data.data_day_task_list;if(s&&s[t]){for(var n in s[t])s[t][n].day==e&&this.day_task_list.push(s[t][n]);this.day_task_list.sort(function(t,e){return t.goal_id-e.goal_id})}}else if(2==i){var a=Config.holiday_war_order_data.data_week_task_list;if(a&&a[t]){for(var n in a[t])e>=a[t][n].min_day&&e<=a[t][n].max_day&&this.week_task_list.push(a[t][n]);this.week_task_list.sort(function(t,e){return t.goal_id-e.goal_id})}}else if(3==i){var o=Config.holiday_war_order_data.data_period_task_list;if(o&&o[t]){for(var n in o[t])this.period_task_list.push(o[t][n]);this.period_task_list.sort(function(t,e){return t.goal_id-e.goal_id})}}},getTaskInduct:function(t){var e;return 1==t?e=this.day_task_list:2==t?e=this.week_task_list:3==t&&(e=this.period_task_list),e&&null!=Utils.next(e)?e:null},setCurExp:function(t){this.cur_exp=t},getCurExp:function(){return this.cur_exp?this.cur_exp:1},setCurPeriod:function(t){this.cur_period=t},getCurPeriod:function(){return this.cur_period?(n.getInstance().getFunctionIconById(a.OrderActionEntranceID.entrance_id)&&(this.cur_period=1),this.cur_period):1},setCurDay:function(t){this.cur_day=t},getCurDay:function(){return null!=this.cur_day?this.cur_day:1},setCurLev:function(t){this.cur_lev=t},getCurLev:function(){return null!=this.cur_lev?this.cur_lev:1},setRMBStatus:function(t){this.rmb_status=t},getRMBStatus:function(){return null!=this.rmb_status?this.rmb_status:0},setExtraStatus:function(t){this.extra_status=t},getExtraStatus:function(){return null!=this.extra_status?this.extra_status:0},setGiftStatus:function(t){if(t&&null==Utils.next(t)&&(this.gift_status=null),null!=this.gift_status&&1==this.gift_status)return 1;Config.charge_data.data_charge_data;var e=Config.holiday_war_order_data.data_advance_card_list,i=this.getCurPeriod();if(e&&e[i]&&e[i][1]){var s=e[i][1].id||null;if(s)for(var n in t)s==t[n].id&&(this.gift_status=t[n].status)}},getGiftStatus:function(){return null!=this.gift_status?this.gift_status:0},setLevShowData:function(t){for(var e in this.lev_show_data={},t)this.lev_show_data[t[e].id]=t[e];this.setRewardLevRedPoint()},getLevShowData:function(t){return this.lev_show_data&&this.lev_show_data[t]?this.lev_show_data[t]:null},setRewardLevRedPoint:function(){var t=!1,e=Config.holiday_war_order_data.data_lev_reward_list,i=this.getCurLev(),s=this.getCurPeriod();if(this.lev_show_data&&e[s])for(var n in e[s]){var o=e[s][n];if(o.lev<=i){var l=!1,r=this.getLevShowData(o.lev);if(r?1==this.getRMBStatus()&&(l=1!=r.rmb_status||1!=r.status):e[s][o.lev]&&e[s][o.lev].reward&&e[s][o.lev].reward[1]&&(l=!0),1==l){t=!0;break}}}this.reward_red_point=t,this.setMainTipsStatus(a.OrderActionView.reward_panel,t)},getRewardLevRedPoint:function(){return!!this.reward_red_point&&this.reward_red_point},setInitTaskData:function(t){for(var e in this.initConfig(),this.init_task_data={},t)this.init_task_data[t[e].id]=t[e];this.setTaskRedPoint()},getInitTaskData:function(t){return this.init_task_data&&this.init_task_data[t]?this.init_task_data[t]:null},updataTeskData:function(t){if(t&&t.list)for(var e in t.list)this.init_task_data&&this.init_task_data[t.list[e].id]&&(this.init_task_data[t.list[e].id]=t.list[e]);this.setTaskRedPoint()},setTaskRedPoint:function(){var t=!1;if(this.init_task_data)for(var e in this.init_task_data)if(1==this.init_task_data[e].finish){t=!0;break}this.task_red_point=t;var i=this.getCurLev(),s=this.getRMBStatus(),n=gdata("holiday_war_order_data","data_constant","war_order_levmax");n&&i>=n.val&&1==s&&(t=!1),this.setMainTipsStatus(a.OrderActionView.tesk_panel,t)},getTaskRedPoint:function(){return!!this.task_red_point&&this.task_red_point},setMainTipsStatus:function(t,e){var i=0;e&&(i=1);var s={bid:t,num:i},o=a.OrderActionEntranceID.entrance_id;n.getInstance().setFunctionTipsStatus(o,s)},sortTeskItemList:function(t){var e,i=(s(e={},0,2),s(e,1,1),s(e,2,3),e);t.sort(function(t,e){return t.status!=e.status?!(!i[t.status]||!i[e.status])&&i[t.status]-i[e.status]:t.goal_id-e.goal_id})}});cc._RF.pop()},{mainui_controller:"mainui_controller",orderaction_const:"orderaction_const"}],orderaction_reward_item_panel:[function(t,e,i){"use strict";cc._RF.push(e,"9c78dNEg4tCBIyKysShc8vh","orderaction_reward_item_panel");var s=t("pathtool"),n=t("orderaction_controller");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("orderaction","reward_item1"),this.ctrl=n.getInstance(),this.model=this.ctrl.getModel()},initConfig:function(){},initPanel:function(){var t=this.root_wnd.getChildByName("main_container");this.goods_item=t.getChildByName("goods_item"),this.good_item_content=this.goods_item.getChildByName("content"),this.mark=t.getChildByName("mark"),this.mark.active=!1,this.lev_num=t.getChildByName("lev_num").getComponent(cc.Label),this.lev_num.string="",this.common_goods_item=ItemsPool.getInstance().getItem("backpack_item"),this.common_goods_item.initConfig(!1,.8,null,!0),this.common_goods_item.setParent(t),this.common_goods_item.setPosition(263,58),this.common_goods_item.addActionCallBack(function(){this.data&&this.data.lev&&null!=this.data.status&&0==this.data.status&&this.ctrl.send25304(this.data.lev)}.bind(this)),this.common_goods_item.show(),this.data&&this.updateData(this.data)},registerEvent:function(){},updateData:function(t){this.lev_num.string=t.lev||1;var e=!0;this.common_goods_item&&(t.reward&&t.reward[0]?(this.common_goods_item.setData({bid:t.reward[0][0],num:t.reward[0][1]}),this.common_goods_item.setVisible(!0),this.common_goods_item.showOrderWarLock(!0)):this.common_goods_item.setVisible(!1),1==t.status?this.common_goods_item.IsGetStatus(!0):this.common_goods_item.IsGetStatus(!1));var i=!0;t.cur_lev>=t.lev?(this.common_goods_item&&(this.common_goods_item.showOrderWarLock(!1),e=!1),i=1!=t.is_locak):(this.common_goods_item&&(this.common_goods_item.showOrderWarLock(!0),e=!0),i=!0),0==e?1==t.status?this.common_goods_item.showItemEffect(!1):this.common_goods_item.showItemEffect(!0,263,PlayerAction.action_1,!0,1.1):this.common_goods_item.showItemEffect(!1),0!=t.status&&(e=!1),this.common_goods_item.setDefaultTip(e);var s,n=!0;1==this.model.getGiftStatus()&&0==t.rmb_status&&t.cur_lev>=t.lev&&(n=!1),0==n&&(s=263);var a=t.rmb_reward||[],o={start_x:10,scale:.8,max_count:3};o.lock=i,o.is_tip=n,o.show_effect_id=s;var l=function(){this.data&&this.data.lev&&null!=this.data.rmb_status&&0==this.data.rmb_status&&this.ctrl.send25304(this.data.lev)}.bind(this);o.callback=l,this.item_list=Utils.commonShowSingleRowItemList(this.goods_item,this.item_list,a,o,this.good_item_content,!0)},setData:function(t){t&&(this.data=t,this.root_wnd&&this.updateData(t))},onShow:function(t){},onHide:function(){},onDelete:function(){if(this.item_list){for(var t in this.item_list)this.item_list[t].deleteMe();this.item_list=null}this.common_goods_item&&(this.common_goods_item.deleteMe(),this.common_goods_item=null)}});cc._RF.pop()},{orderaction_controller:"orderaction_controller",pathtool:"pathtool"}],orderaction_reward_panel:[function(t,e,i){"use strict";cc._RF.push(e,"a0bd9USK0ZOmYfmuBQUriQT","orderaction_reward_panel");var s=t("pathtool"),n=(t("action_controller"),t("common_scrollview_single")),a=t("orderaction_reward_item_panel"),o=t("orderaction_event"),l=t("orderaction_controller");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("orderaction","reward_panel1"),this.ctrl=l.getInstance(),this.model=this.ctrl.getModel(),this.cur_period=arguments[0]||1},initConfig:function(){this.cur_move_num=null,this.is_init=!0},initPanel:function(){this.main_container=this.root_wnd.getChildByName("main_container"),this.main_container.getChildByName("Image_1").getChildByName("Text_1").getComponent(cc.Label).string=Utils.TI18N("\u7b49\u7ea7"),this.main_container.getChildByName("Image_1").getChildByName("Text_1_0").getComponent(cc.Label).string=Utils.TI18N("\u5956\u52b1"),this.main_container.getChildByName("Image_1").getChildByName("Text_1_1").getComponent(cc.Label).string=Utils.TI18N("\u8fdb\u9636\u5956\u52b1"),this.main_container.getChildByName("Image_14").getChildByName("Text_2").getComponent(cc.Label).string=Utils.TI18N("\u5956\u52b1\u9884\u89c8"),this.lev_num=this.main_container.getChildByName("Image_14").getChildByName("lev_num").getComponent(cc.Label),this.lev_num.string="",this.slide_goods_item=this.main_container.getChildByName("slide_goods_item"),this.slide_goods_content=this.slide_goods_item.getChildByName("content"),this.lock_image=this.main_container.getChildByName("lock_image"),this.btn_change_advance=this.lock_image.getChildByName("btn_change_advance"),this.lock_image.active=!0,1==this.model.getGiftStatus()?this.lock_image.active=!1:this.lock_image.active=!0;var t=this.main_container.getChildByName("goods_item"),e=t.getContentSize();this.reward_goods_item=new n,this.reward_goods_item.createScroll(t,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,e,{start_x:0,space_x:0,start_y:0,space_y:0,item_width:635,item_height:116,row:0,col:1,need_dynamic:!0}),this.reward_goods_item.registerScriptHandlerSingle(this.createTaskCell.bind(this),ScrollViewFuncType.CreateNewCell),this.reward_goods_item.registerScriptHandlerSingle(this.numberOfTaskCells.bind(this),ScrollViewFuncType.NumberOfCells),this.reward_goods_item.registerScriptHandlerSingle(this.updateTaskCellByIndex.bind(this),ScrollViewFuncType.UpdateCellByIndex);var i=this.model.getCurLev();this.setChangeLevelStatus(i)},registerEvent:function(){this.addGlobalEvent(o.OrderAction_Updata_LevExp_Event,function(t){t&&this.setChangeLevelStatus(t.lev)}.bind(this)),this.addGlobalEvent(o.OrderAction_LevReward_Event,function(t){this.setChangeLevelStatus(t)}.bind(this)),this.addGlobalEvent(o.OrderAction_BuyGiftCard_Event,function(){var t=this.model.getCurLev();this.setChangeLevelStatus(t),1==this.model.getGiftStatus()?this.lock_image.active=!1:this.lock_image.active=!0}.bind(this)),Utils.onTouchEnd(this.btn_change_advance,function(){this.ctrl.openBuyCardView(!0)}.bind(this),1)},createTaskCell:function(){var t=new a;return t.show(),t},numberOfTaskCells:function(){return this.reward_list?this.reward_list.length:0},updateTaskCellByIndex:function(t,e){if(this.reward_list){var i=this.reward_list[e];i&&(t.setData(i),this.setSlideGoodsItem(i.lev))}},setSlideGoodsItem:function(t){var e=Object.keys(Config.holiday_war_order_data.data_lev_reward_list[this.cur_period]).length||1;if(t=Math.ceil(.1*t),this.cur_move_num!=t){this.cur_move_num=t;var i=10*this.cur_move_num;if(i>=e&&(i=e),0==i&&(i=1),Config.holiday_war_order_data.data_lev_reward_list[this.cur_period]){var s=Config.holiday_war_order_data.data_lev_reward_list[this.cur_period][i];if(s){this.lev_num.string="("+s.lev+")",this.common_item||(this.common_item=ItemsPool.getInstance().getItem("backpack_item"),this.common_item.initConfig(!1,.8),this.common_item.setParent(this.main_container),this.common_item.setPosition(263,58),this.common_item.setDefaultTip(),this.common_item.show()),s.reward&&null!=Utils.next(s.reward)?(this.common_item.setData({bid:s.reward[0][0],num:s.reward[0][1]}),this.common_item.setVisible(!0)):this.common_item.setVisible(!1);var n=s.rmb_reward||[],a={scale:.8,max_count:3};this.slide_goods_list=Utils.commonShowSingleRowItemList(this.slide_goods_item,this.slide_goods_list,n,a,this.slide_goods_content)}}}},setChangeLevelStatus:function(t){if(Config.holiday_war_order_data.data_lev_reward_list[this.cur_period]){for(var e in this.reward_list=[],Config.holiday_war_order_data.data_lev_reward_list[this.cur_period]){var i=Config.holiday_war_order_data.data_lev_reward_list[this.cur_period][e];i.cur_lev=t,i.status=0,i.rmb_status=0,i.is_locak=this.model.getGiftStatus();var s=this.model.getLevShowData(i.lev);s&&(i.status=s.status,i.rmb_status=s.rmb_status),1==i.status&&1==i.rmb_status||this.reward_list.push(i)}null==Utils.next(this.reward_list)?(this.common_item&&this.common_item.setVisible(!1),this.slide_goods_item&&(this.slide_goods_item.active=!1),this.lev_num.string=Utils.TI18N("(\u9886\u53d6\u5b8c\u6bd5)"),this.reward_goods_item.reloadData(),Utils.commonShowEmptyIcon(this.main_container,!0,{font_size:22,scale:1,text:Utils.TI18N("\u5df2\u9886\u53d6\u6240\u6709\u5956\u52b1")})):(this.reward_list.sort(function(t,e){return t.lev-e.lev}),this.reward_goods_item.reloadData())}},setVisibleStatus:function(t){t=t||!1,this.setVisible(t)},onShow:function(t){},onHide:function(){},onDelete:function(){if(this.reward_goods_item&&(this.reward_goods_item.deleteMe(),this.reward_goods_item=null),this.slide_goods_list){for(var t in this.slide_goods_list)this.slide_goods_list[t].deleteMe();this.slide_goods_list=null}this.common_item&&(this.common_item.deleteMe(),this.common_item=null)}});cc._RF.pop()},{action_controller:"action_controller",common_scrollview_single:"common_scrollview_single",orderaction_controller:"orderaction_controller",orderaction_event:"orderaction_event",orderaction_reward_item_panel:"orderaction_reward_item_panel",pathtool:"pathtool"}],orderaction_tesk_item_panel:[function(t,e,i){"use strict";cc._RF.push(e,"56ddfEKCh1IY6rdCbRxxvY1","orderaction_tesk_item_panel");var s=t("pathtool"),n=t("stronger_controller"),a=t("orderaction_controller");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("orderaction","tesk_item1"),this.ctrl=a.getInstance()},initConfig:function(){this.tab_name=[Utils.TI18N("\u6bcf\u65e5"),Utils.TI18N("\u6bcf\u5468"),Utils.TI18N("\u6bcf\u6708")]},initPanel:function(){var t=this.root_wnd.getChildByName("main_container");this.btn_goto=t.getChildByName("btn_goto"),this.btn_goto.getChildByName("Text_3").getComponent(cc.Label).string=Utils.TI18N("\u524d\u5f80"),this.btn_goto.active=!1,this.btn_get=t.getChildByName("btn_get"),this.btn_get.getChildByName("Text_3").getComponent(cc.Label).string=Utils.TI18N("\u9886\u53d6"),this.btn_get.active=!1,this.spr_get=t.getChildByName("spr_get"),this.spr_get.active=!1,this.big_title_head=t.getChildByName("big_title_head").getComponent(cc.Label),this.big_title_head.string="",this.big_title=t.getChildByName("big_title").getComponent(cc.Label),this.big_title.string="",this.small_title=t.getChildByName("small_title").getComponent(cc.Label),this.small_title.string="",this.task_reward||(this.task_reward=ItemsPool.getInstance().getItem("backpack_item"),this.task_reward.initConfig(!1,.7),this.task_reward.setParent(t),this.task_reward.setPosition(59,57),this.task_reward.setDefaultTip(),this.task_reward.show()),this.data&&this.updateData(this.data)},registerEvent:function(){Utils.onTouchEnd(this.btn_get,function(){this.data&&this.data.goal_id&&this.ctrl.send25302(this.data.goal_id)}.bind(this),1),Utils.onTouchEnd(this.btn_goto,function(){this.data&&""!=this.data.show_icon&&(this.ctrl.openOrderActionMainView(!1),n.getInstance().clickCallBack(this.data.show_icon))}.bind(this),1)},updateData:function(t){this.task_reward&&t.award&&t.award[0]&&this.task_reward.setData({bid:t.award[0][0],num:t.award[0][1]}),t.tab_index&&(this.big_title_head.string="\u3010"+this.tab_name[t.tab_index-1]+"\u3011"),this.big_title.string=t.title||"";var e=t.desc||"",i=Utils.getMoneyString(t.value||0),s=Utils.getMoneyString(t.target_val||0),n=cc.js.formatStr("%s (%s/%s)",e,i,s);this.small_title.string=n,this.btn_goto.active=0==t.status,this.btn_get.active=1==t.status,this.spr_get.active=2==t.status},setData:function(t){t&&(this.data=t,this.root_wnd&&this.updateData(t))},onShow:function(t){},onHide:function(){},onDelete:function(){this.task_reward&&(this.task_reward.deleteMe(),this.task_reward=null)}});cc._RF.pop()},{orderaction_controller:"orderaction_controller",pathtool:"pathtool",stronger_controller:"stronger_controller"}],orderaction_tesk_panel:[function(t,e,i){"use strict";cc._RF.push(e,"3718aWVTN9M2a3oyPVhV5VM","orderaction_tesk_panel");var s=t("pathtool"),n=t("action_controller"),a=t("common_scrollview_single"),o=t("orderaction_tesk_item_panel"),l=(t("orderaction_const"),t("orderaction_event")),r=t("orderaction_controller");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("orderaction","tesk_panel1"),this.ctrl=r.getInstance(),this.model=this.ctrl.getModel(),this.cur_period=arguments[0]||1},initConfig:function(){this.title_name_list=[Utils.TI18N("\u6bcf\u65e5\u4efb\u52a1"),Utils.TI18N("\u6bcf\u5468\u6311\u6218"),Utils.TI18N("\u7ec8\u6781\u8bd5\u70bc")],this.cur_task_index=null},initPanel:function(){var t=this.root_wnd.getChildByName("main_container");this.time_title=t.getChildByName("time_title").getComponent(cc.Label),this.time_desc=t.getChildByName("time_desc").getComponent(cc.Label),this.tab_view_list={};for(var e=t.getChildByName("tab_view"),i=1;i<=3;i++){var s={};s.btn_view=e.getChildByName("tab_task_"+i),s.normal=s.btn_view.getChildByName("normal"),s.select=s.btn_view.getChildByName("select"),s.select.active=!1,s.title_name=s.btn_view.getChildByName("title_name").getComponent(cc.Label),s.title_name.string=this.title_name_list[i-1],s.redpoint=s.btn_view.getChildByName("redpoint"),s.redpoint.active=!1,this.tab_view_list[i]=s}var n=t.getChildByName("task_item"),o=n.getContentSize();this.task_goods_item=new a,this.task_goods_item.createScroll(n,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,o,{start_x:0,space_x:0,start_y:0,space_y:0,item_width:635,item_height:116,row:0,col:1,need_dynamic:!0}),this.task_goods_item.registerScriptHandlerSingle(this.createTaskCell.bind(this),ScrollViewFuncType.CreateNewCell),this.task_goods_item.registerScriptHandlerSingle(this.numberOfTaskCells.bind(this),ScrollViewFuncType.NumberOfCells),this.task_goods_item.registerScriptHandlerSingle(this.updateTaskCellByIndex.bind(this),ScrollViewFuncType.UpdateCellByIndex),this.setTabRedPoint(),this.tabChargeTaskView(1)},registerEvent:function(){for(var t in this.addGlobalEvent(l.OrderAction_TaskGet_Event,function(){this.setTaskGetStatus(),this.setTabRedPoint()}.bind(this)),this.tab_view_list)Utils.onTouchEnd(this.tab_view_list[t].btn_view,function(t){this.tabChargeTaskView(t)}.bind(this,t),1)},createTaskCell:function(){var t=new o;return t.show(),t},numberOfTaskCells:function(){return this.task_list?this.task_list.length:0},updateTaskCellByIndex:function(t,e){if(this.task_list){var i=this.task_list[e];i&&t.setData(i)}},tabChargeTaskView:function(t){t=t||1,this.cur_task_index!=t&&(null!=this.cur_tab_view&&(this.cur_tab_view.select.active=!1),this.cur_task_index=t,this.cur_tab_view=this.tab_view_list[t],null!=this.cur_tab_view&&(this.cur_tab_view.select.active=!0),this.setTaskGetStatus())},setTaskGetStatus:function(){var t=this.model.getCurDay(),e=this.setTaskData(this.cur_period,t,this.cur_task_index),i=0;if(e){for(var s in this.task_list=[],e){var a=e[s],o=this.model.getInitTaskData(a.goal_id);a.tab_index=this.cur_task_index,o&&(a.status=o.finish,a.value=o.value,a.target_val=o.target_val,0==i&&(i=o.end_time-gcore.SmartSocket.getTime())),this.task_list.push(a)}this.model.sortTeskItemList(this.task_list),this.task_goods_item.reloadData()}this.time_title.string=Utils.TI18N("\u5237\u65b0\u65f6\u95f4:"),n.getInstance().getModel().setCountDownTime(this.time_desc,i)},setTaskData:function(t,e,i){i=i||1;var s=null,n=this.model.getTaskInduct(i);if(n)s=n;else{this.model.setTaskInduct(t,e,i);var a=this.model.getTaskInduct(i);a&&(s=a)}return s},setTabRedPoint:function(){for(var t=this.model.getCurDay(),e=1;e<=3;e++){var i=this.setTaskData(this.cur_period,t,e);if(i){var s=!1;for(var n in i){var a=this.model.getInitTaskData(i[n].goal_id);if(a&&1==a.finish){s=!0;break}}this.tab_view_list[e].redpoint.active=s}}},setVisibleStatus:function(t){t=t||!1,this.setVisible(t)},onShow:function(t){},onHide:function(){},onDelete:function(){this.time_desc&&this.time_desc.node.stopAllActions(),this.task_goods_item&&(this.task_goods_item.deleteMe(),this.task_goods_item=null)}});cc._RF.pop()},{action_controller:"action_controller",common_scrollview_single:"common_scrollview_single",orderaction_const:"orderaction_const",orderaction_controller:"orderaction_controller",orderaction_event:"orderaction_event",orderaction_tesk_item_panel:"orderaction_tesk_item_panel",pathtool:"pathtool"}],pako:[function(t,e,i){(function(s){"use strict";function n(t){"@babel/helpers - typeof";return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}cc._RF.push(e,"4f8a2jevs1E0IswVXEelNkw","pako"),function(t){"object"==(void 0===i?"undefined":n(i))&&void 0!==e?e.exports=t():"function"==typeof define&&define.amd?define([],t):("undefined"!=typeof window?window:void 0!==s?s:"undefined"!=typeof self?self:this).pako=t()}(function(){return function e(i,s,n){function a(l,r){if(!s[l]){if(!i[l]){var c="function"==typeof t&&t;if(!r&&c)return c(l,!0);if(o)return o(l,!0);var _=new Error("Cannot find module '"+l+"'");throw _.code="MODULE_NOT_FOUND",_}var h=s[l]={exports:{}};i[l][0].call(h.exports,function(t){return a(i[l][1][t]||t)},h,h.exports,e,i,s,n)}return s[l].exports}for(var o="function"==typeof t&&t,l=0;l<n.length;l++)a(n[l]);return a}({1:[function(t,e,i){var s=t("./zlib/deflate"),n=t("./utils/common"),a=t("./utils/strings"),o=t("./zlib/messages"),l=t("./zlib/zstream"),r=Object.prototype.toString,c=0,_=-1,h=0,d=8;function u(t){if(!(this instanceof u))return new u(t);this.options=n.assign({level:_,method:d,chunkSize:16384,windowBits:15,memLevel:8,strategy:h,to:""},t||{});var e=this.options;e.raw&&0<e.windowBits?e.windowBits=-e.windowBits:e.gzip&&0<e.windowBits&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var i=s.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(i!==c)throw new Error(o[i]);if(e.header&&s.deflateSetHeader(this.strm,e.header),e.dictionary){var m;if(m="string"==typeof e.dictionary?a.string2buf(e.dictionary):"[object ArrayBuffer]"===r.call(e.dictionary)?new Uint8Array(e.dictionary):e.dictionary,(i=s.deflateSetDictionary(this.strm,m))!==c)throw new Error(o[i]);this._dict_set=!0}}function m(t,e){var i=new u(e);if(i.push(t,!0),i.err)throw i.msg||o[i.err];return i.result}u.prototype.push=function(t,e){var i,o,l=this.strm,_=this.options.chunkSize;if(this.ended)return!1;o=e===~~e?e:!0===e?4:0,"string"==typeof t?l.input=a.string2buf(t):"[object ArrayBuffer]"===r.call(t)?l.input=new Uint8Array(t):l.input=t,l.next_in=0,l.avail_in=l.input.length;do{if(0===l.avail_out&&(l.output=new n.Buf8(_),l.next_out=0,l.avail_out=_),1!==(i=s.deflate(l,o))&&i!==c)return this.onEnd(i),!(this.ended=!0);0!==l.avail_out&&(0!==l.avail_in||4!==o&&2!==o)||("string"===this.options.to?this.onData(a.buf2binstring(n.shrinkBuf(l.output,l.next_out))):this.onData(n.shrinkBuf(l.output,l.next_out)))}while((0<l.avail_in||0===l.avail_out)&&1!==i);return 4===o?(i=s.deflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===c):2!==o||(this.onEnd(c),!(l.avail_out=0))},u.prototype.onData=function(t){this.chunks.push(t)},u.prototype.onEnd=function(t){t===c&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=n.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},i.Deflate=u,i.deflate=m,i.deflateRaw=function(t,e){return(e=e||{}).raw=!0,m(t,e)},i.gzip=function(t,e){return(e=e||{}).gzip=!0,m(t,e)}},{"./utils/common":3,"./utils/strings":4,"./zlib/deflate":8,"./zlib/messages":13,"./zlib/zstream":15}],2:[function(t,e,i){var s=t("./zlib/inflate"),n=t("./utils/common"),a=t("./utils/strings"),o=t("./zlib/constants"),l=t("./zlib/messages"),r=t("./zlib/zstream"),c=t("./zlib/gzheader"),_=Object.prototype.toString;function h(t){if(!(this instanceof h))return new h(t);this.options=n.assign({chunkSize:16384,windowBits:0,to:""},t||{});var e=this.options;e.raw&&0<=e.windowBits&&e.windowBits<16&&(e.windowBits=-e.windowBits,0===e.windowBits&&(e.windowBits=-15)),!(0<=e.windowBits&&e.windowBits<16)||t&&t.windowBits||(e.windowBits+=32),15<e.windowBits&&e.windowBits<48&&0==(15&e.windowBits)&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new r,this.strm.avail_out=0;var i=s.inflateInit2(this.strm,e.windowBits);if(i!==o.Z_OK)throw new Error(l[i]);this.header=new c,s.inflateGetHeader(this.strm,this.header)}function d(t,e){var i=new h(e);if(i.push(t,!0),i.err)throw i.msg||l[i.err];return i.result}h.prototype.push=function(t,e){var i,l,r,c,h,d,u=this.strm,m=this.options.chunkSize,f=this.options.dictionary,p=!1;if(this.ended)return!1;l=e===~~e?e:!0===e?o.Z_FINISH:o.Z_NO_FLUSH,"string"==typeof t?u.input=a.binstring2buf(t):"[object ArrayBuffer]"===_.call(t)?u.input=new Uint8Array(t):u.input=t,u.next_in=0,u.avail_in=u.input.length;do{if(0===u.avail_out&&(u.output=new n.Buf8(m),u.next_out=0,u.avail_out=m),(i=s.inflate(u,o.Z_NO_FLUSH))===o.Z_NEED_DICT&&f&&(d="string"==typeof f?a.string2buf(f):"[object ArrayBuffer]"===_.call(f)?new Uint8Array(f):f,i=s.inflateSetDictionary(this.strm,d)),i===o.Z_BUF_ERROR&&!0===p&&(i=o.Z_OK,p=!1),i!==o.Z_STREAM_END&&i!==o.Z_OK)return this.onEnd(i),!(this.ended=!0);u.next_out&&(0!==u.avail_out&&i!==o.Z_STREAM_END&&(0!==u.avail_in||l!==o.Z_FINISH&&l!==o.Z_SYNC_FLUSH)||("string"===this.options.to?(r=a.utf8border(u.output,u.next_out),c=u.next_out-r,h=a.buf2string(u.output,r),u.next_out=c,u.avail_out=m-c,c&&n.arraySet(u.output,u.output,r,c,0),this.onData(h)):this.onData(n.shrinkBuf(u.output,u.next_out)))),0===u.avail_in&&0===u.avail_out&&(p=!0)}while((0<u.avail_in||0===u.avail_out)&&i!==o.Z_STREAM_END);return i===o.Z_STREAM_END&&(l=o.Z_FINISH),l===o.Z_FINISH?(i=s.inflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===o.Z_OK):l!==o.Z_SYNC_FLUSH||(this.onEnd(o.Z_OK),!(u.avail_out=0))},h.prototype.onData=function(t){this.chunks.push(t)},h.prototype.onEnd=function(t){t===o.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=n.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},i.Inflate=h,i.inflate=d,i.inflateRaw=function(t,e){return(e=e||{}).raw=!0,d(t,e)},i.ungzip=d},{"./utils/common":3,"./utils/strings":4,"./zlib/constants":6,"./zlib/gzheader":9,"./zlib/inflate":11,"./zlib/messages":13,"./zlib/zstream":15}],3:[function(t,e,i){var s="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;i.assign=function(t){for(var e,i,s=Array.prototype.slice.call(arguments,1);s.length;){var a=s.shift();if(a){if("object"!=n(a))throw new TypeError(a+"must be non-object");for(var o in a)e=a,i=o,Object.prototype.hasOwnProperty.call(e,i)&&(t[o]=a[o])}}return t},i.shrinkBuf=function(t,e){return t.length===e?t:t.subarray?t.subarray(0,e):(t.length=e,t)};var a={arraySet:function(t,e,i,s,n){if(e.subarray&&t.subarray)t.set(e.subarray(i,i+s),n);else for(var a=0;a<s;a++)t[n+a]=e[i+a]},flattenChunks:function(t){var e,i,s,n,a,o;for(e=s=0,i=t.length;e<i;e++)s+=t[e].length;for(o=new Uint8Array(s),e=n=0,i=t.length;e<i;e++)a=t[e],o.set(a,n),n+=a.length;return o}},o={arraySet:function(t,e,i,s,n){for(var a=0;a<s;a++)t[n+a]=e[i+a]},flattenChunks:function(t){return[].concat.apply([],t)}};i.setTyped=function(t){t?(i.Buf8=Uint8Array,i.Buf16=Uint16Array,i.Buf32=Int32Array,i.assign(i,a)):(i.Buf8=Array,i.Buf16=Array,i.Buf32=Array,i.assign(i,o))},i.setTyped(s)},{}],4:[function(t,e,i){var s=t("./common"),n=!0,a=!0;try{String.fromCharCode.apply(null,[0])}catch(t){n=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){a=!1}for(var o=new s.Buf8(256),l=0;l<256;l++)o[l]=252<=l?6:248<=l?5:240<=l?4:224<=l?3:192<=l?2:1;function r(t,e){if(e<65534&&(t.subarray&&a||!t.subarray&&n))return String.fromCharCode.apply(null,s.shrinkBuf(t,e));for(var i="",o=0;o<e;o++)i+=String.fromCharCode(t[o]);return i}o[254]=o[254]=1,i.string2buf=function(t){var e,i,n,a,o,l=t.length,r=0;for(a=0;a<l;a++)55296==(64512&(i=t.charCodeAt(a)))&&a+1<l&&56320==(64512&(n=t.charCodeAt(a+1)))&&(i=65536+(i-55296<<10)+(n-56320),a++),r+=i<128?1:i<2048?2:i<65536?3:4;for(e=new s.Buf8(r),a=o=0;o<r;a++)55296==(64512&(i=t.charCodeAt(a)))&&a+1<l&&56320==(64512&(n=t.charCodeAt(a+1)))&&(i=65536+(i-55296<<10)+(n-56320),a++),e[o++]=i<128?i:(e[o++]=i<2048?192|i>>>6:(e[o++]=i<65536?224|i>>>12:(e[o++]=240|i>>>18,128|i>>>12&63),128|i>>>6&63),128|63&i);return e},i.buf2binstring=function(t){return r(t,t.length)},i.binstring2buf=function(t){for(var e=new s.Buf8(t.length),i=0,n=e.length;i<n;i++)e[i]=t.charCodeAt(i);return e},i.buf2string=function(t,e){var i,s,n,a,l=e||t.length,c=new Array(2*l);for(i=s=0;i<l;)if((n=t[i++])<128)c[s++]=n;else if(4<(a=o[n]))c[s++]=65533,i+=a-1;else{for(n&=2===a?31:3===a?15:7;1<a&&i<l;)n=n<<6|63&t[i++],a--;c[s++]=1<a?65533:n<65536?n:(n-=65536,c[s++]=55296|n>>10&1023,56320|1023&n)}return r(c,s)},i.utf8border=function(t,e){var i;for((e=e||t.length)>t.length&&(e=t.length),i=e-1;0<=i&&128==(192&t[i]);)i--;return i<0?e:0===i?e:i+o[t[i]]>e?i:e}},{"./common":3}],5:[function(t,e,i){e.exports=function(t,e,i,s){for(var n=65535&t|0,a=t>>>16&65535|0,o=0;0!==i;){for(i-=o=2e3<i?2e3:i;a=a+(n=n+e[s++]|0)|0,--o;);n%=65521,a%=65521}return n|a<<16|0}},{}],6:[function(t,e,i){e.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],7:[function(t,e,i){var s=function(){for(var t,e=[],i=0;i<256;i++){t=i;for(var s=0;s<8;s++)t=1&t?3988292384^t>>>1:t>>>1;e[i]=t}return e}();e.exports=function(t,e,i,n){var a=s,o=n+i;t^=-1;for(var l=n;l<o;l++)t=t>>>8^a[255&(t^e[l])];return-1^t}},{}],8:[function(t,e,i){var s,n=t("../utils/common"),a=t("./trees"),o=t("./adler32"),l=t("./crc32"),r=t("./messages"),c=0,_=4,h=0,d=-2,u=-1,m=4,f=2,p=8,g=9,v=286,b=30,w=19,y=2*v+1,C=15,k=3,S=258,T=S+k+1,I=42,E=113,B=1,x=2,P=3,R=4;function N(t,e){return t.msg=r[e],e}function U(t){return(t<<1)-(4<t?9:0)}function A(t){for(var e=t.length;0<=--e;)t[e]=0}function D(t){var e=t.state,i=e.pending;i>t.avail_out&&(i=t.avail_out),0!==i&&(n.arraySet(t.output,e.pending_buf,e.pending_out,i,t.next_out),t.next_out+=i,e.pending_out+=i,t.total_out+=i,t.avail_out-=i,e.pending-=i,0===e.pending&&(e.pending_out=0))}function L(t,e){a._tr_flush_block(t,0<=t.block_start?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,D(t.strm)}function F(t,e){t.pending_buf[t.pending++]=e}function M(t,e){t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e}function G(t,e){var i,s,n=t.max_chain_length,a=t.strstart,o=t.prev_length,l=t.nice_match,r=t.strstart>t.w_size-T?t.strstart-(t.w_size-T):0,c=t.window,_=t.w_mask,h=t.prev,d=t.strstart+S,u=c[a+o-1],m=c[a+o];t.prev_length>=t.good_match&&(n>>=2),l>t.lookahead&&(l=t.lookahead);do{if(c[(i=e)+o]===m&&c[i+o-1]===u&&c[i]===c[a]&&c[++i]===c[a+1]){a+=2,i++;do{}while(c[++a]===c[++i]&&c[++a]===c[++i]&&c[++a]===c[++i]&&c[++a]===c[++i]&&c[++a]===c[++i]&&c[++a]===c[++i]&&c[++a]===c[++i]&&c[++a]===c[++i]&&a<d);if(s=S-(d-a),a=d-S,o<s){if(t.match_start=e,l<=(o=s))break;u=c[a+o-1],m=c[a+o]}}}while((e=h[e&_])>r&&0!=--n);return o<=t.lookahead?o:t.lookahead}function H(t){var e,i,s,a,r,c,_,h,d,u,m=t.w_size;do{if(a=t.window_size-t.lookahead-t.strstart,t.strstart>=m+(m-T)){for(n.arraySet(t.window,t.window,m,m,0),t.match_start-=m,t.strstart-=m,t.block_start-=m,e=i=t.hash_size;s=t.head[--e],t.head[e]=m<=s?s-m:0,--i;);for(e=i=m;s=t.prev[--e],t.prev[e]=m<=s?s-m:0,--i;);a+=m}if(0===t.strm.avail_in)break;if(c=t.strm,_=t.window,h=t.strstart+t.lookahead,u=void 0,(d=a)<(u=c.avail_in)&&(u=d),i=0===u?0:(c.avail_in-=u,n.arraySet(_,c.input,c.next_in,u,h),1===c.state.wrap?c.adler=o(c.adler,_,u,h):2===c.state.wrap&&(c.adler=l(c.adler,_,u,h)),c.next_in+=u,c.total_in+=u,u),t.lookahead+=i,t.lookahead+t.insert>=k)for(r=t.strstart-t.insert,t.ins_h=t.window[r],t.ins_h=(t.ins_h<<t.hash_shift^t.window[r+1])&t.hash_mask;t.insert&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[r+k-1])&t.hash_mask,t.prev[r&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=r,r++,t.insert--,!(t.lookahead+t.insert<k)););}while(t.lookahead<T&&0!==t.strm.avail_in)}function O(t,e){for(var i,s;;){if(t.lookahead<T){if(H(t),t.lookahead<T&&e===c)return B;if(0===t.lookahead)break}if(i=0,t.lookahead>=k&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+k-1])&t.hash_mask,i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==i&&t.strstart-i<=t.w_size-T&&(t.match_length=G(t,i)),t.match_length>=k)if(s=a._tr_tally(t,t.strstart-t.match_start,t.match_length-k),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=k){for(t.match_length--;t.strstart++,t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+k-1])&t.hash_mask,i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart,0!=--t.match_length;);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+1])&t.hash_mask;else s=a._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(s&&(L(t,!1),0===t.strm.avail_out))return B}return t.insert=t.strstart<k-1?t.strstart:k-1,e===_?(L(t,!0),0===t.strm.avail_out?P:R):t.last_lit&&(L(t,!1),0===t.strm.avail_out)?B:x}function V(t,e){for(var i,s,n;;){if(t.lookahead<T){if(H(t),t.lookahead<T&&e===c)return B;if(0===t.lookahead)break}if(i=0,t.lookahead>=k&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+k-1])&t.hash_mask,i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=k-1,0!==i&&t.prev_length<t.max_lazy_match&&t.strstart-i<=t.w_size-T&&(t.match_length=G(t,i),t.match_length<=5&&(1===t.strategy||t.match_length===k&&4096<t.strstart-t.match_start)&&(t.match_length=k-1)),t.prev_length>=k&&t.match_length<=t.prev_length){for(n=t.strstart+t.lookahead-k,s=a._tr_tally(t,t.strstart-1-t.prev_match,t.prev_length-k),t.lookahead-=t.prev_length-1,t.prev_length-=2;++t.strstart<=n&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+k-1])&t.hash_mask,i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!=--t.prev_length;);if(t.match_available=0,t.match_length=k-1,t.strstart++,s&&(L(t,!1),0===t.strm.avail_out))return B}else if(t.match_available){if((s=a._tr_tally(t,0,t.window[t.strstart-1]))&&L(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return B}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(s=a._tr_tally(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<k-1?t.strstart:k-1,e===_?(L(t,!0),0===t.strm.avail_out?P:R):t.last_lit&&(L(t,!1),0===t.strm.avail_out)?B:x}function W(t,e,i,s,n){this.good_length=t,this.max_lazy=e,this.nice_length=i,this.max_chain=s,this.func=n}function z(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=p,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new n.Buf16(2*y),this.dyn_dtree=new n.Buf16(2*(2*b+1)),this.bl_tree=new n.Buf16(2*(2*w+1)),A(this.dyn_ltree),A(this.dyn_dtree),A(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new n.Buf16(C+1),this.heap=new n.Buf16(2*v+1),A(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new n.Buf16(2*v+1),A(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function q(t){var e;return t&&t.state?(t.total_in=t.total_out=0,t.data_type=f,(e=t.state).pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?I:E,t.adler=2===e.wrap?0:1,e.last_flush=c,a._tr_init(e),h):N(t,d)}function j(t){var e,i=q(t);return i===h&&((e=t.state).window_size=2*e.w_size,A(e.head),e.max_lazy_match=s[e.level].max_lazy,e.good_match=s[e.level].good_length,e.nice_match=s[e.level].nice_length,e.max_chain_length=s[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=k-1,e.match_available=0,e.ins_h=0),i}function K(t,e,i,s,a,o){if(!t)return d;var l=1;if(e===u&&(e=6),s<0?(l=0,s=-s):15<s&&(l=2,s-=16),a<1||g<a||i!==p||s<8||15<s||e<0||9<e||o<0||m<o)return N(t,d);8===s&&(s=9);var r=new z;return(t.state=r).strm=t,r.wrap=l,r.gzhead=null,r.w_bits=s,r.w_size=1<<r.w_bits,r.w_mask=r.w_size-1,r.hash_bits=a+7,r.hash_size=1<<r.hash_bits,r.hash_mask=r.hash_size-1,r.hash_shift=~~((r.hash_bits+k-1)/k),r.window=new n.Buf8(2*r.w_size),r.head=new n.Buf16(r.hash_size),r.prev=new n.Buf16(r.w_size),r.lit_bufsize=1<<a+6,r.pending_buf_size=4*r.lit_bufsize,r.pending_buf=new n.Buf8(r.pending_buf_size),r.d_buf=1*r.lit_bufsize,r.l_buf=3*r.lit_bufsize,r.level=e,r.strategy=o,r.method=i,j(t)}s=[new W(0,0,0,0,function(t,e){var i=65535;for(i>t.pending_buf_size-5&&(i=t.pending_buf_size-5);;){if(t.lookahead<=1){if(H(t),0===t.lookahead&&e===c)return B;if(0===t.lookahead)break}t.strstart+=t.lookahead,t.lookahead=0;var s=t.block_start+i;if((0===t.strstart||t.strstart>=s)&&(t.lookahead=t.strstart-s,t.strstart=s,L(t,!1),0===t.strm.avail_out))return B;if(t.strstart-t.block_start>=t.w_size-T&&(L(t,!1),0===t.strm.avail_out))return B}return t.insert=0,e===_?(L(t,!0),0===t.strm.avail_out?P:R):(t.strstart>t.block_start&&(L(t,!1),t.strm.avail_out),B)}),new W(4,4,8,4,O),new W(4,5,16,8,O),new W(4,6,32,32,O),new W(4,4,16,16,V),new W(8,16,32,32,V),new W(8,16,128,128,V),new W(8,32,128,256,V),new W(32,128,258,1024,V),new W(32,258,258,4096,V)],i.deflateInit=function(t,e){return K(t,e,p,15,8,0)},i.deflateInit2=K,i.deflateReset=j,i.deflateResetKeep=q,i.deflateSetHeader=function(t,e){return t&&t.state?2!==t.state.wrap?d:(t.state.gzhead=e,h):d},i.deflate=function(t,e){var i,n,o,r;if(!t||!t.state||5<e||e<0)return t?N(t,d):d;if(n=t.state,!t.output||!t.input&&0!==t.avail_in||666===n.status&&e!==_)return N(t,0===t.avail_out?-5:d);if(n.strm=t,i=n.last_flush,n.last_flush=e,n.status===I)if(2===n.wrap)t.adler=0,F(n,31),F(n,139),F(n,8),n.gzhead?(F(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),F(n,255&n.gzhead.time),F(n,n.gzhead.time>>8&255),F(n,n.gzhead.time>>16&255),F(n,n.gzhead.time>>24&255),F(n,9===n.level?2:2<=n.strategy||n.level<2?4:0),F(n,255&n.gzhead.os),n.gzhead.extra&&n.gzhead.extra.length&&(F(n,255&n.gzhead.extra.length),F(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(t.adler=l(t.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=69):(F(n,0),F(n,0),F(n,0),F(n,0),F(n,0),F(n,9===n.level?2:2<=n.strategy||n.level<2?4:0),F(n,3),n.status=E);else{var u=p+(n.w_bits-8<<4)<<8;u|=(2<=n.strategy||n.level<2?0:n.level<6?1:6===n.level?2:3)<<6,0!==n.strstart&&(u|=32),u+=31-u%31,n.status=E,M(n,u),0!==n.strstart&&(M(n,t.adler>>>16),M(n,65535&t.adler)),t.adler=1}if(69===n.status)if(n.gzhead.extra){for(o=n.pending;n.gzindex<(65535&n.gzhead.extra.length)&&(n.pending!==n.pending_buf_size||(n.gzhead.hcrc&&n.pending>o&&(t.adler=l(t.adler,n.pending_buf,n.pending-o,o)),D(t),o=n.pending,n.pending!==n.pending_buf_size));)F(n,255&n.gzhead.extra[n.gzindex]),n.gzindex++;n.gzhead.hcrc&&n.pending>o&&(t.adler=l(t.adler,n.pending_buf,n.pending-o,o)),n.gzindex===n.gzhead.extra.length&&(n.gzindex=0,n.status=73)}else n.status=73;if(73===n.status)if(n.gzhead.name){o=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>o&&(t.adler=l(t.adler,n.pending_buf,n.pending-o,o)),D(t),o=n.pending,n.pending===n.pending_buf_size)){r=1;break}F(n,r=n.gzindex<n.gzhead.name.length?255&n.gzhead.name.charCodeAt(n.gzindex++):0)}while(0!==r);n.gzhead.hcrc&&n.pending>o&&(t.adler=l(t.adler,n.pending_buf,n.pending-o,o)),0===r&&(n.gzindex=0,n.status=91)}else n.status=91;if(91===n.status)if(n.gzhead.comment){o=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>o&&(t.adler=l(t.adler,n.pending_buf,n.pending-o,o)),D(t),o=n.pending,n.pending===n.pending_buf_size)){r=1;break}F(n,r=n.gzindex<n.gzhead.comment.length?255&n.gzhead.comment.charCodeAt(n.gzindex++):0)}while(0!==r);n.gzhead.hcrc&&n.pending>o&&(t.adler=l(t.adler,n.pending_buf,n.pending-o,o)),0===r&&(n.status=103)}else n.status=103;if(103===n.status&&(n.gzhead.hcrc?(n.pending+2>n.pending_buf_size&&D(t),n.pending+2<=n.pending_buf_size&&(F(n,255&t.adler),F(n,t.adler>>8&255),t.adler=0,n.status=E)):n.status=E),0!==n.pending){if(D(t),0===t.avail_out)return n.last_flush=-1,h}else if(0===t.avail_in&&U(e)<=U(i)&&e!==_)return N(t,-5);if(666===n.status&&0!==t.avail_in)return N(t,-5);if(0!==t.avail_in||0!==n.lookahead||e!==c&&666!==n.status){var m=2===n.strategy?function(t,e){for(var i;;){if(0===t.lookahead&&(H(t),0===t.lookahead)){if(e===c)return B;break}if(t.match_length=0,i=a._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,i&&(L(t,!1),0===t.strm.avail_out))return B}return t.insert=0,e===_?(L(t,!0),0===t.strm.avail_out?P:R):t.last_lit&&(L(t,!1),0===t.strm.avail_out)?B:x}(n,e):3===n.strategy?function(t,e){for(var i,s,n,o,l=t.window;;){if(t.lookahead<=S){if(H(t),t.lookahead<=S&&e===c)return B;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=k&&0<t.strstart&&(s=l[n=t.strstart-1])===l[++n]&&s===l[++n]&&s===l[++n]){o=t.strstart+S;do{}while(s===l[++n]&&s===l[++n]&&s===l[++n]&&s===l[++n]&&s===l[++n]&&s===l[++n]&&s===l[++n]&&s===l[++n]&&n<o);t.match_length=S-(o-n),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=k?(i=a._tr_tally(t,1,t.match_length-k),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(i=a._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),i&&(L(t,!1),0===t.strm.avail_out))return B}return t.insert=0,e===_?(L(t,!0),0===t.strm.avail_out?P:R):t.last_lit&&(L(t,!1),0===t.strm.avail_out)?B:x}(n,e):s[n.level].func(n,e);if(m!==P&&m!==R||(n.status=666),m===B||m===P)return 0===t.avail_out&&(n.last_flush=-1),h;if(m===x&&(1===e?a._tr_align(n):5!==e&&(a._tr_stored_block(n,0,0,!1),3===e&&(A(n.head),0===n.lookahead&&(n.strstart=0,n.block_start=0,n.insert=0))),D(t),0===t.avail_out))return n.last_flush=-1,h}return e!==_?h:n.wrap<=0?1:(2===n.wrap?(F(n,255&t.adler),F(n,t.adler>>8&255),F(n,t.adler>>16&255),F(n,t.adler>>24&255),F(n,255&t.total_in),F(n,t.total_in>>8&255),F(n,t.total_in>>16&255),F(n,t.total_in>>24&255)):(M(n,t.adler>>>16),M(n,65535&t.adler)),D(t),0<n.wrap&&(n.wrap=-n.wrap),0!==n.pending?h:1)},i.deflateEnd=function(t){var e;return t&&t.state?(e=t.state.status)!==I&&69!==e&&73!==e&&91!==e&&103!==e&&e!==E&&666!==e?N(t,d):(t.state=null,e===E?N(t,-3):h):d},i.deflateSetDictionary=function(t,e){var i,s,a,l,r,c,_,u,m=e.length;if(!t||!t.state)return d;if(2===(l=(i=t.state).wrap)||1===l&&i.status!==I||i.lookahead)return d;for(1===l&&(t.adler=o(t.adler,e,m,0)),i.wrap=0,m>=i.w_size&&(0===l&&(A(i.head),i.strstart=0,i.block_start=0,i.insert=0),u=new n.Buf8(i.w_size),n.arraySet(u,e,m-i.w_size,i.w_size,0),e=u,m=i.w_size),r=t.avail_in,c=t.next_in,_=t.input,t.avail_in=m,t.next_in=0,t.input=e,H(i);i.lookahead>=k;){for(s=i.strstart,a=i.lookahead-(k-1);i.ins_h=(i.ins_h<<i.hash_shift^i.window[s+k-1])&i.hash_mask,i.prev[s&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=s,s++,--a;);i.strstart=s,i.lookahead=k-1,H(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=k-1,i.match_available=0,t.next_in=c,t.input=_,t.avail_in=r,i.wrap=l,h},i.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":3,"./adler32":5,"./crc32":7,"./messages":13,"./trees":14}],9:[function(t,e,i){e.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],10:[function(t,e,i){e.exports=function(t,e){var i,s,n,a,o,l,r,c,_,h,d,u,m,f,p,g,v,b,w,y,C,k,S,T,I;i=t.state,s=t.next_in,T=t.input,n=s+(t.avail_in-5),a=t.next_out,I=t.output,o=a-(e-t.avail_out),l=a+(t.avail_out-257),r=i.dmax,c=i.wsize,_=i.whave,h=i.wnext,d=i.window,u=i.hold,m=i.bits,f=i.lencode,p=i.distcode,g=(1<<i.lenbits)-1,v=(1<<i.distbits)-1;t:do{m<15&&(u+=T[s++]<<m,m+=8,u+=T[s++]<<m,m+=8),b=f[u&g];e:for(;;){if(u>>>=w=b>>>24,m-=w,0==(w=b>>>16&255))I[a++]=65535&b;else{if(!(16&w)){if(0==(64&w)){b=f[(65535&b)+(u&(1<<w)-1)];continue e}if(32&w){i.mode=12;break t}t.msg="invalid literal/length code",i.mode=30;break t}y=65535&b,(w&=15)&&(m<w&&(u+=T[s++]<<m,m+=8),y+=u&(1<<w)-1,u>>>=w,m-=w),m<15&&(u+=T[s++]<<m,m+=8,u+=T[s++]<<m,m+=8),b=p[u&v];i:for(;;){if(u>>>=w=b>>>24,m-=w,!(16&(w=b>>>16&255))){if(0==(64&w)){b=p[(65535&b)+(u&(1<<w)-1)];continue i}t.msg="invalid distance code",i.mode=30;break t}if(C=65535&b,m<(w&=15)&&(u+=T[s++]<<m,(m+=8)<w&&(u+=T[s++]<<m,m+=8)),r<(C+=u&(1<<w)-1)){t.msg="invalid distance too far back",i.mode=30;break t}if(u>>>=w,m-=w,(w=a-o)<C){if(_<(w=C-w)&&i.sane){t.msg="invalid distance too far back",i.mode=30;break t}if(S=d,(k=0)===h){if(k+=c-w,w<y){for(y-=w;I[a++]=d[k++],--w;);k=a-C,S=I}}else if(h<w){if(k+=c+h-w,(w-=h)<y){for(y-=w;I[a++]=d[k++],--w;);if(k=0,h<y){for(y-=w=h;I[a++]=d[k++],--w;);k=a-C,S=I}}}else if(k+=h-w,w<y){for(y-=w;I[a++]=d[k++],--w;);k=a-C,S=I}for(;2<y;)I[a++]=S[k++],I[a++]=S[k++],I[a++]=S[k++],y-=3;y&&(I[a++]=S[k++],1<y&&(I[a++]=S[k++]))}else{for(k=a-C;I[a++]=I[k++],I[a++]=I[k++],I[a++]=I[k++],2<(y-=3););y&&(I[a++]=I[k++],1<y&&(I[a++]=I[k++]))}break}}break}}while(s<n&&a<l);s-=y=m>>3,u&=(1<<(m-=y<<3))-1,t.next_in=s,t.next_out=a,t.avail_in=s<n?n-s+5:5-(s-n),t.avail_out=a<l?l-a+257:257-(a-l),i.hold=u,i.bits=m}},{}],11:[function(t,e,i){var s=t("../utils/common"),n=t("./adler32"),a=t("./crc32"),o=t("./inffast"),l=t("./inftrees"),r=1,c=2,_=0,h=-2,d=1,u=852,m=592;function f(t){return(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24)}function p(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new s.Buf16(320),this.work=new s.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function g(t){var e;return t&&t.state?(e=t.state,t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=1&e.wrap),e.mode=d,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new s.Buf32(u),e.distcode=e.distdyn=new s.Buf32(m),e.sane=1,e.back=-1,_):h}function v(t){var e;return t&&t.state?((e=t.state).wsize=0,e.whave=0,e.wnext=0,g(t)):h}function b(t,e){var i,s;return t&&t.state?(s=t.state,e<0?(i=0,e=-e):(i=1+(e>>4),e<48&&(e&=15)),e&&(e<8||15<e)?h:(null!==s.window&&s.wbits!==e&&(s.window=null),s.wrap=i,s.wbits=e,v(t))):h}function w(t,e){var i,s;return t?(s=new p,(t.state=s).window=null,(i=b(t,e))!==_&&(t.state=null),i):h}var y,C,k=!0;function S(t){if(k){var e;for(y=new s.Buf32(512),C=new s.Buf32(32),e=0;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(l(r,t.lens,0,288,y,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;l(c,t.lens,0,32,C,0,t.work,{bits:5}),k=!1}t.lencode=y,t.lenbits=9,t.distcode=C,t.distbits=5}function T(t,e,i,n){var a,o=t.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new s.Buf8(o.wsize)),n>=o.wsize?(s.arraySet(o.window,e,i-o.wsize,o.wsize,0),o.wnext=0,o.whave=o.wsize):(n<(a=o.wsize-o.wnext)&&(a=n),s.arraySet(o.window,e,i-n,a,o.wnext),(n-=a)?(s.arraySet(o.window,e,i-n,n,0),o.wnext=n,o.whave=o.wsize):(o.wnext+=a,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=a))),0}i.inflateReset=v,i.inflateReset2=b,i.inflateResetKeep=g,i.inflateInit=function(t){return w(t,15)},i.inflateInit2=w,i.inflate=function(t,e){var i,u,m,p,g,v,b,w,y,C,k,I,E,B,x,P,R,N,U,A,D,L,F,M,G=0,H=new s.Buf8(4),O=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!t||!t.state||!t.output||!t.input&&0!==t.avail_in)return h;12===(i=t.state).mode&&(i.mode=13),g=t.next_out,m=t.output,b=t.avail_out,p=t.next_in,u=t.input,v=t.avail_in,w=i.hold,y=i.bits,C=v,k=b,L=_;t:for(;;)switch(i.mode){case d:if(0===i.wrap){i.mode=13;break}for(;y<16;){if(0===v)break t;v--,w+=u[p++]<<y,y+=8}if(2&i.wrap&&35615===w){H[i.check=0]=255&w,H[1]=w>>>8&255,i.check=a(i.check,H,2,0),y=w=0,i.mode=2;break}if(i.flags=0,i.head&&(i.head.done=!1),!(1&i.wrap)||(((255&w)<<8)+(w>>8))%31){t.msg="incorrect header check",i.mode=30;break}if(8!=(15&w)){t.msg="unknown compression method",i.mode=30;break}if(y-=4,D=8+(15&(w>>>=4)),0===i.wbits)i.wbits=D;else if(D>i.wbits){t.msg="invalid window size",i.mode=30;break}i.dmax=1<<D,t.adler=i.check=1,i.mode=512&w?10:12,y=w=0;break;case 2:for(;y<16;){if(0===v)break t;v--,w+=u[p++]<<y,y+=8}if(i.flags=w,8!=(255&i.flags)){t.msg="unknown compression method",i.mode=30;break}if(57344&i.flags){t.msg="unknown header flags set",i.mode=30;break}i.head&&(i.head.text=w>>8&1),512&i.flags&&(H[0]=255&w,H[1]=w>>>8&255,i.check=a(i.check,H,2,0)),y=w=0,i.mode=3;case 3:for(;y<32;){if(0===v)break t;v--,w+=u[p++]<<y,y+=8}i.head&&(i.head.time=w),512&i.flags&&(H[0]=255&w,H[1]=w>>>8&255,H[2]=w>>>16&255,H[3]=w>>>24&255,i.check=a(i.check,H,4,0)),y=w=0,i.mode=4;case 4:for(;y<16;){if(0===v)break t;v--,w+=u[p++]<<y,y+=8}i.head&&(i.head.xflags=255&w,i.head.os=w>>8),512&i.flags&&(H[0]=255&w,H[1]=w>>>8&255,i.check=a(i.check,H,2,0)),y=w=0,i.mode=5;case 5:if(1024&i.flags){for(;y<16;){if(0===v)break t;v--,w+=u[p++]<<y,y+=8}i.length=w,i.head&&(i.head.extra_len=w),512&i.flags&&(H[0]=255&w,H[1]=w>>>8&255,i.check=a(i.check,H,2,0)),y=w=0}else i.head&&(i.head.extra=null);i.mode=6;case 6:if(1024&i.flags&&(v<(I=i.length)&&(I=v),I&&(i.head&&(D=i.head.extra_len-i.length,i.head.extra||(i.head.extra=new Array(i.head.extra_len)),s.arraySet(i.head.extra,u,p,I,D)),512&i.flags&&(i.check=a(i.check,u,I,p)),v-=I,p+=I,i.length-=I),i.length))break t;i.length=0,i.mode=7;case 7:if(2048&i.flags){if(0===v)break t;for(I=0;D=u[p+I++],i.head&&D&&i.length<65536&&(i.head.name+=String.fromCharCode(D)),D&&I<v;);if(512&i.flags&&(i.check=a(i.check,u,I,p)),v-=I,p+=I,D)break t}else i.head&&(i.head.name=null);i.length=0,i.mode=8;case 8:if(4096&i.flags){if(0===v)break t;for(I=0;D=u[p+I++],i.head&&D&&i.length<65536&&(i.head.comment+=String.fromCharCode(D)),D&&I<v;);if(512&i.flags&&(i.check=a(i.check,u,I,p)),v-=I,p+=I,D)break t}else i.head&&(i.head.comment=null);i.mode=9;case 9:if(512&i.flags){for(;y<16;){if(0===v)break t;v--,w+=u[p++]<<y,y+=8}if(w!==(65535&i.check)){t.msg="header crc mismatch",i.mode=30;break}y=w=0}i.head&&(i.head.hcrc=i.flags>>9&1,i.head.done=!0),t.adler=i.check=0,i.mode=12;break;case 10:for(;y<32;){if(0===v)break t;v--,w+=u[p++]<<y,y+=8}t.adler=i.check=f(w),y=w=0,i.mode=11;case 11:if(0===i.havedict)return t.next_out=g,t.avail_out=b,t.next_in=p,t.avail_in=v,i.hold=w,i.bits=y,2;t.adler=i.check=1,i.mode=12;case 12:if(5===e||6===e)break t;case 13:if(i.last){w>>>=7&y,y-=7&y,i.mode=27;break}for(;y<3;){if(0===v)break t;v--,w+=u[p++]<<y,y+=8}switch(i.last=1&w,y-=1,3&(w>>>=1)){case 0:i.mode=14;break;case 1:if(S(i),i.mode=20,6!==e)break;w>>>=2,y-=2;break t;case 2:i.mode=17;break;case 3:t.msg="invalid block type",i.mode=30}w>>>=2,y-=2;break;case 14:for(w>>>=7&y,y-=7&y;y<32;){if(0===v)break t;v--,w+=u[p++]<<y,y+=8}if((65535&w)!=(w>>>16^65535)){t.msg="invalid stored block lengths",i.mode=30;break}if(i.length=65535&w,y=w=0,i.mode=15,6===e)break t;case 15:i.mode=16;case 16:if(I=i.length){if(v<I&&(I=v),b<I&&(I=b),0===I)break t;s.arraySet(m,u,p,I,g),v-=I,p+=I,b-=I,g+=I,i.length-=I;break}i.mode=12;break;case 17:for(;y<14;){if(0===v)break t;v--,w+=u[p++]<<y,y+=8}if(i.nlen=257+(31&w),w>>>=5,y-=5,i.ndist=1+(31&w),w>>>=5,y-=5,i.ncode=4+(15&w),w>>>=4,y-=4,286<i.nlen||30<i.ndist){t.msg="too many length or distance symbols",i.mode=30;break}i.have=0,i.mode=18;case 18:for(;i.have<i.ncode;){for(;y<3;){if(0===v)break t;v--,w+=u[p++]<<y,y+=8}i.lens[O[i.have++]]=7&w,w>>>=3,y-=3}for(;i.have<19;)i.lens[O[i.have++]]=0;if(i.lencode=i.lendyn,i.lenbits=7,F={bits:i.lenbits},L=l(0,i.lens,0,19,i.lencode,0,i.work,F),i.lenbits=F.bits,L){t.msg="invalid code lengths set",i.mode=30;break}i.have=0,i.mode=19;case 19:for(;i.have<i.nlen+i.ndist;){for(;P=(G=i.lencode[w&(1<<i.lenbits)-1])>>>16&255,R=65535&G,!((x=G>>>24)<=y);){if(0===v)break t;v--,w+=u[p++]<<y,y+=8}if(R<16)w>>>=x,y-=x,i.lens[i.have++]=R;else{if(16===R){for(M=x+2;y<M;){if(0===v)break t;v--,w+=u[p++]<<y,y+=8}if(w>>>=x,y-=x,0===i.have){t.msg="invalid bit length repeat",i.mode=30;break}D=i.lens[i.have-1],I=3+(3&w),w>>>=2,y-=2}else if(17===R){for(M=x+3;y<M;){if(0===v)break t;v--,w+=u[p++]<<y,y+=8}y-=x,D=0,I=3+(7&(w>>>=x)),w>>>=3,y-=3}else{for(M=x+7;y<M;){if(0===v)break t;v--,w+=u[p++]<<y,y+=8}y-=x,D=0,I=11+(127&(w>>>=x)),w>>>=7,y-=7}if(i.have+I>i.nlen+i.ndist){t.msg="invalid bit length repeat",i.mode=30;break}for(;I--;)i.lens[i.have++]=D}}if(30===i.mode)break;if(0===i.lens[256]){t.msg="invalid code -- missing end-of-block",i.mode=30;break}if(i.lenbits=9,F={bits:i.lenbits},L=l(r,i.lens,0,i.nlen,i.lencode,0,i.work,F),i.lenbits=F.bits,L){t.msg="invalid literal/lengths set",i.mode=30;break}if(i.distbits=6,i.distcode=i.distdyn,F={bits:i.distbits},L=l(c,i.lens,i.nlen,i.ndist,i.distcode,0,i.work,F),i.distbits=F.bits,L){t.msg="invalid distances set",i.mode=30;break}if(i.mode=20,6===e)break t;case 20:i.mode=21;case 21:if(6<=v&&258<=b){t.next_out=g,t.avail_out=b,t.next_in=p,t.avail_in=v,i.hold=w,i.bits=y,o(t,k),g=t.next_out,m=t.output,b=t.avail_out,p=t.next_in,u=t.input,v=t.avail_in,w=i.hold,y=i.bits,12===i.mode&&(i.back=-1);break}for(i.back=0;P=(G=i.lencode[w&(1<<i.lenbits)-1])>>>16&255,R=65535&G,!((x=G>>>24)<=y);){if(0===v)break t;v--,w+=u[p++]<<y,y+=8}if(P&&0==(240&P)){for(N=x,U=P,A=R;P=(G=i.lencode[A+((w&(1<<N+U)-1)>>N)])>>>16&255,R=65535&G,!(N+(x=G>>>24)<=y);){if(0===v)break t;v--,w+=u[p++]<<y,y+=8}w>>>=N,y-=N,i.back+=N}if(w>>>=x,y-=x,i.back+=x,i.length=R,0===P){i.mode=26;break}if(32&P){i.back=-1,i.mode=12;break}if(64&P){t.msg="invalid literal/length code",i.mode=30;break}i.extra=15&P,i.mode=22;case 22:if(i.extra){for(M=i.extra;y<M;){if(0===v)break t;v--,w+=u[p++]<<y,y+=8}i.length+=w&(1<<i.extra)-1,w>>>=i.extra,y-=i.extra,i.back+=i.extra}i.was=i.length,i.mode=23;case 23:for(;P=(G=i.distcode[w&(1<<i.distbits)-1])>>>16&255,R=65535&G,!((x=G>>>24)<=y);){if(0===v)break t;v--,w+=u[p++]<<y,y+=8}if(0==(240&P)){for(N=x,U=P,A=R;P=(G=i.distcode[A+((w&(1<<N+U)-1)>>N)])>>>16&255,R=65535&G,!(N+(x=G>>>24)<=y);){if(0===v)break t;v--,w+=u[p++]<<y,y+=8}w>>>=N,y-=N,i.back+=N}if(w>>>=x,y-=x,i.back+=x,64&P){t.msg="invalid distance code",i.mode=30;break}i.offset=R,i.extra=15&P,i.mode=24;case 24:if(i.extra){for(M=i.extra;y<M;){if(0===v)break t;v--,w+=u[p++]<<y,y+=8}i.offset+=w&(1<<i.extra)-1,w>>>=i.extra,y-=i.extra,i.back+=i.extra}if(i.offset>i.dmax){t.msg="invalid distance too far back",i.mode=30;break}i.mode=25;case 25:if(0===b)break t;if(I=k-b,i.offset>I){if((I=i.offset-I)>i.whave&&i.sane){t.msg="invalid distance too far back",i.mode=30;break}E=I>i.wnext?(I-=i.wnext,i.wsize-I):i.wnext-I,I>i.length&&(I=i.length),B=i.window}else B=m,E=g-i.offset,I=i.length;for(b<I&&(I=b),b-=I,i.length-=I;m[g++]=B[E++],--I;);0===i.length&&(i.mode=21);break;case 26:if(0===b)break t;m[g++]=i.length,b--,i.mode=21;break;case 27:if(i.wrap){for(;y<32;){if(0===v)break t;v--,w|=u[p++]<<y,y+=8}if(k-=b,t.total_out+=k,i.total+=k,k&&(t.adler=i.check=i.flags?a(i.check,m,k,g-k):n(i.check,m,k,g-k)),k=b,(i.flags?w:f(w))!==i.check){t.msg="incorrect data check",i.mode=30;break}y=w=0}i.mode=28;case 28:if(i.wrap&&i.flags){for(;y<32;){if(0===v)break t;v--,w+=u[p++]<<y,y+=8}if(w!==(4294967295&i.total)){t.msg="incorrect length check",i.mode=30;break}y=w=0}i.mode=29;case 29:L=1;break t;case 30:L=-3;break t;case 31:return-4;case 32:default:return h}return t.next_out=g,t.avail_out=b,t.next_in=p,t.avail_in=v,i.hold=w,i.bits=y,(i.wsize||k!==t.avail_out&&i.mode<30&&(i.mode<27||4!==e))&&T(t,t.output,t.next_out,k-t.avail_out)?(i.mode=31,-4):(C-=t.avail_in,k-=t.avail_out,t.total_in+=C,t.total_out+=k,i.total+=k,i.wrap&&k&&(t.adler=i.check=i.flags?a(i.check,m,k,t.next_out-k):n(i.check,m,k,t.next_out-k)),t.data_type=i.bits+(i.last?64:0)+(12===i.mode?128:0)+(20===i.mode||15===i.mode?256:0),(0===C&&0===k||4===e)&&L===_&&(L=-5),L)},i.inflateEnd=function(t){if(!t||!t.state)return h;var e=t.state;return e.window&&(e.window=null),t.state=null,_},i.inflateGetHeader=function(t,e){var i;return t&&t.state?0==(2&(i=t.state).wrap)?h:((i.head=e).done=!1,_):h},i.inflateSetDictionary=function(t,e){var i,s=e.length;return t&&t.state?0!==(i=t.state).wrap&&11!==i.mode?h:11===i.mode&&n(1,e,s,0)!==i.check?-3:T(t,e,s,s)?(i.mode=31,-4):(i.havedict=1,_):h},i.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":3,"./adler32":5,"./crc32":7,"./inffast":10,"./inftrees":12}],12:[function(t,e,i){var s=t("../utils/common"),n=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],a=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],o=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],l=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];e.exports=function(t,e,i,r,c,_,h,d){var u,m,f,p,g,v,b,w,y,C=d.bits,k=0,S=0,T=0,I=0,E=0,B=0,x=0,P=0,R=0,N=0,U=null,A=0,D=new s.Buf16(16),L=new s.Buf16(16),F=null,M=0;for(k=0;k<=15;k++)D[k]=0;for(S=0;S<r;S++)D[e[i+S]]++;for(E=C,I=15;1<=I&&0===D[I];I--);if(I<E&&(E=I),0===I)return c[_++]=20971520,c[_++]=20971520,d.bits=1,0;for(T=1;T<I&&0===D[T];T++);for(E<T&&(E=T),k=P=1;k<=15;k++)if(P<<=1,(P-=D[k])<0)return-1;if(0<P&&(0===t||1!==I))return-1;for(L[1]=0,k=1;k<15;k++)L[k+1]=L[k]+D[k];for(S=0;S<r;S++)0!==e[i+S]&&(h[L[e[i+S]]++]=S);if(v=0===t?(U=F=h,19):1===t?(U=n,A-=257,F=a,M-=257,256):(U=o,F=l,-1),k=T,g=_,x=S=N=0,f=-1,p=(R=1<<(B=E))-1,1===t&&852<R||2===t&&592<R)return 1;for(;;){for(b=k-x,y=h[S]<v?(w=0,h[S]):h[S]>v?(w=F[M+h[S]],U[A+h[S]]):(w=96,0),u=1<<k-x,T=m=1<<B;c[g+(N>>x)+(m-=u)]=b<<24|w<<16|y|0,0!==m;);for(u=1<<k-1;N&u;)u>>=1;if(0!==u?(N&=u-1,N+=u):N=0,S++,0==--D[k]){if(k===I)break;k=e[i+h[S]]}if(E<k&&(N&p)!==f){for(0===x&&(x=E),g+=T,P=1<<(B=k-x);B+x<I&&!((P-=D[B+x])<=0);)B++,P<<=1;if(R+=1<<B,1===t&&852<R||2===t&&592<R)return 1;c[f=N&p]=E<<24|B<<16|g-_|0}}return 0!==N&&(c[g+N]=k-x<<24|64<<16|0),d.bits=E,0}},{"../utils/common":3}],13:[function(t,e,i){e.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],14:[function(t,e,i){var s=t("../utils/common");function n(t){for(var e=t.length;0<=--e;)t[e]=0}var a=0,o=256,l=o+1+29,r=30,c=19,_=2*l+1,h=15,d=16,u=256,m=16,f=17,p=18,g=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],v=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],b=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],w=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],y=new Array(2*(l+2));n(y);var C=new Array(2*r);n(C);var k=new Array(512);n(k);var S=new Array(256);n(S);var T=new Array(29);n(T);var I,E,B,x=new Array(r);function P(t,e,i,s,n){this.static_tree=t,this.extra_bits=e,this.extra_base=i,this.elems=s,this.max_length=n,this.has_stree=t&&t.length}function R(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}function N(t){return t<256?k[t]:k[256+(t>>>7)]}function U(t,e){t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255}function A(t,e,i){t.bi_valid>d-i?(t.bi_buf|=e<<t.bi_valid&65535,U(t,t.bi_buf),t.bi_buf=e>>d-t.bi_valid,t.bi_valid+=i-d):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=i)}function D(t,e,i){A(t,i[2*e],i[2*e+1])}function L(t,e){for(var i=0;i|=1&t,t>>>=1,i<<=1,0<--e;);return i>>>1}function F(t,e,i){var s,n,a=new Array(h+1),o=0;for(s=1;s<=h;s++)a[s]=o=o+i[s-1]<<1;for(n=0;n<=e;n++){var l=t[2*n+1];0!==l&&(t[2*n]=L(a[l]++,l))}}function M(t){var e;for(e=0;e<l;e++)t.dyn_ltree[2*e]=0;for(e=0;e<r;e++)t.dyn_dtree[2*e]=0;for(e=0;e<c;e++)t.bl_tree[2*e]=0;t.dyn_ltree[2*u]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0}function G(t){8<t.bi_valid?U(t,t.bi_buf):0<t.bi_valid&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0}function H(t,e,i,s){var n=2*e,a=2*i;return t[n]<t[a]||t[n]===t[a]&&s[e]<=s[i]}function O(t,e,i){for(var s=t.heap[i],n=i<<1;n<=t.heap_len&&(n<t.heap_len&&H(e,t.heap[n+1],t.heap[n],t.depth)&&n++,!H(e,s,t.heap[n],t.depth));)t.heap[i]=t.heap[n],i=n,n<<=1;t.heap[i]=s}function V(t,e,i){var s,n,a,l,r=0;if(0!==t.last_lit)for(;s=t.pending_buf[t.d_buf+2*r]<<8|t.pending_buf[t.d_buf+2*r+1],n=t.pending_buf[t.l_buf+r],r++,0===s?D(t,n,e):(D(t,(a=S[n])+o+1,e),0!==(l=g[a])&&A(t,n-=T[a],l),D(t,a=N(--s),i),0!==(l=v[a])&&A(t,s-=x[a],l)),r<t.last_lit;);D(t,u,e)}function W(t,e){var i,s,n,a=e.dyn_tree,o=e.stat_desc.static_tree,l=e.stat_desc.has_stree,r=e.stat_desc.elems,c=-1;for(t.heap_len=0,t.heap_max=_,i=0;i<r;i++)0!==a[2*i]?(t.heap[++t.heap_len]=c=i,t.depth[i]=0):a[2*i+1]=0;for(;t.heap_len<2;)a[2*(n=t.heap[++t.heap_len]=c<2?++c:0)]=1,t.depth[n]=0,t.opt_len--,l&&(t.static_len-=o[2*n+1]);for(e.max_code=c,i=t.heap_len>>1;1<=i;i--)O(t,a,i);for(n=r;i=t.heap[1],t.heap[1]=t.heap[t.heap_len--],O(t,a,1),s=t.heap[1],t.heap[--t.heap_max]=i,t.heap[--t.heap_max]=s,a[2*n]=a[2*i]+a[2*s],t.depth[n]=(t.depth[i]>=t.depth[s]?t.depth[i]:t.depth[s])+1,a[2*i+1]=a[2*s+1]=n,t.heap[1]=n++,O(t,a,1),2<=t.heap_len;);t.heap[--t.heap_max]=t.heap[1],function(t,e){var i,s,n,a,o,l,r=e.dyn_tree,c=e.max_code,d=e.stat_desc.static_tree,u=e.stat_desc.has_stree,m=e.stat_desc.extra_bits,f=e.stat_desc.extra_base,p=e.stat_desc.max_length,g=0;for(a=0;a<=h;a++)t.bl_count[a]=0;for(r[2*t.heap[t.heap_max]+1]=0,i=t.heap_max+1;i<_;i++)p<(a=r[2*r[2*(s=t.heap[i])+1]+1]+1)&&(a=p,g++),r[2*s+1]=a,c<s||(t.bl_count[a]++,o=0,f<=s&&(o=m[s-f]),l=r[2*s],t.opt_len+=l*(a+o),u&&(t.static_len+=l*(d[2*s+1]+o)));if(0!==g){do{for(a=p-1;0===t.bl_count[a];)a--;t.bl_count[a]--,t.bl_count[a+1]+=2,t.bl_count[p]--,g-=2}while(0<g);for(a=p;0!==a;a--)for(s=t.bl_count[a];0!==s;)c<(n=t.heap[--i])||(r[2*n+1]!==a&&(t.opt_len+=(a-r[2*n+1])*r[2*n],r[2*n+1]=a),s--)}}(t,e),F(a,c,t.bl_count)}function z(t,e,i){var s,n,a=-1,o=e[1],l=0,r=7,c=4;for(0===o&&(r=138,c=3),e[2*(i+1)+1]=65535,s=0;s<=i;s++)n=o,o=e[2*(s+1)+1],++l<r&&n===o||(l<c?t.bl_tree[2*n]+=l:0!==n?(n!==a&&t.bl_tree[2*n]++,t.bl_tree[2*m]++):l<=10?t.bl_tree[2*f]++:t.bl_tree[2*p]++,a=n,c=(l=0)===o?(r=138,3):n===o?(r=6,3):(r=7,4))}function q(t,e,i){var s,n,a=-1,o=e[1],l=0,r=7,c=4;for(0===o&&(r=138,c=3),s=0;s<=i;s++)if(n=o,o=e[2*(s+1)+1],!(++l<r&&n===o)){if(l<c)for(;D(t,n,t.bl_tree),0!=--l;);else 0!==n?(n!==a&&(D(t,n,t.bl_tree),l--),D(t,m,t.bl_tree),A(t,l-3,2)):l<=10?(D(t,f,t.bl_tree),A(t,l-3,3)):(D(t,p,t.bl_tree),A(t,l-11,7));a=n,c=(l=0)===o?(r=138,3):n===o?(r=6,3):(r=7,4)}}n(x);var j=!1;function K(t,e,i,n){var o,l,r;A(t,(a<<1)+(n?1:0),3),l=e,r=i,G(o=t),U(o,r),U(o,~r),s.arraySet(o.pending_buf,o.window,l,r,o.pending),o.pending+=r}i._tr_init=function(t){j||(function(){var t,e,i,s,n,a=new Array(h+1);for(s=i=0;s<28;s++)for(T[s]=i,t=0;t<1<<g[s];t++)S[i++]=s;for(S[i-1]=s,s=n=0;s<16;s++)for(x[s]=n,t=0;t<1<<v[s];t++)k[n++]=s;for(n>>=7;s<r;s++)for(x[s]=n<<7,t=0;t<1<<v[s]-7;t++)k[256+n++]=s;for(e=0;e<=h;e++)a[e]=0;for(t=0;t<=143;)y[2*t+1]=8,t++,a[8]++;for(;t<=255;)y[2*t+1]=9,t++,a[9]++;for(;t<=279;)y[2*t+1]=7,t++,a[7]++;for(;t<=287;)y[2*t+1]=8,t++,a[8]++;for(F(y,l+1,a),t=0;t<r;t++)C[2*t+1]=5,C[2*t]=L(t,5);I=new P(y,g,o+1,l,h),E=new P(C,v,0,r,h),B=new P(new Array(0),b,0,c,7)}(),j=!0),t.l_desc=new R(t.dyn_ltree,I),t.d_desc=new R(t.dyn_dtree,E),t.bl_desc=new R(t.bl_tree,B),t.bi_buf=0,t.bi_valid=0,M(t)},i._tr_stored_block=K,i._tr_flush_block=function(t,e,i,s){var n,a,l=0;0<t.level?(2===t.strm.data_type&&(t.strm.data_type=function(t){var e,i=4093624447;for(e=0;e<=31;e++,i>>>=1)if(1&i&&0!==t.dyn_ltree[2*e])return 0;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return 1;for(e=32;e<o;e++)if(0!==t.dyn_ltree[2*e])return 1;return 0}(t)),W(t,t.l_desc),W(t,t.d_desc),l=function(t){var e;for(z(t,t.dyn_ltree,t.l_desc.max_code),z(t,t.dyn_dtree,t.d_desc.max_code),W(t,t.bl_desc),e=c-1;3<=e&&0===t.bl_tree[2*w[e]+1];e--);return t.opt_len+=3*(e+1)+5+5+4,e}(t),n=t.opt_len+3+7>>>3,(a=t.static_len+3+7>>>3)<=n&&(n=a)):n=a=i+5,i+4<=n&&-1!==e?K(t,e,i,s):4===t.strategy||a===n?(A(t,2+(s?1:0),3),V(t,y,C)):(A(t,4+(s?1:0),3),function(t,e,i,s){var n;for(A(t,e-257,5),A(t,i-1,5),A(t,s-4,4),n=0;n<s;n++)A(t,t.bl_tree[2*w[n]+1],3);q(t,t.dyn_ltree,e-1),q(t,t.dyn_dtree,i-1)}(t,t.l_desc.max_code+1,t.d_desc.max_code+1,l+1),V(t,t.dyn_ltree,t.dyn_dtree)),M(t),s&&G(t)},i._tr_tally=function(t,e,i){return t.pending_buf[t.d_buf+2*t.last_lit]=e>>>8&255,t.pending_buf[t.d_buf+2*t.last_lit+1]=255&e,t.pending_buf[t.l_buf+t.last_lit]=255&i,t.last_lit++,0===e?t.dyn_ltree[2*i]++:(t.matches++,e--,t.dyn_ltree[2*(S[i]+o+1)]++,t.dyn_dtree[2*N(e)]++),t.last_lit===t.lit_bufsize-1},i._tr_align=function(t){var e;A(t,2,3),D(t,u,y),16===(e=t).bi_valid?(U(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):8<=e.bi_valid&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}},{"../utils/common":3}],15:[function(t,e,i){e.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],"/":[function(t,e,i){var s={};(0,t("./lib/utils/common").assign)(s,t("./lib/deflate"),t("./lib/inflate"),t("./lib/zlib/constants")),e.exports=s},{"./lib/deflate":1,"./lib/inflate":2,"./lib/utils/common":3,"./lib/zlib/constants":6}]},{},[])("/")}),cc._RF.pop()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],partner_calculate:[function(t,e,i){"use strict";cc._RF.push(e,"0e4e4uKnNtKT4JEgjcu+ZGC","partner_calculate");var s={isEquipAttr:function(t){return"atk2"==t||"def2"==t||"hp2"==t||"speed2"==t||"hit_rate2"==t||"crit_rate2"==t||"hit_magic2"==t||"dodge_magic2"==t||"crit_ratio2"==t},isShowPer:function(t){var e=gdata("attr_data","data_id_to_key",[t]),i=gdata("attr_data","data_type",[e]);return!(!i||2!=i)},isShowPerByStr:function(t){var e=gdata("attr_data","data_type",[t]);return!(!e||2!=e)},calculatePower:function(t){var e=0;if(null==t||0==Utils.getArrLen(t))return e;var i=null,s=null;for(var n in t){var a=t[n];a instanceof Array&&a.length>=2?(i=a[0],s=a[1]):(i=n,s=a);var o=Config.attr_data.data_power[i];o&&(e+=s*o*.001)}return Math.ceil(e)}};e.exports=s,cc._RF.pop()},{}],partner_comment_window:[function(t,e,i){"use strict";cc._RF.push(e,"f684bjSyTxMh6OQXOVhoUqi","partner_comment_window");var s=t("pathtool"),n=t("pokedex_controller"),a=t("pokedex_event"),o=t("pokedex_comment_item"),l=t("common_scrollview");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("pokedex","pokedex_comment"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Full,this.ctrl=n.getInstance()},initConfig:function(){},openCallBack:function(){this.main_panel=this.root_wnd.getChildByName("main_panel"),this.like_btn=this.main_panel.getChildByName("like_btn"),this.send_btn=this.main_panel.getChildByName("send_btn"),this.like_num_lb=this.seekChild("like_num",cc.Label),this.comment_num_lb=this.seekChild("comment_lab",cc.Label),this.edit_box_eb=this.seekChild("edit_box",cc.EditBox),this.hero_name_lb=this.seekChild("name_lab",cc.Label),this.close_btn_nd=this.seekChild("close_btn")},registerEvent:function(){var t=this;t.get_list_event||(t.get_list_event=this.addGlobalEvent(a.Comment_List_Event,function(e){t.data=e,t.updateCommentList()})),t.comment_success_event||(t.comment_success_event=this.addGlobalEvent(a.Comment_Say_Event,function(){t.ctrl.sender11041(t.hero_data.bid,1,100),t.edit_box_eb.string=""})),t.like_success_event||(t.like_success_event=this.addGlobalEvent(a.Comment_Like_Event,function(){if(t.data){var e=t.data.like_num||0;this.like_num_lb.string=e+1,t.like_btn.active=!1}})),t.zan_success_event||(t.zan_success_event=this.addGlobalEvent(a.Comment_Zan_Event,function(e){t.select_item&&t.select_item.updateCommentNum(e),t.select_item=null})),this.send_btn.on("touchend",function(){this.hero_data&&(Utils.playButtonSound(1),this.edit_box_eb.string.length<=0?message("\u8bf7\u8f93\u5165\u8bc4\u8bba\u5185\u5bb9"):t.ctrl.sender11043(t.hero_data.bid,this.edit_box_eb.string))},this),t.like_btn.on("touchend",function(){Utils.playButtonSound(3),t.data&&t.data.like&&1==t.data.like?message("\u4f60\u5df2\u8bbe\u7f6e\u4e3a\u559c\u6b22"):t.hero_data&&t.ctrl.sender11042(t.hero_data.bid)},this),t.close_btn_nd.on("touchend",function(){Utils.playButtonSound(2),this.ctrl.openCommentWindow(!1)},this)},openRootWnd:function(t){t&&(this.hero_data=t||{},this.hero_name_lb.string=this.hero_data.name,this.createHeroMessage(),this.ctrl.sender11041(this.hero_data.bid,1,100))},createHeroMessage:function(){this.hero_item=ItemsPool.getInstance().getItem("hero_exhibition_item"),this.hero_item.setParent(this.main_panel),this.hero_item.setPosition(85,740),this.hero_item.setData(this.hero_data),this.hero_item.show()},updateCommentList:function(){var t=this;if(t.data){var e=t.data.like_num||0;if(t.like_num_lb.string=e,t.data.partner_comments){var i=t.data.partner_comments.length||0;t.comment_num_lb.string="\u8bc4\u8bba\u6570\uff1a"+i}var s=!0;t.data.like&&1==t.data.like&&(s=!1),t.like_btn.active=s;var n=cc.size(620,560),a={item_class:o,start_x:4,space_x:0,start_y:0,space_y:5,item_width:610,item_height:150,row:1,col:1,need_dynamic:!0};t.list_view=new l,t.list_view.createScroll(t.main_panel,cc.v2(13,95),ScrollViewDir.vertical,ScrollViewStartPos.top,n,a);var r=t.data.partner_comments||[];t.list_view.setData(r,function(e,i,s){if(i&&Utils.next(i)){t.select_item=e;var n=t.hero_data.bid||0,a=i.comment_id||0;t.ctrl.sender11044(n,a,s)}})}},addCallBack:function(t){this.call_fun=t},closeCallBack:function(){this.call_fun&&this.call_fun(),this.hero_item&&this.hero_item.deleteMe(),this.ctrl.openCommentWindow(!1)}});cc._RF.pop()},{common_scrollview:"common_scrollview",pathtool:"pathtool",pokedex_comment_item:"pokedex_comment_item",pokedex_controller:"pokedex_controller",pokedex_event:"pokedex_event"}],partner_const:[function(t,e,i){"use strict";var s,n,a,o,l,r,c,_,h,d,u,m,f,p,g,v;function b(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}cc._RF.push(e,"69de96M7FxHR6lmeb6BzFko","partner_const");var w={Type:{Message:1,Break:2,Skill:3,Star:4,StarLife:5},Form_Type:{Pos:1,Learn:2,Help:3,Other:4},Item_Create_Form_Type:{ItemCreateReset:1,ItemCreateOther:99},Artifact_Type:{Compose:1,Recast:2,Resolve:3,Cloth:4,Getoff:5,Replace:6,Upstar:7,Source:8},Fun_Form:{Drama:0,Arena:1,GuildDun_AD:4,ArenaChampion:6,EndLess:7,GodBattle:8,Ladder:9,Expedit_Fight:10,Startower:17,LimitExercise:21},Red_Point_Type:{Level:1,Star:2,Skill:3,Equip:4,Artifact:5,Form:6,Equip_make:7,Gemstone:8},Vo_Red_Type:{Level:1,Skill:2,Star:3,Equip:4,Artifact:5,EequipJing:6,EquipMake:7,Gemstone:8,Break:9}};w.Hero_Type=(b(s={},0,"\u5168\u90e8"),b(s,1,"\u63a7\u5236"),b(s,2,"\u6cd5\u653b"),b(s,3,"\u7269\u653b"),b(s,4,"\u8089\u76fe"),b(s,5,"\u8f85\u52a9"),s),w.EqmTips={normal:0,backpack:1,partner:2,other:3},w.ArtifactTips={normal:0,backpack:1,partner:2},w.FormCount=5,w.OpenType={Jie:1,Level:2,Star:3,Skill:4,Equip:5,Awake:6},w.SubType={Halo:1,EquipBag:2,AritfactBag:3,ArtifactMake:4,ArtifactSummon:5},w.starPos=(b(n={},1,{x:34,y:391}),b(n,2,{x:118,y:366}),b(n,3,{x:212,y:416}),b(n,4,{x:294,y:365}),b(n,5,{x:234,y:312}),b(n,6,{x:308,y:255}),b(n,7,{x:208,y:202}),b(n,8,{x:140,y:275}),b(n,9,{x:38,y:262}),b(n,10,{x:105,y:204}),n),w.linePos=(b(a={},1,{x:53,y:421,rota:20}),b(a,2,{x:150,y:394,rota:-25}),b(a,3,{x:238,y:432,rota:23}),b(a,4,{x:262,y:324,rota:-40}),b(a,5,{x:257,y:330,rota:45}),b(a,6,{x:246,y:236,rota:-25}),b(a,7,{x:166,y:290,rota:43}),b(a,8,{x:70,y:280,rota:-7}),b(a,9,{x:66,y:278,rota:45}),a),w.AttrIconPos=(b(o={},1,{x:37,y:31}),b(o,2,{x:109,y:83}),b(o,3,{x:150,y:156}),b(o,4,{x:0,y:0}),o),w.awakePos=(b(l={},1,{x:175,y:454}),b(l,2,{x:245,y:426}),b(l,3,{x:267,y:361}),b(l,4,{x:244,y:295}),b(l,5,{x:176,y:267}),b(l,6,{x:109,y:293}),b(l,7,{x:82,y:361}),b(l,8,{x:108,y:429}),l),w.StarPos=(b(d={},1,b({},1,{x:52,y:87})),b(d,2,(b(r={},1,{x:34,y:87}),b(r,2,{x:70,y:87}),r)),b(d,3,(b(c={},1,{x:50,y:100}),b(c,2,{x:33,y:73}),b(c,3,{x:70,y:73}),c)),b(d,4,(b(_={},1,{x:34,y:104}),b(_,2,{x:70,y:104}),b(_,3,{x:33,y:73}),b(_,4,{x:70,y:73}),_)),b(d,5,(b(h={},1,{x:35,y:104}),b(h,2,{x:65,y:104}),b(h,3,{x:23,y:74}),b(h,4,{x:52,y:72}),b(h,5,{x:81,y:72}),h)),d),w.EquipSellAttrType=(b(u={},1,1),b(u,2,101),b(u,3,104),b(u,4,107),b(u,5,106),b(u,6,118),b(u,7,119),b(u,8,120),b(u,9,113),b(u,10,114),b(u,11,115),b(u,12,116),u),w.EquipSellAttrTypeII=(b(m={},1,1),b(m,101,2),b(m,104,3),b(m,107,4),b(m,106,5),b(m,118,6),b(m,119,7),b(m,120,8),b(m,113,9),b(m,114,10),b(m,115,11),b(m,116,12),m),w.EquipSellAttrTypeIII=(b(f={},1,1),b(f,2,104),b(f,3,101),b(f,4,107),b(f,5,113),b(f,6,115),b(f,7,106),b(f,8,120),b(f,9,118),b(f,10,119),b(f,11,114),b(f,12,116),f),w.EqmPosByType=(b(p={},1,4),b(p,2,3),b(p,3,5),b(p,4,1),b(p,5,6),b(p,6,2),p),w.Eqm_posII=(b(g={},1,1),b(g,2,6),b(g,3,2),b(g,4,4),b(g,5,3),b(g,6,5),g),w.getSkillDesc=function(t){return 2==t?Utils.TI18N("\u4e2d\u7ea7"):3==t?Utils.TI18N("\u9ad8\u7ea7"):4==t?Utils.TI18N("\u7279\u7ea7"):5==t?Utils.TI18N("\u795e\u7ea7"):Utils.TI18N("\u4f4e\u7ea7")},w.Reset={ResetType:1,DisbandType:2},w.SkillColor=(b(v={},1,new cc.Color(104,69,42,255)),b(v,2,new cc.Color(58,120,196,255)),b(v,3,new cc.Color(179,88,0,255)),b(v,4,new cc.Color(168,56,179,255)),b(v,5,new cc.Color(226,135,0,255)),b(v,6,new cc.Color(217,80,20,255)),v),e.exports=w,cc._RF.pop()},{}],partner_event:[function(t,e,i){"use strict";cc._RF.push(e,"f0e4cExGCxBV6GYrw6ZEkSN","partner_event");var s={Partner_Data_Update:"PartnerEvent.Partner_Data_Update",Partner_Power_Event:"PartnerEvent.Partner_Power_Event",Partner_Call_Event:"PartnerEvent.Partner_Call_Event",Level_Red_Point:"PartnerEvent.Level_Red_Point",Skill_Learn_Success:"PartnerEvent.Skill_Learn_Success",Partner_Lev_Event:"PartnerEvent.Partner_Lev_Event",Level_Panel_Close:"PartnerEvent.Level_Panel_Close",Form_List_Event:"PartnerEvent.Form_List_Event",Form_Pos_Update:"PartnerEvent.Form_Pos_Update",Use_Form_Success:"PartnerEvent.Use_Form_Success",Form_Level_Event:"PartnerEvent.Form_Level_Event",Form_Help_Select:"PartnerEvent.Form_Help_Select",Form_Help_Data:"PartnerEvent.Form_Help_Data",Form_UnLock_Data:"PartnerEvent.Form_UnLock_Data",Form_Lev_Event:"PartnerEvent.Form_Lev_Event",Form_Help_Red:"PartnerEvent.Form_Help_Red",Update_Fun_Form:"PartnerEvent.Update_Fun_Form",Equip_Update_Event:"PartnerEvent.Equip_Update_Event",Jing_Event:"PartnerEvent.Jing_Event",Artifact_Update_Event:"PartnerEvent.Artifact_Update_Event",Artifact_UpStar_Event:"PartnerEvent.Artifact_UpStar_Event",Artifact_Recast_Event:"PartnerEvent.Artifact_Recast_Event",Artifact_Save_Event:"PartnerEvent.Artifact_Save_Event",Artifact_Select_Event:"PartnerEvent.Artifact_Select_Event",Partner_Treasure_LevelUp:"PartnerEvent.Partner_Treasure_LevelUp",Partner_Treasure_JieUp:"PartnerEvent.Partner_Treasure_JieUp",Partner_Treasure_SkillUp:"PartnerEvent.Partner_Treasure_SkillUp",Partner_Chips_Change:"PartnerEvent.Partner_Chips_Change",Update_Partner_Equip_Attr:"PartnerEvent.Update_Partner_Equip_Attr",Update_Partner_Equip:"PartnerEvent.Update_Partner_Equip",Save_Form_event:"PartnerEvent.Save_Form_event",Save_Sell_equip:"PartnerEvent.Save_Sell_equip",Red_point_Event:"PartnerEvent.Red_point_Event",Star_Fail_Event:"PartnerEvent.Star_Fail_Event",Lock_Equip_Event:"PartnerEvent.Lock_Equip_Event",Form_Change_Event:"PartnerEvent.Form_Change_Event",Partner_Attr_event:"PartnerEvent.Partner_Attr_event",Del_Partner_Event:"PartnerEvent.Del_Partner_Event",Partner_Equip_Tishi:"PartnerEvent.Partner_Equip_Tishi",Artiface_Data_Event:"PartnerEvent.Artiface_Data_Event",Del_One_Artiface:"PartnerEvent.Del_One_Artiface",Update_Artiface_Data:"PartnerEvent.Update_Artiface_Data",Artiface_Sysnthesis_Event:"PartnerEvent.Artiface_Sysnthesis_Event",Recast_Data_Event:"PartnerEvent.Recast_Data_Event",Fashion_Data_Event:"PartnerEvent.Fashion_Data_Event",Equip_Recommend_Event:"PartnerEvent.Equip_Recommend_Event",Equip_Sell_Event:"PartnerEvent.Equip_Sell_Event",SaveFunFormEvent:"PartnerEvent.SaveFunFormEvent",ChangeEvent:"PartnerEvent.ChangeEvent",OpenGemStoneEvent:"PartnerEvent.OpenGemStoneEvent",UpdateGemStoneEvent:"PartnerEvent.UpdateGemStoneEvent",ComposeGemStoneEvent:"PartnerEvent.ComposeGemStoneEvent",UpgradeGemStoneEvent:"PartnerEvent.UpgradeGemStoneEvent",PartnerResetEvent:"PartnerEvent.PartnerResetEvent",PartnerDisbandEvent:"PartnerEvent.PartnerDisbandEvent"};e.exports=s,cc._RF.pop()},{}],partner_model:[function(t,e,i){"use strict";cc._RF.push(e,"c24eepf+7NOtbvc2j372Vmt","partner_model");cc.Class({extends:BaseClass,ctor:function(){},properties:{},initConfig:function(){}});cc._RF.pop()},{}],partnersummon_const:[function(t,e,i){"use strict";var s;function n(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}cc._RF.push(e,"2a902iZlj1P1rNUvRzHtB8T","partnersummon_const");var a={Summon_Type:{Normal:100,Friend:200,Advanced:300,Score:400},Recruit_Key:{Free_Count:4,Free_Time:5},Status:{Free:1,Item:2,Gold:3},Good_Bg:(s={},n(s,100,"partnersummon_image_5"),n(s,200,"partnersummon_image_6"),n(s,300,"partnersummon_image_7"),s),Gain_Show_Type:{Common_Show:1,Skin_show:2},Normal_Id:10401,Advanced_Id:10403};e.exports=a,cc._RF.pop()},{}],partnersummon_controller:[function(t,e,i){"use strict";cc._RF.push(e,"38414tz0/NM7qQqsbBWz8f0","partnersummon_controller");var s=t("partnersummon_event"),n=t("mainui_event"),a=t("battle_event"),o=cc.Class({extends:BaseController,properties:{partner_summon_window:null},ctor:function(){},initConfig:function(){var e=t("partnersummon_model");this.model=new e,this.model.initConfig()},getModel:function(){return this.model},registerEvents:function(){this.init_role_event||(this.init_role_event=gcore.GlobalEvent.bind(EventId.EVT_ROLE_CREATE_SUCCESS,function(){gcore.GlobalEvent.unbind(this.init_role_event)}.bind(this))),this.re_link_game_event||(this.re_link_game_event=gcore.GlobalEvent.bind(EventId.EVT_RE_LINK_GAME,function(){t("guide_controller").getInstance().isInGuide()||this.openPartnerSummonWindow(!1)}.bind(this))),this.get_new_partner_event||(this.get_new_partner_event=gcore.GlobalEvent.bind(n.CLOSE_ITEM_VIEW,function(){this.is_add_partner&&this.add_partner_data&&(this.openSummonGainShowWindow(!0,[this.add_partner_data]),this.is_add_partner=!1,this.add_partner_data=null)}.bind(this))),this.battle_result_event||(this.battle_result_event=gcore.GlobalEvent.bind(a.CLOSE_RESULT_VIEW,function(){this.is_add_partner&&this.add_partner_data&&(this.openSummonGainShowWindow(!0,[this.add_partner_data]),this.is_add_partner=!1,this.add_partner_data=null)}.bind(this)))},registerProtocals:function(){this.RegisterProtocal(23200,this.handle23200.bind(this)),this.RegisterProtocal(23201,this.handle23201.bind(this)),this.RegisterProtocal(23202,this.handle23202.bind(this)),this.RegisterProtocal(23203,this.handle23203.bind(this)),this.RegisterProtocal(23204,this.handle23204.bind(this)),this.RegisterProtocal(11095,this.handle11095.bind(this)),this.RegisterProtocal(23212,this.handle23212.bind(this)),this.RegisterProtocal(23205,this.handle23205.bind(this))},send23200:function(){this.SendProtocal(23200,{})},handle23200:function(t){t&&this.model.setSummonData(t)},send23201:function(t,e,i){var s={};s.group_id=t,s.times=e,s.recruit_type=i,this.SendProtocal(23201,s)},handle23201:function(t){t&&(this.model.setRecruitData(t),gcore.GlobalEvent.fire(s.PartnerSummonSuccess))},handle23202:function(t){t&&this.model.updateSummonData(t)},handle23203:function(){},handle23204:function(){},sender23205:function(){this.SendProtocal(23205,{})},handle23205:function(t){this.five_star_data=t,gcore.GlobalEvent.fire(s.PartnerSummonFiveStar,t)},getFiveStarData:function(){return this.five_star_data},handle11095:function(t){1==t.status?this.openSummonGainShowWindow(!0,t):(this.is_add_partner=!0,this.add_partner_data=t)},handle23212:function(){},scoreRecruit:function(t,e,i){this.partner_summon_window&&this.partner_summon_window.startRecruit(t,e,i)},againRecruit:function(){this.partner_summon_window&&this.partner_summon_window.regainRecruit()},recurit:function(t,e,i){this.partner_summon_window.sendRecruitProtocal(t,e,i)},openPartnerSummonWindow:function(e){if(!1===e)this.partner_summon_window&&(this.partner_summon_window.close(),this.partner_summon_window=null);else{if(!this.partner_summon_window){var i=t("partnersummon_window");this.partner_summon_window=new i(this)}this.partner_summon_window.open(),this.model.setOpenPartnerSummonFlag(!0)}},openSummonGainWindow:function(e,i){if(e){if(!this.summon_gain_window){var s=t("partnersummon_gain_window");this.summon_gain_window=new s(this,i)}this.summon_gain_window.open()}else{if(!this.summon_gain_window)return;this.summon_gain_window.close(),this.summon_gain_window=null}},openSummonGainShowWindow:function(e,i,s,n){if(e){var a;if(1==i.length)if(!(a=Config.partner_data.data_partner_base[i[0].partner_bid])||!a.show_effect||1!=a.show_effect)return;if(!this.summon_show_window){var o=t("partnersummon_show_window");this.summon_show_window=new o(this,i,s,n)}this.summon_show_window.open()}else{if(!this.summon_show_window)return;this.summon_show_window.close(),this.summon_show_window=null}},openScoreTipWindow:function(e){if(e){if(!this.summon_score_window){var i=t("partnersummon_score_window");this.summon_score_window=new i(this)}this.summon_score_window.open()}else this.summon_score_window,this.summon_score_window.close(),this.summon_score_window=null},getSummonItemRoot:function(t,e){if(this.partner_summon_window)return this.partner_summon_window.root_wnd},getSummonResultRoot:function(){if(this.summon_gain_window)return this.summon_gain_window.root_wnd},getSummonShowRoot:function(){if(this.summon_show_window)return this.summon_show_window.root_wnd}});e.exports=o,cc._RF.pop()},{battle_event:"battle_event",guide_controller:"guide_controller",mainui_event:"mainui_event",partnersummon_event:"partnersummon_event",partnersummon_gain_window:"partnersummon_gain_window",partnersummon_model:"partnersummon_model",partnersummon_score_window:"partnersummon_score_window",partnersummon_show_window:"partnersummon_show_window",partnersummon_window:"partnersummon_window"}],partnersummon_event:[function(t,e,i){"use strict";cc._RF.push(e,"f07a5pfbDJPcoPC7xDkoRDw","partnersummon_event"),e.exports={UpdateSummonDataEvent:"UpdateSummonDataEvent",UpdateSummonShareDataEvent:"UpdateSummonShareDataEvent",UpdateSummonSingleDataEvent:"UpdateSummonSingleDataEvent",PartnerSummonSuccess:"PartnerSummonSuccess",PartnerSummonFiveStar:"PartnerSummonFiveStar"},cc._RF.pop()},{}],partnersummon_gain_window:[function(t,e,i){"use strict";cc._RF.push(e,"1f4502T3qVFapFZQ5PPUam2","partnersummon_gain_window");var s=t("pathtool"),n=t("partnersummon_const"),a=t("role_controller"),o=t("backpack_controller"),l=t("timesummon_controller");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("partnersummon","partnersummon_gain_window"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Full,this.can_show=!1,this.ctrl=arguments[0],this.modle=this.ctrl.getModel(),this.recruit_data=this.modle.getRecruitData()},initConfig:function(){this.partnersummon_config=Config.recruit_data.data_partnersummon_data},openCallBack:function(){this.summon_bg_sp=this.seekChild("summon_bg",cc.Sprite),this.bg_effect_sk=this.seekChild("bg_effect",sp.Skeleton),this.partnersummon_bg=this.seekChild("partnersummon_bg"),this.summon_bg_nd=this.seekChild("summon_bg"),this.partnersummon_bg.scale=FIT_SCALE,this.summon_bg_nd.scale=FIT_SCALE,this.get_des_nd=this.seekChild("get_des"),this.items_content_nd=this.seekChild("items_content"),this.again_btn_nd=this.seekChild("again_btn"),this.confirm_btn_nd=this.seekChild("confirm_btn"),this.again_one_txt_nd=this.seekChild("again_one_txt"),this.again_ten_txt_nd=this.seekChild("again_ten_txt"),this.again_need_nd=this.seekChild("again_need"),this.goods_num_lb=this.seekChild("goods_num",cc.RichText),this.goods_sp=this.seekChild("goods",cc.Sprite),this.confirm_btn_nd.on(cc.Node.EventType.TOUCH_END,this.didClickConfirmBtn,this),this.again_btn_nd.on(cc.Node.EventType.TOUCH_END,this.didClickAgainBtn,this)},registerEvent:function(){},closeCallBack:function(){if(this.item_nds){for(var e=0;e<this.item_nds.length;++e)this.item_nds[e]&&(this.item_nds[e].deleteMe(),this.item_nds[e]=null);this.item_nds=null}var i=t("guide_event");gcore.GlobalEvent.fire(i.CloseTaskEffect),this.get_des_nd&&this.get_des_nd.isValid&&this.get_des_nd.stopAllActions(),this.ctrl.openSummonGainWindow(!1)},openRootWnd:function(t){this.recruit_data&&(this.udpateWidgets(),this.createGetItems(),this.analyseRecruitData())},udpateWidgets:function(){this.type_flag=this.recruit_data.flag,0==this.type_flag?this.partnersummon_config=Config.recruit_data.data_partnersummon_data:1==this.type_flag?this.partnersummon_config=Config.recruit_holiday_data.data_summon:2==this.type_flag&&(this.partnersummon_config=Config.recruit_holiday_elite_data.data_summon);var t=this.partnersummon_config[this.recruit_data.group_id],e="partnersummon_call_bg_100";t&&(e=t.call_bg);var i,l,r=s.getUIIconPath("bigbg/partnersummon",e);(this.loadRes(r,function(t){this.summon_bg_sp.spriteFrame=t}.bind(this)),1===this.recruit_data.times?(this.again_one_txt_nd.active=!0,this.again_ten_txt_nd.active=!1):(this.again_one_txt_nd.active=!1,this.again_ten_txt_nd.active=!0),this.need_item_id=null,this.item_enough=!1,this.recruit_data.group_id!=n.Summon_Type.Score&&(0==this.type_flag?1===this.recruit_data.times?(this.need_item_id=t.item_once[0][0],i=t.item_once[0][1]):(this.need_item_id=t.item_five[0][0],i=t.item_five[0][1]):1==this.type_flag?1===this.recruit_data.times?(this.need_item_id=t.loss_item_once[0][0],i=t.loss_item_once[0][1]):(this.need_item_id=t.loss_item_ten[0][0],i=t.loss_item_ten[0][1]):2==this.type_flag&&(1===this.recruit_data.times?(this.need_item_id=t.loss_item_once[0][0],i=t.loss_item_once[0][1]):(this.need_item_id=t.loss_item_ten[0][0],i=t.loss_item_ten[0][1]))),this.recruit_data.group_id===n.Summon_Type.Friend)?l=a.getInstance().getRoleVo().friend_point:l=o.getInstance().getModel().getBackPackItemNumByBid(this.need_item_id);if(this.recruit_data.group_id===n.Summon_Type.Score)this.again_need_nd.active=!1,this.again_btn_nd.active=!1,this.confirm_btn_nd.x=.5*this.root_wnd.width;else{this.again_need_nd.active=!0,this.again_btn_nd.active=!0,this.confirm_btn_nd.x=530;var c=Utils.getItemConfig(this.need_item_id),_=s.getItemRes(c.icon);this.loadRes(_,function(t){this.goods_sp.spriteFrame=t}.bind(this));var h="";l<i?(this.item_enough=!1,h=cc.js.formatStr("<color=#e14737><outline color=#000000 width=2>%s</outline></color><color=#ffffff><outline color=#000000 width=2>/%s</outline></color>",l,i)):(this.item_enough=!0,h=cc.js.formatStr("<color=#35ff14><outline color=#000000 width=2>%s</outline></color><color=#ffffff><outline color=#000000 width=2>/%s</outline></color>",l,i)),this.goods_num_lb.string=h}},showItems:function(){if(this.get_des_nd&&this.get_des_nd.isValid){if(this.get_des_nd.scale=1.5,!this.get_action){var t=cc.delayTime(.1),e=cc.scaleTo(.1,1);this.get_action=cc.sequence(t,e)}this.get_des_nd.runAction(this.get_action),this.can_show=!0,this.items_init&&this.addGetItems()}},addGetItems:function(){if(Utils.playEffectSound(AUDIO_TYPE.Recruit,"result_01"),null!=this.item_nds)for(var t=0;t<this.item_nds.length;t++)this.items_content_nd.addChild(this.item_nds[t].root_wnd),this.item_nds[t].playShowAction(t)},createGetItems:function(){if(this.recruit_data){this.rewards=this.recruit_data.rewards,this.init_num=0,this.item_nds=[];var e=0,i=t("hero_get_item");gcore.Timer.set(function(){var t=new i(this.rewards[e],e,this.itemFinishCreate.bind(this));null!=this.item_nds&&(this.item_nds.push(t),++e)}.bind(this),50,this.rewards.length)}},itemFinishCreate:function(t,e){if(++this.init_num,this.init_num==this.rewards.length){if(null==this.item_nds)return;this.item_nds.length>5?this.items_content_nd.width=680:this.items_content_nd.width=120*this.item_nds.length+(20*this.item_nds.length-1),this.items_init=!0,this.can_show&&this.addGetItems()}},analyseRecruitData:function(){this.finish_cb&&this.finish_cb();var t=[];if(this.recruit_data.partner_bids){var e=null;for(var i in this.recruit_data.partner_bids){e=this.recruit_data.partner_bids[i],Config.partner_data.data_partner_base[e.partner_bid].show_effect&&t.push(e)}}t.length>0?this.ctrl.openSummonGainShowWindow(!0,t,this.showItems.bind(this)):this.showItems()},didClickConfirmBtn:function(t){this.ctrl.openSummonGainWindow(!1)},didClickAgainBtn:function(e){var i=t("hero_controller").getInstance().getModel().getHeroMaxCount(),s=i.max_count-i.have_coutn;if(this.recruit_data.times>s){var a=Utils.TI18N("\u82f1\u96c4\u5217\u8868\u5df2\u6ee1\uff0c\u53ef\u901a\u8fc7\u63d0\u5347\u8d35\u65cf\u7b49\u7ea7\u6216\u8d2d\u4e70\u589e\u52a0\u82f1\u96c4\u643a\u5e26\u6570\u91cf\uff0c\u662f\u5426\u524d\u5f80\u8d2d\u4e70\uff1f");t("commonalert").show(a,Utils.TI18N("\u786e\u5b9a"),function(){var e=t("mainui_const"),i=t("action_controller");t("mainui_controller").getInstance().changeMainUIStatus(e.btn_index.partner),i.getInstance().openActionMainPanel(!1)},Utils.TI18N("\u53d6\u6d88"),function(){})}else if(0==this.type_flag)if(this.item_enough)this.ctrl.againRecruit(),this.modle.getClickStatus()?this.modle.clickIntervalStatus(!1):this.ctrl.openSummonGainWindow(!1);else{if(this.recruit_data.group_id==n.Summon_Type.Advanced)return void this.showGoldTips(this.recruit_data.times);o.getInstance().openTipsSource(!0,this.need_item_id)}else{if(this.item_enough){if(1==this.type_flag)this.ctrl.openSummonGainWindow(!1),l.getInstance().requestTimeSummon(this.recruit_data.times,4);else if(2==this.type_flag){this.ctrl.openSummonGainWindow(!1),t("elitesummon_controller").getInstance().send23221(this.recruit_data.times,4)}return}this.showGoldTips(this.recruit_data.times)}},showGoldTips:function(e){var i;0==this.type_flag?i=Config.recruit_data.data_partnersummon_data[300]:1==this.type_flag?i=Config.recruit_holiday_data.data_summon[this.recruit_data.group_id]:2==this.type_flag&&(i=Config.recruit_holiday_elite_data.data_summon[this.recruit_data.group_id]);var n,a,o,l,r=this.modle.getSummonProtoDataByGroupID(300),c=t("role_controller").getInstance().getRoleVo();0==this.type_flag?(n=i.exchange_once[0][1],a=Utils.getItemConfig(i.exchange_once_gain[0][0]).name,o=i.exchange_once_gain[0][1],l=r.draw_list[1].times||1):1!=this.type_flag&&2!=this.type_flag||(n=i.loss_gold_once[0][1],a=Utils.getItemConfig(i.gain_once[0][0]).name,o=i.gain_once[0][1],l=this.recruit_data.times);var _=c.gold;10===e&&(0==this.type_flag?(n=i.exchange_five[0][1],a=Utils.getItemConfig(i.exchange_five_gain[0][0]).name,o=i.exchange_once_gain[0][1],l=r.draw_list[0].times||10):1!=this.type_flag&&2!=this.type_flag||(n=i.loss_gold_ten[0][1],a=Utils.getItemConfig(i.gain_ten[0][0]).name,o=i.gain_once[0][1],l=this.recruit_data.times));var h=cc.js.formatStr(StringUtil.parseStr(Lang.DIAMOND_CONSUME).string,"3",n,_)+cc.js.formatStr(StringUtil.parseStr(Lang.BUY_DES).string,a,o,l),d=[],u=s.getIconPath("item","3");d.push(u);t("commonalert").show(h,"\u786e\u5b9a",this.configUseGold.bind(this,e),"\u53d6\u6d88",null,null,null,{resArr:d,maxWidth:450,align:cc.macro.TextAlignment.LEFT})},configUseGold:function(){if(0==this.type_flag){var e=this.recruit_data.times;this.ctrl.recurit(300,e,3),this.ctrl.openSummonGainWindow(!1)}else if(1==this.type_flag)l.getInstance().requestTimeSummon(this.recruit_data.times,3),this.ctrl.openSummonGainWindow(!1);else if(2==this.type_flag){t("elitesummon_controller").getInstance().send23221(this.recruit_data.times,3),this.ctrl.openSummonGainWindow(!1)}}});cc._RF.pop()},{action_controller:"action_controller",backpack_controller:"backpack_controller",commonalert:"commonalert",elitesummon_controller:"elitesummon_controller",guide_event:"guide_event",hero_controller:"hero_controller",hero_get_item:"hero_get_item",mainui_const:"mainui_const",mainui_controller:"mainui_controller",partnersummon_const:"partnersummon_const",pathtool:"pathtool",role_controller:"role_controller",timesummon_controller:"timesummon_controller"}],partnersummon_item:[function(t,e,i){"use strict";var s;function n(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}cc._RF.push(e,"76fa1lOvMxNcJfkOOcmVqR2","partnersummon_item");var a=t("pathtool"),o=t("partnersummon_const"),l=t("guide_event"),r=t("partnersummon_event");cc.Class({extends:ViewClass,properties:(s={summon_data:null,parent:null},n(s,"summon_data",null),n(s,"sprite_frmas",null),n(s,"height",228),n(s,"recruit_once_staus",null),n(s,"recruit_more_staus",null),n(s,"item_enough",!1),n(s,"cur_timer",null),n(s,"final_once_use_item",null),n(s,"final_once_use_num",null),n(s,"final_more_use_item",null),n(s,"final_more_use_num",null),s),ctor:function(){this.parent=arguments[0],this.index=arguments[1],this.recruit_cb=arguments[2];var e=t("partnersummon_controller");this.ctrl=e.getInstance(),this.rleasePrefab=!1,this.prefabPath=a.getPrefabPath("partnersummon","partnersummon_item"),this.initConfig(),this.registerEvent(),this.initWindRoot()},initConfig:function(){var e=t("role_controller");this.role_vo=e.getInstance().getRoleVo();var i=t("backpack_controller");this.backpack_ctrl=i.getInstance(),this.backpack_model=i.getInstance().getModel()},initWindRoot:function(){LoaderManager.getInstance().loadRes(this.prefabPath,function(t){this.root_wnd=t,this.root_wnd.y=-this.index*this.height,this.parent.addChild(this.root_wnd),this.initWidget()}.bind(this))},registerEvent:function(){this.addGlobalEvent(EventId.ADD_GOODS,function(t,e){this.summon_data.group_id!=o.Summon_Type.Friend&&this.updateWidgets()}.bind(this)),this.addGlobalEvent(EventId.DELETE_GOODS,function(t,e){this.summon_data.group_id!=o.Summon_Type.Friend&&this.updateWidgets()}.bind(this)),this.addGlobalEvent(EventId.MODIFY_GOODS_NUM,function(t,e){this.summon_data.group_id!=o.Summon_Type.Friend&&this.updateWidgets()}.bind(this)),this.role_vo&&!this.role_vo_friend&&(this.role_vo_friend=this.role_vo.bind(EventId.UPDATE_ROLE_ATTRIBUTE,function(t,e){"friend_point"==t&&this.summon_data.group_id==o.Summon_Type.Friend&&this.updateWidgets()}.bind(this))),null==this.five_star_event&&(this.five_star_event=gcore.GlobalEvent.bind(r.PartnerSummonFiveStar,function(t){this.summon_data.group_id==o.Summon_Type.Advanced&&this.desc_lb&&(t&&t.need_times>0?("QQ_SDK"==PLATFORM_TYPR||"SH_SDK"==PLATFORM_TYPR||"WX_SDK"==PLATFORM_TYPR?this.desc_lb.string=Utils.TI18N("         \u6b21\u5185\u53ec\u5524\u5fc5\u5f97        \u661f\u82f1\u96c4"):this.desc_lb.string=Utils.TI18N("        \u6b21\u5185\u53ec\u5524\u5fc5\u5f97      \u661f\u82f1\u96c4"),this.updateFiveStarSp(t.need_times)):(this.desc_lb.string=Utils.TI18N("\u968f\u673a\u53ec\u55241\u4e2a\u621610\u4e2a3~5\u661f\u82f1\u96c4"),this.desc_lb.node.y=-84,1==this.five_nd.active&&(this.five_nd.active=!1),this.five_star_event&&(gcore.GlobalEvent.unbind(this.five_star_event),this.five_star_event=null)))}.bind(this)))},initWidget:function(){this.item_bg_sp=this.seekChild("item_bg",cc.Sprite),this.good_bg_sp=this.seekChild("good_bg",cc.Sprite),this.good_sp=this.seekChild("good",cc.Sprite),this.good_num_lb=this.seekChild("good_num_label",cc.Label),this.recruit_btn_one_nd=this.seekChild("recruit_btn_one"),this.recruit_btn_one_nd.tag_1=1,this.l_item_icon_nd=this.seekChild("l_item_icon"),this.l_item_icon_sp=this.seekChild("l_item_icon",cc.Sprite),this.l_item_num_lb=this.seekChild("l_item_num",cc.Label),this.l_free_recruit_nd=this.seekChild("l_free_recruit"),this.l_item_recruit_nd=this.seekChild("l_item_recruit"),this.recruit_but_ten_nd=this.seekChild("recruit_but_ten"),this.recruit_but_ten_nd.tag_1=2,this.r_item_icon_nd=this.seekChild("r_item_icon"),this.r_item_icon_sp=this.seekChild("r_item_icon",cc.Sprite),this.r_item_num_lb=this.seekChild("r_item_num",cc.Label),this.next_free_time_nd=this.seekChild("next_free_time"),this.next_free_time_rt=this.seekChild("next_free_time",cc.RichText),this.discount_nd=this.seekChild("discount"),this.desc_lb=this.seekChild("desc_lb",cc.Label),this.desc_lo=this.seekChild("desc_lb",cc.LabelOutline),this.five_nd=this.seekChild("five_nd"),this.five_sp_1=this.seekChild(this.five_nd,"five_sp_1").getComponent("CusRichText"),this.five_sp_2=this.seekChild(this.five_nd,"five_sp_2").getComponent("CusRichText"),this.recruit_btn_one_nd.on(cc.Node.EventType.TOUCH_END,this.onClickOnceBtn,this),this.recruit_but_ten_nd.on(cc.Node.EventType.TOUCH_END,this.onClickMoreBtn,this),this.summon_data&&this.updateWidgets()},updateWidgets:function(){var t=this.summon_data.config_data.card_bg_res,e=a.getBigBg(t,null,"partnersummon");if(this.loadRes(e,function(t){this.item_bg_sp.spriteFrame=t}.bind(this)),this.summon_data.group_id==o.Summon_Type.Normal)this.desc_lb.string=Utils.TI18N("\u968f\u673a\u53ec\u55241\u4e2a\u621610\u4e2a1~5\u661f\u82f1\u96c4"),this.desc_lo.color=new cc.Color(26,36,124,255);else if(this.summon_data.group_id==o.Summon_Type.Advanced){var i=this.ctrl.getFiveStarData();i&&i.need_times>0?("QQ_SDK"==PLATFORM_TYPR||"SH_SDK"==PLATFORM_TYPR||"WX_SDK"==PLATFORM_TYPR?this.desc_lb.string=Utils.TI18N("         \u6b21\u5185\u53ec\u5524\u5fc5\u5f97        \u661f\u82f1\u96c4"):this.desc_lb.string=Utils.TI18N("        \u6b21\u5185\u53ec\u5524\u5fc5\u5f97      \u661f\u82f1\u96c4"),this.updateFiveStarSp(i.need_times),this.desc_lb.node.y=-89):(this.desc_lb.string=Utils.TI18N("\u968f\u673a\u53ec\u55241\u4e2a\u621610\u4e2a3~5\u661f\u82f1\u96c4"),this.desc_lb.node.y=-84),this.desc_lo.color=new cc.Color(143,28,0,255)}else this.summon_data.group_id==o.Summon_Type.Friend&&(this.desc_lb.string=Utils.TI18N("\u968f\u673a\u53ec\u55241\u4e2a\u621610\u4e2a2~5\u661f\u82f1\u96c4"),this.desc_lo.color=new cc.Color(90,0,159,255));this.l_item_icon_nd.scale=.35,this.r_item_icon_nd.scale=.35,this.once_good_id=this.summon_data.config_data.item_once[0][0];var s=this.summon_data.config_data.item_once[0][1],n=Utils.getItemConfig(this.once_good_id),l=a.getItemRes(n.icon);this.loadRes(l,function(t){this.good_sp.spriteFrame=t}.bind(this)),this.summon_data.group_id==o.Summon_Type.Normal?this.recruit_btn_one_nd.ui_tag="recruit_btn_one_1":this.summon_data.group_id==o.Summon_Type.Advanced&&(this.recruit_btn_one_nd.ui_tag="recruit_btn_one_3");var r=0;r=this.summon_data.group_id==o.Summon_Type.Friend?this.role_vo.friend_point:this.backpack_model.getBackPackItemNumByBid(this.once_good_id),this.good_num_lb.string=r;var c=this.getFreeInfo(1);if(c.free_times>0)this.stopTimer(),this.l_free_recruit_nd.active=!0,this.l_item_recruit_nd.active=!1,this.recruit_once_staus=o.Status.Free;else if(this.startTimer(c),this.l_free_recruit_nd.active=!1,this.l_item_recruit_nd.active=!0,this.l_item_num_lb.string=s,r>=s)this.recruit_once_staus=o.Status.Item,this.item_enough=!0,this.loadRes(l,function(t){this.l_item_icon_sp.spriteFrame=t}.bind(this));else if(this.l_item_icon_nd.scale=.3,this.summon_data.group_id==o.Summon_Type.Advanced){var _=this.summon_data.config_data.exchange_once[0][0],h=this.summon_data.config_data.exchange_once[0][1];this.l_item_num_lb.string=h;n=Utils.getItemConfig(_),l=a.getItemRes(n.icon);this.loadRes(l,function(t){this.l_item_icon_sp.spriteFrame=t}.bind(this)),this.recruit_once_staus=o.Status.Gold}else this.recruit_once_staus=o.Status.Item,this.item_enough=!1,this.loadRes(l,function(t){this.l_item_icon_sp.spriteFrame=t}.bind(this));this.summon_data.config_data.item_five[0][0];var d=this.summon_data.config_data.item_five[0][1];if(this.r_item_num_lb.string=d,r>=d)this.recruit_more_staus=o.Status.Item,this.item_more_enough=!0,this.loadRes(l,function(t){this.r_item_icon_sp.spriteFrame=t}.bind(this));else if(this.r_item_icon_nd.scale=.3,this.summon_data.group_id==o.Summon_Type.Advanced){_=this.summon_data.config_data.exchange_five[0][0],h=this.summon_data.config_data.exchange_five[0][1],n=Utils.getItemConfig(_),l=a.getItemRes(n.icon);this.loadRes(l,function(t){this.r_item_icon_sp.spriteFrame=t}.bind(this)),this.r_item_num_lb.string=h,this.recruit_more_staus=o.Status.Gold,this.discount_nd.active=!0,CommonAction.breatheShineAction3(this.discount_nd)}else this.recruit_more_staus=o.Status.Item,this.item_more_enough=!1,this.loadRes(l,function(t){this.r_item_icon_sp.spriteFrame=t}.bind(this));this.updateSprites()},startTimer:function(t){!t&&t.surplus_time>0||(this.time_interval=Utils.getTimeInterval(t.surplus_time),this.surplus_time=Utils.changeIntevalToDate(this.time_interval),this.surplus_time&&(this.next_free_time_nd.active=!0,this.cur_timer=gcore.Timer.set(function(){if(this.cur_timer){this.time_interval=Utils.getTimeInterval(t.surplus_time),this.surplus_time=Utils.changeIntevalToDate(this.time_interval);var e=this.surplus_time.H+":"+this.surplus_time.M+":"+this.surplus_time.S,i=Utils.TI18N(cc.js.formatStr(Lang.FREE_RECRUIT,e));this.next_free_time_rt.string=i}}.bind(this),1e3,-1)))},stopTimer:function(){this.next_free_time_nd.active=!1,gcore.Timer.del(this.cur_timer),this.cur_timer=null},updateSprites:function(){var t=o.Good_Bg[this.summon_data.group_id],e=a.getUIIconPath("partnersummon",t);this.loadRes(e,function(t){this.good_bg_sp.spriteFrame=t}.bind(this))},updateData:function(t){t&&(this.summon_data=t,this.root_wnd&&this.updateWidgets())},onClickOnceBtn:function(t){this.sendRecruit(1),window.TASK_TIPS&&gcore.GlobalEvent.fire(l.TaskNextStep,"recruit_btn_one_3")},onClickMoreBtn:function(){this.sendRecruit(10)},sendRecruit:function(e){Utils.playButtonSound(ButtonSound.Normal);var i=t("hero_controller").getInstance().getModel().getHeroMaxCount();if(e>i.max_count-i.have_coutn){var s=Utils.TI18N("\u82f1\u96c4\u5217\u8868\u5df2\u6ee1\uff0c\u53ef\u901a\u8fc7\u63d0\u5347\u8d35\u65cf\u7b49\u7ea7\u6216\u8d2d\u4e70\u589e\u52a0\u82f1\u96c4\u643a\u5e26\u6570\u91cf\uff0c\u662f\u5426\u524d\u5f80\u8d2d\u4e70\uff1f");t("commonalert").show(s,Utils.TI18N("\u786e\u5b9a"),function(){var e=t("mainui_controller"),i=t("mainui_const"),s=t("action_controller");e.getInstance().changeMainUIStatus(i.btn_index.partner),s.getInstance().openActionMainPanel(!1)},Utils.TI18N("\u53d6\u6d88"),function(){})}else{var n=null;if(1==e){if(this.recruit_once_staus==o.Status.Free)n=1;else if(this.recruit_once_staus==o.Status.Item){if(n=4,!this.item_enough)return void this.showGetPath()}else if(this.recruit_once_staus==o.Status.Gold)return n=3,void this.showGoldTips(e)}else if(10==e)if(this.recruit_more_staus==o.Status.Free)n=1;else if(this.recruit_more_staus==o.Status.Item){if(n=4,!this.item_more_enough)return void this.showGetPath()}else if(this.recruit_more_staus==o.Status.Gold)return n=3,void this.showGoldTips(e);n&&this.recruit_cb&&this.recruit_cb(this.summon_data.group_id,e,n)}},showGoldTips:function(e){Utils.getItemConfig(this.summon_data.config_data.exchange_once[0][0]);var i=this.summon_data.config_data.exchange_once[0][1],s=this.role_vo.gold,n=Utils.getItemConfig(this.summon_data.config_data.exchange_once_gain[0][0]).name,o=this.summon_data.config_data.exchange_once_gain[0][1],l=this.summon_data.recruit_data.draw_list[1].times||1;10===e&&(i=this.summon_data.config_data.exchange_five[0][1],n=Utils.getItemConfig(this.summon_data.config_data.exchange_five_gain[0][0]).name,o=this.summon_data.config_data.exchange_five_gain[0][1],l=this.summon_data.recruit_data.draw_list[0].times||10);var r=cc.js.formatStr(StringUtil.parseStr(Lang.DIAMOND_CONSUME).string,"3",i,s)+cc.js.formatStr(StringUtil.parseStr(Lang.BUY_DES).string,o,n,l),c=[],_=a.getIconPath("item","3");c.push(_);t("commonalert").show(r,"\u786e\u5b9a",this.configUseGold.bind(this,e),"\u53d6\u6d88",null,null,null,{resArr:c,maxWidth:450,align:cc.macro.TextAlignment.LEFT})},configUseGold:function(t,e){var i=this.summon_data.group_id;t=t;this.recruit_cb&&this.recruit_cb(i,t,3)},showGetPath:function(){this.backpack_ctrl.openTipsSource(!0,this.once_good_id)},getFreeInfo:function(t){if(null!==t){var e=this.summon_data.recruit_data.draw_list;if(e){var i=null,s={};for(var n in e)e[n].times==t&&(i=e[n]);if(i)for(var a in i.kv_list)i.kv_list[a].key===o.Recruit_Key.Free_Count&&(s.free_times=i.kv_list[a].val),i.kv_list[a].key===o.Recruit_Key.Free_Time&&(s.surplus_time=i.kv_list[a].val);return s}}},deleteMe:function(){this._super(),this.stopTimer(),this.five_star_event&&(gcore.GlobalEvent.unbind(this.five_star_event),this.five_star_event=null)},getSummonItemRoot:function(t,e){this.root_wnd?e(this.seekChild(this.root_wnd,t)):(this.get_root_name=t,this.get_root_cb=e)},regainRecruit:function(){this.backpack_model.getBackPackItemNumByBid(this.once_good_id)>0?this.recruit_cb&&this.recruit_cb(this.summon_data.group_id,1,4):this.summon_data.group_id==o.Summon_Type.Advanced?this.showGoldTips(1):this.showGetPath()},updateFiveStarSp:function(t){t<=0||null!=this.five_nd&&(this.five_nd.active=!0,this.five_sp_2.setNum(5),this.five_sp_1.setNum(t))}});cc._RF.pop()},{action_controller:"action_controller",backpack_controller:"backpack_controller",commonalert:"commonalert",guide_event:"guide_event",hero_controller:"hero_controller",mainui_const:"mainui_const",mainui_controller:"mainui_controller",partnersummon_const:"partnersummon_const",partnersummon_controller:"partnersummon_controller",partnersummon_event:"partnersummon_event",pathtool:"pathtool",role_controller:"role_controller"}],partnersummon_model:[function(t,e,i){"use strict";cc._RF.push(e,"5404dkqo/9HCK53yJeJbyxU","partnersummon_model");var s=t("partnersummon_event"),n=t("partnersummon_const");cc.Class({extends:BaseClass,ctor:function(){},properties:{recruit_list:null,recruit_data:null,had_open_view:!1},initConfig:function(){},setSummonData:function(t){t&&(this.recruit_list=t.recruit_list,this.setShareData(t),this.updateRecruitData(),this.updateRedPoint())},updateSummonData:function(t){if(t&&this.recruit_list){for(var e in this.recruit_list){var i=this.recruit_list[e];if(i.group_id===t.group_id&&i.draw_list)for(var a in i.draw_list){var o=i.draw_list[a];if(1===o.times&&o.kv_list)for(var l in o.kv_list){var r=o.kv_list[l];r.key==n.Recruit_Key.Free_Count&&(r.val=t.free_times),r.key==n.Recruit_Key.Free_Time&&(r.val=t.free_cd_end)}}}this.updateRedPoint(),gcore.GlobalEvent.fire(s.UpdateSummonDataEvent,t)}},setRecruitData:function(t){this.recruit_data=t},getRecruitData:function(){return this.recruit_data},setShareData:function(t){},updateRecruitData:function(t){},updateExtendData:function(){},getSummonGroupData:function(){var t=[],e=Config.recruit_data.data_partnersummon_data,i=null,s=null,n=null;for(var a in e)if(0===(s=e[a]).is_show){n=s.group_id;var o=this.getSummonProtoDataByGroupID(n);(i={}).config_data=e[a],i.recruit_data=o,i.group_id=s.group_id,t.push(i)}return t.sort(function(t){return function(e,i){return e.config_data[t]<i.config_data[t]?-1:1}}("sort_id"))},getSummonProtoDataByGroupID:function(t){if(t&&this.recruit_list){var e=null;for(var i in this.recruit_list)if((e=this.recruit_list[i]).group_id===t)return e;return null}},getScoreSummonNeedCount:function(){var t=0,e=Config.recruit_data.data_partnersummon_data[n.Summon_Type.Score];return e.exchange_once&&e.exchange_once[0]&&(t=e.exchange_once[0][1]),t},updateMainSceneRedPoint:function(){var e=t("mainscene_controller"),i=t("scene_const"),s=!1;for(var a in this.recruit_list){var o=this.recruit_list[a];if(o.draw_list)for(var l in o.draw_list){var r=o.draw_list[l];if(r.kv_list)for(var c in r.kv_list){var _=r.kv_list[c];_.key==n.Recruit_Key.Free_Count&&_.val>0&&(s=!0)}}}if(!s&&!this.had_open_view){var h=t("backpack_controller"),d=h.getInstance().getModel().getItemNumByBid(n.Normal_Id),u=h.getInstance().getModel().getItemNumByBid(n.Normal_Id);(d>0||u>0)&&(s=!0)}e.getInstance().setBuildRedStatus(i.CenterSceneBuild.summon,s)},setOpenPartnerSummonFlag:function(t){this.had_open_view=t,this.updateRedPoint()},updateRedPoint:function(){RedMgr.getInstance().addCalHandler(this.updateMainSceneRedPoint.bind(this),RedIds.PartnerSummon)},clickIntervalStatus:function(t){this.updateTime=t},getClickStatus:function(){return this.updateTime}});cc._RF.pop()},{backpack_controller:"backpack_controller",mainscene_controller:"mainscene_controller",partnersummon_const:"partnersummon_const",partnersummon_event:"partnersummon_event",scene_const:"scene_const"}],partnersummon_score_window:[function(t,e,i){"use strict";cc._RF.push(e,"602cayAUnJOHIEpkam2LKWg","partnersummon_score_window");var s=t("pathtool"),n=t("partnersummon_const");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("partnersummon","partnersummon_score_window"),this.viewTag=SCENE_TAG.ui,this.win_type=WinType.Tips,this.ctrl=arguments[0],this.model=this.ctrl.getModel();var e=t("role_controller");this.role_vo=e.getInstance().getRoleVo()},initConfig:function(){},openCallBack:function(){},registerEvent:function(){},openRootWnd:function(t){this.initWidgets()},closeCallBack:function(){this.ctrl.openScoreTipWindow(!1)},initWidgets:function(){this.close_btn_nd=this.seekChild("close_btn"),this.ok_btn_nd=this.seekChild("ok_btn"),this.ok_btn_bt=this.ok_btn_nd.getComponent(cc.Button),this.content_lb=this.seekChild("content_label",cc.Label),this.btn_title_ol=this.seekChild("btn_label",cc.LabelOutline),this.background=this.seekChild("background"),this.background.scale=FIT_SCALE;var t=this.seekChild("Image_9",cc.Sprite);this.loadRes(s.getIconPath("item","29999"),function(e){t.spriteFrame=e}.bind(this)),this.ok_btn_nd.on(cc.Node.EventType.TOUCH_END,this.didClickOkBtn,this),this.close_btn_nd.on(cc.Node.EventType.TOUCH_END,this.didCloseBnt,this),this.updateWidgets()},updateWidgets:function(){var t=this.model.getScoreSummonNeedCount(),e=Utils.TI18N(cc.js.formatStr(Lang.SCORE_RECRUIT,t));this.content_lb.string=e,this.role_vo.recruit_hero>=t?(this.ok_btn_bt.interactable=!0,this.btn_title_ol.enabled=!0):(this.ok_btn_bt.interactable=!1,this.btn_title_ol.enabled=!1)},didCloseBnt:function(t){this.ctrl.openScoreTipWindow(!1)},didClickOkBtn:function(t){if(this.ok_btn_bt.interactable){this.ctrl.scoreRecruit(n.Summon_Type.Score,1,3),this.ctrl.openScoreTipWindow(!1)}}});cc._RF.pop()},{partnersummon_const:"partnersummon_const",pathtool:"pathtool",role_controller:"role_controller"}],partnersummon_show_window:[function(t,e,i){"use strict";cc._RF.push(e,"78c3aRo8gpItYMuh6K04FLu","partnersummon_show_window");var s=t("pathtool"),n=t("guide_event"),a=t("partnersummon_const");cc.Class({extends:BaseView,properties:{skelton_data:null,conmmon_sp:null},ctor:function(){this.prefabPath=s.getPrefabPath("partnersummon","partnersummon_show_window"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Full,this.ctrl=arguments[0],this.model=this.ctrl.getModel(),this.show_bids=arguments[1],this.finish_cb=arguments[2],this.bg_type=arguments[3]},initConfig:function(){this.partnersummon_config=Config.recruit_data.data_partnersummon_data},openCallBack:function(){},registerEvent:function(){},openRootWnd:function(t){this.initWidget(),this.initBgInfo(),this.showRecruit()},closeCallBack:function(){gcore.GlobalEvent.fire(n.CloseTaskEffect),t("partnersummon_controller").getInstance().openSummonGainShowWindow(!1)},initBgInfo:function(){if(this.recruit_data=this.model.getRecruitData(),this.recruit_data)var t=this.partnersummon_config[this.recruit_data.group_id];var e="partnersummon_call_bg_100";null!=this.bg_type&&2==this.bg_type&&(e="partnersummon_call_bg_200"),t&&(e=t.call_bg);var i=s.getUIIconPath("bigbg/partnersummon",e);this.loadRes(i,function(t){this.summon_bg_sp.spriteFrame=t}.bind(this))},initWidget:function(){this.summon_bg_sp=this.seekChild("summon_bg",cc.Sprite),this.bg_effect_sk=this.seekChild("bg_effect",sp.Skeleton),this.herocard_info_nd=this.seekChild("herocard_info"),this.partnersummon_bg=this.seekChild("partnersummon_bg"),this.summon_bg_nd=this.seekChild("summon_bg"),this.summon_bg_nd.scale=this.summon_bg_nd.scale*FIT_SCALE,this.partnersummon_bg.scale=FIT_SCALE,this.share_conten_nd=this.seekChild("share_conten"),this.show_conten_nd=this.seekChild("show_conten"),this.skill_item_nd=this.seekChild("skill_item"),this.star_item_nd=this.seekChild("star_item"),this.herocard_sp=this.seekChild("herocard",cc.Sprite),this.stars_conten_nd=this.seekChild("stars_conten"),this.hero_type_sp=this.seekChild("hero_type",cc.Sprite),this.hero_name_lb=this.seekChild("hero_name",cc.Label),this.hero_slogn_lb=this.seekChild("hero_slogn",cc.Label),this.camp_type_sp=this.seekChild("camp_type",cc.Sprite),this.share_btn_nd=this.seekChild("share_btn"),this.partnersummon_tag_bg_nd=this.seekChild("partnersummon_tag_bg"),this.again_one_txt_nd=this.seekChild("again_one_txt"),this.again_ten_txt_nd=this.seekChild("again_ten_txt"),this.confirm_btn_nd=this.seekChild("confirm_btn"),"QQ_SDK"==PLATFORM_TYPR?this.share_btn_nd.active=!0:(this.share_btn_nd.active=!1,this.confirm_btn_nd.x=360),this.skills_content_nd=this.seekChild("skills_content"),this.reward_nd=this.seekChild("reward"),this.reward_nd.active=!1,this.get_des_nd=this.seekChild("get_des"),this.gongxi_img_nd=this.seekChild("gongxi_img"),this.return_btn_nd=this.seekChild("return_btn"),this.weixin_btn_nd=this.seekChild("weixin_btn"),this.friend_btn_nd=this.seekChild("friend_btn"),this.card_skeleton=this.seekChild("card_skelton",sp.Skeleton),this.card_skeleton.setCompleteListener(this.animaComplete.bind(this)),this.get_anima_sp=this.seekChild("get_anima",sp.Skeleton),this.share_btn_nd.on(cc.Node.EventType.TOUCH_END,this.didClickShareBtn,this),this.confirm_btn_nd.on(cc.Node.EventType.TOUCH_END,this.didClickConfimBtn,this),this.return_btn_nd.on(cc.Node.EventType.TOUCH_END,this.didClickReturnBtn,this)},updateWidget:function(e){if(this.par_base_config&&this.par_star_config&&e){if(e.show_type&&e.show_type==a.Gain_Show_Type.Skin_show){var i=Config.partner_skin_data.data_skin_info[e.skin_id];if(i)return this.hero_name_lb.string=i.skin_name,this.hero_slogn_lb.string=cc.js.formatStr(Utils.TI18N("%s\xb7\u76ae\u80a4"),this.par_base_config.name),this.stars_conten_nd.active=!1,void(this.partnersummon_tag_bg_nd.active=!1)}var n=s.getHeroCampRes(this.par_base_config.camp_type);this.loadRes(s.getUIIconPath("common",n),function(t){this.camp_type_sp.spriteFrame=t}.bind(this));var o=s.getUIIconPath("partnersummon","partnersummon_type_"+this.par_base_config.type);this.loadRes(o,function(t){this.hero_type_sp.spriteFrame=t}.bind(this)),this.par_base_config.voice&&Utils.playEffectSound(AUDIO_TYPE.DUBBING,this.par_base_config.voice),this.stars_conten_nd.removeAllChildren();for(var l=0;l<e.init_star;l++){var r=cc.instantiate(this.star_item_nd);this.stars_conten_nd.addChild(r)}this.hero_name_lb.string=this.par_base_config.name,this.hero_slogn_lb.string=this.par_base_config.hero_pos,this.skills_content_nd.removeAllChildren();for(var c=this.par_star_config.skills,_=0;_<c.length;_++){var h=c[_];if(1!=h[0]){var d=cc.instantiate(this.skill_item_nd);d.y=0;var u=d.getChildByName("skill_con");this.skills_content_nd.addChild(d);var m=new(t("skill_item"));m.setLeveStatus(!1),m.setShowTips(!0),m.setParent(u),m.setData(h[1]),m.showBG(!1)}}}},showRecruit:function(){if(this.show_bids.length>0){this.show_conten_nd.active=!1,this.herocard_info_nd.active=!1;var t=this.show_bids.shift();this.par_base_config=Config.partner_data.data_partner_base[t.partner_bid],this.par_star_config=gdata("partner_data","data_partner_star",t.partner_bid.toString()+"_"+t.init_star.toString()),this.updateWidget(t);var e=null;if(t.show_type&&t.show_type==a.Gain_Show_Type.Skin_show){var i=Config.partner_skin_data.data_skin_info[t.skin_id];e=s.getBigBg("partnercard_"+i.head_card_id,"png","partnercard")}else e=s.getBigBg("partnercard_"+t.partner_bid,"png","partnercard");this.loadRes(e,function(t){this.herocard_sp.spriteFrame=t}.bind(this));if(this.card_skeleton)if(this.is_playing=!0,this.card_skeleton.skeletonData)this.card_skeleton.setAnimation(0,"action1");else{var n=s.getSpinePath("E51007","action");this.loadRes(n,function(t){this.card_skeleton.skeletonData=t,this.card_skeleton.setAnimation(0,"action1")}.bind(this))}if(this.get_des_nd.scale=1.5,!this.get_action){var o=cc.delayTime(.1),l=cc.scaleTo(.1,1),r=cc.callFunc(function(){if(this.get_anima_sp)if(this.get_anima_sp.skeletonData)this.get_anima_sp.setAnimation(0,"action");else{var t=s.getSpinePath("E50093","action");this.loadRes(t,function(t){this.get_anima_sp.skeletonData=t,this.get_anima_sp.setAnimation(0,"action")}.bind(this))}}.bind(this));this.get_action=cc.sequence(r,o,l)}this.get_des_nd.runAction(this.get_action)}},didClickShareBtn:function(t){Utils.playButtonSound(1),"QQ_SDK"==PLATFORM_TYPR&&SDK.canvasToTempFilePath()},didClickConfimBtn:function(e){(Utils.playButtonSound(1),this.show_bids.length>0)?this.showRecruit():(this.finish_cb&&this.finish_cb(),t("partnersummon_controller").getInstance().openSummonGainShowWindow(!1));window.TASK_TIPS&&gcore.GlobalEvent.fire(n.TaskNextStep,"confirm_btn")},didClickReturnBtn:function(){Utils.playButtonSound(1),this.show_conten_nd.active=!0,this.show_conten_nd.active=!0,this.share_conten_nd.active=!1},animaComplete:function(t,e){if(0!=this.is_playing){var i=t.animation?t.animation.name:"";"action1"!=i&&"action2"!=i||(this.card_skeleton.setAnimation(0,"action3",!0),this.show_conten_nd.active=!0,this.herocard_info_nd.active=!0),this.is_playing=!1,this.shakeScreen(this.root_wnd)}},shakeScreen:function(t){var e=this,i=t;i.action&&(this.is_shake=!1,i.stopAllActions(),i.action=null),this.camera_shake_pos=t.getPosition(),this.is_shake=!0;for(var s=function(){this.is_shake=!1,i.setPosition(this.camera_shake_pos)}.bind(this),n=[1,4,7,8,9,6,3,2],a=15,o=[[-.7,.7],[0,1],[.7,.7],[-1,0],[0,0],[1,0],[-.7,-.7],[0,-1],[.7,-.7]],l=function(t){var e,s;e=.25*a*o[n[t]-1][0],s=.25*-a*o[n[t]-1][1];var l=cc.v2(this.camera_shake_pos.x+e,this.camera_shake_pos.y+s);i.setPosition(l)}.bind(this),r=cc.delayTime(0),c=0;c<1;++c){for(var _=function(t){var i=cc.delayTime(.015);r=cc.sequence(r,cc.callFunc(function(){l(t)}.bind(e)),i)},h=0;h<n.length;++h)_(h);a-=3}r=cc.sequence(r,cc.callFunc(s)),i.action=r,i.runAction(r)}});cc._RF.pop()},{guide_event:"guide_event",partnersummon_const:"partnersummon_const",partnersummon_controller:"partnersummon_controller",pathtool:"pathtool",skill_item:"skill_item"}],partnersummon_window:[function(t,e,i){"use strict";cc._RF.push(e,"4b7db4azrtO3qfjh8QFjoB8","partnersummon_window");var s=t("pathtool"),n=(t("partnersummon_item"),t("partnersummon_event")),a=(t("partnersummon_const"),t("mainui_controller")),o=t("guide_event");cc.Class({extends:BaseView,properties:{item_list:{default:{}},recruit_sk:null},ctor:function(){this.prefabPath=s.getPrefabPath("partnersummon","partnersummon_window"),this.viewTag=SCENE_TAG.ui,this.win_type=WinType.Full,this.rleasePrefab=!1,this.ctrl=arguments[0],this.model=this.ctrl.getModel();var e=t("role_controller");this.role_vo=e.getInstance().getRoleVo();var i=t("action_controller");i.getInstance().action_operate&&i.getInstance().action_operate.setVisible(!1)},initConfig:function(){this.partnersummon_config=Config.recruit_data.data_partnersummon_data},openCallBack:function(){this.role_vo_attr&&gcore.GlobalEvent.unbind(this.role_vo_attr)},registerEvent:function(){gcore.GlobalEvent.bind(n.UpdateSummonDataEvent,function(t){this.updateSummonGroupData()}.bind(this)),this.addGlobalEvent(n.PartnerSummonSuccess,function(){this.playRecruitEffect()}.bind(this)),this.role_vo&&!this.role_vo_attr&&(this.role_vo_attr=this.role_vo.bind(EventId.UPDATE_ROLE_ATTRIBUTE,function(t,e){"recruit_hero"===t&&this.root_wnd&&this.updateScoreInfo()}.bind(this)))},openRootWnd:function(t){this.initWidgets()},initWidgets:function(){this.close_btn_nd=this.seekChild("close_btn"),this.tips_btn_nd=this.seekChild("tips_btn"),this.score_btn_nd=this.seekChild("score_btn"),this.progress_nd=this.seekChild("progress"),this.card_content_nd=this.seekChild("content"),this.progress_label_lb=this.seekChild("progress_label",cc.Label),this.top_anima_sk=this.seekChild("top_anima",sp.Skeleton),this.top_anima_nd=this.seekChild("top_anima"),this.background_nd=this.seekChild("background"),this.background_nd.scale=FIT_SCALE,this.loadRes(s.getBigBg("bigbg_11"),function(t){this.background_nd.getComponent(cc.Sprite).spriteFrame=t}.bind(this)),this.recruit_ani_bg_nd=this.seekChild("recruit_ani_bg"),this.recruit_ani_sk=this.seekChild("recruit_ani",sp.Skeleton),this.recruit_ani_sk.setCompleteListener(this.animaComplete.bind(this)),this.recruit_ani_bg_nd.on(cc.Node.EventType.TOUCH_END,this.animaComplete,this),this.close_btn_nd.on(cc.Node.EventType.TOUCH_END,this.didClickCloseBtn,this),this.tips_btn_nd.on(cc.Node.EventType.TOUCH_END,this.didClickTipsBtn,this),this.score_btn_nd.on(cc.Node.EventType.TOUCH_END,this.didClickScoreBtn,this);var t=s.getSpinePath("E50065","action");this.loadRes(t,function(t){this.top_anima_sk.skeletonData=t,this.top_anima_sk.setAnimation(0,"status_0",!0)}.bind(this)),this.updageWidget()},updageWidget:function(){this.updateSummonGroupData(),this.refreshWelfarStatus(),this.updateScoreInfo();this.role_vo.recruit_hero},updateSummonGroupData:function(){for(var e=this.model.getSummonGroupData(),i=0;i<e.length;i++){if(!this.item_list[i]){var s=t("partnersummon_item");this.item_list[i]=new s(this.card_content_nd,i,this.startRecruit.bind(this))}this.item_list[i].updateData(e[i])}},refreshWelfarStatus:function(){},updateScoreInfo:function(){var t=this.model.getScoreSummonNeedCount(),e=this.role_vo.recruit_hero,i=0;e>=t?(i=1,this.showScoreFullAction(!0)):(e>=0&&(i=e/t),this.showScoreFullAction(!1));var s=e+"/"+t;this.progress_label_lb.string=s,this.progress_nd.scaleX=i},closeCallBack:function(){gcore.GlobalEvent.fire(o.CloseTaskEffect);var e=t("action_controller");e.getInstance().action_operate&&e.getInstance().action_operate.setVisible(!0),this.ctrl.openPartnerSummonWindow(!1)},didClickCloseBtn:function(){Utils.playButtonSound(ButtonSound.Close),this.ctrl.openPartnerSummonWindow(!1)},didClickTipsBtn:function(){Utils.playButtonSound(ButtonSound.Normal),a.getInstance().openCommonExplainView(!0,Config.recruit_data.data_explain,Utils.TI18N("\u89c4\u5219\u8bf4\u660e"))},didClickScoreBtn:function(){Utils.playButtonSound(ButtonSound.Normal),this.ctrl.openScoreTipWindow(!0)},showScoreFullAction:function(t){if(this.score_btn_nd.angle=-1,this.score_btn_nd.stopAllActions(),t){var e=cc.rotateBy(.05,-10),i=cc.rotateBy(.1,20),s=cc.rotateBy(.05,-10),n=cc.delayTime(.7),a=cc.sequence(e,i,s),o=cc.repeat(a,5),l=cc.sequence(o,n),r=cc.repeatForever(l);this.score_btn_nd.runAction(r)}},startRecruit:function(t,e,i){this.last_recruit={},this.last_recruit.group_id=t,this.last_recruit.times=e,this.last_recruit.recruit_type=i,this.sendRecruitProtocal(t,e,i)},regainRecruit:function(){this.last_recruit&&(1==this.last_recruit.recruit_type&&(this.last_recruit.recruit_type=4),this.sendRecruitProtocal(this.last_recruit.group_id,this.last_recruit.times,this.last_recruit.recruit_type))},sendRecruitProtocal:function(t,e,i){var s;if(s=1==e?500:2e3,this.last_time&&Math.abs((new Date).getTime()-this.last_time)<s)return message(Utils.TI18N("\u70b9\u51fb\u8fc7\u5feb")),void(this.ctrl.getSummonResultRoot()&&this.model.clickIntervalStatus(!0));this.last_time=(new Date).getTime(),this.ctrl.send23201(t,e,i)},playRecruitEffect:function(){var t=this.model.getRecruitData();if(t){var e=this.partnersummon_config[t.group_id],i="action";e&&(i=e.action_name);var n=s.getEffectRes("120"),o=s.getSpinePath(n,"action");this.recruit_ani_bg_nd.active=!0,this.loadRes(o,function(t){this.recruit_ani_sk.skeletonData=t,this.recruit_ani_sk.setAnimation(0,i)}.bind(this));var l="recruit_"+i;Utils.playEffectSound(AUDIO_TYPE.Recruit,l),a.getInstance().setMainUIBottomStatus(!1),a.getInstance().setMainUITopStatus(!1)}},animaComplete:function(){a.getInstance().setMainUIBottomStatus(!0),a.getInstance().setMainUITopStatus(!0),this.recruit_ani_sk.clearTrack(0),this.recruit_ani_bg_nd.active=!1,this.ctrl.openSummonGainWindow(!0)},deleteMe:function(){for(var t in this._super(),this.item_list)this.item_list[t].deleteMe()},getSummonItemRoot:function(t,e){this.root_item_get_cb=e,this.root_item_get_name=t,this.item_list[0]&&this.item_list[0].getSummonItemRoot(t,e)}});cc._RF.pop()},{action_controller:"action_controller",guide_event:"guide_event",mainui_controller:"mainui_controller",partnersummon_const:"partnersummon_const",partnersummon_event:"partnersummon_event",partnersummon_item:"partnersummon_item",pathtool:"pathtool",role_controller:"role_controller"}],paste_panel:[function(t,e,i){"use strict";cc._RF.push(e,"91b96nCP/NMY6PPklWFhPVh","paste_panel");var s=t("pathtool"),n=t("welfare_const");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("welfare","paste_panel")},initConfig:function(){this.ctrl=t("welfare_controller").getInstance(),this.item_list=[]},initPanel:function(){this.item_cons=this.seekChild("item_cons"),this.bg_sp=this.seekChild("bg",cc.Sprite),this.loadRes(s.getBigBg("welfare/txt_cn_paste"),function(t){this.bg_sp.spriteFrame=t}.bind(this))},registerEvent:function(){},onShow:function(t){this.setItemList()},setItemList:function(){var t=Config.holiday_client_data.data_info[n.WelfareIcon.poste];if(null!=t&&null!=t.items){var e=0;for(var i in t.items){var s=t.items[i];if(!this.item_list[i]){var a=ItemsPool.getInstance().getItem("backpack_item");a.initConfig(!1,1,!1,!0),a.show(),a.setParent(this.item_cons),a.setData({bid:s[0],num:s[1]}),a.setPosition(134*e+60,77),this.item_list[i]=a,e+=1}}}},setVisibleStatus:function(t){this.setVisible(t)},onHide:function(){},onDelete:function(){if(this.item_list){for(var t in this.item_list)this.item_list[t].deleteMe(),this.item_list[t]=null;this.item_list=null}}});cc._RF.pop()},{pathtool:"pathtool",welfare_const:"welfare_const",welfare_controller:"welfare_controller"}],pathtool:[function(t,e,i){"use strict";cc._RF.push(e,"5c24ew9BclME7NqSzhzS5RV","pathtool"),window.PathTool={getPrefabPath:function(t,e){return"prefab/"+t+"/"+e+".prefab"},getIconPath:function(t,e,i){var s="png";return i&&(s=i),"res/"+t+"/"+e+"."+s},getUIIconPath:function(t,e,i){var s="png";return i&&(s=i),"ui_res/"+t+"/"+e+"."+s},getResFrame:function(t,e){return"res/"+t+"/"+(e=e||t)+".plist"},getPlistPath:function(t,e){return"res/"+t+"/"+e+".plist"},getHeadRes:function(t){return"res/headicon/"+t+".png"},getHeadcircle:function(t){return"res/headcircle/txt_cn_headcircle_"+t+".png"},getHonorRes:function(t){return"res/honor/txt_cn_honor_"+t+".png"},getWelfareBannerRes:function(t){return"res/welfare/welfare_banner/"+t+".png"},getBigBuffRes:function(t){return"res/bigbufficon/"+t+".png"},getSoundRes:function(t,e){if(t&&e)return cc.js.formatStr("sound/%s/%s.mp3",t,e)},getBigBg:function(t,e,i){return i?i+="/":i="","ui_res/bigbg/"+i+t+"."+(e||"png")},getCommonIcomPath:function(t){return"ui_res/common/"+t+".png"},getItemRes:function(t){return"res/item/"+t+".png"},getBattleSingleBg:function(t){return"ui_res/bigbg/battle_bg/"+t+"/b_bg.jpg"},getBattleSceneRes:function(t,e){return 1==e?"ui_res/bigbg/battle_bg/"+t+".jpg":"ui_res/bigbg/battle_bg/"+t+".png"},getBuffRes:function(t){return"res/bufficon/"+t+".png"},getFunctionRes:function(t){return"res/functionicon/"+t+".png"},getBattleDrameBg:function(t){var e="ui_res/bigbg/battle_bg/"+t;return{s:e+"/map_bg.png",f:e+"/m_bg.png"}},getActivityBig:function(t){return"res/activity/activity_big/"+t+".png"},getSpinePath:function(t,e){return null==e&&(e=PlayerAction.action),-1!==t.indexOf("H")?"spine/"+t+"/"+t+".atlas":"spine/"+t+"/"+e+".atlas"},getBattleFormIcon:function(t){return"res/battleformicon/battle_form_icon_"+t+".png"},getBattleCampIcon:function(t){return"res/battlecamp/battlecamp_"+t+".png"},getBattleCampIconByType:function(e){null==e&&(e=1);var i=t("hero_const");return e==i.CampType.eWater?"res/battlecamp/battlecamp_1001.png":e==i.CampType.eFire?"res/battlecamp/battlecamp_1002.png":e==i.CampType.eWind?"res/battlecamp/battlecamp_1003.png":e==i.CampType.eLight?"res/battlecamp/battlecamp_1004.png":e==i.CampType.eDark?"res/battlecamp/battlecamp_1005.png":"res/battlecamp/battlecamp_1000.png"},getRoundQualityBg:function(t){(t=t||1)>5&&(t=5);var e="mainui_"+(t=2e3+t);return PathTool.getUIIconPath("mainui",e)},getEffectRes:function(t){return gdata("effect_data","data_effect_info",[t])||"E88888"},getItemQualityBG:function(t){return null==t?t=0:t>5&&(t=5),0==t?"common_1005":1==t?"common_1006":2==t?"common_1007":3==t?"common_1008":4==t?"common_1009":"common_1010"},getHeroCampRes:function(t){return null==t?t=1:t>6&&(t=1),1==t?"common_90067":2==t?"common_90068":3==t?"common_90069":4==t?"common_90070":5==t?"common_90071":6==t?"common_90079":void 0},getAttrIconByStr:function(t){return"atk"==t||"atk_per"==t?"common_90021":"hp"==t||"hp_max"==t||"hp_max_per"==t?"common_90022":"def"==t||"def_per"==t?"common_90023":"speed"==t?"common_90038":"crit_rate"==t?"common_90043":"crit_ratio"==t?"common_90039":"hit_magic"==t?"common_90040":"dodge_magic"==t?"common_90037":"tenacity"==t?"common_90021_1":"hit_rate"==t?"common_90021_2":"res"==t?"common_90021_3":"dodge_rate"==t?"common_90021_4":"cure"==t?"common_90021_5":"be_cure"==t?"common_90021_6":"dam"==t?"common_90021_7":"common_90037"},getHeroCampTypeIcon:function(e){null==e&&(e=1);var i=t("hero_const");return e==i.CampType.eWater?"common_90067":e==i.CampType.eFire?"common_90068":e==i.CampType.eWind?"common_90069":e==i.CampType.eLight?"common_90070":e==i.CampType.eLingtDark?"common_90079":"common_90071"},specialBSModel:function(t){return 37300==t||37301==t||37302==t},getPartnerTypeIcon:function(t){var e=45+(t=t||1);return this.getCommonIcomPath("common_900"+e)},getPartnerBustRes:function(t){return t=t||1e4,this.getIconPath("partner",t)},getLogoRes:function(){return"ui_res/login/txt_cn_logo.png"},getSelectBg:function(){return this.getUIIconPath("common","common_90019")}},e.exports=PathTool,cc._RF.pop()},{hero_const:"hero_const"}],playeffect:[function(t,e,i){"use strict";cc._RF.push(e,"2fd13SpS5ZCSashgs6tVCZ1","playeffect");cc.Class({extends:cc.Component,properties:{},ctor:function(){},start:function(){}});cc._RF.pop()},{}],playerhead:[function(t,e,i){"use strict";cc._RF.push(e,"70f383+TA9FNYsybDVLsVk6","playerhead");var s=t("pathtool");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("mainui","head_item")},initPanel:function(){this.container=this.root_wnd.getChildByName("container"),this.icon=this.container.getChildByName("icon").getComponent(cc.Sprite),this.frame=this.root_wnd.getChildByName("frame").getComponent(cc.Sprite),this.lev_container=this.root_wnd.getChildByName("lev_container"),this.lev_container.active=!1,this.lev=this.lev_container.getChildByName("lev").getComponent(cc.Label),this.click_icon=this.root_wnd.getChildByName("click"),null!=this.lev_value&&(this.lev.string=this.lev_value,this.lev_container.active=!0),this.head_res&&this.loadHeadRes(this.head_res),null!=this.frame_res&&this.loadFrameRes(this.frame_res,this.frame_scale),null!=this.scale_value&&this.setScale(this.scale_value),null!=this.grey_bool&&this.setLockStatus(this.grey_bool)},registerEvent:function(){this.call_back&&this.click_icon.on(cc.Node.EventType.TOUCH_END,function(){this.call_back(this)},this)},onShow:function(){},onHide:function(){},addCallBack:function(t){this.call_back=t},setHeadRes:function(t){this.root_wnd?this.loadHeadRes(t):this.head_res=t},setFrameRes:function(t,e){this.root_wnd?this.loadFrameRes(t,e):(this.frame_res=t,this.frame_scale=e)},setLev:function(t){this.root_wnd?(this.lev.string=t,this.lev_container.active=!0):this.lev_value=t},setLockStatus:function(t){this.grey_bool=t,null!=this.root_wnd&&(t?(this.icon.setMaterial(0,cc.Material.getBuiltinMaterial("2d-sprite")),this.frame.setMaterial(0,cc.Material.getBuiltinMaterial("2d-sprite"))):(this.icon.setMaterial(0,cc.Material.getBuiltinMaterial("2d-gray-sprite")),this.frame.setMaterial(0,cc.Material.getBuiltinMaterial("2d-gray-sprite"))))},loadHeadRes:function(t){var e=s.getHeadRes(t);this.loadRes(e,function(t){this.icon.spriteFrame=t}.bind(this))},loadFrameRes:function(t,e){if(null==e&&(e=100/117),"number"==typeof t){var i=Config.avatar_data.data_avatar[t];if(!i)return;var n=s.getHeadcircle(i.res_id);this.loadRes(n,function(t){this.frame.spriteFrame=t}.bind(this)),this.frame.node.scale=e,this.frame.node.y=1e3==t?0:5}else this.loadRes(t,function(t){this.frame.spriteFrame=t}.bind(this)),this.frame.node.scale=e},setScale:function(t){this.scale_value=t,this.root_wnd&&(this.root_wnd.scale=t)},showBg:function(t,e){this.setFrameRes(t,e)},setSex:function(t,e){null!=t&&"number"==typeof t&&(t>=2||(null==this.sex_icon_sp&&(this.sex_icon_sp=Utils.createImage(this.root_wnd,null,0,0,cc.v2(0,0))),this.loadRes(s.getUIIconPath("common","common_sex"+t),function(t){this.sex_icon_sp.spriteFrame=t}.bind(this)),null!=e&&null!=this.sex_icon_sp&&this.sex_icon_sp.node.setPosition(e)))},onDelete:function(){},clearHead:function(){this.icon.spriteFrame=null}});cc._RF.pop()},{pathtool:"pathtool"}],pokedex_comment_item:[function(t,e,i){"use strict";cc._RF.push(e,"a0f5b71SbJAh7wPkWWoWuch","pokedex_comment_item");var s=t("pathtool");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("pokedex","pokedex_comment_item")},initConfig:function(){},initPanel:function(){this.main_panel=this.root_wnd.getChildByName("main_panel"),this.bg=this.main_panel.getChildByName("bg"),this.hot_bg=this.main_panel.getChildByName("hot_bg"),this.hot_bg.active=!1,this.btn2=this.main_panel.getChildByName("btn2"),this.likes_lb=this.btn2.getChildByName("title").getComponent(cc.Label),this.btn2_select=this.btn2.getChildByName("bg_select"),this.btn2_unselect=this.btn2.getChildByName("bg_unselect"),this.btn2_select.active=!1,this.btn2_unselect.active=!0,this.btn1=this.main_panel.getChildByName("btn1"),this.dislike_lb=this.btn1.getChildByName("title").getComponent(cc.Label),this.btn1_select=this.btn1.getChildByName("bg_select"),this.btn1_unselect=this.btn1.getChildByName("bg_unselect"),this.btn1_select.active=!1,this.btn1_unselect.active=!0,this.goods_name_lb=this.main_panel.getChildByName("name").getComponent(cc.Label),this.comment_lb=this.main_panel.getChildByName("comment_label").getComponent(cc.Label),this.data&&this.setData(this.data)},registerEvent:function(){var t=this;t.btn1.on("touchend",function(){t.call_fun&&t.call_fun(t,t.data,0)},this),t.btn2.on("touchend",function(){t.call_fun&&t.call_fun(t,t.data,1)},this)},onShow:function(t){},onHide:function(){},setData:function(t){if(this.data=t,t&&this.root_wnd){var e=t.name||"";this.goods_name_lb.string=e,this.likes_lb.string=t.like_num,this.dislike_lb.string=t.no_like_num;var i=t.msg||"";this.comment_lb.string=i,t._index&&t._index<=3&&(this.hot_bg.active=!0),0==t.is_like?(this.btn1_unselect.active=!1,this.btn1_select.active=!0,this.btn2_unselect.active=!0,this.btn2_select.active=!1):1==t.is_like?(this.btn2_unselect.active=!1,this.btn2_select.active=!0,this.btn1_unselect.active=!0,this.btn1_select.active=!1):(this.btn1_select.active=!1,this.btn1_unselect.active=!0,this.btn2_select.active=!1,this.btn2_unselect.active=!0)}},updateCommentNum:function(t){if(t&&this.data)if(0==(t.type||0)){this.data.is_like=0;var e=this.data.no_like_num;this.dislike_lb.string=e+1,this.btn1_unselect.active=!1,this.btn1_select.active=!0,this.btn2_unselect.active=!0,this.btn2_select.active=!1}else{this.data.is_like=1;var i=this.data.like_num;this.likes_lb.string=i+1,this.btn2_unselect.active=!1,this.btn2_select.active=!0,this.btn1_unselect.active=!0,this.btn1_select.active=!1}},addCallBack:function(t){this.call_fun=t},onDelete:function(){}});cc._RF.pop()},{pathtool:"pathtool"}],pokedex_controller:[function(t,e,i){"use strict";cc._RF.push(e,"0bcfflnB4FJFKqb5h4viHFs","pokedex_controller");t("role_controller");var s=t("pokedex_event"),n=cc.Class({extends:BaseController,ctor:function(){},initConfig:function(){var e=t("pokedex_model");this.model=new e,this.model.initConfig()},getModel:function(){return this.model},registerEvents:function(){},registerProtocals:function(){this.RegisterProtocal(11041,this.handle11041.bind(this)),this.RegisterProtocal(11042,this.handle11042.bind(this)),this.RegisterProtocal(11043,this.handle11043.bind(this)),this.RegisterProtocal(11044,this.handle11044.bind(this)),this.RegisterProtocal(11046,this.handle11046.bind(this)),this.RegisterProtocal(11047,this.handle11047.bind(this))},handle11041:function(t){gcore.GlobalEvent.fire(s.Comment_List_Event,t)},handle11042:function(t){message(t.msg),1==t.result&&gcore.GlobalEvent.fire(s.Comment_Like_Event,t)},handle11043:function(t){message(t.msg),1==t.result&&gcore.GlobalEvent.fire(s.Comment_Say_Event,t)},handle11044:function(t){message(t.msg),1==t.result&&gcore.GlobalEvent.fire(s.Comment_Zan_Event,t)},handle11046:function(t){(message(t.msg),t)&&(this.model.getAllData().all_star=t.new_star)},handle11047:function(t){message(t.msg);if(1==t.result){var e=Config.partner_data.data_pokedex_attr,i=this.model.getAllData(),n=i.lev;if(!n)return;i.lev=t.lev;var a=Math.min(t.lev+1,tableLen(e)),o=Config.partner_data.data_pokedex_attr[a];this.star_data={old_star:i.all_star,new_star:o.star,old_lev:n,cur_lev:t.lev},this.star_data&&this.openStarUpWindow(!0,this.star_data),gcore.GlobalEvent.fire(s.Up_End_Event,this.star_data)}},openCommentWindow:function(e,i,s){if(0==e)this.commentWindow&&(this.commentWindow.close(),this.commentWindow=null);else{if(!this.commentWindow){var n=t("partner_comment_window");this.commentWindow=new n}0==this.commentWindow.isOpen()&&(this.commentWindow.open(i),s&&this.commentWindow.addCallBack(s))}},openStarUpWindow:function(t,e){},sender11041:function(t,e,i){var s={};s.partner_id=t,s.start=e,s.num=i,this.SendProtocal(11041,s)},sender11043:function(t,e){var i={};i.partner_id=t,i.msg=e,this.SendProtocal(11043,i)},sender11042:function(t){var e={};e.partner_id=t,this.SendProtocal(11042,e)},sender11044:function(t,e,i){var s={};s.partner_id=t,s.comment_id=e,s.type=i,this.SendProtocal(11044,s)}});e.exports=n,cc._RF.pop()},{partner_comment_window:"partner_comment_window",pokedex_event:"pokedex_event",pokedex_model:"pokedex_model",role_controller:"role_controller"}],pokedex_event:[function(t,e,i){"use strict";cc._RF.push(e,"9d8a8hSofNAn7lZdo3no/VV","pokedex_event"),e.exports={Get_All_Event:"PokedexEvent.Get_All_Event",Comment_List_Event:"PokedexEvent.Comment_List_Event",Comment_Like_Event:"PokedexEvent.Comment_Like_Event",Comment_Zan_Event:"PokedexEvent.Comment_Zan_Event",Comment_Say_Event:"PokedexEvent.Comment_Say_Event",Call_End_Event:"PokedexEvent.Call_End_Event",Up_End_Event:"PokedexEvent.Up_End_Event"},cc._RF.pop()},{}],pokedex_model:[function(t,e,i){"use strict";cc._RF.push(e,"a62fdlsGkJDnp1kj4chhtEi","pokedex_model");cc.Class({extends:BaseClass,ctor:function(){},properties:{},initConfig:function(){this.all_data={}},getAllData:function(){if(this.all_data)return this.all_data}});cc._RF.pop()},{}],primus_challenge_record_item_panel:[function(t,e,i){"use strict";cc._RF.push(e,"b6ce9UXJydHrIVX9oBf9Ess","primus_challenge_record_item_panel");var s=t("pathtool"),n=t("timetool"),a=t("hero_vo"),o=t("common_scrollview");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("primus","primus_challenge_record_item")},initConfig:function(){},initPanel:function(){this.size=cc.size(616,218),this.container=this.root_wnd.getChildByName("container"),this.name_label=this.container.getChildByName("name_label").getComponent(cc.Label),this.time_label=this.container.getChildByName("time_label").getComponent(cc.Label),this.attk_label=this.container.getChildByName("attk_label").getComponent(cc.Label),this.magic_label=this.container.getChildByName("magic_label").getComponent(cc.Label);var t=this.container.getChildByName("result_node");this.result_label=Utils.createRichLabel(22,new cc.Color(255,255,255,255),cc.v2(1,.5),cc.v2(0,0),30),this.result_label.horizontalAlign=cc.macro.TextAlignment.RIGHT,t.addChild(this.result_label.node),this.vedio_btn=this.container.getChildByName("vedio_btn"),this.role_list=this.container.getChildByName("role_list");var e=this.role_list.getContentSize();this.scroll_view_size=cc.size(e.width-10,e.height);this.scroll_view=new o,this.scroll_view.createScroll(this.role_list,cc.v2(8,0),ScrollViewDir.horizontal,null,cc.size(this.scroll_view_size.width,this.scroll_view_size.height),{item_class:"hero_exhibition_item",start_x:0,space_x:6,start_y:0,space_y:0,item_width:96,item_height:96,row:1,once_num:5,need_dynamic:!0,scale:.8}),this.data&&this.updateInfo()},registerEvent:function(){Utils.onTouchEnd(this.vedio_btn,function(){this.data&&this.data.replay_id&&t("battle_controller").getInstance().csRecordBattle(this.data.replay_id)}.bind(this),1)},updateInfo:function(){if(this.root_wnd){this.name_label.string=cc.js.formatStr(Utils.TI18N("\u6311\u6218\u8005\uff1a%s"),this.data.name),this.attk_label.string=cc.js.formatStr(Utils.TI18N("\u6218\u529b\uff1a%d"),this.data.power),this.time_label.string=n.getYMDHMS(this.data.time);var t=Config.formation_data.data_form_data[this.data.formation_type];t&&(this.magic_label.string=t.name);this.data.num;this.result_label.string=cc.js.formatStr(Utils.TI18N("<color=#A95F0F>\u6311\u6218\u8fdb\u5316<color=#249003>%s\u6b21</color>\u6210\u529f</color>"),this.data.num);var e=[];for(var i in this.data.partner_list){var s=new a;s.updateHeroVo(this.data.partner_list[i]),e.push(s)}this.scroll_view.setData(e)}},setData:function(t){this.data=t,this.updateInfo()},onShow:function(t){},onHide:function(){},onDelete:function(){this.scroll_view&&(this.scroll_view.deleteMe(),this.scroll_view=null)}});cc._RF.pop()},{battle_controller:"battle_controller",common_scrollview:"common_scrollview",hero_vo:"hero_vo",pathtool:"pathtool",timetool:"timetool"}],primus_challenge_record_window:[function(t,e,i){"use strict";cc._RF.push(e,"7983aATzbtG0qZYT9X4iaGn","primus_challenge_record_window");var s=t("pathtool"),n=t("common_scrollview"),a=t("primus_challenge_record_item_panel");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("primus","primus_challenge_record_panel"),this.viewTag=SCENE_TAG.ui,this.win_type=WinType.Mini,this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){},openCallBack:function(){this.background=this.root_wnd.getChildByName("background"),this.background.scale=FIT_SCALE;var t=this.root_wnd.getChildByName("container");this.container=t,t.getChildByName("win_title").getComponent(cc.Label).string=Utils.TI18N("\u6311\u6218\u8bb0\u5f55"),this.close_btn=t.getChildByName("close_btn"),this.no_vedio_image=t.getChildByName("no_vedio_image"),this.loadRes(s.getBigBg("bigbg_3"),function(t){this.no_vedio_image&&(this.no_vedio_image.getComponent(cc.Sprite).spriteFrame=t)}.bind(this)),this.no_vedio_label=t.getChildByName("no_vedio_label"),this.time_label=t.getChildByName("time_label"),this.list_panel=t.getChildByName("list_panel");var e=this.list_panel.getContentSize(),i=cc.size(e.width,e.height-8),o={item_class:a,start_x:0,space_x:0,start_y:0,space_y:0,item_width:616,item_height:218,row:0,col:1,delay:6};this.item_scrollview=new n,this.item_scrollview.createScroll(this.list_panel,cc.v2(0,5),ScrollViewDir.vertical,ScrollViewStartPos.top,i,o)},registerEvent:function(){Utils.onTouchEnd(this.background,function(){this.ctrl.openPrimusChallengeRecordPanel(!1)}.bind(this),1),Utils.onTouchEnd(this.close_btn,function(){this.ctrl.openPrimusChallengeRecordPanel(!1)}.bind(this),2)},setData:function(t){(t=t||{}).list&&null!=Utils.next(t.list)?(this.item_scrollview.setData(t.list),this.no_vedio_image.active=!1,this.no_vedio_label.active=!1):(this.no_vedio_image.active=!0,this.no_vedio_label.active=!0)},openRootWnd:function(t){this.setData(t)},closeCallBack:function(){this.item_scrollview&&(this.item_scrollview.deleteMe(),this.item_scrollview=null),this.ctrl.openPrimusChallengeRecordPanel(!1)}});cc._RF.pop()},{common_scrollview:"common_scrollview",pathtool:"pathtool",primus_challenge_record_item_panel:"primus_challenge_record_item_panel"}],primus_challenge_result_item_panel:[function(t,e,i){"use strict";cc._RF.push(e,"79a2dOAcjNLHrUY/vwHxGQs","primus_challenge_result_item_panel");var s=t("pathtool"),n=t("partner_calculate");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("primus","primus_challenge_result_item ")},initConfig:function(){this.is_completed=!1},initPanel:function(){this.init_pos_y=this.root_wnd.y,this.item_name=this.root_wnd.getChildByName("item_name").getComponent(cc.Label),this.item_num=this.root_wnd.getChildByName("item_num").getComponent(cc.Label),this.data&&this.updateInfo()},updateInfo:function(){if(this.root_wnd&&this.data){var t=Config.attr_data.data_key_to_name[this.data[0]];if(this.item_name.string=t,n.isShowPerByStr(this.data[0])){var e=this.data[1]/10;this.item_num.string=e+"%"}else this.item_num.string=this.data[1]}},setData:function(t){this.data=t,this.updateInfo()},registerEvent:function(){},onShow:function(t){},onHide:function(){},onDelete:function(){}});cc._RF.pop()},{partner_calculate:"partner_calculate",pathtool:"pathtool"}],primus_challenge_result_window:[function(t,e,i){"use strict";cc._RF.push(e,"57876sOK9JAB7FwHa4QQqvh","primus_challenge_result_window");var s=t("pathtool"),n=t("common_scrollview"),a=t("role_controller"),o=t("primus_challenge_result_item_panel");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("primus","primus_challenge_result_window"),this.viewTag=SCENE_TAG.ui,this.win_type=WinType.Full,this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){},openCallBack:function(){this.background=this.root_wnd.getChildByName("background"),this.background.scale=FIT_SCALE,this.main_container=this.root_wnd.getChildByName("main_container"),this.title_container=this.main_container.getChildByName("title_container"),this.title_width=this.title_container.getContentSize().width,this.title_height=this.title_container.getContentSize().height,this.title_img=this.main_container.getChildByName("title_img").getComponent(cc.Sprite),this.harm_btn=this.main_container.getChildByName("harm_btn"),this.harm_btn.active=!1,this.list_view=this.root_wnd.getChildByName("list_view");var t=this.list_view.getContentSize(),e={item_class:o,start_x:0,space_x:0,start_y:8,space_y:12,item_width:720,item_height:43,row:0,col:1,need_dynamic:!0};this.scroll_view=new n,this.scroll_view.createScroll(this.list_view,null,null,null,t,e),this.goto_btn=this.main_container.getChildByName("goto_btn"),this.goto_btn.getChildByName("label").getComponent(cc.Label).string=Utils.TI18N("\u524d\u5f80\u88c5\u5907\u79f0\u53f7"),this.comfirm_btn=this.main_container.getChildByName("comfirm_btn"),this.comfirm_btn.getChildByName("label").getComponent(cc.Label).string=Utils.TI18N("\u786e \u5b9a")},registerEvent:function(){Utils.onTouchEnd(this.background,function(){this.ctrl.openPrimusChallengeResultWindow(!1)}.bind(this),1),Utils.onTouchEnd(this.goto_btn,function(){this._onGoToEquipTitle()}.bind(this),2),Utils.onTouchEnd(this.comfirm_btn,function(){this.ctrl.openPrimusChallengeResultWindow(!1)}.bind(this),2),Utils.onTouchEnd(this.harm_btn,function(){this._onClickHarmBtn()}.bind(this),1)},_onClickHarmBtn:function(){this.data&&null!=Utils.next(this.data)&&t("battle_controller").getInstance().openBattleHarmInfoView(!0,this.data)},_onGoToEquipTitle:function(){this.ctrl.openPrimusChallengeResultWindow(!1),a.getInstance().openRoleDecorateView(!0,4)},openRootWnd:function(t){if(this.handleEffect(!0),t&&(this.data=t,this.harm_btn.active=!0),this.local_data=Config.primus_data.data_upgrade[t.pos],this.local_data){var e=Config.honor_data.data_title[this.local_data.honor_id];if(this.scroll_view.setData(e.attr),e&&this.title_img){var i=s.getHonorRes(e.res_id);this.loadRes(i,function(t){this.title_img&&(this.title_img.spriteFrame=t)}.bind(this))}}},handleEffect:function(t){if(0==t)this.play_effect&&(this.play_effect.setToSetupPose(),this.play_effect.clearTracks(),this.play_effect=null);else{var e=PlayerAction.action_3;if(this.title_container&&null==this.play_effect){var i=new cc.Node;i.setAnchorPoint(.5,.5),i.setPosition(0,10),this.title_container.addChild(i,0),this.play_effect=i.addComponent(sp.Skeleton);var n=s.getSpinePath(s.getEffectRes(274),"action");this.loadRes(n,function(t){this.play_effect&&(this.play_effect.skeletonData=t,this.play_effect.setAnimation(0,e,!1))}.bind(this))}}},closeCallBack:function(){this.scroll_view&&(this.scroll_view.deleteMe(),this.scroll_view=null),this.handleEffect(!1),this.ctrl.openPrimusChallengeResultWindow(!1)}});cc._RF.pop()},{battle_controller:"battle_controller",common_scrollview:"common_scrollview",pathtool:"pathtool",primus_challenge_result_item_panel:"primus_challenge_result_item_panel",role_controller:"role_controller"}],primus_challenge_window:[function(t,e,i){"use strict";cc._RF.push(e,"bc034lVSFJIUoazB/hWXMt2","primus_challenge_window");var s=t("pathtool"),n=t("role_controller"),a=t("arena_controller"),o=t("playerhead"),l=t("friend_controller"),r=t("partner_calculate"),c=t("baserole");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("primus","primus_challenge_panel"),this.viewTag=SCENE_TAG.ui,this.win_type=WinType.Mini,this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){this.attr_label_list=[],this.attr_icon_list=[],this.checkbox_list=[],this.checkbox_counts=[1,5,10],this.act_skill_item_list=[],this.passive_skill_item_list=[],this.skill_width=88},openCallBack:function(){this.background=this.root_wnd.getChildByName("background"),this.background.scale=FIT_SCALE,this.main_container=this.root_wnd.getChildByName("main_container"),this.main_panel=this.main_container.getChildByName("main_panel"),this.close_btn=this.main_panel.getChildByName("close_btn"),this.win_title=this.main_panel.getChildByName("win_title").getComponent(cc.Label),this.win_title.string=Utils.TI18N("\u795e\u6bbf\u6311\u6218"),this.primus_bigbg_3_node=this.main_panel.getChildByName("primus_bigbg_3"),this.primus_bigbg_3_node.scale=2,this.primus_bigbg_3=this.primus_bigbg_3_node.getComponent(cc.Sprite),this.loadRes(s.getBigBg("primus_bigbg_3",null,"primus"),function(t){this.primus_bigbg_3&&(this.primus_bigbg_3.spriteFrame=t)}.bind(this)),this.record_btn=this.main_panel.getChildByName("record_btn");var t=this.main_panel.getChildByName("station_lay");this.mode_node=t.getChildByName("mode_node"),this.occupant_tips=t.getChildByName("occupant_tips").getComponent(cc.Label),this.tips_node=t.getChildByName("tips_node"),this.head_node=t.getChildByName("head_node"),this.title_img=t.getChildByName("title_img").getComponent(cc.Sprite),this.name=t.getChildByName("name").getComponent(cc.Label),this.name_bg=t.getChildByName("name_bg");var e=this.main_panel.getChildByName("boss_panel"),i=e.getChildByName("desc_label").getComponent(cc.Label),n=e.getChildByName("desc_label_1").getComponent(cc.Label),a=e.getChildByName("desc_label_2").getComponent(cc.Label);i.string=Utils.TI18N("Boss\u6280\u80fd"),n.string=Utils.TI18N("\u4e3b\u52a8\u6280\u80fd"),a.string=Utils.TI18N("\u88ab\u52a8\u6280\u80fd"),this.item_container_1=e.getChildByName("item_container_1").getChildByName("content"),this.item_container_2=e.getChildByName("item_container_2").getChildByName("content"),this.attr_panel=this.main_panel.getChildByName("attr_panel"),this.arrt_title=this.attr_panel.getChildByName("title").getComponent(cc.Label);for(var o=0;o<4;o++)this.attr_label_list[o]=this.attr_panel.getChildByName("attr_label"+(o+1)).getComponent(cc.Label),this.attr_icon_list[o]=this.attr_panel.getChildByName("attr_icon"+(o+1)).getComponent(cc.Sprite);this.arrt_title.string=Utils.TI18N("\u795e\u4f4d\u79f0\u53f7\u5c5e\u6027\u52a0\u6210");var l=this.main_panel.getChildByName("box_panel");this.checkbox_list[0]=l.getChildByName("checkbox1"),this.checkbox_list[1]=l.getChildByName("checkbox5"),this.checkbox_list[2]=l.getChildByName("checkbox10");var r=this.checkbox_list[0].getChildByName("name").getComponent(cc.Label);r.string=cc.js.formatStr(Utils.TI18N("\u8fdb\u5316%s\u6b21"),this.checkbox_counts[0]),(r=this.checkbox_list[1].getChildByName("name").getComponent(cc.Label)).string=cc.js.formatStr(Utils.TI18N("\u8fdb\u5316%s\u6b21"),this.checkbox_counts[1]),(r=this.checkbox_list[2].getChildByName("name").getComponent(cc.Label)).string=cc.js.formatStr(Utils.TI18N("\u8fdb\u5316%s\u6b21"),this.checkbox_counts[2]),this.select_checkbox=0,this.warning_tips=l.getChildByName("warning_tips").getComponent(cc.Label),this.warning_tips.string=Utils.TI18N("(\u96be\u5ea6\u5927\u8bf7\u8c28\u614e)"),this.tips_name=this.main_panel.getChildByName("tips_name").getComponent(cc.Label),this.challenge_btn=this.main_panel.getChildByName("challenge_btn");var c=this.main_panel.getChildByName("goto_node");this.gotoe_label=Utils.createRichLabel(24,new cc.Color(36,144,3,255),cc.v2(0,.5),cc.v2(0,0),30,125),this.gotoe_label.horizontalAlign=cc.macro.TextAlignment.LEFT,this.gotoe_label.string=cc.js.formatStr("<u>%s</u>",Utils.TI18N("\u524d\u5f80\u7ade\u6280\u573a")),c.addChild(this.gotoe_label.node);var _=this.main_panel.getChildByName("tips_node");this.tips_label=Utils.createRichLabel(22,new cc.Color(169,95,16,255),cc.v2(.5,.5),cc.v2(0,0),30,1280),_.addChild(this.tips_label.node)},registerEvent:function(){for(var e in Utils.onTouchEnd(this.gotoe_label.node,function(){t("arena_controller").getInstance().requestOpenArenWindow(),this.ctrl.openPrimusChallengePanel(!1)}.bind(this),1),Utils.onTouchEnd(this.close_btn,function(){this.ctrl.openPrimusChallengePanel(!1)}.bind(this),2),Utils.onTouchEnd(this.record_btn,function(){this._onClickChallengeRecordBtn()}.bind(this),2),Utils.onTouchEnd(this.challenge_btn,function(){this._onClickChallengeBtn()}.bind(this),2),this.checkbox_list)Utils.onTouchEnd(this.checkbox_list[e],function(t){if(this.sever_data){this.select_checkbox=t,this.setSelectCheckBox();var e=this.sever_data.num+this.checkbox_counts[t];this.initBossSkill(e)}}.bind(this,e),1)},_onClickChallengeBtn:function(){if(this.sever_data){var e=function(){var t=this.checkbox_counts[this.select_checkbox];this.ctrl.sender20702(this.sever_data.pos,t)}.bind(this);if(this.is_have_title)t("commonalert").show(Utils.TI18N("\u60a8\u5f53\u524d\u5df2\u5360\u6709\u4e00\u4e2a\u795e\u4f4d\uff0c\u82e5\u6311\u6218\u5176\u4ed6\u795e\u4f4d\u6210\u529f\uff0c\u5c06\u5931\u53bb\u539f\u6709\u795e\u4f4d\uff0c\u662f\u5426\u7ee7\u7eed\u6311\u6218\uff1f"),Utils.TI18N("\u786e\u5b9a"),e,Utils.TI18N("\u53d6\u6d88"));else e()}},_onClickChallengeRecordBtn:function(){this.sever_data&&this.ctrl.sender20703(this.sever_data.pos)},openRootWnd:function(t){if(t&&!(t.length<2)){this.is_have_title=t[1],this.sever_data=t[0],this.var_data=Config.primus_data.data_upgrade[this.sever_data.pos];var e=Config.honor_data.data_title[this.var_data.honor_id];if(e&&this.title_img){var i=s.getHonorRes(e.res_id);this.loadRes(i,function(t){this.title_img&&(this.title_img.spriteFrame=t)}.bind(this))}if(this.tips_node&&this.var_data){var a=cc.js.formatStr(Utils.TI18N("<color=#ffffff>\u5df2\u8fdb\u5316<color=#14ff32>%s</color>\u6b21</color>"),this.sever_data.num),o=Utils.createRichLabel(24,new cc.Color(255,255,255,255),cc.v2(.5,.5),cc.v2(0,0),30);o.string=a,this.tips_node.addChild(o.node)}if(null!=this.sever_data.name||""!=this.sever_data.name){var l=n.getInstance().getRoleVo();l&&this.sever_data.rid==l.rid&&this.sever_data.srv_id==l.srv_id&&(this.tips_name.string=Utils.TI18N("\u5df2\u5360\u9886\u795e\u4f4d"),this.challenge_btn.active=!1,this.gotoe_label.node.active=!1)}this.var_data&&this.updateSpine(this.var_data.look_id),this.initHeadUi(),this.initBossSkill(this.sever_data.num),this.initHonorAttribute(),this.setSelectCheckBox(),this.updateTipsLabel()}},updateTipsLabel:function(){var t=a.getInstance().getModel().getMyLoopData();this.tips_label&&this.var_data&&(t&&t.rank&&t.rank>0?this.tips_label.string=cc.js.formatStr(Utils.TI18N("\u6311\u6218\u6761\u4ef6:\u5f53\u524d\u7ade\u6280\u573a\u5904\u4e8e\u524d%s\u540d(\u6211\u7684\u6392\u540d:<color=#249003>%s</color>)"),this.var_data.arena_rank,t.rank):this.tips_label.string=cc.js.formatStr(Utils.TI18N("\u6311\u6218\u6761\u4ef6:\u5f53\u524d\u7ade\u6280\u573a\u5904\u4e8e\u524d%s\u540d(\u6211\u7684\u6392\u540d:<color=#249003>\u65e0</color>)"),this.var_data.arena_rank))},initHeadUi:function(){if(this.sever_data){if(null==this.sever_data.name||""==this.sever_data.name)return this.occupant_tips.string=Utils.TI18N("\u865a\u4f4d\u4ee5\u5f85"),this.name_bg.active=!1,void(this.name.node.active=!1);this.play_head=new o,this.play_head.setPosition(0,0),this.sever_data.lev&&this.play_head.setLev(this.sever_data.lev),this.play_head.setParent(this.head_node),this.play_head.show(),this.play_head.setHeadRes(this.sever_data.face_id),this.name.string=this.sever_data.name,this.play_head.addCallBack(function(){l.getInstance().openFriendCheckPanel(!0,{srv_id:this.sever_data.srv_id,rid:this.sever_data.rid})}.bind(this))}},initHonorAttribute:function(){if(this.var_data&&this.attr_label_list&&this.attr_icon_list){var t=Config.honor_data.data_title[this.var_data.honor_id];if(t)for(var e in this.attr_label_list){var i=this.attr_icon_list[e];if(t.attr[e]){this.attr_label_list[e].node.active=!0;var n=Config.attr_data.data_key_to_name[t.attr[e][0]];if(r.isShowPerByStr(t.attr[e][0])){var a=t.attr[e][1]/10;this.attr_label_list[e].string=cc.js.formatStr("%s + %s%",Utils.TI18N(n),a)}else this.attr_label_list[e].string=cc.js.formatStr("%s + %s ",Utils.TI18N(n),t.attr[e][1]);if(i){i.node.active=!0;var o=s.getAttrIconByStr(t.attr[e][0]),l=s.getCommonIcomPath(o);this.loadRes(l,function(t,e){t&&(t.spriteFrame=e)}.bind(this,i))}}else this.attr_label_list[e].node.active=!1,i&&(i.node.active=!1)}}},initBossSkill:function(t){if(null==this.unit_data_list)for(var e in this.unit_data_list=[],Config.primus_data.data_unitdata)this.sever_data.pos==Config.primus_data.data_unitdata[e].pos&&this.unit_data_list.push(Config.primus_data.data_unitdata[e]);var i=null,s=this.unit_data_list.length;for(var n in this.unit_data_list){if(t>=this.unit_data_list[n].min&&t<=this.unit_data_list[n].max){i=this.unit_data_list[n];break}n+1==s&&(i=this.unit_data_list[n])}if(null!=i&&(!this.cur_unit_data||this.cur_unit_data.min!=i.min)){this.cur_unit_data=i;var a=i.act_skill,o=i.passive_skill,l=this.skill_width*a.length,r=Math.max(this.item_container_1.getContentSize().width,l);for(var e in this.item_container_1.setContentSize(cc.size(r,this.item_container_1.getContentSize().height)),a){(c=gdata("skill_data","data_get_skill",a[e]))?(null==this.act_skill_item_list[e]?(this.act_skill_item_list[e]={},this.act_skill_item_list[e]=this.updateSkillItem(c,this.act_skill_item_list[e],!0),this.item_container_1.addChild(this.act_skill_item_list[e].con)):this.updateSkillItem(c,this.act_skill_item_list[e]),this.act_skill_item_list[e].con.setPosition((this.skill_width+5)*e+this.skill_width/2,this.skill_width/2)):console.log(cc.js.formatStr("\u6280\u80fd\u8868id: %s \u6ca1\u53d1\u73b0",a[e].toString()))}l=this.skill_width*o.length,r=Math.max(this.item_container_2.getContentSize().width,l);for(var e in this.item_container_2.setContentSize(cc.size(r,this.item_container_2.getContentSize().height)),o){var c;(c=gdata("skill_data","data_get_skill",o[e]))?(null==this.passive_skill_item_list[e]?(this.passive_skill_item_list[e]={},this.passive_skill_item_list[e]=this.updateSkillItem(c,this.passive_skill_item_list[e],!1),this.item_container_2.addChild(this.passive_skill_item_list[e].con)):this.updateSkillItem(c,this.passive_skill_item_list[e]),this.passive_skill_item_list[e].con.setPosition((this.skill_width+5)*e+this.skill_width/2,this.skill_width/2)):console.log(cc.js.formatStr("\u6280\u80fd\u8868id: %s \u6ca1\u53d1\u73b0",o[e].toString()))}}},updateSpine:function(t){if(t){var e=function(){this.spine||(this.spine=new c,this.spine.setParent(this.mode_node),this.spine.node.setPosition(0,76),this.spine.node.setAnchorPoint(cc.v2(.5,.5)),this.spine.setData(c.type.role,t,PlayerAction.show,!0,.75))}.bind(this);if(this.spine){var i=cc.fadeOut(.2);this.spine.node.runAction(cc.sequence(i,cc.CallFunc(function(){this.spine.node.stopAllActions(),this.spine.deleteMe(),this.spine=null,e()})))}else e()}},updateSkillItem:function(e,i,n){var a=cc.size(this.skill_width,this.skill_width);cc.size(this.skill_width-4,this.skill_width-4);if(i.config=e,null==i.con){var o=new cc.Node;o.setContentSize(a),o.scale=.75,Utils.onTouchEnd(o,function(){i.config&&t("tips_controller").getInstance().showSkillTips(i.config)}.bind(this),1),i.con=o;var l=s.getCommonIcomPath("common_1005"),r=Utils.createImage(o,null,0,0,cc.v2(.5,.5),!0,0);this.loadRes(l,function(t,e){t&&(t.spriteFrame=e)}.bind(this,r))}l=s.getIconPath("skillicon",e.icon);return null==i.icon?(i.icon=Utils.createImage(i.con,null,0,0,cc.v2(.5,.5),!1,0,!1),this.loadRes(l,function(t){i&&i.icon&&(i.icon.spriteFrame=t)}.bind(this))):this.loadRes(l,function(t){i&&i.icon&&(i.icon.spriteFrame=t)}.bind(this)),null==i.lev_label?i.lev_label=Utils.createLabel(26,new cc.Color(255,255,255,255),new cc.Color(0,0,0,255),this.skill_width/2+10,-this.skill_width/2-20,e.level.toString(),i.con,2,cc.v2(1,0)):i.lev_label.string=e.level.toString(),i},setSelectCheckBox:function(){if(this.select_checkbox&&this.checkbox_list)for(var t in this.checkbox_list)this.select_checkbox==t?this.checkbox_list[t].getComponent(cc.Toggle).check():this.checkbox_list[t].getComponent(cc.Toggle).uncheck()},closeCallBack:function(){this.spine&&(this.spine.deleteMe(),this.spine=null),this.play_head&&(this.play_head.deleteMe(),this.play_head=null),this.ctrl.openPrimusChallengePanel(!1)}});cc._RF.pop()},{arena_controller:"arena_controller",baserole:"baserole",commonalert:"commonalert",friend_controller:"friend_controller",partner_calculate:"partner_calculate",pathtool:"pathtool",playerhead:"playerhead",role_controller:"role_controller",tips_controller:"tips_controller"}],primus_controller:[function(t,e,i){"use strict";cc._RF.push(e,"37b0araJRtEkKK/cygIgYP6","primus_controller");var s=cc.Class({extends:BaseController,ctor:function(){},initConfig:function(){var e=t("primus_model");this.model=new e,this.model.initConfig()},getModel:function(){return this.model},registerEvents:function(){},registerProtocals:function(){this.RegisterProtocal(20700,this.handle20700),this.RegisterProtocal(20701,this.handle20701),this.RegisterProtocal(20702,this.handle20702),this.RegisterProtocal(20703,this.handle20703),this.RegisterProtocal(20705,this.handle20705)},requestPrimusChallengeCount:function(){this.SendProtocal(20700,{})},handle20700:function(e){this.model.recordChallengeCount(e);var i=t("primus_event");gcore.GlobalEvent.fire(i.Updata_Primus_RedPoint)},sender20701:function(){this.SendProtocal(20701,{})},handle20701:function(t){t&&this.primus_main_window&&this.primus_main_window.setData(t)},sender20702:function(t,e){var i={};i.pos=t,i.num=e,this.SendProtocal(20702,i)},handle20702:function(t){message(t.msg),1==t.code&&this.openPrimusChallengePanel(!1)},sender20703:function(t){var e={};e.pos=t,this.SendProtocal(20703,e)},handle20703:function(t){this.openPrimusChallengeRecordPanel(!0,t)},handle20705:function(t){this.openPrimusChallengeResultWindow(!0,t)},openPrimusMainWindow:function(e){if(0==e)null!=this.primus_main_window&&(this.primus_main_window.close(),this.primus_main_window=null);else{var i=t("esecsice_const"),s=Config.dailyplay_data.data_exerciseactivity[i.execsice_index.honourfane];if(null==s)return void message(Utils.TI18N("\u661f\u6cb3\u795e\u6bbf\u6570\u636e\u5f02\u5e38"));if(0==t("mainui_controller").getInstance().checkIsOpenByActivate(s.activate))return void message(s.lock_desc);this.model.is_show_redpoint=!1,null==this.primus_main_window&&(this.primus_main_window=Utils.createClass("primus_main_window",this)),this.primus_main_window&&0==this.primus_main_window.isOpen()&&this.primus_main_window.open()}},openPrimusChallengePanel:function(t,e,i){0==t?null!=this.primus_challenge_panel&&(this.primus_challenge_panel.close(),this.primus_challenge_panel=null):null==this.primus_challenge_panel&&(this.primus_challenge_panel=Utils.createClass("primus_challenge_window",this),this.primus_challenge_panel&&0==this.primus_challenge_panel.isOpen()&&this.primus_challenge_panel.open([e,i]))},openPrimusChallengeRecordPanel:function(t,e){0==t?null!=this.primus_challenge_record_panel&&(this.primus_challenge_record_panel.close(),this.primus_challenge_record_panel=null):(null==this.primus_challenge_record_panel&&(this.primus_challenge_record_panel=Utils.createClass("primus_challenge_record_window",this)),this.primus_challenge_record_panel&&0==this.primus_challenge_record_panel.isOpen()&&this.primus_challenge_record_panel.open(e))},openPrimusChallengeResultWindow:function(t,e){0==t?null!=this.primus_challenge_result_window&&(this.primus_challenge_result_window.close(),this.primus_challenge_result_window=null):(null==this.primus_challenge_result_window&&(this.primus_challenge_result_window=Utils.createClass("primus_challenge_result_window",this)),this.primus_challenge_result_window&&0==this.primus_challenge_result_window.isOpen()&&this.primus_challenge_result_window.open(e))},checkIsCanOpenPrimusWindow:function(){var e=t("role_controller").getInstance().getRoleVo(),i=e&&e.lev||0,s=Config.primus_data.data_const.open_lev.val;return!(i<s)||(message(cc.js.formatStr(Utils.TI18N('\u7b49\u7ea7\u8fbe\u5230%s\u7ea7\u5f00\u542f"\u661f\u6cb3\u795e\u6bbf"\u73a9\u6cd5'),s)),!1)},__delete:function(){null!=this.model&&(this.model.DeleteMe(),this.model=null)}});e.exports=s,cc._RF.pop()},{esecsice_const:"esecsice_const",mainui_controller:"mainui_controller",primus_event:"primus_event",primus_model:"primus_model",role_controller:"role_controller"}],primus_event:[function(t,e,i){"use strict";cc._RF.push(e,"c7f937oTftL8KCnn+PdwgIP","primus_event");var s={Updata_Primus_RedPoint:"PrimusEvent.Updata_Primus_RedPoint"};e.exports=s,cc._RF.pop()},{}],primus_main_window:[function(t,e,i){"use strict";cc._RF.push(e,"4873e7BaVROM5aUlgXt2UcB","primus_main_window");var s=t("pathtool"),n=t("role_controller"),a=t("baserole");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("primus","primus_main_window"),this.viewTag=SCENE_TAG.ui,this.win_type=WinType.Full,this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){this.station_list=[],this.tips_list=[],this.is_have_title=!1},openCallBack:function(){this.background=this.root_wnd.getChildByName("background"),this.background.scale=FIT_SCALE,this.background_bg=this.root_wnd.getChildByName("background").getComponent(cc.Sprite),this.loadRes(s.getBigBg("primus_bigbg_1","jpg","primus"),function(t){this.background_bg&&(this.background_bg.spriteFrame=t)}.bind(this)),this.main_container=this.root_wnd.getChildByName("main_container"),this.primus_bigbg_2_node=this.main_container.getChildByName("primus_bigbg_2"),this.primus_bigbg_2_node.scale=2,this.primus_bigbg_2=this.primus_bigbg_2_node.getComponent(cc.Sprite),this.loadRes(s.getBigBg("primus_bigbg_2",null,"primus"),function(t){this.primus_bigbg_2&&(this.primus_bigbg_2.spriteFrame=t)}.bind(this)),this.main_panel=this.main_container.getChildByName("main_panel"),this.main_panel.zIndex=2,this.explain_btn=this.main_panel.getChildByName("explain_btn"),this.title_bg=this.main_panel.getChildByName("title_bg"),this.title_bg.getChildByName("title_lab").getComponent(cc.Label).string=Utils.TI18N("\u661f\u6cb3\u795e\u6bbf"),this.exit_btn=this.title_bg.getChildByName("exit_btn"),this.exit_btn.getChildByName("text").getComponent(cc.Label).string=Utils.TI18N("\u9000\u51fa"),this.tips_panel=this.main_panel.getChildByName("tips_panel");for(var t=1;t<=6;t++){var e=this.main_panel.getChildByName("station_lay_"+t),i={};i.station_lay=e,i.title_img=e.getChildByName("title_img").getComponent(cc.Sprite),i.mode_node=e.getChildByName("mode_node"),i.name=e.getChildByName("name").getComponent(cc.Label),this.station_list[t]=i}for(var n=1;n<=3;n++)this.tips_list[n]=this.tips_panel.getChildByName("tips_node_"+n);this.tips_panel.getChildByName("title").getComponent(cc.Label).string=Utils.TI18N("\u6311\u6218\u6761\u4ef6:"),this.initTipsInfo(),this.addEffect()},registerEvent:function(){Utils.onTouchEnd(this.exit_btn,function(){this._onClickBtnClose()}.bind(this),2),this.explain_btn.on(cc.Node.EventType.TOUCH_END,function(e){Utils.playButtonSound(ButtonSound.Normal);var i=Config.primus_data.data_const.game_rule,s=e.touch.getLocation();t("tips_controller").getInstance().showCommonTips(i.desc,s,null,null,500)})},_onClickBtnClose:function(){this.ctrl.openPrimusMainWindow(!1)},_onClickByPosIndex:function(t){this.station_list&&this.station_list[t]&&this.station_list[t].sever_data&&this.ctrl.openPrimusChallengePanel(!0,this.station_list[t].sever_data,this.is_have_title)},addEffect:function(){if(this.size=this.main_container.getContentSize(),null==this.scene_effect_1){var t=new cc.Node;t.setAnchorPoint(.5,.5),t.setPosition(0,0),this.background.addChild(t,0),this.scene_effect_1=t.addComponent(sp.Skeleton);var e=s.getSpinePath(s.getEffectRes(305),"action");this.loadRes(e,function(t){this.scene_effect_1&&(this.scene_effect_1.skeletonData=t,this.scene_effect_1.setAnimation(0,PlayerAction.action,!0))}.bind(this))}if(null==this.scene_effect_2){var i=new cc.Node;i.setAnchorPoint(.5,.5),i.setPosition(0,0),this.background.addChild(i,0),this.scene_effect_2=i.addComponent(sp.Skeleton);e=s.getSpinePath(s.getEffectRes(306),"action");this.loadRes(e,function(t){this.scene_effect_2&&(this.scene_effect_2.skeletonData=t,this.scene_effect_2.setAnimation(0,PlayerAction.action,!0))}.bind(this))}if(null==this.scene_effect_3){var n=new cc.Node;n.setAnchorPoint(.5,.5),n.setPosition(0,0),this.main_container.addChild(n,0),this.scene_effect_3=n.addComponent(sp.Skeleton);e=s.getSpinePath(s.getEffectRes(307),"action");this.loadRes(e,function(t){this.scene_effect_3&&(this.scene_effect_3.skeletonData=t,this.scene_effect_3.setAnimation(0,PlayerAction.action,!0))}.bind(this))}},openRootWnd:function(e){this.ctrl.requestPrimusChallengeCount(),this.ctrl.sender20701();var i=t("mainui_controller"),s=t("mainui_const"),n=t("scene_const");i.getInstance().setBtnRedPoint(s.btn_index.esecsice,{bid:n.RedPointType.primus,status:!1})},setData:function(t){if(this.is_have_title=!1,t.list.sort(function(t,e){return t.pos-e.pos}),this.station_list)for(var e in t.list)if(this.station_list[t.list[e].pos]){this.station_list[t.list[e].pos].sever_data=t.list[e],this.station_list[t.list[e].pos].var_data=Config.primus_data.data_upgrade[t.list[e].pos],this.updateStationInfoByPos(t.list[e].pos);var i=t.list[e].pos;this.station_list[i].station_lay&&Utils.onTouchEnd(this.station_list[i].station_lay,function(t){this._onClickByPosIndex(t)}.bind(this,i),2)}},updateStationInfoByPos:function(t){var e=this.station_list[t];if(e){var i=e.sever_data;if(i){if(e.var_data){var a=Config.honor_data.data_title[e.var_data.honor_id];a&&this.loadRes(s.getHonorRes(a.res_id),function(t){e&&e.title_img&&(e.title_img.spriteFrame=t)}.bind(this))}if(null==i.name||""==i.name)e.name.string=Utils.TI18N("\u865a\u4f4d\u4ee5\u5f85"),e.name.node.color=new cc.Color(255,255,255,255),this.updateSpine(e.var_data.look_id,t);else{e.name.string=i.name;var o=n.getInstance().getRoleVo();o&&i.rid==o.rid&&i.srv_id==o.srv_id?(this.is_have_title=!0,e.name.node.color=new cc.Color(20,255,50,255)):e.name.node.color=new cc.Color(255,226,64,255),this.updateSpine(i.look_id,t)}}}},updateSpine:function(t,e){var i=this.station_list[e];i&&(i.spine||(i.spine=new a,i.spine.setParent(i.mode_node),i.spine.node.setPosition(0,45),i.spine.node.setAnchorPoint(cc.v2(.5,.5))),i.spine&&i.spine.setData(a.type.role,t,PlayerAction.show,!0,.6,{scale:.72}))},initTipsInfo:function(){if(this.tips_list){var t=[1,2,4];for(var e in t){var i=Config.primus_data.data_upgrade[t[e]];if(this.tips_list[parseInt(e)+1]&&i){var s=cc.js.formatStr(Utils.TI18N("%s:\u7ade\u6280\u573a\u6392\u884c<color=#14ff32>\u524d%s\u540d</color>"),i.name,i.arena_rank),n=Utils.createRichLabel(22,new cc.Color(255,255,255,255),cc.v2(0,0),cc.v2(0,0),30,500);n.horizontalAlign=cc.macro.TextAlignment.LEFT,n.string=s,this.tips_list[parseInt(e)+1].addChild(n.node)}}}},closeCallBack:function(){for(var t in this.station_list)this.station_list[t]&&(this.station_list[t].spine&&(this.station_list[t].spine.deleteMe(),this.station_list[t].spine=null),this.station_list[t]=null);this.station_list=null,this.ctrl.openPrimusMainWindow(!1)}});cc._RF.pop()},{baserole:"baserole",mainui_const:"mainui_const",mainui_controller:"mainui_controller",pathtool:"pathtool",role_controller:"role_controller",scene_const:"scene_const",tips_controller:"tips_controller"}],primus_model:[function(t,e,i){"use strict";cc._RF.push(e,"cdb68e9gRBEjpBsriuHdUhX","primus_model");var s=t("mainui_controller"),n=t("mainui_const"),a=t("esecsice_const"),o=t("role_controller");cc.Class({extends:BaseClass,ctor:function(){},properties:{},initConfig:function(){this.is_show_redpoint=!0,this.challenge_count=0,this.challenge_time=0},recordChallengeCount:function(t){this.challenge_count=t.num||0,this.challenge_time=t.time||0,this.updateRedPoint()},updateRedPoint:function(){RedMgr.getInstance().addCalHandler(this.checkRed.bind(this),RedIds.Primus)},checkRed:function(){var e=this.checkRedStatus(),i=t("scene_const");s.getInstance().setBtnRedPoint(n.btn_index.esecsice,{bid:i.RedPointType.primus,status:e})},checkRedStatus:function(){var t=Config.dailyplay_data.data_exerciseactivity;if(0==s.getInstance().checkIsOpenByActivate(t[a.execsice_index.honourfane].activate))return!1;var e=this.is_show_redpoint;if(e){var i=o.getInstance().getRoleVo();(i&&i.lev||0)<Config.primus_data.data_const.open_lev.val&&(e=!1)}if(e){var n=Config.primus_data.data_const.daily_challenge_limit.val;this.challenge_count>=n&&(e=!1)}if(e){var l=gcore.SmartSocket.getTime();0!=this.challenge_time&&this.challenge_time>l&&(e=!1)}return e}});cc._RF.pop()},{esecsice_const:"esecsice_const",mainui_const:"mainui_const",mainui_controller:"mainui_controller",role_controller:"role_controller",scene_const:"scene_const"}],privilege_item:[function(t,e,i){"use strict";cc._RF.push(e,"90b3eRiJLBIe4tObr+gzAhm","privilege_item");var s=t("pathtool"),n=t("vip_controller"),a=t("role_controller"),o=t("timetool"),l=t("common_scrollview");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("vip","privilege_item")},initConfig:function(){this.ctrl=n.getInstance(),this.model=this.ctrl.getModel()},initPanel:function(){this.container_nd=this.seekChild("container"),this.image_title_sp=this.seekChild(this.container_nd,"image_title",cc.Sprite),this.title_txt_lb=this.seekChild(this.container_nd,"title_txt",cc.Label),this.limit_txt_lb=this.seekChild(this.container_nd,"limit_txt",cc.Label),this.iamge_icon_sp=this.seekChild(this.container_nd,"image_icon",cc.Sprite),this.image_sell_out_nd=this.seekChild(this.container_nd,"image_sell_out"),this.buy_btn_nd=this.seekChild(this.container_nd,"buy_btn"),this.buy_btn_rt=this.seekChild(this.buy_btn_nd,"label",cc.RichText),this.buy_btn_sp=this.seekChild(this.buy_btn_nd,"img",cc.Sprite),this.desc_txt_rt=this.seekChild(this.container_nd,"desc_txt",cc.RichText),this.left_day_txt_rt=this.seekChild(this.container_nd,"left_day_txt",cc.RichText);var t=this.seekChild(this.container_nd,"good_list"),e=t.getContentSize(),i={item_class:"backpack_item",start_x:0,space_x:0,start_y:0,space_y:0,item_width:.7*BackPackItem.Width,item_height:.7*BackPackItem.Height,row:1,col:1,scale:.7};this.tab_scrollview=new l,this.tab_scrollview.createScroll(t,cc.v2(0,0),ScrollViewDir.horizontal,ScrollViewStartPos.top,e,i,cc.v2(.5,.5)),this.loadRes(s.getItemRes(3),function(t){this.buy_btn_sp.spriteFrame=t}.bind(this)),this.buy_btn_sp.node.active=!1},registerEvent:function(){Utils.onTouchEnd(this.buy_btn_nd,function(){this._onClickBuyBtn()}.bind(this),1)},setData:function(t){this.data=t,this.root_wnd&&this.onShow()},onShow:function(){if(null!=this.data){var t=this.data;this.privilege_cfg=t;var e=this.model.getPrivilegeDataById(t.id);if(e||((e={}).status=0,e.expire_time=0),1==this.privilege_cfg.title_type?this.loadRes(s.getUIIconPath("vip","vip_image_1"),function(t){this.image_title_sp.spriteFrame=t}.bind(this)):2==this.privilege_cfg.title_type&&this.loadRes(s.getUIIconPath("vip","vip_image_3"),function(t){this.image_title_sp.spriteFrame=t}.bind(this)),this.title_txt_lb.string=this.privilege_cfg.name||"",this.privilege_cfg.icon_id){var i=s.getUIIconPath("vip","vip_icon"+this.privilege_cfg.icon_id);this.loadRes(i,function(t){this.iamge_icon_sp.spriteFrame=t}.bind(this))}this.desc_txt_rt.string=this.privilege_cfg.desc||"";var n=a.getInstance().getRoleVo(),l=gdata("privilege_data","data_privilege_award",[t.id]);if(l){var r={};for(var c in l){if((h=l[c]).min<=n.lev&&h.max>=n.lev){r=Utils.deepCopy(h.reward);break}}var _=[];for(var c in r){var h=r[c],d=Utils.deepCopy(Utils.getItemConfig(h[0]));d&&(d.bid=d.id,d.num=h[1],d.quantity=h[1],_.push(d))}this.tab_scrollview.setData(_),this.tab_scrollview.addEndCallBack(function(){var t=this.tab_scrollview.getItemList();for(var e in t)t[e]&&t[e].setDefaultTip()}.bind(this))}if(0==this.privilege_cfg.limit_type?this.limit_txt_lb.string=Utils.TI18N("\u6c38\u4e45\u9650\u8d2d"):this.privilege_cfg.limit_day<2?this.limit_txt_lb.string=Utils.TI18N("\u6bcf\u65e5\u9650\u8d2d"):this.privilege_cfg.limit_day<8?this.limit_txt_lb.string=Utils.TI18N("\u6bcf\u5468\u9650\u8d2d"):this.privilege_cfg.limit_day<32&&(this.limit_txt_lb.string=Utils.TI18N("\u6bcf\u6708\u9650\u8d2d")),1==e.status)if(0==this.privilege_cfg.limit_type)this.image_sell_out_nd.active=!0,this.buy_btn_nd.active=!1,this.left_day_txt_rt&&(this.left_day_txt_rt.node.active=!1);else{this.image_sell_out_nd.active=!1,this.buy_btn_nd.active=!1;var u=gcore.SmartSocket.getTime(),m=(e.expire_time||0)-u;m<0&&(m=0);var f=Math.floor(m/86400);this.left_day_txt_rt.string=f<1?cc.js.formatStr("<size=24>\u8fd8\u6709</size><size=24><color=#249003>%s</c></size>",o.GetTimeFormatTwo(m)):cc.js.formatStr("\u8fd8\u6709<color=#249003>%s</c>\u5929",f),this.left_day_txt_rt.node.active=!0}else this.image_sell_out_nd.active=!1,this.buy_btn_nd.active=!0,this.left_day_txt_rt&&(this.left_day_txt_rt.node.active=!1),1==this.privilege_cfg.pay_type?(this.buy_btn_rt.string=cc.js.formatStr("%d\u5143",this.privilege_cfg.loss),this.buy_btn_sp.node.active=!1,this.buy_btn_rt.node.x=0):2==this.privilege_cfg.pay_type&&(this.buy_btn_rt.string=cc.js.formatStr("%d",this.privilege_cfg.loss),this.buy_btn_sp.node.active=!0,this.buy_btn_rt.node.x=10)}},_onClickBuyBtn:function(){if(this.privilege_cfg)if(1==this.privilege_cfg.pay_type){var t=this.privilege_cfg.charge_id,e=gdata("charge_data","data_charge_data",[t||0]);e&&SDK.pay(e.val,null,e.id,e.name,e.name,null,null)}else 2==this.privilege_cfg.pay_type&&this.ctrl.sender24501(this.privilege_cfg.id)},onHide:function(){},onDelete:function(){this.tab_scrollview&&(this.tab_scrollview.deleteMe(),this.tab_scrollview=null)}});cc._RF.pop()},{common_scrollview:"common_scrollview",pathtool:"pathtool",role_controller:"role_controller",timetool:"timetool",vip_controller:"vip_controller"}],privilege_panel:[function(t,e,i){"use strict";cc._RF.push(e,"b5b30bV4wZCp7HchERwRnaL","privilege_panel");var s=t("pathtool"),n=t("vip_controller"),a=t("privilege_item"),o=t("common_scrollview"),l=t("vip_event");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("vip","privilege_panel")},initConfig:function(){this.ctrl=n.getInstance(),this.model=this.ctrl.getModel(),this.model.setPrivilegeOpenFlag(!0)},initPanel:function(){this.main_container_nd=this.seekChild("main_container");var t=this.seekChild(this.main_container_nd,"scrollCon"),e=t.getContentSize(),i=cc.size(e.width,e.height),s={item_class:a,start_x:0,space_x:0,start_y:0,space_y:0,item_width:636,item_height:170,row:0,col:1,need_dynamic:!0};this.tab_scrollview=new o,this.tab_scrollview.createScroll(t,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,i,s,cc.v2(.5,.5)),this.setData()},registerEvent:function(){this.addGlobalEvent(l.PRIVILEGE_INFO,function(){this.setData()},this)},setData:function(){var t=[];for(var e in Config.privilege_data.data_privilege_data)t.push(gdata("privilege_data","data_privilege_data",[e]));var i=Utils.tableLowerSorter(["id"]);t.sort(i),this.tab_scrollview.setData(t)},onShow:function(t){},setVisibleStatus:function(t){this.setVisible(t)},onHide:function(){},onDelete:function(){this.tab_scrollview&&(this.tab_scrollview.deleteMe(),this.tab_scrollview=null)}});cc._RF.pop()},{common_scrollview:"common_scrollview",pathtool:"pathtool",privilege_item:"privilege_item",vip_controller:"vip_controller",vip_event:"vip_event"}],prompt_controller:[function(t,e,i){"use strict";cc._RF.push(e,"8a670beVKdHXZQFdYbrWDSh","prompt_controller");var s=cc.Class({extends:BaseController,ctor:function(){},initConfig:function(){var e=t("prompt_model");this.model=new e,this.model.initConfig()},getModel:function(){return this.model},registerEvents:function(){},registerProtocals:function(){this.RegisterProtocal(16800,this.hander16800)},hander16800:function(e){var i=t("prompt_type_const");if(e.type==i.Private_chat||e.type==i.At_notice)this.model.addPromptData(e);else if(e.type==i.Endless_trail){var s=t("battle_controller"),n=s.getInstance().isInFight(),a=s.getInstance().getModel().getCombatType(),o=t("battle_const");0!=n&&a==o.Fight_Type.Endless||this.model.addPromptData(e)}}});e.exports=s,cc._RF.pop()},{battle_const:"battle_const",battle_controller:"battle_controller",prompt_model:"prompt_model",prompt_type_const:"prompt_type_const"}],prompt_event:[function(t,e,i){"use strict";cc._RF.push(e,"10c32TlgmJKxLBNK8Sfgpg6","prompt_event");var s={ADD_PROMPT_DATA:"PromptEvent.ADD_PROMPT_DATA",REMOVE_PROMPT_DATA:"PromptEvent.REMOVE_PROMPT_DATA"};e.exports=s,cc._RF.pop()},{}],prompt_model:[function(t,e,i){"use strict";cc._RF.push(e,"7ab42uMxktP54+bqyufoXdb","prompt_model");var s=t("prompt_event");cc.Class({extends:BaseClass,ctor:function(){},properties:{},initConfig:function(){this.prompt_list=[],this.auto_id=0},addPromptData:function(e){var i=Config.notice_data.data_get[e.type];if(null!=i){var n=null,a=this.getSridByData(e),o=a.rid,l=a.srv_id;if(1!=this.checkIsInList(e.type,o,l)){this.auto_id=this.auto_id+1;var r=t("prompt_vo");1==i.can_overly?(null==(n=this.getPromptVoByType(e.type))&&(n=new r(e.type,this.auto_id),this.prompt_list.push(n)),n.update(e)):((n=new r(e.type,this.auto_id)).update(e),this.prompt_list.push(n)),gcore.GlobalEvent.fire(s.ADD_PROMPT_DATA,n)}}else cc.log("==============> \u6dfb\u52a0\u5c0f\u56fe\u6807\u5931\u8d25, \u672a\u914d\u7f6e\u8be5\u5c0f\u56fe\u6807\u6570\u636e, \u7c7b\u578b\u4e3a ",e.type)},getPromptVoByType:function(t){for(var e=0;e<this.prompt_list.length;++e){var i=this.prompt_list[e];if(i.type==t)return i}},checkIsInList:function(t,e,i){for(var s=0;s<this.prompt_list.length;++s){var n=this.prompt_list[s];if(n.type==t)for(var a=0;a<n.list.length;++a){var o=n.list[a],l=n.getSridByData(o.data),r=l.rid,c=l.srv_id;l.role_name;if(Utils.getNorKey(r,c)==Utils.getNorKey(e,i))return!0}}return!1},getSridByData:function(t){var e=0,i="",s="",n=0;if(t&&t.arg_uint32&&t.arg_uint32.length>0)for(var a=0;a<t.arg_uint32.length;++a){var o=t.arg_uint32[a];o&&(1==o.key?e=o.value:2==o.key&&(n=o.value))}if(t&&t.arg_str&&t.arg_str.length>0)for(var l=0;l<t.arg_str.length;++l){var r=t.arg_str[l];r&&(1==r.key?i=r.value:2==r.key&&(s=r.value))}return{rid:e,srv_id:i,role_name:s,bbs_id:n}},getPromptList:function(){return this.prompt_list},getNotBubblePrompt:function(){for(var t=0;t<this.prompt_list.length;++t){var e=this.prompt_list[t];if(0==e.is_show_bubble)return e}},removePromptData:function(t,e){if(this.prompt_list.length>0){for(var i=0;i<this.prompt_list.length;++i)if(vo.type==t&&vo.id==e){this.prompt_list.splice(i,1);break}gcore.GlobalEvent.fire(s.REMOVE_PROMPT_DATA)}},removePromptDataByTpye:function(t){if(this.prompt_list.length>0){for(var e=0;e<this.prompt_list.length;++e){if(this.prompt_list[e].type==t){this.prompt_list.splice(e,1);break}}gcore.GlobalEvent.fire(s.REMOVE_PROMPT_DATA)}},checkPromptDataByTpye:function(t){if(this.prompt_list.length>0)for(var e=0;e<this.prompt_list.length;++e){if(this.prompt_list[e].type==t)return!0}return!1}});cc._RF.pop()},{prompt_event:"prompt_event",prompt_vo:"prompt_vo"}],prompt_type_const:[function(t,e,i){"use strict";cc._RF.push(e,"a90fc82CeNIJLpNsCbYWB43","prompt_type_const");e.exports={Mail:1,Add_friend:2,Join_guild:4,Challenge:6,Private_chat:8,Invite_guild:9,GuildWar_summon:10,Guild_merge:11,Team_invite:12,Friend_energy:13,World_boss:14,At_notice:15,Endless_trail:16,Escort:17,GuileMuster:18,Guild:19,Guild_war:20,Guild_voyage:21,BBS_message:22,BBS_message_reply:23,BBS_message_reply_self:24,Mine_defeat:25},cc._RF.pop()},{}],prompt_vo:[function(t,e,i){"use strict";cc._RF.push(e,"f4d6d/OdX5MDKXT8eAm+rsl","prompt_vo");var s=t("prompt_type_const"),n=cc.Class({extends:gcore.BaseEvent,ctor:function(){this.list=[],this.type=arguments[0],this.id=arguments[1],this.auto_id=0,this.name="",this.is_show_bubble=!1},update:function(t){if(this.auto_id=this.auto_id+1,this.type==s.BBS_message_reply){var e=this.getSridByData(t).role_name||Utils.TI18N("\u540d\u5b57");this.name=e+Utils.TI18N("\u56de\u590d\u4e86\u4f60")}else this.name=Config.notice_data.data_get[this.type].name;this.list.push({id:this.auto_id,data:t,time:gcore.SmartSocket.getTime()}),this.fire(n.UPDATE_SELF_EVENT)},getSridByData:function(t){var e=0,i="",s="",n=0;if(t&&t.arg_uint32&&t.arg_uint32.length>0)for(var a=0;a<t.arg_uint32.length;++a){var o=t.arg_uint32[a];o&&(1==o.key?e=o.value:2==o.key&&(n=o.value))}var l="";if(t&&t.arg_str&&t.arg_str.length>0)for(var r=0;r<t.arg_str.length;++r){var c=t.arg_str[r];c&&(1==c.key?i=c.value:2==c.key?s=c.value:3==c.key&&(l=c.value))}return{rid:e,srv_id:i,role_name:s,guild_name:l,bbs_id:n}},removeDataById:function(t){for(var e=0;e<this.list.length;++e){this.list[e].id==t&&this.list.splice(e,1)}},getNum:function(){return this.list.length},setShowBubbleStatus:function(t){this.is_show_bubble=t}});n.UPDATE_SELF_EVENT="PromptVo.UPDATE_SELF_EVENT",e.exports=n,cc._RF.pop()},{prompt_type_const:"prompt_type_const"}],proto_mate:[function(t,e,i){"use strict";cc._RF.push(e,"255d7HDm4lK5J+8zyRQ2KUf","proto_mate"),e.exports.send={10101:[{s:"sex",t:2},{s:"name",t:7},{s:"career",t:3},{s:"playform",t:7}],10102:[{s:"rid",t:6},{s:"srv_id",t:7}],10103:[{s:"rid",t:6},{s:"srv_id",t:7}],10200:[{s:"battle_id",t:6},{s:"id",t:6},{s:"code",t:4}],10215:[{s:"base_id",t:6},{s:"x",t:4},{s:"y",t:4},{s:"dir",t:2}],10300:[],10309:[{s:"signature",t:7}],10312:[],10315:[{s:"rid",t:6},{s:"srv_id",t:7}],10316:[{s:"type",t:2},{s:"rid",t:6},{s:"srv_id",t:7},{s:"idx",t:6}],10317:[],10318:[{s:"auto_pk",t:2}],10322:[{s:"code",t:2}],10325:[],10327:[{s:"face_id",t:6}],10343:[{s:"name",t:7},{s:"sex",t:2}],10345:[],10346:[{s:"id",t:6}],10347:[{s:"id",t:6}],10348:[{s:"is_show_vip",t:2}],10380:[],10391:[{s:"msg",t:7}],10395:[{s:"age",t:1}],10397:[{s:"status",t:2}],10399:[{s:"msg",t:7}],10400:[],10402:[{s:"id",t:6}],10405:[{s:"id",t:6}],10406:[{s:"id",t:6}],10500:[],10501:[],10515:[{s:"id",t:6},{s:"quantity",t:4},{s:"args",t:9,f:[{s:"name",t:2},{s:"value",t:6},{s:"str",t:7}]}],10520:[{s:"id",t:6},{s:"storage",t:2}],10522:[{s:"storage",t:2},{s:"args",t:9,f:[{s:"id",t:6},{s:"bid",t:6},{s:"num",t:4}]}],10523:[{s:"id",t:6},{s:"num",t:4}],10524:[{s:"star_list",t:9,f:[{s:"star",t:2}]}],10525:[],10526:[{s:"type",t:2}],10528:[],10535:[{s:"type",t:2},{s:"id",t:6},{s:"partner_id",t:6},{s:"code",t:6}],10536:[{s:"id",t:6},{s:"srv_id",t:7}],10800:[],10801:[{s:"id",t:6},{s:"srv_id",t:7}],10802:[],10804:[{s:"ids",t:9,f:[{s:"id",t:6},{s:"srv_id",t:7}]}],10805:[{s:"id",t:6},{s:"srv_id",t:7}],10810:[{s:"issue_type",t:2},{s:"title",t:7},{s:"content",t:7}],10900:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"hour",t:6},{s:"interdict",t:7}],10901:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"hour",t:6},{s:"banned",t:7}],10902:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"stop_role",t:7}],10905:[],10906:[],10922:[],10923:[{s:"id",t:4}],10924:[],10925:[{s:"id",t:4}],10926:[],10927:[{s:"time",t:6}],10945:[{s:"card_id",t:7}],10946:[],10950:[],10952:[{s:"id",t:6}],10955:[],10956:[{s:"key",t:4},{s:"val",t:6}],10999:[{s:"msg",t:7}],1110:[{s:"args",t:9,f:[{s:"key",t:7},{s:"val",t:7}]}],1198:[{s:"time",t:6}],1199:[],11000:[],11001:[],11002:[],11003:[{s:"partner_id",t:6}],11004:[{s:"partner_id",t:6}],11005:[{s:"partner_id",t:6},{s:"expend1",t:9,f:[{s:"partner_id",t:6}]},{s:"expend2",t:9,f:[{s:"partner_id",t:6}]}],11006:[],11007:[],11008:[{s:"bid",t:6},{s:"num",t:6}],11009:[],11010:[{s:"partner_id",t:6},{s:"item_id",t:6}],11011:[{s:"partner_id",t:6},{s:"pos_id",t:6}],11012:[],11015:[{s:"partner_id",t:6},{s:"type",t:2}],11016:[{s:"partner_id",t:6}],11017:[],11019:[{s:"partner_id",t:6},{s:"skin_id",t:6}],11020:[],11025:[],11026:[{s:"partner_ids",t:9,f:[{s:"partner_id",t:6}]}],11030:[{s:"partner_id",t:6},{s:"pos_id",t:2},{s:"artifact_id",t:6},{s:"type",t:2}],11031:[],11032:[{s:"partner_id",t:6},{s:"artifact_id",t:6},{s:"expends",t:9,f:[{s:"artifact_id",t:6}]}],11033:[{s:"partner_id",t:6},{s:"artifact_id",t:6},{s:"skills",t:9,f:[{s:"skill_id",t:6}]}],11034:[{s:"partner_id",t:6},{s:"artifact_id",t:6},{s:"type",t:2}],11035:[{s:"artifact_id",t:6}],11036:[{s:"item_id",t:6},{s:"expends",t:9,f:[{s:"artifact_id",t:6}]}],11037:[],11038:[],11040:[],11041:[{s:"partner_id",t:6},{s:"start",t:2},{s:"num",t:2}],11042:[{s:"partner_id",t:6}],11043:[{s:"partner_id",t:6},{s:"msg",t:7}],11044:[{s:"partner_id",t:6},{s:"comment_id",t:6},{s:"type",t:2}],11045:[{s:"partner_id",t:6}],11046:[],11047:[],11050:[],11051:[{s:"fields",t:9,f:[{s:"pos",t:6},{s:"partner_id",t:6}]}],11052:[],11053:[{s:"pos",t:2}],11055:[{s:"is_point",t:2}],11056:[],11060:[{s:"partner_id",t:6},{s:"channel",t:4}],11061:[{s:"r_rid",t:6},{s:"r_srvid",t:7},{s:"partner_id",t:6}],11062:[{s:"id",t:6},{s:"srv_id",t:7}],11063:[{s:"partner_id",t:6}],11070:[{s:"partner_bid",t:6}],11073:[],11075:[{s:"list",t:9,f:[{s:"partner_id",t:6}]}],11076:[{s:"list",t:9,f:[{s:"partner_id",t:6}]}],11077:[{s:"partner_bid",t:6}],11078:[{s:"id",t:6},{s:"flag",t:2}],11079:[{s:"base_id",t:6},{s:"num",t:6}],11080:[{s:"base_id",t:6},{s:"num",t:6}],11081:[{s:"base_id",t:6},{s:"num",t:6}],11082:[],11083:[{s:"partner_id",t:6},{s:"item_id",t:6}],11085:[],11086:[{s:"partner_id",t:6}],11087:[{s:"list",t:9,f:[{s:"partner_id",t:6}]}],11088:[{s:"item_ids",t:9,f:[{s:"item_id",t:6}]}],11089:[{s:"item_ids",t:9,f:[{s:"item_id",t:6}]}],11090:[{s:"partner_id",t:6},{s:"holy_eqm_id",t:6},{s:"type",t:2}],11091:[],11092:[{s:"partner_ids",t:9,f:[{s:"partner_id",t:6}]}],11093:[{s:"partner_id",t:6},{s:"holy_eqm_id",t:6},{s:"type",t:2}],11094:[{s:"partner_id",t:6},{s:"holy_eqm_id",t:6},{s:"pos",t:9,f:[{s:"pos",t:2}]}],11095:[],11096:[{s:"partner_id",t:6},{s:"pos",t:2},{s:"skill_id",t:6}],11097:[{s:"partner_id",t:6},{s:"pos",t:2}],11098:[{s:"partner_id",t:6},{s:"pos",t:2}],11099:[{s:"partner_ids",t:9,f:[{s:"partner_id",t:6}]}],11100:[{s:"drama_bid",t:6},{s:"step_id",t:2}],11102:[{s:"drama_bid",t:6}],11111:[{s:"type",t:4},{s:"bid",t:6}],11121:[{s:"id",t:6},{s:"n",t:6}],11122:[{s:"id",t:6},{s:"is_skip",t:6}],11200:[],11201:[{s:"id",t:2},{s:"pos_info",t:9,f:[{s:"pos",t:2},{s:"id",t:2}]},{s:"hallows_id",t:6}],11211:[{s:"type",t:2}],11212:[{s:"type",t:2},{s:"formation_type",t:2},{s:"pos_info",t:9,f:[{s:"pos",t:2},{s:"id",t:6}]},{s:"hallows_id",t:6}],11213:[{s:"type_list",t:9,f:[{s:"type",t:2}]}],11300:[],11301:[],11302:[{s:"set_id",t:6},{s:"pos_id",t:6},{s:"partner_id",t:6}],11303:[{s:"set_id",t:6},{s:"pos_id",t:6},{s:"partner_id",t:6}],11304:[{s:"set_id",t:6},{s:"id",t:6}],11305:[{s:"set_id",t:6},{s:"id",t:6}],11306:[{s:"id",t:6},{s:"set_id",t:6}],11307:[{s:"set_id",t:6}],11308:[],11310:[{s:"set_id",t:6},{s:"id",t:6}],11311:[{s:"set_id",t:6},{s:"id",t:6}],11320:[],11321:[],11322:[{s:"tower",t:6}],11323:[],11324:[{s:"tower",t:6}],11325:[{s:"tower",t:6}],11326:[],11327:[],11328:[{s:"id",t:6}],11329:[],11330:[],11331:[{s:"type",t:2},{s:"count",t:2}],11332:[],11333:[{s:"replay_id",t:6},{s:"channel",t:4},{s:"tower",t:6}],12700:[],12701:[{s:"base_id",t:6}],12702:[],12703:[{s:"base_id",t:6}],12720:[{s:"to_rid",t:6},{s:"to_srv_id",t:7},{s:"len",t:2},{s:"msg",t:7}],12723:[{s:"rid",t:6},{s:"srv_id",t:7}],12725:[{s:"voice",t:8},{s:"voice_len",t:4},{s:"time",t:2},{s:"type",t:2}],12726:[{s:"srv_id",t:7},{s:"voice_id",t:6}],12730:[{s:"type",t:6},{s:"is_push",t:2}],12731:[],12732:[{s:"type",t:6},{s:"msg",t:7}],12762:[{s:"channel",t:4},{s:"len",t:2},{s:"msg",t:7}],12764:[{s:"channel",t:4},{s:"id",t:7},{s:"msg",t:7}],12766:[{s:"channel",t:4}],12767:[],12768:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"channel",t:4},{s:"msg",t:7}],12770:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"type",t:2},{s:"msg",t:7},{s:"history",t:9,f:[{s:"id",t:2}]}],12771:[{s:"rid",t:6},{s:"srv_id",t:7}],12900:[{s:"type",t:4},{s:"start",t:2},{s:"num",t:2},{s:"is_cluster",t:2}],12901:[{s:"type",t:4},{s:"is_cluster",t:2}],12902:[{s:"is_cluster",t:2}],12903:[{s:"start",t:2},{s:"num",t:2}],12904:[{s:"start",t:2},{s:"num",t:2}],13000:[],13002:[],13003:[{s:"is_auto",t:2}],13004:[],13005:[{s:"dun_id",t:6},{s:"num",t:4}],13006:[],13008:[],13009:[{s:"id",t:6}],13011:[],13012:[],13013:[],13014:[{s:"chapter_id",t:6},{s:"award_id",t:6}],13015:[{s:"dun_id",t:6}],13017:[],13018:[],13019:[],13020:[],13030:[],13031:[{s:"id",t:6}],13032:[{s:"id",t:6}],13039:[],13040:[],13300:[],13303:[{s:"rid",t:6},{s:"srv_id",t:7}],13305:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"agreed",t:2}],13306:[{s:"role_ids",t:9,f:[{s:"rid",t:6},{s:"srv_id",t:7}]}],13307:[{s:"rid",t:6},{s:"srv_id",t:7}],13309:[{s:"role_ids",t:9,f:[{s:"rid",t:6},{s:"srv_id",t:7}]}],13311:[],13312:[],13314:[{s:"name",t:7}],13315:[{s:"rid",t:6},{s:"srv_id",t:7}],13316:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"code",t:2}],13317:[{s:"code",t:2},{s:"list",t:9,f:[{s:"rid",t:6},{s:"srv_id",t:7}]}],13320:[],13330:[],13332:[{s:"rid",t:6},{s:"srv_id",t:7}],13333:[{s:"rid",t:6},{s:"srv_id",t:7}],13334:[{s:"role_ids",t:9,f:[{s:"rid",t:6},{s:"srv_id",t:7}]}],13401:[{s:"type",t:2}],13402:[{s:"eid",t:6},{s:"num",t:6}],13403:[{s:"type",t:6}],13405:[{s:"type",t:6}],13407:[{s:"order",t:6},{s:"type",t:6},{s:"buy_type",t:6}],13408:[{s:"type",t:2}],13409:[{s:"type",t:2}],13410:[{s:"type",t:2},{s:"pos",t:6}],13411:[{s:"type",t:2}],13412:[],13413:[{s:"id",t:6}],13414:[],13415:[{s:"type",t:6}],13416:[{s:"order",t:6},{s:"type",t:6},{s:"buy_type",t:6}],13417:[{s:"type",t:6}],13419:[{s:"num",t:6}],13420:[],13500:[{s:"name",t:7},{s:"sign",t:7},{s:"apply_type",t:2},{s:"apply_lev",t:2}],13501:[{s:"page",t:4},{s:"flag",t:2},{s:"num",t:4},{s:"name",t:7}],13503:[{s:"gid",t:6},{s:"gsrv_id",t:7},{s:"type",t:2}],13505:[{s:"type",t:2},{s:"rid",t:6},{s:"srv_id",t:7}],13507:[{s:"page",t:2},{s:"num",t:2}],13513:[{s:"rid",t:6},{s:"srv_id",t:7}],13514:[],13516:[],13518:[],13519:[],13520:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"position",t:2}],13521:[{s:"sign",t:7}],13522:[{s:"apply_type",t:2},{s:"apply_lev",t:2}],13523:[],13524:[{s:"type",t:2}],13534:[],13535:[{s:"type",t:2},{s:"num",t:4},{s:"msg_id",t:2},{s:"loss_type",t:2}],13536:[{s:"id",t:6}],13540:[{s:"id",t:6}],13541:[],13545:[],13546:[],13558:[],13565:[],13568:[{s:"name",t:7}],13573:[],13574:[{s:"box_id",t:2}],13575:[],13576:[{s:"rid",t:6},{s:"srv_id",t:7}],13601:[],13602:[{s:"type",t:2},{s:"day_type",t:6},{s:"id",t:6},{s:"item",t:6}],13603:[],13604:[],13605:[],13606:[{s:"id",t:6}],13607:[],13608:[{s:"id",t:4}],14100:[],14101:[],14102:[],14103:[{s:"id",t:2}],16400:[],16401:[],16402:[{s:"id",t:6}],16601:[],16602:[],16603:[{s:"bid",t:6}],16604:[{s:"bid",t:6},{s:"aim",t:6},{s:"arg",t:6}],16605:[{s:"bid_list",t:9,f:[{s:"bid",t:6}]}],16607:[],16620:[{s:"id_list",t:9,f:[{s:"id",t:6}]}],16630:[],16631:[],16633:[],16634:[],16635:[],16636:[{s:"number",t:7},{s:"code",t:7}],16637:[],16638:[{s:"type",t:6},{s:"type2",t:6}],16639:[],16640:[{s:"type",t:6},{s:"id",t:6}],16641:[],16642:[{s:"type",t:6}],16643:[{s:"type",t:6},{s:"type2",t:6}],16650:[{s:"bid",t:6}],16660:[],16661:[{s:"bid",t:6},{s:"aim",t:6},{s:"num",t:6}],16665:[{s:"bid",t:6},{s:"ids",t:9,f:[{s:"id",t:6},{s:"num",t:6}]}],16666:[{s:"bid",t:6}],16670:[],16671:[{s:"count",t:2},{s:"flag",t:2}],16672:[],16673:[{s:"id",t:2}],16674:[{s:"type",t:2}],16675:[{s:"num",t:6}],16676:[],16680:[],16681:[],16682:[{s:"pos",t:2}],16683:[],16684:[{s:"num",t:4}],16685:[{s:"type",t:2}],16686:[{s:"partner_id",t:6},{s:"partner_bid",t:6},{s:"expend",t:9,f:[{s:"partner_id",t:6}]}],16687:[{s:"bid",t:6}],16688:[],16689:[{s:"id",t:6},{s:"num",t:6}],16691:[{s:"id",t:2}],16692:[{s:"id",t:2}],16693:[{s:"id",t:2}],16694:[{s:"id",t:2}],16695:[],16696:[],16697:[],16698:[],16700:[],16705:[],16706:[{s:"card_type",t:2}],16707:[],16708:[],16710:[],16711:[{s:"lev",t:2}],16712:[],16713:[{s:"id",t:2}],16730:[],16731:[],16800:[{s:"idx",t:6},{s:"val",t:6},{s:"str",t:7}],16801:[],16802:[],16900:[],16901:[],16903:[{s:"id",t:6}],16904:[],19800:[],19801:[{s:"code",t:6}],19802:[],19804:[],19805:[{s:"id",t:2}],19806:[],19807:[],19901:[{s:"type",t:2}],19902:[{s:"type",t:2},{s:"cond_type",t:6},{s:"start",t:6},{s:"num",t:2}],19903:[{s:"id",t:6},{s:"srv_id",t:7},{s:"combat_type",t:2}],19904:[{s:"id",t:6},{s:"type",t:2},{s:"srv_id",t:7},{s:"combat_type",t:2}],19905:[{s:"id",t:6},{s:"channel",t:4},{s:"srv_id",t:7},{s:"combat_type",t:2}],19906:[],19907:[{s:"replay_id",t:6},{s:"partner_id",t:6},{s:"type",t:2},{s:"srv_id",t:7},{s:"combat_type",t:2}],19908:[{s:"replay_id",t:6},{s:"srv_id",t:7},{s:"type",t:2},{s:"channel",t:4}],20000:[],20001:[],20002:[],20004:[],20005:[],20006:[],20008:[],20009:[],20013:[],20014:[{s:"target_id",t:6},{s:"target_srv_id",t:7},{s:"is_province",t:2}],20015:[{s:"target_id",t:6},{s:"target_srv_id",t:7},{s:"is_agree",t:2}],20016:[{s:"target_id",t:6},{s:"target_srv_id",t:7},{s:"is_agree",t:2}],20019:[],20020:[],20022:[{s:"speed",t:2}],20026:[],20027:[],20028:[],20029:[{s:"replay_id",t:6}],20030:[],20033:[],20034:[{s:"replay_id",t:6},{s:"channel",t:4},{s:"target_name",t:7},{s:"share_type",t:2}],20036:[{s:"replay_id",t:6},{s:"replay_srv_id",t:7}],20060:[{s:"combat_type",t:4}],20062:[],20063:[],20200:[],20201:[],20202:[{s:"rid",t:6},{s:"srv_id",t:7}],20203:[{s:"rid",t:6},{s:"srv_id",t:7}],20204:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"pos",t:2}],20206:[],20207:[{s:"num",t:4}],20208:[],20209:[{s:"num",t:2}],20220:[],20221:[],20222:[],20223:[],20250:[],20251:[],20252:[],20253:[],20254:[{s:"bet_type",t:2},{s:"bet_val",t:6}],20255:[],20256:[],20258:[],20260:[],20261:[],20262:[],20263:[{s:"group",t:2},{s:"pos",t:2}],20280:[],20281:[],20300:[],20301:[{s:"activity",t:4}],20500:[],20501:[{s:"boss_id",t:6}],20502:[{s:"boss_id",t:6}],20530:[],20531:[],20532:[{s:"boss_id",t:6}],20533:[{s:"boss_id",t:6}],20535:[],20537:[{s:"boss_id",t:6}],20538:[{s:"boss_id",t:6}],20540:[],20541:[{s:"boss_list",t:9,f:[{s:"boss_id",t:6}]}],20542:[],20600:[],20601:[],20602:[],20604:[],20605:[{s:"plist",t:9,f:[{s:"id",t:6}]}],20606:[],20607:[{s:"skill_id",t:6},{s:"val",t:6}],20608:[{s:"room_id",t:2}],20609:[],20610:[{s:"id",t:6}],20611:[],20620:[{s:"room_id",t:2},{s:"action",t:2},{s:"ext_list",t:9,f:[{s:"type",t:2},{s:"val",t:6}]}],20632:[],20633:[{s:"id",t:6}],20634:[],20635:[{s:"id",t:6}],20700:[],20701:[],20702:[{s:"pos",t:2},{s:"num",t:2}],20703:[{s:"pos",t:2}],21000:[],21001:[{s:"id",t:2}],21002:[],21003:[],21004:[],21005:[],21006:[],21007:[{s:"type",t:2}],21008:[],21009:[],21010:[],21011:[],21012:[],21013:[{s:"id",t:2}],21014:[{s:"id",t:2}],21015:[],21016:[{s:"charge_id",t:6}],21020:[],21100:[],21101:[{s:"day",t:2}],21200:[],21201:[{s:"id",t:2}],21210:[],21211:[],21220:[],21300:[],21303:[],21304:[{s:"fid",t:6}],21305:[],21308:[{s:"boss_id",t:6},{s:"formation_type",t:4},{s:"pos_info",t:9,f:[{s:"pos",t:2},{s:"id",t:6}]},{s:"hallows_id",t:6}],21312:[{s:"type",t:2}],21317:[{s:"boss_id",t:6}],21318:[],21319:[{s:"boss_id",t:6},{s:"start_num",t:6},{s:"end_num",t:6}],21320:[],21321:[{s:"fid",t:6}],21322:[],21323:[],21401:[],21403:[],21410:[],21421:[{s:"id",t:2}],21425:[],21427:[{s:"type",t:2},{s:"num",t:2}],21500:[],21501:[{s:"base_id",t:6}],21502:[],21503:[{s:"base_id",t:6}],21504:[],22100:[],22101:[{s:"step",t:2}],22200:[],22202:[{s:"id",t:2},{s:"list",t:9,f:[{s:"id",t:6}]}],22203:[{s:"id",t:2}],22204:[{s:"id",t:2},{s:"list1",t:9,f:[{s:"id",t:6}]},{s:"list2",t:9,f:[{s:"id",t:6}]}],22700:[{s:"is_cluster",t:2}],22701:[{s:"id",t:2}],22702:[],22703:[],22704:[{s:"quest_id",t:6}],23200:[],23201:[{s:"group_id",t:4},{s:"times",t:2},{s:"recruit_type",t:2}],23202:[],23203:[],23204:[],23205:[],23210:[],23211:[{s:"id",t:6}],23212:[],23213:[{s:"group_id",t:4}],23214:[],23215:[{s:"partner_id",t:6},{s:"action",t:2}],23216:[],23217:[{s:"times",t:2},{s:"recruit_type",t:2}],23218:[],23219:[{s:"bid",t:6}],23220:[],23221:[{s:"times",t:2},{s:"recruit_type",t:2}],23222:[],23300:[],23301:[{s:"base_id",t:6}],23302:[],23303:[{s:"base_id",t:6}],23400:[],23402:[],23403:[{s:"id",t:2}],23500:[{s:"catalg",t:6}],23501:[{s:"base_id",t:6},{s:"num",t:4}],23502:[{s:"id",t:6},{s:"num",t:4}],23504:[{s:"package_type",t:2},{s:"item_id",t:6},{s:"num",t:2},{s:"percent",t:6},{s:"cell_id",t:2}],23505:[{s:"type",t:2},{s:"id",t:2},{s:"num",t:2}],23506:[{s:"cell_id",t:2}],23507:[],23508:[{s:"item_base_id",t:6}],23509:[{s:"refresh_type",t:2}],23511:[{s:"cell_id",t:2}],23512:[],23513:[{s:"cell_id",t:2},{s:"percent",t:6},{s:"num",t:2}],23514:[{s:"type",t:2}],23516:[{s:"base_ids",t:9,f:[{s:"base_id",t:6}]}],23518:[{s:"catalg",t:6}],23519:[],23520:[],23601:[],23602:[],23603:[],23604:[],23606:[],23607:[{s:"id",t:2}],23700:[{s:"career",t:2}],23701:[{s:"skill_id",t:6}],23702:[],23703:[],23800:[],23801:[],23802:[{s:"order_id",t:6},{s:"assign_ids",t:9,f:[{s:"partner_id",t:6}]}],23803:[{s:"order_id",t:6},{s:"type",t:2}],23804:[],23805:[],23820:[],23821:[],23900:[],23901:[{s:"formation_type",t:4},{s:"pos_info",t:9,f:[{s:"pos",t:2},{s:"owner_id",t:6},{s:"owner_srv_id",t:7},{s:"id",t:6}]},{s:"hallows_id",t:6}],23902:[],23903:[],23904:[{s:"id",t:6}],23905:[],23906:[],23907:[],23908:[{s:"id",t:6}],23909:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"id",t:6},{s:"flag",t:2}],23910:[],23911:[{s:"buff_id",t:4}],24000:[{s:"rid",t:6},{s:"srv_id",t:7}],24001:[{s:"type",t:2}],24002:[],24003:[],24004:[],24005:[],24006:[],24010:[{s:"rid",t:6},{s:"srv_id",t:7}],24011:[{s:"rid",t:6},{s:"srv_id",t:7}],24012:[],24013:[{s:"type",t:2}],24014:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"id",t:6},{s:"type",t:2}],24015:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"id",t:6}],24017:[{s:"id",t:6}],24018:[],24019:[],24020:[],24100:[],24101:[{s:"id",t:6},{s:"is_auto",t:2}],24103:[{s:"hallows_id",t:6}],24104:[{s:"hallows_id",t:6},{s:"num",t:6}],24107:[],24108:[],24120:[],24121:[],24122:[{s:"id",t:6}],24123:[{s:"id",t:6}],24124:[],24125:[],24126:[],24127:[],24128:[],24129:[],24130:[{s:"id",t:6}],24131:[{s:"id",t:6}],24132:[{s:"id",t:6},{s:"hallows_id",t:6},{s:"flag",t:2}],24133:[],24200:[],24201:[{s:"pos",t:6}],24202:[{s:"pos",t:2},{s:"hp",t:4},{s:"flag",t:2}],24204:[],24205:[],24206:[],24207:[],24208:[],24209:[{s:"g_id1",t:6},{s:"g_sid1",t:7},{s:"pos",t:6}],24210:[],24212:[],24213:[],24214:[],24220:[],24221:[{s:"order",t:4}],24223:[],24300:[],24301:[],24302:[{s:"rid",t:6},{s:"srv_id",t:7}],24303:[{s:"rid",t:6},{s:"srv_id",t:7}],24304:[],24305:[],24306:[],24308:[],24309:[],24310:[],24311:[],24312:[],24313:[],24314:[],24315:[],24316:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"pos",t:2}],24400:[],24401:[{s:"id",t:2}],24402:[{s:"id",t:2}],24403:[{s:"formation_type",t:2},{s:"pos_info",t:9,f:[{s:"pos",t:2},{s:"owner_id",t:6},{s:"owner_srv_id",t:7},{s:"id",t:6}]},{s:"hallows_id",t:6}],24404:[],24405:[],24406:[],24407:[{s:"id",t:6}],24408:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"id",t:6}],24409:[],24410:[],24411:[],24500:[],24501:[{s:"id",t:6}],24502:[],24600:[],24601:[],24602:[],24603:[{s:"ret_list",t:9,f:[{s:"id",t:6},{s:"topic_type",t:2},{s:"ret",t:7}]}],24604:[],24700:[],24701:[{s:"id",t:6}],24702:[{s:"id",t:6}],24801:[],24802:[{s:"id",t:2}],24803:[{s:"id",t:2}],24804:[],24805:[],24806:[{s:"id",t:6}],24807:[{s:"id",t:4}],24808:[],24809:[],24810:[],24811:[],24812:[{s:"id",t:6}],24813:[],24814:[{s:"id",t:6}],24815:[],24816:[{s:"id",t:6}],24817:[],24818:[{s:"id",t:6}],25100:[],25101:[{s:"id",t:6}],25102:[],25300:[],25301:[],25302:[{s:"id",t:6}],25303:[],25304:[{s:"id",t:4}],25305:[],25306:[],25307:[{s:"id",t:4}],25308:[],25309:[],25400:[],25401:[],25402:[],25403:[],25404:[],25405:[],25410:[],25411:[],25412:[],25413:[],25414:[],25800:[{s:"city_id",t:6}],25801:[{s:"rid",t:6},{s:"srv_id",t:7}],25802:[],25805:[{s:"pos",t:2},{s:"id",t:6}],25806:[{s:"rid",t:6},{s:"srv_id",t:7}],25807:[],25810:[],25811:[],25812:[{s:"id",t:6}],25813:[{s:"id",t:6}],25814:[],25815:[{s:"id",t:6},{s:"channel",t:4}],25816:[{s:"share_id",t:6},{s:"srv_id",t:7}],25817:[{s:"id",t:6},{s:"channel",t:4}],25818:[{s:"share_id",t:6},{s:"srv_id",t:7}],25819:[{s:"channel",t:4}],25820:[{s:"share_id",t:6},{s:"srv_id",t:7}],25830:[{s:"start",t:4},{s:"num",t:2}],25831:[{s:"channel",t:4}],25832:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"start",t:4},{s:"num",t:2}],25835:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"msg",t:7}],25836:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"bbs_id",t:6},{s:"msg",t:7}],25837:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"start",t:4},{s:"num",t:2}],25838:[{s:"bbs_id",t:6}],25839:[{s:"type",t:2}],25840:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"bbs_id",t:6}],25841:[],30001:[],30002:[{s:"id",t:6}],30100:[],30101:[],30102:[]},e.exports.recv={10101:[{s:"code",t:2},{s:"msg",t:7},{s:"rid",t:6},{s:"srv_id",t:7},{s:"name",t:7},{s:"reg_time",t:6}],10102:[{s:"code",t:2},{s:"msg",t:7},{s:"timestamp",t:6},{s:"world_lev",t:4}],10103:[{s:"code",t:2},{s:"msg",t:7},{s:"timestamp",t:6},{s:"world_lev",t:4}],10200:[{s:"result",t:2},{s:"msg",t:7},{s:"battle_id",t:6},{s:"id",t:6},{s:"time",t:6}],10210:[{s:"bid",t:6},{s:"res_id",t:6},{s:"x",t:4},{s:"y",t:4},{s:"dir",t:2}],10211:[{s:"bid",t:6},{s:"dynamic_block",t:9,f:[{s:"id",t:2},{s:"val",t:2}]}],10213:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"name",t:7},{s:"speed",t:4},{s:"dir",t:2},{s:"x",t:4},{s:"y",t:4},{s:"face",t:6},{s:"lev",t:2},{s:"sex",t:2},{s:"avatar",t:6},{s:"status",t:2},{s:"event",t:2},{s:"looks",t:9,f:[{s:"looks_type",t:6},{s:"looks_mode",t:6},{s:"looks_val",t:6},{s:"looks_str",t:7}]}],10214:[{s:"bid",t:6},{s:"role_ids",t:9,f:[{s:"rid",t:6},{s:"srv_id",t:7}]}],10215:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"dir",t:2},{s:"dx",t:4},{s:"dy",t:4}],10216:[{s:"role_list",t:9,f:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"name",t:7},{s:"speed",t:4},{s:"dir",t:2},{s:"x",t:4},{s:"y",t:4},{s:"face",t:6},{s:"lev",t:2},{s:"sex",t:2},{s:"avatar",t:6},{s:"status",t:2},{s:"event",t:2},{s:"looks",t:9,f:[{s:"looks_type",t:6},{s:"looks_mode",t:6},{s:"looks_val",t:6},{s:"looks_str",t:7}]}]}],10217:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"name",t:7},{s:"speed",t:4},{s:"dir",t:2},{s:"x",t:4},{s:"y",t:4},{s:"face",t:6},{s:"lev",t:2},{s:"sex",t:2},{s:"avatar",t:6},{s:"status",t:2},{s:"event",t:2},{s:"looks",t:9,f:[{s:"looks_type",t:6},{s:"looks_mode",t:6},{s:"looks_val",t:6},{s:"looks_str",t:7}]}],10219:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"type",t:2},{s:"looks",t:9,f:[{s:"looks_type",t:6},{s:"looks_mode",t:6},{s:"looks_val",t:6},{s:"looks_str",t:7}]}],10220:[{s:"unit_list",t:9,f:[{s:"battle_id",t:6},{s:"id",t:6},{s:"base_id",t:6},{s:"name",t:7},{s:"status",t:2},{s:"speed",t:4},{s:"x",t:4},{s:"y",t:4},{s:"lev",t:2},{s:"looks",t:9,f:[{s:"looks_type",t:6},{s:"looks_mode",t:6},{s:"looks_val",t:6},{s:"looks_str",t:7}]}]}],10222:[{s:"role_list",t:9,f:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"name",t:7},{s:"speed",t:4},{s:"dir",t:2},{s:"x",t:4},{s:"y",t:4},{s:"face",t:6},{s:"lev",t:2},{s:"sex",t:2},{s:"avatar",t:6},{s:"status",t:2},{s:"event",t:2},{s:"looks",t:9,f:[{s:"looks_type",t:6},{s:"looks_mode",t:6},{s:"looks_val",t:6},{s:"looks_str",t:7}]}]}],10250:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"act_type",t:6},{s:"num",t:2}],10260:[{s:"battle_id",t:6},{s:"id",t:6},{s:"base_id",t:6},{s:"name",t:7},{s:"status",t:2},{s:"speed",t:4},{s:"x",t:4},{s:"y",t:4},{s:"lev",t:2},{s:"looks",t:9,f:[{s:"looks_type",t:6},{s:"looks_mode",t:6},{s:"looks_val",t:6},{s:"looks_str",t:7}]}],10262:[{s:"battle_id",t:6},{s:"id",t:6}],10264:[{s:"battle_id",t:6},{s:"id",t:6},{s:"dx",t:4},{s:"dy",t:4}],10265:[{s:"battle_id",t:6},{s:"id",t:6},{s:"msg",t:7}],10266:[{s:"battle_id",t:6},{s:"id",t:6},{s:"base_id",t:6},{s:"name",t:7},{s:"status",t:2},{s:"speed",t:4},{s:"x",t:4},{s:"y",t:4},{s:"lev",t:2},{s:"looks",t:9,f:[{s:"looks_type",t:6},{s:"looks_mode",t:6},{s:"looks_val",t:6},{s:"looks_str",t:7}]}],10300:[],10301:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"name",t:7},{s:"lev",t:4},{s:"is_vip",t:2},{s:"vip_lev",t:2},{s:"vip_exp",t:6},{s:"is_show_vip",t:2},{s:"sex",t:2},{s:"career",t:4},{s:"face_id",t:6},{s:"event",t:2},{s:"gid",t:6},{s:"gsrv_id",t:7},{s:"position",t:2},{s:"gname",t:7},{s:"signature",t:7},{s:"exp_max",t:6},{s:"exp_total_nextlev",t:6},{s:"buffs",t:9,f:[{s:"bid",t:6},{s:"duration",t:6},{s:"count",t:2},{s:"effect",t:9,f:[{s:"key",t:2},{s:"val",t:6}]}]},{s:"reg_time",t:6},{s:"guild_lev",t:2},{s:"power",t:6},{s:"is_first_rename",t:2},{s:"avatar_base_id",t:6},{s:"guild_quit_time",t:6},{s:"look_id",t:6},{s:"max_power",t:6},{s:"auto_pk",t:2},{s:"vip_card_exp",t:6},{s:"dun_id",t:6},{s:"chapter_id",t:6}],10302:[{s:"lev",t:4},{s:"exp",t:6},{s:"gold",t:6},{s:"gold_acc",t:6},{s:"coin",t:6},{s:"red_gold",t:6},{s:"energy",t:6},{s:"energy_max",t:6},{s:"arena_cent",t:6},{s:"activity",t:4},{s:"guild",t:6},{s:"hero_soul",t:6},{s:"friend_point",t:6},{s:"boss_point",t:6},{s:"silver_coin",t:6},{s:"star_hun",t:6},{s:"star_point",t:6},{s:"arena_guesscent",t:6},{s:"sky_coin",t:6},{s:"hero_exp",t:6},{s:"recruit_hero",t:6},{s:"recruithigh_hero",t:6},{s:"expedition_medal",t:6}],10304:[],10305:[{s:"assets",t:9,f:[{s:"label",t:2},{s:"val",t:6}]}],10306:[{s:"power",t:6},{s:"max_power",t:6}],10307:[{s:"event",t:2}],10309:[{s:"code",t:2},{s:"msg",t:7},{s:"signature",t:7}],10310:[{s:"is_show",t:2},{s:"msg",t:7}],10312:[],10315:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"name",t:7},{s:"gname",t:7},{s:"lev",t:4},{s:"face_id",t:6},{s:"power",t:6},{s:"partner_list",t:9,f:[{s:"id",t:6},{s:"bid",t:6},{s:"lev",t:4},{s:"star",t:2},{s:"quality",t:2},{s:"awaken_lev",t:6},{s:"use_skin",t:6}]},{s:"gid",t:6},{s:"gsrv_id",t:7},{s:"avatar_bid",t:6},{s:"sex",t:2},{s:"city",t:6},{s:"vip_lev",t:6},{s:"honor_list",t:9,f:[{s:"type",t:6},{s:"val",t:6},{s:"rank",t:2}]}],10316:[{s:"code",t:2},{s:"msg",t:7},{s:"type",t:2},{s:"rid",t:6},{s:"srv_id",t:7},{s:"idx",t:6}],10317:[{s:"worship",t:6}],10318:[{s:"code",t:2},{s:"msg",t:7},{s:"auto_pk",t:2}],10322:[{s:"code1",t:2}],10323:[{s:"code",t:2}],10325:[{s:"face_list",t:9,f:[{s:"face_id",t:6}]}],10327:[{s:"code",t:2},{s:"msg",t:7},{s:"face_id",t:6}],10342:[],10343:[{s:"code",t:2},{s:"msg",t:7},{s:"name",t:7},{s:"sex",t:2}],10344:[{s:"old_lev",t:4},{s:"lev",t:4}],10345:[{s:"use_id",t:6},{s:"list",t:9,f:[{s:"id",t:6}]}],10346:[{s:"code",t:2},{s:"msg",t:7},{s:"id",t:6}],10347:[{s:"code",t:2},{s:"msg",t:7},{s:"id",t:6}],10348:[{s:"code",t:2},{s:"msg",t:7},{s:"is_show_vip",t:2}],10350:[{s:"holiday_assets",t:9,f:[{s:"id",t:6},{s:"val",t:6}]}],10351:[{s:"holiday_assets",t:9,f:[{s:"id",t:6},{s:"val",t:6}]}],10380:[{s:"reg_time",t:6},{s:"open_time",t:6}],10391:[{s:"type",t:2},{s:"data",t:7}],10395:[{s:"status",t:2},{s:"end_time",t:6},{s:"down_sec",t:6}],10396:[],10397:[],10399:[{s:"code",t:2},{s:"msg",t:7}],10400:[{s:"quest_list",t:9,f:[{s:"id",t:6},{s:"finish",t:2},{s:"accept_time",t:6},{s:"progress",t:9,f:[{s:"id",t:3},{s:"finish",t:2},{s:"target",t:6},{s:"target_val",t:6},{s:"value",t:6},{s:"ext_data",t:9,f:[{s:"key",t:2},{s:"value",t:6}]}]}]}],10402:[{s:"flag",t:1},{s:"msg",t:7},{s:"id",t:6}],10403:[{s:"quest_list",t:9,f:[{s:"id",t:6},{s:"finish",t:2},{s:"accept_time",t:6},{s:"progress",t:9,f:[{s:"id",t:3},{s:"finish",t:2},{s:"target",t:6},{s:"target_val",t:6},{s:"value",t:6},{s:"ext_data",t:9,f:[{s:"key",t:2},{s:"value",t:6}]}]}]}],10404:[{s:"quest_list",t:9,f:[{s:"id",t:6}]}],10405:[{s:"flag",t:1},{s:"msg",t:7},{s:"id",t:6}],10406:[{s:"flag",t:1},{s:"msg",t:7},{s:"id",t:6}],10407:[{s:"quest_list",t:9,f:[{s:"id",t:6}]}],10408:[{s:"quest_list",t:9,f:[{s:"id",t:6}]}],10409:[{s:"quest_list",t:9,f:[{s:"id",t:6},{s:"finish",t:2},{s:"accept_time",t:6},{s:"progress",t:9,f:[{s:"id",t:3},{s:"finish",t:2},{s:"target",t:6},{s:"target_val",t:6},{s:"value",t:6},{s:"ext_data",t:9,f:[{s:"key",t:2},{s:"value",t:6}]}]}]}],10500:[{s:"volume",t:6},{s:"open_times",t:2},{s:"item_list",t:9,f:[{s:"id",t:6},{s:"base_id",t:6},{s:"bind",t:2},{s:"quantity",t:6},{s:"pos",t:4},{s:"expire_type",t:2},{s:"expire_time",t:6},{s:"main_attr",t:9,f:[{s:"attr_id",t:6},{s:"attr_val",t:6}]},{s:"enchant",t:6},{s:"attr",t:9,f:[{s:"attr_id",t:6},{s:"attr_val",t:6}]},{s:"extra_attr",t:9,f:[{s:"attr_id",t:6},{s:"attr_val",t:6}]},{s:"score",t:6},{s:"all_score",t:6},{s:"extra",t:9,f:[{s:"extra_k",t:6},{s:"extra_v",t:6}]}]}],10501:[{s:"volume",t:6},{s:"open_times",t:2},{s:"item_list",t:9,f:[{s:"id",t:6},{s:"base_id",t:6},{s:"bind",t:2},{s:"quantity",t:6},{s:"pos",t:4},{s:"expire_type",t:2},{s:"expire_time",t:6},{s:"main_attr",t:9,f:[{s:"attr_id",t:6},{s:"attr_val",t:6}]},{s:"enchant",t:6},{s:"attr",t:9,f:[{s:"attr_id",t:6},{s:"attr_val",t:6}]},{s:"extra_attr",t:9,f:[{s:"attr_id",t:6},{s:"attr_val",t:6}]},{s:"score",t:6},{s:"all_score",t:6},{s:"extra",t:9,f:[{s:"extra_k",t:6},{s:"extra_v",t:6}]},{s:"gemstones",t:9,f:[{s:"lev",t:6}]}]}],10510:[{s:"item_list",t:9,f:[{s:"storage",t:2},{s:"id",t:6},{s:"base_id",t:6},{s:"bind",t:2},{s:"quantity",t:6},{s:"pos",t:4},{s:"expire_type",t:2},{s:"expire_time",t:6},{s:"main_attr",t:9,f:[{s:"attr_id",t:6},{s:"attr_val",t:6}]},{s:"enchant",t:6},{s:"attr",t:9,f:[{s:"attr_id",t:6},{s:"attr_val",t:6}]},{s:"extra_attr",t:9,f:[{s:"attr_id",t:6},{s:"attr_val",t:6}]},{s:"score",t:6},{s:"all_score",t:6},{s:"extra",t:9,f:[{s:"extra_k",t:6},{s:"extra_v",t:6}]},{s:"gemstones",t:9,f:[{s:"lev",t:6}]}]}],10511:[{s:"item_list",t:9,f:[{s:"storage",t:2},{s:"id",t:6},{s:"pos",t:4}]}],10512:[{s:"item_list",t:9,f:[{s:"storage",t:2},{s:"id",t:6},{s:"base_id",t:6},{s:"bind",t:2},{s:"quantity",t:6},{s:"pos",t:4},{s:"expire_type",t:2},{s:"expire_time",t:6},{s:"main_attr",t:9,f:[{s:"attr_id",t:6},{s:"attr_val",t:6}]},{s:"enchant",t:6},{s:"attr",t:9,f:[{s:"attr_id",t:6},{s:"attr_val",t:6}]},{s:"extra_attr",t:9,f:[{s:"attr_id",t:6},{s:"attr_val",t:6}]},{s:"score",t:6},{s:"all_score",t:6},{s:"extra",t:9,f:[{s:"extra_k",t:6},{s:"extra_v",t:6}]},{s:"gemstones",t:9,f:[{s:"lev",t:6}]}]}],10515:[{s:"flag",t:2},{s:"base_id",t:6},{s:"msg",t:7}],10520:[{s:"id",t:6},{s:"storage",t:2},{s:"flag",t:2},{s:"msg",t:7}],10522:[{s:"flag",t:2},{s:"msg",t:7}],10523:[{s:"flag",t:2},{s:"msg",t:7}],10524:[{s:"flag",t:2},{s:"msg",t:7}],10525:[{s:"star_list",t:9,f:[{s:"star",t:2}]}],10526:[{s:"type",t:2},{s:"volume",t:6},{s:"open_times",t:2}],10528:[{s:"time",t:6},{s:"minu_exp",t:6}],10530:[],10535:[{s:"flag",t:2},{s:"msg",t:7},{s:"share_id",t:6},{s:"base_id",t:6},{s:"count",t:6},{s:"code",t:6}],10536:[{s:"base_id",t:6},{s:"quantity",t:6},{s:"pos",t:4},{s:"expire_type",t:2},{s:"expire_time",t:6},{s:"main_attr",t:9,f:[{s:"attr_id",t:6},{s:"attr_val",t:6}]},{s:"enchant",t:6},{s:"attr",t:9,f:[{s:"attr_id",t:6},{s:"attr_val",t:6}]},{s:"score",t:6},{s:"all_score",t:6},{s:"extra",t:9,f:[{s:"extra_k",t:6},{s:"extra_v",t:6}]},{s:"gemstones",t:9,f:[{s:"lev",t:6}]}],10800:[{s:"mail",t:9,f:[{s:"id",t:6},{s:"srv_id",t:7},{s:"type",t:2},{s:"from_name",t:7},{s:"subject",t:7},{s:"content",t:7},{s:"assets",t:9,f:[{s:"label",t:2},{s:"val",t:6}]},{s:"items",t:9,f:[{s:"base_id",t:6},{s:"quantity",t:6}]},{s:"send_time",t:6},{s:"read_time",t:6},{s:"time_out",t:6},{s:"status",t:2}]}],10801:[{s:"id",t:6},{s:"srv_id",t:7},{s:"code",t:2},{s:"msg",t:7}],10802:[{s:"ids",t:9,f:[{s:"id",t:6},{s:"srv_id",t:7},{s:"read_time",t:6}]},{s:"msg",t:7}],10803:[{s:"mail",t:9,f:[{s:"id",t:6},{s:"srv_id",t:7},{s:"type",t:2},{s:"from_name",t:7},{s:"subject",t:7},{s:"content",t:7},{s:"assets",t:9,f:[{s:"label",t:2},{s:"val",t:6}]},{s:"items",t:9,f:[{s:"base_id",t:6},{s:"quantity",t:6}]},{s:"send_time",t:6},{s:"read_time",t:6},{s:"time_out",t:6},{s:"status",t:2}]}],10804:[{s:"ids",t:9,f:[{s:"id",t:6},{s:"srv_id",t:7}]},{s:"msg",t:7}],10805:[{s:"id",t:6},{s:"srv_id",t:7},{s:"code",t:2},{s:"msg",t:7},{s:"read_time",t:6},{s:"is_delete",t:2}],10810:[{s:"code",t:2},{s:"msg",t:7}],10900:[{s:"code",t:2},{s:"msg",t:7}],10901:[{s:"code",t:2},{s:"msg",t:7}],10902:[{s:"code",t:2},{s:"msg",t:7}],10905:[{s:"world_lev",t:2}],10906:[{s:"open_day",t:6}],10911:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"buffs",t:9,f:[{s:"bid",t:6},{s:"duration",t:6},{s:"count",t:2},{s:"effect",t:9,f:[{s:"key",t:2},{s:"val",t:6}]}]}],10912:[{s:"bid",t:6},{s:"effect",t:9,f:[{s:"key",t:2},{s:"val",t:6}]}],10913:[{s:"buffs",t:9,f:[{s:"change_type",t:2},{s:"bid",t:6},{s:"duration",t:6},{s:"count",t:2},{s:"effect",t:9,f:[{s:"key",t:2},{s:"val",t:5}]}]}],10922:[{s:"act_list",t:9,f:[{s:"id",t:4},{s:"status",t:2},{s:"int_args",t:9,f:[{s:"val",t:6}]},{s:"ext_args",t:9,f:[{s:"type",t:2},{s:"val",t:6},{s:"str",t:7}]}]}],10923:[{s:"id",t:4},{s:"status",t:2},{s:"int_args",t:9,f:[{s:"val",t:6}]},{s:"ext_args",t:9,f:[{s:"type",t:2},{s:"val",t:6},{s:"str",t:7}]}],10924:[{s:"act_list",t:9,f:[{s:"id",t:4},{s:"status",t:2},{s:"int_args",t:9,f:[{s:"val",t:6}]},{s:"ext_args",t:9,f:[{s:"type",t:2},{s:"val",t:6},{s:"str",t:7}]}]}],10925:[{s:"id",t:4},{s:"status",t:2},{s:"int_args",t:9,f:[{s:"val",t:6}]},{s:"ext_args",t:9,f:[{s:"type",t:2},{s:"val",t:6},{s:"str",t:7}]}],10926:[{s:"time",t:6},{s:"list",t:9,f:[{s:"time",t:6}]}],10927:[{s:"code",t:2},{s:"msg",t:7},{s:"time",t:6}],10945:[{s:"code",t:2},{s:"msg",t:7}],10946:[{s:"code",t:2}],10950:[{s:"type",t:2},{s:"board_list",t:9,f:[{s:"id",t:6},{s:"type",t:2},{s:"title",t:7},{s:"summary",t:7},{s:"content",t:7},{s:"start_time",t:6},{s:"end_time",t:6},{s:"flag",t:2}]}],10951:[{s:"id",t:6}],10952:[{s:"code",t:2},{s:"msg",t:7},{s:"id",t:6}],10955:[{s:"key",t:4},{s:"val",t:6}],10956:[],10994:[{s:"type",t:2}],10995:[{s:"main_srv_id",t:7},{s:"srv_list",t:9,f:[{s:"srv_id",t:7}]}],10996:[{s:"cli_ver_list",t:9,f:[{s:"cdn_patch",t:7},{s:"cli_ver",t:4}]}],10997:[{s:"flag",t:2}],10999:[],1110:[{s:"code",t:2},{s:"msg",t:7},{s:"roles",t:9,f:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"name",t:7},{s:"lev",t:4},{s:"sex",t:2},{s:"career",t:4},{s:"face_id",t:6},{s:"is_online",t:2}]},{s:"least_career",t:2}],1198:[{s:"time",t:6}],1199:[{s:"time",t:6}],11000:[{s:"sort_type",t:2},{s:"num",t:6},{s:"buy_num",t:2},{s:"partners",t:9,f:[{s:"partner_id",t:6},{s:"bid",t:6},{s:"lev",t:4},{s:"star",t:2},{s:"skills",t:9,f:[{s:"pos",t:2},{s:"skill_bid",t:6}]},{s:"break_lev",t:2},{s:"power",t:6},{s:"is_lock",t:9,f:[{s:"lock_type",t:6},{s:"is_lock",t:2}]},{s:"use_skin",t:6},{s:"atk",t:6},{s:"def_p",t:6},{s:"def_s",t:6},{s:"hp",t:6},{s:"speed",t:6},{s:"hit_rate",t:6},{s:"dodge_rate",t:6},{s:"crit_rate",t:6},{s:"crit_ratio",t:6},{s:"hit_magic",t:6},{s:"dodge_magic",t:6},{s:"def",t:6},{s:"atk2",t:6},{s:"hp2",t:6},{s:"def2",t:6},{s:"speed2",t:6},{s:"eqms",t:9,f:[{s:"id",t:6},{s:"base_id",t:6},{s:"type",t:6}]},{s:"artifacts",t:9,f:[{s:"artifact_pos",t:2},{s:"id",t:6},{s:"base_id",t:6},{s:"enchant",t:6},{s:"attr",t:9,f:[{s:"attr_id",t:6},{s:"attr_val",t:6}]},{s:"extra_attr",t:9,f:[{s:"attr_id",t:6},{s:"attr_val",t:6}]},{s:"extra",t:9,f:[{s:"extra_k",t:6},{s:"extra_v",t:6}]}]}]}],11001:[{s:"partners",t:9,f:[{s:"partner_id",t:6},{s:"bid",t:6},{s:"lev",t:4},{s:"star",t:2},{s:"skills",t:9,f:[{s:"pos",t:2},{s:"skill_bid",t:6}]},{s:"break_lev",t:2},{s:"power",t:6},{s:"is_lock",t:9,f:[{s:"lock_type",t:6},{s:"is_lock",t:2}]},{s:"use_skin",t:6},{s:"atk",t:6},{s:"def_p",t:6},{s:"def_s",t:6},{s:"hp",t:6},{s:"speed",t:6},{s:"hit_rate",t:6},{s:"dodge_rate",t:6},{s:"crit_rate",t:6},{s:"crit_ratio",t:6},{s:"hit_magic",t:6},{s:"dodge_magic",t:6},{s:"def",t:6},{s:"atk2",t:6},{s:"hp2",t:6},{s:"def2",t:6},{s:"speed2",t:6},{s:"eqms",t:9,f:[{s:"id",t:6},{s:"base_id",t:6},{s:"type",t:6}]},{s:"artifacts",t:9,f:[{s:"artifact_pos",t:2},{s:"id",t:6},{s:"base_id",t:6},{s:"enchant",t:6},{s:"attr",t:9,f:[{s:"attr_id",t:6},{s:"attr_val",t:6}]},{s:"extra_attr",t:9,f:[{s:"attr_id",t:6},{s:"attr_val",t:6}]},{s:"extra",t:9,f:[{s:"extra_k",t:6},{s:"extra_v",t:6}]}]}]}],11002:[{s:"partner_id",t:6},{s:"bid",t:6},{s:"lev",t:4},{s:"star",t:2},{s:"skills",t:9,f:[{s:"pos",t:2},{s:"skill_bid",t:6}]},{s:"break_lev",t:2},{s:"power",t:6},{s:"is_lock",t:9,f:[{s:"lock_type",t:6},{s:"is_lock",t:2}]},{s:"use_skin",t:6},{s:"atk",t:6},{s:"def_p",t:6},{s:"def_s",t:6},{s:"hp",t:6},{s:"speed",t:6},{s:"hit_rate",t:6},{s:"dodge_rate",t:6},{s:"crit_rate",t:6},{s:"crit_ratio",t:6},{s:"hit_magic",t:6},{s:"dodge_magic",t:6},{s:"def",t:6},{s:"atk2",t:6},{s:"hp2",t:6},{s:"def2",t:6},{s:"speed2",t:6}],11003:[{s:"result",t:2},{s:"msg",t:7}],11004:[{s:"result",t:2},{s:"msg",t:7}],11005:[{s:"result",t:2},{s:"msg",t:7}],11006:[{s:"expend2",t:9,f:[{s:"partner_id",t:6}]}],11007:[{s:"ref_partners",t:9,f:[{s:"partner_id",t:6},{s:"power",t:6},{s:"atk",t:6},{s:"def_p",t:6},{s:"def_s",t:6},{s:"hp",t:6},{s:"speed",t:6},{s:"hit_rate",t:6},{s:"dodge_rate",t:6},{s:"crit_rate",t:6},{s:"crit_ratio",t:6},{s:"hit_magic",t:6},{s:"dodge_magic",t:6},{s:"def",t:6}]}],11008:[{s:"result",t:2},{s:"msg",t:7},{s:"partners",t:9,f:[{s:"partner_bid",t:6}]}],11009:[{s:"result",t:2},{s:"msg",t:7},{s:"num",t:6},{s:"buy_num",t:2}],11010:[{s:"result",t:2},{s:"msg",t:7}],11011:[{s:"result",t:2},{s:"msg",t:7}],11012:[{s:"partner_id",t:6},{s:"power",t:6},{s:"atk",t:6},{s:"def_p",t:6},{s:"def_s",t:6},{s:"hp",t:6},{s:"speed",t:6},{s:"hit_rate",t:6},{s:"dodge_rate",t:6},{s:"crit_rate",t:6},{s:"crit_ratio",t:6},{s:"hit_magic",t:6},{s:"dodge_magic",t:6},{s:"def",t:6},{s:"eqms",t:9,f:[{s:"id",t:6},{s:"base_id",t:6},{s:"type",t:6}]}],11015:[{s:"result",t:2},{s:"msg",t:7},{s:"partner_id",t:6},{s:"type",t:2}],11016:[{s:"atk",t:6},{s:"def_p",t:6},{s:"def_s",t:6},{s:"hp",t:6},{s:"speed",t:6},{s:"hit_rate",t:6},{s:"dodge_rate",t:6},{s:"crit_rate",t:6},{s:"crit_ratio",t:6},{s:"hit_magic",t:6},{s:"dodge_magic",t:6},{s:"def",t:6}],11017:[{s:"num",t:6}],11019:[{s:"result",t:2},{s:"msg",t:7},{s:"partner_id",t:6}],11020:[{s:"partner_skins",t:9,f:[{s:"id",t:6},{s:"end_time",t:6}]}],11025:[{s:"sort_type",t:2},{s:"num",t:6},{s:"buy_num",t:2},{s:"partners",t:9,f:[{s:"partner_id",t:6},{s:"bid",t:6},{s:"lev",t:4},{s:"star",t:2},{s:"skills",t:9,f:[{s:"pos",t:2},{s:"skill_bid",t:6}]},{s:"break_lev",t:2},{s:"power",t:6},{s:"is_lock",t:9,f:[{s:"lock_type",t:6},{s:"is_lock",t:2}]},{s:"use_skin",t:6}]}],11026:[{s:"partners",t:9,f:[{s:"partner_id",t:6},{s:"atk",t:6},{s:"def_p",t:6},{s:"def_s",t:6},{s:"hp",t:6},{s:"speed",t:6},{s:"hit_rate",t:6},{s:"dodge_rate",t:6},{s:"crit_rate",t:6},{s:"crit_ratio",t:6},{s:"hit_magic",t:6},{s:"dodge_magic",t:6},{s:"def",t:6},{s:"eqms",t:9,f:[{s:"id",t:6},{s:"base_id",t:6},{s:"type",t:6}]},{s:"artifacts",t:9,f:[{s:"artifact_pos",t:2},{s:"id",t:6},{s:"base_id",t:6},{s:"enchant",t:6},{s:"attr",t:9,f:[{s:"attr_id",t:6},{s:"attr_val",t:6}]},{s:"extra_attr",t:9,f:[{s:"attr_id",t:6},{s:"attr_val",t:6}]},{s:"extra",t:9,f:[{s:"extra_k",t:6},{s:"extra_v",t:6}]}]}]}],11030:[{s:"result",t:2},{s:"msg",t:7}],11031:[{s:"partner_id",t:6},{s:"power",t:6},{s:"atk",t:6},{s:"def_p",t:6},{s:"def_s",t:6},{s:"hp",t:6},{s:"speed",t:6},{s:"hit_rate",t:6},{s:"dodge_rate",t:6},{s:"crit_rate",t:6},{s:"crit_ratio",t:6},{s:"hit_magic",t:6},{s:"dodge_magic",t:6},{s:"def",t:6},{s:"artifacts",t:9,f:[{s:"artifact_pos",t:2},{s:"id",t:6},{s:"base_id",t:6},{s:"enchant",t:6},{s:"attr",t:9,f:[{s:"attr_id",t:6},{s:"attr_val",t:6}]},{s:"extra_attr",t:9,f:[{s:"attr_id",t:6},{s:"attr_val",t:6}]},{s:"extra",t:9,f:[{s:"extra_k",t:6},{s:"extra_v",t:6}]}]}],11032:[{s:"result",t:2},{s:"msg",t:7}],11033:[{s:"result",t:2},{s:"msg",t:7}],11034:[{s:"result",t:2},{s:"msg",t:7}],11035:[{s:"result",t:2},{s:"msg",t:7}],11036:[{s:"result",t:2},{s:"msg",t:7},{s:"flag",t:2}],11037:[{s:"lucky",t:6}],11038:[{s:"result",t:2},{s:"msg",t:7}],11040:[{s:"partners",t:9,f:[{s:"partner_id",t:6},{s:"max_star",t:2}]},{s:"all_star",t:6},{s:"lev",t:6},{s:"decompose_partners",t:9,f:[{s:"partner_id",t:6}]}],11041:[{s:"like",t:2},{s:"like_num",t:6},{s:"partner_comments",t:9,f:[{s:"comment_id",t:6},{s:"name",t:7},{s:"msg",t:7},{s:"like_num",t:6},{s:"no_like_num",t:6},{s:"is_like",t:2}]}],11042:[{s:"result",t:2},{s:"msg",t:7}],11043:[{s:"result",t:2},{s:"msg",t:7}],11044:[{s:"result",t:2},{s:"msg",t:7},{s:"type",t:2}],11045:[{s:"result",t:2},{s:"msg",t:7},{s:"partner_id",t:6}],11046:[{s:"old_star",t:6},{s:"new_star",t:6}],11047:[{s:"result",t:2},{s:"msg",t:7},{s:"lev",t:6}],11050:[{s:"result",t:2},{s:"msg",t:7},{s:"lev",t:6},{s:"fields",t:9,f:[{s:"pos",t:6},{s:"partner_id",t:6}]}],11051:[{s:"result",t:2},{s:"msg",t:7}],11052:[{s:"result",t:2},{s:"msg",t:7},{s:"lev",t:6}],11053:[{s:"result",t:2},{s:"msg",t:7},{s:"pos",t:2}],11055:[],11056:[{s:"is_point",t:2}],11060:[{s:"result",t:2},{s:"msg",t:7}],11061:[{s:"partner_id",t:6},{s:"bid",t:6},{s:"lev",t:4},{s:"star",t:2},{s:"skills",t:9,f:[{s:"pos",t:2},{s:"skill_bid",t:6}]},{s:"break_lev",t:2},{s:"power",t:6},{s:"is_lock",t:9,f:[{s:"lock_type",t:6},{s:"is_lock",t:2}]},{s:"use_skin",t:6},{s:"atk",t:6},{s:"def_p",t:6},{s:"def_s",t:6},{s:"hp",t:6},{s:"speed",t:6},{s:"hit_rate",t:6},{s:"dodge_rate",t:6},{s:"crit_rate",t:6},{s:"crit_ratio",t:6},{s:"hit_magic",t:6},{s:"dodge_magic",t:6},{s:"dam",t:6},{s:"res",t:6},{s:"cure",t:6},{s:"be_cure",t:6},{s:"tenacity",t:6},{s:"def",t:6},{s:"dam_p",t:6},{s:"dam_s",t:6},{s:"res_p",t:6},{s:"res_s",t:6},{s:"atk2",t:6},{s:"hp2",t:6},{s:"def2",t:6},{s:"speed2",t:6},{s:"eqms",t:9,f:[{s:"id",t:6},{s:"base_id",t:6},{s:"type",t:6}]},{s:"artifacts",t:9,f:[{s:"artifact_pos",t:2},{s:"id",t:6},{s:"base_id",t:6},{s:"enchant",t:6},{s:"attr",t:9,f:[{s:"attr_id",t:6},{s:"attr_val",t:6}]},{s:"extra_attr",t:9,f:[{s:"attr_id",t:6},{s:"attr_val",t:6}]},{s:"extra",t:9,f:[{s:"extra_k",t:6},{s:"extra_v",t:6}]}]},{s:"dower_skill",t:9,f:[{s:"pos",t:2},{s:"skill_id",t:6}]},{s:"ext_data",t:9,f:[{s:"id",t:6},{s:"val",t:6}]},{s:"holy_eqm",t:9,f:[{s:"id",t:6},{s:"base_id",t:6},{s:"main_attr",t:9,f:[{s:"attr_id",t:6},{s:"attr_val",t:6}]},{s:"holy_eqm_attr",t:9,f:[{s:"pos",t:2},{s:"attr_id",t:6},{s:"attr_val",t:6}]}]}],11062:[{s:"partner_id",t:6},{s:"bid",t:6},{s:"lev",t:4},{s:"star",t:2},{s:"skills",t:9,f:[{s:"pos",t:2},{s:"skill_bid",t:6}]},{s:"break_lev",t:2},{s:"power",t:6},{s:"is_lock",t:9,f:[{s:"lock_type",t:6},{s:"is_lock",t:2}]},{s:"use_skin",t:6},{s:"atk",t:6},{s:"def_p",t:6},{s:"def_s",t:6},{s:"hp",t:6},{s:"speed",t:6},{s:"hit_rate",t:6},{s:"dodge_rate",t:6},{s:"crit_rate",t:6},{s:"crit_ratio",t:6},{s:"hit_magic",t:6},{s:"dodge_magic",t:6},{s:"dam",t:6},{s:"res",t:6},{s:"cure",t:6},{s:"be_cure",t:6},{s:"tenacity",t:6},{s:"def",t:6},{s:"dam_p",t:6},{s:"dam_s",t:6},{s:"res_p",t:6},{s:"res_s",t:6},{s:"atk2",t:6},{s:"hp2",t:6},{s:"def2",t:6},{s:"speed2",t:6},{s:"eqms",t:9,f:[{s:"id",t:6},{s:"base_id",t:6},{s:"type",t:6}]},{s:"artifacts",t:9,f:[{s:"artifact_pos",t:2},{s:"id",t:6},{s:"base_id",t:6},{s:"enchant",t:6},{s:"attr",t:9,f:[{s:"attr_id",t:6},{s:"attr_val",t:6}]},{s:"extra_attr",t:9,f:[{s:"attr_id",t:6},{s:"attr_val",t:6}]},{s:"extra",t:9,f:[{s:"extra_k",t:6},{s:"extra_v",t:6}]}]},{s:"dower_skill",t:9,f:[{s:"pos",t:2},{s:"skill_id",t:6}]},{s:"ext_data",t:9,f:[{s:"id",t:6},{s:"val",t:6}]},{s:"holy_eqm",t:9,f:[{s:"id",t:6},{s:"base_id",t:6},{s:"main_attr",t:9,f:[{s:"attr_id",t:6},{s:"attr_val",t:6}]},{s:"holy_eqm_attr",t:9,f:[{s:"pos",t:2},{s:"attr_id",t:6},{s:"attr_val",t:6}]}]}],11063:[{s:"partner_id",t:6},{s:"atk",t:6},{s:"def_p",t:6},{s:"def_s",t:6},{s:"hp",t:6},{s:"speed",t:6},{s:"hit_rate",t:6},{s:"dodge_rate",t:6},{s:"crit_rate",t:6},{s:"crit_ratio",t:6},{s:"hit_magic",t:6},{s:"dodge_magic",t:6},{s:"dam",t:6},{s:"res",t:6},{s:"cure",t:6},{s:"be_cure",t:6},{s:"tenacity",t:6},{s:"def",t:6},{s:"dam_p",t:6},{s:"dam_s",t:6},{s:"res_p",t:6},{s:"res_s",t:6},{s:"ext_data",t:9,f:[{s:"id",t:6},{s:"val",t:6}]}],11070:[{s:"partner_bid",t:6},{s:"partner_score",t:9,f:[{s:"id_2",t:2},{s:"val",t:6}]},{s:"stronger_partner_score",t:9,f:[{s:"id_2",t:2},{s:"val",t:6}]}],11073:[{s:"partners",t:9,f:[{s:"partner_id",t:6},{s:"bid",t:6},{s:"lev",t:4},{s:"star",t:2},{s:"skills",t:9,f:[{s:"pos",t:2},{s:"skill_bid",t:6}]},{s:"break_lev",t:2},{s:"power",t:6},{s:"is_lock",t:9,f:[{s:"lock_type",t:6},{s:"is_lock",t:2}]},{s:"use_skin",t:6},{s:"atk",t:6},{s:"def_p",t:6},{s:"def_s",t:6},{s:"hp",t:6},{s:"speed",t:6},{s:"hit_rate",t:6},{s:"dodge_rate",t:6},{s:"crit_rate",t:6},{s:"crit_ratio",t:6},{s:"hit_magic",t:6},{s:"dodge_magic",t:6},{s:"def",t:6},{s:"atk2",t:6},{s:"hp2",t:6},{s:"def2",t:6},{s:"speed2",t:6},{s:"eqms",t:9,f:[{s:"id",t:6},{s:"base_id",t:6},{s:"type",t:6}]},{s:"artifacts",t:9,f:[{s:"artifact_pos",t:2},{s:"id",t:6},{s:"base_id",t:6},{s:"enchant",t:6},{s:"attr",t:9,f:[{s:"attr_id",t:6},{s:"attr_val",t:6}]},{s:"extra_attr",t:9,f:[{s:"attr_id",t:6},{s:"attr_val",t:6}]},{s:"extra",t:9,f:[{s:"extra_k",t:6},{s:"extra_v",t:6}]}]}]}],11075:[{s:"code",t:2},{s:"msg",t:7},{s:"list",t:9,f:[{s:"id",t:6},{s:"num",t:6}]}],11076:[{s:"code",t:2},{s:"msg",t:7},{s:"list",t:9,f:[{s:"partner_id",t:6}]}],11077:[{s:"result",t:2},{s:"msg",t:7},{s:"partner_bid",t:6}],11078:[{s:"result",t:2},{s:"msg",t:7},{s:"id",t:6}],11079:[{s:"type",t:2},{s:"coin",t:6},{s:"list",t:9,f:[{s:"bid",t:6},{s:"num",t:4}]}],11080:[{s:"result",t:2},{s:"msg",t:7}],11081:[{s:"result",t:2},{s:"msg",t:7}],11082:[{s:"logs",t:9,f:[{s:"items",t:9,f:[{s:"bid",t:6},{s:"num",t:4}]},{s:"time",t:6},{s:"coin",t:6}]}],11083:[{s:"result",t:2},{s:"msg",t:7},{s:"partner_id",t:6},{s:"item_id",t:6}],11085:[{s:"partner_id",t:6},{s:"old_star",t:6},{s:"new_star",t:6}],11086:[{s:"partner_id",t:6},{s:"power",t:6},{s:"atk",t:6},{s:"def_p",t:6},{s:"def_s",t:6},{s:"hp",t:6},{s:"speed",t:6},{s:"hit_rate",t:6},{s:"dodge_rate",t:6},{s:"crit_rate",t:6},{s:"crit_ratio",t:6},{s:"hit_magic",t:6},{s:"dodge_magic",t:6},{s:"dam",t:6},{s:"res",t:6},{s:"cure",t:6},{s:"be_cure",t:6},{s:"tenacity",t:6},{s:"def",t:6},{s:"dam_p",t:6},{s:"dam_s",t:6},{s:"res_p",t:6},{s:"res_s",t:6}],11087:[{s:"code",t:2},{s:"msg",t:7},{s:"list",t:9,f:[{s:"id",t:6},{s:"num",t:6}]}],11088:[{s:"code",t:2},{s:"msg",t:7},{s:"list",t:9,f:[{s:"id",t:6},{s:"num",t:6}]}],11089:[{s:"code",t:2},{s:"msg",t:7}],11090:[{s:"result",t:2},{s:"msg",t:7}],11091:[{s:"partner_id",t:6},{s:"power",t:6},{s:"atk",t:6},{s:"def_p",t:6},{s:"def_s",t:6},{s:"hp",t:6},{s:"speed",t:6},{s:"hit_rate",t:6},{s:"dodge_rate",t:6},{s:"crit_rate",t:6},{s:"crit_ratio",t:6},{s:"hit_magic",t:6},{s:"dodge_magic",t:6},{s:"dam",t:6},{s:"res",t:6},{s:"cure",t:6},{s:"be_cure",t:6},{s:"tenacity",t:6},{s:"def",t:6},{s:"dam_p",t:6},{s:"dam_s",t:6},{s:"res_p",t:6},{s:"res_s",t:6},{s:"holy_eqm",t:9,f:[{s:"id",t:6},{s:"base_id",t:6},{s:"main_attr",t:9,f:[{s:"attr_id",t:6},{s:"attr_val",t:6}]},{s:"holy_eqm_attr",t:9,f:[{s:"pos",t:2},{s:"attr_id",t:6},{s:"attr_val",t:6}]},{s:"extra",t:9,f:[{s:"extra_k",t:6},{s:"extra_v",t:6}]}]}],11092:[{s:"partner_ids",t:9,f:[{s:"partner_id",t:6},{s:"holy_eqm",t:9,f:[{s:"id",t:6},{s:"base_id",t:6},{s:"main_attr",t:9,f:[{s:"attr_id",t:6},{s:"attr_val",t:6}]},{s:"holy_eqm_attr",t:9,f:[{s:"pos",t:2},{s:"attr_id",t:6},{s:"attr_val",t:6}]},{s:"extra",t:9,f:[{s:"extra_k",t:6},{s:"extra_v",t:6}]}]}]}],11093:[{s:"result",t:2},{s:"msg",t:7}],11094:[{s:"result",t:2},{s:"msg",t:7}],11095:[{s:"partner_bid",t:6},{s:"is_chips",t:2},{s:"init_star",t:2},{s:"status",t:2}],11096:[{s:"partner_id",t:6},{s:"result",t:2},{s:"msg",t:7},{s:"dower_skill",t:9,f:[{s:"pos",t:2},{s:"skill_id",t:6}]}],11097:[{s:"partner_id",t:6},{s:"result",t:2},{s:"msg",t:7},{s:"dower_skill",t:9,f:[{s:"pos",t:2},{s:"skill_id",t:6}]}],11098:[{s:"partner_id",t:6},{s:"result",t:2},{s:"msg",t:7},{s:"dower_skill",t:9,f:[{s:"pos",t:2},{s:"skill_id",t:6}]}],11099:[{s:"partner_ids",t:9,f:[{s:"partner_id",t:6},{s:"dower_skill",t:9,f:[{s:"pos",t:2},{s:"skill_id",t:6}]}]}],11100:[],11101:[{s:"drama_bid",t:6}],11102:[{s:"code",t:2},{s:"msg",t:7}],11110:[{s:"id",t:2},{s:"act_list",t:9,f:[{s:"id",t:4},{s:"act_type",t:2},{s:"base_id",t:6},{s:"map_bid",t:6},{s:"x",t:4},{s:"y",t:4},{s:"val",t:6},{s:"name",t:7},{s:"desc",t:7}]}],11111:[{s:"code",t:2},{s:"msg",t:7}],11120:[{s:"id",t:6},{s:"n",t:6}],11121:[{s:"id",t:6},{s:"n",t:6}],11122:[],11123:[],11200:[{s:"id",t:2},{s:"pos_info",t:9,f:[{s:"pos",t:2},{s:"id",t:2}]},{s:"formation_list",t:9,f:[{s:"id",t:2}]},{s:"hallows_id",t:6}],11201:[{s:"flag",t:2},{s:"msg",t:7}],11211:[{s:"type",t:2},{s:"formation_type",t:2},{s:"pos_info",t:9,f:[{s:"pos",t:2},{s:"id",t:6}]},{s:"hallows_id",t:6}],11212:[{s:"code",t:2},{s:"msg",t:7},{s:"type",t:2}],11213:[{s:"info",t:9,f:[{s:"type",t:2},{s:"formation_type",t:2},{s:"pos_info",t:9,f:[{s:"pos",t:2},{s:"id",t:6}]},{s:"hallows_id",t:6}]}],11300:[{s:"star",t:9,f:[{s:"set_id",t:6},{s:"add_attr",t:9,f:[{s:"attr_id",t:6},{s:"attr_val",t:6}]},{s:"set_skill_id",t:6},{s:"power",t:6},{s:"natals",t:9,f:[{s:"id",t:6},{s:"base_id",t:6},{s:"type",t:6},{s:"enchant",t:6},{s:"break_count",t:6},{s:"star_lev",t:6},{s:"score",t:6},{s:"all_score",t:6}]}]},{s:"fetters",t:9,f:[{s:"set_id",t:6},{s:"pos_id",t:6},{s:"partner_id",t:6}]}],11301:[{s:"set_id",t:6},{s:"add_attr",t:9,f:[{s:"attr_id",t:6},{s:"attr_val",t:6}]},{s:"set_skill_id",t:6},{s:"power",t:6},{s:"natals",t:9,f:[{s:"id",t:6},{s:"base_id",t:6},{s:"type",t:6},{s:"enchant",t:6},{s:"break_count",t:6},{s:"star_lev",t:6},{s:"score",t:6},{s:"all_score",t:6}]}],11302:[{s:"result",t:2},{s:"msg",t:7},{s:"old_set_id",t:6},{s:"fetter",t:9,f:[{s:"set_id",t:6},{s:"pos_id",t:6},{s:"partner_id",t:6}]}],11303:[{s:"result",t:2},{s:"msg",t:7},{s:"old_set_id",t:6},{s:"fetter",t:9,f:[{s:"set_id",t:6},{s:"pos_id",t:6},{s:"partner_id",t:6}]}],11304:[{s:"result",t:2},{s:"msg",t:7}],11305:[{s:"result",t:2},{s:"msg",t:7}],11306:[{s:"result",t:2},{s:"msg",t:7},{s:"id",t:6}],11307:[{s:"result",t:2},{s:"msg",t:7},{s:"fetter",t:9,f:[{s:"set_id",t:6},{s:"pos_id",t:6},{s:"partner_id",t:6}]}],11308:[{s:"star",t:9,f:[{s:"set_id",t:6},{s:"add_attr",t:9,f:[{s:"attr_id",t:6},{s:"attr_val",t:6}]},{s:"set_skill_id",t:6},{s:"power",t:6},{s:"natals",t:9,f:[{s:"id",t:6},{s:"base_id",t:6},{s:"type",t:6},{s:"enchant",t:6},{s:"break_count",t:6},{s:"star_lev",t:6},{s:"score",t:6},{s:"all_score",t:6}]}]},{s:"fetters",t:9,f:[{s:"set_id",t:6},{s:"pos_id",t:6},{s:"partner_id",t:6}]}],11310:[{s:"result",t:2},{s:"msg",t:7},{s:"set_id",t:6},{s:"id",t:6},{s:"lev",t:6}],11311:[{s:"result",t:2},{s:"msg",t:7},{s:"set_id",t:6},{s:"id",t:6}],11320:[{s:"result",t:2},{s:"msg",t:7},{s:"max_tower",t:6},{s:"count",t:6},{s:"buy_count",t:6},{s:"award_list",t:9,f:[{s:"id",t:6},{s:"status",t:2}]}],11321:[{s:"result",t:2},{s:"msg",t:7},{s:"count",t:6},{s:"buy_count",t:6}],11322:[{s:"result",t:2},{s:"msg",t:7}],11323:[{s:"result",t:2},{s:"max_tower",t:6},{s:"tower",t:6},{s:"timer",t:6},{s:"count",t:6},{s:"first_award",t:9,f:[{s:"item_id",t:6},{s:"num",t:6}]},{s:"award",t:9,f:[{s:"item_id",t:6},{s:"num",t:6}]},{s:"target_role_name",t:7},{s:"hurt_statistics",t:9,f:[{s:"type",t:2},{s:"partner_hurts",t:9,f:[{s:"rid",t:6},{s:"srvid",t:7},{s:"id",t:6},{s:"bid",t:6},{s:"star",t:6},{s:"lev",t:6},{s:"camp_type",t:6},{s:"dps",t:6},{s:"cure",t:6}]}]}],11324:[{s:"result",t:2},{s:"msg",t:7},{s:"count",t:6},{s:"buy_count",t:6}],11325:[{s:"tower_replay_data",t:9,f:[{s:"type",t:2},{s:"rid",t:6},{s:"sid",t:7},{s:"name",t:7},{s:"face_id",t:6},{s:"power",t:6},{s:"time",t:6},{s:"replay_id",t:6}]},{s:"m_replay_id",t:6},{s:"my_time",t:6}],11326:[{s:"tower",t:6}],11327:[{s:"rank_lists",t:9,f:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"name",t:7},{s:"rank",t:6},{s:"tower",t:6}]}],11328:[{s:"result",t:2},{s:"msg",t:7}],11329:[{s:"award_list",t:9,f:[{s:"id",t:6},{s:"status",t:2}]}],11330:[{s:"quality",t:6},{s:"luck",t:6},{s:"end_count",t:6},{s:"ref_count",t:6},{s:"day_gold_count",t:6},{s:"flag",t:2}],11331:[{s:"result",t:2},{s:"msg",t:7},{s:"end_count",t:6},{s:"quality",t:6},{s:"day_gold_count",t:6},{s:"flag",t:2},{s:"award",t:9,f:[{s:"item_id",t:6},{s:"num",t:6}]},{s:"award2",t:9,f:[{s:"item_id",t:6},{s:"num",t:6}]}],11332:[{s:"result",t:2},{s:"msg",t:7},{s:"luck",t:6},{s:"ref_count",t:6}],11333:[{s:"result",t:2},{s:"msg",t:7}],12700:[{s:"say_frame_bid",t:6},{s:"say_frame",t:9,f:[{s:"base_id",t:6},{s:"expire_time",t:6}]}],12701:[{s:"base_id",t:6}],12702:[{s:"say_frame",t:9,f:[{s:"base_id",t:6},{s:"expire_time",t:6}]}],12703:[{s:"say_frame",t:9,f:[{s:"base_id",t:6},{s:"expire_time",t:6}]}],12720:[{s:"code",t:2},{s:"msg",t:7}],12721:[{s:"flag",t:2},{s:"rid",t:6},{s:"srv_id",t:7},{s:"name",t:7},{s:"lev",t:2},{s:"career",t:4},{s:"face_id",t:4},{s:"len",t:2},{s:"msg",t:7},{s:"sex",t:2},{s:"vip_lev",t:2},{s:"capacity",t:2},{s:"head_bid",t:6},{s:"bubble_bid",t:6},{s:"tick",t:6}],12722:[{s:"offline_list",t:9,f:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"name",t:7},{s:"lev",t:2},{s:"career",t:4},{s:"face_id",t:4},{s:"sex",t:2},{s:"vip_lev",t:2},{s:"capacity",t:2},{s:"head_bid",t:6},{s:"chat_bubble",t:6},{s:"msg_list",t:9,f:[{s:"len",t:2},{s:"msg",t:7},{s:"tick",t:6}]}]}],12723:[],12725:[{s:"flag",t:2},{s:"srv_id",t:7},{s:"voice_id",t:6},{s:"msg",t:7}],12726:[{s:"srv_id",t:7},{s:"voice_id",t:6},{s:"time",t:2},{s:"voice",t:8},{s:"type",t:2}],12730:[],12731:[],12732:[{s:"code",t:2},{s:"msg",t:7}],12733:[{s:"type",t:6},{s:"list",t:9,f:[{s:"id",t:6},{s:"rid",t:6},{s:"srv_id",t:7},{s:"name",t:7},{s:"msg",t:7},{s:"time",t:6}]}],12741:[{s:"msg",t:7}],12742:[{s:"asset_list",t:9,f:[{s:"bid",t:6},{s:"is_bind",t:2},{s:"num",t:6},{s:"id",t:6},{s:"move_to",t:2}]},{s:"source",t:6}],12743:[{s:"msg",t:7}],12744:[{s:"type",t:2},{s:"msg",t:7}],12745:[{s:"bid",t:6},{s:"need_num",t:6},{s:"num",t:6}],12761:[{s:"role_list",t:9,f:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"name",t:7},{s:"face_id",t:4},{s:"lev",t:2},{s:"sex",t:2},{s:"career",t:4},{s:"vip_lev",t:2},{s:"is_show_vip",t:2},{s:"province",t:7},{s:"city",t:7},{s:"capacity",t:2},{s:"head_bid",t:6},{s:"bubble_bid",t:6},{s:"ext_list",t:9,f:[{s:"type",t:2},{s:"val",t:6}]},{s:"gid",t:6},{s:"gsrv_id",t:7},{s:"g_name",t:7}]},{s:"channel",t:4},{s:"len",t:2},{s:"msg",t:7},{s:"tick",t:6}],12762:[{s:"code",t:2},{s:"msg",t:7}],12763:[{s:"channel",t:4},{s:"id",t:7},{s:"msg",t:7}],12764:[],12766:[{s:"channel",t:4},{s:"msg_list",t:9,f:[{s:"role_list",t:9,f:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"name",t:7},{s:"face_id",t:4},{s:"lev",t:2},{s:"sex",t:2},{s:"career",t:4},{s:"vip_lev",t:2},{s:"is_show_vip",t:2},{s:"province",t:7},{s:"city",t:7},{s:"capacity",t:2},{s:"head_bid",t:6},{s:"chat_bubble",t:6},{s:"ext_list",t:9,f:[{s:"type",t:2},{s:"val",t:6}]},{s:"gid",t:6},{s:"gsrv_id",t:7},{s:"g_name",t:7}]},{s:"channel",t:4},{s:"len",t:2},{s:"msg",t:7},{s:"tick",t:6}]}],12767:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"name",t:7},{s:"channel",t:4},{s:"msg",t:7}],12768:[],12770:[{s:"code",t:2},{s:"msg",t:7}],12771:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"history",t:9,f:[{s:"id",t:2},{s:"channel",t:4},{s:"msg",t:7}]}],12799:[{s:"msg",t:7}],12900:[{s:"is_cluster",t:2},{s:"type",t:4},{s:"start",t:2},{s:"num",t:2},{s:"len",t:2},{s:"time",t:6},{s:"my_idx",t:4},{s:"lev",t:2},{s:"face_id",t:4},{s:"avatar_bid",t:4},{s:"name",t:7},{s:"my_val1",t:6},{s:"my_val2",t:6},{s:"my_val3",t:6},{s:"rank_list",t:9,f:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"name",t:7},{s:"guild_name",t:7},{s:"lev",t:2},{s:"face_id",t:6},{s:"avatar_bid",t:6},{s:"val1",t:6},{s:"val2",t:6},{s:"val3",t:6},{s:"idx",t:2},{s:"desc",t:7}]}],12901:[{s:"is_cluster",t:2},{s:"type",t:4},{s:"time",t:6}],12902:[{s:"is_cluster",t:2},{s:"rank_list",t:9,f:[{s:"type",t:4},{s:"name",t:7},{s:"rid",t:6},{s:"srv_id",t:7},{s:"guild_name",t:7},{s:"face_id",t:6},{s:"avatar_bid",t:6},{s:"val1",t:6},{s:"val2",t:6},{s:"val3",t:6}]}],12903:[{s:"start",t:2},{s:"num",t:2},{s:"len",t:2},{s:"time",t:6},{s:"my_idx",t:4},{s:"gname",t:7},{s:"leader_name",t:7},{s:"glev",t:2},{s:"power",t:6},{s:"rank_list",t:9,f:[{s:"name",t:7},{s:"lev",t:2},{s:"members_num",t:2},{s:"members_max",t:2},{s:"leader_name",t:7},{s:"power",t:6},{s:"idx",t:2},{s:"leader_rid",t:6},{s:"leader_srvid",t:7},{s:"leader_face",t:6},{s:"leader_lev",t:2},{s:"leader_avatar_bid",t:6}]}],12904:[{s:"start",t:2},{s:"num",t:2},{s:"len",t:2},{s:"time",t:6},{s:"my_idx",t:4},{s:"lev",t:2},{s:"face_id",t:4},{s:"avatar_bid",t:6},{s:"name",t:7},{s:"pid",t:4},{s:"pbid",t:4},{s:"plev",t:2},{s:"pquality",t:2},{s:"pstar",t:2},{s:"power",t:6},{s:"rank_list",t:9,f:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"name",t:7},{s:"lev",t:2},{s:"face_id",t:6},{s:"avatar_bid",t:6},{s:"power",t:6},{s:"idx",t:2},{s:"pid",t:4},{s:"pbid",t:4},{s:"plev",t:2},{s:"pquality",t:2},{s:"pstar",t:2}]}],13000:[{s:"mode",t:2},{s:"chapter_id",t:2},{s:"dun_id",t:6},{s:"status",t:2},{s:"is_first",t:2},{s:"cool_time",t:6},{s:"max_dun_id",t:6},{s:"auto_num",t:2},{s:"auto_num_max",t:2},{s:"mode_list",t:9,f:[{s:"mode",t:2},{s:"chapter_list",t:9,f:[{s:"chapter_id",t:2},{s:"status",t:2},{s:"dun_list",t:9,f:[{s:"dun_id",t:6},{s:"status",t:2},{s:"cool_time",t:6},{s:"auto_num",t:2}]}]}]}],13001:[{s:"mode",t:2},{s:"chapter_id",t:2},{s:"dun_id",t:6},{s:"status",t:2},{s:"is_first",t:2},{s:"cool_time",t:6},{s:"max_dun_id",t:6}],13002:[{s:"code",t:2},{s:"msg",t:7}],13003:[{s:"code",t:2},{s:"msg",t:7}],13004:[{s:"code",t:2},{s:"msg",t:7}],13005:[{s:"code",t:2},{s:"msg",t:7},{s:"dun_id",t:6},{s:"num",t:4},{s:"items",t:9,f:[{s:"bid",t:6},{s:"num",t:6}]}],13006:[{s:"fast_combat_num",t:2},{s:"fast_combat_max",t:2},{s:"auto_num",t:2},{s:"auto_num_max",t:2},{s:"is_auto_combat",t:2},{s:"fast_combat_add_time",t:4},{s:"fast_combat_w_num",t:2},{s:"fast_combat_p_num",t:2},{s:"fast_combat_free_num",t:2},{s:"is_holiday",t:2}],13007:[{s:"type",t:2},{s:"dun_id",t:6},{s:"time",t:6},{s:"old_lev",t:2},{s:"new_lev",t:2},{s:"items",t:9,f:[{s:"bid",t:6},{s:"num",t:6}]},{s:"auto_start_dun_id",t:6},{s:"auto_end_dun_id",t:6},{s:"fast_add_time1",t:6},{s:"fast_add_time2",t:6},{s:"old_exp",t:6},{s:"new_exp",t:6},{s:"vip_buff",t:6},{s:"honor_buff",t:6}],13008:[{s:"list",t:9,f:[{s:"id",t:2}]}],13009:[{s:"code",t:2},{s:"msg",t:7},{s:"id",t:6}],13010:[{s:"dun_id",t:6},{s:"chapter_id",t:2}],13011:[{s:"buff_list",t:9,f:[{s:"bid",t:6},{s:"end_time",t:6}]}],13012:[{s:"chapter_list",t:9,f:[{s:"chapter_id",t:6},{s:"award_list",t:9,f:[{s:"award_id",t:6},{s:"status",t:6}]}]}],13013:[{s:"chapter_list",t:9,f:[{s:"chapter_id",t:6},{s:"award_list",t:9,f:[{s:"award_id",t:6},{s:"status",t:6}]}]}],13014:[{s:"code",t:2},{s:"msg",t:7},{s:"chapter_id",t:6},{s:"award_id",t:6},{s:"status",t:6}],13015:[{s:"dungeon_replay_log",t:9,f:[{s:"rid",t:6},{s:"sid",t:7},{s:"name",t:7},{s:"face_id",t:6},{s:"power",t:6},{s:"time",t:6},{s:"repaly_id",t:6},{s:"type",t:2}]}],13016:[{s:"result",t:2},{s:"item_rewards",t:9,f:[{s:"bid",t:6},{s:"is_bind",t:2},{s:"num",t:6},{s:"id",t:6}]},{s:"combat_type",t:4},{s:"partner_bid",t:6},{s:"partner_hurt",t:6},{s:"partner_total_hurt",t:6},{s:"lev",t:2},{s:"exp",t:6},{s:"new_lev",t:2},{s:"new_exp",t:6},{s:"auto_num",t:4},{s:"target_role_name",t:7},{s:"hurt_statistics",t:9,f:[{s:"type",t:2},{s:"partner_hurts",t:9,f:[{s:"rid",t:6},{s:"srvid",t:7},{s:"id",t:6},{s:"bid",t:6},{s:"star",t:6},{s:"lev",t:6},{s:"camp_type",t:6},{s:"dps",t:6},{s:"cure",t:6},{s:"ext_data",t:9,f:[{s:"key",t:6},{s:"val",t:6}]}]}]},{s:"use_skin",t:6}],13017:[{s:"hook_time",t:6},{s:"list",t:9,f:[{s:"bid",t:6},{s:"num",t:6}]}],13018:[{s:"code",t:2},{s:"msg",t:7}],13019:[],13020:[{s:"val",t:6}],13030:[{s:"list",t:9,f:[{s:"type",t:6},{s:"day_num",t:2}]},{s:"pass_list",t:9,f:[{s:"id",t:6}]}],13031:[{s:"code",t:2},{s:"msg",t:7}],13032:[{s:"code",t:2},{s:"msg",t:7},{s:"id",t:6}],13039:[],13040:[{s:"flag",t:2}],13300:[{s:"present_count",t:4},{s:"draw_count",t:4},{s:"draw_all",t:4},{s:"friend_list",t:9,f:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"name",t:7},{s:"lev",t:2},{s:"sex",t:2},{s:"career",t:2},{s:"face_id",t:4},{s:"power",t:6},{s:"intimacy",t:6},{s:"login_time",t:6},{s:"login_out_time",t:6},{s:"is_online",t:2},{s:"is_cross",t:2},{s:"gid",t:6},{s:"gsrv_id",t:7},{s:"gname",t:7},{s:"main_partner_id",t:6},{s:"partner_bid",t:6},{s:"partner_lev",t:4},{s:"partner_star",t:2},{s:"is_awake",t:2},{s:"is_used",t:2},{s:"is_present",t:2},{s:"is_draw",t:2},{s:"avatar_bid",t:6},{s:"dun_id",t:6}]}],13301:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"login_time",t:6},{s:"is_online",t:2},{s:"login_out_time",t:6}],13302:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"name",t:7},{s:"lev",t:2},{s:"sex",t:2},{s:"career",t:2},{s:"face_id",t:4},{s:"power",t:6},{s:"intimacy",t:6},{s:"login_time",t:6},{s:"login_out_time",t:6},{s:"is_online",t:2},{s:"is_cross",t:2},{s:"gid",t:6},{s:"gsrv_id",t:7},{s:"gname",t:7},{s:"main_partner_id",t:6},{s:"partner_bid",t:6},{s:"partner_lev",t:4},{s:"partner_star",t:2},{s:"is_awake",t:2},{s:"is_used",t:2},{s:"is_present",t:2},{s:"is_draw",t:2},{s:"avatar_bid",t:6},{s:"dun_id",t:6}],13303:[{s:"code",t:2},{s:"msg",t:7}],13304:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"name",t:7},{s:"sex",t:2},{s:"career",t:2},{s:"lev",t:2},{s:"avatar_bid",t:6}],13305:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"code",t:2},{s:"msg",t:7}],13306:[{s:"code",t:2},{s:"msg",t:7}],13307:[{s:"code",t:2},{s:"msg",t:7},{s:"rid",t:6},{s:"srv_id",t:7}],13308:[{s:"rid",t:6},{s:"srv_id",t:7}],13309:[{s:"role_ids",t:9,f:[{s:"rid",t:6},{s:"srv_id",t:7}]}],13310:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"name",t:7},{s:"lev",t:2},{s:"sex",t:2},{s:"career",t:2},{s:"face_id",t:4},{s:"power",t:6},{s:"intimacy",t:6},{s:"login_time",t:6},{s:"login_out_time",t:6},{s:"is_online",t:2},{s:"is_cross",t:2},{s:"gid",t:6},{s:"gsrv_id",t:7},{s:"gname",t:7},{s:"main_partner_id",t:6},{s:"partner_bid",t:6},{s:"partner_lev",t:4},{s:"partner_star",t:2},{s:"is_awake",t:2},{s:"is_used",t:2},{s:"is_present",t:2},{s:"is_draw",t:2},{s:"avatar_bid",t:6},{s:"dun_id",t:6}],13311:[{s:"friend_req_list",t:9,f:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"name",t:7},{s:"sex",t:2},{s:"career",t:2},{s:"lev",t:2},{s:"face_id",t:4},{s:"power",t:6},{s:"avatar_bid",t:6}]}],13312:[{s:"code",t:2},{s:"msg",t:7}],13314:[{s:"role_list",t:9,f:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"name",t:7},{s:"sex",t:2},{s:"career",t:2},{s:"lev",t:2},{s:"power",t:6},{s:"face_id",t:4}]}],13315:[{s:"code",t:2}],13316:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"present_count",t:4},{s:"draw_count",t:4},{s:"code",t:2},{s:"msg",t:7},{s:"type",t:2},{s:"is_present",t:2},{s:"is_draw",t:2}],13317:[{s:"code",t:2},{s:"msg",t:7},{s:"type",t:2},{s:"list",t:9,f:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"is_present",t:2},{s:"is_draw",t:2}]}],13320:[{s:"recommend_list",t:9,f:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"name",t:7},{s:"sex",t:2},{s:"career",t:2},{s:"lev",t:2},{s:"face_id",t:4},{s:"power",t:6}]}],13330:[{s:"black_list",t:9,f:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"name",t:7},{s:"lev",t:2},{s:"sex",t:2},{s:"career",t:2},{s:"face_id",t:4},{s:"power",t:6},{s:"login_out_time",t:6},{s:"is_online",t:2},{s:"gid",t:6},{s:"gsrv_id",t:7},{s:"gname",t:7}]}],13331:[{s:"type",t:2},{s:"black_list",t:9,f:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"name",t:7},{s:"lev",t:2},{s:"sex",t:2},{s:"career",t:2},{s:"face_id",t:4},{s:"power",t:6},{s:"login_time",t:6},{s:"is_online",t:2},{s:"gid",t:6},{s:"gsrv_id",t:7},{s:"gname",t:7}]}],13332:[{s:"code",t:2},{s:"msg",t:7},{s:"rid",t:6},{s:"srv_id",t:7}],13333:[{s:"code",t:2},{s:"msg",t:7},{s:"rid",t:6},{s:"srv_id",t:7}],13334:[{s:"role_ids",t:9,f:[{s:"rid",t:6},{s:"srv_id",t:7}]}],13401:[{s:"code",t:2},{s:"msg",t:7},{s:"type",t:2},{s:"is_half",t:2},{s:"item_list",t:9,f:[{s:"item_id",t:6},{s:"ext",t:9,f:[{s:"key",t:2},{s:"val",t:6}]}]}],13402:[{s:"code",t:2},{s:"type",t:2},{s:"eid",t:6},{s:"is_half",t:2},{s:"ext",t:9,f:[{s:"key",t:2},{s:"val",t:6}]},{s:"msg",t:7}],13403:[{s:"type",t:6},{s:"code",t:2},{s:"msg",t:7},{s:"count",t:6},{s:"free_count",t:6},{s:"num",t:6},{s:"refresh_time",t:6},{s:"item_list",t:9,f:[{s:"item_id",t:6},{s:"item_num",t:6},{s:"order",t:6},{s:"price",t:6},{s:"type",t:2},{s:"pay_type",t:6},{s:"has_buy",t:6},{s:"limit_count",t:6},{s:"discount_type",t:6},{s:"discount",t:6},{s:"main_attr",t:9,f:[{s:"attr_type",t:2},{s:"val",t:6}]},{s:"pay_type2",t:6},{s:"price2",t:6},{s:"score",t:6}]}],13404:[],13405:[{s:"type",t:6},{s:"code",t:2},{s:"msg",t:7},{s:"count",t:6},{s:"free_count",t:6},{s:"num",t:6},{s:"refresh_time",t:6},{s:"item_list",t:9,f:[{s:"item_id",t:6},{s:"item_num",t:6},{s:"order",t:6},{s:"price",t:6},{s:"type",t:2},{s:"pay_type",t:6},{s:"has_buy",t:6},{s:"limit_count",t:6},{s:"discount_type",t:6},{s:"discount",t:6},{s:"main_attr",t:9,f:[{s:"attr_type",t:2},{s:"val",t:6}]},{s:"pay_type2",t:6},{s:"price2",t:6},{s:"score",t:6}]}],13407:[{s:"code",t:2},{s:"msg",t:7},{s:"order",t:6}],13408:[{s:"code",t:2}],13409:[{s:"code",t:2},{s:"msg",t:7},{s:"count",t:6},{s:"item_list",t:9,f:[{s:"pos",t:6},{s:"item_id",t:6},{s:"item_num",t:6},{s:"price",t:6},{s:"status",t:6}]}],13410:[{s:"code",t:2},{s:"msg",t:7},{s:"item_list",t:9,f:[{s:"pos",t:6},{s:"item_id",t:6},{s:"item_num",t:6},{s:"price",t:6},{s:"status",t:6}]}],13411:[{s:"code",t:2},{s:"msg",t:7},{s:"count",t:6},{s:"item_list",t:9,f:[{s:"pos",t:6},{s:"item_id",t:6},{s:"item_num",t:6},{s:"price",t:6},{s:"status",t:6}]}],13412:[{s:"code",t:2},{s:"msg",t:7},{s:"type",t:6},{s:"day",t:6},{s:"item_list",t:9,f:[{s:"item_id",t:6},{s:"status",t:6}]}],13413:[{s:"code",t:2},{s:"msg",t:7},{s:"type",t:6},{s:"day",t:6},{s:"item_list",t:9,f:[{s:"item_id",t:6},{s:"status",t:6}]}],13414:[{s:"code",t:2}],13415:[{s:"type",t:6},{s:"count",t:4},{s:"max_count",t:4},{s:"free_count",t:2},{s:"max_free_count",t:2},{s:"item_list",t:9,f:[{s:"order",t:2},{s:"item_id",t:6},{s:"item_num",t:6},{s:"price",t:6},{s:"type",t:2},{s:"pay_type",t:2},{s:"buycount",t:6},{s:"discount_type",t:6},{s:"discount",t:6}]}],13416:[{s:"code",t:2},{s:"msg",t:7},{s:"order",t:6}],13417:[{s:"code",t:2},{s:"msg",t:7}],13418:[],13419:[{s:"code",t:2},{s:"msg",t:7}],13420:[{s:"type",t:6},{s:"count",t:6},{s:"free_count",t:6},{s:"refresh_time",t:6}],13500:[{s:"code",t:2},{s:"msg",t:7}],13501:[{s:"page",t:4},{s:"flag",t:2},{s:"num",t:4},{s:"page_total",t:4},{s:"all_count",t:4},{s:"name",t:7},{s:"guilds",t:9,f:[{s:"gid",t:6},{s:"gsrv_id",t:7},{s:"name",t:7},{s:"lev",t:2},{s:"members_num",t:2},{s:"members_max",t:2},{s:"leader_name",t:7},{s:"apply_type",t:2},{s:"apply_lev",t:2},{s:"is_apply",t:2}]}],13503:[{s:"code",t:2},{s:"msg",t:7},{s:"gid",t:6},{s:"gsrv_id",t:7},{s:"is_apply",t:2}],13505:[{s:"type",t:2},{s:"rid",t:6},{s:"srv_id",t:7},{s:"code",t:2},{s:"msg",t:7}],13507:[{s:"page",t:2},{s:"page_total",t:2},{s:"num",t:2},{s:"guids",t:9,f:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"name",t:7},{s:"lev",t:2},{s:"face",t:6},{s:"power",t:6},{s:"vip_lev",t:2},{s:"is_online",t:2}]}],13513:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"code",t:2},{s:"msg",t:7}],13514:[{s:"code",t:2},{s:"msg",t:7}],13516:[{s:"code",t:2},{s:"msg",t:7}],13518:[{s:"gid",t:6},{s:"gsrv_id",t:7},{s:"name",t:7},{s:"lev",t:2},{s:"members_num",t:2},{s:"members_max",t:2},{s:"leader_name",t:7},{s:"rid",t:6},{s:"srv_id",t:7},{s:"sign",t:7},{s:"exp",t:6},{s:"day_exp",t:6},{s:"apply_type",t:2},{s:"apply_lev",t:2},{s:"recruit_num",t:2},{s:"rank_idx",t:3}],13519:[{s:"members",t:9,f:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"name",t:7},{s:"lev",t:2},{s:"face",t:6},{s:"post",t:2},{s:"online",t:2},{s:"vip_lev",t:2},{s:"power",t:6},{s:"join_time",t:6},{s:"login_time",t:6},{s:"donate",t:6},{s:"day_donate",t:6},{s:"avatar_bid",t:6},{s:"sex",t:2},{s:"active_lev",t:2}]}],13520:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"position",t:2},{s:"code",t:2},{s:"msg",t:7}],13521:[{s:"code",t:2},{s:"msg",t:7}],13522:[{s:"code",t:2},{s:"msg",t:7}],13523:[{s:"donate_list",t:9,f:[{s:"type",t:2},{s:"num",t:2}]},{s:"boxes",t:9,f:[{s:"box_id",t:2}]},{s:"donate_exp",t:6},{s:"day_send_num",t:2},{s:"day_recv_num",t:2}],13524:[{s:"code",t:2},{s:"msg",t:7}],13534:[{s:"type",t:2},{s:"list",t:9,f:[{s:"id",t:6},{s:"type",t:2},{s:"name",t:7},{s:"post",t:6},{s:"num",t:2},{s:"max_num",t:2},{s:"max_val",t:6},{s:"time",t:6},{s:"flag",t:2},{s:"msg_id",t:2}]}],13535:[{s:"code",t:2},{s:"msg",t:7},{s:"day_send_num",t:2}],13536:[{s:"code",t:2},{s:"msg",t:7},{s:"id",t:6},{s:"type",t:2},{s:"val",t:6},{s:"day_recv_num",t:2}],13540:[{s:"id",t:6},{s:"type",t:2},{s:"name",t:7},{s:"face_id",t:6},{s:"avatar_bid",t:6},{s:"post",t:6},{s:"val",t:6},{s:"list",t:9,f:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"name",t:7},{s:"face_id",t:6},{s:"avatar_bid",t:6},{s:"post",t:6},{s:"val",t:6},{s:"time",t:6}]}],13541:[{s:"code",t:2},{s:"msg",t:7}],13542:[{s:"type",t:2},{s:"members",t:9,f:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"name",t:7},{s:"lev",t:2},{s:"face",t:6},{s:"post",t:2},{s:"online",t:2},{s:"vip_lev",t:2},{s:"power",t:6},{s:"join_time",t:6},{s:"login_time",t:6},{s:"donate",t:6},{s:"day_donate",t:6},{s:"avatar_bid",t:6},{s:"sex",t:2},{s:"active_lev",t:2}]}],13545:[{s:"list",t:9,f:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"name",t:7},{s:"face_id",t:6},{s:"avatar_bid",t:6},{s:"price",t:6},{s:"num",t:6}]}],13546:[{s:"list",t:9,f:[{s:"id",t:6},{s:"num",t:6}]}],13558:[{s:"code",t:2},{s:"msg",t:7}],13565:[{s:"code",t:2},{s:"msg",t:7}],13568:[{s:"code",t:2},{s:"msg",t:7}],13573:[{s:"code",t:2}],13574:[{s:"code",t:2},{s:"msg",t:7},{s:"box_id",t:2}],13575:[{s:"donate_exp",t:6}],13576:[{s:"code",t:2},{s:"msg",t:7}],13601:[{s:"flag",t:2},{s:"msg",t:7},{s:"period",t:2},{s:"charge",t:6},{s:"cur_day",t:6},{s:"num",t:6},{s:"end_time",t:6},{s:"welfare_list",t:9,f:[{s:"day",t:6},{s:"goal_id",t:6},{s:"status",t:2},{s:"target_val",t:6},{s:"value",t:6}]},{s:"grow_list",t:9,f:[{s:"day",t:6},{s:"goal_id",t:6},{s:"condition",t:6},{s:"lev",t:6},{s:"status",t:2},{s:"target_type",t:2},{s:"progress",t:9,f:[{s:"id",t:4},{s:"finish",t:2},{s:"target",t:6},{s:"target_val",t:6},{s:"value",t:6}]}]},{s:"price_list",t:9,f:[{s:"day",t:6},{s:"status",t:2}]},{s:"finish_list",t:9,f:[{s:"goal_id",t:6},{s:"status",t:2}]}],13602:[{s:"flag",t:2},{s:"msg",t:7},{s:"type",t:2},{s:"day_type",t:6},{s:"id",t:6},{s:"item",t:6},{s:"status",t:2},{s:"num",t:6}],13603:[{s:"grow_list",t:9,f:[{s:"day",t:6},{s:"goal_id",t:6},{s:"condition",t:6},{s:"lev",t:6},{s:"status",t:2},{s:"target_type",t:2},{s:"progress",t:9,f:[{s:"id",t:4},{s:"finish",t:2},{s:"target",t:6},{s:"target_val",t:6},{s:"value",t:6}]}]}],13604:[{s:"period",t:2},{s:"cur_day",t:6},{s:"end_time",t:6},{s:"lev",t:6},{s:"list",t:9,f:[{s:"id",t:6},{s:"finish",t:2},{s:"target_val",t:6},{s:"value",t:6}]}],13605:[{s:"lev",t:6},{s:"list",t:9,f:[{s:"id",t:6},{s:"finish",t:2},{s:"target_val",t:6},{s:"value",t:6}]}],13606:[{s:"code",t:2},{s:"msg",t:7}],13607:[{s:"lev",t:6},{s:"reward_list",t:9,f:[{s:"id",t:4}]}],13608:[{s:"flag",t:2},{s:"msg",t:7}],14100:[{s:"day",t:2},{s:"status",t:2}],14101:[{s:"code",t:2},{s:"msg",t:7},{s:"day",t:2},{s:"status",t:2}],14102:[{s:"attr_list",t:9,f:[{s:"id",t:6},{s:"status",t:2}]}],14103:[{s:"code",t:2},{s:"msg",t:7},{s:"id",t:6},{s:"status",t:2}],14104:[],16400:[{s:"feat_list",t:9,f:[{s:"id",t:6},{s:"finish",t:2},{s:"end_time",t:6},{s:"finish_time",t:6},{s:"progress",t:9,f:[{s:"id",t:4},{s:"finish",t:2},{s:"target",t:6},{s:"target_val",t:6},{s:"value",t:6}]}]}],16401:[{s:"feat_list",t:9,f:[{s:"id",t:6},{s:"finish",t:2},{s:"end_time",t:6},{s:"finish_time",t:6},{s:"progress",t:9,f:[{s:"id",t:4},{s:"finish",t:2},{s:"target",t:6},{s:"target_val",t:6},{s:"value",t:6}]}]}],16402:[{s:"code",t:2},{s:"msg",t:7},{s:"id",t:6}],16601:[{s:"holiday_list",t:9,f:[{s:"camp_id",t:6},{s:"bid",t:6},{s:"title",t:7},{s:"title2",t:7},{s:"ico",t:7},{s:"type_ico",t:2},{s:"top_banner",t:7},{s:"rule_str",t:7},{s:"time_str",t:7},{s:"bottom_alert",t:7},{s:"aim_title",t:7},{s:"panel_type",t:2},{s:"channel_ban",t:7},{s:"sort_val",t:2},{s:"reward_title",t:7},{s:"remain_sec",t:6},{s:"cli_type",t:6},{s:"cli_type_name",t:7}]}],16602:[{s:"holiday_list",t:9,f:[{s:"bid",t:6},{s:"can_get_num",t:2}]}],16603:[{s:"bid",t:6},{s:"cli_type",t:6},{s:"remain_sec",t:6},{s:"finish",t:6},{s:"aim_list",t:9,f:[{s:"aim",t:6},{s:"aim_str",t:7},{s:"status",t:2},{s:"item_list",t:9,f:[{s:"bid",t:6},{s:"num",t:6}]},{s:"aim_args",t:9,f:[{s:"aim_args_key",t:2},{s:"aim_args_val",t:6},{s:"aim_args_str",t:7}]}]},{s:"item_effect_list",t:9,f:[{s:"bid",t:6},{s:"effect_1",t:2},{s:"effect_2",t:2}]},{s:"args",t:9,f:[{s:"args_key",t:2},{s:"args_val",t:6},{s:"args_str",t:7}]},{s:"client_reward",t:7},{s:"rank_list",t:9,f:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"name",t:7},{s:"sex",t:2},{s:"career",t:2},{s:"lev",t:2},{s:"val",t:6},{s:"rank_args",t:9,f:[{s:"rank_args_key",t:2},{s:"rank_args_val",t:6}]}]}],16604:[{s:"code",t:2},{s:"msg",t:7}],16605:[{s:"status",t:9,f:[{s:"bid",t:6},{s:"code",t:2},{s:"end_time",t:6}]}],16606:[{s:"bid",t:6},{s:"can_get_num",t:2}],16607:[{s:"type",t:2}],16610:[{s:"bid",t:6},{s:"aim",t:6},{s:"item_bid",t:6}],16620:[{s:"holiday_list",t:9,f:[{s:"bid",t:6},{s:"cli_type",t:6},{s:"remain_sec",t:6},{s:"finish",t:6},{s:"aim_list",t:9,f:[{s:"aim",t:6},{s:"aim_str",t:7},{s:"status",t:2},{s:"item_list",t:9,f:[{s:"bid",t:6},{s:"num",t:6}]},{s:"aim_args",t:9,f:[{s:"aim_args_key",t:2},{s:"aim_args_val",t:6},{s:"aim_args_str",t:7}]}]},{s:"item_effect_list",t:9,f:[{s:"bid",t:6},{s:"effect_1",t:2},{s:"effect_2",t:2}]},{s:"args",t:9,f:[{s:"args_key",t:2},{s:"args_val",t:6},{s:"args_str",t:7}]},{s:"client_reward",t:7},{s:"rank_list",t:9,f:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"name",t:7},{s:"sex",t:2},{s:"career",t:2},{s:"lev",t:2},{s:"val",t:6},{s:"rank_args",t:9,f:[{s:"rank_args_key",t:2},{s:"rank_args_val",t:6}]}]}]}],16630:[{s:"code",t:2},{s:"items",t:9,f:[{s:"bid",t:6},{s:"num",t:6}]}],16631:[{s:"code",t:2},{s:"msg",t:7}],16633:[{s:"code",t:2},{s:"items",t:9,f:[{s:"bid",t:6},{s:"num",t:6}]}],16634:[],16635:[{s:"code",t:2},{s:"items",t:9,f:[{s:"bid",t:6},{s:"num",t:6}]}],16636:[{s:"code",t:2},{s:"msg",t:7}],16637:[{s:"dial_data",t:9,f:[{s:"type",t:6},{s:"count",t:6},{s:"lucky",t:6},{s:"frist_type",t:6},{s:"lucky_award",t:9,f:[{s:"lucky",t:6}]},{s:"end_time",t:6},{s:"rand_lists",t:9,f:[{s:"pos",t:2},{s:"id",t:6},{s:"status",t:2}]},{s:"log_list",t:9,f:[{s:"role_name",t:7},{s:"bid",t:6},{s:"num",t:6}]}]}],16638:[{s:"code",t:2},{s:"msg",t:7},{s:"frist_awards",t:9,f:[{s:"bid",t:6},{s:"num",t:6}]},{s:"awards1",t:9,f:[{s:"bid",t:6},{s:"num",t:6}]},{s:"awards2",t:9,f:[{s:"bid",t:6},{s:"num",t:6}]},{s:"awards3",t:9,f:[{s:"pos",t:2}]}],16639:[{s:"type",t:6},{s:"count",t:6},{s:"lucky",t:6},{s:"frist_type",t:6},{s:"lucky_award",t:9,f:[{s:"lucky",t:6}]},{s:"end_time",t:6},{s:"rand_lists",t:9,f:[{s:"pos",t:2},{s:"id",t:6},{s:"status",t:2}]}],16640:[{s:"code",t:2},{s:"msg",t:7},{s:"type",t:6}],16641:[{s:"type",t:6},{s:"log_list",t:9,f:[{s:"role_name",t:7},{s:"bid",t:6},{s:"num",t:6}]}],16642:[{s:"code",t:2},{s:"msg",t:7},{s:"type",t:6}],16643:[{s:"code",t:2},{s:"msg",t:7},{s:"frist_awards",t:9,f:[{s:"bid",t:6},{s:"num",t:6}]},{s:"awards1",t:9,f:[{s:"bid",t:6},{s:"num",t:6}]},{s:"awards2",t:9,f:[{s:"bid",t:6},{s:"num",t:6}]},{s:"awards3",t:9,f:[{s:"pos",t:2}]}],16650:[{s:"rank",t:6},{s:"rank_award",t:9,f:[{s:"rank1",t:6},{s:"rank2",t:6},{s:"award",t:9,f:[{s:"bid",t:6},{s:"num",t:6}]}]}],16660:[{s:"holiday_exchanges",t:9,f:[{s:"bid",t:6},{s:"end_time",t:6},{s:"exchange_name",t:7},{s:"need_id",t:6},{s:"exchange_list",t:9,f:[{s:"aim",t:6},{s:"aim_str",t:7},{s:"buy_count",t:6},{s:"limit_buy",t:6},{s:"lable",t:6},{s:"expend_id",t:6},{s:"expend_num",t:6},{s:"item_list",t:9,f:[{s:"bid",t:6},{s:"num",t:6}]},{s:"aim_args",t:9,f:[{s:"aim_args_key",t:2},{s:"aim_args_val",t:6},{s:"aim_args_str",t:7}]}]}]}],16661:[{s:"code",t:2},{s:"msg",t:7},{s:"bid",t:6},{s:"aim",t:6},{s:"buy_count",t:6}],16665:[{s:"code",t:2},{s:"msg",t:7}],16666:[],16670:[{s:"num",t:6},{s:"gold",t:6},{s:"is_free",t:2},{s:"holiday_lev",t:6},{s:"award_list",t:9,f:[{s:"id",t:6},{s:"status",t:6}]}],16671:[{s:"result",t:2},{s:"msg",t:7},{s:"id",t:2},{s:"flag",t:2}],16672:[{s:"count",t:2},{s:"awards2",t:9,f:[{s:"bid",t:6},{s:"num",t:6}]}],16673:[{s:"result",t:2},{s:"msg",t:7}],16674:[{s:"type",t:2},{s:"log_list",t:9,f:[{s:"role_name",t:7},{s:"bid",t:6},{s:"num",t:6}]}],16675:[{s:"result",t:2},{s:"msg",t:7}],16676:[{s:"gold",t:6}],16680:[{s:"lucky",t:6},{s:"free_num",t:2},{s:"endtime",t:6},{s:"egg_status",t:9,f:[{s:"pos",t:2},{s:"type",t:2},{s:"status",t:2},{s:"show_reward",t:9,f:[{s:"item_id",t:6},{s:"num",t:6}]}]}],16681:[{s:"code",t:2},{s:"msg",t:7}],16682:[{s:"code",t:2},{s:"msg",t:7}],16683:[{s:"code",t:2},{s:"msg",t:7}],16684:[{s:"code",t:2},{s:"msg",t:7}],16685:[{s:"type",t:2},{s:"log_list",t:9,f:[{s:"role_name",t:7},{s:"bid",t:6},{s:"num",t:6}]}],16686:[{s:"code",t:2},{s:"msg",t:7}],16687:[{s:"bid",t:6},{s:"code",t:2}],16688:[{s:"buy_info",t:9,f:[{s:"id",t:2},{s:"day_num",t:6},{s:"all_num",t:6},{s:"s_day_num",t:6},{s:"s_all_num",t:6}]}],16689:[{s:"code",t:2},{s:"msg",t:7},{s:"id",t:6},{s:"num",t:6}],16691:[{s:"code",t:2},{s:"items",t:9,f:[{s:"bid",t:6},{s:"num",t:6}]}],16692:[{s:"code",t:2},{s:"msg",t:7}],16693:[{s:"code",t:2},{s:"items",t:9,f:[{s:"bid",t:6},{s:"num",t:6}]}],16694:[{s:"code",t:2},{s:"msg",t:7}],16695:[{s:"code",t:2},{s:"items",t:9,f:[{s:"bid",t:6},{s:"num",t:6}]}],16696:[{s:"code",t:2},{s:"msg",t:7}],16697:[{s:"code",t:2},{s:"items",t:9,f:[{s:"bid",t:6},{s:"num",t:6}]}],16698:[{s:"code",t:2},{s:"msg",t:7}],16700:[{s:"list",t:9,f:[{s:"id",t:2},{s:"name",t:7},{s:"need_rmb",t:6},{s:"get_gold",t:6},{s:"add_gold",t:6},{s:"is_first",t:2},{s:"pic",t:2}]}],16705:[{s:"card1_is_reward",t:2},{s:"card1_end_time",t:6},{s:"card1_days",t:4},{s:"card1_acc",t:4},{s:"card2_is_reward",t:2},{s:"card2_end_time",t:6},{s:"card2_days",t:4},{s:"card2_acc",t:4}],16706:[{s:"code",t:2},{s:"msg",t:7},{s:"card_type",t:2}],16707:[{s:"status",t:2}],16708:[{s:"code",t:2},{s:"msg",t:7}],16710:[{s:"list",t:9,f:[{s:"lev",t:2}]}],16711:[{s:"code",t:2},{s:"msg",t:7}],16712:[{s:"charge_sum",t:6},{s:"list",t:9,f:[{s:"id",t:6},{s:"status",t:2}]}],16713:[{s:"code",t:2},{s:"msg",t:7},{s:"list",t:9,f:[{s:"id",t:6},{s:"status",t:2}]}],16730:[{s:"time",t:6},{s:"state",t:2}],16731:[{s:"code",t:2},{s:"msg",t:7}],16800:[{s:"type",t:2},{s:"arg_uint32",t:9,f:[{s:"key",t:2},{s:"value",t:6}]},{s:"arg_str",t:9,f:[{s:"key",t:2},{s:"value",t:7}]},{s:"idx",t:6}],16801:[{s:"buff_list",t:9,f:[{s:"bid",t:6},{s:"remain_seconds",t:6}]}],16802:[{s:"bid",t:6}],16900:[{s:"lev",t:2},{s:"exp",t:6},{s:"day_exp",t:6},{s:"week_exp",t:6}],16901:[{s:"list",t:9,f:[{s:"id",t:6},{s:"finish",t:2},{s:"target_val",t:6},{s:"value",t:6}]}],16902:[{s:"list",t:9,f:[{s:"id",t:6},{s:"finish",t:2},{s:"target_val",t:6},{s:"value",t:6}]}],16903:[{s:"code",t:2},{s:"msg",t:7}],16904:[{s:"code",t:2},{s:"msg",t:7}],19800:[{s:"code",t:6}],19801:[{s:"code",t:2},{s:"msg",t:7}],19802:[{s:"list",t:9,f:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"name",t:7},{s:"lev",t:2},{s:"vip",t:2},{s:"sex",t:2},{s:"online",t:2},{s:"power",t:6},{s:"face_id",t:6},{s:"avatar_bid",t:6}]}],19803:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"name",t:7},{s:"lev",t:2},{s:"vip",t:2},{s:"sex",t:2},{s:"online",t:2},{s:"power",t:6},{s:"face_id",t:6},{s:"avatar_bid",t:6}],19804:[{s:"list",t:9,f:[{s:"id",t:2},{s:"num",t:2},{s:"had",t:2}]}],19805:[{s:"code",t:2},{s:"msg",t:7},{s:"id",t:2},{s:"num",t:2},{s:"had",t:2}],19806:[{s:"status",t:2}],19807:[{s:"code",t:6},{s:"rid",t:6},{s:"srv_id",t:7},{s:"name",t:7},{s:"lev",t:2},{s:"vip",t:2},{s:"online",t:2},{s:"power",t:6},{s:"face_id",t:6},{s:"avatar_bid",t:6}],19901:[{s:"type",t:2},{s:"replay_list",t:9,f:[{s:"name",t:7},{s:"flag",t:1},{s:"is_collect",t:1},{s:"id",t:6},{s:"combat_type",t:2},{s:"round",t:2},{s:"sec_type",t:6},{s:"a_rid",t:6},{s:"a_srv_id",t:7},{s:"a_name",t:7},{s:"a_lev",t:4},{s:"a_face",t:6},{s:"a_power",t:6},{s:"a_rank",t:2},{s:"a_formation_type",t:2},{s:"a_camp_type",t:2},{s:"b_rid",t:6},{s:"b_srv_id",t:7},{s:"b_name",t:7},{s:"b_lev",t:4},{s:"b_face",t:6},{s:"b_power",t:6},{s:"b_rank",t:2},{s:"b_formation_type",t:2},{s:"b_camp_type",t:2},{s:"ret",t:2},{s:"like",t:6},{s:"share",t:6},{s:"play",t:6},{s:"time",t:6},{s:"a_plist",t:9,f:[{s:"id",t:6},{s:"pos",t:2},{s:"bid",t:6},{s:"lev",t:4},{s:"star",t:2},{s:"break_lev",t:2},{s:"power",t:6},{s:"hp",t:6},{s:"hp_max",t:6},{s:"dps",t:6},{s:"behurt",t:6},{s:"cure",t:6}]},{s:"b_plist",t:9,f:[{s:"id",t:6},{s:"pos",t:2},{s:"bid",t:6},{s:"lev",t:4},{s:"star",t:2},{s:"break_lev",t:2},{s:"power",t:6},{s:"hp",t:6},{s:"hp_max",t:6},{s:"dps",t:6},{s:"behurt",t:6},{s:"cure",t:6}]}]}],19902:[{s:"type",t:2},{s:"cond_type",t:6},{s:"start",t:6},{s:"num",t:2},{s:"len",t:6},{s:"replay_list",t:9,f:[{s:"name",t:7},{s:"flag",t:1},{s:"is_collect",t:1},{s:"id",t:6},{s:"combat_type",t:2},{s:"round",t:2},{s:"sec_type",t:6},{s:"a_rid",t:6},{s:"a_srv_id",t:7},{s:"a_name",t:7},{s:"a_lev",t:4},{s:"a_face",t:6},{s:"a_power",t:6},{s:"a_rank",t:2},{s:"a_formation_type",t:2},{s:"a_camp_type",t:2},{s:"b_rid",t:6},{s:"b_srv_id",t:7},{s:"b_name",t:7},{s:"b_lev",t:4},{s:"b_face",t:6},{s:"b_power",t:6},{s:"b_rank",t:2},{s:"b_formation_type",t:2},{s:"b_camp_type",t:2},{s:"ret",t:2},{s:"like",t:6},{s:"share",t:6},{s:"play",t:6},{s:"time",t:6},{s:"a_plist",t:9,f:[{s:"id",t:6},{s:"pos",t:2},{s:"bid",t:6},{s:"lev",t:4},{s:"star",t:2},{s:"break_lev",t:2},{s:"power",t:6},{s:"hp",t:6},{s:"hp_max",t:6},{s:"dps",t:6},{s:"behurt",t:6},{s:"cure",t:6}]},{s:"b_plist",t:9,f:[{s:"id",t:6},{s:"pos",t:2},{s:"bid",t:6},{s:"lev",t:4},{s:"star",t:2},{s:"break_lev",t:2},{s:"power",t:6},{s:"hp",t:6},{s:"hp_max",t:6},{s:"dps",t:6},{s:"behurt",t:6},{s:"cure",t:6}]}]}],19903:[{s:"code",t:2},{s:"msg",t:7},{s:"id",t:6}],19904:[{s:"code",t:2},{s:"msg",t:7},{s:"id",t:6},{s:"type",t:2}],19905:[{s:"code",t:2},{s:"msg",t:7}],19906:[{s:"like",t:2}],19907:[{s:"replay_id",t:6},{s:"partner_id",t:6},{s:"type",t:2},{s:"pos",t:2},{s:"bid",t:6},{s:"lev",t:4},{s:"star",t:2},{s:"break_lev",t:2},{s:"power",t:6},{s:"now_hp",t:6},{s:"hp",t:6},{s:"atk",t:6},{s:"def",t:6},{s:"speed",t:6},{s:"crit_rate",t:6},{s:"crit_ratio",t:6},{s:"hit_magic",t:6},{s:"dodge_magic",t:6},{s:"dps",t:6},{s:"behurt",t:6},{s:"cure",t:6},{s:"skills",t:9,f:[{s:"pos",t:2},{s:"skill_bid",t:6}]},{s:"eqms",t:9,f:[{s:"id",t:6},{s:"base_id",t:6},{s:"type",t:6}]},{s:"artifacts",t:9,f:[{s:"id",t:6},{s:"base_id",t:6},{s:"artifact_pos",t:2},{s:"enchant",t:6},{s:"attr",t:9,f:[{s:"attr_id",t:6},{s:"attr_val",t:6}]},{s:"extra_attr",t:9,f:[{s:"attr_id",t:6},{s:"attr_val",t:6}]},{s:"extra",t:9,f:[{s:"extra_k",t:6},{s:"extra_v",t:6}]}]},{s:"ext",t:9,f:[{s:"id",t:6},{s:"val",t:6}]}],19908:[{s:"type",t:2},{s:"channel",t:4},{s:"name",t:7},{s:"flag",t:1},{s:"is_collect",t:1},{s:"id",t:6},{s:"combat_type",t:2},{s:"round",t:2},{s:"sec_type",t:6},{s:"a_rid",t:6},{s:"a_srv_id",t:7},{s:"a_name",t:7},{s:"a_lev",t:4},{s:"a_face",t:6},{s:"a_power",t:6},{s:"a_rank",t:2},{s:"a_formation_type",t:2},{s:"a_camp_type",t:2},{s:"b_rid",t:6},{s:"b_srv_id",t:7},{s:"b_name",t:7},{s:"b_lev",t:4},{s:"b_face",t:6},{s:"b_power",t:6},{s:"b_rank",t:2},{s:"b_formation_type",t:2},{s:"b_camp_type",t:2},{s:"ret",t:2},{s:"like",t:6},{s:"share",t:6},{s:"play",t:6},{s:"time",t:6},{s:"a_plist",t:9,f:[{s:"id",t:6},{s:"pos",t:2},{s:"bid",t:6},{s:"lev",t:4},{s:"star",t:2},{s:"break_lev",t:2},{s:"power",t:6},{s:"hp",t:6},{s:"hp_max",t:6},{s:"dps",t:6},{s:"behurt",t:6},{s:"cure",t:6}]},{s:"b_plist",t:9,f:[{s:"id",t:6},{s:"pos",t:2},{s:"bid",t:6},{s:"lev",t:4},{s:"star",t:2},{s:"break_lev",t:2},{s:"power",t:6},{s:"hp",t:6},{s:"hp_max",t:6},{s:"dps",t:6},{s:"behurt",t:6},{s:"cure",t:6}]}],20000:[{s:"combat_type",t:4},{s:"combat_map",t:6}],20001:[{s:"code",t:2},{s:"msg",t:7}],20002:[{s:"pos",t:4},{s:"owner_id",t:6},{s:"owner_srv_id",t:7},{s:"all_alive",t:9,f:[{s:"pos",t:4}]},{s:"skill_plays",t:9,f:[{s:"order",t:2},{s:"actor",t:4},{s:"target",t:4},{s:"skill_bid",t:6},{s:"talk_pos",t:4},{s:"talk_content",t:7},{s:"effect_play",t:9,f:[{s:"order",t:4},{s:"actor",t:4},{s:"target",t:4},{s:"effect_bid",t:6},{s:"is_hit",t:2},{s:"is_crit",t:2},{s:"hp_changed",t:5},{s:"hp",t:5},{s:"is_dead",t:1},{s:"camp_restrain",t:1},{s:"buff_list",t:9,f:[{s:"target",t:4},{s:"buff_bid",t:6},{s:"remain_round",t:4},{s:"end_round",t:2},{s:"action_type",t:2},{s:"change_type",t:2},{s:"change_value",t:5},{s:"is_dead",t:1},{s:"id",t:6}]},{s:"summon_list",t:9,f:[{s:"pos",t:4},{s:"group",t:2},{s:"owner_id",t:6},{s:"owner_srv_id",t:7},{s:"object_type",t:4},{s:"object_id",t:6},{s:"object_bid",t:6},{s:"object_name",t:7},{s:"star",t:2},{s:"camp_type",t:1},{s:"sex",t:1},{s:"career",t:1},{s:"lev",t:6},{s:"hp",t:5},{s:"hp_max",t:5},{s:"face_id",t:5},{s:"skills",t:9,f:[{s:"skill_bid",t:6},{s:"end_round",t:1}]},{s:"extra_data",t:9,f:[{s:"extra_key",t:2},{s:"extra_value",t:6}]}]},{s:"sub_effect_play_list",t:9,f:[{s:"sub_target",t:4},{s:"sub_effect_id",t:6},{s:"sub_hp_changed",t:5},{s:"sub_is_hit",t:2},{s:"sub_skill_id",t:6},{s:"extra_effect",t:9,f:[{s:"extra_key",t:4},{s:"extra_param",t:5}]}]},{s:"is_blind",t:2},{s:"skill_bid_of_effect",t:6},{s:"actor_hp_changed",t:5},{s:"actor_is_dead",t:1},{s:"aid_actor",t:4},{s:"total_hurt",t:6},{s:"hurt_reward",t:9,f:[{s:"assets_id",t:6},{s:"assets_val",t:5}]}]}]},{s:"round_buff",t:9,f:[{s:"target",t:4},{s:"buff_bid",t:6},{s:"remain_round",t:4},{s:"end_round",t:2},{s:"action_type",t:2},{s:"change_type",t:2},{s:"change_value",t:5},{s:"is_dead",t:1},{s:"id",t:6}]},{s:"countdown_time",t:6},{s:"action_count",t:6},{s:"combat_type",t:4},{s:"hallows_list",t:9,f:[{s:"group",t:2},{s:"val",t:2}]}],20004:[{s:"skill_plays",t:9,f:[{s:"order",t:2},{s:"actor",t:4},{s:"target",t:4},{s:"skill_bid",t:6},{s:"talk_pos",t:4},{s:"talk_content",t:7},{s:"effect_play",t:9,f:[{s:"order",t:4},{s:"actor",t:4},{s:"target",t:4},{s:"effect_bid",t:6},{s:"is_hit",t:2},{s:"is_crit",t:2},{s:"hp_changed",t:5},{s:"hp",t:5},{s:"is_dead",t:1},{s:"camp_restrain",t:1},{s:"buff_list",t:9,f:[{s:"target",t:4},{s:"buff_bid",t:6},{s:"remain_round",t:4},{s:"end_round",t:2},{s:"action_type",t:2},{s:"change_type",t:2},{s:"change_value",t:5},{s:"is_dead",t:1},{s:"id",t:6}]},{s:"summon_list",t:9,f:[{s:"pos",t:4},{s:"group",t:2},{s:"owner_id",t:6},{s:"owner_srv_id",t:7},{s:"object_type",t:4},{s:"object_id",t:6},{s:"object_bid",t:6},{s:"object_name",t:7},{s:"star",t:2},{s:"camp_type",t:1},{s:"sex",t:1},{s:"career",t:1},{s:"lev",t:6},{s:"hp",t:5},{s:"hp_max",t:5},{s:"face_id",t:5},{s:"skills",t:9,f:[{s:"skill_bid",t:6},{s:"end_round",t:1}]},{s:"extra_data",t:9,f:[{s:"extra_key",t:2},{s:"extra_value",t:6}]}]},{s:"sub_effect_play_list",t:9,f:[{s:"sub_target",t:4},{s:"sub_effect_id",t:6},{s:"sub_hp_changed",t:5},{s:"sub_is_hit",t:2},{s:"sub_skill_id",t:6},{s:"extra_effect",t:9,f:[{s:"extra_key",t:4},{s:"extra_param",t:5}]}]},{s:"is_blind",t:2},{s:"skill_bid_of_effect",t:6},{s:"actor_hp_changed",t:5},{s:"actor_is_dead",t:1},{s:"aid_actor",t:4},{s:"total_hurt",t:6},{s:"hurt_reward",t:9,f:[{s:"assets_id",t:6},{s:"assets_val",t:5}]}]}]},{s:"round_buff",t:9,f:[{s:"target",t:4},{s:"buff_bid",t:6},{s:"remain_round",t:4},{s:"end_round",t:2},{s:"action_type",t:2},{s:"change_type",t:2},{s:"change_value",t:5},{s:"is_dead",t:1},{s:"id",t:6}]},{s:"action_count",t:6},{s:"combat_type",t:4},{s:"star_list",t:9,f:[{s:"id",t:2},{s:"val",t:2}]}],20005:[],20006:[{s:"result",t:2},{s:"item_rewards",t:9,f:[{s:"bid",t:6},{s:"is_bind",t:2},{s:"num",t:6},{s:"id",t:6}]},{s:"show_panel_type",t:2},{s:"current_time",t:6},{s:"best_time",t:6},{s:"combat_type",t:4},{s:"target_role_name",t:7},{s:"hurt_statistics",t:9,f:[{s:"type",t:2},{s:"partner_hurts",t:9,f:[{s:"rid",t:6},{s:"srvid",t:7},{s:"id",t:6},{s:"bid",t:6},{s:"star",t:6},{s:"lev",t:6},{s:"camp_type",t:6},{s:"dps",t:6},{s:"cure",t:6},{s:"ext_data",t:9,f:[{s:"key",t:6},{s:"val",t:6}]}]}]}],20008:[{s:"code",t:2},{s:"msg",t:7}],20009:[{s:"code",t:2},{s:"msg",t:7}],20013:[{s:"combat_type",t:4},{s:"formation",t:9,f:[{s:"group",t:2},{s:"formation_type",t:2},{s:"formation_lev",t:2}]},{s:"objects",t:9,f:[{s:"pos",t:4},{s:"group",t:2},{s:"owner_id",t:6},{s:"owner_srv_id",t:7},{s:"object_type",t:4},{s:"object_id",t:6},{s:"object_bid",t:6},{s:"object_name",t:7},{s:"star",t:2},{s:"camp_type",t:1},{s:"sex",t:1},{s:"career",t:1},{s:"lev",t:6},{s:"hp",t:5},{s:"hp_max",t:5},{s:"face_id",t:5},{s:"skills",t:9,f:[{s:"skill_bid",t:6},{s:"end_round",t:1}]},{s:"extra_data",t:9,f:[{s:"extra_key",t:2},{s:"extra_value",t:6}]}]},{s:"is_auto",t:2},{s:"buffs",t:9,f:[{s:"target",t:4},{s:"buff_bid",t:6},{s:"remain_round",t:4},{s:"end_round",t:2},{s:"action_type",t:2},{s:"change_type",t:2},{s:"change_value",t:5},{s:"is_dead",t:1},{s:"id",t:6}]},{s:"current_wave",t:2},{s:"total_wave",t:4},{s:"play_speed",t:2},{s:"combat_map",t:6},{s:"extra_args",t:9,f:[{s:"param",t:6}]},{s:"action_count",t:6},{s:"a_object_num",t:2},{s:"target_role_name",t:7},{s:"actor_role_name",t:7},{s:"begin_time",t:6},{s:"suppress",t:2},{s:"flag",t:2},{s:"halo_list",t:9,f:[{s:"group",t:2},{s:"type",t:4}]},{s:"hallows_list",t:9,f:[{s:"group",t:2},{s:"val",t:2},{s:"max",t:2}]},{s:"cli_string_ext_args",t:9,f:[{s:"param",t:7}]}],20014:[{s:"code",t:2},{s:"msg",t:7}],20015:[{s:"code",t:2},{s:"msg",t:7}],20016:[{s:"target_id",t:6},{s:"target_srv_id",t:7},{s:"target_name",t:7},{s:"target_lev",t:2},{s:"target_face",t:6}],20019:[],20020:[{s:"combat_type",t:4},{s:"formation",t:9,f:[{s:"group",t:2},{s:"formation_type",t:2},{s:"formation_lev",t:2}]},{s:"objects",t:9,f:[{s:"pos",t:4},{s:"group",t:2},{s:"owner_id",t:6},{s:"owner_srv_id",t:7},{s:"object_type",t:4},{s:"object_id",t:6},{s:"object_bid",t:6},{s:"object_name",t:7},{s:"star",t:2},{s:"camp_type",t:1},{s:"sex",t:1},{s:"career",t:1},{s:"lev",t:6},{s:"hp",t:5},{s:"hp_max",t:5},{s:"face_id",t:5},{s:"skills",t:9,f:[{s:"skill_bid",t:6},{s:"end_round",t:1}]},{s:"extra_data",t:9,f:[{s:"extra_key",t:2},{s:"extra_value",t:6}]}]},{s:"is_auto",t:2},{s:"buffs",t:9,f:[{s:"target",t:4},{s:"buff_bid",t:6},{s:"remain_round",t:4},{s:"end_round",t:2},{s:"action_type",t:2},{s:"change_type",t:2},{s:"change_value",t:5},{s:"is_dead",t:1},{s:"id",t:6}]},{s:"current_wave",t:2},{s:"total_wave",t:4},{s:"target_role_name",t:7},{s:"actor_role_name",t:7},{s:"halo_list",t:9,f:[{s:"group",t:2},{s:"type",t:4}]}],20022:[{s:"code",t:2},{s:"msg",t:7}],20026:[{s:"drama_id",t:6}],20027:[{s:"combat_type",t:4},{s:"formation",t:9,f:[{s:"group",t:2},{s:"formation_type",t:2},{s:"formation_lev",t:2}]},{s:"objects",t:9,f:[{s:"pos",t:4},{s:"group",t:2},{s:"owner_id",t:6},{s:"owner_srv_id",t:7},{s:"object_type",t:4},{s:"object_id",t:6},{s:"object_bid",t:6},{s:"object_name",t:7},{s:"star",t:2},{s:"camp_type",t:1},{s:"sex",t:1},{s:"career",t:1},{s:"lev",t:6},{s:"hp",t:5},{s:"hp_max",t:5},{s:"face_id",t:5},{s:"skills",t:9,f:[{s:"skill_bid",t:6},{s:"end_round",t:1}]},{s:"extra_data",t:9,f:[{s:"extra_key",t:2},{s:"extra_value",t:6}]}]},{s:"is_auto",t:2},{s:"current_wave",t:2},{s:"total_wave",t:4},{s:"play_speed",t:2},{s:"extra_args",t:9,f:[{s:"param",t:6}]},{s:"target_role_name",t:7},{s:"a_object_num",t:2},{s:"actor_role_name",t:7},{s:"suppress",t:2},{s:"halo_list",t:9,f:[{s:"group",t:2},{s:"type",t:4}]},{s:"hallows_list",t:9,f:[{s:"group",t:2},{s:"val",t:2},{s:"max",t:2}]},{s:"string_ext_args",t:9,f:[{s:"param",t:7}]}],20028:[{s:"code",t:2},{s:"msg",t:7}],20029:[{s:"code",t:2},{s:"msg",t:7}],20030:[{s:"is_in_combat",t:2}],20033:[{s:"result",t:2},{s:"def_name",t:7},{s:"def_guild_name",t:7},{s:"def_lev",t:6},{s:"def_face_id",t:6},{s:"replay_id",t:6},{s:"is_province",t:2},{s:"hurt_statistics",t:9,f:[{s:"type",t:2},{s:"partner_hurts",t:9,f:[{s:"rid",t:6},{s:"srvid",t:7},{s:"id",t:6},{s:"bid",t:6},{s:"star",t:6},{s:"lev",t:6},{s:"camp_type",t:6},{s:"dps",t:6},{s:"cure",t:6},{s:"ext_data",t:9,f:[{s:"key",t:6},{s:"val",t:6}]}]}]}],20034:[{s:"result",t:2},{s:"msg",t:7}],20036:[{s:"code",t:2},{s:"msg",t:7}],20060:[{s:"combat_type",t:4},{s:"type",t:2}],20061:[{s:"combat_type",t:4},{s:"bid",t:6},{s:"partner_list",t:9,f:[{s:"pos",t:2},{s:"speed",t:4},{s:"bid",t:6},{s:"lev",t:2},{s:"star",t:2},{s:"quality",t:2},{s:"hp",t:6},{s:"crit",t:4},{s:"skill_list",t:9,f:[{s:"sid",t:6},{s:"effect_list",t:9,f:[{s:"eid",t:6},{s:"num",t:2},{s:"min_hurt",t:6},{s:"max_hurt",t:6}]},{s:"rand",t:2}]},{s:"use_skin",t:6}]},{s:"wave_list",t:9,f:[{s:"unit_list",t:9,f:[{s:"pos",t:2},{s:"bid",t:6},{s:"speed",t:4},{s:"hp",t:6},{s:"crit",t:4},{s:"skill_list",t:9,f:[{s:"sid",t:6},{s:"effect_list",t:9,f:[{s:"eid",t:6},{s:"num",t:2},{s:"min_hurt",t:6},{s:"max_hurt",t:6}]},{s:"rand",t:2}]}]}]},{s:"dun_bid",t:6},{s:"b_formation_type",t:2}],20062:[{s:"code",t:2},{s:"msg",t:7}],20063:[{s:"type_list",t:9,f:[{s:"combat_type",t:4}]}],20200:[{s:"rank",t:4},{s:"score",t:6},{s:"can_combat_num",t:2},{s:"buy_combat_num",t:2},{s:"ref_time",t:5},{s:"start_time",t:6},{s:"end_time",t:6},{s:"cont_win",t:4}],20201:[{s:"f_list",t:9,f:[{s:"idx",t:2},{s:"rid",t:6},{s:"srv_id",t:7},{s:"name",t:7},{s:"lev",t:4},{s:"sex",t:2},{s:"face",t:6},{s:"power",t:6},{s:"score",t:6},{s:"get_score",t:2},{s:"status",t:2},{s:"p_list",t:9,f:[{s:"pos",t:2},{s:"bid",t:6},{s:"lev",t:4},{s:"star",t:2},{s:"break_lev",t:2},{s:"use_skin",t:6}]}]},{s:"type",t:2}],20202:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"name",t:7},{s:"lev",t:4},{s:"face",t:6},{s:"power",t:6},{s:"score",t:6},{s:"formation_type",t:2},{s:"formation_lev",t:2},{s:"p_list",t:9,f:[{s:"pos",t:2},{s:"bid",t:6},{s:"lev",t:4},{s:"quality",t:2},{s:"star",t:2},{s:"break_lev",t:2},{s:"use_skin",t:6}]}],20203:[{s:"code",t:2},{s:"msg",t:7}],20204:[{s:"code",t:2},{s:"msg",t:7}],20206:[{s:"code",t:2},{s:"msg",t:7}],20207:[{s:"code",t:2},{s:"msg",t:7}],20208:[{s:"had_combat_num",t:4},{s:"num_list",t:9,f:[{s:"num",t:2}]}],20209:[{s:"code",t:2},{s:"msg",t:7}],20210:[{s:"result",t:2},{s:"score",t:6},{s:"get_score",t:5},{s:"items",t:9,f:[{s:"bid",t:6},{s:"num",t:6}]},{s:"tar_name",t:7},{s:"tar_lev",t:4},{s:"tar_face",t:6},{s:"tar_score",t:5},{s:"lose_score",t:5},{s:"target_role_name",t:7},{s:"hurt_statistics",t:9,f:[{s:"type",t:2},{s:"partner_hurts",t:9,f:[{s:"rid",t:6},{s:"srvid",t:7},{s:"id",t:6},{s:"bid",t:6},{s:"star",t:6},{s:"lev",t:6},{s:"camp_type",t:6},{s:"dps",t:6},{s:"cure",t:6},{s:"ext_data",t:9,f:[{s:"key",t:6},{s:"val",t:6}]}]}]}],20220:[{s:"rank_list",t:9,f:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"name",t:7},{s:"lev",t:4},{s:"rank",t:2},{s:"score",t:6},{s:"sex",t:2},{s:"lookid",t:6},{s:"worship",t:6},{s:"worship_status",t:2}]}],20221:[{s:"rank",t:4},{s:"score",t:6},{s:"worship",t:6},{s:"rank_list",t:9,f:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"name",t:7},{s:"lev",t:4},{s:"face",t:6},{s:"sex",t:2},{s:"rank",t:4},{s:"score",t:6},{s:"power",t:6},{s:"avatar_id",t:6},{s:"worship",t:6},{s:"worship_status",t:2}]}],20222:[{s:"log_list",t:9,f:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"name",t:7},{s:"lev",t:4},{s:"sex",t:2},{s:"face",t:6},{s:"avatar_id",t:6},{s:"power",t:6},{s:"score",t:3},{s:"type",t:2},{s:"ret",t:2},{s:"replay_id",t:6},{s:"time",t:6}]}],20223:[{s:"flag",t:2}],20250:[{s:"start_time",t:6},{s:"end_time",t:6},{s:"step",t:2},{s:"step_status",t:2},{s:"step_status_time",t:6},{s:"round",t:2},{s:"round_status",t:2},{s:"round_status_time",t:6},{s:"flag",t:2}],20251:[{s:"rank",t:4},{s:"best_rank",t:4},{s:"can_bet",t:6},{s:"group",t:2}],20252:[{s:"step",t:2},{s:"round",t:2},{s:"group",t:2},{s:"a_bet",t:6},{s:"a_rid",t:6},{s:"a_srv_id",t:7},{s:"a_name",t:7},{s:"a_lev",t:4},{s:"a_face",t:6},{s:"a_avatar_id",t:6},{s:"a_sex",t:2},{s:"a_power",t:6},{s:"a_formation_type",t:2},{s:"a_formation_lev",t:2},{s:"a_plist",t:9,f:[{s:"pos",t:2},{s:"bid",t:6},{s:"lev",t:4},{s:"quality",t:2},{s:"star",t:2},{s:"break_lev",t:2},{s:"hurt",t:6},{s:"behurt",t:6},{s:"curt",t:6},{s:"ext_data",t:9,f:[{s:"key",t:6},{s:"val",t:6}]}]},{s:"b_bet",t:6},{s:"b_rid",t:6},{s:"b_srv_id",t:7},{s:"b_name",t:7},{s:"b_lev",t:4},{s:"b_face",t:6},{s:"b_avatar_id",t:6},{s:"b_sex",t:2},{s:"b_power",t:6},{s:"b_formation_type",t:2},{s:"b_formation_lev",t:2},{s:"b_plist",t:9,f:[{s:"pos",t:2},{s:"bid",t:6},{s:"lev",t:4},{s:"quality",t:2},{s:"star",t:2},{s:"break_lev",t:2},{s:"hurt",t:6},{s:"behurt",t:6},{s:"curt",t:6},{s:"ext_data",t:9,f:[{s:"key",t:6},{s:"val",t:6}]}]},{s:"ret",t:2},{s:"replay_id",t:6}],20253:[{s:"bet_type",t:2},{s:"bet_val",t:6},{s:"a_bet_ratio",t:4},{s:"b_bet_ratio",t:4},{s:"step",t:2},{s:"round",t:2},{s:"group",t:2},{s:"a_bet",t:6},{s:"a_rid",t:6},{s:"a_srv_id",t:7},{s:"a_name",t:7},{s:"a_lev",t:4},{s:"a_face",t:6},{s:"a_avatar_id",t:6},{s:"a_sex",t:2},{s:"a_power",t:6},{s:"a_formation_type",t:2},{s:"a_formation_lev",t:2},{s:"a_plist",t:9,f:[{s:"pos",t:2},{s:"bid",t:6},{s:"lev",t:4},{s:"quality",t:2},{s:"star",t:2},{s:"break_lev",t:2},{s:"hurt",t:6},{s:"behurt",t:6},{s:"curt",t:6},{s:"ext_data",t:9,f:[{s:"key",t:6},{s:"val",t:6}]}]},{s:"b_bet",t:6},{s:"b_rid",t:6},{s:"b_srv_id",t:7},{s:"b_name",t:7},{s:"b_lev",t:4},{s:"b_face",t:6},{s:"b_avatar_id",t:6},{s:"b_sex",t:2},{s:"b_power",t:6},{s:"b_formation_type",t:2},{s:"b_formation_lev",t:2},{s:"b_plist",t:9,f:[{s:"pos",t:2},{s:"bid",t:6},{s:"lev",t:4},{s:"quality",t:2},{s:"star",t:2},{s:"break_lev",t:2},{s:"hurt",t:6},{s:"behurt",t:6},{s:"curt",t:6},{s:"ext_data",t:9,f:[{s:"key",t:6},{s:"val",t:6}]}]},{s:"ret",t:2},{s:"replay_id",t:6}],20254:[{s:"code",t:2},{s:"msg",t:7},{s:"can_bet",t:6},{s:"bet_type",t:2},{s:"bet_val",t:6}],20255:[{s:"list",t:9,f:[{s:"id",t:4},{s:"target",t:2},{s:"bet",t:6},{s:"get_bet",t:6},{s:"step",t:2},{s:"round",t:2},{s:"group",t:2},{s:"a_bet",t:6},{s:"a_rid",t:6},{s:"a_srv_id",t:7},{s:"a_name",t:7},{s:"a_lev",t:4},{s:"a_face",t:6},{s:"a_avatar_id",t:6},{s:"a_sex",t:2},{s:"a_power",t:6},{s:"a_formation_type",t:2},{s:"a_formation_lev",t:2},{s:"a_plist",t:9,f:[{s:"pos",t:2},{s:"bid",t:6},{s:"lev",t:4},{s:"quality",t:2},{s:"star",t:2},{s:"break_lev",t:2},{s:"hurt",t:6},{s:"behurt",t:6},{s:"curt",t:6},{s:"ext_data",t:9,f:[{s:"key",t:6},{s:"val",t:6}]}]},{s:"b_bet",t:6},{s:"b_rid",t:6},{s:"b_srv_id",t:7},{s:"b_name",t:7},{s:"b_lev",t:4},{s:"b_face",t:6},{s:"b_avatar_id",t:6},{s:"b_sex",t:2},{s:"b_power",t:6},{s:"b_formation_type",t:2},{s:"b_formation_lev",t:2},{s:"b_plist",t:9,f:[{s:"pos",t:2},{s:"bid",t:6},{s:"lev",t:4},{s:"quality",t:2},{s:"star",t:2},{s:"break_lev",t:2},{s:"hurt",t:6},{s:"behurt",t:6},{s:"curt",t:6},{s:"ext_data",t:9,f:[{s:"key",t:6},{s:"val",t:6}]}]},{s:"ret",t:2},{s:"replay_id",t:6}]}],20256:[{s:"rank",t:4},{s:"cnum",t:2},{s:"win",t:2}],20257:[{s:"a_bet",t:6},{s:"b_bet",t:6},{s:"a_bet_ratio",t:4},{s:"b_bet_ratio",t:4}],20258:[{s:"list",t:9,f:[{s:"id",t:4},{s:"score",t:4},{s:"step",t:2},{s:"round",t:2},{s:"group",t:2},{s:"a_bet",t:6},{s:"a_rid",t:6},{s:"a_srv_id",t:7},{s:"a_name",t:7},{s:"a_lev",t:4},{s:"a_face",t:6},{s:"a_avatar_id",t:6},{s:"a_sex",t:2},{s:"a_power",t:6},{s:"a_formation_type",t:2},{s:"a_formation_lev",t:2},{s:"a_plist",t:9,f:[{s:"pos",t:2},{s:"bid",t:6},{s:"lev",t:4},{s:"quality",t:2},{s:"star",t:2},{s:"break_lev",t:2},{s:"hurt",t:6},{s:"behurt",t:6},{s:"curt",t:6},{s:"ext_data",t:9,f:[{s:"key",t:6},{s:"val",t:6}]}]},{s:"b_bet",t:6},{s:"b_rid",t:6},{s:"b_srv_id",t:7},{s:"b_name",t:7},{s:"b_lev",t:4},{s:"b_face",t:6},{s:"b_avatar_id",t:6},{s:"b_sex",t:2},{s:"b_power",t:6},{s:"b_formation_type",t:2},{s:"b_formation_lev",t:2},{s:"b_plist",t:9,f:[{s:"pos",t:2},{s:"bid",t:6},{s:"lev",t:4},{s:"quality",t:2},{s:"star",t:2},{s:"break_lev",t:2},{s:"hurt",t:6},{s:"behurt",t:6},{s:"curt",t:6},{s:"ext_data",t:9,f:[{s:"key",t:6},{s:"val",t:6}]}]},{s:"ret",t:2},{s:"replay_id",t:6}]}],20260:[{s:"list",t:9,f:[{s:"group",t:2},{s:"pos_list",t:9,f:[{s:"pos",t:2},{s:"rid",t:6},{s:"srv_id",t:7},{s:"name",t:7},{s:"ret",t:2},{s:"replay_id",t:6}]}]}],20261:[{s:"pos_list",t:9,f:[{s:"pos",t:2},{s:"rid",t:6},{s:"srv_id",t:7},{s:"name",t:7},{s:"face",t:6},{s:"ret",t:2},{s:"replay_id",t:6}]}],20262:[{s:"group",t:2},{s:"pos",t:2}],20263:[{s:"step",t:2},{s:"round",t:2},{s:"group",t:2},{s:"a_bet",t:6},{s:"a_rid",t:6},{s:"a_srv_id",t:7},{s:"a_name",t:7},{s:"a_lev",t:4},{s:"a_face",t:6},{s:"a_avatar_id",t:6},{s:"a_sex",t:2},{s:"a_power",t:6},{s:"a_formation_type",t:2},{s:"a_formation_lev",t:2},{s:"a_plist",t:9,f:[{s:"pos",t:2},{s:"bid",t:6},{s:"lev",t:4},{s:"quality",t:2},{s:"star",t:2},{s:"break_lev",t:2},{s:"hurt",t:6},{s:"behurt",t:6},{s:"curt",t:6},{s:"ext_data",t:9,f:[{s:"key",t:6},{s:"val",t:6}]}]},{s:"b_bet",t:6},{s:"b_rid",t:6},{s:"b_srv_id",t:7},{s:"b_name",t:7},{s:"b_lev",t:4},{s:"b_face",t:6},{s:"b_avatar_id",t:6},{s:"b_sex",t:2},{s:"b_power",t:6},{s:"b_formation_type",t:2},{s:"b_formation_lev",t:2},{s:"b_plist",t:9,f:[{s:"pos",t:2},{s:"bid",t:6},{s:"lev",t:4},{s:"quality",t:2},{s:"star",t:2},{s:"break_lev",t:2},{s:"hurt",t:6},{s:"behurt",t:6},{s:"curt",t:6},{s:"ext_data",t:9,f:[{s:"key",t:6},{s:"val",t:6}]}]},{s:"ret",t:2},{s:"replay_id",t:6}],20280:[{s:"rank_list",t:9,f:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"name",t:7},{s:"lev",t:4},{s:"rank",t:2},{s:"sex",t:2},{s:"lookid",t:6},{s:"worship",t:6},{s:"worship_status",t:2}]}],20281:[{s:"rank",t:4},{s:"worship",t:6},{s:"power",t:6},{s:"rank_list",t:9,f:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"name",t:7},{s:"lev",t:4},{s:"face",t:6},{s:"sex",t:2},{s:"rank",t:4},{s:"score",t:4},{s:"power",t:6},{s:"worship",t:6},{s:"worship_status",t:2}]}],20282:[{s:"time",t:6},{s:"rank_list",t:9,f:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"name",t:7},{s:"lev",t:4},{s:"face",t:6},{s:"sex",t:2},{s:"rank",t:4}]}],20300:[{s:"activity_box",t:9,f:[{s:"activity",t:4}]}],20301:[{s:"code",t:2},{s:"msg",t:7},{s:"activity",t:2}],20500:[{s:"boss_list",t:9,f:[{s:"boss_id",t:6},{s:"status",t:2},{s:"first",t:2}]},{s:"ext_list",t:9,f:[{s:"ext_id",t:2},{s:"status",t:2}]}],20501:[{s:"code",t:2},{s:"msg",t:7}],20502:[{s:"code",t:2},{s:"msg",t:7}],20530:[{s:"can_combat_num",t:2},{s:"buy_combat_num",t:2},{s:"num_time",t:6}],20531:[{s:"code",t:2},{s:"msg",t:7}],20532:[{s:"code",t:2},{s:"msg",t:7}],20533:[{s:"code",t:2},{s:"msg",t:7}],20535:[{s:"boss_list",t:9,f:[{s:"boss_id",t:6},{s:"rnum",t:4},{s:"hp",t:6},{s:"hp_max",t:6},{s:"ref_time",t:6}]}],20536:[{s:"boss_id",t:6},{s:"rnum",t:4},{s:"hp",t:6},{s:"hp_max",t:6},{s:"ref_time",t:6}],20537:[{s:"boss_id",t:6},{s:"role_list",t:9,f:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"name",t:7},{s:"hurt",t:6}]}],20538:[{s:"boss_id",t:6},{s:"role_list",t:9,f:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"name",t:7},{s:"power",t:6},{s:"time",t:6}]}],20539:[{s:"boss_id",t:6},{s:"hurt",t:6},{s:"item_rewards",t:9,f:[{s:"bid",t:6},{s:"is_bind",t:2},{s:"num",t:6},{s:"id",t:6}]}],20540:[{s:"boss_list",t:9,f:[{s:"boss_id",t:6}]}],20541:[],20542:[{s:"result",t:2},{s:"first_award",t:9,f:[{s:"item_id",t:6},{s:"num",t:6}]},{s:"award",t:9,f:[{s:"item_id",t:6},{s:"num",t:6}]}],20600:[{s:"pass_id",t:2},{s:"pass_num",t:2},{s:"id",t:2},{s:"room",t:2},{s:"is_kill_boss",t:2},{s:"map_id",t:2},{s:"is_all_finish",t:2},{s:"start_time",t:6},{s:"end_time",t:6}],20601:[{s:"buff_list",t:9,f:[{s:"bid",t:6},{s:"time",t:6}]},{s:"holiday_buff_list",t:9,f:[{s:"bid",t:6},{s:"time",t:6}]}],20602:[{s:"room_list",t:9,f:[{s:"id",t:2},{s:"status",t:2},{s:"lock",t:2},{s:"evt_id",t:6},{s:"res_id",t:2}]}],20603:[{s:"room_list",t:9,f:[{s:"id",t:2},{s:"status",t:2},{s:"lock",t:2},{s:"evt_id",t:6},{s:"res_id",t:2}]}],20604:[{s:"id",t:6},{s:"partners",t:9,f:[{s:"now_hp",t:6},{s:"partner_id",t:6},{s:"bid",t:6},{s:"lev",t:4},{s:"star",t:2},{s:"skills",t:9,f:[{s:"pos",t:2},{s:"skill_bid",t:6}]},{s:"break_lev",t:2},{s:"power",t:6},{s:"is_lock",t:9,f:[{s:"lock_type",t:6},{s:"is_lock",t:2}]},{s:"use_skin",t:6},{s:"atk",t:6},{s:"def_p",t:6},{s:"def_s",t:6},{s:"hp",t:6},{s:"speed",t:6},{s:"hit_rate",t:6},{s:"dodge_rate",t:6},{s:"crit_rate",t:6},{s:"crit_ratio",t:6},{s:"hit_magic",t:6},{s:"dodge_magic",t:6},{s:"def",t:6},{s:"atk2",t:6},{s:"hp2",t:6},{s:"def2",t:6},{s:"speed2",t:6},{s:"eqms",t:9,f:[{s:"id",t:6},{s:"base_id",t:6},{s:"type",t:6}]},{s:"artifacts",t:9,f:[{s:"artifact_pos",t:2},{s:"id",t:6},{s:"base_id",t:6},{s:"enchant",t:6},{s:"attr",t:9,f:[{s:"attr_id",t:6},{s:"attr_val",t:6}]},{s:"extra_attr",t:9,f:[{s:"attr_id",t:6},{s:"attr_val",t:6}]},{s:"extra",t:9,f:[{s:"extra_k",t:6},{s:"extra_v",t:6}]}]}]}],20605:[{s:"code",t:2},{s:"msg",t:7}],20606:[{s:"items_list",t:9,f:[{s:"bid",t:6},{s:"num",t:6}]},{s:"vip_buff",t:6}],20607:[{s:"code",t:2},{s:"msg",t:7}],20608:[{s:"code",t:2},{s:"msg",t:7},{s:"room_id",t:2}],20609:[{s:"skill_list",t:9,f:[{s:"bid",t:6},{s:"num",t:6},{s:"use_count",t:6}]}],20610:[{s:"code",t:2},{s:"msg",t:7},{s:"id",t:6}],20611:[{s:"room_list",t:9,f:[{s:"id",t:2},{s:"evt_id",t:6}]}],20612:[],20620:[{s:"code",t:2},{s:"msg",t:7},{s:"room_id",t:2},{s:"action",t:2}],20621:[{s:"sel_val",t:2},{s:"ret_val",t:2},{s:"ret",t:2},{s:"items",t:9,f:[{s:"bid",t:6},{s:"num",t:6},{s:"move_to",t:2}]}],20623:[{s:"ret",t:2},{s:"sel_val",t:2},{s:"right",t:2},{s:"num",t:2},{s:"max",t:2},{s:"bid",t:6},{s:"ret_msg",t:7},{s:"now_items",t:9,f:[{s:"bid",t:6},{s:"num",t:6}]},{s:"max_items",t:9,f:[{s:"bid",t:6},{s:"num",t:6}]},{s:"ret_items",t:9,f:[{s:"bid",t:6},{s:"num",t:6},{s:"move_to",t:2}]}],20624:[{s:"hp_per",t:2}],20625:[{s:"id",t:2},{s:"skill_id",t:6}],20627:[{s:"evt_id",t:6},{s:"id",t:2}],20628:[{s:"msg",t:7},{s:"items",t:9,f:[{s:"bid",t:6},{s:"num",t:6},{s:"move_to",t:2}]}],20630:[{s:"items",t:9,f:[{s:"bid",t:6},{s:"num",t:6},{s:"move_to",t:2}]}],20631:[{s:"type",t:2},{s:"list",t:9,f:[{s:"id",t:6},{s:"pay_type",t:2},{s:"pay_val",t:6},{s:"bid",t:6},{s:"num",t:6},{s:"is_buy",t:2},{s:"discount",t:2}]}],20632:[{s:"list",t:9,f:[{s:"id",t:6},{s:"pay_type",t:2},{s:"pay_val",t:6},{s:"bid",t:6},{s:"num",t:6},{s:"is_buy",t:2},{s:"discount",t:2}]}],20633:[{s:"code",t:2},{s:"msg",t:7},{s:"id",t:2}],20634:[{s:"list",t:9,f:[{s:"id",t:6},{s:"status",t:2}]},{s:"kill_mon",t:6}],20635:[{s:"code",t:2},{s:"msg",t:7}],20700:[{s:"num",t:2},{s:"time",t:6}],20701:[{s:"list",t:9,f:[{s:"pos",t:2},{s:"num",t:6},{s:"status",t:2},{s:"look_id",t:6},{s:"rid",t:6},{s:"srv_id",t:7},{s:"name",t:7},{s:"lev",t:4},{s:"face_id",t:6},{s:"unit_id",t:6}]}],20702:[{s:"code",t:2},{s:"msg",t:7}],20703:[{s:"pos",t:2},{s:"list",t:9,f:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"name",t:7},{s:"lev",t:4},{s:"power",t:6},{s:"face_id",t:6},{s:"time",t:6},{s:"num",t:6},{s:"replay_id",t:6},{s:"formation_type",t:2},{s:"formation_lev",t:2},{s:"partner_list",t:9,f:[{s:"bid",t:6},{s:"lev",t:4},{s:"star",t:2}]}]}],20705:[{s:"pos",t:2},{s:"num1",t:6},{s:"num2",t:6},{s:"target_role_name",t:7},{s:"hurt_statistics",t:9,f:[{s:"type",t:2},{s:"partner_hurts",t:9,f:[{s:"rid",t:6},{s:"srvid",t:7},{s:"id",t:6},{s:"bid",t:6},{s:"star",t:6},{s:"lev",t:6},{s:"camp_type",t:6},{s:"dps",t:6},{s:"cure",t:6}]}]}],21000:[{s:"end_time",t:6},{s:"first_gift",t:9,f:[{s:"id",t:2},{s:"status",t:2}]}],21001:[{s:"code",t:2},{s:"msg",t:7}],21002:[{s:"count",t:4}],21003:[],21004:[{s:"code",t:2},{s:"msg",t:7}],21005:[{s:"count",t:4},{s:"gold",t:6},{s:"next_gold",t:6}],21006:[{s:"first_gift",t:9,f:[{s:"id",t:2},{s:"count",t:4}]}],21007:[{s:"type",t:2},{s:"ref_time",t:6},{s:"reg_day",t:6},{s:"first_gift",t:9,f:[{s:"id",t:6},{s:"count",t:4}]}],21008:[{s:"status",t:2}],21009:[{s:"code",t:2},{s:"msg",t:7}],21010:[{s:"status",t:2},{s:"num",t:6}],21011:[{s:"code",t:2},{s:"msg",t:7}],21012:[{s:"choosen_status",t:2},{s:"has_choosen_id",t:2},{s:"first_gift",t:9,f:[{s:"id",t:2},{s:"status",t:2}]}],21013:[{s:"code",t:2},{s:"msg",t:7}],21014:[{s:"code",t:2},{s:"msg",t:7}],21015:[{s:"open_id",t:9,f:[{s:"id",t:4}]}],21016:[{s:"charge_id",t:6},{s:"status",t:2}],21020:[{s:"code",t:2}],21100:[{s:"status_list",t:9,f:[{s:"day",t:2},{s:"status",t:2}]}],21101:[{s:"code",t:2},{s:"msg",t:7},{s:"day",t:2}],21200:[{s:"gifts",t:9,f:[{s:"id",t:2},{s:"status",t:2},{s:"num",t:6}]}],21201:[{s:"code",t:2},{s:"msg",t:7},{s:"id",t:2}],21210:[{s:"gifts",t:9,f:[{s:"id",t:6},{s:"num",t:4},{s:"end_time",t:6}]}],21211:[{s:"id",t:6}],21220:[{s:"gifts",t:9,f:[{s:"id",t:6},{s:"num",t:4},{s:"end_time",t:6}]}],21300:[{s:"fid",t:6},{s:"max_id",t:6},{s:"count",t:6},{s:"buy_count",t:4},{s:"info",t:9,f:[{s:"boss_id",t:6},{s:"hp",t:6}]},{s:"combat_info",t:9,f:[{s:"boss_id",t:6},{s:"dps",t:6}]},{s:"buff_lev",t:4},{s:"buff_end_time",t:6},{s:"ref_time",t:6},{s:"worship",t:6},{s:"coldtime",t:6}],21303:[{s:"box_list",t:9,f:[{s:"fid",t:6},{s:"num",t:6}]}],21304:[{s:"code",t:2},{s:"msg",t:7},{s:"fid",t:6},{s:"num",t:6}],21305:[{s:"code",t:2},{s:"msg",t:7}],21308:[{s:"code",t:2},{s:"msg",t:7}],21309:[{s:"bossid",t:6},{s:"all_dps",t:6},{s:"best_partner",t:6},{s:"award_list",t:9,f:[{s:"bid",t:6},{s:"num",t:6}]},{s:"target_role_name",t:7},{s:"hurt_statistics",t:9,f:[{s:"type",t:2},{s:"partner_hurts",t:9,f:[{s:"rid",t:6},{s:"srvid",t:7},{s:"id",t:6},{s:"bid",t:6},{s:"star",t:6},{s:"lev",t:6},{s:"camp_type",t:6},{s:"dps",t:6},{s:"cure",t:6}]}]}],21312:[{s:"code",t:2},{s:"msg",t:7},{s:"count",t:4},{s:"buy_count",t:4},{s:"type",t:2}],21317:[{s:"code",t:2},{s:"msg",t:7},{s:"do_count",t:6},{s:"all_dps",t:6},{s:"best_partner",t:6},{s:"award_list",t:9,f:[{s:"bid",t:6},{s:"num",t:6}]},{s:"target_role_name",t:7},{s:"hurt_statistics",t:9,f:[{s:"type",t:2},{s:"partner_hurts",t:9,f:[{s:"rid",t:6},{s:"srvid",t:7},{s:"id",t:6},{s:"bid",t:6},{s:"star",t:6},{s:"lev",t:6},{s:"camp_type",t:6},{s:"dps",t:6},{s:"cure",t:6}]}]}],21318:[{s:"my_name",t:7},{s:"my_rank",t:6},{s:"my_max_id",t:2},{s:"my_dps",t:6},{s:"r_rid",t:6},{s:"r_srvid",t:7},{s:"r_name",t:7},{s:"face_id",t:6},{s:"lev",t:6},{s:"power",t:6},{s:"avatar_bid",t:6},{s:"rank_guild",t:9,f:[{s:"name",t:7},{s:"rank",t:2},{s:"r_name",t:7},{s:"max_id",t:6},{s:"day_dps",t:6}]}],21319:[{s:"rank",t:6},{s:"mydps",t:6},{s:"worship",t:6},{s:"day_worship",t:6},{s:"rank_list",t:9,f:[{s:"rank",t:6},{s:"r_rid",t:6},{s:"r_srvid",t:7},{s:"name",t:7},{s:"family_name",t:7},{s:"all_dps",t:6},{s:"face_id",t:6},{s:"lev",t:6},{s:"power",t:6},{s:"avatar_bid",t:6},{s:"worship",t:6},{s:"worship_status",t:2}]}],21320:[{s:"award_list",t:9,f:[{s:"fid",t:6},{s:"status",t:2}]}],21321:[{s:"fid",t:6},{s:"code",t:2},{s:"msg",t:7}],21322:[{s:"code",t:2}],21323:[{s:"code",t:2},{s:"msg",t:7},{s:"coldtime",t:6}],21401:[{s:"code",t:2},{s:"msg",t:7}],21403:[{s:"code",t:2}],21409:[{s:"time",t:2}],21410:[{s:"type",t:2},{s:"role_list",t:9,f:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"name",t:7},{s:"camp",t:2},{s:"lev",t:2},{s:"status",t:2},{s:"effect",t:2},{s:"score",t:4},{s:"win_acc",t:4},{s:"win_best",t:2},{s:"pos_x",t:2},{s:"pos_y",t:2},{s:"skill_effect",t:9,f:[{s:"id",t:2}]}]}],21411:[{s:"role_move_list",t:9,f:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"pos_x",t:2},{s:"pos_y",t:2}]}],21412:[{s:"score_a",t:6},{s:"score_b",t:6},{s:"group",t:2},{s:"zone",t:2}],21413:[{s:"type",t:2},{s:"guard_list",t:9,f:[{s:"id",t:2},{s:"camp",t:2},{s:"bid",t:6},{s:"pos_x",t:2},{s:"pos_y",t:2},{s:"status",t:2},{s:"hp",t:6},{s:"max_hp",t:6}]}],21415:[{s:"ret",t:2},{s:"role_list",t:9,f:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"name",t:7},{s:"camp",t:2},{s:"lev",t:2},{s:"score",t:4},{s:"win_acc",t:4},{s:"win_best",t:2}]}],21416:[{s:"type",t:2},{s:"camp1",t:2},{s:"face1",t:6},{s:"srv_id1",t:7},{s:"name1",t:7},{s:"face2",t:6},{s:"srv_id2",t:7},{s:"name2",t:7}],21420:[{s:"skill_list",t:9,f:[{s:"id",t:2},{s:"cdtime",t:6},{s:"num",t:2}]}],21421:[{s:"code",t:2},{s:"msg",t:7}],21425:[{s:"group",t:2},{s:"cnum",t:2},{s:"win",t:2}],21426:[{s:"cnum_list",t:9,f:[{s:"num",t:2}]},{s:"win_list",t:9,f:[{s:"num",t:2}]}],21427:[{s:"code",t:2},{s:"msg",t:7},{s:"type",t:2},{s:"num",t:2}],21500:[{s:"avatar_frame",t:9,f:[{s:"base_id",t:6},{s:"expire_time",t:6}]}],21501:[{s:"base_id",t:6}],21502:[{s:"avatar_frame",t:9,f:[{s:"base_id",t:6},{s:"expire_time",t:6}]}],21503:[{s:"avatar_frame",t:9,f:[{s:"base_id",t:6},{s:"expire_time",t:6}]}],21504:[{s:"attr",t:9,f:[{s:"key",t:2},{s:"val",t:6}]}],22100:[{s:"step",t:2},{s:"servers",t:9,f:[{s:"srv_id",t:7},{s:"srv_name",t:7},{s:"process_val",t:6}]},{s:"step_reward",t:9,f:[{s:"step",t:2},{s:"status",t:2}]}],22101:[{s:"code",t:2},{s:"msg",t:7},{s:"step",t:2}],22200:[{s:"list",t:9,f:[{s:"id",t:2},{s:"lev",t:2},{s:"exp",t:6},{s:"step",t:2},{s:"all_attr",t:9,f:[{s:"name",t:2},{s:"val",t:6}]}]}],22201:[{s:"id",t:2},{s:"lev",t:2},{s:"exp",t:6},{s:"step",t:2},{s:"all_attr",t:9,f:[{s:"name",t:2},{s:"val",t:6}]}],22202:[{s:"code",t:2},{s:"msg",t:7},{s:"id",t:2}],22203:[{s:"code",t:2},{s:"msg",t:7},{s:"id",t:2}],22204:[{s:"code",t:2},{s:"msg",t:7},{s:"id",t:2}],22205:[{s:"id",t:2}],22700:[{s:"is_cluster",t:2},{s:"rank_list",t:9,f:[{s:"id",t:2},{s:"end_time",t:6}]}],22701:[{s:"id",t:2},{s:"end_time",t:6},{s:"rank",t:2},{s:"rank_list",t:9,f:[{s:"idx",t:2},{s:"name",t:7},{s:"lev",t:2},{s:"face_id",t:6},{s:"avatar_id",t:6},{s:"rid",t:6},{s:"srv_id",t:7}]}],22702:[{s:"feat_list",t:9,f:[{s:"id",t:6},{s:"finish",t:2},{s:"end_time",t:6},{s:"finish_time",t:6},{s:"progress",t:9,f:[{s:"id",t:4},{s:"finish",t:2},{s:"target",t:6},{s:"target_val",t:6},{s:"value",t:6}]}]}],22703:[{s:"feat_list",t:9,f:[{s:"id",t:6},{s:"finish",t:2},{s:"end_time",t:6},{s:"finish_time",t:6},{s:"progress",t:9,f:[{s:"id",t:4},{s:"finish",t:2},{s:"target",t:6},{s:"target_val",t:6},{s:"value",t:6}]}]}],22704:[{s:"result",t:2},{s:"msg",t:7},{s:"quest_id",t:6}],23200:[{s:"recruit_list",t:9,f:[{s:"group_id",t:4},{s:"draw_list",t:9,f:[{s:"times",t:2},{s:"kv_list",t:9,f:[{s:"key",t:6},{s:"val",t:6},{s:"str_val",t:7}]}]}]},{s:"is_share",t:2},{s:"is_day_share",t:2}],23201:[{s:"group_id",t:4},{s:"times",t:2},{s:"flag",t:6},{s:"rewards",t:9,f:[{s:"base_id",t:6},{s:"num",t:6}]},{s:"partner_bids",t:9,f:[{s:"partner_bid",t:6},{s:"init_star",t:2}]},{s:"partner_chips",t:9,f:[{s:"partner_bid",t:6},{s:"chip_bid",t:6},{s:"chip_num",t:6}]}],23202:[{s:"group_id",t:4},{s:"free_cd_end",t:6},{s:"free_times",t:2}],23203:[{s:"code",t:2},{s:"msg",t:7},{s:"is_share",t:2},{s:"is_day_share",t:2}],23204:[{s:"recruit_group",t:9,f:[{s:"group_id",t:4},{s:"draw_list",t:9,f:[{s:"times",t:2},{s:"kv_list",t:9,f:[{s:"key",t:6},{s:"val",t:6},{s:"str_val",t:7}]}]}]}],23205:[{s:"need_times",t:2}],23210:[{s:"fals",t:2},{s:"end_time",t:6},{s:"rewards",t:9,f:[{s:"id",t:6},{s:"num",t:6},{s:"status",t:2}]}],23211:[{s:"code",t:2},{s:"msg",t:7}],23212:[],23213:[{s:"group_id",t:4},{s:"rewards",t:9,f:[{s:"base_id",t:6},{s:"num",t:6}]}],23214:[{s:"partner_id",t:6},{s:"new_partner_bid",t:6},{s:"partner_ids",t:9,f:[{s:"id",t:6}]}],23215:[{s:"code",t:2},{s:"msg",t:7}],23216:[{s:"camp_id",t:6},{s:"free_time",t:6},{s:"times",t:6},{s:"start_time",t:6},{s:"end_time",t:6},{s:"item_id",t:6},{s:"item_num",t:6},{s:"must_count",t:4},{s:"reward_list",t:9,f:[{s:"id",t:4}]}],23217:[{s:"flag",t:2},{s:"msg",t:7}],23218:[{s:"flag",t:2},{s:"msg",t:7}],23219:[{s:"flag",t:2},{s:"msg",t:7}],23220:[{s:"camp_id",t:6},{s:"free_time",t:6},{s:"times",t:6},{s:"start_time",t:6},{s:"end_time",t:6},{s:"item_id",t:6},{s:"item_num",t:6},{s:"must_count",t:4},{s:"reward_list",t:9,f:[{s:"id",t:4}]}],23221:[{s:"flag",t:2},{s:"msg",t:7}],23222:[{s:"flag",t:2},{s:"msg",t:7}],23300:[{s:"base_id",t:6},{s:"honor",t:9,f:[{s:"base_id",t:6},{s:"expire_time",t:6}]}],23301:[{s:"base_id",t:6}],23302:[{s:"honor",t:9,f:[{s:"base_id",t:6},{s:"expire_time",t:6}]}],23303:[{s:"honor",t:9,f:[{s:"base_id",t:6},{s:"expire_time",t:6}]}],23400:[{s:"gifts",t:9,f:[{s:"id",t:2},{s:"status",t:2}]}],23402:[{s:"code",t:2}],23403:[{s:"code",t:2},{s:"msg",t:7},{s:"id",t:2}],23500:[{s:"catalg",t:6},{s:"goods",t:9,f:[{s:"id",t:6},{s:"base_id",t:6},{s:"cur_price",t:6},{s:"margin",t:6}]}],23501:[{s:"flag",t:2}],23502:[{s:"flag",t:2}],23504:[],23505:[{s:"type",t:2},{s:"id",t:2},{s:"status",t:2},{s:"num",t:2}],23506:[{s:"cell_id",t:2},{s:"flag",t:2}],23507:[{s:"free_ids",t:9,f:[{s:"cell_id",t:2}]},{s:"cells",t:9,f:[{s:"cell_id",t:2},{s:"item_base_id",t:6},{s:"num",t:2},{s:"price",t:6},{s:"expiry",t:6},{s:"item_attrs",t:9,f:[{s:"attr",t:2},{s:"value",t:6}]},{s:"status",t:2}]}],23508:[{s:"item_base_id",t:6},{s:"price",t:6}],23509:[{s:"refresh_time",t:6},{s:"data",t:9,f:[{s:"type",t:2},{s:"goods",t:9,f:[{s:"id",t:2},{s:"item_base_id",t:6},{s:"num",t:2},{s:"price",t:6},{s:"status",t:2},{s:"item_attrs",t:9,f:[{s:"attr",t:2},{s:"value",t:6}]}]}]}],23511:[{s:"cell_id",t:2},{s:"flag",t:2}],23512:[{s:"cell_id",t:2},{s:"flag",t:2}],23513:[],23514:[],23516:[{s:"market_price",t:9,f:[{s:"source",t:2},{s:"base_id",t:6},{s:"assets",t:6},{s:"price",t:6}]}],23518:[{s:"goods",t:9,f:[{s:"id",t:6},{s:"base_id",t:6},{s:"cur_price",t:6},{s:"margin",t:6}]}],23519:[],23520:[{s:"limit_data",t:9,f:[{s:"item_id",t:6},{s:"count",t:6}]}],23601:[{s:"reward",t:2},{s:"process",t:6},{s:"double",t:2},{s:"count",t:6}],23602:[{s:"code",t:2},{s:"msg",t:7}],23603:[{s:"code",t:2},{s:"msg",t:7}],23604:[{s:"ext_reward",t:9,f:[{s:"type",t:2},{s:"rate",t:6}]}],23606:[{s:"ref_time",t:6},{s:"camp_type",t:2},{s:"list",t:9,f:[{s:"id",t:2},{s:"price",t:4},{s:"gain",t:6},{s:"num",t:2},{s:"max",t:2}]}],23607:[{s:"code",t:2},{s:"msg",t:7},{s:"id",t:2}],23700:[{s:"career",t:2},{s:"group_id",t:6},{s:"skill_ids",t:9,f:[{s:"skill_id",t:6}]},{s:"group_ids",t:9,f:[{s:"group_id",t:6}]}],23701:[{s:"code",t:2},{s:"msg",t:7},{s:"career",t:2},{s:"skill_id",t:6}],23702:[{s:"career",t:2},{s:"group_id",t:6}],23703:[{s:"outline",t:9,f:[{s:"career",t:2},{s:"skill_id",t:6}]}],23800:[{s:"order_list",t:9,f:[{s:"order_id",t:6},{s:"order_bid",t:6},{s:"status",t:2},{s:"end_time",t:6},{s:"assign_ids",t:9,f:[{s:"partner_id",t:6}]}]},{s:"free_times",t:2},{s:"coin_times",t:6}],23801:[{s:"order_id",t:6},{s:"order_bid",t:6},{s:"status",t:2},{s:"end_time",t:6},{s:"assign_ids",t:9,f:[{s:"partner_id",t:6}]}],23802:[{s:"flag",t:2},{s:"msg",t:7}],23803:[{s:"flag",t:2},{s:"msg",t:7},{s:"order_id",t:6}],23804:[{s:"flag",t:2},{s:"msg",t:7}],23805:[{s:"flag",t:2}],23820:[],23821:[{s:"flag",t:2}],23900:[{s:"max_round",t:4},{s:"current_round",t:4},{s:"day_pass_round",t:4},{s:"my_idx",t:4},{s:"rank_list",t:9,f:[{s:"idx",t:2},{s:"name",t:7},{s:"rid",t:6},{s:"srv_id",t:7},{s:"val",t:6}]},{s:"is_employ",t:2},{s:"list",t:9,f:[{s:"id",t:6},{s:"bid",t:6},{s:"lev",t:4},{s:"star",t:2},{s:"quality",t:2},{s:"power",t:6},{s:"ext_data",t:9,f:[{s:"key",t:6},{s:"val",t:6}]}]},{s:"is_appoint",t:2},{s:"is_reward",t:2}],23901:[{s:"code",t:2},{s:"msg",t:7}],23902:[{s:"round",t:4},{s:"max_round",t:4},{s:"buff_list",t:9,f:[{s:"id",t:6},{s:"group_id",t:4},{s:"count",t:4}]},{s:"rest_round",t:4},{s:"max_reward_round",t:4},{s:"reward_flag",t:2},{s:"acc_reward",t:9,f:[{s:"base_id",t:6},{s:"num",t:6}]},{s:"id",t:6},{s:"status",t:2}],23903:[{s:"id",t:6},{s:"status",t:2}],23904:[{s:"code",t:2},{s:"msg",t:7}],23905:[{s:"list",t:9,f:[{s:"id",t:6},{s:"bid",t:6},{s:"lev",t:4},{s:"star",t:2},{s:"quality",t:2},{s:"power",t:6},{s:"ext_data",t:9,f:[{s:"key",t:6},{s:"val",t:6}]}]}],23906:[{s:"list",t:9,f:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"name",t:7},{s:"id",t:6},{s:"bid",t:6},{s:"lev",t:4},{s:"star",t:2},{s:"quality",t:2},{s:"power",t:6},{s:"ext_data",t:9,f:[{s:"key",t:6},{s:"val",t:6}]}]}],23907:[{s:"list",t:9,f:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"name",t:7},{s:"id",t:6},{s:"bid",t:6},{s:"lev",t:4},{s:"star",t:2},{s:"quality",t:2},{s:"power",t:6},{s:"ext_data",t:9,f:[{s:"key",t:6},{s:"val",t:6}]}]}],23908:[{s:"code",t:2},{s:"msg",t:7},{s:"id",t:6}],23909:[{s:"code",t:2},{s:"msg",t:7}],23910:[{s:"is_select",t:2},{s:"list",t:9,f:[{s:"group_id",t:2},{s:"buff_id",t:4}]},{s:"partner",t:9,f:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"pos",t:2},{s:"id",t:6},{s:"bid",t:6},{s:"lev",t:4},{s:"star",t:2},{s:"quality",t:2},{s:"hp_per",t:2},{s:"use_skin",t:6}]},{s:"formation_type",t:2},{s:"formation_lev",t:2},{s:"round",t:4},{s:"end_time",t:6}],23911:[{s:"code",t:2},{s:"msg",t:7}],24000:[{s:"plunders",t:9,f:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"gid",t:6},{s:"gsrv_id",t:7},{s:"name",t:7},{s:"gname",t:7},{s:"quality",t:2},{s:"end_time",t:6},{s:"plunder_lists",t:9,f:[{s:"rid",t:6},{s:"srv_id",t:7}]}]}],24001:[{s:"result",t:2},{s:"msg",t:7}],24002:[{s:"result",t:2},{s:"msg",t:7}],24003:[{s:"result",t:2},{s:"msg",t:7}],24004:[{s:"result",t:2},{s:"msg",t:7}],24005:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"plunders",t:9,f:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"gid",t:6},{s:"gsrv_id",t:7},{s:"name",t:7},{s:"gname",t:7},{s:"quality",t:2},{s:"end_time",t:6}]}],24006:[{s:"status",t:2},{s:"quality",t:2},{s:"end_time",t:6},{s:"plunder_count",t:6},{s:"datas",t:9,f:[{s:"id",t:2},{s:"val",t:2}]}],24010:[{s:"quality",t:2},{s:"rid",t:6},{s:"srv_id",t:7},{s:"gid",t:6},{s:"gsrv_id",t:7},{s:"name",t:7},{s:"lev",t:4},{s:"face",t:6},{s:"power",t:6},{s:"guild_name",t:7},{s:"formation_type",t:2},{s:"formation_lev",t:2},{s:"p_list",t:9,f:[{s:"pos",t:2},{s:"bid",t:6},{s:"lev",t:4},{s:"quality",t:2},{s:"star",t:2},{s:"break_lev",t:2}]}],24011:[{s:"result",t:2},{s:"msg",t:7}],24012:[{s:"result",t:2},{s:"item_rewards",t:9,f:[{s:"bid",t:6},{s:"num",t:6}]}],24013:[{s:"type",t:2},{s:"logs",t:9,f:[{s:"id",t:6},{s:"quality",t:2},{s:"rid",t:6},{s:"srv_id",t:7},{s:"name",t:7},{s:"guild_name",t:7},{s:"lev",t:4},{s:"sex",t:2},{s:"face",t:6},{s:"power",t:6},{s:"avatar_id",t:6},{s:"ret",t:2},{s:"atk_ret",t:2},{s:"atk_count",t:2},{s:"time",t:6},{s:"help_count",t:6},{s:"help_time",t:6},{s:"items",t:9,f:[{s:"bid",t:6},{s:"num",t:6}]},{s:"replay_id",t:6}]}],24014:[{s:"quality",t:2},{s:"id",t:6},{s:"type",t:2},{s:"rid",t:6},{s:"srv_id",t:7},{s:"name",t:7},{s:"lev",t:4},{s:"face",t:6},{s:"avatar_id",t:6},{s:"power",t:6},{s:"guild_name",t:7},{s:"formation_type",t:2},{s:"formation_lev",t:2},{s:"p_list",t:9,f:[{s:"pos",t:2},{s:"bid",t:6},{s:"lev",t:4},{s:"quality",t:2},{s:"star",t:2},{s:"break_lev",t:2}]}],24015:[{s:"result",t:2},{s:"msg",t:7}],24017:[{s:"code",t:2},{s:"msg",t:7}],24018:[{s:"id",t:6},{s:"quality",t:2},{s:"rid",t:6},{s:"srv_id",t:7},{s:"name",t:7},{s:"guild_name",t:7},{s:"lev",t:4},{s:"sex",t:2},{s:"face",t:6},{s:"power",t:6},{s:"avatar_id",t:6},{s:"ret",t:2},{s:"atk_ret",t:2},{s:"atk_count",t:2},{s:"time",t:6},{s:"help_count",t:6},{s:"help_time",t:6},{s:"items",t:9,f:[{s:"bid",t:6},{s:"num",t:6}]},{s:"replay_id",t:6}],24019:[{s:"plunders",t:9,f:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"gid",t:6},{s:"gsrv_id",t:7},{s:"name",t:7},{s:"gname",t:7},{s:"quality",t:2},{s:"end_time",t:6}]}],24020:[{s:"code",t:2}],24100:[{s:"hallows",t:9,f:[{s:"id",t:6},{s:"step",t:6},{s:"lucky",t:6},{s:"lucky_endtime",t:6},{s:"seal",t:6},{s:"add_attr",t:9,f:[{s:"attr_id",t:6},{s:"attr_val",t:6}]},{s:"skill",t:9,f:[{s:"lev",t:6},{s:"skill_bid",t:6}]},{s:"look_id",t:6}]}],24101:[{s:"result",t:2},{s:"msg",t:7},{s:"id",t:6}],24103:[{s:"result",t:2},{s:"msg",t:7},{s:"hallows_id",t:6}],24104:[{s:"result",t:2},{s:"msg",t:7},{s:"id",t:6}],24107:[{s:"id",t:6},{s:"step",t:6},{s:"lucky",t:6},{s:"lucky_endtime",t:6},{s:"seal",t:6},{s:"add_attr",t:9,f:[{s:"attr_id",t:6},{s:"attr_val",t:6}]},{s:"skill",t:9,f:[{s:"lev",t:6},{s:"skill_bid",t:6}]},{s:"look_id",t:6}],24108:[{s:"id",t:6},{s:"step",t:6},{s:"lucky",t:6},{s:"lucky_endtime",t:6},{s:"seal",t:6},{s:"add_attr",t:9,f:[{s:"attr_id",t:6},{s:"attr_val",t:6}]},{s:"skill",t:9,f:[{s:"lev",t:6},{s:"skill_bid",t:6}]},{s:"look_id",t:6}],24120:[{s:"list",t:9,f:[{s:"id",t:6},{s:"finish",t:2},{s:"target_val",t:6},{s:"value",t:6}]}],24121:[{s:"list",t:9,f:[{s:"id",t:6},{s:"finish",t:2},{s:"target_val",t:6},{s:"value",t:6}]}],24122:[{s:"code",t:2},{s:"msg",t:7}],24123:[{s:"code",t:2},{s:"msg",t:7}],24124:[{s:"is_first",t:2}],24125:[{s:"hallows_looks",t:9,f:[{s:"id",t:6},{s:"endtime",t:6},{s:"eqm_hallows",t:6}]}],24126:[{s:"id",t:6},{s:"endtime",t:6},{s:"eqm_hallows",t:6}],24127:[{s:"id",t:6},{s:"endtime",t:6},{s:"eqm_hallows",t:6}],24128:[{s:"list",t:9,f:[{s:"id",t:6},{s:"finish",t:2},{s:"target_val",t:6},{s:"value",t:6}]}],24129:[{s:"list",t:9,f:[{s:"id",t:6},{s:"finish",t:2},{s:"target_val",t:6},{s:"value",t:6}]}],24130:[{s:"code",t:2},{s:"msg",t:7}],24131:[{s:"code",t:2},{s:"msg",t:7}],24132:[{s:"code",t:2},{s:"msg",t:7}],24133:[{s:"id",t:6}],24200:[{s:"count",t:6},{s:"result",t:2},{s:"ranks",t:9,f:[{s:"rank",t:6},{s:"name",t:7}]},{s:"gname1",t:7},{s:"hp1",t:4},{s:"buff_lev1",t:4},{s:"gname2",t:7},{s:"g_id",t:6},{s:"g_sid",t:7},{s:"hp2",t:4},{s:"defense",t:9,f:[{s:"pos",t:2},{s:"rid",t:6},{s:"srv_id",t:7},{s:"name",t:7},{s:"lev",t:4},{s:"face",t:6},{s:"power",t:6},{s:"hp",t:4},{s:"hp_max",t:4},{s:"relic_def_count",t:4},{s:"status",t:2}]}],24201:[{s:"pos",t:6},{s:"rid",t:6},{s:"srv_id",t:7},{s:"name",t:7},{s:"lev",t:4},{s:"face",t:6},{s:"power",t:6},{s:"formation_type",t:4},{s:"formation_lev",t:4},{s:"hp",t:4},{s:"hp_max",t:4},{s:"def_count",t:4},{s:"relic_def_count",t:4},{s:"defense",t:9,f:[{s:"pos",t:2},{s:"bid",t:6},{s:"lev",t:4},{s:"star",t:2}]}],24202:[{s:"code",t:2},{s:"msg",t:7},{s:"count",t:6}],24203:[{s:"result",t:2},{s:"timer",t:6},{s:"item_rewards",t:9,f:[{s:"bid",t:6},{s:"num",t:6}]}],24204:[{s:"status",t:2},{s:"flag",t:2},{s:"start_time",t:6},{s:"end_time",t:6}],24205:[{s:"match_info",t:9,f:[{s:"g_id1",t:6},{s:"g_sid1",t:7},{s:"srv_name1",t:7},{s:"guild_name1",t:7},{s:"rank1",t:6},{s:"g_id2",t:6},{s:"g_sid2",t:7},{s:"srv_name2",t:7},{s:"guild_name2",t:7},{s:"rank2",t:6},{s:"status",t:2},{s:"g_id",t:6},{s:"g_sid",t:7}]}],24206:[{s:"flag",t:2},{s:"defense",t:9,f:[{s:"pos",t:2},{s:"rid",t:6},{s:"srv_id",t:7},{s:"name",t:7},{s:"lev",t:4},{s:"face",t:6},{s:"power",t:6},{s:"hp",t:4},{s:"hp_max",t:4},{s:"relic_def_count",t:4},{s:"status",t:2}]}],24207:[{s:"ranks",t:9,f:[{s:"rank",t:6},{s:"name",t:7}]},{s:"hp",t:4},{s:"buff_lev",t:4},{s:"hp2",t:4}],24208:[{s:"hp",t:4},{s:"defense",t:9,f:[{s:"pos",t:2},{s:"rid",t:6},{s:"srv_id",t:7},{s:"name",t:7},{s:"lev",t:4},{s:"face",t:6},{s:"power",t:6},{s:"hp",t:4},{s:"hp_max",t:4},{s:"relic_def_count",t:4},{s:"status",t:2}]}],24209:[{s:"power",t:6},{s:"formation_type",t:6},{s:"formation_lev",t:6},{s:"defense",t:9,f:[{s:"pos",t:2},{s:"bid",t:6},{s:"lev",t:4},{s:"star",t:2}]},{s:"guild_war_role_log",t:9,f:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"name",t:7},{s:"lev",t:4},{s:"face",t:6},{s:"power",t:6},{s:"time",t:6},{s:"repaly_id",t:6},{s:"hp",t:4},{s:"result",t:2},{s:"formation_type",t:6},{s:"formation_lev",t:6},{s:"defense",t:9,f:[{s:"pos",t:2},{s:"bid",t:6},{s:"lev",t:4},{s:"star",t:2}]}]}],24210:[],24212:[{s:"guild_war_log",t:9,f:[{s:"flag1",t:2},{s:"flag2",t:2},{s:"time",t:6},{s:"rid1",t:6},{s:"srv_id1",t:7},{s:"name1",t:7},{s:"rid2",t:6},{s:"srv_id2",t:7},{s:"name2",t:7},{s:"rid",t:6},{s:"srv_id",t:7},{s:"gname",t:7},{s:"int_args",t:9,f:[{s:"key",t:6},{s:"val",t:6}]},{s:"str_args",t:9,f:[{s:"key",t:6},{s:"val",t:7}]}]}],24213:[{s:"ranks",t:9,f:[{s:"rank",t:6},{s:"rid",t:6},{s:"srv_id",t:7},{s:"face",t:6},{s:"lev",t:6},{s:"name",t:7},{s:"star",t:6},{s:"war_score",t:6}]}],24214:[{s:"result",t:2}],24220:[{s:"result",t:2},{s:"end_time",t:6},{s:"status",t:2},{s:"guild_war_box",t:9,f:[{s:"order",t:4},{s:"rid",t:6},{s:"sid",t:7},{s:"name",t:7},{s:"item_id",t:6},{s:"item_num",t:6}]}],24221:[{s:"result",t:2},{s:"msg",t:7}],24223:[{s:"order",t:4},{s:"rid",t:6},{s:"sid",t:7},{s:"name",t:7},{s:"item_id",t:6},{s:"item_num",t:6}],24300:[{s:"rank",t:4},{s:"best_rank",t:4},{s:"can_combat_num",t:2},{s:"buy_combat_num",t:2},{s:"ref_time",t:5},{s:"combat_time",t:5}],24301:[{s:"f_list",t:9,f:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"idx",t:2},{s:"name",t:7},{s:"lev",t:4},{s:"sex",t:2},{s:"face",t:6},{s:"power",t:6},{s:"rank",t:6},{s:"look",t:6}]},{s:"type",t:2}],24302:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"name",t:7},{s:"lev",t:4},{s:"vip_lev",t:2},{s:"face",t:6},{s:"sex",t:2},{s:"power",t:6},{s:"rank",t:6},{s:"gname",t:7},{s:"avatar_id",t:6},{s:"formation_type",t:2},{s:"formation_lev",t:2},{s:"p_list",t:9,f:[{s:"pos",t:2},{s:"id",t:6},{s:"bid",t:6},{s:"lev",t:4},{s:"quality",t:2},{s:"star",t:2},{s:"is_robot",t:2}]}],24303:[{s:"code",t:2},{s:"msg",t:7}],24304:[{s:"code",t:2},{s:"msg",t:7}],24305:[{s:"code",t:2},{s:"msg",t:7}],24306:[{s:"code",t:2},{s:"msg",t:7}],24307:[{s:"result",t:2},{s:"rid",t:6},{s:"srv_id",t:7},{s:"def_name",t:7},{s:"def_lev",t:6},{s:"def_face",t:6},{s:"def_change_rank",t:5},{s:"def_rank",t:6},{s:"is_change_best_rank",t:6},{s:"atk_change_rank",t:5},{s:"atk_rank",t:6},{s:"reward",t:9,f:[{s:"bid",t:6},{s:"num",t:6}]},{s:"target_role_name",t:7},{s:"hurt_statistics",t:9,f:[{s:"type",t:2},{s:"partner_hurts",t:9,f:[{s:"rid",t:6},{s:"srvid",t:7},{s:"id",t:6},{s:"bid",t:6},{s:"star",t:6},{s:"lev",t:6},{s:"camp_type",t:6},{s:"dps",t:6},{s:"cure",t:6}]}]}],24308:[{s:"rank_list",t:9,f:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"name",t:7},{s:"gname",t:7},{s:"rank",t:6},{s:"lookid",t:6},{s:"worship",t:6},{s:"worship_status",t:2}]}],24309:[{s:"rank",t:4},{s:"best_rank",t:4},{s:"rank_list",t:9,f:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"name",t:7},{s:"gname",t:7},{s:"lev",t:4},{s:"face",t:6},{s:"sex",t:2},{s:"rank",t:4},{s:"power",t:6},{s:"avatar_id",t:6}]}],24310:[{s:"replay_srv_id",t:7},{s:"log_list",t:9,f:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"name",t:7},{s:"lev",t:4},{s:"sex",t:2},{s:"face",t:6},{s:"avatar_id",t:6},{s:"power",t:6},{s:"type",t:2},{s:"ret",t:2},{s:"rank_type",t:2},{s:"rank",t:6},{s:"replay_id",t:6},{s:"time",t:6}]}],24311:[{s:"replay_srv_id",t:7},{s:"log_list",t:9,f:[{s:"atk_rid",t:6},{s:"atk_srv_id",t:7},{s:"atk_name",t:7},{s:"atk_face",t:6},{s:"atk_rank",t:6},{s:"def_rid",t:6},{s:"def_srv_id",t:7},{s:"def_name",t:7},{s:"def_face",t:6},{s:"def_rank",t:6},{s:"ret",t:2},{s:"replay_id",t:6},{s:"time",t:6}]}],24312:[{s:"code",t:2}],24313:[{s:"code",t:2}],24314:[{s:"code",t:2}],24315:[{s:"code",t:2},{s:"msg",t:7}],24316:[{s:"code",t:2},{s:"msg",t:7}],24400:[{s:"guard_id",t:6},{s:"reward",t:9,f:[{s:"reward_id",t:6}]},{s:"rewards",t:9,f:[{s:"bid",t:6},{s:"num",t:6}]}],24401:[{s:"id",t:2},{s:"rid",t:6},{s:"srv_id",t:7},{s:"name",t:7},{s:"face",t:6},{s:"lev",t:2},{s:"power",t:6},{s:"guards",t:9,f:[{s:"pos",t:2},{s:"bid",t:6},{s:"lev",t:4},{s:"star",t:2},{s:"hp_per",t:2},{s:"ext_data",t:9,f:[{s:"key",t:6},{s:"val",t:6}]}]},{s:"rewards",t:9,f:[{s:"bid",t:6},{s:"num",t:6}]},{s:"is_holiday",t:2},{s:"status",t:2}],24402:[{s:"code",t:2},{s:"msg",t:7},{s:"id",t:2}],24403:[{s:"code",t:2},{s:"msg",t:7}],24404:[{s:"list",t:9,f:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"name",t:7},{s:"id",t:6},{s:"bid",t:6},{s:"lev",t:4},{s:"star",t:2},{s:"power",t:6},{s:"ext_data",t:9,f:[{s:"key",t:6},{s:"val",t:6}]}]}],24405:[{s:"list",t:9,f:[{s:"id",t:6}]}],24406:[{s:"list",t:9,f:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"name",t:7},{s:"id",t:6},{s:"bid",t:6},{s:"lev",t:4},{s:"star",t:2},{s:"power",t:6},{s:"is_employ",t:2},{s:"ext_data",t:9,f:[{s:"key",t:6},{s:"val",t:6}]}]}],24407:[{s:"code",t:2},{s:"msg",t:7},{s:"id",t:6}],24408:[{s:"code",t:2},{s:"msg",t:7}],24409:[{s:"list",t:9,f:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"name",t:7},{s:"id",t:6},{s:"bid",t:6},{s:"lev",t:4},{s:"star",t:2},{s:"power",t:6},{s:"is_used",t:2},{s:"hp_per",t:2},{s:"ext_data",t:9,f:[{s:"key",t:6},{s:"val",t:6}]}]},{s:"p_list",t:9,f:[{s:"id",t:6},{s:"hp_per",t:2}]}],24410:[{s:"is_show",t:2}],24411:[{s:"is_show",t:2}],24500:[{s:"list",t:9,f:[{s:"id",t:2},{s:"status",t:2},{s:"expire_time",t:6}]}],24501:[{s:"code",t:2},{s:"msg",t:7}],24502:[{s:"list",t:9,f:[{s:"id",t:6},{s:"status",t:2},{s:"expire_time",t:6}]}],24600:[{s:"status",t:2},{s:"start_time",t:6},{s:"end_time",t:6},{s:"flag",t:2}],24601:[{s:"id",t:6},{s:"title",t:7},{s:"memo",t:7},{s:"rewards",t:9,f:[{s:"bid",t:6},{s:"bind",t:2},{s:"num",t:6}]}],24602:[{s:"questionnaire_list",t:9,f:[{s:"id",t:6},{s:"title",t:7},{s:"sort",t:4},{s:"topic_type",t:2},{s:"specific_type",t:2},{s:"must",t:2},{s:"jump",t:2},{s:"topic",t:6},{s:"option",t:7},{s:"option_list",t:7}]}],24603:[{s:"code",t:2},{s:"msg",t:7}],24604:[{s:"code",t:2},{s:"msg",t:7}],24700:[{s:"ids",t:9,f:[{s:"id",t:6},{s:"status",t:2}]}],24701:[{s:"id",t:6},{s:"current_day",t:4},{s:"group_id",t:4},{s:"endtime",t:6},{s:"status",t:2}],24702:[{s:"code",t:2},{s:"msg",t:7}],24801:[{s:"all_num",t:6},{s:"award_list",t:9,f:[{s:"id",t:2},{s:"flag",t:2}]}],24802:[{s:"flag",t:2},{s:"msg",t:7},{s:"count",t:6},{s:"rand_list",t:9,f:[{s:"rand_id",t:6},{s:"status",t:2}]}],24803:[{s:"flag",t:2},{s:"msg",t:7}],24804:[{s:"lev",t:6},{s:"exp",t:6},{s:"camp_id",t:6},{s:"group_id",t:6},{s:"combat_num",t:4},{s:"start_time",t:6},{s:"end_time",t:6},{s:"show_list",t:9,f:[{s:"show_id",t:2},{s:"num",t:6}]},{s:"make_list",t:9,f:[{s:"id",t:6},{s:"num",t:6}]}],24805:[{s:"lev",t:6},{s:"reward_list",t:9,f:[{s:"id",t:4}]}],24806:[{s:"flag",t:2},{s:"msg",t:7}],24807:[{s:"flag",t:2},{s:"msg",t:7}],24808:[{s:"flag",t:2},{s:"msg",t:7}],24809:[{s:"flag",t:2},{s:"msg",t:7},{s:"combat_num",t:4}],24810:[{s:"quest_list",t:9,f:[{s:"id",t:6},{s:"finish",t:2},{s:"end_time",t:6},{s:"finish_time",t:6},{s:"progress",t:9,f:[{s:"id",t:4},{s:"finish",t:2},{s:"target",t:6},{s:"target_val",t:6},{s:"value",t:6}]}]},{s:"camp_id",t:6}],24811:[{s:"id",t:6},{s:"finish",t:2},{s:"end_time",t:6},{s:"finish_time",t:6},{s:"progress",t:9,f:[{s:"id",t:4},{s:"finish",t:2},{s:"target",t:6},{s:"target_val",t:6},{s:"value",t:6}]}],24812:[{s:"code",t:2},{s:"msg",t:7},{s:"id",t:6}],24813:[{s:"quest_list",t:9,f:[{s:"id",t:6},{s:"finish",t:2},{s:"end_time",t:6},{s:"finish_time",t:6},{s:"progress",t:9,f:[{s:"id",t:4},{s:"finish",t:2},{s:"target",t:6},{s:"target_val",t:6},{s:"value",t:6}]}]},{s:"camp_id",t:6}],24814:[{s:"code",t:2},{s:"msg",t:7},{s:"id",t:6}],24815:[{s:"quest_list",t:9,f:[{s:"id",t:6},{s:"finish",t:2},{s:"end_time",t:6},{s:"finish_time",t:6},{s:"progress",t:9,f:[{s:"id",t:4},{s:"finish",t:2},{s:"target",t:6},{s:"target_val",t:6},{s:"value",t:6}]}]},{s:"camp_id",t:6}],24816:[{s:"code",t:2},{s:"msg",t:7},{s:"id",t:6}],24817:[{s:"quest_list",t:9,f:[{s:"id",t:6},{s:"finish",t:2},{s:"end_time",t:6},{s:"finish_time",t:6},{s:"progress",t:9,f:[{s:"id",t:4},{s:"finish",t:2},{s:"target",t:6},{s:"target_val",t:6},{s:"value",t:6}]}]},{s:"camp_id",t:6}],24818:[{s:"code",t:2},{s:"msg",t:7},{s:"id",t:6}],25100:[{s:"state",t:2},{s:"quests",t:9,f:[{s:"id",t:6},{s:"val",t:6},{s:"status",t:2}]},{s:"end_time",t:6}],25101:[{s:"code",t:2},{s:"msg",t:7}],25102:[{s:"flag",t:2},{s:"msg",t:7}],25300:[{s:"period",t:2},{s:"cur_day",t:6},{s:"end_time",t:6},{s:"lev",t:6},{s:"exp",t:6},{s:"rmb_status",t:2},{s:"exp_status",t:2},{s:"list",t:9,f:[{s:"id",t:6},{s:"type",t:2},{s:"finish",t:2},{s:"target_val",t:6},{s:"value",t:6},{s:"end_time",t:6}]}],25301:[{s:"list",t:9,f:[{s:"id",t:6},{s:"type",t:2},{s:"finish",t:2},{s:"target_val",t:6},{s:"value",t:6},{s:"end_time",t:6}]}],25302:[{s:"code",t:2},{s:"msg",t:7}],25303:[{s:"lev",t:6},{s:"reward_list",t:9,f:[{s:"id",t:4},{s:"status",t:2},{s:"rmb_status",t:2}]}],25304:[{s:"flag",t:2},{s:"msg",t:7}],25305:[{s:"lev",t:6},{s:"exp",t:6}],25306:[{s:"rmb_status",t:2},{s:"exp_status",t:2},{s:"list",t:9,f:[{s:"id",t:6},{s:"status",t:2}]}],25307:[{s:"flag",t:2},{s:"msg",t:7}],25308:[{s:"flag",t:2},{s:"msg",t:7}],25309:[{s:"is_pop",t:2},{s:"cur_day",t:6}],25400:[{s:"order",t:2},{s:"score",t:6},{s:"rank",t:6},{s:"count",t:2}],25401:[{s:"order",t:2},{s:"score",t:6},{s:"rank",t:6},{s:"count",t:2},{s:"buy_count",t:2},{s:"hp_per",t:6},{s:"award_info",t:9,f:[{s:"award_id",t:6}]}],25402:[{s:"code",t:2},{s:"msg",t:7},{s:"count",t:2},{s:"buy_count",t:2}],25403:[{s:"code",t:2},{s:"msg",t:7},{s:"award_info",t:9,f:[{s:"award_id",t:6}]}],25404:[{s:"code",t:2},{s:"msg",t:7}],25405:[{s:"result",t:2},{s:"dps_score",t:6},{s:"kill_score",t:6},{s:"all_dps",t:6},{s:"best_partner",t:6},{s:"target_role_name",t:7},{s:"hurt_statistics",t:9,f:[{s:"type",t:2},{s:"partner_hurts",t:9,f:[{s:"rid",t:6},{s:"srvid",t:7},{s:"id",t:6},{s:"bid",t:6},{s:"star",t:6},{s:"lev",t:6},{s:"camp_type",t:6},{s:"dps",t:6},{s:"cure",t:6},{s:"ext_data",t:9,f:[{s:"key",t:6},{s:"val",t:6}]}]}]}],25410:[{s:"round",t:2},{s:"difficulty",t:2},{s:"order",t:2},{s:"order_type",t:2},{s:"round_combat",t:6},{s:"round_boss",t:6},{s:"count",t:2},{s:"buy_count",t:2},{s:"endtime",t:6},{s:"hp_per",t:6},{s:"status",t:2}],25411:[{s:"code",t:2},{s:"msg",t:7},{s:"count",t:2},{s:"buy_count",t:2}],25412:[{s:"code",t:2},{s:"msg",t:7}],25413:[{s:"code",t:2},{s:"msg",t:7}],25414:[{s:"p_list",t:9,f:[{s:"id",t:6},{s:"count",t:2}]}],25800:[{s:"code",t:2},{s:"msg",t:7},{s:"city_id",t:6}],25801:[{s:"code",t:2},{s:"msg",t:7},{s:"flag",t:2}],25802:[{s:"rank",t:4},{s:"rank_list",t:9,f:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"name",t:7},{s:"lev",t:4},{s:"face",t:6},{s:"rank",t:4},{s:"avatar_bid",t:6},{s:"fans_num",t:6}]}],25805:[{s:"code",t:2},{s:"msg",t:7},{s:"pos",t:2},{s:"id",t:6}],25806:[{s:"point",t:6},{s:"honor_badges",t:9,f:[{s:"id",t:6},{s:"time",t:6}]},{s:"use_badges",t:9,f:[{s:"pos",t:2},{s:"id",t:6}]}],25807:[{s:"id",t:6}],25810:[{s:"feat_list",t:9,f:[{s:"id",t:6},{s:"finish",t:2},{s:"end_time",t:6},{s:"finish_time",t:6},{s:"progress",t:9,f:[{s:"id",t:4},{s:"finish",t:2},{s:"target",t:6},{s:"target_val",t:6},{s:"value",t:6}]}]},{s:"finish_list",t:9,f:[{s:"id",t:6},{s:"finish_time",t:6}]}],25811:[{s:"feat_list",t:9,f:[{s:"id",t:6},{s:"finish",t:2},{s:"end_time",t:6},{s:"finish_time",t:6},{s:"progress",t:9,f:[{s:"id",t:4},{s:"finish",t:2},{s:"target",t:6},{s:"target_val",t:6},{s:"value",t:6}]}]}],25812:[{s:"code",t:2},{s:"msg",t:7},{s:"id",t:6},{s:"finish_time",t:6}],25813:[],25814:[{s:"result",t:2}],25815:[{s:"result",t:2},{s:"msg",t:7}],25816:[{s:"id",t:6},{s:"finish_time",t:6},{s:"share_id",t:6}],25817:[{s:"result",t:2},{s:"msg",t:7}],25818:[{s:"id",t:6},{s:"finish_time",t:6},{s:"share_id",t:6}],25819:[{s:"result",t:2},{s:"msg",t:7}],25820:[{s:"point",t:6},{s:"num",t:6},{s:"share_id",t:6}],25830:[{s:"start",t:4},{s:"num",t:2},{s:"max_num",t:6},{s:"progress",t:9,f:[{s:"id",t:6},{s:"order",t:6},{s:"time",t:6},{s:"arge",t:9,f:[{s:"pos",t:2},{s:"val",t:7}]}]}],25831:[{s:"result",t:2},{s:"msg",t:7}],25832:[{s:"rid",t:6},{s:"srv_id",t:7},{s:"start",t:4},{s:"num",t:2},{s:"max_num",t:4},{s:"room_grow_info",t:9,f:[{s:"id",t:6},{s:"order",t:6},{s:"time",t:6},{s:"arge",t:9,f:[{s:"pos",t:2},{s:"val",t:7}]}]}],25835:[{s:"result",t:2},{s:"msg",t:7}],25836:[{s:"result",t:2},{s:"msg",t:7}],25837:[{s:"result",t:2},{s:"msg",t:7},{s:"rid",t:6},{s:"srv_id",t:7},{s:"start",t:4},{s:"num",t:2},{s:"max_num",t:6},{s:"room_bbs_info",t:9,f:[{s:"bbs_id",t:6},{s:"bbs_type",t:6},{s:"reply_name",t:7},{s:"msg",t:7},{s:"time",t:6},{s:"rid",t:6},{s:"srv_id",t:7},{s:"face_id",t:6},{s:"avatar_id",t:6},{s:"lev",t:4},{s:"sex",t:2},{s:"name",t:7}]}],25838:[{s:"result",t:2},{s:"msg",t:7},{s:"bbs_id",t:6}],25839:[{s:"result",t:2},{s:"msg",t:7},{s:"type",t:2}],25840:[],25841:[{s:"max_num",t:6},{s:"rid",t:6},{s:"srv_id",t:7},{s:"room_bbs_info",t:9,f:[{s:"bbs_id",t:6},{s:"bbs_type",t:6},{s:"reply_name",t:7},{s:"msg",t:7},{s:"time",t:6},{s:"rid",t:6},{s:"srv_id",t:7},{s:"face_id",t:6},{s:"avatar_id",t:6},{s:"lev",t:4},{s:"sex",t:2},{s:"name",t:7}]}],30001:[{s:"id",t:6},{s:"finish",t:2},{s:"target_val",t:6},{s:"value",t:6}],30002:[{s:"code",t:2},{s:"msg",t:7}],30100:[{s:"flag",t:2},{s:"msg",t:7}],30101:[{s:"code",t:2}],30102:[{s:"code",t:2}]},cc._RF.pop()},{}],qq_sdk:[function(t,e,i){"use strict";cc._RF.push(e,"5c5bd9NS+JOaLaYqbUdHfeN","qq_sdk"),window.PACKAGE_NAME="\u95ea\u70c1\u4e4b\u5149\u53e3\u888b\u7248";var s=t("login_controller"),n=t("role_controller"),a=t("vip_event"),o=function(){};o.account_info=null,o.user_info=null,o.initSDK=function(){console.log("QQSDK\u76f8\u5173"),console.log(window),window.qq&&(this.initTopInfo(),window.CHANNEL="h5youyi_qq",window.PLATFORM_NAME="wb",window.PLATFORM="wb",qq.setKeepScreenOn({keepScreenOn:!0}),qq.onShow(function(t){qq.setKeepScreenOn({keepScreenOn:!0})}),qq.onHide(function(t){qq.setKeepScreenOn({keepScreenOn:!1})}),qq.showShareMenu({showShareItems:["qq","qzone","wechatFriends","wechatMoment"],success:function(){qq.onShareAppMessage(function(){return{imageUrl:"https://s2.ax1x.com/2019/09/21/nvzZlj.png"}})}}),qq.getSetting({success:function(t){if(cc.log(t),t.authSetting["scope.userInfo"])o.checkLoginStatus();else{var e=qq.getSystemInfoSync(),i=qq.createUserInfoButton({type:"text",text:"",style:{left:0,top:e.screenHeight/2,width:e.screenWidth,height:e.screenHeight/2,lineHeight:0,backgroundColor:"",color:"#ffffff",textAlign:"center",fontSize:16,borderRadius:4}});i.show(),i.onTap(function(t){i.hide(),o.checkLoginStatus(),console.log(t)})}}}))},o.initTopInfo=function(){var t=qq.getMenuButtonBoundingClientRect(),e=qq.getSystemInfoSync();t.top>30?window.WX_FIT=t.top/e.screenHeight*.7||0:window.WX_FIT=t.top/e.screenHeight*.1||0,console.log("QQ\u5c0f\u6e38\u620f\u83dc\u5355\u680f\u7684\u9002\u914d\u503c"),cc.log(WX_FIT)},o.checkLoginStatus=function(){try{var t=this.account_info=qq.getStorageSync("account_info");t?o.checkSessionKey(t):o.login()}catch(t){}},o.login=function(){window.qq&&qq.login({success:function(t){t.code?(cc.log("\u521d\u59cb\u5316\u767b\u5f55\u4fe1\u606f\u8fd4\u56de"),cc.log(t),qq.request({url:"https://s1-wb-h5sszg.shiyuegame.com/api.php/pf/qq/login",method:"POST",data:{js_code:t.code,cps:"qqtest"},header:{"content-type":"application/json"},success:function(t){if(cc.log("\u670d\u52a1\u5668\u767b\u5f55\u4fe1\u606f\u8fd4\u56de"),cc.log(t),t&&t.data&&666==t.data.error)try{console.log("\u4fdd\u5b58\u7528\u6237\u4fe1\u606f\u5230\u672c\u5730"),cc.log(t.data.msg),o.account_info=t.data.msg,qq.setStorageSync("account_info",t.data.msg),o.initUserInfo()}catch(t){}}})):console.log("\u767b\u5f55\u5931\u8d25\uff01"+t.errMsg)}})},o.checkSessionKey=function(t){cc.log("\u6821\u9a8ckey\u662f\u5426\u8fc7\u671f"),qq.checkSession({success:function(){o.initUserInfo()},fail:function(){o.login()}})},o.initUserInfo=function(){qq.getUserInfo({success:function(t){o.user_info=t,cc.log("\u83b7\u53d6\u7528\u6237\u4fe1\u606f\u6210\u529f"),cc.log(t),o.setLoginData(t)},fail:function(t){cc.log("\u83b7\u53d6\u7528\u6237\u4fe1\u606f\u5931\u8d25")}})},o.setLoginData=function(t){this.user_info=t,this.sdkBackLogin()},o.sdkBackLogin=function(){var t={};t.usrName="qq_"+this.account_info.openid,t.password="qq123456",console.log("QQ\u6570\u636e\u521d\u59cb\u82b1\u6210\u529f\uff0c\u5f00\u59cb\u8bf7\u6c42\u670d\u52a1\u5668\u5217\u8868"),s.getInstance().loginPlatformRequest(t)},o.loginGame=function(){var t=s.getInstance().getTestAccount();cc.log("\u4f7f\u7528\u4e86QQ\u6d4b\u8bd5\u8d26\u53f7"),cc.log(t);var e={};e.account=t||"qq_"+this.account_info.openid,e.rawData=this.user_info.rawData,e.signature=this.user_info.signature,e.channel=CHANNEL,e.package_name=PACKAGE_NAME,e.package_version=PACKAGE_VERSION,e.platform=PLATFORM,e.token=o.account_info.session_key,e.timestamp=o.account_info.time,e.sign=o.account_info.sign,s.getInstance().cusSDKLogin(e)},o.submitLogin=function(t){if(t){var e="https://"+t+"/api.php/pf/qq/session";console.log(e),console.log(o.account_info),qq.request({url:e,method:"POST",data:{session_key:o.account_info.session_key,openid:o.account_info.openid,time:o.account_info.time,sign:o.account_info.sign,cps:"qqtest"},header:{"content-type":"application/json"},success:function(t){cc.log("\u670d\u52a1\u5668\u767b\u5f55\u4fe1\u606f\u8fd4\u56de"),cc.log(t),t&&t.data&&(console.log(t.data),t.data.error)}})}},o.getCurrChannel=function(){},o.canvasToTempFilePath=function(){var t=cc.game.canvas;t.toTempFilePath({x:0,y:510*t.height/1280,width:t.width,height:550*t.height/1280,destWidth:500,destHeight:400,fileType:"jpg",success:function(t){qq.shareAppMessage({imageUrl:t.tempFilePath})},fail:function(t){qq.shareAppMessage({imageUrl:"https://s2.ax1x.com/2019/09/21/nvzZlj.png"})}})},o.getSubChannel=function(){},o.checkBalance=function(){var t=s.getInstance().model.getLoginInfo(),e={openid:this.account_info.openid,time:o.account_info.time,sign:o.account_info.sign,cps:"qqtest"};qq.request({url:"https://"+t.host+"/api.php/pf/qq/balance",method:"POST",data:e,header:{"content-type":"application/json"},success:function(t){if(t&&t.data&&666==t.data.error)try{t.data.msg&&gcore.GlobalEvent.fire(a.UPDATA_QQ_BALANCE,t.data.msg.remainder)}catch(t){}}})},o.pay=function(e,i,a,l,r,c,_){var h=function(){var i=s.getInstance().model.getLoginInfo(),r=n.getInstance().getRoleVo();if(null!=r){var c=r.srv_id.split("_"),_=c[0]||"",h=c[1],d=qq.getSystemInfoSync().system,u="";d.indexOf("iOS")>-1||d.indexOf("Android")>-1&&(u="qq_m_qq-2001-android-2011");var m=Math.ceil(Date.now()/1e3);l=l||10*e+"\u94bb\u77f3";var f=CHANNEL,p=r.rid+"$$"+_+"$$"+h+"$$"+f+"$$"+a+"$$"+l+"$$qqtest$$"+m;cc.log("\u62d3\u5c55\u53c2\u6570_extension==>",p),p=t("base64").Base64.encode(p),qq.request({url:"https://"+i.host+"/api.php/pf/qq/pre_pay",method:"POST",data:{openid:this.account_info.openid,zone_id:h,pf:u,amt:10*e,good_num:1,time:o.account_info.time,sign:o.account_info.sign,app_remark:p,cps:"qqtest"},header:{"content-type":"application/json"},success:function(t){if(console.log("\u9884\u4e0b\u5355\u8fd4\u56de"),console.log(t),t&&t.data&&666==t.data.error)try{qq.requestMidasPayment({prepayId:t.data.msg.prepayId,starCurrency:10*e,success:function(t){console.log("\u652f\u4ed8\u56de\u8c03\u6210\u529f",t)},fail:function(t){console.log("\u652f\u4ed8\u56de\u8c03\u5931\u8d25",t)},complete:function(t){console.log("\u652f\u4ed8\u56de\u8c03complete",t)}})}catch(t){}}})}}.bind(this);t("tips_controller").getInstance().showFirstCharge(h)},e.exports=o,cc._RF.pop()},{base64:"base64",login_controller:"login_controller",role_controller:"role_controller",tips_controller:"tips_controller",vip_event:"vip_event"}],qrcode_shard_panel:[function(t,e,i){"use strict";cc._RF.push(e,"ffc12uia9xIk6M08gaWB9IQ","qrcode_shard_panel");var s=t("pathtool"),n=t("playerhead"),a=t("welfare_event");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("welfare","qrcode_shard_panel")},initConfig:function(){this.ctrl=t("welfare_controller").getInstance(),this.item_list={},this.is_shate=!1},initPanel:function(){this.main_container=this.seekChild("main_container"),this.shrh_container=this.seekChild("shrh_container"),this.shrh_container.active="SH_RH"==PLATFORM_TYPR||"SH_SDK"==PLATFORM_TYPR,this.main_container.active="SH_RH"!=PLATFORM_TYPR&&"SH_SDK"!=PLATFORM_TYPR,this.bg_sp=this.seekChild(this.main_container,"bg",cc.Sprite),this.loadRes(s.getIconPath("welfare/welfare_banner","txt_cn_welfare_bg1"),function(t){this.bg_sp.spriteFrame=t}.bind(this)),this.savePhoto=this.seekChild(this.main_container,"savePhoto"),this.copyURL=this.seekChild(this.main_container,"copyURL"),this.textURL_lb=this.seekChild("textURL",cc.Label),this.textURL_lb.string=Utils.TI18N("\u83b7\u53d6\u94fe\u63a5\u5931\u8d25"),this.erweima_img_sp=this.seekChild("er_wei_ma",cc.Sprite),USE_SDK,this.item_container=this.seekChild(this.shrh_container,"item_container"),this.bg_sp_2=this.seekChild(this.shrh_container,"bg_2",cc.Sprite),this.loadRes(s.getBigBg("welfare/txt_cn_shrh_share"),function(t){this.bg_sp_2.spriteFrame=t}.bind(this)),this.go_btn=this.seekChild(this.shrh_container,"go_btn"),this.go_btn_lb=this.seekChild(this.go_btn,"label",cc.Label),this.go_btn_lb.string=Utils.TI18N("\u524d\u5f80\u9080\u8bf7"),this.go_btn_lo=this.seekChild(this.go_btn,"label",cc.LabelOutline),this.go_btn_btn=this.seekChild(this.shrh_container,"go_btn",cc.Button),"SH_RH"==PLATFORM_TYPR&&1==window.SH_RH_IS_SHARE&&(this.go_btn_lb.string=Utils.TI18N("\u9886\u53d6\u5956\u52b1")),1==this.ctrl.getModel().getShareAwardStatus()&&(this.go_btn_lb.string=Utils.TI18N("\u5df2\u9886\u53d6"),this.go_btn_lo.enabled=!1,Utils.setGreyButton(this.go_btn_btn))},registerEvent:function(){Utils.onTouchEnd(this.savePhoto,function(){this.setShardGame()}.bind(this),1),Utils.onTouchEnd(this.copyURL,function(){if(this.copyData&&1==this.copyData.success&&this.copyData.meesage&&this.copyData.message.url){this.copyData.message.url;message(Utils.TI18N("\u590d\u5236\u94fe\u63a5\u5931\u8d25"))}else message(Utils.TI18N("\u590d\u5236\u94fe\u63a5\u5931\u8d25"))}.bind(this),1),this.go_btn.on("click",function(){Utils.playButtonSound(1),"SH_RH"==PLATFORM_TYPR?1==window.SH_RH_IS_SHARE?0==this.ctrl.getModel().getShareAwardStatus()&&this.ctrl.send16692(0):SDK.share({apiType:"setShare"}):"SH_SDK"==PLATFORM_TYPR&&this.clickGoBtnBySHWX()}.bind(this)),this.addGlobalEvent(a.Update_get_SHRH_share_award_status,function(t){2==t?this.go_btn_lb.string=Utils.TI18N("\u9886\u53d6\u5956\u52b1"):1==t&&(this.go_btn_lb.string=Utils.TI18N("\u5df2\u9886\u53d6"),this.go_btn_lo.enabled=!1,Utils.setGreyButton(this.go_btn_btn))}.bind(this))},clickGoBtnBySHWX:function(){1==this.is_shate?0==this.ctrl.getModel().getShareAwardStatus()&&this.ctrl.send16692(1):(SDK.goShare(),this.share_time||(this.share_time=gcore.Timer.set(function(){this.is_shate=!0,this.go_btn_lb.string=Utils.TI18N("\u9886\u53d6\u5956\u52b1")}.bind(this),3500,1)))},setShardGame:function(){if(this.qrCodeImg){if(!this.poste_picture){var e=t("viewmanager").getInstance().getSceneNode(SCENE_TAG.loading);this.poste_picture=Utils.createImage(e,null,0,0,cc.v2(.5,.5)),this.poste_picture.type=cc.Sprite.Type.SIMPLE,this.poste_picture.sizeMode=cc.Sprite.SizeMode.CUSTOM,this.poste_picture.node.setContentSize(720,1280),this.poste_picture.node.scale=FIT_SCALE,this.layout=new cc.Node,this.layout.setParent(this.poste_picture.node),this.layout.setPosition(0,0);var i=t("role_controller").getInstance().getRoleVo();this.head=new n,this.head.show(),this.head.setPosition(-258,-573),this.head.setHeadRes(i.face_id),this.head.setParent(this.layout);Utils.createLabel(30,new cc.Color(185,238,255,255),new cc.Color(0,0,0,255),-200,-550,Utils.TI18N(i.name),this.layout,2,cc.v2(0,.5));var a=Utils.createLabel(30,new cc.Color(185,238,255,255),new cc.Color(0,0,0,255),310,-550,Utils.TI18N("\u670d\u52a1\u5668: "+i.srv_id),this.layout,2,cc.v2(1,.5)),o=t("login_controller").getInstance().getModel().getLoginData();o&&(a.string=Utils.TI18N("\u670d\u52a1\u5668\uff1a"+o.srv_name));var l=Utils.createLabel(26,new cc.Color(185,238,255,255),new cc.Color(0,0,0,255),-200,-600,Utils.TI18N("\u6211\u7684\u5206\u4eab\u7801: "),this.layout,2,cc.v2(0,.5)),r=t("invitecode_controller").getInstance().getModel().getInviteCode();l.string=cc.js.formatStr(Utils.TI18N("\u6211\u7684\u5206\u4eab\u7801: %s"),r),this.loadRes(s.getIconPath("welfare/welfare_banner","txt_cn_welfare_bg2"),function(t){this.poste_picture.spriteFrame=t;var e=Utils.createImage(this.poste_picture.node,null,0,500,cc.v2(.5,.5));this.loadRes(s.getLogoRes(),function(t){e.spriteFrame=t}.bind(this)),e.type=cc.Sprite.Type.SIMPLE,e.sizeMode=cc.Sprite.SizeMode.CUSTOM,this.time_2&&(gcore.Timer.del(this.time_2),this.time_2=null),this.time_2=gcore.Timer.set(function(){var t=Utils.createImage(this.poste_picture.node,null,0,500,cc.v2(.5,.5));this.loadRes(s.getLogoRes(),function(e){t.spriteFrame=e}.bind(this)),t.type=cc.Sprite.Type.SIMPLE,t.sizeMode=cc.Sprite.SizeMode.CUSTOM}.bind(this),100,1);var i=Utils.createImage(this.poste_picture.node,null,-145,-145,cc.v2(.5,.5));i.spriteFrame=this.qrCodeImg,i.node.scale=340/i.node.width;this.time_1&&(gcore.Timer.del(this.time_1),this.time_1=null),this.time_1=gcore.Timer.set(function(){this.poste_picture&&(this.poste_picture.node.removeFromParent(),this.poste_picture=null),this.head&&(this.head.deleteMe(),this.head=null)}.bind(this),1e3,1)}.bind(this))}}else message(Utils.TI18N("\u4e8c\u7ef4\u7801\u6b63\u5728\u751f\u6210\u4e2d......"))},onShow:function(t){this.setItemList()},setItemList:function(){if("SH_RH"==PLATFORM_TYPR||"SH_SDK"==PLATFORM_TYPR){var t=this.ctrl.getModel().getShareAward();if(null==t)return;var e=0;for(var i in t){var s=t[i];if(!this.item_list[i]){var n=ItemsPool.getInstance().getItem("backpack_item");n.initConfig(!1,.7,!1,!0),n.show(),n.setParent(this.item_container),n.setData({bid:s.bid,num:s.num}),n.setPosition(110*e-110,80),this.item_list[i]=n,e+=1}}}},onHide:function(){},onDelete:function(){if(this.poste_picture&&(this.poste_picture.node.removeFromParent(),this.poste_picture=null,this.layout=null),this.head&&(this.head.deleteMe(),this.head=null),this.time_1&&(gcore.Timer.del(this.time_1),this.time_1=null),this.time_2&&(gcore.Timer.del(this.time_2),this.time_2=null),this.share_time&&(gcore.Timer.del(this.share_time),this.share_time=null),this.is_shate=!1,this.item_list){for(var t in this.item_list)this.item_list[t].deleteMe(),this.item_list[t]=null;this.item_list=null}}});cc._RF.pop()},{invitecode_controller:"invitecode_controller",login_controller:"login_controller",pathtool:"pathtool",playerhead:"playerhead",role_controller:"role_controller",viewmanager:"viewmanager",welfare_controller:"welfare_controller",welfare_event:"welfare_event"}],rank_constant:[function(t,e,i){"use strict";var s,n,a,o,l,r,c,_,h,d,u,m,f,p,g,v,b,w,y,C,k,S,T,I,E,B,x,P,R,N,U,A,D,L,F,M,G,H,O,V,W,z,q,j,K,Y,Z,Q,J,X,$,tt,et,it,st,nt,at,ot,lt,rt,ct,_t,ht,dt,ut,mt,ft,pt,gt,vt,bt,wt,yt,Ct,kt,St,Tt,It,Et,Bt,xt,Pt,Rt,Nt,Ut,At,Dt,Lt,Ft,Mt,Gt,Ht,Ot,Vt,Wt,zt,qt,jt,Kt,Yt,Zt,Qt,Jt,Xt,$t,te,ee,ie,se,ne,ae,oe,le;function re(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}cc._RF.push(e,"078c6xTzsFECa1mA/n5TsaY","rank_constant");var ce={RankType:(s={drama:2,power:6,union:4,arena:5,tower:3,action_drama:9,action_arena:11,action_tower:10,action_power:12,star_power:13,action_partner:14,action_adventure:15,union_boss:16,endless:18,action_star:19,hallows_power:20,colors_tone:21,summon:22,consumption:23,star_master:24,strong_battle:25,holy_device:26,holy_device_1:27,treasure:28,endless_old:29,guild_war:30},re(s,"colors_tone",31),re(s,"gemstone",32),re(s,"pointglod",34),re(s,"speed_fight",35),re(s,"voyage",36),re(s,"hero_expedit",37),re(s,"adventure",38),re(s,"elite",39),re(s,"element",40),re(s,"adventure_muster",41),re(s,"heaven",42),s),RankRewardType:{ePointGlod:97001},RankRewardTitleName:re({},97001,"\u5956\u52b1\u9884\u89c8")};ce.RankTitle=(re(H={},2,(re(n={},1,"\u6392\u540d"),re(n,2,"\u73a9\u5bb6\u540d\u79f0"),re(n,3,"\u5267\u60c5\u8fdb\u5ea6"),n)),re(H,3,(re(a={},1,"\u6392\u540d"),re(a,2,"\u73a9\u5bb6\u540d\u79f0"),re(a,3,"\u5c42\u6570"),re(a,4,"\u901a\u5173\u7528\u65f6"),a)),re(H,4,(re(o={},1,"\u6392\u540d"),re(o,2,"\u516c\u4f1a\u540d\u79f0"),re(o,3,"\u7b49\u7ea7"),re(o,4,"\u6210\u5458"),re(o,5,"\u603b\u6218\u529b"),o)),re(H,5,(re(l={},1,"\u6392\u540d"),re(l,2,"\u73a9\u5bb6\u540d\u79f0"),re(l,3,"\u7ade\u6280\u676f\u6570"),l)),re(H,6,(re(r={},1,"\u6392\u540d"),re(r,2,"\u73a9\u5bb6\u540d\u79f0"),re(r,3,"\u6218\u6597\u529b"),r)),re(H,9,(re(c={},1,"\u6392\u540d"),re(c,2,"\u73a9\u5bb6\u540d\u79f0"),re(c,3,"\u5267\u60c5\u8fdb\u5ea6"),c)),re(H,10,(re(_={},1,"\u6392\u540d"),re(_,2,"\u73a9\u5bb6\u540d\u79f0"),re(_,3,"\u5c42\u6570"),re(_,4,"\u901a\u5173\u7528\u65f6"),_)),re(H,11,(re(h={},1,"\u6392\u540d"),re(h,2,"\u73a9\u5bb6\u540d\u79f0"),re(h,3,"\u7ade\u6280\u676f\u6570"),h)),re(H,12,(re(d={},1,"\u6392\u540d"),re(d,2,"\u73a9\u5bb6\u540d\u79f0"),re(d,3,"\u6218\u6597\u529b"),d)),re(H,13,(re(u={},1,"\u6392\u540d"),re(u,2,"\u73a9\u5bb6\u540d\u79f0"),re(u,3,"\u6218\u6597\u529b"),u)),re(H,14,(re(m={},1,"\u6392\u540d"),re(m,2,"\u73a9\u5bb6\u540d\u79f0"),re(m,3,"\u82f1\u96c4"),re(m,4,"\u6218\u6597\u529b"),m)),re(H,15,(re(f={},1,"\u6392\u540d"),re(f,2,"\u73a9\u5bb6\u540d\u79f0"),re(f,3,"\u795e\u754c\u63a2\u7d22\u5ea6"),f)),re(H,16,(re(p={},1,"\u6392\u540d"),re(p,2,"\u73a9\u5bb6\u540d\u79f0"),re(p,3,"\u7d2f\u8ba1\u4f24\u5bb3"),p)),re(H,18,(re(g={},1,"\u6392\u540d"),re(g,2,"\u73a9\u5bb6\u540d\u79f0"),re(g,3,"\u5c42\u6570"),re(g,4,"\u6218\u529b"),g)),re(H,20,(re(v={},1,"\u6392\u540d"),re(v,2,"\u73a9\u5bb6\u540d\u79f0"),re(v,3,"\u6218\u529b"),v)),re(H,21,(re(b={},1,"\u6392\u540d"),re(b,2,"\u73a9\u5bb6\u540d\u79f0"),re(b,3,"\u7b49\u7ea7"),re(b,4,"\u6218\u529b"),b)),re(H,22,(re(w={},1,"\u6392\u540d"),re(w,2,"\u73a9\u5bb6\u540d\u79f0"),re(w,3,"\u53ec\u5524\u6b21\u6570"),w)),re(H,23,(re(y={},1,"\u6392\u540d"),re(y,2,"\u73a9\u5bb6\u540d\u79f0"),re(y,3,"\u6d88\u8d39\u6392\u540d"),y)),re(H,24,(re(C={},1,"\u6392\u540d"),re(C,2,"\u73a9\u5bb6\u540d\u79f0"),re(C,3,"\u89c2\u661f\u6b21\u6570"),C)),re(H,25,(re(k={},1,"\u6392\u540d"),re(k,2,"\u73a9\u5bb6\u540d\u79f0"),re(k,3,"\u6218\u529b"),k)),re(H,26,(re(S={},1,"\u6392\u540d"),re(S,2,"\u73a9\u5bb6\u540d\u79f0"),re(S,3,"\u6218\u529b"),S)),re(H,27,(re(T={},1,"\u6392\u540d"),re(T,2,"\u73a9\u5bb6\u540d\u79f0"),re(T,3,"\u6218\u529b"),T)),re(H,28,(re(I={},1,"\u6392\u540d"),re(I,2,"\u73a9\u5bb6\u540d\u79f0"),re(I,3,"\u5bfb\u5b9d\u6b21\u6570"),I)),re(H,29,(re(E={},1,"\u6392\u540d"),re(E,2,"\u73a9\u5bb6\u540d\u79f0"),re(E,3,"\u5c42\u6570"),re(E,4,"\u6218\u529b"),E)),re(H,30,(re(B={},1,"\u6392\u540d"),re(B,2,"\u73a9\u5bb6\u540d\u79f0"),re(B,3,"\u661f\u6570"),re(B,4,"\u6218\u7ee9"),B)),re(H,31,(re(x={},1,"\u6392\u540d"),re(x,2,"\u73a9\u5bb6\u540d\u79f0"),re(x,3,"\u6218\u529b"),x)),re(H,32,(re(P={},1,"\u6392\u540d"),re(P,2,"\u73a9\u5bb6\u540d\u79f0"),re(P,3,"\u6218\u529b"),P)),re(H,ce.RankType.ladder,(re(R={},1,"\u6392\u540d"),re(R,2,"\u73a9\u5bb6\u540d\u79f0"),re(R,3,"\u516c\u4f1a\u540d\u79f0"),R)),re(H,ce.RankType.pointglod,(re(N={},1,"\u6392\u540d"),re(N,2,"\u73a9\u5bb6\u540d\u79f0"),re(N,3,"\u70b9\u91d1\u6b21\u6570"),N)),re(H,ce.RankType.hero_expedit,(re(U={},1,"\u6392\u540d"),re(U,2,"\u73a9\u5bb6\u540d\u79f0"),re(U,3,"\u6d3b\u52a8\u79ef\u5206"),U)),re(H,ce.RankType.voyage,(re(A={},1,"\u6392\u540d"),re(A,2,"\u73a9\u5bb6\u540d\u79f0"),re(A,3,"\u8fdc\u822a\u6b21\u6570"),A)),re(H,ce.RankType.speed_fight,(re(D={},1,"\u6392\u540d"),re(D,2,"\u73a9\u5bb6\u540d\u79f0"),re(D,3,"\u901f\u6218\u6b21\u6570"),D)),re(H,ce.RankType.adventure,(re(L={},1,"\u6392\u540d"),re(L,2,"\u73a9\u5bb6\u540d\u79f0"),re(L,3,"\u5c42\u6570"),re(L,4,"\u63a2\u7d22\u5ea6"),L)),re(H,ce.RankType.elite,(re(F={},1,"\u6392\u540d"),re(F,2,"\u73a9\u5bb6\u540d\u79f0"),re(F,3,"\u6bb5\u4f4d"),re(F,4,"\u79ef\u5206"),F)),re(H,ce.RankType.adventure_muster,(re(M={},1,"\u6392\u540d"),re(M,2,"\u73a9\u5bb6\u540d\u79f0"),re(M,3,"\u5c42\u6570"),re(M,4,"\u63a2\u7d22\u5ea6"),M)),re(H,ce.RankType.heaven,(re(G={},1,"\u6392\u540d"),re(G,2,"\u73a9\u5bb6\u540d\u79f0"),re(G,3,"\u901a\u5173\u661f\u6570"),G)),H),ce.TitleLinePos=(re(kt={},2,(re(O={},1,130),re(O,2,415),re(O,3,675),O)),re(kt,3,(re(V={},1,130),re(V,2,405),re(V,3,500),V)),re(kt,4,(re(W={},1,130),re(W,2,340),re(W,3,415),re(W,4,503),W)),re(kt,5,(re(z={},1,130),re(z,2,415),re(z,3,675),z)),re(kt,6,(re(q={},1,130),re(q,2,415),re(q,3,665),q)),re(kt,9,(re(j={},1,130),re(j,2,415),re(j,3,675),j)),re(kt,10,(re(K={},1,130),re(K,2,405),re(K,3,500),K)),re(kt,11,(re(Y={},1,130),re(Y,2,415),re(Y,3,675),Y)),re(kt,12,(re(Z={},1,130),re(Z,2,415),re(Z,3,675),Z)),re(kt,13,(re(Q={},1,130),re(Q,2,405),re(Q,3,500),Q)),re(kt,14,(re(J={},1,130),re(J,2,380),re(J,3,500),J)),re(kt,15,(re(X={},1,130),re(X,2,405),re(X,3,500),X)),re(kt,16,(re($={},1,130),re($,2,415),re($,3,665),$)),re(kt,18,(re(tt={},1,130),re(tt,2,380),re(tt,3,500),tt)),re(kt,20,(re(et={},1,130),re(et,2,405),re(et,3,500),et)),re(kt,21,(re(it={},1,130),re(it,2,380),re(it,3,500),it)),re(kt,22,(re(st={},1,130),re(st,2,405),re(st,3,500),st)),re(kt,23,(re(nt={},1,130),re(nt,2,405),re(nt,3,500),nt)),re(kt,24,(re(at={},1,130),re(at,2,405),re(at,3,500),at)),re(kt,25,(re(ot={},1,130),re(ot,2,405),re(ot,3,500),ot)),re(kt,26,(re(lt={},1,130),re(lt,2,405),re(lt,3,500),lt)),re(kt,27,(re(rt={},1,130),re(rt,2,405),re(rt,3,500),rt)),re(kt,28,(re(ct={},1,130),re(ct,2,380),re(ct,3,500),ct)),re(kt,29,(re(_t={},1,130),re(_t,2,380),re(_t,3,500),_t)),re(kt,30,(re(ht={},1,130),re(ht,2,380),re(ht,3,500),ht)),re(kt,31,(re(dt={},1,130),re(dt,2,380),re(dt,3,500),dt)),re(kt,32,(re(ut={},1,130),re(ut,2,380),re(ut,3,500),ut)),re(kt,ce.RankType.ladder,(re(mt={},1,130),re(mt,2,380),re(mt,3,500),mt)),re(kt,ce.RankType.pointglod,(re(ft={},1,130),re(ft,2,380),re(ft,3,500),ft)),re(kt,ce.RankType.hero_expedit,(re(pt={},1,130),re(pt,2,380),re(pt,3,500),pt)),re(kt,ce.RankType.voyage,(re(gt={},1,130),re(gt,2,380),re(gt,3,500),gt)),re(kt,ce.RankType.speed_fight,(re(vt={},1,130),re(vt,2,380),re(vt,3,500),vt)),re(kt,ce.RankType.adventure,(re(bt={},1,130),re(bt,2,380),re(bt,3,500),bt)),re(kt,ce.RankType.elite,(re(wt={},1,130),re(wt,2,425),re(wt,3,524),wt)),re(kt,ce.RankType.adventure_muster,(re(yt={},1,130),re(yt,2,380),re(yt,3,500),yt)),re(kt,ce.RankType.heaven,(re(Ct={},1,130),re(Ct,2,380),re(Ct,3,500),Ct)),kt),ce.TitleName=(re(St={},2,"\u5267\u60c5\u8fdb\u5ea6"),re(St,3,"\u8bd5\u70bc\u5854"),re(St,4,"\u516c\u4f1a\u6392\u540d"),re(St,5,"\u7ade\u6280\u573a"),re(St,6,"\u6218\u529b\u6392\u540d"),re(St,9,"\u5267\u60c5\u8fdb\u5ea6"),re(St,10,"\u661f\u547d\u5854"),re(St,11,"\u7ade\u6280\u573a"),re(St,12,"\u6218\u529b\u6392\u540d"),re(St,13,"\u661f\u547d\u8bc4\u5206"),re(St,14,"\u82f1\u96c4\u6218\u529b"),re(St,15,"\u795e\u754c\u8bc4\u5206"),re(St,16,"\u4f24\u5bb3\u6392\u884c"),re(St,18,"\u65e0\u5c3d\u8bd5\u70bc"),re(St,19,"\u661f\u547d\u8bc4\u5206"),re(St,20,"\u5723\u5668\u6218\u529b"),re(St,21,"\u70ab\u5f69\u5b9d\u77f3"),re(St,22,"\u53ec\u5524\u6392\u884c"),re(St,30,"\u6218\u7ee9\u6392\u884c\u699c"),re(St,23,"\u6d88\u8d39\u6392\u884c"),re(St,24,"\u89c2\u661f\u5927\u5e08"),re(St,25,"\u6700\u5f3a\u9635\u5bb9"),re(St,26,"\u5723\u5668\u6bd4\u62fc"),re(St,27,"\u5723\u5668\u6bd4\u62fc"),re(St,28,"\u5bfb\u5b9d\u6bd4\u62fc"),re(St,29,"\u65e0\u5c3d\u8bd5\u70bc"),re(St,31,"\u70ab\u5f69\u5b9d\u77f3"),re(St,32,"\u70ab\u5f69\u5b9d\u77f3"),re(St,ce.RankType.ladder,"\u5929\u68af\u6392\u884c"),re(St,ce.RankType.pointglod,"\u70b9\u91d1\u699c"),re(St,ce.RankType.hero_expedit,"\u8fdc\u5f81\u699c"),re(St,ce.RankType.voyage,"\u8fdc\u822a\u699c"),re(St,ce.RankType.speed_fight,"\u901f\u6218\u699c"),re(St,ce.RankType.adventure,"\u5192\u9669\u699c"),re(St,ce.RankType.elite,"\u7cbe\u82f1\u8d5b"),re(St,ce.RankType.adventure_muster,"\u5192\u9669\u699c"),re(St,ce.RankType.heaven,"\u5929\u754c\u526f\u672c"),St),ce.TitlePos=(re(le={},2,(re(Tt={},1,60),re(Tt,2,220),re(Tt,3,485),Tt)),re(le,3,(re(It={},1,60),re(It,2,210),re(It,3,430),re(It,4,520),It)),re(le,4,(re(Et={},1,60),re(Et,2,192),re(Et,3,353),re(Et,4,435),re(Et,5,535),Et)),re(le,5,(re(Bt={},1,60),re(Bt,2,220),re(Bt,3,485),Bt)),re(le,6,(re(xt={},1,60),re(xt,2,220),re(xt,3,485),xt)),re(le,9,(re(Pt={},1,60),re(Pt,2,220),re(Pt,3,485),Pt)),re(le,10,(re(Rt={},1,60),re(Rt,2,210),re(Rt,3,430),re(Rt,4,520),Rt)),re(le,11,(re(Nt={},1,60),re(Nt,2,220),re(Nt,3,485),Nt)),re(le,12,(re(Ut={},1,60),re(Ut,2,220),re(Ut,3,485),Ut)),re(le,13,(re(At={},1,60),re(At,2,210),re(At,3,485),At)),re(le,14,(re(Dt={},1,60),re(Dt,2,210),re(Dt,3,421),re(Dt,4,520),Dt)),re(le,15,(re(Lt={},1,60),re(Lt,2,210),re(Lt,3,460),Lt)),re(le,16,(re(Ft={},1,60),re(Ft,2,220),re(Ft,3,485),Ft)),re(le,18,(re(Mt={},1,60),re(Mt,2,210),re(Mt,3,418),re(Mt,4,550),Mt)),re(le,20,(re(Gt={},1,60),re(Gt,2,210),re(Gt,3,485),Gt)),re(le,21,(re(Ht={},1,60),re(Ht,2,210),re(Ht,3,415),re(Ht,4,540),Ht)),re(le,22,(re(Ot={},1,60),re(Ot,2,210),re(Ot,3,467),Ot)),re(le,23,(re(Vt={},1,60),re(Vt,2,210),re(Vt,3,470),Vt)),re(le,24,(re(Wt={},1,60),re(Wt,2,210),re(Wt,3,473),Wt)),re(le,25,(re(zt={},1,60),re(zt,2,210),re(zt,3,485),zt)),re(le,26,(re(qt={},1,60),re(qt,2,210),re(qt,3,485),qt)),re(le,27,(re(jt={},1,60),re(jt,2,210),re(jt,3,485),jt)),re(le,28,(re(Kt={},1,60),re(Kt,2,210),re(Kt,3,485),Kt)),re(le,29,(re(Yt={},1,60),re(Yt,2,210),re(Yt,3,418),re(Yt,4,550),Yt)),re(le,30,(re(Zt={},1,60),re(Zt,2,210),re(Zt,3,421),re(Zt,4,548),Zt)),re(le,31,(re(Qt={},1,60),re(Qt,2,210),re(Qt,3,485),Qt)),re(le,32,(re(Jt={},1,60),re(Jt,2,210),re(Jt,3,485),Jt)),re(le,ce.RankType.ladder,(re(Xt={},1,60),re(Xt,2,210),re(Xt,3,485),Xt)),re(le,ce.RankType.pointglod,(re($t={},1,60),re($t,2,210),re($t,3,485),$t)),re(le,ce.RankType.hero_expedit,(re(te={},1,60),re(te,2,210),re(te,3,448),te)),re(le,ce.RankType.voyage,(re(ee={},1,60),re(ee,2,210),re(ee,3,448),ee)),re(le,ce.RankType.speed_fight,(re(ie={},1,60),re(ie,2,210),re(ie,3,448),ie)),re(le,ce.RankType.adventure,(re(se={},1,60),re(se,2,210),re(se,3,421),re(se,4,548),se)),re(le,ce.RankType.elite,(re(ne={},1,60),re(ne,2,210),re(ne,3,450),re(ne,4,548),ne)),re(le,ce.RankType.adventure_muster,(re(ae={},1,60),re(ae,2,210),re(ae,3,421),re(ae,4,548),ae)),re(le,ce.RankType.heaven,(re(oe={},1,60),re(oe,2,210),re(oe,3,448),oe)),le),e.exports=ce,cc._RF.pop()},{}],rank_controller:[function(t,e,i){"use strict";cc._RF.push(e,"490d1uCJXtIoL7oaw9StSoQ","rank_controller");var s=t("rank_event"),n=t("mainui_controller"),a=t("mainui_const"),o=cc.Class({extends:BaseController,ctor:function(){},initConfig:function(){var e=t("rank_model");this.model=new e,this.model.initConfig()},getModel:function(){return this.model},registerEvents:function(){},registerProtocals:function(){this.RegisterProtocal(12900,this.handle_12900),this.RegisterProtocal(12901,this.handle_12901),this.RegisterProtocal(12902,this.handle_12902),this.RegisterProtocal(12903,this.handle_12903),this.RegisterProtocal(12904,this.handle_12904)},send_12900:function(t,e,i,s){var n=0;1==s&&(n=1);var a={};a.type=t,a.start=e||1,a.num=i||100,a.is_cluster=n,this.SendProtocal(12900,a)},handle_12900:function(t){gcore.GlobalEvent.fire(s.RankEvent_Get_Rank_data,t)},send_12901:function(t,e){var i=0;1==e&&(i=1);var s={};s.type=t,s.is_cluster=i,this.SendProtocal(12901,s)},handle_12901:function(t){gcore.GlobalEvent.fire(s.RankEvent_Get_Time_event,t)},send_12902:function(t){var e=0;1==t&&(e=1);var i={};i.is_cluster=e,this.SendProtocal(12902,i)},handle_12902:function(t){gcore.GlobalEvent.fire(s.RankEvent_Get_First_data,t)},send_12903:function(t,e){var i={};i.start=t||1,i.num=e||100,this.SendProtocal(12903,i)},handle_12903:function(t){gcore.GlobalEvent.fire(s.RankEvent_Get_Rank_data,t)},send_12904:function(t,e){var i={};i.start=t||1,i.num=e||100,this.SendProtocal(12904,i)},handle_12904:function(t){gcore.GlobalEvent.fire(s.RankEvent_Get_Rank_data,t)},openMainView:function(t){if(1==t){if(0==n.getInstance().checkMainFunctionOpenStatus(a.icon.rank,a.function_type.other))return;this.main_view||(this.main_view=Utils.createClass("rank_main_window")),this.main_view.open()}else this.main_view&&(this.main_view.close(),this.main_view=null)},openRankView:function(e,i,s,n){if(1==e){if(!this.rank_panel){var a=t("rank_window");this.rank_panel=new a(i,s)}this.rank_panel.open(n)}else this.rank_panel&&(this.rank_panel.close(),this.rank_panel=null)},openRankRewardPanel:function(t,e){1==t?(this.rank_reward_panel||(this.rank_reward_panel=Utils.createClass("rank_reward_window")),this.rank_reward_panel.open(e)):this.rank_reward_panel&&(this.rank_reward_panel.close(),this.rank_reward_panel=null)}});e.exports=o,cc._RF.pop()},{mainui_const:"mainui_const",mainui_controller:"mainui_controller",rank_event:"rank_event",rank_model:"rank_model",rank_window:"rank_window"}],rank_event:[function(t,e,i){"use strict";cc._RF.push(e,"a920cyUE2lN17SiSaij1D9m","rank_event"),e.exports={RANKEvent_UPDATE_RANK_ITEM:"RANKEvent_UPDATE_RANK_ITEM",RankEvent_Get_Time_event:"RankEvent_Get_Time_event",RankEvent_Get_Rank_data:"RankEvent_Get_Rank_data",RankEvent_Get_Skyladder_Partner_data:"RankEvent_Get_Skyladder_Partner_data",RankEvent_Get_First_data:"RankEvent_Get_First_data"},cc._RF.pop()},{}],rank_item:[function(t,e,i){"use strict";cc._RF.push(e,"c3d6eKseSVOEJk4l3Y/qbbw","rank_item");var s=t("pathtool"),n=t("rank_controller"),a=t("rank_constant"),o=t("hero_vo"),l=t("role_controller"),r=t("playerhead"),c=t("timetool"),_=cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("rank","rank_item"),this.ctrl=n.getInstance(),this.data=null,this.width=600,this.height=120,this.index=arguments[0]||1,this.rank_type=a.RankType.drama,this.rank_num=0,this.item_list={},this.node_list=[]},initPanel:function(){this.background=this.seekChild("bg"),this.rank_icon=this.seekChild("rank_icon",cc.Sprite),this.rank_index=this.seekChild("rank_index",cc.Label),this.other_panel=this.seekChild("other_panel"),this.select=this.seekChild("select"),this.select.active=!1,this._btnPraise=this.seekChild("btnPraise"),this._btnPraise_btn=this.seekChild("btnPraise",cc.Button),this._praise=this.seekChild(this._btnPraise,"img",cc.Sprite),this._labelPraise=this.seekChild(this._btnPraise,"label",cc.Label),this._btnPraise.active=!1},clickHandler:function(){this.call_fun&&this.call_fun(this.vo)},setTouchFunc:function(t){this.call_fun=t},registerEvent:function(){this.background.on(cc.Node.EventType.TOUCH_START,function(t){var e=t.getTouches();this.touch_began=e[0].getLocation()},this),this.background.on(cc.Node.EventType.TOUCH_END,function(t){var e=t.getTouches();this.touch_end=e[0].getLocation();var i=!0;null!=this.touch_began&&(i=Math.abs(this.touch_end.x-this.touch_began.x)<=20&&Math.abs(this.touch_end.y-this.touch_began.y)<=20),1==i&&(Utils.playButtonSound(ButtonSound.Normal),this.rank_type!=a.RankType.union&&this.openChatMessage())},this)},setData:function(t){this.data=t,this.root_wnd&&this.onShow()},onShow:function(){null!=this.data&&(this.index=this.data.idx||this.data.rank||1,this.rank_index.string=this.index,this.index>=1&&this.index<=3?(this.rank_index.node.active=!1,this.rank_icon.node.active=!0,this.rank_icon.node.setScale(.7),this.loadRes(s.getCommonIcomPath("common_200"+this.index),function(t){this.rank_icon.spriteFrame=t}.bind(this))):(this.rank_index.node.active=!0,this.rank_icon.node.active=!1),this.updateDataByRankType())},setExtendData:function(t){t&&(this.rank_type=t.rank_type||a.RankType.drama,this.is_cluster=t.is_cluster||!1)},updateDataByRankType:function(){if(this.data){for(var t in this.item_list)this.item_list[t].setVisible(!1);this.other_panel.removeAllChildren();var e=this.data.name;if(1==this.is_cluster&&(e=Utils.transformNameByServ(this.data.name,this.data.srv_id)),this.rank_type!=a.RankType.union){this.player_head=this.createPlayerHead(105,60);var i=this.data.face_id||this.data.face,n=this.data.avatar_bid;this.player_head.setFrameRes(n),this.player_head.setHeadRes(i),this.player_head.setLev(this.data.lev)}if(this.rank_type==a.RankType.power||this.rank_type==a.RankType.action_power){var o=Utils.createLabel(24,new cc.Color(104,69,42,255),null,198,this.height/2,"",this.other_panel,0,cc.v2(0,.5));this.node_list.push(o),o.string=e;o=Utils.createRichLabel(24,new cc.Color(104,69,42,255),cc.v2(.5,.5),cc.v2(480,this.height/2),0,500);this.node_list.push(o),this.other_panel.addChild(o.node);var l=this.data.val1||0,r=s.getCommonIcomPath("common_90002");o.string=cc.js.formatStr("<img src='%s' /> %s","common_90002",l),this.loadRes(r,function(t,e){t.spriteFrame=e}.bind(this,o))}else if(this.rank_type==a.RankType.union){var _=this.data.step||0;_=Math.max(_,1),_=Math.min(_,11);o=Utils.createLabel(24,new cc.Color(104,69,42,255),null,204,80,"",this.other_panel,0,cc.v2(.5,.5));this.node_list.push(o),o.string=e;o=Utils.createLabel(20,new cc.Color(169,95,15,255),null,204,40,"",this.other_panel,0,cc.v2(.5,.5));this.node_list.push(o),o.string=Utils.TI18N("\u4f1a\u957f\uff1a")+(this.data.leader_name||"");o=Utils.createLabel(24,new cc.Color(104,69,42,255),null,342,this.height/2,"",this.other_panel,0,cc.v2(.5,.5));this.node_list.push(o),o.string=this.data.lev||313;o=Utils.createLabel(24,new cc.Color(104,69,42,255),null,425,this.height/2,"",this.other_panel,0,cc.v2(.5,.5));this.node_list.push(o);var h=this.data.members_num||0,d=this.data.members_max||0;o.string=cc.js.formatStr("%s/%s",h,d);o=Utils.createRichLabel(24,new cc.Color(169,95,15,255),cc.v2(.5,.5),cc.v2(525,this.height/2),0,500);this.node_list.push(o),this.other_panel.addChild(o.node),o.string=String(this.data.power)||0}else if(this.rank_type==a.RankType.union_boss){o=Utils.createLabel(24,new cc.Color(104,69,42,255),null,210,this.height/2,"",this.other_panel,0,cc.v2(0,.5));this.node_list.push(o),o.string=e;o=Utils.createRichLabel(24,new cc.Color(104,69,42,255),cc.v2(.5,.5),cc.v2(505,this.height/2+25),0,500);this.node_list.push(o),this.other_panel.addChild(o.node);var u=this.data.all_dps||0;o.string=String(u),this.addPraise(this.data)}else if(this.rank_type==a.RankType.tower||this.rank_type==a.RankType.action_tower){o=Utils.createLabel(24,new cc.Color(104,69,42,255),null,210,this.height/2,"",this.other_panel,0,cc.v2(0,.5));this.node_list.push(o),o.string=e;o=Utils.createLabel(24,new cc.Color(169,95,15,255),null,405,61,"",this.other_panel,0,cc.v2(0,.5));this.node_list.push(o),o.string=this.data.val1||0;o=Utils.createLabel(24,new cc.Color(104,69,42,255),null,500,this.height/2,"",this.other_panel,0,cc.v2(0,.5));this.node_list.push(o);var m=this.data.val2||0;o.string=c.getTimeMs(m,!0)}else if(this.rank_type==a.RankType.action_star||this.rank_type==a.RankType.star_power||this.rank_type==a.RankType.hallows_power||this.rank_type==a.RankType.treasure||this.rank_type==a.RankType.colors_tone||this.rank_type==a.RankType.gemstone||this.rank_type==a.RankType.pointglod||this.rank_type==a.RankType.speed_fight||this.rank_type==a.RankType.voyage||this.rank_type==a.RankType.hero_expedit){var f=Utils.createLabel(24,new cc.Color(104,69,42,255),null,198,this.height/2,"",this.other_panel,0,cc.v2(0,.5));this.node_list.push(f),f.string=e;var p=Utils.createLabel(24,new cc.Color(169,95,15,255),null,455,this.height/2,"",this.other_panel,0,cc.v2(0,.5));this.node_list.push(p),p.string=this.data.val1||0}else if(this.rank_type==a.RankType.guild_war){var g=Utils.createLabel(24,new cc.Color(104,69,42,255),null,198,this.height/2,"",this.other_panel,0,cc.v2(0,.5));this.node_list.push(g),g.string=e;o=Utils.createLabel(24,new cc.Color(104,69,42,255),null,402,this.height/2,"",this.other_panel,0,cc.v2(.5,.5));this.node_list.push(o),o.string=this.data.star||0;var v=Utils.createLabel(24,new cc.Color(169,95,15,255),null,525,this.height/2,"",this.other_panel,0,cc.v2(.5,.5));this.node_list.push(v),v.string=this.data.war_score||0}else if(this.rank_type==a.RankType.drama||this.rank_type==a.RankType.action_drama){var b=Utils.createLabel(24,new cc.Color(104,69,42,255),null,198,this.height/2,"",this.other_panel,0,cc.v2(0,.5));this.node_list.push(b),b.string=e;var w=Utils.createLabel(24,new cc.Color(104,69,42,255),null,495,this.height/2,"",this.other_panel,0,cc.v2(.5,.5));this.node_list.push(w);var y=gdata("dungeon_data","data_drama_dungeon_info",this.data.val1);if(y){var C=y.name;w.string=C}}else if(this.rank_type==a.RankType.arena||this.rank_type==a.RankType.action_arena){var k=Utils.createLabel(24,new cc.Color(104,69,42,255),null,198,this.height/2,"",this.other_panel,0,cc.v2(0,.5));this.node_list.push(k),k.string=e;o=Utils.createRichLabel(24,new cc.Color(169,95,15,255),cc.v2(.5,.5),cc.v2(480,this.height/2),0,500);this.node_list.push(o),this.other_panel.addChild(o.node);v=this.data.score||this.data.val1||0,r=s.getItemRes("8");o.string=cc.js.formatStr("<img src='%s' /> %s","8",v),this.loadRes(r,function(t,e){t.spriteFrame=e}.bind(this,o))}else if(this.rank_type==a.RankType.endless||this.rank_type==a.RankType.endless_old||this.rank_type==a.RankType.adventure||this.rank_type==a.RankType.adventure_muster){var S=Utils.createLabel(24,new cc.Color(104,69,42,255),null,198,this.height/2,"",this.other_panel,0,cc.v2(0,.5));this.node_list.push(S),S.string=e;var T=Utils.createLabel(24,new cc.Color(169,95,15,255),null,403,this.height/2,"",this.other_panel,0,cc.v2(.5,.5));this.node_list.push(T),T.string=this.data.val1||0;o=Utils.createLabel(24,new cc.Color(169,95,15,255),null,535,this.height/2,"",this.other_panel,0,cc.v2(.5,.5));this.node_list.push(o),o.string=this.data.val2||0}}},addCallBack:function(t){this.call_back=t},addPraise:function(t){this._btnPraise.active||(this._btnPraise.active=!0),Utils.setGreyButton(this._btnPraise_btn,!1),this._praise.setMaterial(0,cc.Material.getBuiltinMaterial("2d-sprite")),this.index<=3?this._btnPraise.on(cc.Node.EventType.TOUCH_END,function(){Utils.playButtonSound(1),this.index>3||(null!=this.call_back&&this.call_back(this),l.getInstance().sender10316(t.r_rid,t.r_srvid,this.index,2))},this):(this._praise.setMaterial(0,cc.Material.getBuiltinMaterial("2d-gray-sprite")),Utils.setGreyButton(this._btnPraise_btn,!0)),this._labelPraise.string=t.worship,1==t.worship_status&&(this._praise.setMaterial(0,cc.Material.getBuiltinMaterial("2d-gray-sprite")),Utils.setGreyButton(this._btnPraise_btn,!0))},updateWorshipStatus:function(){null!=this.data&&(this.data.worship=this.data.worship+1,this.data.worship_status=1,this._labelPraise.string=this.data.worship,this._praise.setMaterial(0,cc.Material.getBuiltinMaterial("2d-gray-sprite")),Utils.setGreyButton(this._btnPraise_btn,!0))},openChatMessage:function(){var e=l.getInstance().getRoleVo(),i=this.data.rid||this.data.r_rid,s=this.data.srv_id||this.data.r_srvid;if(i&&s&&e.rid==i&&e.srv_id==s)message(Utils.TI18N("\u4f60\u4e0d\u8ba4\u8bc6\u4f60\u81ea\u5df1\u4e86\u4e48\uff1f"));else if(this.data.is_robot&&1==this.data.is_robot)message(Utils.TI18N("\u795e\u79d8\u4eba\u592a\u9ad8\u51b7\uff0c\u4e0d\u7ed9\u67e5\u770b"));else if(this.data){var n={rid:i,srv_id:s};t("chat_controller").getInstance().openFriendInfo(n,cc.v2(0,0))}},createPartnerVo:function(){var t=new o,e={partner_id:this.data.pid,bid:this.data.pbid,lev:this.data.plev,star:this.data.pstar};return t.updateHeroVo(e),t},createPlayerHead:function(t,e){t+=43;var i=new r;return i.setParent(this.other_panel),i.show(),i.setScale(.8),i.setPosition(t,e),i},setSelected:function(t){if(this.select.active=t,1==t){var e=cc.fadeIn(.7),i=cc.fadeOut(.7);this.select.runAction(cc.repeatForever(cc.sequence(e,i)))}else this.select.stopAllActions()},isHaveData:function(){return!!this.vo},reset:function(){this.num&&this.num.setVisible(!1),this.vo=null},getData:function(){return this.vo},onDelete:function(){if(this.item_list){for(var t in this.item_list){(e=this.item_list[t]).deleteMe(),e=null}this.item_list=null}if(this.node_list){for(var t in this.node_list){var e;(e=this.node_list[t])instanceof cc.Node?(e.destroy(),e=null):(e.node.destroy(),e=null)}this.node_list=null}this.player_head&&(this.player_head.deleteMe(),this.player_head=null)}});e.exports=_,cc._RF.pop()},{chat_controller:"chat_controller",hero_vo:"hero_vo",pathtool:"pathtool",playerhead:"playerhead",rank_constant:"rank_constant",rank_controller:"rank_controller",role_controller:"role_controller",timetool:"timetool"}],rank_main_item:[function(t,e,i){"use strict";cc._RF.push(e,"ca381dQ479GKaB8XnUcyuYk","rank_main_item");var s=t("pathtool"),n=t("rank_constant"),a=t("playerhead");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("rank","rank_main_item")},initConfig:function(){},initPanel:function(){this.main_panel=this.seekChild("main_panel"),this.bg_sp=this.seekChild("bg",cc.Sprite),this.first_icon_sp=this.seekChild("first_icon",cc.Sprite),this.name_lb=this.seekChild("name",cc.Label),this.rank_rt=this.seekChild("rank",cc.RichText),this.union_icon=this.seekChild("union_icon"),this.union_icon.active=!1,this.icon_sp=this.seekChild("icon",cc.Sprite),this.icon_sp.node.active=!1},registerEvent:function(){this.root_wnd.on(cc.Node.EventType.TOUCH_END,function(){this.data&&null!=Utils.next(this.data)?this.call_fun&&this.call_fun(this,this.data):message(Utils.TI18N("\u6682\u65e0\u6392\u540d\u6570\u636e"))},this)},setData:function(t){this.data=t,this.root_wnd&&this.onShow()},onShow:function(){if(null!=this.data){this.showActionIcon(!1);this.data;this.rank_type=this.data.type;var t=s.getBigBg("txt_cn_rank_"+this.rank_type,null,"rank");if(this.item_res_id!=t&&(this.item_res_id=t,this.loadRes(t,function(t){this.bg_sp.spriteFrame=t}.bind(this))),0!=this.data.val1){this.first_icon_sp.node.active=!0;var e=this.data.name;if(""==e?e=Utils.TI18N("\u6682\u65e0\u6392\u540d"):1==this.is_cluster&&(e=Utils.transformNameByServ(this.data.name,this.data.srv_id)),this.name_lb.string=e,this.name_lb.node.setPosition(cc.v2(125,38)),!this.data||null==Utils.next(this.data))return;if(this.rank_type!=n.RankType.union){this.player_head||(this.player_head=new a,this.player_head.setParent(this.main_panel),this.player_head.show(),this.player_head.setScale(.6),this.player_head.setPosition(88,38)),this.player_head.setHeadRes(this.data.face_id);var i=this.data.avatar_bid;this.player_head.setFrameRes(i),this.union_icon&&(this.union_icon.active=!1),this.player_head.setVisible(!0)}else this.union_icon.active=!0,this.player_head&&this.player_head.setVisible(!1);this.icon_sp.node.active=!1,this.rank_rt.node.x=327;var o="";if(this.rank_type==n.RankType.arena){var l=s.getItemRes(8),r=this.data.val1||0;this.loadRes(l,function(t){this.icon_sp.spriteFrame=t}.bind(this)),this.icon_sp.node.active=!0,this.icon_sp.node.scale=.3,this.rank_rt.node.x=360,o=String(r)}else if(this.rank_type==n.RankType.drama){var c=0|this.data.val1,_=gdata("dungeon_data","data_drama_dungeon_info",[c]);_&&(o=_.name)}else if(this.rank_type==n.RankType.power||this.rank_type==n.RankType.action_partner||this.rank_type==n.RankType.colors_tone){l=s.getCommonIcomPath("common_90001");this.loadRes(l,function(t){this.icon_sp.spriteFrame=t}.bind(this)),this.icon_sp.node.active=!0,this.icon_sp.node.scale=.9,this.rank_rt.node.x=360;r=this.data.val1||0;o=String(r),this.rank_type==n.RankType.action_partner&&this.showActionIcon(!0)}else if(this.rank_type==n.RankType.tower){r=this.data.val1||0;o=cc.js.formatStr("\u901a\u5173\u5c42\u6570\uff1a%s",r)}else if(this.rank_type==n.RankType.union){e=this.data.guild_name||"";r=this.data.val1||0;o=cc.js.formatStr("\u603b\u6218\u529b\uff1a%s",r)}else if(this.rank_type==n.RankType.star_power){r=this.data.val1||0;o=cc.js.formatStr("\u8bc4\u5206\uff1a%s",r)}else if(this.rank_type==n.RankType.action_star){r=this.data.val1||0;o=cc.js.formatStr("\u8bc4\u5206\uff1a%s",r),this.showActionIcon(!0)}else if(this.rank_type==n.RankType.action_adventure){r=this.data.val1||0;o=cc.js.formatStr("\u795e\u754c\u63a2\u7d22\u5ea6\uff1a%s",r),this.showActionIcon(!0)}else if(this.rank_type==n.RankType.hallows_power){r=this.data.val1||0;o=cc.js.formatStr("\u5723\u5668\u6218\u529b\uff1a%s",r)}this.name_lb.string=e,this.name_lb.node.setPosition(cc.v2(125,55)),this.rank_rt.string=o}else this.name_lb.string=Utils.TI18N("\u865a\u4f4d\u4ee5\u5f85"),this.name_lb.node.setPosition(cc.v2(25,35)),this.rank_rt.string="",this.first_icon_sp.node.active=!1,this.union_icon&&(this.union_icon.active=!1),this.player_head&&this.player_head.setVisible(!1)}},setExtendData:function(t){this.is_cluster=t},showActionIcon:function(t){(0!=t||this.action_icon)&&(this.action_icon||(this.action_icon=this.seekChild("action_icon"),this.action_label=this.seekChild("action_label")),this.action_icon.active=t,this.action_label.active=t)},clickHandler:function(){this.call_fun&&this.call_fun(this.data)},addCallBack:function(t){this.call_fun=t},setSelectStatus:function(t){},setVisibleStatus:function(t){this.setVisible(t)},getRankIndex:function(){return this.rank_type||1},onHide:function(){},onDelete:function(){this.player_head&&(this.player_head.deleteMe(),this.player_head=null)}});cc._RF.pop()},{pathtool:"pathtool",playerhead:"playerhead",rank_constant:"rank_constant"}],rank_main_window:[function(t,e,i){"use strict";cc._RF.push(e,"1d513sQe8pIsYbJv9vL/l91","rank_main_window");var s=t("pathtool"),n=t("rank_controller"),a=t("rank_event"),o=t("common_scrollview"),l=t("rank_main_item"),r=cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("rank","rank_main"),this.win_type=WinType.Full,this.ctrl=n.getInstance(),this.cur_type=0,this.res_list={},this.tab_info_list={},this.view_list={},this.tab_list={},this.is_init={},this.select_tyep=1,this.is_cluster=!1,this.rank_first_list={},this.is_send=!1},openCallBack:function(){this.contaienr=this.seekChild("container"),this.main_panel=this.seekChild("main_panel"),this.close_btn=this.seekChild("close_btn"),this.bg_nd=this.seekChild("bg"),this.background=this.seekChild("background"),this.background.scale=FIT_SCALE,this.loadRes(s.getBigBg("bigbg_2"),function(t){this.background.getComponent(cc.Sprite).spriteFrame=t}.bind(this))},registerEvent:function(){this.addGlobalEvent(a.RankEvent_Get_First_data,function(t){if(t){var e=1;0==t.is_cluster&&(e=2),this.select_type==e&&(1==t.is_cluster?this.rank_first_list[1]=t.rank_list:this.rank_first_list[2]=t.rank_list,this.updateRankList())}},this),this.is_send?this.ctrl.send_12902(this.is_cluster):this.is_send=!0,Utils.onTouchEnd(this.close_btn,function(){this.ctrl.openMainView(!1)}.bind(this),2)},openRootWnd:function(t){t=t||2,this.select_tyep=t,this.changeTabIndex(t)},changeTabIndex:function(t){this.select_type=t,null!=this.rank_first_list[t]?this.updateRankList():(this.is_cluster=1==this.select_type,0==this.is_send?this.is_send=!0:this.ctrl.send_12902(this.is_cluster))},updateRankList:function(){if(null!=this.select_type){var t=this.rank_first_list[this.select_tyep];if(null!=t){var e=cc.size(610,848);if(null==this.list_view){var i={item_class:l,start_x:5,space_x:0,start_y:0,space_y:0,item_width:602,item_height:162,row:0,col:1,need_dynamic:!0};this.list_view=new o,this.list_view.createScroll(this.bg_nd,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,e,i,cc.v2(.5,.5))}var s=1==this.select_type;t.sort(Utils.tableLowerSorter(["type"]));var n=function(t,e){if(e&&null!=Utils.next(e)){var i=t.getRankIndex()||1;this.ctrl.openRankView(!0,i,s)}}.bind(this);this.list_view.setData(t,n,s)}}},closeCallBack:function(){this.ctrl.openMainView(!1),this.list_view&&(this.list_view.deleteMe(),this.list_view=null)}});e.exports=r,cc._RF.pop()},{common_scrollview:"common_scrollview",pathtool:"pathtool",rank_controller:"rank_controller",rank_event:"rank_event",rank_main_item:"rank_main_item"}],rank_model:[function(t,e,i){"use strict";cc._RF.push(e,"2d357vsClZNSZzXsCMfGdzI","rank_model");cc.Class({extends:BaseClass,ctor:function(){},properties:{},initConfig:function(){}});cc._RF.pop()},{}],rank_reward_item:[function(t,e,i){"use strict";cc._RF.push(e,"a3ac4hQ93hCHYbq2wrdSkpe","rank_reward_item");var s=t("pathtool");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("rank","rank_reward_item")},initConfig:function(){this.item_list=[]},initPanel:function(){this.rank_img_sp=this.seekChild("rank_img",cc.Sprite),this.rank_label_lb=this.seekChild("rank_label",cc.Label),this.con_nd=this.seekChild("con")},registerEvent:function(){},setData:function(t){this.data&&this.data.rank1==t.rank1||(this.data=t,this.root_wnd&&this.onShow())},onShow:function(t){if(null!=this.data){var e=this.data;if(e.rank1<=3){this.rank_label_lb.string="",this.rank_img_sp.node.active=!0;var i=s.getUIIconPath("common","common_200"+e.rank1);this.loadRes(i,function(t){this.rank_img_sp.spriteFrame=t}.bind(this))}else{this.rank_img_sp.node.active=!1;var n=null;n=e.rank1&&e.rank2?9999==e.rank2?cc.js.formatStr("%s+",e.rank1):cc.js.formatStr("%s~%s",e.rank1,e.rank2):e.rank1,this.rank_label_lb.string=n}if(this.item_list)for(var a in this.item_list){(r=this.item_list[a])&&r.setVisible(!1)}var o=.9*BackPackItem.Width,l=0;for(var a in e.award){var r=e.award[a];if(this.item_list[a]){var c=this.item_list[a];c.setVisible(!0),c.setData({bid:r.bid,num:r.num}),c.setPosition(l*(o+14)+60,0)}else{var _=ItemsPool.getInstance().getItem("backpack_item");_.initConfig(!1,.9,!1,!0),_.show(),_.setParent(this.con_nd),this.item_list[a]=_,_.setData({bid:r.bid,num:r.num}),_.setPosition(l*(o+14)+60,0)}l+=1}}},onHide:function(){},onDelete:function(){if(this.item_list)for(var t in this.item_list){var e=this.item_list[t];e&&(e.deleteMe(),e=null)}}});cc._RF.pop()},{pathtool:"pathtool"}],rank_reward_window:[function(t,e,i){"use strict";cc._RF.push(e,"20a3fnCjSRE36pqctfvN54A","rank_reward_window");var s=t("pathtool"),n=t("common_scrollview"),a=t("rank_reward_item"),o=t("action_event");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("rank","rank_reward_panel"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Big},initConfig:function(){this.ctrl=t("rank_controller").getInstance(),this.item_list=[]},openCallBack:function(){this.background=this.seekChild("background"),this.background.scale=FIT_SCALE,this.main_container=this.seekChild("main_container"),this.rank_panel=this.seekChild("rank_panel"),this.my_rank_nd=this.seekChild("my_rank"),this.rank_index_lb=this.seekChild(this.my_rank_nd,"rank_id",cc.Label),this.label_tips_lb=this.seekChild(this.my_rank_nd,"label_tips",cc.Label),this.item_scrollview_nd=this.seekChild(this.my_rank_nd,"item_scrollview"),this.item_scrollview_size=this.item_scrollview_nd.getContentSize(),this.item_scrollview_sv=this.item_scrollview_nd.getComponent(cc.ScrollView),this.item_content_nd=this.seekChild(this.item_scrollview_nd,"content")},registerEvent:function(){Utils.onTouchEnd(this.background,function(){this.ctrl.openRankRewardPanel(!1)}.bind(this),2),this.addGlobalEvent(o.RANK_REWARD_LIST,function(t){t&&(this.cell_data_list=t.rank_award,this.cell_data_list.sort(function(t,e){return t.rank1<e.rank2?-1:1}),0==this.cell_data_list?this.showEmptyIcon():this.updateRankList(),this.updateMyRankInfo(t.rank))},this)},openRootWnd:function(e){this.rank_reward_type=e||1,t("action_controller").getInstance().send16650(this.rank_reward_type)},updateMyRankInfo:function(t){if(this.cell_data_list){if(null==t||0==t)return this.rank_index_lb.string="",void(this.label_tips_lb.string=Utils.TI18N("\u672a\u4e0a\u699c"));this.rank_index_lb.string=t;var e=null;for(var i in this.cell_data_list){var s=this.cell_data_list[i];s.rank1&&s.rank2?t>=s.rank1&&t<=s.rank2&&(e=s):s.rank1&&t<=s.rank1&&(e=s)}if(e){var n=Utils.getArrLen(e.award),a=.8*BackPackItem.Width,o=(a+10)*n,l=Math.max(this.item_scrollview_size.width,o);this.item_content_nd.setContentSize(l,this.item_scrollview_size.height),this.item_content_nd.x=0;var r=0;for(var i in e.award){var c=e.award[i];if(!this.item_list[i]){var _=ItemsPool.getInstance().getItem("backpack_item");_.initConfig(!1,.8,!1,!0),_.show(),_.setParent(this.item_content_nd),_.setData({bid:c.bid,num:c.num}),_.setPosition(r*(a+10)+60,0),this.item_list[i]=_,r+=1}}}}},updateRankList:function(){if(this.common_scrollview)this.common_scrollview.setData(this.cell_data_list);else{var t=this.seekChild(this.main_container,"lay_scrollview"),e=t.getContentSize(),i=cc.size(e.width,e.height),s={item_class:a,start_x:0,space_x:0,start_y:0,space_y:0,item_width:634,item_height:142,row:0,col:1,need_dynamic:!0};this.common_scrollview=new n,this.common_scrollview.createScroll(t,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,i,s,cc.v2(.5,.5)),this.common_scrollview.setData(this.cell_data_list)}},showEmptyIcon:function(t){if(this.empty_con||0!=t){if(!this.empty_con){var e=cc.size(200,200);this.empty_con=new cc.Node,this.empty_con.setContentSize(e),this.empty_con.setAnchorPoint(cc.v2(.5,.5)),this.empty_con.setPosition(cc.v2(0,0)),this.main_panel.addChild(this.empty_con);var i=s.getBigBg("bigbg_3");this.empty_bg=Utils.createImage(this.empty_con,null,0,0,cc.v2(.5,.5),!1),this.loadRes(i,function(t){this.empty_bg.spriteFrame=t}.bind(this)),this.empty_label=Utils.createLabel(26,new cc.Color(104,69,42,255),null,0,-100,"",this.empty_con,0,cc.v2(.5,.5))}var n=Utils.TI18N("\u6682\u65e0\u5956\u52b1\u6570\u636e");this.empty_label.string=n,this.empty_con.active=t}},closeCallBack:function(){if(this.common_scrollview&&(this.common_scrollview.deleteMe(),this.common_scrollview=null),this.item_list){for(var t in this.item_list)this.item_list[t].deleteMe(),this.item_list[t]=null;this.item_list=null}this.empty_con&&(this.empty_con.destroy(),this.empty_label.destroy(),this.empty_bg.destroy(),this.empty_con=null,this.empty_bg=null,this.empty_label=null),this.ctrl.openRankRewardPanel(!1)}});cc._RF.pop()},{action_controller:"action_controller",action_event:"action_event",common_scrollview:"common_scrollview",pathtool:"pathtool",rank_controller:"rank_controller",rank_reward_item:"rank_reward_item"}],rank_window:[function(t,e,i){"use strict";function s(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}cc._RF.push(e,"d479flo5JFEjZMiSRZD80qE","rank_window");var n=t("pathtool"),a=t("rank_controller"),o=t("rank_constant"),l=t("rank_event"),r=t("arena_event"),c=t("common_scrollview"),_=t("rank_item"),h=t("role_controller"),d=t("playerhead"),u=t("timetool"),m=t("hero_vo"),f=cc.Class({extends:BaseView,ctor:function(){this.prefabPath=n.getPrefabPath("rank","rank_window"),this.win_type=WinType.Big,this.viewTag=SCENE_TAG.dialogue,this.ctrl=a.getInstance(),this.cur_type=0,this.res_list={},this.tab_info_list={},this.first_list={},this.click_index=arguments[0]||1,this.is_cluster=arguments[1]||!1,this.node_list=[]},openCallBack:function(){this.background=this.seekChild("background"),this.background.scale=FIT_SCALE,this.main_panel=this.seekChild("main_container"),this.close_btn=this.seekChild(this.main_panel,"close_btn"),this.rank_panel=this.seekChild(this.main_panel,"rank_panel"),this.my_rank=this.seekChild(this.main_panel,"my_rank"),this.seekChild(this.my_rank,"title",cc.Label).string=Utils.TI18N("\u6211\u7684\u6392\u540d"),this.rank_index=this.seekChild(this.my_rank,"rank_id",cc.Label),this.four_label=this.seekChild(this.my_rank,"four_label",cc.RichText),this.my_rank_power=this.seekChild(this.my_rank,"my_rank_power",cc.Label),this.my_head=new d,this.my_head.setParent(this.my_rank),this.my_head.show(),this.my_head.setPosition(-155,60),this.my_head.setScale(.9),this.no_rank=this.seekChild(this.my_rank,"no_rank",cc.Label),this.my_name=this.seekChild(this.my_rank,"my_name",cc.Label),this.no_rank.string="\u672a\u4e0a\u699c",this.my_name.string="",this.title_con=this.seekChild(this.main_panel,"title_con");var t=this.seekChild(this.title_con,"title_label",cc.Label),e=o.TitleName[this.click_index]||"";t.string=e,this.top_bg=this.seekChild(this.main_panel,"top_bg",cc.Sprite),this.top_bg.node.setScale(.9,.9);var i=n.getBigBg("rank_1",null,"rank");this.loadRes(i,function(t){this.top_bg.spriteFrame=t}.bind(this)),this.top_container=this.seekChild("top_container"),this.top_rank_list={};for(var s=1;s<=3;s++){var a=this.seekChild(this.top_container,"name_"+s,cc.Label),l=this.seekChild(this.top_container,"guan_"+s);null==this.top_rank_list[s]&&(this.top_rank_list[s]={},this.top_rank_list[s].label=a,this.top_rank_list[s].img=l)}this.updateTitle()},registerEvent:function(){if(this.background.on(cc.Node.EventType.TOUCH_END,function(){this.ctrl.openRankView(!1)},this),this.close_btn.on(cc.Node.EventType.TOUCH_END,function(){this.ctrl.openRankView(!1)},this),this.addGlobalEvent(l.RankEvent_Get_Rank_data,function(t){this.updateRankList(t)},this),this.addGlobalEvent(r.UpdateLoopChallengeRank,function(t){this.updateRankList(t)},this),this.addGlobalEvent(l.RankEvent_Get_Time_event,function(t){if(t&&this.click_index){var e=this.click_index||o.RankType.drama;t.type&&e!=t.type||this.senProto(e)}},this),this.click_index==o.RankType.union_boss){var e=t("guildboss_event"),i=t("guildboss_const");this.addGlobalEvent(e.UpdateGuildDunRank,function(t,e){e==i.rank.role&&this.updateRankList(t)},this);var s=t("role_event");this.addGlobalEvent(s.WorshipOtherRole,function(t){cc.log(t,this.select_item),null!=t.idx&&null!=this.select_item&&null!=this.select_item.data&&t.idx==this.select_item.data.rank&&this.select_item.updateWorshipStatus()},this)}},openRootWnd:function(e){if(null==e)this.ctrl.send_12901(this.click_index,this.is_cluster);else{this.data=e;var i={boss_id:this.data.boss_id,start_num:1,end_num:100},s=t("guildboss_const");t("guildboss_controller").getInstance().requestGuildDunRank(s.rank.role,i)}},updateTitle:function(){for(var t=o.RankTitle[this.click_index]||{},e=Object.keys(t).length||0,i=o.TitlePos[this.click_index]||{},s=o.TitleLinePos[this.click_index]||{},n=1;n<=e;n++){n!=e&&this.createImage(s[n]);var a=i[n]||0,l=Utils.createLabel(24,new cc.Color(104,69,42,255),null,a-336,230,"",this.main_panel,0,cc.v2(0,.5)),r=t[n]||"";l.string=r,this.node_list.push(l)}},createImage:function(t){var e=t||0,i=n.getCommonIcomPath("common_1069"),s=Utils.createImage(this.main_panel,i,e-338,230,cc.v2(0,.5),!0,1,!1);this.loadRes(i,function(t){s.spriteFrame=t}.bind(this)),s.node.setScale(1,.8),this.node_list.push(s)},updateRankList:function(t){if(this.data=t,this.updateMyData(),this.updateRankData(),!this.list_view){var e=cc.size(610,530),i={item_class:_,start_x:5,space_x:0,start_y:0,space_y:0,item_width:600,item_height:120,row:0,col:1,need_dynamic:!0};this.list_view=new c,this.list_view.createScroll(this.rank_panel,cc.v2(0,-28),ScrollViewDir.vertical,ScrollViewStartPos.top,e,i,cc.v2(.5,.5))}if(t&&null!=Utils.next(t)){var s=t.rank_list||{};this.showEmptyIcon(!1),s.length<=0&&this.showEmptyIcon(!0);var n=function(t,e){};this.click_index==o.RankType.union_boss&&(n=function(t){this.worshipOtherRole(t)}.bind(this)),this.list_view.setData(s,n,{rank_type:this.click_index,is_cluster:this.is_cluster})}else this.senProto(this.click_index)},worshipOtherRole:function(t){null!=t.data&&(this.select_item=t)},showEmptyIcon:function(t){if(this.empty_con||0!=t){if(!this.empty_con){var e=cc.size(200,200);this.empty_con=new cc.Node,this.empty_con.setContentSize(e),this.empty_con.setAnchorPoint(cc.v2(.5,.5)),this.empty_con.setPosition(cc.v2(0,0)),this.main_panel.addChild(this.empty_con);var i=n.getBigBg("bigbg_3");this.empty_bg=Utils.createImage(this.empty_con,null,0,0,cc.v2(.5,.5),!1),this.loadRes(i,function(t){this.empty_bg.spriteFrame=t}.bind(this)),this.empty_label=Utils.createLabel(26,new cc.Color(104,69,42,255),null,0,-100,"",this.empty_con,0,cc.v2(.5,.5))}var s=Utils.TI18N("\u5f53\u524d\u6392\u884c\u699c\u6682\u65e0\u6570\u636e");this.empty_label.string=s,this.empty_con.active=t}},senProto:function(e){if(e==o.RankType.union)this.ctrl.send_12903();else if(e==o.RankType.arena){t("arena_controller").getInstance().sender20221()}else if(e==o.RankType.action_partner)this.ctrl.send_12904(0,100);else{2!=e&&3!=e&&6!=e&&18!=e||300,this.ctrl.send_12900(e,null,null,this.is_cluster)}},updateMyData:function(){if(this.data){var t=this.data,e="0",i=t.my_idx||t.rank||0;i&&i>0&&(e=i),this.no_rank.node.active=!1;var s=h.getInstance().getRoleVo();this.rank_index.string=e,i&&i>=1&&i<=3?(this.rank_index.node.active=!1,this.my_rank_icon||(this.my_rank_icon=this.seekChild(this.my_rank,"my_rank_icon",cc.Sprite)),this.my_rank_icon.node.active=!0,this.loadRes(n.getCommonIcomPath("common_200"+i),function(t){this.my_rank_icon.spriteFrame=t}.bind(this)),this.my_rank_icon.node.setScale(.7)):i<=0?(this.no_rank.node.active=!0,this.rank_index.node.active=!1):(this.rank_index.node.active=!0,this.my_rank_icon&&(this.my_rank_icon.node.active=!1)),this.my_head.setHeadRes(s.face_id);var a=s.name||"";this.my_name.string=a;var l=s.avatar_base_id;this.my_head.setFrameRes(l);e="";var r=null;if(this.my_rank_power.node.x=207,this.four_label.node.x=244,this.four_label.node.active=!0,this.rune_item&&(this.rune_item.active=!1),this.my_rank_power.string="",this.four_label.node.setPosition(cc.v2(174,50)),this.click_index==o.RankType.power||this.click_index==o.RankType.action_power){r=n.getCommonIcomPath("common_90002");var c=t.my_val1||0;e=cc.js.formatStr("<img src='%s' /> %s","common_90002",c)}else if(this.click_index==o.RankType.drama||this.click_index==o.RankType.action_drama){var _=gdata("dungeon_data","data_drama_dungeon_info",[t.my_val1]);_&&(e=_.name)}else if(this.click_index==o.RankType.union){e=cc.js.formatStr("<size=20><color=#a95f0f>\u4f1a\u957f\u540d\uff1a%s</c></size>",t.leader_name),0==s.gid&&(e=Utils.TI18N("\u6682\u65e0\u516c\u4f1a")),this.my_name.string=s.name,this.my_name.node.setPosition(cc.v2(-106,82)),this.my_head.setVisible(!1),this.four_label.node.setPosition(cc.v2(-106,45));c=t.power||0;this.my_rank_power.string=c<=0?"0":c,this.my_rank_power.node.x=225}else if(this.click_index==o.RankType.tower||this.click_index==o.RankType.action_tower){var d=t.my_val2||0,m=u.getTimeMs(d,!0);t.my_val1&&0==t.my_val1&&(m="",this.four_label.node.active=!1),this.my_head.setVisible(!0),this.my_name.node.x=0,this.my_rank_power.string=m,e=t.my_val1.toString()||"",this.my_name.node.y=53,this.four_label.node.setPosition(cc.v2(109,53)),this.my_rank_power.node.setPosition(cc.v2(219,53))}else if(this.click_index==o.RankType.arena||this.click_index==o.RankType.action_arena){r=n.getItemRes("8");var f=this.data.score||this.data.my_val1||0;e=cc.js.formatStr("<img src='%s' scale=0.35 /> %s",8,f)}else if(this.click_index==o.RankType.union_boss)this.four_label.node.active=!0,this.four_label.node.setPosition(cc.v2(174,50)),this.my_name.node.setPosition(cc.v2(-36,53)),this.my_rank_power.node.setPosition(cc.v2(219,53)),this.four_label.string=String(t.mydps||0);else if(this.click_index==o.RankType.action_star||this.click_index==o.RankType.star_power);else if(this.click_index==o.RankType.adventure){e=t.my_val1.toString()||0;var p=0!=t.my_val2&&t.my_val2||"";this.my_rank_power.string=p,this.four_label.node.setPosition(cc.v2(109,53)),this.my_rank_power.node.setPosition(cc.v2(219,53))}0==e&&(e=""),this.four_label.string=e,this.loadRes(r,function(t){this.four_label.spriteFrame=t}.bind(this))}},createPartnerVo:function(){var t=new m,e={partner_id:self.data.pid,bid:self.data.pbid,lev:self.data.plev,star:self.data.pstar};return t.updateHeroVo(e),t},updateRankData:function(){var e;if(this.data){var i=this.data.rank_list||{},n=0,a=this.main_panel.getContentSize();for(var o in i){var l=i[o],r=l.idx||l.rank;if(r>0&&r<=3){if(n+=1,!this.first_list[r]){var c=new d;c.show();var _=0,u=380;2==r?(_=-170,u=370,6):3==r&&(_=170,u=370,6),c.setPosition(_,u),c.setParent(this.main_panel),(g=this.top_rank_list[n].label).node.active=!0;var m=this.top_rank_list[n].img;m.active=!0,this.first_list[r]=m,this.first_list[r]=c,this.first_list[r].head_name=g}var f=l.face_id||l.face||l.leader_face||0,p=l.avatar_id||l.avatar_bid||l.leader_avatar_bid||0;this.first_list[r].setFrameRes(p),this.first_list[r].setHeadRes(f),this.first_list[r].addCallBack(function(e){var i=h.getInstance().getRoleVo(),s=e.rid||e.leader_rid||0,n=e.srv_id||e.leader_srvid||0;if(i.rid!=s||i.srv_id!=n){var a={rid:s,srv_id:n};t("chat_controller").getInstance().openFriendInfo(a)}}.bind(this,l));var g=l.name||"";this.first_list[r].head_name.string=g}if(n>=3)break}for(var o in this.no_label_list||(this.no_label_list={}),this.no_label_list)this.no_label_list[o].setVisible(!1);var v=(s(e={},1,336-a.width/2),s(e,2,167-a.width/2),s(e,3,508-a.width/2),e);if(i.length<3)for(o=i.length+1;o<=3;o++){if(!this.no_label_list[o]){var b=Utils.createLabel(24,null,null,v[o],360,Utils.TI18N("\u865a\u4f4d\u4ee5\u5f85"),this.main_panel,0,cc.v2(.5,.5));this.no_label_list[o]=b.node,this.node_list.push(b),this.top_rank_list[o]&&(this.top_rank_list[o].label.node.active=!1,this.top_rank_list[o].img.active=!1)}this.no_label_list[o].active=!0}}},closeCallBack:function(){if(this.list_view&&this.list_view.DeleteMe(),this.list_view=null,this.ctrl.openRankView(!1),this.empty_con&&(this.empty_con.destroy(),this.empty_label.destroy(),this.empty_bg.destroy(),this.empty_con=null,this.empty_bg=null,this.empty_label=null),this.node_list){for(var t in this.node_list){var e=this.node_list[t];e instanceof cc.Node?(e.destroy(),e=null):(e.node.destroy(),e=null)}this.node_list=null}if(this.my_head&&(this.my_head.deleteMe(),this.my_head=null),this.first_list){for(var i in this.first_list)this.first_list[i]&&(this.first_list[i].deleteMe(),this.first_list[i]=null);this.first_list=null}}});e.exports=f,cc._RF.pop()},{arena_controller:"arena_controller",arena_event:"arena_event",chat_controller:"chat_controller",common_scrollview:"common_scrollview",guildboss_const:"guildboss_const",guildboss_controller:"guildboss_controller",guildboss_event:"guildboss_event",hero_vo:"hero_vo",pathtool:"pathtool",playerhead:"playerhead",rank_constant:"rank_constant",rank_controller:"rank_controller",rank_event:"rank_event",rank_item:"rank_item",role_controller:"role_controller",role_event:"role_event",timetool:"timetool"}],recruit_hero_window:[function(t,e,i){"use strict";cc._RF.push(e,"15c822qJFxNwbARbTTePDh2","recruit_hero_window");var s=t("pathtool"),n=t("action_controller"),a=(t("hero_controller"),t("jump_controller")),o=t("recruithero_event");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("recruithero","recruit_hero_window"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Big,this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){this.player_item=[]},openCallBack:function(){this.background=this.root_wnd.getChildByName("background"),this.background.scale=FIT_SCALE,this.main_container=this.root_wnd.getChildByName("main_container"),this.load_bg=this.main_container.getChildByName("load_bg").getComponent(cc.Sprite);var t=s.getBigBg("action_bigbg_3",null,"action");this.loadRes(t,function(t){this.load_bg.spriteFrame=t}.bind(this)),this.main_container.getChildByName("Text_1").getComponent(cc.Label).string=Utils.TI18N("\u6d3b\u52a8\u65f6\u95f4\uff1a"),this.main_container.getChildByName("Text_3").getComponent(cc.Label).string=Utils.TI18N("\u5b8c\u6210\u4e0a\u65b9\u4efb\u52a1\u5373\u53ef\u514d\u8d39\u9886\u53d65\u661f\u82f1\u96c4\u65af\u82ac\u514b\u65af"),this.remain_time=this.main_container.getChildByName("remain_time").getComponent(cc.Label),this.remain_time.string="",this.all_get=this.main_container.getChildByName("all_get"),this.all_get.active=!1,this.all_get.getChildByName("label").getComponent(cc.Label).string=Utils.TI18N("\u9886\u53d6"),this.all_goto=this.main_container.getChildByName("all_goto"),this.all_goto.active=!1,this.all_goto.getChildByName("label").getComponent(cc.Label).string=Utils.TI18N("\u672a\u5b8c\u6210"),this.btn_paint=this.main_container.getChildByName("btn_paint"),this.btn_paint.getChildByName("Text_2").getComponent(cc.Label).string=Utils.TI18N("\u6218\u6597\u9884\u89c8"),this.finish_text=this.main_container.getChildByName("finish_text").getComponent(cc.Label),this.finish_text.string="",this.setPlayerItem(),this.btn_close=this.main_container.getChildByName("btn_close")},setPlayerItem:function(){for(var t=[29905,26900,26903],e=0;e<3;e++){var i={},s=this.main_container.getChildByName("item_"+(parseInt(e)+1));i.btn_goto=s.getChildByName("btn_goto"),i.btn_goto.active=!1,i.btn_goto.getChildByName("label").getComponent(cc.Label).string=Utils.TI18N("\u524d\u5f80\u5b8c\u6210"),i.btn_get=s.getChildByName("btn_get"),i.btn_get.active=!1,i.btn_get_label=i.btn_get.getChildByName("label").getComponent(cc.Label),i.btn_get_label.string=Utils.TI18N("\u524d\u5f80\u9886\u53d6"),i.has=s.getChildByName("has"),i.has.active=!1,i.title_label=s.getChildByName("title").getComponent(cc.Label),this.player_item[e]=ItemsPool.getInstance().getItem("backpack_item"),this.player_item[e].setParent(s),this.player_item[e].initConfig(!1,.8),this.player_item[e].setPosition(100-s.width/2,114-s.height/2),this.player_item[e].setData({bid:t[e],num:50}),this.player_item[e].show(),this.player_item[e].setDefaultTip(),this.player_item[e]=i}},registerEvent:function(){for(var t in this.addGlobalEvent(o.RecruitHeroBaseInfo,function(t){var e=n.getInstance(),i=t.end_time-gcore.SmartSocket.getTime();e.getModel().setCountDownTime(this.remain_time,i),this.showBtnStatus(t)}.bind(this)),Utils.onTouchEnd(this.btn_close,function(){this.ctrl.openRecruitHeroWindow(!1)}.bind(this),2),Utils.onTouchEnd(this.background,function(){this.ctrl.openRecruitHeroWindow(!1)}.bind(this),2),Utils.onTouchEnd(this.all_get,function(){this.ctrl.sender25101(0)}.bind(this),2),Utils.onTouchEnd(this.btn_paint,function(){this.ctrl.sender25102()}.bind(this),1),this.player_item)Utils.onTouchEnd(this.player_item[t].btn_goto,function(t){this.model.getRecruitEndTime()?(1!=t&&this.ctrl.openRecruitHeroWindow(!1),this.jumpGotoTeskView(t)):message(Utils.TI18N("\u6d3b\u52a8\u5df2\u7ed3\u675f"))}.bind(this,t),1),Utils.onTouchEnd(this.player_item[t].btn_get,function(t){this.jumpGetTeskView(t)}.bind(this,t),1)},showBtnStatus:function(t){if(t){for(var e=[Utils.TI18N("\u901a\u5173%d/%d\u5173"),Utils.TI18N("\u6b21\u65e5\u767b\u5f55"),Utils.TI18N("\u6fc0\u6d3b\u81f3\u5c0a\u6708\u5361")],i=Config.welfare_data.data_welfare_const.dun_max_id,s=0,n=[2,1,3],a=0;a<3;a++){var o=this.model.getRecruitBaseData(n[a]);o&&(this.player_item[a].title_label.string=0==a?cc.js.formatStr(e[a],o.val,i.val):e[a],2==a&&1==o.status&&(this.player_item[a].btn_get_label.string=Utils.TI18N("\u9886\u53d6")),this.player_item[a].btn_goto.active=0==o.status,this.player_item[a].btn_get.active=1==o.status,this.player_item[a].has.active=2==o.status,1!=o.status&&2!=o.status||(s+=1))}var l=cc.js.formatStr(Utils.TI18N("\u5b8c\u6210\u8fdb\u5ea6: %d/3"),s);this.finish_text.string=l,null!=t.state&&(this.all_goto.active=0==t.state,this.all_get.active=1==t.state||1==t.state)}},jumpGotoTeskView:function(t){null!=t&&(0==t?a.getInstance().jumpViewByEvtData([5]):1==t?n.getInstance().openSevenLoginWin(!0):2==t&&a.getInstance().jumpViewByEvtData([44]))},jumpGetTeskView:function(t){null!=t&&(0==t?a.getInstance().jumpViewByEvtData([46]):1==t?n.getInstance().openSevenLoginWin(!0):2==t&&this.ctrl.sender25101(parseInt(t)+1))},openRootWnd:function(){this.ctrl.sender25100(),this.model.setDayFirstLogin(!1)},closeCallBack:function(){if(this.player_item&&null!=Utils.next(this.player_item||[]))for(var t in this.player_item)this.player_item[t]&&this.player_item[t].deleteMe&&this.player_item[t].deleteMe();this.player_item=[],this.remain_time&&this.remain_time.node&&this.remain_time.node.stopAllActions(),this.ctrl.openRecruitHeroWindow(!1)}});cc._RF.pop()},{action_controller:"action_controller",hero_controller:"hero_controller",jump_controller:"jump_controller",pathtool:"pathtool",recruithero_event:"recruithero_event"}],recruithero_controller:[function(t,e,i){"use strict";cc._RF.push(e,"1bb41FclCZKzqq29ylNMALt","recruithero_controller");var s=t("recruithero_event"),n=cc.Class({extends:BaseController,ctor:function(){},initConfig:function(){var e=t("recruithero_model");this.model=new e,this.model.initConfig()},getModel:function(){return this.model},registerEvents:function(){},registerProtocals:function(){this.RegisterProtocal(25100,this.handle25100),this.RegisterProtocal(25101,this.handle25101),this.RegisterProtocal(25102,this.handle25102)},sender25100:function(){this.SendProtocal(25100,{})},handle25100:function(t){this.model.setRecruitEndTime(t.end_time),this.model.setRecruitBaseData(t),this.model.setStatusRedPoint(t),gcore.GlobalEvent.fire(s.RecruitHeroBaseInfo,t)},sender25101:function(t){var e={};e.id=t,this.SendProtocal(25101,e)},handle25101:function(t){message(t.msg)},sender25102:function(){this.SendProtocal(25102,{})},handle25102:function(t){message(t.msg)},openRecruitHeroWindow:function(t){1==t?(this.recruit_hero_window||(this.recruit_hero_window=Utils.createClass("recruit_hero_window",this)),this.recruit_hero_window&&0==this.recruit_hero_window.isOpen()&&this.recruit_hero_window.open()):this.recruit_hero_window&&(this.recruit_hero_window.close(),this.recruit_hero_window=null)}});e.exports=n,cc._RF.pop()},{recruithero_event:"recruithero_event",recruithero_model:"recruithero_model"}],recruithero_event:[function(t,e,i){"use strict";cc._RF.push(e,"d1ee2SksolNWKlScOwj5wCD","recruithero_event");var s={RecruitHeroBaseInfo:"RecruitHeroEvent.RecruitHeroBaseInfo"};e.exports=s,cc._RF.pop()},{}],recruithero_model:[function(t,e,i){"use strict";cc._RF.push(e,"387b8w5WehH/pwvOMujk78A","recruithero_model");var s=t("battle_drama_controller"),n=t("mainui_controller"),a=t("mainui_const");cc.Class({extends:BaseClass,ctor:function(){},properties:{},initConfig:function(){this.day_first_login=!0},setDayFirstLogin:function(t){this.day_first_login=t},getDramaDunMaxID:function(){var t=1,e=s.getInstance().getModel().getDramaData();if(e&&e.max_dun_id){var i=gdata("dungeon_data","data_drama_dungeon_info",e.max_dun_id);i&&(t=i.floor||1)}return t},setRecruitEndTime:function(t){var e=t-gcore.SmartSocket.getTime();this.recruit_status=!(e<=0)},getRecruitEndTime:function(){return!!this.recruit_status&&this.recruit_status},setRecruitBaseData:function(t){if(this.recruit_data=[],t.quests)for(var e in t.quests)this.recruit_data[t.quests[e].id]=t.quests[e]},getRecruitBaseData:function(t){return this.recruit_data[t]?this.recruit_data[t]:null},setStatusRedPoint:function(t){if(t){var e=Config.function_data.data_info[a.icon.limit_recruit];if(0!=n.getInstance().checkIsOpenByActivate(e.activate)){var i=this.day_first_login;if(!i){var s=!1;if(t.quests)for(var o in t.quests)if(1==t.quests[o].status){s=!0;break}i=s}if(!i){var l=!1;t.state&&1==t.state&&(l=!0),i=l}n.getInstance().setFunctionTipsStatus(a.icon.limit_recruit,i)}}}});cc._RF.pop()},{battle_drama_controller:"battle_drama_controller",mainui_const:"mainui_const",mainui_controller:"mainui_controller"}],red_mgr:[function(t,e,i){"use strict";function s(t){"@babel/helpers - typeof";return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}cc._RF.push(e,"09beffHJFVKu66tOjY0aWs1","red_mgr"),window.RedIds={PartnerSummon:1,Endless:2,StoneDungeon:3,Primus:4,Heroexpedit:5,StarTower:6,Hallow:7,NewfirstchargeModel:8,HeroAll:21,RefuseHero:22,GuildDonate:10,GuildActive:11,GuildBoss:12,GuildSkill:13,Ladder:101},window.RedMgr=cc.Class({ctor:function(){this.handler_queue=[]},addCalHandler:function(t,e){if(t){if(e){var i={};i.handler=t,i.id=e;var n=!1;for(var a in this.handler_queue)if("object"==s(this.handler_queue[a])&&this.handler_queue[a].id===e){n=!0;break}if(n)return;t=i}this.handler_queue.push(t),this.mainloop_timer||(this.mainloop_timer=gcore.Timer.set(this.mainloop.bind(this),1e3,-1))}},mainloop:function(){var t=this.handler_queue.shift();t&&("function"==typeof t?t():(t=t.handler)&&t()),0==this.handler_queue.length&&this.mainloop_timer&&(gcore.Timer.del(this.mainloop_timer),this.mainloop_timer=null)}}),RedMgr.getInstance=function(){return RedMgr.instance||(RedMgr.instance=new RedMgr),RedMgr.instance},e.exports=RedMgr,cc._RF.pop()},{}],redbag_controller:[function(t,e,i){"use strict";cc._RF.push(e,"941a7QZuwtDCbqK0qoAhlio","redbag_controller");t("role_controller");var s=t("mainui_event"),n=t("redbag_event"),a=cc.Class({extends:BaseController,ctor:function(){},initConfig:function(){var e=t("redbag_model");this.model=new e,this.model.initConfig(),this.red_bag_vo=null},getModel:function(){return this.model},registerEvents:function(){this.role_create_success||(this.role_create_success=gcore.GlobalEvent.bind(EventId.EVT_ROLE_CREATE_SUCCESS,function(){gcore.GlobalEvent.unbind(this.role_create_success),this.role_create_success=null,this.role_vo&&null==this.role_update_event&&(this.role_update_event=this.role_vo.bind(EventId.UPDATE_ROLE_ATTRIBUTE,function(t,e){"gid"==t&&0==e&&this.model.resetData()}.bind(this)))}.bind(this))),this.red_bg_event||(this.red_bg_event=gcore.GlobalEvent.bind(s.CLOSE_ITEM_VIEW,function(t){if(t&&t.is_red_bag&&1==t.is_red_bag){var e=this.model.getRedBagListById(t.info_data.id);null!=e&&this.openLookWindow(!0,e)}}.bind(this)))},registerProtocals:function(){this.RegisterProtocal(13534,this.handle13534),this.RegisterProtocal(13535,this.handle13535),this.RegisterProtocal(13536,this.handle13536),this.RegisterProtocal(13546,this.handle13546),this.RegisterProtocal(13540,this.handle13540),this.RegisterProtocal(13545,this.handle13545)},openMainView:function(t,e){0==t?this.main_window&&(this.main_window.close(),this.main_window=null):(null==this.main_window&&(this.main_window=Utils.createClass("redbag_window",e)),this.main_window.open())},openLookWindow:function(t,e){0==t?this.look_window&&(this.look_window.close(),this.look_window=null):(null==this.look_window&&(this.look_window=Utils.createClass("redbag_look_window",e)),this.look_window.open(e))},sender13534:function(){this.SendProtocal(13534,{})},handle13534:function(t){this.model.updateData(t)},sender13535:function(t,e){var i={};i.type=t,i.num=1,i.msg_id=0,i.loss_type=e,this.SendProtocal(13535,i)},handle13535:function(t){t&&message(t.msg)},sender13536:function(t){var e={};e.id=t,this.SendProtocal(13536,e)},handle13536:function(t){message(t.msg),1==t.code&&this.openRegBagWindow(!0,t)},sender13540:function(t){var e={};e.id=t,this.SendProtocal(13540,e)},handle13540:function(t){gcore.GlobalEvent.fire(n.Get_List_Event,t)},sender13545:function(){this.SendProtocal(13545,{})},handle13545:function(t){gcore.GlobalEvent.fire(n.Rank_List_Event,t)},setRedBagVo:function(t){this.red_bag_vo=t},openRegBagWindow:function(t,e){0==t?this.open_window&&(this.open_window.close(),this.open_window=null):(null==this.open_window&&(this.open_window=Utils.createClass("redbag_open_window",e)),this.open_window.open(e))},send13546:function(){this.SendProtocal(13546,{})},handle13546:function(t){gcore.GlobalEvent.fire(n.Update_Red_Bag_Event,t.list)}});e.exports=a,cc._RF.pop()},{mainui_event:"mainui_event",redbag_event:"redbag_event",redbag_model:"redbag_model",role_controller:"role_controller"}],redbag_event:[function(t,e,i){"use strict";cc._RF.push(e,"e31f4TVb1FCb5VEORkjk2NU","redbag_event"),e.exports={Get_Data_Event:"Get_Data_Event",Get_List_Event:"Get_List_Event",Rank_List_Event:"Rank_List_Event",Can_Get_Red_Bag:"Can_Get_Red_Bag",Update_Red_Bag_Event:"Update_Red_Bag_Event"},cc._RF.pop()},{}],redbag_get_panel:[function(t,e,i){"use strict";cc._RF.push(e,"15396kjHj1NibLl/U70p8HI","redbag_get_panel");var s=t("pathtool"),n=t("redbag_controller"),a=t("redbag_event"),o=t("redbag_item"),l=t("common_scrollview"),r=cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("redbag","redbag_get"),this.ctrl=n.getInstance(),this.size=cc.v2(644,740),this.bool=!1},initPanel:function(){this.main_panel=this.seekChild("main_panel"),this.empty_con&&this.showEmptyIcon(this.bool),this.updateBagList(),null!=this.is_event&&this.updateBagList(this.is_event)},registerEvent:function(t){this.update_data_event||(this.update_data_event=gcore.GlobalEvent.bind(a.Get_Data_Event,function(){this.updateBagList(!0)}.bind(this)))},updateBagList:function(t){if(null!=this.root_wnd){var e=this.ctrl.getModel().getRedBagList()||[],i=Utils.deepCopy(e);if(i&&null!=Utils.next(i)){this.showEmptyIcon(!1);var s=Utils.tableUpperSorter(["order"]);if(i.sort(s),!this.scroll_view){var n=cc.size(570,790),a={item_class:o,start_x:10,space_x:23,start_y:5,space_y:10,item_width:262,item_height:327,row:2,col:2,need_dynamic:!0};this.scroll_view=new l,this.scroll_view.createScroll(this.main_panel,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,n,a,cc.v2(.5,.5))}this.scroll_view.setRootVisible(!0);var r=function(t,e){e&&null!=Utils.next(e)&&(1==t.getIsCanGet()?(this.ctrl.sender13536(e.id),this.ctrl.setRedBagVo(e)):this.ctrl.openLookWindow(!0,e))}.bind(this);this.scroll_view.setData(i,r)}else this.showEmptyIcon(!0),this.scroll_view&&this.scroll_view.setRootVisible(!1)}else this.is_event=t},setVisibleStatus:function(t){this.setVisible(t),this.registerEvent(t),1==t&&this.root_wnd&&this.updateBagList()},updateListData:function(t){var e=this.scroll_view.getItemList(),i=1;for(var s in t){var n=t[s];e[i]&&e[i].setData(n),i+=1}},showEmptyIcon:function(t){if((this.empty_con||0!=t)&&null!=this.main_panel){if(this.bool=t,!this.empty_con){var e=cc.size(200,200);this.empty_con=new cc.Node,this.empty_con.setContentSize(e),this.empty_con.setAnchorPoint(cc.v2(.5,.5)),this.empty_con.setPosition(cc.v2(0,0)),this.main_panel.addChild(this.empty_con);var i=s.getBigBg("bigbg_3");this.empty_bg=Utils.createImage(this.empty_con,null,0,0,cc.v2(.5,.5),!1),this.loadRes(i,function(t){this.empty_bg.spriteFrame=t}.bind(this)),this.empty_label=Utils.createLabel(26,new cc.Color(104,69,42,255),null,0,-100,"",this.empty_con,0,cc.v2(.5,.5))}var n=Utils.TI18N("\u5f53\u524d\u6ca1\u6709\u53ef\u4ee5\u62a2\u7684\u7ea2\u5305\uff0c\u4e0d\u6765\u4e00\u53d1\u5417\uff1f");this.empty_label.string=n,this.empty_con.active=t}},openRootWnd:function(){},onShow:function(){},setData:function(t){},onDelete:function(){this.empty_con&&(this.empty_con.destroy(),this.empty_label.destroy(),this.empty_bg.destroy(),this.empty_con=null,this.empty_bg=null,this.empty_label=null),this.scroll_view&&(this.scroll_view.DeleteMe(),this.scroll_view=null),this.update_data_event&&(gcore.GlobalEvent.unbind(this.update_data_event),this.update_data_event=null)}});e.exports=r,cc._RF.pop()},{common_scrollview:"common_scrollview",pathtool:"pathtool",redbag_controller:"redbag_controller",redbag_event:"redbag_event",redbag_item:"redbag_item"}],redbag_item:[function(t,e,i){"use strict";cc._RF.push(e,"88377cpDnpKV5ON+lkTC+0z","redbag_item");var s=t("pathtool"),n=cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("redbag","redbag_item"),this.data=null,this.item_list={},this.is_show_point=!1,this.open_type=0,this.star_list={},this.is_can_get=!0,this.zindex=null,this.action=null,this.func=null,this.black_bool=null,this.scale=null},initPanel:function(){this.main_panel=this.seekChild("main_panel"),this.label_panel=this.seekChild("label_panel"),this.title=this.seekChild(this.main_panel,"title",cc.Label),this.title.string=Utils.TI18N("\u6211\u662f\u7ea2\u5305\u6807\u9898"),this.coin_icon=this.seekChild(this.main_panel,"coin_icon",cc.Sprite);var t=s.getUIIconPath("redbag","redbag_4");this.loadRes(t,function(t){this.coin_icon.spriteFrame=t}.bind(this)),this.black_bg=this.seekChild(this.main_panel,"black_bg"),this.black_bg.active=!0,this.finish_icon=this.seekChild(this.main_panel,"finish_icon"),this.finish_icon.active=!1,this.status_icon=this.seekChild(this.main_panel,"status_icon",cc.Sprite),this.status_icon.node.active=!1,this.get_status=this.seekChild(this.main_panel,"get_status"),this.get_status.active=!1,this.desc_label=this.seekChild(this.label_panel,"desc_label",cc.RichText),this.role_name=this.seekChild(this.label_panel,"role_name",cc.RichText),this.other_label=this.seekChild(this.label_panel,"other_label",cc.RichText),this.other_label.node.active=!1,this.other_label.string=Utils.TI18N("\u5411\u516c\u4f1a\u53d1\u9001\u5927\u91cf\u91d1\u5e01"),null!=this.zindex&&this.setLocalZOrder(this.zindex),null!=this.action&&this.runActionFunc(this.action,this.func),null!=this.black_bool&&this.showBlackBg(this.black_bool),null!=this.scale&&this.setScale(this.scale)},registerEvent:function(){this.root_wnd.on(cc.Node.EventType.TOUCH_END,function(){this.call_fun&&this.call_fun(this,this.data)}.bind(this))},setData:function(t){var e=t;null!=t.open_type&&1==t.open_type&&(e=t.data),this.open_type=t.open_type||0,this.data=e,this.root_wnd&&this.onShow()},onShow:function(){if(null!=this.data){var t=this.data,e=s.getUIIconPath("redbag","redbag_4");if(1==this.open_type){var i=t.name||"";this.title.string=i,this.role_name.string="",this.desc_label.string="",this.get_status.active=!1,this.other_label.node.active=!0;var n=t.desc||"";this.other_label.string=n,e=s.getUIIconPath("redbag",t.res_name)}else{var a=t.name||"",o=t.post||3,l=gdata("guild_data","data_position",[o]);if(l){var r=l.name||"";i=cc.js.formatStr(Utils.TI18N("\u6765\u81ea<color=#ffea96>%s</c>(%s)"),a,r);this.role_name.string=i}var c=gdata("guild_data","data_guild_red_bag",[t.type]);if(c){a=c.name||"";this.title.string=a,e=s.getUIIconPath("redbag",c.res_name),this.desc_label.string=c.desc}this.updateStatus(t)}this.loadRes(e,function(t){this.coin_icon.spriteFrame=t}.bind(this))}},updateStatus:function(t){if(t){this.is_can_get=!0;var e=t.num,i=t.max_num;this.is_finish=!1,e>=i&&(this.is_finish=!0);var n,a=t.time-gcore.SmartSocket.getTime();this.is_out_time=!1,a<=0&&(this.is_out_time=!0),this.my_status=t.flag,1==this.my_status?(this.finish_icon.active=!0,this.is_can_get=!1):this.finish_icon.active=!1,1==this.is_finish?(n=s.getUIIconPath("redbag","txt_cn_redbag_3"),this.is_can_get=!1):1==this.is_out_time&&(n=s.getUIIconPath("redbag","txt_cn_redbag_1"),this.is_can_get=!1),n&&this.loadRes(n,function(t){this.status_icon.spriteFrame=t}.bind(this));var o=this.is_finish||this.is_out_time;this.status_icon.node.active=o;o=this.is_finish||this.is_out_time||1==this.my_status;this.black_bg.active=o,CommonAction.breatheShineAction3(this.get_status,.8,.8),this.get_status.active=this.is_can_get}},getIsCanGet:function(){return this.is_can_get},clickHandler:function(){this.call_fun&&this.call_fun(this.data)},addCallBack:function(t){this.call_fun=t},showBlackBg:function(t){this.black_bool=t,null!=this.root_wnd&&(t=t||!1,this.black_bg.active=t)},setVisibleStatus:function(t){this.setVisible(t)},getData:function(){return this.data},setLocalZOrder:function(t){this.zindex=t,null!=this.root_wnd&&(this.root_wnd.zIndex=t)},setScale:function(t){this.scale=t,null!=this.root_wnd&&(this.root_wnd.scale=t)},runActionFunc:function(t,e){this.action=t,this.func=e,null!=this.root_wnd&&this.root_wnd.runAction(t,e)},onDelete:function(){}});e.exports=n,cc._RF.pop()},{pathtool:"pathtool"}],redbag_list_panel:[function(t,e,i){"use strict";cc._RF.push(e,"0f354SBZypEzpnpwVRFIkg5","redbag_list_panel");t("loadermanager");var s=t("pathtool");cc.Class({extends:BaseClass,ctor:function(){this.initConfig()},initConfig:function(){this.parent=null,this.prefabPath=s.getPrefabPath("common","common_scroll_view"),this.pos=cc.v2(0,0),this.dir=ScrollViewDir.vertical,this.start_pos=ScrollViewStartPos.top,this.size=cc.size(100,100),this.ap=cc.v2(0,0),this.total_cache_list=[],this.item_click_callback=null,this.extend=null,this.cur_item_class=null,this.is_run=!1,this.item_num=0,this.move_over_index=0,this.posx_list={1:this.size.width/2,2:this.size.width/2+140,3:this.size.width/2-140},this.cur_min_index=0},createScroll:function(t,e,i,s,n,a,o){this.parent=t,this.pos=e||cc.v2(0,0),this.dir=i||ScrollViewDir.vertical,this.start_pos=s||ScrollViewStartPos.top,this.size=n||cc.size(100,100),this.ap=o||cc.v2(.5,.5),this.analysisSetting(a),this.createRootWnd()},createRootWnd:function(){var t=new cc.Node;this.container=new cc.Node("container"),this.container.setParent(t),this.root_wnd=t,this.root_wnd.setParent(this.parent),this.root_wnd.setContentSize(this.size),this.root_wnd.setAnchorPoint(this.ap),this.root_wnd.setPosition(this.pos.x,this.pos.y),this.registerEvent()},registerEvent:function(){var t=this,e=new cc.EventTarget;this.touchListener=cc.EventListener.create({event:cc.EventListener.TOUCH_ONE_BY_ONE,onTouchBegin:function(e,i){if(t.last_point=null,t.is_move=!1,null==t.cur_item_class)return!1;if(null==t.screenSize){var s=t.convertToWorldSpace(cc.p(0,0));t.screenSize=cc.rect(s.x,s.y,t.size.width,t.size.height)}s=cc.v2(e.getLocation().x,e.getLocation().y);return!!cc.rectContainsPoint(t.screenSize,s)},onTouchMoved:function(e,i){t.last_point=e.getDelta(),t.moveContainer(t.last_point)},onTouchEnded:function(){t.is_move=!1,t.last_point}}),e.on(this.touchListener,this.container)},moveContainer:function(t){this.checkPosition(t.x,t.y);var e=t.x<0;if(Math.abs(t.x)>=5&&1!=this.is_move){this.is_move=!0,this.is_run=!0;for(var i=this.total_cache_list[this.cur_item_class],s=1;s<=this.item_num;s++){var n=i.item[s];this.setMoveItemPos(n,e)}}},jumpToMove:function(t,e,i){var s=this.checkPosition(t.x,t.y);e=e||1;var n=cc.moveTo.create(e,cc.v2(s.x,s.y));this.container.runAction(cc.sequence.create(n,cc.callFunc.create(function(){i&&i()})))},setData:function(t,e,i){if(this.clearCacheList(),null!=t&&null!=Utils.next(t)){this.item_click_callback=e,this.data_list=t,this.extend=i;var s=t.length;this.item_num=s;var n=this.size.width,a=this.size.height,o=0;if(this.dir==ScrollViewDir.horizontal?n=(o=Math.ceil(s/this.row))*this.item_width+2*this.start_y+(o-1)*this.space_x:a=(o=Math.ceil(s/this.col))*this.item_height+2*this.start_y+(o-1)*this.space_y,n=Math.max(n,this.size.width),a=Math.max(a,this.size.height),this.container_size=cc.size(n,a),this.container.setContentSize(this.container_size),this.start_pos>0){var l=Math.max(0-a*this.start_pos+35,this.size.height-this.container_size.height);this.container.setPosition(cc.v2(0,l))}else 0==this.start_pos&&this.container.setPosition(cc.v2(0,0));this.cur_item_class=this.item_class;var r=0,c=this.once_num||1;null==this.time_ticket&&null!=Utils.next(this.data_list||{})&&(this.time_ticket=gcore.Timer.set(function(){if(this.container)if(null==this.data_list)this.end_callBack&&this.end_callBack(),this.clearTimeTicket();else{for(var t=r;t<r+c;t++){var e=this.data_list[t];null!=e&&this.createList(e)}(r+=c)>s&&(this.end_callBack&&this.end_callBack(),this.clearTimeTicket())}}.bind(this),10*this.delay,-1))}},clearTimeTicket:function(){null!=this.time_ticket&&(gcore.Timer.del(this.time_ticket),this.time_ticket=null)},clearCacheList:function(){if(this.clearTimeTicket(),null!=this.cur_item_class){var t=this.total_cache_list[this.cur_item_class]||{};if(null!=t||null!=Utils.next(t))for(var e in t.item){var i=t.item[e];i.setVisible(!1),t.pool.push(i)}t.item={}}this.cur_item_class=null},addEndCallBack:function(t){this.end_callBack=t},createList:function(t){var e=t;if(null!=this.cur_item_class){null==this.total_cache_list[this.cur_item_class]&&(this.total_cache_list[this.cur_item_class]={});var i=this.total_cache_list[this.cur_item_class];null==i.item&&(i.item=[]),null==i.pool&&(i.pool=[]);var s=null;null==Utils.next(i.pool)?((s=new this.item_class(!0,!0,cc.size(this.item_width,this.item_height))).setSwallowTouches&&s.setSwallowTouches(!1),s.setParent(this.container),s.show()):s=i.splice(i.pool,0),i.item.push(s);var n=i.item.length;s.item_index=n,null!=this.extend&&s.setExtendData&&s.setExtendData(this.extend),this.setItemPosition(s,t.index),null!=this.item_click_callback&&s.addCallBack&&s.addCallBack(this.item_click_callback),s.setData(e)}},setItemPosition:function(t){var e=this.total_cache_list[this.cur_item_class];if(null!=e&&null!=e.item){var i=e.item.length,s=cc.v2(.5,.5),n=0,a=0;this.dir==ScrollViewDir.horizontal&&(n=this.posx_list[i],a=this.container_size.height-(this.start_y+this.item_height*(1-s.y)+(i-1)%this.row*(this.item_height+this.space_y))),t.setPosition(n,a),1==i?(t.setLocalZOrder(10),t.showBlackBg(!1),t.setScale(1.05),this.select_item=t):(t.setLocalZOrder(1),t.showBlackBg(!0),t.setScale(.85))}},getItemList:function(){for(var t=[],e=0;e<this.total_cache_list.length;e++){var i=this.total_cache_list[e];t.push(i)}return t},setMoveItemPos:function(t,e){var i=this.total_cache_list[this.cur_item_class];if(null!=i&&null!=i.item){var s=t.item_index||0;1==e?s<=1?s=this.item_num:s-=1:s>=this.item_num?s=1:s+=1,t.item_index=s;var n=cc.v2(.5,.5),a=0,o=0;this.dir==ScrollViewDir.horizontal&&(a=this.posx_list[s],o=this.container_size.height-(this.start_y+this.item_height*(1-n.y)+(s-1)%this.row*(this.item_height+this.space_y)));var l=1;1==s?(t.setLocalZOrder(10),t.showBlackBg(!1),l=1.05,this.select_item=t):(t.setLocalZOrder(1),t.showBlackBg(!0),l=.85);var r=cc.moveTo(.3,cc.v2(a,o)),c=cc.scaleTo(0,1),_=cc.scaleTo(.3,l);t.runActionFunc(cc.sequence(c,_));var h=this;t.runActionFunc(cc.sequence(r,cc.callFunc(function(){h.is_run=!1,h.end_callBack&&h.end_callBack()})))}},runLeftPostion:function(){if(1!=this.is_run){var t=this.total_cache_list[this.cur_item_class];this.is_run=!0;for(var e=0;e<this.item_num;e++){var i=t.item[e];this.setMoveItemPos(i,!0)}}},runRightPostion:function(){if(1!=this.is_run){this.is_run=!0;for(var t=this.total_cache_list[this.cur_item_class],e=0;e<this.item_num;e++){var i=t.item[e];this.setMoveItemPos(i,!1)}}},getSelectItem:function(){return this.select_item},setSelectItem:function(t){t&&(this.select_item=t)},analysisSetting:function(t){this.setting=t||{},this.item_class=this.setting.item_class,this.start_x=this.setting.start_x||0,this.space_x=this.setting.space_x||3,this.start_y=this.setting.start_y||0,this.space_y=this.setting.space_y||3,this.item_width=this.setting.item_width||115,this.item_height=this.setting.item_height||115,this.is_radian=this.setting.is_radian||!1,this.row=this.setting.row||5,this.col=this.setting.col||5,this.delay=this.setting.delay||4,this.once_num=this.setting.once_num||1,this.scale=this.setting.scale||1},getMaxSize:function(){return this.container_size},getContainer:function(){return this.container},deleteMe:function(){this.DeleteMe()},DeleteMe:function(){for(var t in this.clearTimeTicket(),this.total_cache_list){var e=this.total_cache_list[t];for(var i in e){var s=e[i];for(var n in s)s[n].deleteMe&&(s[n].deleteMe(),s[n]=null)}}this.total_cache_list=null,this.root_wnd.destroy(),this.root_wnd=null,this.container.destroy(),this.container=null}});cc._RF.pop()},{loadermanager:"loadermanager",pathtool:"pathtool"}],redbag_look_item:[function(t,e,i){"use strict";cc._RF.push(e,"725839AfKxLGK5rL403pMXK","redbag_look_item");var s=t("pathtool"),n=t("playerhead"),a=t("role_controller"),o=t("timetool");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("redbag","redbag_look_item")},initConfig:function(){this.size=cc.size(455,93)},initPanel:function(){this.main_panel=this.seekChild("main_panel"),this.bg_nd=this.seekChild("bg"),this.me_bg_nd=this.seekChild("me_bg"),this.me_bg_nd.active=!1,this.head_icon=new n,this.head_icon.show(),this.head_icon.setParent(this.main_panel),this.head_icon.setPosition(-180,0),this.head_icon.setScale(.7),this.head_icon.addCallBack(function(){var e=a.getInstance().getRoleVo();e.rid==this.data.rid&&e.srv_id==this.data.srv_id||t("chat_controller").getInstance().openFriendInfo(this.data)}.bind(this)),this.me_icon_nd=this.seekChild("me_icon"),this.me_icon_nd.active=!1,this.role_name_rt=this.seekChild("role_name",cc.RichText),this.get_time_lb=this.seekChild("get_time",cc.Label),this.money_label_rt=this.seekChild("money_label",cc.RichText)},registerEvent:function(){},setData:function(t){this.data=t,this.root_wnd&&this.onShow()},onShow:function(){if(null!=this.data){var t=this.data;this.showFirstIcon(!1),null!=t.index&&t.index%2==1?this.bg_nd.active=!0:this.bg_nd.active=!1,null!=t.index&&0==t.index&&this.showFirstIcon(!0),this.head_icon.setHeadRes(t.face_id),this.head_icon.setFrameRes(t.avatar_bid);var e=t.name||"",i=t.post||3,n=Config.guild_data.data_position[i];if(n){var l=n.name||"",r=cc.js.formatStr("%s(%s)",e,l);this.role_name_rt.string=r,this.me_icon_nd.x=this.role_name_rt.node.x+this.role_name_rt.node.width+10}var c=o.getYMDHMS(t.time||0);if(this.get_time_lb.string=c,this.extend_data){var _=this.extend_data.assets,h=t.val||0,d=Config.item_data.data_assets_label2id[_]||"",u=Utils.getItemConfig(d);if(u){var m=u.icon;r=cc.js.formatStr(Utils.TI18N("%s <img src='%s' />"),h,m);this.money_label_rt.string=r,this.loadRes(s.getItemRes(u.icon),function(t){this.money_label_rt.spriteFrame=t}.bind(this))}var f=a.getInstance().getRoleVo();f.rid==t.rid&&f.srv_id==t.srv_id?(this.me_icon_nd.active=!0,this.me_bg_nd.active=!0):(this.me_bg_nd.active=!1,this.me_icon_nd.active=!1)}}},setExtendData:function(t){t&&(this.extend_data=t)},showFirstIcon:function(t){if(0!=t||this.first_icon){if(!this.first_icon){var e=s.getUIIconPath("redbag","txt_cn_redbag_4");this.first_icon=Utils.createImage(this.root_wnd,null,-191,24,cc.v2(.5,.5)),this.loadRes(e,function(t){this.first_icon.spriteFrame=t}.bind(this))}this.first_icon.node.active=t}},onHide:function(){},onDelete:function(){this.first_icon&&(this.first_icon.node.destroy(),this.first_icon=null),this.head_icon&&(this.head_icon.deleteMe(),this.head_icon=null)}});cc._RF.pop()},{chat_controller:"chat_controller",pathtool:"pathtool",playerhead:"playerhead",role_controller:"role_controller",timetool:"timetool"}],redbag_look_window:[function(t,e,i){"use strict";cc._RF.push(e,"c40a37KFuJEYZgF0W7fKcs6","redbag_look_window");var s=t("pathtool"),n=t("playerhead"),a=t("role_controller"),o=t("redbag_event"),l=t("timetool"),r=t("redbag_look_item"),c=t("common_scrollview");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("redbag","redbag_look"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Mini},initConfig:function(){this.ctrl=t("redbag_controller").getInstance()},openCallBack:function(){this.background=this.seekChild("background"),this.background.scale=FIT_SCALE,this.main_panel=this.seekChild("main_panel"),this.size=this.main_panel.getContentSize(),this.close_btn=this.seekChild("close_btn"),this.label_panel=this.seekChild("label_panel"),this.title_lb=this.seekChild(this.label_panel,"title",cc.Label),this.bg_sp=this.seekChild("bg",cc.Sprite),this.loadRes(s.getBigBg("bigbg_42"),function(t){this.bg_sp.spriteFrame=t}.bind(this)),this.head_icon=new n,this.head_icon.show(),this.head_icon.setParent(this.main_panel),this.head_icon.setPosition(0,250),this.head_icon.setScale(.9),this.head_icon.addCallBack(function(){var e=a.getInstance().getRoleVo();e.rid==this.data.rid&&e.srv_id==this.data.srv_id||t("chat_controller").getInstance().openFriendInfo(this.data)}.bind(this)),this.status_bg_nd=this.seekChild("status_bg"),this.status_bg_nd.active=!1,this.desc_label_rt=this.seekChild("desc_label",cc.RichText),this.role_name_rt=this.seekChild("role_name",cc.RichText),this.less_num_lb=this.seekChild("less_num",cc.Label),this.less_time_lb=this.seekChild("less_time",cc.Label),this.event_data&&(this.updateMessage(event_data),this.updateMemberList(event_data))},registerEvent:function(){Utils.onTouchEnd(this.background,function(){this.ctrl.openLookWindow(!1)}.bind(this),2),Utils.onTouchEnd(this.close_btn,function(){this.ctrl.openLookWindow(!1)}.bind(this),2),this.addGlobalEvent(o.Get_List_Event,function(t){null!=this.root_wnd?(this.updateMessage(t),this.updateMemberList(t)):this.event_data=t},this)},updateMessage:function(t){if(t&&(this.data&&(this.status_bg_nd.active=!1,this.list_data=t,this.head_icon.setHeadRes(t.face_id),this.head_icon.setFrameRes(t.avatar_bid),e=Config.guild_data.data_guild_red_bag[this.data.type]))){this.red_config=e,this.title_lb.string=e.name;var e,i=t.name||"";this.role_name_rt.string=cc.js.formatStr(Utils.TI18N("<color=#ffea96>%s</c>\u7684\u7ea2\u5305"),i),(e=Config.guild_data.data_guild_red_bag[t.type])&&(this.desc_label_rt.string=e.msg),this.data.num>=this.data.max_num&&(this.status_bg_nd.active=!0),this.less_num_lb.string=cc.js.formatStr(Utils.TI18N("\u5269\u4f59\u4e2a\u6570\uff1a%s/%s"),this.data.max_num-this.data.num,this.data.max_num),this.less_timer&&(gcore.Timer.del(this.less_timer),this.less_timer=null);var s=this.data.time||0;s-gcore.SmartSocket.getTime()<=0?this.less_time_lb.string=Utils.TI18N("\u5269\u4f59\u65f6\u95f4\uff1a\u5df2\u8fc7\u671f"):this.less_timer||(this.less_timer=gcore.Timer.set(function(){this.less_time_lb.string=cc.js.formatStr(Utils.TI18N("\u5269\u4f59\u65f6\u95f4\uff1a%s"),l.getTimeFormatDay(s-gcore.SmartSocket.getTime())),s-=1}.bind(this),1e3,-1))}},openRootWnd:function(t){this.data=t,this.ctrl.sender13540(this.data.id)},updateMemberList:function(t){if(!this.list_view){var e=cc.size(450,400),i={item_class:r,start_x:1,space_x:2,start_y:10,space_y:3,item_width:455,item_height:93,row:1,col:1,need_dynamic:!0};this.list_view=new c,this.list_view.createScroll(this.main_panel,cc.v2(0,-100),ScrollViewDir.vertical,ScrollViewStartPos.top,e,i,cc.v2(.5,.5))}var s=t.list||[];for(var n in s.sort(Utils.tableUpperSorter(["val","time"])),s)s[n].index=n;this.list_view.setData(s,null,this.red_config)},closeCallBack:function(){this.ctrl.openLookWindow(!1),this.list_view&&(this.list_view.deleteMe(),this.list_view=null),this.head_icon&&(this.head_icon.deleteMe(),this.head_icon=null),this.less_timer&&(gcore.Timer.del(this.less_timer),this.less_timer=null)}});cc._RF.pop()},{chat_controller:"chat_controller",common_scrollview:"common_scrollview",pathtool:"pathtool",playerhead:"playerhead",redbag_controller:"redbag_controller",redbag_event:"redbag_event",redbag_look_item:"redbag_look_item",role_controller:"role_controller",timetool:"timetool"}],redbag_model:[function(t,e,i){"use strict";cc._RF.push(e,"44ea0Mgh+hGP6SZQFLU5xvc","redbag_model");var s=t("redbag_event"),n=t("guild_controller"),a=t("mainui_const"),o=t("mainui_controller"),l=t("backpack_controller"),r=t("guild_const"),c=t("guild_event");cc.Class({extends:BaseClass,ctor:function(){this.ctrl=t("redbag_controller").getInstance()},properties:{},initConfig:function(){this.redbag_list={},this.redbag_num=0,this.redbag_send_num=0,this.redbag_rec_num=0,this.is_get_redbag=0,this.red_bag_item_num=[],this.all_red_show=!1},resetData:function(){this.initConfig()},updateData:function(t){if(t){t.type&&0==t.type&&(this.redbag_list={});var e=t.list||{};for(var i in e){var a=e[i];a.order=0-a.time,0==a.flag&&a.num<a.max_num&&a.time-gcore.SmartSocket.getTime()>=0&&(a.order=gcore.SmartSocket.getTime()-a.time),this.redbag_list[a.id]=a}gcore.GlobalEvent.fire(s.Get_Data_Event,t),0!=this.is_get_redbag?this.checkRedBagRedPoint():n.getInstance().SendProtocal(13523,{}),this.is_get_redbag=0}},updateRedBagNum:function(t,e){this.redbag_send_num=t||0,this.redbag_rec_num=e||0,this.is_get_redbag=1;var i=gdata("guild_data","data_const","red_packet_get").val;this.redbag_rec_num>=i&&(this.is_get_redbag=2),this.checkRedBagRedPoint()},checkRedBagRedPoint:function(){var t;for(var e in this.is_have_red=!1,this.all_red_show=!1,this.redbag_num=0,this.redbag_list){if(this.redbag_num=this.redbag_num+1,(i=this.redbag_list[e]).num<i.max_num&&i.time-gcore.SmartSocket.getTime()>=0&&0==i.flag){t=i,this.is_have_red=!0,this.all_red_show=!0;break}}if(2==this.is_get_redbag&&(t=null,this.is_have_red=!1,this.all_red_show=!1),this.checkItemNumRedPoint(),this.red_bag_item_num&&null!=Utils.next(this.red_bag_item_num||{}))for(var e in this.red_bag_item_num){var i;if(1==(i=this.red_bag_item_num[e]).status){this.all_red_show=!0;break}}gcore.GlobalEvent.fire(s.Can_Get_Red_Bag,t),gcore.GlobalEvent.fire(c.UpdateGuildRedStatus,r.red_index.red_bag,this.all_red_show);var n=Config.function_data.data_base;1==o.getInstance().checkIsOpenByActivate(n[6].activate)&&o.getInstance().setBtnRedPoint(a.btn_index.guild,{bid:r.red_index.red_bag,status:this.all_red_show})},checkItemNumRedPoint:function(){if(Config.guild_data.data_guild_red_bag)for(var t in this.red_bag_item_num=[],Config.guild_data.data_guild_red_bag){var e=gdata("guild_data","data_guild_red_bag",[t]);if(e&&e.loss_item&&e.loss_item[0]){var i=!1;l.getInstance().getModel().getBackPackItemNumByBid(e.loss_item[0][0])>=e.loss_item[0][1]&&(i=!0),this.red_bag_item_num.push({id:e.id,status:i,bid:e.loss_item[0][0]})}}},getRedBagNum:function(){return this.redbag_num||0},getIsHaveRedBag:function(){return this.is_have_red||!1},getAllRedBagStatus:function(){return this.all_red_show||!1},getHaveItemID:function(){if(this.red_bag_item_num&&Utils.next(this.red_bag_item_num||null!={})){var t=99;for(var e in this.red_bag_item_num){var i=this.red_bag_item_num[e];1==i.status&&i.id<=t&&(t=i.id)}return t}},getSendRedBagStatue:function(t){var e=!1;if(this.red_bag_item_num&&null!=Utils.next(this.red_bag_item_num||{}))for(var i in this.red_bag_item_num){var s=this.red_bag_item_num[i];if(t){if(s.id!=t&&1==s.status){e=!0;break}}else if(1==s.status){e=!0;break}}return e},getRebBagItemNumList:function(){if(this.red_bag_item_num&&null!=Utils.next(this.red_bag_item_num||{}))return this.red_bag_item_num},getRedBagList:function(){var t=[];for(var e in this.redbag_list){var i=this.redbag_list[e];t.push(i)}return t},getRedBagListById:function(t){return this.redbag_list[t]}});cc._RF.pop()},{backpack_controller:"backpack_controller",guild_const:"guild_const",guild_controller:"guild_controller",guild_event:"guild_event",mainui_const:"mainui_const",mainui_controller:"mainui_controller",redbag_controller:"redbag_controller",redbag_event:"redbag_event"}],redbag_open_window:[function(t,e,i){"use strict";cc._RF.push(e,"fcd99XLX8JEgr4UvA0PKKRE","redbag_open_window");var s=t("pathtool"),n=t("redbag_controller"),a=cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("redbag","redbg_open_view"),this.win_type=WinType.Mini,this.viewTag=SCENE_TAG.dialogue,this.ctrl=n.getInstance(),this.model=this.ctrl.getModel()},openCallBack:function(){this.background=this.seekChild("background"),this.background.scale=FIT_SCALE,this.main_panel=this.seekChild("main_container"),this.after_effect=this.seekChild("after_effect",sp.Skeleton),this.begin_effect=this.seekChild("begin_effect",sp.Skeleton),this.red_bg_sp=this.seekChild("red_bg",cc.Sprite)},registerEvent:function(){this.background.on(cc.Node.EventType.TOUCH_END,function(){this.ctrl.openRegBagWindow(!1)}.bind(this))},openRootWnd:function(t){this.data=t,t&&this.showAfterEffect()},showAfterEffect:function(){if(this.red_bg_sp){var e=Config.guild_data.data_guild_red_bag[this.data.type];if(e){var i=s.getUIIconPath("redbag",e.res_name);this.loadRes(i,function(t){this.red_bg_sp.spriteFrame=t}.bind(this)),this.red_bg_sp.node.opacity=0,this.red_bg_sp.node.scale=.8,this.red_bg_sp.node.runAction(cc.fadeIn(.5))}}if(this.after_effect&&(this.after_effect.setToSetupPose(),this.after_effect.clearTracks()),this.after_effect){i=cc.js.formatStr("spine/%s/action.atlas",s.getEffectRes(261));this.loadRes(i,function(t){this.after_effect.skeletonData=t,this.after_effect.setAnimation(1,PlayerAction.action_1,!1)}.bind(this))}if(this.timer=gcore.Timer.set(function(){if(this.data){var e=Config.guild_data.data_guild_red_bag[this.data.type].assets,i=[{bid:Config.item_data.data_assets_label2id[e],num:this.data.val}];t("mainui_controller").getInstance().openGetItemView(!0,i,null,{is_backpack:!0,is_red_bag:!0,info_data:this.data}),this.ctrl.openRegBagWindow(!1)}}.bind(this),1e3,1),this.begin_effect&&(this.begin_effect.setToSetupPose(),this.begin_effect.clearTracks()),this.begin_effect){i=cc.js.formatStr("spine/%s/action.atlas",s.getEffectRes(261));this.loadRes(i,function(t){this.begin_effect.skeletonData=t,this.begin_effect.setAnimation(1,PlayerAction.action_2,!1)}.bind(this))}},closeCallBack:function(){this.after_effect&&(this.after_effect.setToSetupPose(),this.after_effect.clearTracks()),this.begin_effect&&(this.begin_effect.setToSetupPose(),this.begin_effect.clearTracks()),this.ctrl.openRegBagWindow(!1)}});e.exports=a,cc._RF.pop()},{mainui_controller:"mainui_controller",pathtool:"pathtool",redbag_controller:"redbag_controller"}],redbag_rank_item:[function(t,e,i){"use strict";cc._RF.push(e,"af948+07thE369gBDFRj8pS","redbag_rank_item");var s=t("pathtool"),n=cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("redbag","redbag_rank_item"),this.data=null,this.star_list={},this.is_show_point=!1,this.size=cc.size(600,123)},initPanel:function(){this.main_panel=this.seekChild("main_panel"),this.rank_icon=this.seekChild("rank_icon",cc.Sprite),this.role_name=Utils.createLabel(26,new cc.Color(104,69,42,255),null,125-this.size.width/2,0,"",this.main_panel,0,cc.v2(0,.5)),this.rank_index=Utils.createLabel(30,new cc.Color(169,95,15,255),null,50-this.size.width/2,0,"",this.main_panel,0,cc.v2(0,.5)),this.send_money=Utils.createLabel(22,new cc.Color(104,69,42,255),null,355-this.size.width/2,15,"",this.main_panel,0,cc.v2(0,.5)),this.send_num=Utils.createLabel(22,new cc.Color(169,95,15,255),null,355-this.size.width/2,-15,"",this.main_panel,0,cc.v2(0,.5))},registerEvent:function(){this.root_wnd.on(cc.Node.EventType.TOUCH_END,function(){this.calkl_fun&&this.call_fun(this.data)},this)},setData:function(t){this.data=t,this.root_wnd&&this.onShow()},onShow:function(){if(null!=this.data){var t=this.data,e=Number(t.index)+1;this.index=e||1,this.rank_index.string=this.index,this.index>=1&&this.index<=3?(this.rank_index.node.active=!1,this.rank_icon.node.active=!0,this.loadRes(s.getUIIconPath("common","common_300"+this.index),function(t){this.rank_icon.spriteFrame=t}.bind(this)),this.rank_icon.node.setScale(.7)):(this.rank_index.node.active=!0,this.rank_icon.node.active=!1);var i=t.name||"";this.role_name.string=i;var n=t.price||"";this.send_money.string=Utils.TI18N("\u53d1\u653e\u603b\u4ef7\u503c\uff1a"+n);var a=t.num||0;this.send_num.string=Utils.TI18N("\u53d1\u653e\u7ea2\u5305\u6570\uff1a"+a)}},clickHandler:function(){this.call_fun&&this.call_fun(this.data)},addCallBack:function(t){this.call_fun=t},setVisibleStatus:function(t){this.setVisible(t)},getData:function(){return this.data},onDelete:function(){}});e.exports=n,cc._RF.pop()},{pathtool:"pathtool"}],redbag_rank_panel:[function(t,e,i){"use strict";cc._RF.push(e,"66424c61OpDQqBVyPzdxcZL","redbag_rank_panel");var s=t("pathtool"),n=t("redbag_controller"),a=t("playerhead"),o=t("role_controller"),l=t("redbag_event"),r=t("redbag_rank_item"),c=t("common_scrollview"),_=cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("redbag","redbag_rank"),this.ctrl=n.getInstance(),this.size=cc.v2(644,740)},initPanel:function(){this.main_panel=this.seekChild("main_panel"),this.size=this.main_panel.getContentSize(),this.top_panel=this.seekChild(this.main_panel,"top_panel"),this.look_btn=this.seekChild(this.top_panel,"look_btn"),this.no_label=this.seekChild(this.top_panel,"no_label"),this.no_label.active=!1,this.head_bg=this.seekChild(this.top_panel,"head_bg"),this.head_icon=new a,this.head_icon.setParent(this.head_bg),this.head_icon.show(),this.head_icon.setPosition(0,0),this.head_bg.active=!1,this.look_btn.active=!1,this.role_name=this.seekChild(this.top_panel,"role_name",cc.Label)},registerEvent:function(){this.look_btn.on(cc.Node.EventType.TOUCH_END,function(e){if(this.first_data){var i=o.getInstance().getRoleVo();i.rid!=this.first_data.rid||i.srv_id!=this.first_data.srv_id?t("chat_controller").getInstance().openFriendInfo(this.first_data):message(Utils.TI18N("\u4f60\u8fde\u81ea\u5df1\u90fd\u4e0d\u8ba4\u8bc6\u4e86\u4e48\uff1f"))}}.bind(this)),this.addGlobalEvent(l.Rank_List_Event,function(t){this.updateMessage(t),this.updateRankList(t)}.bind(this)),this.ctrl.sender13545()},setVisibleStatus:function(t){this.setVisible(t)},updateMessage:function(t){t&&t.list&&null!=Utils.next(t.list)&&(this.first_data=t.list[0],this.role_name.string=this.first_data.name||"",this.head_icon.setHeadRes(this.first_data.face_id),this.head_icon.setFrameRes(this.first_data.avatar_bid))},updateRankList:function(t){if(t){if(!this.scroll_view){var e=cc.size(600,700),i={item_class:r,start_x:0,space_x:0,start_y:0,space_y:0,item_width:600,item_height:123,row:1,col:1,need_dynamic:!0};this.scroll_view=new c,this.scroll_view.createScroll(this.main_panel,cc.v2(0,-70),ScrollViewDir.vertical,ScrollViewStartPos.top,e,i,cc.v2(.5,.5))}var s=t.list||[];if(s&&null!=Utils.next(s)){for(var n in s.sort(Utils.tableUpperSorter(["price"])),s)s[n].index=n;this.showEmptyIcon(!1),this.scroll_view.setData(s)}else this.showEmptyIcon(!0)}else this.showEmptyIcon(!0)},showEmptyIcon:function(t){if(this.head_bg.active=!t,this.look_btn.active=!t,this.empty_con||0!=t){if(!this.empty_con){var e=cc.size(200,200);this.empty_con=new cc.Node,this.empty_con.setContentSize(e),this.empty_con.setAnchorPoint(cc.v2(.5,.5)),this.empty_con.setPosition(cc.v2(0,0)),this.main_panel.addChild(this.empty_con);var i=s.getBigBg("bigbg_3");this.empty_bg=Utils.createImage(this.empty_con,null,0,0,cc.v2(.5,.5),!1),this.loadRes(i,function(t){this.empty_bg.spriteFrame=t}.bind(this)),this.empty_label=Utils.createLabel(26,new cc.Color(104,69,42,255),null,0,-100,"",this.empty_con,0,cc.v2(.5,.5))}var n=Utils.TI18N("\u6682\u65e0\u6392\u884c");this.empty_label.string=n,this.empty_con.active=t,this.no_label.active=t}},onShow:function(){},setData:function(t){},onDelete:function(){this.empty_con&&(this.empty_con.destroy(),this.empty_label.destroy(),this.empty_bg.destroy(),this.empty_con=null,this.empty_bg=null,this.empty_label=null),this.head_icon&&(this.head_icon.onDelete(),this.head_icon=null),this.scroll_view&&this.scroll_view.DeleteMe(),this.scroll_view=null}});e.exports=_,cc._RF.pop()},{chat_controller:"chat_controller",common_scrollview:"common_scrollview",pathtool:"pathtool",playerhead:"playerhead",redbag_controller:"redbag_controller",redbag_event:"redbag_event",redbag_rank_item:"redbag_rank_item",role_controller:"role_controller"}],redbag_send_panel:[function(t,e,i){"use strict";cc._RF.push(e,"9c0d5vfkGBJN7b1Ocs11bzH","redbag_send_panel");var s=t("pathtool"),n=t("redbag_controller"),a=t("redbag_event"),o=t("redbag_item"),l=t("redbag_list_panel"),r=t("backpack_controller"),c=t("backpack_const"),_=cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("redbag","redbag_send"),this.ctrl=n.getInstance(),this.size=cc.v2(644,740),this.is_can_save=!1,this.item_list={},this.need_list={},this.default_msg=Utils.TI18N("\u8eab\u4e3a\u571f\u8c6a\uff0c\u6709\u94b1\u4efb\u6027"),this.is_send_proto=!1,this.use_assert=0,this.msg_list={},this.extend_id=arguments[0]||this.ctrl.getModel().getHaveItemID()||1,this.select_msg=null},initPanel:function(){this.main_panel=this.seekChild("main_panel"),this.top_panel=this.seekChild(this.main_panel,"top_panel"),this.bottom_panel=this.seekChild(this.main_panel,"bottom_panel"),this.num_panel=this.seekChild(this.bottom_panel,"num_panel"),this.send_btn=this.seekChild(this.bottom_panel,"send_btn"),this.send_btn_red_point=this.seekChild(this.send_btn,"red_point"),this.send_btn_red_point.active=!1,this.btn_label=this.seekChild(this.send_btn,"label",cc.RichText),this.send_tips_lb=this.seekChild("send_tips",cc.Label),this.left_btn=this.seekChild(this.top_panel,"left_btn"),this.right_btn=this.seekChild(this.top_panel,"right_btn"),this.right_btn_red_point=this.seekChild(this.right_btn,"red_point"),this.right_btn_red_point.active=!1,this.left_btn_red_point=this.seekChild(this.left_btn,"red_point"),this.left_btn_red_point.active=!1,this.item_container=this.seekChild(this.bottom_panel,"item_container"),this.num_label=this.seekChild(this.bottom_panel,"num_label",cc.Label),this.send_content=this.seekChild(this.bottom_panel,"send_content",cc.Label),this.createDesc(),this.requireProto()},createDesc:function(){this.send_notice=this.seekChild(this.top_panel,"send_notice",cc.RichText),this.send_notice.string=cc.js.formatStr(Utils.TI18N("(\u4eca\u65e5\u8fd8\u53ef\u53d1<color=#249003>%s</c>)"),100),this.coin_label=this.seekChild(this.bottom_panel,"coin_label",cc.RichText),this.coin_img=this.seekChild(this.bottom_panel,"coin_img",cc.Sprite),this.updateBagList()},requireProto:function(){this.ctrl.send13546()},registerEvent:function(){this.send_btn.on(cc.Node.EventType.TOUCH_END,function(){if(null!=this.red_send_info&&null!=this.select_vo)if(this.cost_item_bid&&0!=this.cost_item_bid)this.ctrl.sender13535(this.select_vo.id,1);else{var t=gdata("charge_data","data_charge_data",[this.select_vo.charge_id]);t&&SDK.pay(t.val,null,t.id,t.name,t.name,null,null)}}.bind(this)),this.left_btn.on(cc.Node.EventType.TOUCH_END,function(){this.list_view&&this.list_view.runLeftPostion()}.bind(this)),this.right_btn.on(cc.Node.EventType.TOUCH_END,function(){this.list_view&&this.list_view.runRightPostion()}.bind(this)),this.addGlobalEvent(a.Update_Red_Bag_Event,function(t){this.updateRedInfo(t)}.bind(this)),this.addGlobalEvent(EventId.ADD_GOODS,function(t,e){this.updateItemNum(t,e)}.bind(this)),this.addGlobalEvent(EventId.DELETE_GOODS,function(t,e){this.updateItemNum(t,e)}.bind(this)),this.addGlobalEvent(EventId.MODIFY_GOODS_NUM,function(t,e){this.updateItemNum(t,e)}.bind(this))},openRootWnd:function(){},updateBagList:function(){if(null==this.list_view){var t=cc.size(580,370),e={item_class:o,start_x:0,space_x:0,start_y:2,space_y:0,item_width:262,item_height:327,row:1,col:1};this.list_view=new l,this.list_view.createScroll(this.top_panel,cc.v2(270,20),ScrollViewDir.horizontal,ScrollViewStartPos.top,t,e,cc.v2(.5,.5))}var i=Config.guild_data.data_guild_red_bag,s=[],n=0;for(var a in i){var r=i[a];s[n]={data:r,open_type:1},n+=1}for(var a in s){(r=s[a]).sort_index=1,r.data.id==this.extend_id&&(r.sort_index=0)}s.sort(Utils.tableLowerSorter(["sort_index","id"])),this.list_view.setData(s),this.list_view.addEndCallBack(function(){this.updateMessage()}.bind(this)),this.list_view.setData(s)},updateMessage:function(){var t=this.list_view.getSelectItem(),e=null;if(t&&(e=t.getData()),null!=t&&(!this.select_vo||this.select_vo!=e)&&(this.select_vo=e,this.select_vo)){var i=this.select_vo,n=i.assets,a=gdata("item_data","data_assets_label2id",[n]),o=Utils.getItemConfig(a);if(o){this.coin_label.string=String(i.val);var l=s.getItemRes(o.icon);this.loadRes(l,function(t){this.coin_img.spriteFrame=t}.bind(this))}this.send_content.string=i.msg,this.num_label.string=i.num,this.fileRewardsItem(i.reward),this.showRedSendNum()}},fileRewardsItem:function(t){if(null!=t&&null!=Utils.next(t)){for(var e in this.item_list){(s=this.item_list[e]).setVisible(!1)}for(var i in t){var s=t[i];if(null==this.item_list[i]){var n;(n=ItemsPool.getInstance().getItem("backpack_item")).initConfig(!1,.7,!1,!1),n.show();var a=20+94*(i-1)+42-194+42;n.setPosition(a,50),n.setParent(this.item_container),this.item_list[i]=n}(n=this.item_list[i]).setData({bid:s[0],num:s[1]}),n.setVisible(!0)}}},updateRedInfo:function(t){this.red_send_info=t,this.showRedSendNum()},updateItemNum:function(t,e){if(this.cost_item_bid&&null!=t&&null!=e&&t==c.Bag_Code.BACKPACK)for(var i in e){var s=e[i];if(s&&null!=s.base_id&&this.cost_item_bid==s.base_id){this.showRedSendNum();break}}},showRedSendNum:function(){if(null!=this.red_send_info&&null!=this.select_vo){var t=Config.guild_data.data_guild_red_bag[this.select_vo.id];if(t){this.cost_item_bid=0,this.send_tips_lb.node.active=!1;var e=0;for(var i in this.red_send_info){var n=this.red_send_info[i];if(n.id==this.select_vo.id){e=n.num;break}}if((e=this.select_vo.limit-e)<0&&(e=0),this.send_notice.string=cc.js.formatStr(Utils.TI18N("(\u4eca\u65e5\u8fd8\u53ef\u53d1<color=#249003>%s</c>)"),e),0==e)this.btn_label.string=Utils.TI18N("\u6b21\u6570\u5df2\u8fbe\u4e0a\u9650");else{var a=gdata("charge_data","data_charge_data",[this.select_vo.charge_id]);if(this.checkLossItemIsEnough(t.loss_item)){var o=t.loss_item[0][0],l=t.loss_item[0][1],r=Utils.getItemConfig(o);if(r){this.cost_item_bid=o;var c=s.getItemRes(r.icon);this.btn_label.string=cc.js.formatStr(Utils.TI18N("<img src='%s'/><outline width=2 color=#6C2B00>%s \u53d1\u7ea2\u5305</outline>"),r.icon,l),this.loadRes(c,function(t){this.btn_label.spriteFrame=t}.bind(this)),this.send_tips_lb.string=cc.js.formatStr(Utils.TI18N("\u5f53\u524d\u62e5\u6709\u7ea2\u5305\u4ee4\uff0c\u6d88\u8017%s\u4e2a\u53ef\u53d1\u653e1\u6b21\u8be5\u7ea2\u5305"),l),this.send_tips_lb.node.active=!0}}else a&&(this.btn_label.string=cc.js.formatStr(Utils.TI18N("<outline width=2 color=#6C2B00>%s\u5143 \u53d1\u7ea2\u5305</outline>"),a.val))}this.cur_send_num!=e&&(this.cur_send_num=e,0==e?Utils.setGreyButton(this.send_btn,!0):Utils.setGreyButton(this.send_btn,!1))}}},checkLossItemIsEnough:function(t){var e=!1;if(t&&null!=t[0]){var i=t[0][0],s=t[0][1];r.getInstance().getModel().getItemNumByBid(i)>=s&&(e=!0)}return e},setVisibleStatus:function(t){this.setVisible(t)},onShow:function(){},setData:function(t){},onDelete:function(){if(this.list_view&&(this.list_view.deleteMe(),this.list_view=null),this.item_list){for(var t in this.item_list){this.item_list[t].deleteMe()}this.item_list=null}}});e.exports=_,cc._RF.pop()},{backpack_const:"backpack_const",backpack_controller:"backpack_controller",pathtool:"pathtool",redbag_controller:"redbag_controller",redbag_event:"redbag_event",redbag_item:"redbag_item",redbag_list_panel:"redbag_list_panel"}],redbag_window:[function(t,e,i){"use strict";cc._RF.push(e,"e14bfKymw5Oo6R2jE29f611","redbag_window");var s=t("pathtool"),n=t("redbag_controller"),a=t("guild_event"),o=cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("redbag","redbag_btn_panel"),this.win_type=WinType.Big,this.viewTag=SCENE_TAG.dialogue,this.ctrl=n.getInstance(),this.model=this.ctrl.getModel(),this.extend_id=arguments[0],this.btn_list={},this.view_list={},this.select_btn=null},openCallBack:function(){var t=this.seekChild("main_panel");this.container=this.seekChild(t,"container"),this.background=this.seekChild("background");for(var e=1;e<=3;e++){var i=t.getChildByName("tab_btn_"+e);if(i){var s={};if(s.btn=i,s.select_bg=i.getChildByName("select_bg"),s.select_bg.active=!1,s.title=i.getChildByName("title").getComponent(cc.Label),s.red_point=i.getChildByName("red_point"),s.red_point.active=!1,2==e){var n=this.model.getIsHaveRedBag();s.red_point.active=n}else if(1==e){n=this.model.getSendRedBagStatue();s.red_point.active=n}s.index=e,this.btn_list[e]=s,this.setBtnClick(i,e)}}},setBtnClick:function(t,e){t.on(cc.Node.EventType.TOUCH_END,function(){this.changeTabIndex(e)}.bind(this))},registerEvent:function(){this.background.on(cc.Node.EventType.TOUCH_END,function(){this.ctrl.openMainView(!1)}.bind(this)),this.addGlobalEvent(a.UpdateGuildRedStatus,function(){var t=this.model.getIsHaveRedBag();this.updateSomeRedStatus(t),t=this.model.getSendRedBagStatue(),this.updateOneRedStatus(t)})},updateSomeRedStatus:function(t){this.btn_list&&this.btn_list[2]&&(this.btn_list[2].red_point.active=t)},updateOneRedStatus:function(t){this.btn_list&&this.btn_list[1]&&(this.btn_list[1].red_point.active=t)},changeTabIndex:function(t){this.select_btn&&this.select_btn.index==t||(this.select_btn&&(this.select_btn.select_bg.active=!1,this.select_btn.title.color=new cc.Color(207,181,147,255)),this.pre_panel&&this.pre_panel.setVisibleStatus(!1),this.pre_panel=this.createSubPanel(t),this.select_btn=this.btn_list[t],this.select_btn&&(this.select_btn.select_bg.active=!0,this.select_btn.title.color=new cc.Color(255,237,214,255)),this.pre_panel&&this.pre_panel.setVisibleStatus(!0),this.select_btn&&3==this.select_btn.index&&this.ctrl.sender13545())},createSubPanel:function(t){t=Number(t);var e=this.view_list[t],i=this.container.getContentSize();return null==e&&(1==t?(e=Utils.createClass("redbag_send_panel",this.extend_id)).setPosition(cc.v2(i.width/2,355)):2==t?(e=Utils.createClass("redbag_get_panel")).setPosition(cc.v2(i.width/2,375)):3==t&&(e=Utils.createClass("redbag_rank_panel")).setPosition(cc.v2(i.width/2,375)),e.show(),e.setParent(this.container),this.view_list[t]=e),e},openRootWnd:function(t,e){this.data=e,t=t||1,1!=(this.model.getIsHaveRedBag()||!1)||1!=t||this.extend_id||(t=2),this.changeTabIndex(t)},closeCallBack:function(){for(var t in this.ctrl.openMainView(!1),this.view_list){var e=this.view_list[t];e.deleteMe(),e=null}this.view_list=null}});e.exports=o,cc._RF.pop()},{guild_event:"guild_event",pathtool:"pathtool",redbag_controller:"redbag_controller"}],role_body_panel:[function(t,e,i){"use strict";cc._RF.push(e,"7026eDDwwdMEYbAb/lu0Q6I","role_body_panel");var s=t("pathtool"),n=t("role_controller"),a=t("role_head_item"),o=t("baserole"),l=t("backpack_controller"),r=t("common_scrollview"),c=t("hero_controller"),_=t("partner_calculate"),h=cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("roleinfo","role_body_panel"),this.x=0,this.y=0,this.data=null,this.has_list={},this.item_list={},this.select_bid=0},initPanel:function(){this.setPosition(0,0),this.scroll_con=this.root_wnd.getChildByName("scroll_con"),this.ok_btn=this.root_wnd.getChildByName("ok_btn"),this.ok_label=this.ok_btn.getChildByName("Label").getComponent(cc.Label),this.body_con=this.root_wnd.getChildByName("body_con"),this.attr_desc=this.root_wnd.getChildByName("attr_con").getChildByName("desc").getComponent(cc.RichText),this.cond_desc=this.root_wnd.getChildByName("cond_con").getChildByName("desc").getComponent(cc.RichText),this.spine=new o,this.spine.setParent(this.body_con),this.spine.node.setPosition(0,10),this.spine.scale=.6;var t={item_class:a,start_x:0,space_x:4,start_y:0,space_y:0,item_width:125,item_height:145,row:0,col:2,once_num:4,need_dynamic:!0},e=cc.size(250,490);this.item_scrollview=new r,this.item_scrollview.createScroll(this.scroll_con,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,e,t,cc.v2(.5,.5)),n.getInstance().send10345()},registerEvent:function(){if(this.ok_btn.on(cc.Node.EventType.TOUCH_END,function(){this.select_item&&(1==this.select_item.data.status?n.getInstance().send10346(this.select_bid):this.cond_msg?message(this.cond_msg):n.getInstance().send10347(this.select_bid))},this),this.roleVo=n.getInstance().getRoleVo(),!this.role_update_evt){var e=t("role_event");this.role_update_evt=this.roleVo.bind(EventId.UPDATE_ROLE_ATTRIBUTE,function(t,e){"look_id"==t&&this.updateList()},this),this.addGlobalEvent(e.GetModelList,function(t){this.updateList(t.list)})}},onShow:function(){},updateList:function(t){if(t){this.has_list=this.has_list||{};for(var e=0;e<t.length;++e)this.has_list[t[e].id]=1}if(null==this.list)for(var i in this.list=[],Config.looks_data.data_data){var s=Config.looks_data.data_data[i],n={};if(n.tips=s.tips,n.bid=s.id,n.skin_id=s.skin_id,n.face_id=s.partner_id,0!=n.skin_id){var a=Config.partner_skin_data.data_skin_info[n.skin_id];a&&(n.face_id=a.head_id)}n.name=s.name,this.has_list&&this.has_list[s.id]?n.status=1:n.status=0,this.roleVo.look_id==s.id?n.use=1:n.use=0,this.list.push(n)}else for(var o in this.list){var l=this.list[o];this.roleVo.look_id==l.bid?l.use=1:l.use=0}this.list.sort(Utils.tableCommonSorter([["use",!0],["status",!0],["bid",!0]])),0==this.select_bid&&(this.select_bid=this.roleVo.look_id),this.item_scrollview.setData(this.list,function(t){1!=t.data.status&&message(Utils.TI18N("\u8be5\u5f62\u8c61\u672a\u89e3\u9501")),this.select_bid=t.data.bid,this.select_item&&this.select_item.setSelected(!1),this.select_item=t,this.setSelected(t)}.bind(this),{resObject:this.face_res_object,select_func:this.setSelected.bind(this)})},setSelected:function(t){if(t&&(t.setSelected(this.select_bid==t.data.bid),null==this.select_item&&(this.select_item=t)),this.select_bid==t.data.bid){this.spine.setData(o.type.role,this.select_bid,PlayerAction.show,!0,.6,{skin_id:t.data.skin_id});var e=Config.looks_data.data_data[this.select_bid];this.attr_desc.string=this.attrString(e),this.cond_desc.string=this.condString(e),1==this.select_item.data.status?this.ok_label.string=Utils.TI18N("\u66f4 \u6362"):this.ok_label.string=Utils.TI18N("\u6fc0 \u6d3b")}},attrString:function(t){var e=t.attr;if(0==e.length)return Utils.TI18N("<color=#a95f0f>\u5f53\u524d\u5f62\u8c61\u65e0\u5c5e\u6027\u52a0\u6210</color>");for(var i="",s=0,n=e.length;s<n;s++){var a=e[s];s>0&&s%2==0?i+="<br/>":s>0&&(i+="     "),1==_.isShowPerByStr(a[0])?i+=cc.js.formatStr("%s: %d%",Config.attr_data.data_key_to_name[a[0]],.1*a[1]):i+=cc.js.formatStr("%s: %d",Config.attr_data.data_key_to_name[a[0]],a[1])}return"<color=#a95f0f>"+i+"</color>"},condString:function(t){if(this.cond_msg=null,1==this.select_item.data.status)return Utils.TI18N("<color=#249003>\u5f53\u524d\u5f62\u8c61\u5df2\u89e3\u9501</color>");var e=[];(t.star>0&&(this.cond_msg=cc.js.formatStr(Utils.TI18N("%s\u672a\u8fbe\u5230%d\u661f"),t.name,t.star),e.push(cc.js.formatStr(Utils.TI18N("\u25c6 %s\u8fbe\u5230%d\u661f    <color=#d95014>\u672a\u8fbe\u6210</color>"),t.name,t.star))),t.skin_id)&&(c.getInstance().getModel().isUnlockHeroSkin(t.skin_id)?e.push(cc.js.formatStr(Utils.TI18N("\u25c6 \u89e3\u9501\u76ae\u80a4%s    <color=#249003>\u5df2\u8fbe\u6210</color>"),t.name)):e.push(cc.js.formatStr(Utils.TI18N("\u25c6 \u89e3\u9501\u76ae\u80a4%s    <color=#d95014>\u672a\u8fbe\u6210</color>"),t.name)));t.lev>1&&(this.roleVo.lev>=t.lev?(this.cond_msg=this.cond_msg||Utils.TI18N("\u7b49\u7ea7\u4e0d\u8db3"),e.push(cc.js.formatStr(Utils.TI18N("\u25c6 \u73a9\u5bb6\u7b49\u7ea7\u8fbe\u5230%d     <color=#249003>\u5df2\u8fbe\u6210</color>"),t.lev))):e.push(cc.js.formatStr(Utils.TI18N("\u25c6 \u73a9\u5bb6\u7b49\u7ea7\u8fbe\u5230%d     <color=#d95014>\u672a\u8fbe\u6210</color>"),t.lev))),t.vip_lev>0&&(this.roleVo.vip_lev>=t.vip_lev?(this.cond_msg=this.cond_msg||Utils.TI18N("VIP\u7b49\u7ea7\u4e0d\u8db3"),e.push(cc.js.formatStr(Utils.TI18N("\u25c6 \u73a9\u5bb6VIP\u7b49\u7ea7\u8fbe\u5230%d   <color=#249003>\u5df2\u8fbe\u6210</color>"),t.vip_lev))):e.push(cc.js.formatStr(Utils.TI18N("\u25c6 \u73a9\u5bb6VIP\u7b49\u7ea7\u8fbe\u5230%d   <color=#d95014>\u672a\u8fbe\u6210</color>"),t.vip_lev)));for(var i=0,s=t.expend;i<s;i++){var n=t.expend[i],a=Utils.getItemConfig(n[0]);l.getInstance().getModel().getBackPackItemNumByBid(n[0])>=n[1]?e.push(cc.js.formatStr(Utils.TI18N("\u25c6 \u62e5\u6709%s\u4e2a%s   <color=#249003>\u5df2\u8fbe\u6210</color>"),a.name,n[1])):e.push(cc.js.formatStr(Utils.TI18N("\u25c6 \u62e5\u6709%s\u4e2a%s   <color=#d95014>\u672a\u8fbe\u6210</color>"),a.name,n[1]))}return"<color=#a95f0f>"+e.join("<br/>")+"</color>"},onHide:function(){},onDelete:function(){this.role_update_evt&&this.roleVo.unbind(this.role_update_evt),this.item_scrollview&&this.item_scrollview.DeleteMe(),this.item_scrollview=null}});e.exports=h,cc._RF.pop()},{backpack_controller:"backpack_controller",baserole:"baserole",common_scrollview:"common_scrollview",hero_controller:"hero_controller",partner_calculate:"partner_calculate",pathtool:"pathtool",role_controller:"role_controller",role_event:"role_event",role_head_item:"role_head_item"}],role_controller:[function(t,e,i){"use strict";cc._RF.push(e,"2dffcv8hD1O0I8pPJXBDgcT","role_controller");var s=t("role_event"),n=cc.Class({extends:BaseController,ctor:function(){},initConfig:function(){var e=t("role_model");this.model=new e,this.model.initConfig(),this.is_re_connect=!1,this.apk_data=null},getModel:function(){return this.model},getRoleVo:function(){if(this.model)return this.model.getRoleVo()},registerEvents:function(){this.re_link_game_event=gcore.GlobalEvent.bind(EventId.LOADING_FINISH,function(){this.need_set_name&&this.openRoleSetNameView(!0)}.bind(this))},registerProtocals:function(){this.RegisterProtocal(10301,this.on10301),this.RegisterProtocal(10302,this.on10302),this.RegisterProtocal(10315,this.on10315),this.RegisterProtocal(10306,this.on10306),this.RegisterProtocal(10318,this.on10318),this.RegisterProtocal(10325,this.on10325),this.RegisterProtocal(10327,this.on10327),this.RegisterProtocal(10345,this.on10345),this.RegisterProtocal(10346,this.on10346),this.RegisterProtocal(10347,this.on10347),this.RegisterProtocal(10342,this.on10342),this.RegisterProtocal(10343,this.on10343),this.RegisterProtocal(10317,this.on10317),this.RegisterProtocal(10316,this.on10316),this.RegisterProtocal(12745,this.on12745),this.RegisterProtocal(10906,this.on10906),this.RegisterProtocal(10994,this.on10994),this.RegisterProtocal(10945,this.on10945),this.RegisterProtocal(21500,this.on21500),this.RegisterProtocal(21501,this.on21501),this.RegisterProtocal(21502,this.on21502),this.RegisterProtocal(21503,this.on21503),this.RegisterProtocal(23300,this.on23300),this.RegisterProtocal(23301,this.on23301),this.RegisterProtocal(23302,this.on23302),this.RegisterProtocal(23303,this.on23303),this.RegisterProtocal(24500,this.on24500),this.RegisterProtocal(10350,this.handle10350),this.RegisterProtocal(10351,this.handle10351),this.RegisterProtocal(12770,this.handle12770),this.RegisterProtocal(12771,this.handle12771),this.RegisterProtocal(10905,this.handle10905)},setReconnect:function(t){this.is_re_connect=t},isTheSameSvr:function(t){var e=this.model.isTheSame(t);return!(!t||!e)},on10301:function(e){if(cc.log("\u89d2\u8272\u57fa\u672c\u4fe1\u606f"),cc.log(e),this.init_role)this.model.initRoleBaseData(e);else{this.init_role=!0,this.model.initRoleBaseData(e),this.requestOpenSrvDay(),"SH_SDK"==PLATFORM_TYPR&&SDK.roleUpLevel(this.getRoleVo().lev),e.lev<=5&&(game.addGuideRes(),2==e.sex&&game.addRenameRes()),game.addChapterRes(e.chapter_id),e.lev<10&&(window.hide_loading=!0);var i=t("sys_controller").getInstance();game.preloadRes(function(){i.requestLoginProtocals(function(){t("mainui_controller").getInstance().openMainUI(!0),t("mainscene_controller").getInstance().enterMainScene(!0)}.bind(this))}.bind(this)),gcore.GlobalEvent.fire(EventId.EVT_ROLE_CREATE_SUCCESS),IS_SUBMIT&&SDK.sdkSubmitUserData(3),game.initMsgView()}this.is_re_connect&&(gcore.GlobalEvent.fire(EventId.EVT_RE_LINK_GAME),this.is_re_connect=!1)},on10302:function(t){this.model.initRoleAssetsData(t)},requestRoleInfo:function(t,e){if(0!=t&&e){var i={};i.rid=t,i.srv_id=e,this.SendProtocal(10315,i)}},on10315:function(t){gcore.GlobalEvent.fire(s.DISPATCH_PLAYER_VO_EVENT,t)},sender10316:function(t,e,i,s){if(t){i=i||0,s=s||0;var n={};n.type=s,n.rid=t,n.srv_id=e,n.idx=i,this.SendProtocal(10316,n)}},on10316:function(t){message(t.msg),1==t.code&&gcore.GlobalEvent.fire(s.WorshipOtherRole,t)},send10318:function(t){this.SendProtocal(10318,{auto_pk:t})},on10318:function(t){message(t.msg),1==t.code&&this.model.setRoleAttribute("auto_pk",t.auto_pk)},send10325:function(){this.SendProtocal(10325,{})},on10325:function(t){this.model.setRoleAttribute("face_list",t.face_list)},send10327:function(t){this.SendProtocal(10327,{face_id:t})},on10327:function(t){message(t.msg),1==t.code&&this.model.setRoleAttribute("face_id",t.face_id)},on12741:function(t){},on12745:function(e){var i=Utils.getItemConfig(e.bid);if(i)if(e.bid==Config.item_data.data_assets_label2id.gold||e.bid==Config.item_data.data_assets_label2id.gold)if(0==IS_SHOW_CHARGE)message(Utils.TI18N("\u94bb\u77f3\u4e0d\u8db3"));else{var s=function(){t("vip_controller").getInstance().openVipMainWindow(!0,VIPTABCONST.CHARGE)}.bind(this),n=cc.js.formatStr(Utils.TI18N("%s\u4e0d\u8db3\uff0c\u662f\u5426\u524d\u5f80\u5145\u503c"),i.name),a=t("commonalert");a.show(n,Utils.TI18N("\u786e\u5b9a"),s,Utils.TI18N("\u53d6\u6d88"),null,a.type.rich,null,null)}else if(e.bid==Config.item_data.data_assets_label2id.energy)message(Utils.TI18N("\u60c5\u62a5\u4e0d\u8db3"));else{var o=Utils.getItemConfig(e.bid);if(o)t("backpack_controller").getInstance().openTipsSource(!0,o.id)}},on10994:function(e){6==e.type||18==e.type?t("mainscene_controller").getInstance().changeMainCityTimeType(e.type):0==e.type&&(this.requestOpenSrvDay(),t("action_controller").getInstance().requestActionRedStatus(),t("startower_controller").getInstance().sender11320())},changeRoleName:function(t,e){this.SendProtocal(10343,{name:t,sex:e})},on10343:function(t){message(t.msg),1==t.code&&(this.model.setRoleAttribute("name",t.name),this.model.setRoleAttribute("sex",t.sex),this.model.setRoleAttribute("is_first_rename",0),this.openRoleSetNameView(!1))},send10345:function(){this.SendProtocal(10345,{})},on10345:function(t){gcore.GlobalEvent.fire(s.GetModelList,t)},send10346:function(t){this.SendProtocal(10346,{id:t})},on10346:function(t){message(t.msg),1==t.code&&gcore.GlobalEvent.fire(s.UpdateModel,t.id)},send10347:function(t){this.SendProtocal(10347,{id:t})},on10347:function(t){message(t.msg),1==t.code&&gcore.GlobalEvent.fire(s.ActiveModel,t.id)},sender10945:function(t){this.SendProtocal(10945,{card_id:t})},on10945:function(t){message(t.msg)},send21500:function(){this.SendProtocal(21500)},on21500:function(t){gcore.GlobalEvent.fire(s.GetFaceList,t)},send21501:function(t){this.SendProtocal(21501,{base_id:t})},on21501:function(t){},on21502:function(t){gcore.GlobalEvent.fire(s.GetFaceList,t)},send21503:function(t){this.SendProtocal(21503,{base_id:t})},on21503:function(t){gcore.GlobalEvent.fire(s.GetFaceList,t)},send23300:function(){this.SendProtocal(23300,{})},on23300:function(t){this.model.setRoleAttribute("title_id",t.base_id),this.model.setRoleAttribute("title_list",t.honor),gcore.GlobalEvent.fire(s.GetTitleList,t)},send23301:function(t){this.SendProtocal(23301,{base_id:t})},on23301:function(t){this.model.setRoleAttribute("title_id",t.base_id),gcore.GlobalEvent.fire(s.UseTitle,t.base_id)},on23302:function(t){this.model.setRoleAttribute("title_list",t.honor),gcore.GlobalEvent.fire(s.UpdateTitleList,t)},send23303:function(t){this.SendProtocal(23303,{base_id:t})},on23303:function(t){this.model.setRoleAttribute("title_list",t.honor),gcore.GlobalEvent.fire(s.UpdateTitleList,t)},openRoleInfoView:function(e){if(1==e){if(!this.role_info_view){var i=t("role_set_window");this.role_info_view=new i}this.role_info_view.open()}else this.role_info_view&&(this.role_info_view.close(),this.role_info_view=null)},openRoleDecorateView:function(e,i,s){if(e){if(!this.role_decorate_view){var n=t("role_decorate_window");this.role_decorate_view=new n}this.role_decorate_view.open(i,s)}else this.role_decorate_view&&(this.role_decorate_view.close(),this.role_decorate_view=null)},checkIsSelf:function(t,e){var i=this.getRoleVo();return null!=i&&(i.srv_id==t&&i.rid==e)},on24500:function(t){this.model.setPrivilegeData(t.list)},requestOpenSrvDay:function(){this.SendProtocal(10906,{})},on10906:function(t){this.model.setOpenSrvDay(t.open_day)},on10342:function(){game.finish_loading?this.openRoleSetNameView(!0):this.need_set_name=!0},on10317:function(){},openRoleSetNameView:function(e){if(1==e){if(null==this.role_setname_new){var i=t("role_setname_window");this.role_setname_new=new i}this.role_setname_new.open()}else null!=this.role_setname_new&&(this.role_setname_new.close(),this.role_setname_new=null)},getRandomName:function(t){t=t||1;var e="";for(var i in Config.random_name_data.data_list){for(var s=Config.random_name_data.data_list[i]||{},n=[],a=0;a<s.length;++a){var o=s[a];!o||o.sex!=t&&0!=o.sex||n.push(o)}e+=(n[~~(Math.random()*n.length)]||[]).name||""}return e},handle10350:function(t){this.model.initRoleActionAssetsData(t.holiday_assets,!1)},handle10351:function(t){this.model.initRoleActionAssetsData(t.holiday_assets,!0)},openRoleReportedPanel:function(e,i,s,n){if(1==e){if(null==this.role_reported_panel){var a=t("role_reported_window");this.role_reported_panel=new a}this.role_reported_panel.open({rid:i,srv_id:s,play_name:n})}else null!=this.role_reported_panel&&(this.role_reported_panel.close(),this.role_reported_panel=null)},send12770:function(t,e,i,s,n){var a={};a.rid=t,a.srv_id=e,a.type=i||1,a.msg=s||"",a.history=n||[],this.SendProtocal(12770,a)},send12771:function(t,e){var i={};i.rid=t,i.srv_id=e,this.SendProtocal(12771,i)},handle12770:function(t){message(t.msg)},handle12771:function(t){gcore.GlobalEvent.fire(s.ROLE_REPORTED_EVENT,t)},checkRoleSetNameViewIsOpen:function(){return!!this.role_setname_new},on10306:function(t){var e=this.getRoleVo();e.setPower(t.power),e.setMaxPower(t.max_power)},getApkData:function(){if(this.apk_data)return this.apk_data},handle10905:function(t){this.model.setWorldLev(t.world_lev)},send25830:function(t,e){var i={};i.start=t,i.num=e,this.SendProtocal(25830,i)},handle25830:function(t){cc.log("25830",t),t.num},send25831:function(t){var e={};e.channel=t,this.SendProtocal(25831,e)},handle25831:function(t){cc.log("25831",t)},send25832:function(t,e,i,s){var n={};n.rid=t,n.srv_id=e,n.start=i,n.num=s,this.SendProtocal(25832,n)},handle25832:function(t){cc.log("25832",t)},isfirstRole:function(){var t=this.getRoleVo();return!(!t||2!=t.sex)}});e.exports=n,cc._RF.pop()},{action_controller:"action_controller",backpack_controller:"backpack_controller",commonalert:"commonalert",mainscene_controller:"mainscene_controller",mainui_controller:"mainui_controller",role_decorate_window:"role_decorate_window",role_event:"role_event",role_model:"role_model",role_reported_window:"role_reported_window",role_set_window:"role_set_window",role_setname_window:"role_setname_window",startower_controller:"startower_controller",sys_controller:"sys_controller",vip_controller:"vip_controller"}],role_decorate_window:[function(t,e,i){"use strict";cc._RF.push(e,"f8900VQpeBILa9HICXhziuH","role_decorate_window");var s=t("pathtool"),n=(t("loadermanager"),t("role_controller")),a=cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("roleinfo","role_decorate_window"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Mini},openCallBack:function(){var t=this;this.background=this.root_wnd.getChildByName("background"),this.background.scale=FIT_SCALE,this.main_container=this.root_wnd.getChildByName("main_container"),this.title_container=this.main_container.getChildByName("title_container"),this.title_label=this.title_container.getChildByName("title_label").getComponent(cc.Label),this.title_label.string=Utils.TI18N("\u66f4\u6362\u88c5\u9970"),this.close_btn=this.main_container.getChildByName("close_btn"),this.scrollCon=this.main_container.getChildByName("scrollCon"),this.tab_container=this.main_container.getChildByName("tab_container"),this.tab_list=[{label:Utils.TI18N("\u5934\u50cf"),index:1,status:!0},{label:Utils.TI18N("\u5934\u50cf\u6846"),index:2,status:!1},{label:Utils.TI18N("\u5192\u9669\u5f62\u8c61"),index:3,status:!1},{label:Utils.TI18N("\u79f0\u53f7"),index:4,status:!1}];for(var e=function(e){(s=t.tab_list[e]).btn=t.tab_container.getChildByName("tab_btn_"+s.index),s.btn_label=s.btn.getChildByName("title").getComponent(cc.Label),s.btn_label.node.color=new cc.Color(207,181,147,255),s.btn_sprite=s.btn.getComponent(cc.Sprite),s.btn_label.string=s.label,s.btn.getComponent(cc.Button).interactable=!0,s.btn.on(cc.Node.EventType.TOUCH_END,function(t){this.changeIndex(e+1)},t)},i=0;i<4;i++){var s;e(i)}},registerEvent:function(){this.close_btn.on(cc.Node.EventType.TOUCH_END,function(t){n.getInstance().openRoleDecorateView(!1)},this),this.background.on(cc.Node.EventType.TOUCH_END,function(t){n.getInstance().openRoleDecorateView(!1)},this)},openRootWnd:function(t,e){this.changeIndex(t||1)},changeIndex:function(e){if(e!=this.index){if(this.index=e,this.cur_tab&&(this.cur_tab.btn.getComponent(cc.Button).interactable=!0,this.cur_tab.btn_label.node.color=new cc.Color(207,181,147,255),this.cur_tab.panel.hide()),this.cur_tab=this.tab_list[e-1],this.cur_tab&&(this.cur_tab.btn.getComponent(cc.Button).interactable=!1,this.cur_tab.btn_label.node.color=new cc.Color(255,237,214,255)),!this.cur_tab.panel)if(1==e)(i=new(t("role_head_panel"))).setParent(this.scrollCon),this.cur_tab.panel=i;else if(2==e){(i=new(t("role_face_panel"))).setParent(this.scrollCon),this.cur_tab.panel=i}else if(3==e){(i=new(t("role_body_panel"))).setParent(this.scrollCon),this.cur_tab.panel=i}else if(4==e){var i;(i=new(t("role_title_panel"))).setParent(this.scrollCon),this.cur_tab.panel=i}this.cur_tab.panel.show()}},closeCallBack:function(){for(var t in n.getInstance().openRoleDecorateView(!1),this.tab_list){var e=this.tab_list[t];e.panel&&e.panel.deleteMe()}this.tab_list=null}});e.exports=a,cc._RF.pop()},{loadermanager:"loadermanager",pathtool:"pathtool",role_body_panel:"role_body_panel",role_controller:"role_controller",role_face_panel:"role_face_panel",role_head_panel:"role_head_panel",role_title_panel:"role_title_panel"}],role_event:[function(t,e,i){"use strict";cc._RF.push(e,"0f9623Hj01EbqCIvGUjN1DS","role_event"),e.exports={GetFaceList:"GetFaceList",UpdateTitleList:"UpdateTitleList",GetTitleList:"GetTitleList",UseTitle:"UseTitle",GetModelList:"GetModelList",UpdateModel:"UpdateModel",ActiveModel:"ActiveModel",DISPATCH_PLAYER_VO_EVENT:"DISPATCH_PLAYER_VO_EVENT",OPEN_SRV_DAY:"OPEN_SRV_DAY",WorshipOtherRole:"WorshipOtherRole",UPDATE_ROLE_ACTION_ASSETS:"UPDATE_ROLE_ACTION_ASSETS",UPDATE_ROLE_ATTRIBUTE:"UPDATE_ROLE_ATTRIBUTE",ROLE_REPORTED_EVENT:"ROLE_REPORTED_EVENT"},cc._RF.pop()},{}],role_face_item:[function(t,e,i){"use strict";cc._RF.push(e,"a6edfwxtjVGI7l+ZssJ6RMJ","role_face_item");var s=t("pathtool");t("role_controller"),cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("roleinfo","role_face_item")},initConfig:function(){},initPanel:function(){this.icon_bg_nd=this.seekChild("icon_bg"),this.select_nd=this.seekChild("select"),this.select_nd.active=!1,this.use_icon_nd=this.seekChild("use"),this.use_icon_nd.active=!1,this.face_icon_sp=this.seekChild("icon",cc.Sprite),this.face_name_lb=this.seekChild("label",cc.Label),this.face_name_bg_sp=this.seekChild("name_bg",cc.Sprite),this.active_nd=this.seekChild("active"),this.active_nd.active=!1},registerEvent:function(){this.root_wnd.on(cc.Node.EventType.TOUCH_END,function(){this.call_fun&&this.call_fun(this,this.vo)},this)},setTouchFunc:function(t){this.call_fun=t},setData:function(t){cc.log(t),this.root_wnd&&this.onShow()},onShow:function(){if(null!=this.vo){var t=this.vo;0!=t.has?this.active_nd.active=!1:this.active_nd.active=!0;var e=t.res_id||0,i=s.getUIIconPath("headcircle","txt_cn_headcircle_"+e);0==e?this.face_icon_sp.node.scale=1:this.face_icon_sp.node.sacle=.95,this.loadRes(i,function(t){this.face_icon_sp.spriteFrame=t}.bind(this));Config.avatar_data.data_avatar[t.base_id];config&&(this.icon_bg_nd.y=this.icon_bg_nd.y-config.offy);var n=t.name||"";this.face_name_lb.string=n,this.updateRedPoint()}},updateRedPoint:function(){},setSelected:function(t){this.select_nd.active=t},showLock:function(t){this.is_can_active=!1,this.is_lock=t},showUseIcon:function(t){this.is_use=t,this.use_icon_nd.active=boo},isHaveData:function(){return!!this.vo},getData:function(){return this.vo},getIsLock:function(){return this.is_lock},getIsActive:function(){return this.is_can_active},getIsUse:function(){return this.is_use},onHide:function(){},onDelete:function(){}});cc._RF.pop()},{pathtool:"pathtool",role_controller:"role_controller"}],role_face_panel:[function(t,e,i){"use strict";cc._RF.push(e,"6f7a4HH5PZG+IeBgXRTKB+T","role_face_panel");var s=t("pathtool"),n=(t("timetool"),t("role_controller")),a=t("backpack_controller"),o=(t("tips_controller"),cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("roleinfo","role_face_panel"),this.x=0,this.y=0,this.data=null,this.has_list={},this.item_list={}},initPanel:function(){this.setPosition(0,0),this.scroll_con=this.root_wnd.getChildByName("scroll_con"),this.view=this.scroll_con.getChildByName("view"),this.content=this.view.getChildByName("content"),this.ok_btn=this.root_wnd.getChildByName("ok_btn"),this.ok_label=this.ok_btn.getChildByName("Label").getComponent(cc.Label),this.item=this.root_wnd.getChildByName("item"),n.getInstance().send21500()},registerEvent:function(){if(this.ok_btn.on(cc.Node.EventType.TOUCH_END,function(){this.select_item&&(1==this.select_item.v.status?n.getInstance().send21501(this.select_bid):n.getInstance().send21503(this.select_bid))},this),this.roleVo=n.getInstance().getRoleVo(),!this.role_update_evt){var e=t("role_event");this.role_update_evt=this.roleVo.bind(EventId.UPDATE_ROLE_ATTRIBUTE,function(t,e){"avatar_base_id"==t&&this.updateList()},this),this.addGlobalEvent(e.GetFaceList,function(t){this.updateList(t.avatar_frame)})}},onShow:function(){},updateList:function(t){if(t)for(var e in this.has_list=this.has_list||{},t)this.has_list[t[e].base_id]=t[e];for(var e in this.list=[],Config.avatar_data.data_avatar){var i=Config.avatar_data.data_avatar[e];1!=i.is_show||(i.base_id==this.roleVo.avatar_base_id?this.list.push({bid:i.base_id,use:1,status:1,sort:11e5-i.base_id}):this.has_list[i.base_id]?this.list.push({bid:i.base_id,use:0,status:1,sort:1e5-i.base_id}):i.loss&&i.loss[0]?a.getInstance().getModel().getBackPackItemNumByBid(i.loss[0][0])>=i.loss[0][1]?this.list.push({bid:i.base_id,use:0,status:2,sort:2e6-i.base_id}):this.list.push({bid:i.base_id,use:0,status:0,sort:-i.base_id}):this.list.push({bid:i.base_id,use:0,status:2,sort:2e6-i.base_id}))}this.list.sort(Utils.tableUpperSorter(["has","base_id"]));var s=0,n=function(t){if(this.list&&this.item_list&&0!=this.list.length){t=t||2;for(var e=0;e<t;e++){if(0==this.list.length)return;this.createItem(s,this.list.pop()),s++}gcore.Timer.set(n,20,1,"role_face_panel_timer")}}.bind(this);n(10)},createItem:function(t,e){var i=this.item_list[e.bid];if(!i){var n=Config.avatar_data.data_avatar[e.bid];i=cc.instantiate(this.item),this.content.addChild(i),this.item_list[e.bid]=i,i.active=!0,i.icon=i.getChildByName("icon").getComponent(cc.Sprite),i.use=i.getChildByName("use"),i.select=i.getChildByName("select"),i.active_node=i.getChildByName("active"),i.label=i.getChildByName("label").getComponent(cc.Label),i.label.string=n.name,i.icon_bg=i.getChildByName("icon_bg"),n.offy&&(i.icon_bg.y=i.icon_bg.y-n.offy),i.on(cc.Node.EventType.TOUCH_END,function(){this.setSelected(e.bid)}.bind(this)),this.loadRes(s.getHeadcircle(n.res_id),function(t){i.icon.spriteFrame=t}.bind(this))}i.v=e;var a=-(170*parseInt(t/4)+70);i.setPosition(t%4*150+75,a),1==e.use?(i.use.active=!0,this.setSelected(e.bid)):i.use.active=!1,i.active_node.active=2==e.status,1==e.status?i.icon.setMaterial(0,cc.Material.getBuiltinMaterial("2d-sprite")):i.icon.setMaterial(0,cc.Material.getBuiltinMaterial("2d-gray-sprite"))},setSelected:function(t){this.select_bid!=t&&(this.select_bid=t,this.select_item&&(this.select_item.select.active=!1),this.select_item=this.item_list[t],this.select_item&&(this.select_item.select.active=!0,1==this.select_item.v.status?this.ok_label.string=Utils.TI18N("\u66f4 \u6362"):this.ok_label.string=Utils.TI18N("\u6fc0 \u6d3b")))},onHide:function(){},onDelete:function(){this.role_update_evt&&this.roleVo.unbind(this.role_update_evt),this.list=null,this.item_list=null}}));e.exports=o,cc._RF.pop()},{backpack_controller:"backpack_controller",pathtool:"pathtool",role_controller:"role_controller",role_event:"role_event",timetool:"timetool",tips_controller:"tips_controller"}],role_faced_panel:[function(t,e,i){"use strict";cc._RF.push(e,"3d53bsaLvBAzqAuZrycMbaP","role_faced_panel");var s=t("pathtool"),n=t("role_controller"),a=t("backpack_controller"),o=t("common_scrollview"),l=t("role_face_item"),r=t("role_event");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("roleinfo","role_face_panel")},initConfig:function(){this.ctrl=n.getInstance(),this.item_list={},this.group_list={},this.have_list={},this.is_first=!0,this.role_vo=this.ctrl.getRoleVo()},initPanel:function(){this.scroll_con=this.root_wnd.getChildByName("scroll_con"),this.view=this.scroll_con.getChildByName("view"),this.content=this.view.getChildByName("content"),this.use_btn=this.root_wnd.getChildByName("ok_btn"),this.use_btn_label=this.use_btn.getChildByName("Label").getComponent(cc.Label),this.item=this.root_wnd.getChildByName("item");var t={item_class:l,start_x:5,space_x:4,start_y:0,space_y:10,item_width:141,item_height:120,row:0,col:4,once_num:4,need_dynamic:!0},e=cc.size(604,514);this.item_scrollview=new o,this.item_scrollview.createScroll(this.scroll_con,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,e,t,cc.v2(.5,.5)),this.ctrl.send21500()},registerEvent:function(){Utils.onTouchEnd(this.use_btn,function(){if(this.select_item&&this.select_item.getData()){var t=this.select_item.getData();if(t&&t.base_id){if(1==(this.select_item.getIsLock()||!1))return void this.ctrl.send21503(t.base_id);var e=t.base_id;if(110==t.group)for(var i in this.have_list){var s=this.have_list[i];for(var i in this.have_list)this.isSameGroup(s.base_id,t.base_id)&&(e=s.base_id)}this.ctrl.send21501(e)}}}.bind(this),1),this.addGlobalEvent(r.GetFaceList,function(t){if(t&&t.avatar_frame)for(var e in t.avatar_frame){var i=t.avatar_frame[e];if(i&&i.base_id){this.have_list[i.base_id]=i;var s=Config.avatar_data.data_avatar[i.base_id];s&&s.group&&(this.group_list[s.group]=s)}}this.createItemList()}),this.role_update_evt||(this.role_update_evt=this.role_vo.bind(EventId.UPDATE_ROLE_ATTRIBUTE,function(t,e){"avatar_base_id"==t&&this.role_vo&&this.role_vo.avatar_base_id},this))},onShow:function(t){},createItemList:function(){Config.avatar_data.data_avatar_length;var t=Config.avatar_data.data_avatar;if(t){var e=[];for(var i in t){if(1==(o=t[i]).is_show){if(o.has=3,o.loss&&null!=Utils.next(o.loss||{})){var s=o.loss[0][0],n=o.loss[0][1];if(!this.have_list[o.base_id])a.getInstance().getModel().getBackPackItemNumByBid(s)>=n&&(o.has=0)}else o.has=1;e.push(o)}}for(i=0;i<e.length;i++){var o=e[i];this.have_list[o.base_id]&&(o.has=2)}e.sort(Utils.tableLowerSorter(["has","base_id"]));(function(t,e){this.select_item&&this.select_item.setSelected(!1),this.select_item=t,this.select_item.setSelected(!0);var i=this.select_item.getIsLock()||!1;this.use_btn_label.string=1==i?Utils.TI18N("\u6fc0 \u6d3b"):Utils.TI18N("\u66f4 \u6362"),0==this.is_first||(this.is_first=!1)}).bind(this);this.item_scrollview.setData(e)}},isSameGroup:function(t,e){var i=Config.avatar_data.data_avatar[t];if(!i)return!1;var s=Config.avatar_data.data_avatar[e];return!!s&&!(!i.group||i.group!=s.group)},getGroupByBid:function(t){var e=Config.avatar_data.data_avatar[t];return e&&e.group||0},setVisibleStatus:function(t){this.setVisible(t)},createTimer:function(t){},onHide:function(){},onDelete:function(){this.item_scrollview&&(this.item_scrollview.deleteMe(),this.item_scrollview=null),this.role_update_evt&&this.role_vo.unbind(this.role_update_evt)}});cc._RF.pop()},{backpack_controller:"backpack_controller",common_scrollview:"common_scrollview",pathtool:"pathtool",role_controller:"role_controller",role_event:"role_event",role_face_item:"role_face_item"}],role_head_item:[function(t,e,i){"use strict";cc._RF.push(e,"ddce69j8fFOFYJV2XdB+Cj/","role_head_item");var s=t("playerhead"),n=cc.Class({extends:s,ctor:function(){},initPanel:function(){this._super()},registerEvent:function(){this._super()},onShow:function(){this.setLockStatus(1==this.data.status),this.setUsed(1==this.data.use),this.setName(this.data.name),this.setHeadRes(this.data.face_id),this.extend_data.select_func&&this.extend_data.select_func(this)},setData:function(t){this.data=t,this.show(t)},setExtendData:function(t){this.extend_data=t},setName:function(t){t&&(this.name_node||(this.name_node=new cc.Node,this.name_label=this.name_node.addComponent(cc.Label),this.root_wnd.addChild(this.name_node),this.name_node.setPosition(0,-75),this.name_node.color=new cc.Color(104,69,42),this.name_label.fontSize=24),this.name_label.string=t)},setUsed:function(t){this.root_wnd&&(t?(this.use_node||(this.use_node=new cc.Node,this.use_node_sprite=this.use_node.addComponent(cc.Sprite),this.loadRes(PathTool.getUIIconPath("face","txt_cn_face_use"),function(t){this.use_node_sprite.spriteFrame=t}.bind(this)),this.root_wnd.addChild(this.use_node,100),this.use_node.setPosition(12,-33)),this.use_node.active=!0):this.use_node&&(this.use_node.active=!1))},setSelected:function(t){if(this.root_wnd)if(t){if(!this.select){this.select=new cc.Node,this.select_sprite=this.select.addComponent(cc.Sprite);var e=PathTool.getCommonIcomPath("common_1060");this.loadRes(e,function(t){this.select_sprite.spriteFrame=t}.bind(this)),this.root_wnd.addChild(this.select)}this.select.active=t,this.select.runAction(cc.repeatForever(cc.sequence(cc.fadeIn(.7),cc.fadeOut(.7))))}else this.select&&(this.select.active=t,this.select.stopAllActions())},onDelete:function(){this.select&&(this.select.destroy(),this.select=null,this.select_sprite=null),this.use_node&&(this.use_node.destroy(),this.use_node=null,this.use_node_sprite=null)}});e.exports=n,cc._RF.pop()},{playerhead:"playerhead"}],role_head_panel:[function(t,e,i){"use strict";cc._RF.push(e,"f4c04as1WpF4qH2iJeienwX","role_head_panel");var s=t("pathtool"),n=t("role_controller"),a=t("role_head_item"),o=t("common_scrollview"),l=cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("roleinfo","role_head_panel"),this.data=null,this.has_list={},this.select_bid=0},initPanel:function(){this.setPosition(0,0),this.scroll_con=this.root_wnd.getChildByName("scroll_con"),this.ok_btn=this.root_wnd.getChildByName("ok_btn");var t={item_class:a,start_x:5,space_x:4,start_y:0,space_y:10,item_width:141,item_height:120,row:0,col:4,once_num:4,need_dynamic:!0},e=cc.size(604,514);this.item_scrollview=new o,this.item_scrollview.createScroll(this.scroll_con,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,e,t,cc.v2(.5,.5)),n.getInstance().send10325()},registerEvent:function(){this.ok_btn.on(cc.Node.EventType.TOUCH_END,function(){this.select_bid&&n.getInstance().send10327(this.select_bid)},this),this.roleVo=n.getInstance().getRoleVo(),this.role_update_evt||(this.role_update_evt=this.roleVo.bind(EventId.UPDATE_ROLE_ATTRIBUTE,function(t,e){"face_id"==t?this.updateList():"face_list"==t&&this.updateList(e)},this))},onShow:function(){},updateList:function(t){if(t)for(var e in this.has_list=this.has_list||{},t)this.has_list[t[e].face_id]=1;if(null==this.list)for(var i in this.list=[],Config.looks_data.data_head_data){var s=Config.looks_data.data_head_data[i],n={};n.tips=s.tips,n.bid=s.id,n.face_id=s.id,this.has_list&&this.has_list[s.id]?n.status=1:n.status=0,this.roleVo.face_id==s.id?n.use=1:n.use=0,this.list.push(n)}else for(var a in this.list){var o=this.list[a];this.roleVo.face_id==o.bid?o.use=1:o.use=0}this.list.sort(Utils.tableCommonSorter([["use",!0],["status",!0],["bid",!1]])),0==this.select_bid&&(this.select_bid=this.roleVo.face_id),this.item_scrollview.setData(this.list,function(t){0==t.data.status?message(Utils.TI18N(t.data.tips)):(this.select_bid=t.data.bid,this.select_item&&this.select_item.setSelected(!1),this.select_item=t,this.setSelected(t))}.bind(this),{resObject:this.face_res_object,select_func:this.setSelected.bind(this)}),this.item_scrollview.addEndCallBack(function(){cc.log(this.item_scrollview)}.bind(this))},setSelected:function(t){t&&(t.setSelected(this.select_bid==t.data.bid),null==this.select_item&&(this.select_item=t))},onHide:function(){},onDelete:function(){this.role_update_evt&&this.roleVo.unbind(this.role_update_evt),this.item_scrollview&&this.item_scrollview.DeleteMe(),this.item_scrollview=null}});e.exports=l,cc._RF.pop()},{common_scrollview:"common_scrollview",pathtool:"pathtool",role_controller:"role_controller",role_head_item:"role_head_item"}],role_model:[function(t,e,i){"use strict";cc._RF.push(e,"f613ftIN6JL74MO9bFkYBmJ","role_model");cc.Class({ctor:function(){this.role_vo=null},initConfig:function(){this.open_srv_day=0,this.world_lev=0},setWorldLev:function(t){this.world_lev=t},getWorldLev:function(){return this.world_lev},initRoleBaseData:function(t){this.initAttribute(t),this.role_vo.dispatchUpdateBaseAttr()},initRoleAssetsData:function(t){this.initAttribute(t)},initAttribute:function(e){if(!this.role_vo){var i=t("role_vo");this.role_vo=new i}this.role_vo.initAttributeData(e)},setRoleAttribute:function(t,e){this.role_vo&&this.role_vo.setRoleAttribute(t,e)},setPrivilegeData:function(t){this.privilege_data=t},checkPrivilegeStatus:function(t){var e=!1;if(this.privilege_data)for(var i=0;i<this.privilege_data.length;i++){var s=this.privilege_data[i];if(s.id==t){e=1==s.status;break}}return e},getRoleVo:function(){return this.role_vo},setOpenSrvDay:function(t){this.open_srv_day=t,this.setRoleAttribute("open_day",t),gcore.GlobalEvent.fire(EventId.OPEN_SRV_DAY,t)},getOpenSrvDay:function(){return this.open_srv_day},isTheSame:function(t){return!this.serverList||!t||null!=this.serverList[t]},initRoleActionAssetsData:function(e,i){if(!this.role_vo){var s=t("role_vo");this.role_vo=new s}e&&this.role_vo.initActionAssetsData(e,i)}});cc._RF.pop()},{role_vo:"role_vo"}],role_reported_window:[function(t,e,i){"use strict";function s(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}cc._RF.push(e,"cb10bguCEFK2brKTmQzzbWx","role_reported_window");var n=t("pathtool"),a=t("role_controller"),o=t("role_event"),l=t("chat_const");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=n.getPrefabPath("roleinfo","role_reported_panel"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Mini,this.ctrl=a.getInstance()},initConfig:function(){this.item_list=[]},openCallBack:function(){var t;this.background=this.root_wnd.getChildByName("background"),this.background.scale=FIT_SCALE,this.inputBox_eb=this.seekChild("EditBox",cc.EditBox),this.main_container=this.root_wnd.getChildByName("main_container"),this.main_panel=this.main_container.getChildByName("main_panel"),this.title=this.main_panel.getChildByName("win_title"),this.title.getComponent("cc.Label").string="\u4e3e\u62a5",this.close_btn=this.main_panel.getChildByName("close_btn"),this.key_reported=this.main_container.getChildByName("key_reported"),this.key_reported.getComponent("cc.Label").string="\u4e3e\u62a5\u539f\u56e0:",this.key_explain=this.main_container.getChildByName("key_explain"),this.key_explain.getComponent("cc.Label").string="\u9644\u52a0\u8bf4\u660e:",this.key_evidence=this.main_container.getChildByName("key_evidence"),this.key_evidence.getComponent("cc.Label").string="\u4e3e\u62a5\u8bc1\u636e:",this.key_evidence2=this.main_container.getChildByName("key_evidence2"),this.key_evidence2.getComponent("cc.Label").string="\u52fe\u9009\u53d1\u8a00\u8bb0\u5f55\u4f5c\u4e3a\u8bc1\u636e:",this.key_reported_name=this.main_container.getChildByName("key_reported_name"),this.key_reported_name.getComponent("cc.Label").string="\u88ab\u4e3e\u62a5\u73a9\u5bb6:",this.reported_name=this.main_container.getChildByName("reported_name");var e=(s(t={},1,Utils.TI18N("\u6635\u79f0\u4e0d\u96c5")),s(t,2,Utils.TI18N("\u9a9a\u6270\u8c29\u9a82")),s(t,3,Utils.TI18N("\u5e7f\u544a\u5237\u5c4f")),s(t,4,Utils.TI18N("\u8272\u60c5\u66b4\u529b")),s(t,5,Utils.TI18N("\u53cd\u52a8\u8bc1\u636e")),s(t,6,Utils.TI18N("\u5176\u4ed6")),t);this.checkbox_list={};for(var i=1;i<=6;++i){var n=this.main_container.getChildByName("toggle").getChildByName("checkbox"+i);if(n){var a=n.getChildByName("name");e[i]&&(a.getComponent("cc.Label").string=e[i]),this.checkbox_list[i]=n}}this.item_scrollview=this.main_container.getChildByName("item_scrollview"),this.item_scrollview_size=this.item_scrollview.getContentSize(),this.look_btn=this.main_container.getChildByName("look_btn"),this.comfirm_btn=this.main_container.getChildByName("comfirm_btn"),this.comfirm_btn.getChildByName("label").getComponent("cc.Label").string=Utils.TI18N("\u63d0 \u4ea4")},registerEvent:function(){this.background.on("touchend",function(){Utils.playButtonSound(2),this.onClickBtnClose()},this),this.look_btn.on("click",function(){Utils.playButtonSound(1);var e=Config.role_data.data_role_const.game_rule1,i=this.look_btn.convertToWorldSpace(cc.v2(0,0));t("tips_controller").getInstance().showCommonTips(e.desc,i)},this),this.close_btn.on("click",function(){Utils.playButtonSound(2),this.onClickBtnClose()},this),this.comfirm_btn.on("click",this.onClickBtnComfirm,this),this.addGlobalEvent(o.ROLE_REPORTED_EVENT,function(t){t&&this.setData(t)}.bind(this))},openRootWnd:function(t){var e=t.rid,i=t.srv_id,s=t.play_name;if(e&&i&&s){this.rid=e,this.svr_id=i,this.play_name=s,this.reported_name.getComponent(cc.Label).string=s,this.ctrl.send12771(e,i)}},setData:function(t){var e;this.data=t;var i=(s(e={},l.Channel.World,Utils.TI18N("\u4e16\u754c")),s(e,2,Utils.TI18N("\u516c\u4f1a")),s(e,3,Utils.TI18N("\u79c1\u804a")),s(e,4,Utils.TI18N("\u7cfb\u7edf")),s(e,l.Channel.Cross,Utils.TI18N("\u8de8\u670d")),s(e,6,Utils.TI18N("\u540c\u7701")),e);this.data.history.sort(function(t,e){return t.id-e.id}),this.show_list=[];for(var n=0;n<this.data.history.length;++n){var a=this.data.history[n],o=void 0;null==(o=i[a.channel])&&(o=Utils.TI18N("\u672a\u77e5"));var r=this.filterFace(a.msg);a.show_info="["+o+"] <color=#249003>"+this.play_name+":</color> "+r,r.length>0&&this.show_list.push(a)}this.updateList()},filterFace:function(t){if(0==t.length)return"";var e=t.indexOf("<"),i=t.indexOf(">");return-1!=e&&-1!=i&&e+32==i?(t=t.slice(0,t.indexOf("<img src='emoji"))+t.slice(t.indexOf(">")+1),this.filterFace(t)):t},updateList:function(){for(var t=this,e=n.getPrefabPath("roleinfo","role_reported_item"),i=function(i){var s=new cc.Node;s.setAnchorPoint(.5,1),t.item_list.push(s),Utils.delayRun(t.item_scrollview,Number(i)/30,function(){this.item_scrollview.getChildByName("content").addChild(s);var t=s;this.loadRes(e,function(e){var s=this.show_list[i],n=e;t.addChild(n),n.getChildByName("text").getComponent(cc.RichText).string=s.show_info,n.height=n.getChildByName("text").height+24,t.setContentSize(n.getContentSize())}.bind(this))}.bind(t))},s=0;s<this.show_list.length;++s)i(s)},onClickBtnClose:function(){this.ctrl.openRoleReportedPanel(!1)},onClickBtnComfirm:function(){if(this.data){var t=1;for(var e in this.checkbox_list)if(this.checkbox_list[e].getComponent(cc.Toggle).isChecked){t=Number(e);break}var i=this.inputBox_eb.string||"",s=[];if(this.item_list)for(var n=0;n<this.item_list.length;++n){this.item_list[n].getChildByName("Layer").getChildByName("checkbox").getComponent(cc.Toggle).isChecked&&s.push({id:this.show_list[n].id})}this.ctrl.send12770(this.rid,this.svr_id,t,i,s),this.onClickBtnClose()}},closeCallBack:function(){this.ctrl.openRoleReportedPanel(!1)}});cc._RF.pop()},{chat_const:"chat_const",pathtool:"pathtool",role_controller:"role_controller",role_event:"role_event",tips_controller:"tips_controller"}],role_set_window:[function(t,e,i){"use strict";cc._RF.push(e,"4a683zFm0tJE59X96LBGFnU","role_set_window");var s=t("pathtool"),n=t("role_controller"),a=t("baserole"),o=t("playerhead"),l=t("login_controller"),r=cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("roleinfo","role_set_window"),this.viewTag=SCENE_TAG.dialogue},openCallBack:function(){this.main_container=this.root_wnd.getChildByName("main_container"),this.close_btn=this.main_container.getChildByName("close_btn"),this.background=this.seekChild("background"),this.background.scale=FIT_SCALE;var t=this.main_container.getChildByName("info_con");this.name=t.getChildByName("name").getComponent(cc.Label),this.pen=t.getChildByName("pen"),this.title_label=t.getChildByName("title_val").getComponent(cc.Label),this.head=new o,this.head.setParent(t),this.head.setPosition(-119,22),this.head.show();var e=this.main_container.getChildByName("music_con");this.music_btn=e.getChildByName("music_btn").getComponent(cc.Toggle),this.sound_btn=e.getChildByName("sound_btn").getComponent(cc.Toggle),this.voice_btn=e.getChildByName("voice_btn").getComponent(cc.Toggle),this.auto_pk_btn=e.getChildByName("auto_pk_btn").getComponent(cc.Toggle),this.property_btn=this.seekChild(e,"property_btn",cc.Toggle);var i=this.main_container.getChildByName("btn_con");if(this.quit_btn=i.getChildByName("quit_btn"),this.switch_btn=i.getChildByName("switch_btn"),this.exchange_btn=i.getChildByName("exchange_btn"),this.contact_btn=i.getChildByName("contact_btn"),this.language_btn=this.seekChild(i,"language_btn"),this.share_btn=this.seekChild(i,"share_btn"),this.customer_service_btn=this.seekChild(i,"customer_service_btn"),"SH_RH"==PLATFORM_TYPR)this.share_btn.active=!1,this.switch_btn.active=!1,this.quit_btn.active=!1,e.y=40,this.voice_btn.node.y=-50,this.property_btn.node.y=-50,this.auto_pk_btn.node.y=-133,this.contact_btn.y=-60,this.exchange_btn.y=-60;else if("QQ_SDK"==PLATFORM_TYPR)this.switch_btn.active=!1,this.share_btn.active=!1,this.property_btn.node.active=!1,this.auto_pk_btn.node.x=66,this.auto_pk_btn.node.y=-36.7;else if("SH_SDK"==PLATFORM_TYPR){this.share_btn.active=!1,this.switch_btn.active=this.customer_service_btn.active=!0,this.switch_btn.getChildByName("Label").getComponent(cc.Label).string=Utils.TI18N("\u5237\u65b0\u6e38\u620f"),this.quit_btn.active=!1,e.y=40,this.voice_btn.node.y=-40,this.property_btn.node.y=-40,this.auto_pk_btn.node.y=-113,this.contact_btn.y=-20,this.exchange_btn.y=-20,this.switch_btn.y=-100,this.customer_service_btn.y=-100}this.model_con=this.main_container.getChildByName("model_con"),this.change_btn=this.model_con.getChildByName("change_btn"),this.title=this.model_con.getChildByName("title_img").getComponent(cc.Sprite),this.spine=new a,this.spine.setParent(this.model_con),this.spine.node.setPosition(110,-5),this.roleVo=n.getInstance().getRoleVo(),this.roleVo.title_id||n.getInstance().send23300()},registerEvent:function(){this.background.on(cc.Node.EventType.TOUCH_END,function(t){n.getInstance().openRoleInfoView(!1)},this),this.close_btn.on(cc.Node.EventType.TOUCH_END,function(t){n.getInstance().openRoleInfoView(!1)},this),this.change_btn.on(cc.Node.EventType.TOUCH_END,function(t){n.getInstance().openRoleDecorateView(!0)},this),this.music_btn.node.on(cc.Node.EventType.TOUCH_END,function(t){gcore.SysEnv.set("music_status",this.music_btn.isChecked?"1":"0"),gcore.GlobalEvent.fire(EventId.VOICE_SETTING,"music_status")},this),this.sound_btn.node.on(cc.Node.EventType.TOUCH_END,function(t){gcore.SysEnv.set("sound_status",this.sound_btn.isChecked?"1":"0"),gcore.GlobalEvent.fire(EventId.VOICE_SETTING,"sound_status")},this),this.voice_btn.node.on(cc.Node.EventType.TOUCH_END,function(t){gcore.SysEnv.set("voice_status",this.voice_btn.isChecked?"1":"0"),gcore.GlobalEvent.fire(EventId.VOICE_SETTING,"voice_status")},this),this.auto_pk_btn.node.on(cc.Node.EventType.TOUCH_END,function(t){n.getInstance().send10318(this.auto_pk_btn.isChecked?1:0)},this),this.language_btn.on(cc.Node.EventType.TOUCH_END,function(t){message("\u529f\u80fd\u6682\u672a\u5f00\u653e!")},this),this.share_btn.on(cc.Node.EventType.TOUCH_END,function(t){message("\u529f\u80fd\u6682\u672a\u5f00\u653e!")},this),this.quit_btn.on(cc.Node.EventType.TOUCH_END,function(t){window.location.reload()},this),this.switch_btn.on(cc.Node.EventType.TOUCH_END,function(t){if(n.getInstance().init_role=!1,"SH_SDK"==PLATFORM_TYPR){if(1==IS_RESET)return;IS_RESET=!0,l.getInstance().sender10312()}else window.location.reload()},this),this.contact_btn.on(cc.Node.EventType.TOUCH_END,function(e){t("notice_controller").getInstance().openBugPanel(!0)}),this.customer_service_btn.on(cc.Node.EventType.TOUCH_END,function(t){"SH_SDK"==PLATFORM_TYPR&&SDK&&SDK.openCustomerServiceConversation()}),this.exchange_btn.on(cc.Node.EventType.TOUCH_END,function(e){t("commonalert").showInputApply(null,null,Utils.TI18N("\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u5151\u6362\u7801"),Utils.TI18N("\u5151\u6362"),function(t){if(""!=(t=t.replace("\n","")))return n.getInstance().sender10945(t),!0;message(Utils.TI18N("\u8bf7\u8f93\u5165\u5151\u6362\u7801"))}.bind(this),null,null,null,null,{maxLength:36},2)},this),this.role_update_evt||(this.role_update_evt=this.roleVo.bind(EventId.UPDATE_ROLE_ATTRIBUTE,function(t,e){"name"==t?this.name.string=e:"look_id"==t?this.updateSpine(e):"title_id"==t?this.updateTitle(e):"face_id"==t?this.updateHead(e):"avatar_base_id"==t&&this.updateHeadFrame(e)},this)),this.pen.on(cc.Node.EventType.TOUCH_END,function(e){var i=t("commonalert"),a=Utils.TI18N("<color=#a95f0f>\u6539\u540d\u9700\u6d88\u8017200 <img src='3' /></color>"),o=s.getItemRes(3);1==this.roleVo.is_first_rename&&(a=Utils.TI18N("<color=#a95f0f>\u9996\u6b21\u66f4\u6539\u514d\u8d39\u54e6~</color>")),i.showInputApply(Utils.TI18N("\u540d\u5b57\uff1a"),a,Utils.TI18N("\u8bf7\u8f93\u5165\u540d\u5b57\uff08\u9650\u52366\u5b57\uff09"),Utils.TI18N("\u786e\u8ba4"),function(t){if(""!=(t=t.replace("\n","")))return n.getInstance().changeRoleName(t,Math.min(1,this.roleVo.sex)),!0;message(Utils.TI18N("\u8bf7\u8f93\u5165\u89d2\u8272\u540d\u79f0"))}.bind(this),null,null,null,null,{maxLength:6,resArr:[o]})},this)},openRootWnd:function(){this.updateData()},updateData:function(){this.music_btn.isChecked="1"==gcore.SysEnv.get("music_status","1"),this.sound_btn.isChecked="1"==gcore.SysEnv.get("sound_status","1"),this.voice_btn.isChecked="1"==gcore.SysEnv.get("voice_status","1"),this.roleVo=n.getInstance().getRoleVo(),this.auto_pk_btn.isChecked=1==this.roleVo.auto_pk,this.name.string=this.roleVo.name,this.updateSpine(this.roleVo.look_id),this.updateTitle(this.roleVo.title_id),this.updateHead(this.roleVo.face_id),this.updateHeadFrame(this.roleVo.avatar_base_id)},updateSpine:function(t){this.spine.setData(a.type.role,t,PlayerAction.show,!0,.6)},updateHead:function(t){this.head.setHeadRes(t)},updateHeadFrame:function(t){this.head.setFrameRes(t)},updateTitle:function(t){var e=Config.honor_data.data_title[t];e?(this.title_label.string=e.name,this.loadRes(s.getHonorRes(e.res_id),function(t){this.title.spriteFrame=t}.bind(this))):(this.title_label.string=Utils.TI18N("\u65e0"),this.title.spriteFrame=null)},closeCallBack:function(){n.getInstance().openRoleInfoView(!1),this.role_update_evt&&this.roleVo.unbind(this.role_update_evt)}});e.exports=r,cc._RF.pop()},{baserole:"baserole",commonalert:"commonalert",login_controller:"login_controller",notice_controller:"notice_controller",pathtool:"pathtool",playerhead:"playerhead",role_controller:"role_controller"}],role_setname_window:[function(t,e,i){"use strict";cc._RF.push(e,"535acd1kqNFwLUkel8mxpXy","role_setname_window");var s=t("pathtool"),n=t("role_controller"),a=t("login_controller");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("roleinfo","role_setname_view"),this.viewTag=SCENE_TAG.dialogue,this.ctrl=n.getInstance()},initConfig:function(){this.sex_select=1,this.bind_role=!0,this.is_bind_code=null},openCallBack:function(){var t=this;t.main_panel=t.root_wnd.getChildByName("main_panel"),this.background=this.seekChild("background"),this.background.scale=FIT_SCALE,t.boy_btn=t.seekChild("boy_btn"),t.boy_btn.active=!1,t.girl_btn=t.seekChild("girl_btn"),t.girl_btn.active=!1,t.submit_btn=t.main_panel.getChildByName("btn_submit"),t.submit_btn.active=!1,t.random_btn=t.main_panel.getChildByName("btn_random"),t.random_btn.active=!1,t.input_edit=this.seekChild("input_edit"),t.input_edit.active=!1;var e=n.getInstance().getRandomName(t.sex_select);t.input_edit.getComponent(cc.EditBox).string=e,this.invite_code_edit=this.seekChild("invite_code_edit"),this.invite_code_edit.setPosition(437,377),this.invite_code_edit.active=!1;var i=237,o=!0,l=[374.5,454],r=[499.5,454],c=[353,296.5],_=[346.5,521],h=[517,522];t.boy_btn.setPosition(cc.v2(l[0],l[1])),t.girl_btn.setPosition(cc.v2(r[0],r[1])),t.submit_btn.setPosition(cc.v2(c[0],c[1])),t.input_edit.setPosition(_[0],_[1]),t.random_btn.setPosition(cc.v2(h[0],h[1])),this.bg_sk=t.seekChild("action",sp.Skeleton),this.bg_sk.setCompleteListener(function(){}.bind(this));var d=s.getSpinePath(s.getEffectRes(i),"action");a.getInstance().updateLoading(1),this.close_login_ticket=gcore.Timer.set(function(){a.getInstance().openLoginWindow(!1),gcore.Timer.del(this.close_login_ticket)}.bind(this),100,1),this.loadRes(d,function(e){this.bg_sk.skeletonData=e,this.bg_sk.setAnimation(0,"action1",!1),Utils.delayRun(this.root_wnd,1.2,function(){t.input_edit.active=!0,t.submit_btn.active=!0,t.boy_btn.active=!0,t.girl_btn.active=!0,t.random_btn.active=!0,t.invite_code_edit.active=o}.bind(this))}.bind(this))},registerEvent:function(){this.random_btn.on("click",function(){var t=1;t=this.boy_btn.getComponent(cc.Toggle).isChecked?1:2;var e=this.ctrl.getRandomName(t);this.input_edit.getComponent(cc.EditBox).string=e},this);var e=t("invitecode_event");this.addGlobalEvent(e.BindCode_Invite_Event,function(t){if(this.bind_role=!0,1==t.code){this.is_bind_code=!0;var e=this.input_edit.getComponent(cc.EditBox).string;if(""!=e){var i=e.replace("\n",""),s=1;if(s=this.boy_btn.getComponent(cc.Toggle).isChecked?1:0,this.ctrl.changeRoleName(i,s),"SH_RH"==PLATFORM_TYPR&&"shmix"==PLATFORM_NAME){var n=this.setRoleInfo(i);SDK.createRole2(n)}}else""==e&&message("\u8bf7\u8f93\u5165\u59d3\u540d~")}},this),this.submit_btn.on("click",function(){if(0!=this.bind_role)if(""==this.invite_code_edit.getComponent(cc.EditBox).string||this.is_bind_code){var e=this.input_edit.getComponent(cc.EditBox).string;if(""!=e){n=e.replace("\n","");var i=1;if(i=this.boy_btn.getComponent(cc.Toggle).isChecked?1:0,this.ctrl.changeRoleName(n,i),"SH_RH"==PLATFORM_TYPR&&"shmix"==PLATFORM_NAME){var s=this.setRoleInfo(n);SDK.createRole2(s)}}else""==e&&message("\u8bf7\u8f93\u5165\u59d3\u540d~")}else{var n;this.bind_role=!1,n=(n=this.invite_code_edit.getComponent(cc.EditBox).string).match(/\d+/g),null==this.send_code_ticket&&(this.send_code_ticket=gcore.Timer.set(function(){this.bind_role=!0,null!=this.send_code_ticket&&(gcore.Timer.del(this.send_code_ticket),this.send_code_ticket=null)}.bind(this),1e3,1)),t("invitecode_controller").getInstance().sender19801(Number(n))}else message("\u6b63\u5728\u7ed1\u5b9a\u63a8\u8350\u7801\u4e2d~~~")},this)},openRootWnd:function(t){},closeCallBack:function(){this.bg_sk.skeletonData=null},setRoleInfo:function(t){var e=a.getInstance().getModel().getLoginData();if(""!=e.srv_id){var i=n.getInstance().getRoleVo()||data,s="";i&&i.srv_id?s=i.srv_id:e.srv_id&&(s=e.srv_id);var o=s.indexOf("_");s=-1!=o?Number(s.slice(o+1,s.length)):0;var l={role_id:i.rid||0,role_name:t||"",role_level:i&&i.lev||1,server_id:s,server_name:e.srv_name,has_gold:i&&i.gold||0,vip_level:i&&i.vip_lev||0,role_power:i&&i.power||0,create_time:i&&i.reg_time||0};return cc.log(i,l),l}}});cc._RF.pop()},{invitecode_controller:"invitecode_controller",invitecode_event:"invitecode_event",login_controller:"login_controller",pathtool:"pathtool",role_controller:"role_controller"}],role_title_panel:[function(t,e,i){"use strict";cc._RF.push(e,"257d0GZm8xBo5pjitNoZjb+","role_title_panel");var s=t("pathtool"),n=t("timetool"),a=t("role_controller"),o=t("backpack_controller"),l=t("partner_calculate"),r=cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("roleinfo","role_title_panel"),this.x=0,this.y=0,this.data=null,this.has_list={},this.item_list={}},initPanel:function(){this.setPosition(0,0),this.scroll_con=this.root_wnd.getChildByName("scroll_con"),this.view=this.scroll_con.getChildByName("view"),this.content=this.view.getChildByName("content"),this.ok_btn=this.root_wnd.getChildByName("ok_btn"),this.ok_label=this.ok_btn.getChildByName("Label").getComponent(cc.Label),this.item=this.root_wnd.getChildByName("item"),this.roleVo=a.getInstance().getRoleVo(),a.getInstance().send23300()},registerEvent:function(){this.ok_btn.on(cc.Node.EventType.TOUCH_END,function(){if(this.select_item){var t=Config.honor_data.data_title[this.select_bid];if(1==this.select_item.v.status)a.getInstance().send23301(this.select_bid);else if(0==this.select_item.v.status&&t.source>0){var e=Config.source_data.data_source_data[t.source];null!=e.evt_type&&null!=e.extend&&o.getInstance().gotoItemSources(e.evt_type,e.extend)}else a.getInstance().send23303(this.select_bid)}},this);var e=t("role_event");this.addGlobalEvent(e.GetTitleList,function(t){this.updateList(t.honor)}),this.addGlobalEvent(e.UpdateTitleList,function(t){this.updateList(t.honor)}),this.addGlobalEvent(e.UseTitle,function(t){this.updateList()})},onShow:function(){},updateList:function(t){if(t)for(var e in this.has_list=this.has_list||{},t)this.has_list[t[e].base_id]=t[e];for(var e in this.list=[],Config.honor_data.data_title){var i=Config.honor_data.data_title[e];1!=i.is_show||(i.base_id==this.roleVo.title_id?this.list.push({bid:i.base_id,use:1,status:1,sort:11e5-i.base_id}):this.has_list[i.base_id]?this.list.push({bid:i.base_id,use:0,status:1,sort:1e5-i.base_id}):i.loss&&i.loss[0]?o.getInstance().getModel().getBackPackItemNumByBid(i.loss[0][0])>=i.loss[0][1]?this.list.push({bid:i.base_id,use:0,status:2,sort:2e6-i.base_id,res_id:i.res_id}):this.list.push({bid:i.base_id,use:0,status:0,sort:-i.base_id,res_id:i.res_id}):this.list.push({bid:i.base_id,use:0,status:0,sort:-i.base_id}))}this.list.sort(function(t,e){return t.sort>e.sort});var s=0,n=function(t){if(this.list&&this.item_list&&0!=this.list.length){t=t||2;for(var e=0;e<t;e++){if(0==this.list.length)return;this.createItem(s,this.list.pop()),s++}gcore.Timer.set(n,20,1,"role_title_panel_timer")}}.bind(this);n(10)},createItem:function(t,e){var i=this.item_list[e.bid];if(!i){var a=Config.honor_data.data_title[e.bid];i=cc.instantiate(this.item),this.content.addChild(i),this.item_list[e.bid]=i,i.active=!0,i.icon=i.getChildByName("icon").getComponent(cc.Sprite),i.use=i.getChildByName("use"),i.select=i.getChildByName("select"),i.active_node=i.getChildByName("active"),i.bg=i.getChildByName("bg").getComponent(cc.Sprite),i.label=i.getChildByName("label").getComponent(cc.Label),i.attr_desc=i.getChildByName("attr_desc").getComponent(cc.RichText),i.desc=i.getChildByName("desc").getComponent(cc.RichText),i.desc.string=cc.js.formatStr(Utils.TI18N("<color=#a95f0f>\u83b7\u53d6\u6761\u4ef6\uff1a%s</color>"),a.desc),i.attr_desc.string=this.attrString(a),i.on(cc.Node.EventType.TOUCH_END,function(){this.setSelected(e.bid)}.bind(this)),this.loadRes(s.getHonorRes(a.res_id),function(t){i.icon.spriteFrame=t}.bind(this))}i.v=e;var o=-(127*t+65);i.setPosition(302,o),this.content.height=65-o,i.active_node.active=2==e.status,0==t&&this.setSelected(e.bid),1==e.use?(i.use.active=!0,this.setSelected(e.bid)):i.use.active=!1,this.has_list[e.bid]?this.has_list[e.bid].expire_time>0?i.label.string=n.getTimeFormatDay(this.has_list[e.bid].expire_time-gcore.SmartSocket.getTime()):i.label.string=Utils.TI18N("\u6c38\u4e45"):i.label.string=Utils.TI18N("\u672a\u83b7\u5f97")},attrString:function(t){cc.log("title",t);var e=Utils.deepCopy(t.attr);if(t.add_exp>0&&e.push(["add_exp",t.add_exp]),0==e.length)return Utils.TI18N("<color=#693705>\u65e0\u5c5e\u6027\u52a0\u6210</color>");for(var i="",s=0,n=e.length;s<n;s++){var a=e[s];s>0&&s%2==0?i+="<br/>":s>0&&(i+="        "),"add_exp"==a[0]?i+=cc.js.formatStr(Utils.TI18N("\u6302\u673a\u7ecf\u9a8c: %d"),a[1]):1==l.isShowPerByStr(a[0])?i+=cc.js.formatStr("%s: %d%",Config.attr_data.data_key_to_name[a[0]],.1*a[1]):i+=cc.js.formatStr("%s: %d",Config.attr_data.data_key_to_name[a[0]],a[1])}return"<color=#693705>"+i+"</color>"},setSelected:function(t){if(this.select_bid!=t){if(this.select_bid=t,this.select_item){var e=s.getCommonIcomPath("common_1029");this.changeImage(this.select_item.bg,e)}if(this.select_item=this.item_list[t],this.select_item){e=s.getCommonIcomPath("common_1020");this.changeImage(this.select_item.bg,e);var i=Config.honor_data.data_title[t];1==this.select_item.v.status?this.ok_label.string=Utils.TI18N("\u66f4 \u6362"):0==this.select_item.v.status&&i.source>0?this.ok_label.string=Utils.TI18N("\u524d\u5f80\u83b7\u53d6"):this.ok_label.string=Utils.TI18N("\u6fc0 \u6d3b")}}},changeImage:function(t,e){this.loadRes(e,function(e){t.spriteFrame=e}.bind(this))},onHide:function(){},onDelete:function(){this.list=null,this.item_list=null}});e.exports=r,cc._RF.pop()},{backpack_controller:"backpack_controller",partner_calculate:"partner_calculate",pathtool:"pathtool",role_controller:"role_controller",role_event:"role_event",timetool:"timetool"}],role_vo:[function(t,e,i){"use strict";cc._RF.push(e,"ea7eb0d9mFNdY0UoO3iYk7X","role_vo");var s=t("role_event");cc.Class({extends:gcore.BaseEvent,ctor:function(){this.rid=0,this.srv_id="",this.name="",this.lev=0,this.exp=0,this.exp_max=0,this.sex=0,this.gold=0,this.coin=0,this.vip_lev=0,this.vip_exp=0,this.is_vip=0,this.face_id=0,this.avatar_base_id=0,this.face_list=[],this.title_id=0,this.title_list=[],this.reg_time=0,this.gid=0,this.gsrv_id="",this.position=0,this.gname="",this.guild_lev=0,this.guild_quit_time=0,this.friend_point=0,this.power=0,this.max_power=0,this.open_day=0,this.energy=0,this.energy_max=0,this.dic_action_assets={},this.recruithigh_hero=0,this.vip_card_exp=0},initAttributeData:function(t){for(var e in t)this.setRoleAttribute(e,t[e])},setRoleAttribute:function(t,e){if("srv_id"==t){var i="srv_id"+gcore.SysEnv.get("user_name");gcore.SysEnv.set(i,e)}this[t]!=e&&(this[t]=e,this.dispatchUpdateAttrByKey(t,e),"lev"!=t||"SH_RH"!=PLATFORM_TYPR&&"SH_SDK"!=PLATFORM_TYPR||SDK.roleUpLevel(e))},dispatchUpdateAttrByKey:function(t,e){this.fire(EventId.UPDATE_ROLE_ATTRIBUTE,t,e)},dispatchUpdateBaseAttr:function(){this.fire(EventId.ROLE_EVENT_BASE_ATTR)},isHasGuild:function(){return 0!=this.gid},initActionAssetsData:function(t,e){t=t||[];for(var i=0;i<t.length;++i){var n=t[i];this.dic_action_assets[n.id]=n.val,e&&this.fire(s.UPDATE_ROLE_ACTION_ASSETS,n.id,n.val)}},getActionAssetsNumByBid:function(t){return this.dic_action_assets&&this.dic_action_assets[t]?this.dic_action_assets[t]:0},setPower:function(t){var e=this.power;this.power=t||0,1==this.is_show_power&&e<t&&GlobalMessageMgr.getInstance().showPowerMove(t-e,null,e),this.power!=e&&this.fire(EventId.UPDATE_ROLE_ATTRIBUTE,"power",this.power),this.showPower(!1)},showPower:function(t){this.is_show_power=t},setMaxPower:function(t){var e=this.max_power;this.max_power=t||0,this.max_power!=e&&this.fire(EventId.UPDATE_ROLE_ATTRIBUTE,"max_power",this.max_power)}});cc._RF.pop()},{role_event:"role_event"}],round_item_panel:[function(t,e,i){"use strict";cc._RF.push(e,"95e3aibvCVMCbKjpQtTGBhL","round_item_panel");var s=t("pathtool");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("backpack","round_item"),arguments&&arguments.length>0&&(this.click=arguments[0],this.scale=arguments[1]||1,this.scale1=arguments[2]||1)},initConfig:function(){this.isUnEnabled=!1,this.redpointVisible=!1},initPanel:function(){1!=this.scale&&this.root_wnd.setScale(this.scale),this.main_container=this.root_wnd.getChildByName("main_container"),this.background=this.main_container.getChildByName("background"),this.round_bg=this.background.getChildByName("round_bg"),this.item_icon=this.main_container.getChildByName("icon"),this.item_icon.setScale(this.scale1),this.num_label=this.main_container.getChildByName("num").getComponent(cc.Label),this.num_label.string="",this.num_bg=this.main_container.getChildByName("num_bg"),this.num_bg_size=this.num_bg.getContentSize(),this.redpoint=this.main_container.getChildByName("redpoint"),this.redpoint.active=!1,this.round_res_id=s.getRoundQualityBg(1),this.tmepData&&this.updateData(this.tmepData),this.setItemUnEnabled(this.isUnEnabled),this.setVisibleRedPoint(this.redpointVisible)},setVisibleRedPoint:function(t){t=t||!1,this.redpointVisible=t,this.redpoint&&(this.redpoint.active=t)},setVisibleIcon:function(t){t=t||!1,this.item_icon&&(this.item_icon.active=t)},setSelfBackground:function(t){t=t||1;var e=s.getRoundQualityBg(t);this.round_res_id=e,this.loadRes(this.round_res_id,function(t){this.background.getComponent(cc.Sprite).spriteFrame=t}.bind(this))},setVisibleRoundBG:function(t){t=t||!1,this.round_bg&&(this.round_bg.active=t)},getData:function(){return this.data},addCallBack:function(t){this.callback=t},registerEvent:function(){this.root_wnd.on(cc.Node.EventType.TOUCH_START,function(t){var e=t.getTouches();this.touch_began=e[0].getDelta()},this),this.root_wnd.on(cc.Node.EventType.TOUCH_END,function(e){var i=e.getTouches();this.touch_end=i[0].getDelta();var s=!0;if(null!=this.touch_began&&(s=Math.abs(this.touch_end.x-this.touch_began.x)<=20&&Math.abs(this.touch_end.y-this.touch_began.y)<=20),1==s){if(Utils.playButtonSound(ButtonSound.Normal),this.btn_call_fun)this.btn_call_fun();else if(this.is_show_tips&&null!=this.data){var n,a=this.data.bid||this.data.base_id||this.data.id,o=0;if(this.data&&(this.data.config&&this.data.config.type?o=this.data.config.type:this.data.type&&(o=this.data.type)),t("backpack_const").checkIsEquip(o)&&!this.is_spec)t("hero_controller").getInstance().openEquipTips(!0,this.data);else if(n=this.data.config?this.data.config:Utils.getItemConfig(a),1==this.is_show_source&&n.source&&Utils.next(n.source))t("backpack_controller").getInstance().openTipsSource(!0,n);else t("tips_controller").getInstance().showGoodsTips(n);return}this.callback&&this.callback()}},this)},setDefaultTip:function(t){null==t&&(t=!0),this.is_show_tips=t},setBaseData:function(t){this.tmepData=t,this.root_wnd&&this.updateData(t)},updateData:function(t){var e=Utils.getItemConfig(t.bid);if(null!=e){this.data=e,this.item_icon.active=!0;var i=s.getItemRes(e.icon);this.loadRes(i,function(t){this.item_icon.getComponent(cc.Sprite).spriteFrame=t}.bind(this)),this.setSelfNum(t.num),this.setSelfBackground(e.quality)}},setSelfNum:function(t){t=t||0,this.num_label.node.active=t>1,this.num_bg.active=t>1,t>1&&(this.num_label.string=t,this.updateNumBGSize())},updateNumBGSize:function(){var t=this.num_label.node.getContentSize().width;t<50&&(t=50),this.num_bg.setContentSize(cc.size(t+6,this.num_bg_size.height))},setItemUnEnabled:function(t){this.isUnEnabled=t,this.background&&this.background.getComponent(cc.Sprite).setMaterial(0,t?cc.Material.getBuiltinMaterial("2d-gray-sprite"):cc.Material.getBuiltinMaterial("2d-sprite")),this.round_bg&&this.round_bg.getComponent(cc.Sprite).setMaterial(0,t?cc.Material.getBuiltinMaterial("2d-gray-sprite"):cc.Material.getBuiltinMaterial("2d-sprite")),this.item_icon&&this.item_icon.getComponent(cc.Sprite).setMaterial(0,t?cc.Material.getBuiltinMaterial("2d-gray-sprite"):cc.Material.getBuiltinMaterial("2d-sprite")),this.num_bg&&this.num_bg.getChildByName("background").getComponent(cc.Sprite).setMaterial(0,t?cc.Material.getBuiltinMaterial("2d-gray-sprite"):cc.Material.getBuiltinMaterial("2d-sprite")),this.redpoint&&this.redpoint.getComponent(cc.Sprite).setMaterial(0,t?cc.Material.getBuiltinMaterial("2d-gray-sprite"):cc.Material.getBuiltinMaterial("2d-sprite"))},onShow:function(t){},onHide:function(){},onDelete:function(){}});cc._RF.pop()},{backpack_const:"backpack_const",backpack_controller:"backpack_controller",hero_controller:"hero_controller",pathtool:"pathtool",tips_controller:"tips_controller"}],scene_const:[function(t,e,i){"use strict";var s;function n(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}cc._RF.push(e,"927d9rdoIFHA7XzKmFdP5XZ","scene_const");var a={CenterSceneBuild:{shop:1,mall:2,arena:3,startower:4,summon:5,fuse:6,guild:7,seerpalace:8,library:9,variety:10,adventure:11,ladder:12,crossshow:13,smroom:17},MainSceneWharf:{awards:1,monster:2},BuildItemType:{build:1,effect:2,npc:3},SceneId:{main_scene:1},MainSceneStatus:{none:0,main_scene:1,dungeon_scene:2,abyss_scene:3,guildwar_scene:4,expedition_scene:5,godbattle_scene:6,role_scene:7,bigworld_scene:8},AlchemyType:{coin:1,exp:2,energy:3},RedPointType:{item:1,server:2,guild_donate:3,guild_red:4,guild_member_red:5,guild_join:6,guild_war:7,guild_tech_gift:8,guild_lev_gift:9,guild_boss:10,guild_wish:11,guild_daily:12,endless:13,dungeonstone:14,primus:20,heroexpedit:21},MainSceneDataKey:(s={},n(s,"verifyios","config.verifyios_main_scene_data"),n(s,"normal","config.main_scene_data"),n(s,"special","config.special_main_scene_data"),s)};e.exports=a,cc._RF.pop()},{}],sdk_config:[function(t,e,i){"use strict";cc._RF.push(e,"f80dapV8+BJ65m7YVz1xTO6","sdk_config"),window.PACKAGE_VERSION="0_0_37",window.PLATFORM="sy",window.PLATFORM_TYPR="TBB_BOX",window.PLATFORM_NAME="tbb18",window.PAY_ID_FUNC=null,window.IS_SUBMIT=!1,window.SDK=null,"ANDROID_SDK"==PLATFORM_TYPR?(IS_SUBMIT=!0,SDK=t("sdk")):"WX_SDK"==PLATFORM_TYPR?SDK=t("wx_sdk"):"SH_RH"==PLATFORM_TYPR?SDK=t("sh_rh"):"SH_SDK"==PLATFORM_TYPR?SDK=t("sh_sdk"):"QQ_SDK"==PLATFORM_TYPR?SDK=t("qq_sdk"):(SDK={},SDK.pay=function(e,i,s,n,a,o,l){t("tips_controller").getInstance().showFirstCharge(function(){console.log("money="+e+"--buyNum="+i+"--prodId="+s+"--productName="+n+"--productDesc="+a+"--extension="+o+"--coinNum="+l)})}),cc._RF.pop()},{qq_sdk:"qq_sdk",sdk:"sdk",sh_rh:"sh_rh",sh_sdk:"sh_sdk",tips_controller:"tips_controller",wx_sdk:"wx_sdk"}],sdk_lib:[function(t,e,i){"use strict";cc._RF.push(e,"13ff0vDQuNPwL2HbjAkCZcT","sdk_lib");var s={pay:function(t,e,i,s,n){e=e||1,Log.info("pay ",t,i),gcore.SmartSocket.send(10399,{msg:"pay "+i})}};e.exports=s,cc._RF.pop()},{}],sdk:[function(t,e,i){"use strict";cc._RF.push(e,"113d5GFUD1LTKcVrX4uzUW9","sdk");var s=t("login_platform"),n=t("login_controller"),a=t("role_controller"),o=function(){this._down_apk_url_ret=null};o.initSDK=function(){cc.log("\u521d\u59cb\u5316SDK"),"ANDROID_SDK"==PLATFORM_TYPR&&window.control&&window.control.initSDK()},o.sdkInitBack=function(t){cc.log("SDK\u521d\u59cb\u5316\u7ed3\u679c"),cc.log(t),1==t?this.sdkLogin():2===t&&cc.log("SDK\u521d\u59cb\u5316\u5931\u8d25")},o.sdkLogin=function(){cc.log("\u521d\u59cb\u5316\u767b\u9646"),"ANDROID_SDK"==PLATFORM_TYPR&&window.control&&window.control.sdkLogin()},o.sdkBackLogin=function(t){if(t){cc.log("\u767b\u5f55\u6210\u529f\u56de\u8c03"),cc.log(t);var e=JSON.parse(t);cc.log(e),s.getInstance().onLoginInfo(e)}},o.sdkBackLoginTest=function(){var t={extension:null,sdkUserID:"2174939",sdkUsername:"UQ555438",suc:!0,timestamp:"1561184589",token:"24a56a77b9988712869728f22a896b92",userID:525886,uid:525886};t&&(cc.log("\u767b\u5f55\u6210\u529f\u56de\u8c03"),cc.log(t),s.getInstance().onLoginInfo(t))},o.pay=function(t,e,i,o,l,r,c){var _=n.getInstance().getModel().getLoginData(),h=a.getInstance().getRoleVo();if(h&&_){var d=n.getInstance().getModel().findServer(h.srv_id);d&&d.srv_id==h.srv_id||(d=_);var u=Config.charge_data.data_charge_data[i];if(!u||u.val==t){var m=i;o=o||10*t+"\u94bb\u77f3",l=l||o;var f=t;e=e||1;s.getInstance().getChannel(),h.gold;var p=h.srv_id.split("_"),g=p[0]||"",v=p[1],b=d.srv_name,w=h.rid,y=h.name,C=h.lev,k=(c=h.coin,"vip"+h.vip_lev),S=s.getInstance().getFinalChannel(),T={productId:m,productName:o,productDesc:l,price:f,buyNum:e,coinNum:c,serverID:v,serverName:b,roleID:w,roleName:y,roleLevel:C,vip:k,extension:h.rid+"$$"+g+"$$"+v+"$$"+S+"$$"+i+"$$"+o,host:d.host};cc.log("\u652f\u4ed8\u53c2\u6570"),cc.log(T),"ANDROID_SDK"==PLATFORM_TYPR&&window.control&&window.control.sdkPay(JSON.stringify(T))}}},o.exitAPP=function(){},o.sdkSubmitUserData=function(t,e){var i=n.getInstance().getModel().getLoginData();if(""!=i.srv_id){if(1==t){if(cli_log&&cli_log.log_select_server&&cli_log.log_select_server(login_data.usrName),!this.log_select_flag)return;this.log_select_flag=!0}else 2==t&&cli_log&&cli_log.log_create_role&&cli_log.log_create_role(login_data.usrName);LoginPlatForm.getInstance().getInfo().openid;var s,o=a.getInstance().getRoleVo()||e;o&&o.srv_id?s=o.srv_id:i.srv_id&&(s=i.srv_id);var l=s.indexOf("_"),r=s=-1!=l?Number(s.slice(l+1,s.length)):0,c=(i.srv_name,o&&o.rid,o&&o.name||""),_=o&&o.reg_time||0,h=o&&o.lev||1,d=o&&o.vip_lev||0,u=o&&o.gold||0,m=(o&&o.power,{dataType:t,gold:u,roleId:roleID,roleName:c,roleLev:h,serverId:r,vipLev:d,roleCTime:_});cc.log("\u6570\u636e\u63d0\u4ea4\u53c2\u6570"),cc.log(m),"ANDROID_SDK"==PLATFORM_TYPR&&window.control&&window.control.submitExtraData(JSON.stringify(m))}},o.sdkBackInfo=function(){},o.sdkAlert=function(){},o.testJSON=function(t){if(t){cc.log(t),cc.log("JJJJJJJJJJJJJJJJJJJJ");var e=JSON.parse(t);cc.log(e)}},o.sdkCanSwitchAccount=function(){},o.sdkOnSwitchAccount=function(){},o.sdkCanShowAccountCenter=function(){},o.sdkShowAccountCenter=function(){},o.sdkSubmitUserData=function(t,e){},o.getCurrChannel=function(){var t=null;return"ANDROID_SDK"==PLATFORM_TYPR&&window.control&&(t=window.control.getCurrChannel()),cc.log("\u83b7\u53d6\u6e20\u9053id"+t),t},o.getSubChannel=function(){var t=null;return"ANDROID_SDK"==PLATFORM_TYPR&&window.control&&(t=window.control.getSubChannel()),cc.log("\u83b7\u53d6\u5b50\u6e20\u9053id"+t),t},o.loginGame=function(){n.getInstance().sdkLogin()},o.download_qrcode_png=function(){},e.exports=o,cc._RF.pop()},{login_controller:"login_controller",login_platform:"login_platform",role_controller:"role_controller"}],seerpalace_change_panel:[function(t,e,i){"use strict";cc._RF.push(e,"8aa66VG6x9NoZYTXDQlxD8U","seerpalace_change_panel");var s=t("pathtool"),n=t("seerpalace_controller"),a=t("hero_const"),o=t("seerpalace_const"),l=t("common_scrollview"),r=t("seerpalace_event"),c=t("hero_controller"),_=t("baserole"),h=cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("seerpalace","seerpalace_change_panel"),this.ctrl=n.getInstance(),this.model=n.getInstance().getModel(),this.camp_list={},this.cur_role_vo={},this.cur_role_item=null,this.cur_camp_type=a.CampType.eNone,this.left_stars_1={},this.left_stars_2={},this.right_stars_1={},this.right_stars_2={},this.is_first_open=!0,this.change_partner_id=0,this.change_new_partner_bid=0,this.lock_partner_ids={},this.cancel_partner_id=0},initConfig:function(){},initPanel:function(){var t=this.root_wnd.getChildByName("main_container");this.change_btn=t.getChildByName("change_btn"),this.change_btn.active=!1,this.cancel_btn=t.getChildByName("cancel_btn"),this.cancel_btn.active=!1,this.save_btn=t.getChildByName("save_btn"),this.save_btn.active=!1,this.left_panel=t.getChildByName("left_panel"),this.left_panel.active=!1,this.left_lv_label=this.seekChild("left_lv_label",cc.Label),this.right_panel=t.getChildByName("right_panel"),this.right_panel.active=!1,this.right_lv_label=this.seekChild("right_lv_label",cc.Label),this.change_lb=this.seekChild("change_label",cc.Label),this.left_effect_node=t.getChildByName("left_effect_node"),this.right_effect_node=t.getChildByName("right_effect_node"),this.role_layout=t.getChildByName("role_layout"),this.toggle_nd=this.seekChild("toogle"),this.left_name_label=this.seekChild("left_name_label",cc.Label),this.right_name_label=this.seekChild("right_name_label",cc.Label),this.left_item_sp=this.seekChild("left_item",cc.Sprite),this.right_item_sp=this.seekChild("right_item",cc.Sprite),this.right_name_label_sp=this.seekChild("right_name_label",cc.Sprite);var e=this.role_layout.getContentSize();this.btn_summon_sp=this.seekChild("item",cc.Sprite);var i=cc.size(e.width-80,108),n={item_class:"hero_exhibition_item",start_x:0,space_x:15,start_y:0,space_y:0,item_width:119*.9,item_height:119*.9,row:1,col:0,scale:.9};this.role_scrollview=new l,this.role_scrollview.createScroll(this.role_layout,cc.v2(40,128),ScrollViewDir.horizontal,ScrollViewStartPos.top,i,n,cc.v2(0,0));var a=s.getIconPath("item",o.Good_XianZhi);this.loadRes(a,function(t){this.btn_summon_sp.spriteFrame=t}.bind(this))},registerEvent:function(){var t=this,e=this;this.change_btn.on("touchend",this._onClickChangeBtn,this),this.cancel_btn.on("touchend",this._onClickCancelBtn,this),this.save_btn.on("touchend",this._onClickSaveBtn,this),this.addGlobalEvent(r.Change_Role_Info_Event,function(t){e.setData(t)}.bind(this)),this.addGlobalEvent(r.Change_Role_Success,function(){e.handleRightChangeEffect(!0)}.bind(this));for(var i=function(i){var s=e.toggle_nd.getChildByName("camp_btn_"+i);s&&(e.camp_list[i]=s,s.on("touchend",function(){this._onClickCampBtn(i),Utils.playButtonSound(3)},t))},s=1;s<=4;++s)i(s);this.ctrl.requestSeerpalaceChangeInfo()},onShow:function(t){},onHide:function(){},addToParent:function(t){(t=t||!1)?this.show():this.hide()},_onClickChangeBtn:function(){Utils.playButtonSound(1);this.cur_role_vo&&this.cur_role_vo.id?this.ctrl.requestSeerpalaceChangeRole(this.cur_role_vo.id,1):message("\u8bf7\u5148\u9009\u62e9\u4e00\u4f4d\u82f1\u96c4")},_onClickCancelBtn:function(){Utils.playButtonSound(1);this.change_partner_id&&0!=this.change_partner_id&&(this.cancel_partner_id=this.change_partner_id,this.ctrl.requestSeerpalaceChangeRole(this.change_partner_id,0))},_onClickSaveBtn:function(){Utils.playButtonSound(1);this.change_partner_id&&0!=this.change_partner_id&&this.ctrl.requestSeerpalaceChangeRole(this.change_partner_id,2)},setData:function(t){this.data=t||{},this.change_partner_id=t.partner_id||0,this.change_new_partner_bid=t.new_partner_bid||0,this.lock_partner_ids=t.partner_ids||{},this.role_layout.active=0==this.change_partner_id,this.cancel_btn.active=0!=this.change_partner_id,this.save_btn.active=0!=this.change_partner_id,0==this.change_partner_id?this.cur_index?this.refreshRoleList():(this.toggle_nd.getChildByName("camp_btn_1").getComponent(cc.Toggle).isChecked=!0,this._onClickCampBtn(1)):(this.cur_index=null,this.cur_role_vo={},this.cur_camp_type=a.CampType.eNone,this.cur_role_item&&(this.cur_role_item.setSelected(!1),this.cur_role_item=null)),this.refreshRoleSpine()},refreshRoleList:function(){var t=this;t.cur_role_data=[];var e=c.getInstance().getModel().getAllHeroArray(),i=a.CampType.eNone;for(var s in t.cur_index==o.Change_Index_Camp.All?i=a.CampType.eNone:t.cur_index==o.Change_Index_Camp.Water?i=a.CampType.eWater:t.cur_index==o.Change_Index_Camp.Fire?i=a.CampType.eFire:t.cur_index==o.Change_Index_Camp.Wind&&(i=a.CampType.eWind),t.cur_camp_type=i,e||{}){var n=e[s];if(4==n.star||5==n.star){var l=t.checkIsLockedRole(n.id);if(i==a.CampType.eNone){if(n.camp_type==a.CampType.eWater||n.camp_type==a.CampType.eFire||n.camp_type==a.CampType.eWind){var r=Utils.deepCopy(n);r.is_locked=l,t.cur_role_data.push(r)}}else if(n.camp_type==i){var _=Utils.deepCopy(n);_.is_locked=l,t.cur_role_data.push(_)}}}this.cur_role_data.sort(function(e,i){var s=t.checkIsLockedRole(e.id),n=t.checkIsLockedRole(i.id);return s&&!n?1:!s&&n?-1:e.star==i.star?e.camp_type==i.camp_type?i.lev-e.lev:i.camp_type-e.camp_type:i.star-e.star}),t.cur_role_item&&t.cur_role_item.setSelected(!1);var h={scale:.85,can_click:!0,from_type:a.ExhibitionItemType.eHeroChange};t.role_scrollview.setData(t.cur_role_data,function(t){this._onClickPartner(t)}.bind(this),h),t.role_scrollview.addEndCallBack(function(){if(t.cur_role_vo&&Utils.next(t.cur_role_vo)&&null!=t.cur_camp_type){if(t.cur_role_vo.camp_type==t.cur_camp_type||t.cur_camp_type==a.CampType.eNone)for(var e=t.role_scrollview.getItemList(),i=0;i<e.length;++i){var s=e[i];if(s.getData().id==t.cur_role_vo.id){t._onClickPartner(s);break}}}else if(t.cancel_partner_id&&0!=t.cancel_partner_id){for(var n=t.role_scrollview.getItemList(),o=0;o<n.length;++o){var l=n[o];if(l.getData().id==t.cancel_partner_id){t._onClickPartner(l),t.role_scrollview.jumpToMove(cc.v2(-(o-3)*(.85*119+15),0),.01);break}}t.cancel_partner_id=0}}.bind(this))},_onClickPartner:function(t){var e=t.getData();if(!e.checkHeroLockTips(!0)){this.cur_role_item&&this.cur_role_item.setSelected(!1),t.setSelected(!0),this.cur_role_item=t,this.cur_role_vo=e;var i=e.star,s="",n=Config.recruit_high_data.data_seerpalace_const["hero_change"+i];if(n&&n.val){var a=n.val[0][0],o=n.val[0][1];Utils.getItemConfig(a)&&(s=o+" \u7f6e\u6362")}this.change_lb.string=s,this.refreshRoleSpine()}},refreshRoleSpine:function(){var t=this;if(t.cur_role_vo&&Utils.next(t.cur_role_vo)||0!=t.change_partner_id){var e={};if(0==t.change_partner_id?(e=t.cur_role_vo,t.change_btn.active=!0,t.handleRightRandomEffect(!0)):(e=c.getInstance().getModel().getHeroById(t.change_partner_id),t.change_btn.active=!1,t.handleRightRandomEffect(!1)),e&&(Utils.next(e)||0==Utils.next(e))){null==t.left_role&&(t.left_role=new _,t.left_role.setParent(t.left_panel),t.left_role.node.setPosition(cc.v2(100,180))),t.left_role.setData(_.type.partner,e,PlayerAction.show,!0,.72);var i=s.getHeroCampRes(e.camp_type),n=s.getUIIconPath("common",i);t.right_item_sp.spriteFrame=null,this.loadRes(n,function(e){t.left_item_sp.spriteFrame=e,t.right_item_sp.spriteFrame=e}.bind(this)),t.left_name_label.string=e.name,t.left_lv_label.string=e.lev,t.right_lv_label.string=e.lev;var a="????";if(0!=t.change_new_partner_bid){var l=Config.partner_data.data_partner_base[t.change_new_partner_bid],r={bid:t.change_new_partner_bid,star:e.star};null==t.right_role&&(t.right_role=new _,t.right_role.setParent(t.right_panel),t.right_role.node.setPosition(cc.v2(100,180))),t.right_role.node.active=!0,t.right_role.setData(_.type.partner,r,PlayerAction.show,!0,.72),l&&l.name&&(a=l.name)}else a="????",t.right_role&&(t.right_role.node.active=!1);for(var h in t.right_name_label.string=a,t.left_stars_1){t.left_stars_1[h].node.active=!1}for(var d in t.left_stars_2){t.left_stars_2[d].node.active=!1}for(var u in t.right_stars_1){t.right_stars_1[u].node.active=!1}for(var m in t.right_stars_2){t.right_stars_2[m].node.active=!1}t.left_star10&&(t.left_star10.node.active=!1),t.right_star10&&(t.right_star10.node.active=!1);var f=e.star,p=function(e,i,s,n){for(var a=this,l=o.Change_Pos_X[e]||{},r=0;r<e;++r){s[r]||function(){var e=Utils.createImage(n,i,0,338,cc.v2(.5,.5),!0);t.loadRes(i,function(t){e.spriteFrame=t}.bind(a)),s[r]=e}(),s[r].node.active=!0;var c=l[r];c&&(s[r].node.x=c)}};if(f>0&&f<=5){var g=s.getUIIconPath("common","common_90074");p(f,g,t.left_stars_1,t.left_panel),p(f,g,t.right_stars_1,t.right_panel)}else if(f>=6&&f<=9){var v=s.getUIIconPath("common","common_90075"),b=f-5;p(b,v,t.left_stars_2,t.left_panel),p(b,v,t.right_stars_2,t.right_panel)}else if(f>=10){var w=s.getUIIconPath("common","common_90073");t.left_star10?t.left_star10.node.active=!0:(t.left_star10=Utils.createImage(t.left_panel,w,100,338,cc.v2(.5,.5),!0,0,!1),t.left_star10.setScale(1.2)),t.right_star10?t.right_star10.node.active=!0:(t.right_star10=Utils.createImage(t.right_panel,w,100,338,cc.v2(.5,.5),!0,0,!1),t.right_star10.setScale(1.2))}}t.left_panel.active=!0,t.right_panel.active=!0,t.handleLeftEmptyEffect(!1)}else t.left_panel.active=!1,t.right_panel.active=!1,t.change_btn.active=!1,t.handleLeftEmptyEffect(!0),t.handleRightRandomEffect(!1)},_onClickCampBtn:function(t){if(this.cur_index!=t){if(this.cur_index){var e=this.camp_list[this.cur_index];e&&e.select_image&&(e.select_image.active=!1)}var i=this.camp_list[t];i&&i.select_image&&(i.select_image.active=!0),this.cur_index=t,this.refreshRoleList()}},checkIsLockedRole:function(t){var e=!1;for(var i in this.lock_partner_ids){var s=this.lock_partner_ids[i];if(s.id&&s.id==t){e=!0;break}}return e},handleLeftEmptyEffect:function(t){var e=this;if(0==t)e.left_empty_effect&&(e.left_empty_effect.skeletonData=null,this.left_empty_effect.setToSetupPose(),this.left_empty_effect.clearTracks(),e.left_empty_effect=null);else if(this.left_effect_node&&!this.left_empty_effect){var i=s.getSpinePath("E24001","action");this.loadRes(i,function(t){this.left_empty_effect=e.left_effect_node.getChildByName("action").getComponent(sp.Skeleton),this.left_empty_effect.skeletonData=t,this.left_empty_effect.setAnimation(0,"action",!0)}.bind(this))}},handleRightRandomEffect:function(t){var e=this;if(0==t)e.right_random_effect&&(this.right_random_effect.setToSetupPose(),this.right_random_effect.clearTracks(),this.right_random_effect.skeletonData=null,e.right_random_effect=null);else if(e.right_effect_node&&!e.right_random_effect){var i=s.getSpinePath("E24002","action");this.loadRes(i,function(t){this.right_random_effect=e.right_effect_node.getChildByName("action").getComponent(sp.Skeleton),this.right_random_effect.skeletonData=t,this.right_random_effect.setAnimation(0,"action",!0)}.bind(this))}},handleRightChangeEffect:function(t){var e=this;if(0==t)e.right_change_effect&&(e.right_change_effect.skeletonData=null,this.right_change_effect.setToSetupPose(),this.right_change_effect.clearTracks(),e.right_change_effect=null);else if(e.right_effect_node&&!e.right_change_effect){var i=s.getSpinePath("E24003","action");this.loadRes(i,function(t){e.right_change_effect=e.right_effect_node.getChildByName("action1").getComponent(sp.Skeleton),e.right_change_effect.skeletonData=t,e.right_change_effect.setAnimation(0,"action",!1)}.bind(this))}else e.right_change_effect&&e.right_change_effect.setAnimation(0,"action",!1)},onDelete:function(){this.role_change_info_event&&(gcore.GlobalEvent.unbind(this.role_change_info_event),this.role_change_info_event=null),this.change_success_event&&(gcore.GlobalEvent.unbind(this.change_success_event),this.change_success_event=null),this.left_role&&(this.left_role.deleteMe(),this.left_role=null),this.right_role&&(this.right_role.deleteMe(),this.right_role=null),this.handleRightRandomEffect(!1),this.handleLeftEmptyEffect(!1),this.handleRightChangeEffect(!1)}});e.exports=h,cc._RF.pop()},{baserole:"baserole",common_scrollview:"common_scrollview",hero_const:"hero_const",hero_controller:"hero_controller",pathtool:"pathtool",seerpalace_const:"seerpalace_const",seerpalace_controller:"seerpalace_controller",seerpalace_event:"seerpalace_event"}],seerpalace_const:[function(t,e,i){"use strict";var s,n,a,o;function l(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}cc._RF.push(e,"5095acAPQ5PU7vjT6UnzD4Z","seerpalace_const");var r={Tab_Index:{Summon:1,Change:2},Change_Index_Camp:{All:1,Water:2,Fire:3,Wind:4},Change_Pos_X:(s={},l(s,1,[100]),l(s,2,[85,115]),l(s,3,[70,100,130]),l(s,4,[55,85,115,145]),l(s,5,[40,70,100,130,160]),s),Index_To_GroupId:(n={},l(n,1,3e3),l(n,2,1e3),l(n,3,2e3),l(n,4,4e3),n),Book_EffectId:(a={},l(a,1e3,634),l(a,2e3,635),l(a,3e3,633),l(a,4e3,636),a),Effect_Pos:(o={},l(o,1e3,cc.v2(90,240)),l(o,2e3,cc.v2(-87,240)),l(o,3e3,cc.v2(268,240)),l(o,4e3,cc.v2(-269,240)),o),Good_ZhiHui:14001,Good_XianZhi:14002,Good_JieJing:24};e.exports=r,cc._RF.pop()},{}],seerpalace_controller:[function(t,e,i){"use strict";cc._RF.push(e,"023a6O3lvpK5pDojYgNSZSj","seerpalace_controller");var s=t("seerpalace_event"),n=cc.Class({extends:BaseController,ctor:function(){},initConfig:function(){var e=t("seerpalace_model");this.model=new e,this.model.initConfig()},getModel:function(){return this.model},registerEvents:function(){var t=this;null==t.init_role_event&&(t.init_role_event=gcore.GlobalEvent.bind(EventId.EVT_ROLE_CREATE_SUCCESS,function(){gcore.GlobalEvent.unbind(t.init_role_event),t.init_role_event=null}))},registerProtocals:function(){this.RegisterProtocal(23213,this.handle23213.bind(this)),this.RegisterProtocal(23214,this.handle23214.bind(this)),this.RegisterProtocal(23215,this.handle23215.bind(this))},openSeerpalaceMainWindow:function(e,i){if(e){if(!this.checkSeerpalaceIsOpen())return;var s=t("seerpalace_main_window");this.seerpalace_window||(this.seerpalace_window=new s),this.seerpalace_window.open()}else this.seerpalace_window&&this.seerpalace_window.close(),this.seerpalace_window=null},openShop:function(e,i){if(e){var s=t("seerpalace_shop_window");this.shopWindow||(this.shopWindow=new s),this.shopWindow.open()}else this.shopWindow&&this.shopWindow.close(),this.shopWindow=null},handle23213:function(e){if(e){this.model.setLastSummonGroupId(e.group_id);var i=[];for(var s in e.rewards)i[s]={},i[s].bid=e.rewards[s].base_id,i[s].num=e.rewards[s].num;var n=t("mainui_const");t("mainui_controller").getInstance().openGetItemView(!0,i,0,{is_backpack:!0},n.item_open_type.seerpalace)}},handle23214:function(t){this.model.setChangePartnerId(t.partner_id),gcore.GlobalEvent.fire(s.Change_Role_Info_Event,t)},handle23215:function(t){message(t.msg),1==t.code&&this.model.getChangeFlag()&&(gcore.GlobalEvent.fire(s.Change_Role_Success),this.model.setChangeFlag(!1))},openSeerpalacePreviewWindow:function(e,i){if(1==e){if(!this.seerpalace_preview){var s=t("seerpalace_preview_window");this.seerpalace_preview=new s}0==this.seerpalace_preview.isOpen()&&this.seerpalace_preview.open(i)}else this.seerpalace_preview&&(this.seerpalace_preview.close(),this.seerpalace_preview=null)},requestSeerpalaceSummon:function(t){var e={};e.group_id=t,this.SendProtocal(23213,e)},requestSeerpalaceChangeInfo:function(){this.SendProtocal(23214,{})},requestSeerpalaceChangeRole:function(t,e){var i={};i.partner_id=t,i.action=e,e&&1==e&&this.model.setChangeFlag(!0),this.SendProtocal(23215,i)},getSeerpalaceMainRoot:function(){if(this.seerpalace_window)return this.seerpalace_window.root_wnd},checkSeerpalaceIsOpen:function(e){var i=!1,s=t("role_controller").getInstance().getRoleVo(),n=Config.recruit_high_data.data_seerpalace_const.common_limit;return n&&s.lev>=n.val?i=!0:(i=!1,e||message(cc.js.formatStr(Utils.TI18N("%d\u7ea7\u5f00\u542f\u5148\u77e5\u5723\u6bbf"),n.val))),i}});e.exports=n,cc._RF.pop()},{mainui_const:"mainui_const",mainui_controller:"mainui_controller",role_controller:"role_controller",seerpalace_event:"seerpalace_event",seerpalace_main_window:"seerpalace_main_window",seerpalace_model:"seerpalace_model",seerpalace_preview_window:"seerpalace_preview_window",seerpalace_shop_window:"seerpalace_shop_window"}],seerpalace_event:[function(t,e,i){"use strict";cc._RF.push(e,"783baFXJZVFqIRUdDOcOZCU","seerpalace_event"),e.exports={Change_Role_Info_Event:"Change_Role_Info_Event",Change_Role_Success:"Change_Role_Success"},cc._RF.pop()},{}],seerpalace_main_window:[function(t,e,i){"use strict";cc._RF.push(e,"3a100yiVPNLXZTMjhSBJeQn","seerpalace_main_window");var s=t("pathtool"),n=t("backpack_controller"),a=t("seerpalace_const"),o=t("seerpalace_controller"),l=t("backpack_const"),r=t("backpack_event"),c=t("role_controller"),_=(t("role_event"),cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("seerpalace","seerpalace_main_window"),this.viewTag=SCENE_TAG.ui,this.win_type=WinType.Full,this.ctrl=o.getInstance(),this.cur_index=null},initConfig:function(){this.label_list={},this.role_vo=c.getInstance().getRoleVo(),this.panel_list={}},openCallBack:function(){this.container=this.seekChild("container"),this.score_bg1_nd=this.seekChild("score_bg_1"),this.score_bg2_nd=this.seekChild("score_bg_2"),this.score_bg3_nd=this.seekChild("score_bg_3"),this.shopBtn_nd=this.seekChild("btn_shop"),this.close_btn=this.seekChild("close_btn"),this.background_sp=this.root_wnd.getChildByName("background").getComponent(cc.Sprite),this.background_sp.node.scale=this.background_sp.node.scale*FIT_SCALE,this.btnToggle_tg=[this.seekChild("tab_btn_1",cc.Toggle),this.seekChild("tab_btn_2",cc.Toggle)],this.tip_nd=this.seekChild("explain_btn"),this.tips_lb=this.seekChild("tips_label",cc.Label)},registerEvent:function(){var t=this;t.addGlobalEvent(r.ADD_GOODS,function(e,i){t.refreshGoodNums(e,i)},this),t.addGlobalEvent(r.DELETE_GOODS,function(e,i){t.refreshGoodNums(e,i)},this),t.addGlobalEvent(r.MODIFY_GOODS_NUM,function(e,i){t.refreshGoodNums(e,i)}),t.role_vo&&(t.role_assets_event||(t.role_assets_event=t.role_vo.bind(EventId.UPDATE_ROLE_ATTRIBUTE,function(e,i){"recruithigh_hero"==e&&t.label_list[3]&&(t.label_list[3].string=i)})))},openRootWnd:function(t){this.tips_lb.string="\u968f\u673a\u53ec\u55244~5\u661f\u82f1\u96c4\u6216\u5176\u82f1\u96c4\u788e\u7247",this.updagePropConst(),this.onClickEvent();var e=s.getIconPath("item",a.Good_ZhiHui);this.loadRes(e,function(t){this.score_bg1_nd.getChildByName("score_image").getComponent(cc.Sprite).spriteFrame=t}.bind(this));var i=s.getIconPath("item",a.Good_XianZhi);this.loadRes(i,function(t){this.score_bg2_nd.getChildByName("score_image").getComponent(cc.Sprite).spriteFrame=t}.bind(this));var n=s.getIconPath("item",a.Good_JieJing);this.loadRes(n,function(t){this.score_bg3_nd.getChildByName("score_image").getComponent(cc.Sprite).spriteFrame=t}.bind(this));var o=a.Tab_Index.Summon;this.changeSelectedTab(o)},closeCallBack:function(){for(var t in this.panel_list)this.panel_list[t].deleteMe();this.panel_list=null,this.role_vo&&this.role_assets_event&&(this.role_vo.unbind(this.role_assets_event),this.role_assets_event=null,this.role_vo=null),this.ctrl.openSeerpalaceMainWindow(!1)},updagePropConst:function(){var t=n.getInstance().getModel().getBackPackItemNumByBid(a.Good_ZhiHui),e=n.getInstance().getModel().getBackPackItemNumByBid(a.Good_XianZhi),i=this.role_vo.recruithigh_hero;this.score_bg1_nd.getChildByName("score_label").getComponent("cc.Label").string=t,this.score_bg2_nd.getChildByName("score_label").getComponent("cc.Label").string=e,this.score_bg3_nd.getChildByName("score_label").getComponent("cc.Label").string=i,this.label_list[1]=this.score_bg1_nd.getChildByName("score_label").getComponent("cc.Label"),this.label_list[2]=this.score_bg2_nd.getChildByName("score_label").getComponent("cc.Label"),this.label_list[3]=this.score_bg3_nd.getChildByName("score_label").getComponent("cc.Label")},onClickEvent:function(){var e=this;this.tip_nd.on("touchend",function(e){var i;Utils.playButtonSound(3);var s=e.touch.getLocation();i=this.btnToggle_tg[0].isChecked?Config.recruit_high_data.data_seerpalace_const.game_rule1:Config.recruit_high_data.data_seerpalace_const.game_rule2,t("tips_controller").getInstance().showCommonTips(i.desc,s)},this),this.shopBtn_nd.on("touchend",function(t){Utils.playButtonSound(1),this.ctrl.openShop(!0)},this),this.close_btn.on("touchend",function(){Utils.playButtonSound(2),this.ctrl.openSeerpalaceMainWindow(!1)},this);for(var i=function(t){e.btnToggle_tg[t].node.on("touchend",function(e){Utils.playButtonSound(1),this.changeSelectedTab(t+1)},e)},s=0;s<this.btnToggle_tg.length;++s)i(s)},changeSelectedTab:function(e){if(e!=this.cur_index){var i;if(this.cur_index=e,e==a.Tab_Index.Summon?(this.tips_lb.node.active=!0,i="bigbg_66"):e==a.Tab_Index.Change&&(this.tips_lb.node.active=!1,i="bigbg_67"),this.select_panel&&(this.select_panel.addToParent(!1),this.select_panel=null),this.select_panel=this.panel_list[e],!this.select_panel){if(e==a.Tab_Index.Summon){var n=t("seerpalace_summon_panel");this.select_panel=new n}else if(e==a.Tab_Index.Change){var o=t("seerpalace_change_panel");this.select_panel=new o}this.select_panel&&(this.select_panel.setParent(this.container),this.panel_list[e]=this.select_panel,this.select_panel.setPosition(.5*-SCREEN_WIDTH,.5*-SCREEN_HEIGHT),this.select_panel.addToParent(!0))}this.select_panel&&this.select_panel.addToParent(!0),this.loadRes(s.getBigBg(i),function(t){this.background_sp.spriteFrame=t}.bind(this))}},refreshGoodNums:function(t,e){if(t==l.Bag_Code.BACKPACK)for(var i in e){var s=e[i];if(s&&s.base_id)if(s.base_id==a.Good_ZhiHui&&this.label_list[2]){var o=n.getInstance().getModel().getBackPackItemNumByBid(a.Good_ZhiHui);this.label_list[1].string=o}else if(s.base_id==a.Good_XianZhi&&this.label_list[3]){var r=n.getInstance().getModel().getBackPackItemNumByBid(a.Good_XianZhi);this.label_list[2].string=r}}}}));e.exports=_,cc._RF.pop()},{backpack_const:"backpack_const",backpack_controller:"backpack_controller",backpack_event:"backpack_event",pathtool:"pathtool",role_controller:"role_controller",role_event:"role_event",seerpalace_change_panel:"seerpalace_change_panel",seerpalace_const:"seerpalace_const",seerpalace_controller:"seerpalace_controller",seerpalace_summon_panel:"seerpalace_summon_panel",tips_controller:"tips_controller"}],seerpalace_model:[function(t,e,i){"use strict";cc._RF.push(e,"1e41fZqZZpEPporPJPvRIXY","seerpalace_model");var s=cc.Class({extends:BaseClass,ctor:function(){},properties:{},initConfig:function(){this.change_flag=!1,this.change_partner_id=0,this.change_info=null},setChangePartnerId:function(t){this.change_partner_id=t||0},setChangeFlag:function(t){this.change_flag=t},getChangeFlag:function(){return this.change_flag},setLastSummonGroupId:function(t){this.last_summon_group_id=t},getLastSummonGroupId:function(){return this.last_summon_group_id}});e.exports=s,cc._RF.pop()},{}],seerpalace_preview_window:[function(t,e,i){"use strict";cc._RF.push(e,"ecb27MwWT5Ibpl9bd08hiPn","seerpalace_preview_window");var s=t("pathtool"),n=t("seerpalace_const"),a=t("seerpalace_controller");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("seerpalace","seerpalace_preview_window"),this.viewTag=SCENE_TAG.ui,this.win_type=WinType.Full,this.is_full_screen=!1,this.ctrl=a.getInstance()},initConfig:function(){},openCallBack:function(){this.background=this.root_wnd.getChildByName("background"),this.background;var t=this.root_wnd.getChildByName("container");this.container=t;t.getChildByName("win_title");this.list_panel=t.getChildByName("list_panel"),this.viewContent=this.seekChild("content")},registerEvent:function(){this.background.on("touchend",this._onClickBtnClose,this)},openRootWnd:function(t){this.group_id=n.Index_To_GroupId[t],this.group_id&&this.setData()},closeCallBack:function(){this.list_panel.stopAllActions();for(var t=0;t<this.backpackItem.length;++t)this.backpackItem[t]&&(this.backpackItem[t].deleteMe(),this.backpackItem[t]=null);this.ctrl.openSeerpalacePreviewWindow(!1)},setData:function(){var t=this,e=this,i=Config.recruit_high_data.data_seerpalace_award[e.group_id];i&&function(){t.backpackItem=[];var s=i[5],n=i[4],a=0;for(var o in i){var l=i[o];l.desc&&""!=l.desc&&(a+=40);var r=l.items.length,c=Math.ceil(r/4);a=a+119*.9*c+20*(c-1)+10}var _=284-a;e.viewContent.height=a,e.viewContent.y=_;var h=a;Utils.createLabel(22,new cc.Color(234,181,80,255),null,22,a-20,s.desc,e.viewContent,null,cc.v2(0,.5));for(var d=function(t){var i=s.items[t];Utils.delayRun(e.list_panel,t/60,function(){var s=i[0],n=i[1],a=ItemsPool.getInstance().getItem("backpack_item");a.show(),a.setParent(e.viewContent),a.setScale(.9),a.setData({bid:s,num:n});var o=t+1,l=o%4;0==l&&(l=4);var r=Math.ceil(o/4),c=22+(l-1)*(119*.9+35)+54,_=h-40-(r-1)*(119*.9+20)-54;a.setPosition(c,_),e.backpackItem.push(a)})},u=0;u<s.items.length;++u)d(u);var m=h-40-Math.ceil(s.items.length/4)*(119*.9+20)+20-10;Utils.createLabel(22,new cc.Color(234,181,80,255),null,22,m-20,n.desc,e.viewContent,null,cc.v2(0,.5));for(var f=function(t){var i=n.items[t];Utils.delayRun(e.list_panel,t/60,function(){var s=i[0],n=i[1],a=ItemsPool.getInstance().getItem("backpack_item");a.show(),a.setParent(e.viewContent),a.setScale(.9),a.setData({bid:s,num:n});var o=t+1,l=o%4;0==l&&(l=4);var r=Math.ceil(o/4),c=22+(l-1)*(119*.9+35)+54,_=m-40-(r-1)*(119*.9+20)-54;a.setPosition(c,_),e.backpackItem.push(a)})},p=0;p<n.items.length;++p)f(p)}()},_onClickBtnClose:function(){Utils.playButtonSound(2),this.ctrl.openSeerpalacePreviewWindow(!1)}});cc._RF.pop()},{pathtool:"pathtool",seerpalace_const:"seerpalace_const",seerpalace_controller:"seerpalace_controller"}],seerpalace_shop_window:[function(t,e,i){"use strict";cc._RF.push(e,"51c39RrYg1Km6tlXUD8eUhM","seerpalace_shop_window");var s=t("pathtool"),n=t("backpack_controller"),a=t("seerpalace_const"),o=t("common_scrollview"),l=t("mall_item"),r=t("mall_controller"),c=t("mall_const"),_=t("mall_event"),h=t("seerpalace_controller"),d=t("hero_const"),u=t("role_controller"),m=(t("role_event"),cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("seerpalace","seerpalace_shop_window"),this.viewTag=SCENE_TAG.ui,this.win_type=WinType.Big,this.cur_index=1,this.ctrl=h.getInstance(),this.role_vo=u.getInstance().getRoleVo()},initConfig:function(){this.cur_camp_type=d.CampType.eNone},openCallBack:function(){this.res_lb=this.seekChild("res_label",cc.Label),this.close_nd=this.seekChild("close_btn"),this.background_nd=this.seekChild("background"),this.background_nd.scale=FIT_SCALE,this.res_lb.string=n.getInstance().getModel().getBackPackItemNumByBid(a.Good_JieJing),this.list_panel=this.seekChild("list_panel"),this.camp_list_nd=this.seekChild("btn").children;var t={item_class:l,start_x:2,space_x:2,start_y:8,space_y:2,item_width:306,item_height:143,row:0,col:2,need_dynamic:!0};this.item_scrollview=new o;var e=cc.size(this.list_panel.width,this.list_panel.height);this.item_scrollview.createScroll(this.list_panel,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,e,t,cc.v2(.5,0));var i=this.seekChild("res_icon",cc.Sprite),r=Utils.getItemConfig(a.Good_JieJing);this.loadRes(s.getItemRes(r.icon),function(t){i.spriteFrame=t}),this.res_lb.string=this.role_vo.recruithigh_hero},registerEvent:function(){for(var t=this,e=function(e){t.camp_list_nd[e].on("touchend",function(t){this._onClickCampBtn(e+1),Utils.playButtonSound(3)},t)},i=0;i<this.camp_list_nd.length;++i)e(i);this.background_nd.on("touchend",function(){Utils.playButtonSound(2),this.ctrl.openShop(!1)},this),this.close_nd.on("touchend",function(){Utils.playButtonSound(2),this.ctrl.openShop(!1)},this),this.update_have_count||(this.update_have_count=this.addGlobalEvent(_.Open_View_Event,function(t){this.srv_data=t||{};var e=this.getConfig();this.item_scrollview.setData(e,function(t){r.getInstance().openMallBuyWindow(!0,t)})}.bind(this))),this.role_vo&&null==this.role_assets_event&&(this.role_assets_event=this.role_vo.bind(EventId.UPDATE_ROLE_ATTRIBUTE,function(t,e){"recruithigh_hero"==t&&(this.res_lb.string=e)}.bind(this)))},openRootWnd:function(t){r.getInstance().sender13401(c.MallType.Seerpalace)},closeCallBack:function(){this.item_scrollview&&(this.item_scrollview.DeleteMe(),this.item_scrollview=null),this.role_vo&&this.role_assets_event&&(this.role_vo.unbind(this.role_assets_event),this.role_assets_event=null),this.ctrl.openShop(!1)},getConfig:function(){var t=[],e=Config.exchange_data.data_shop_exchage_seer;if(e&&this.srv_data){var i=JSON.parse(JSON.stringify(this.srv_data.item_list));for(var s in e){var n=e[s],a=Utils.getItemConfig(n.item_bid);if(a&&(this.cur_camp_type==d.CampType.eNone||a.lev==this.cur_camp_type)){if(i&&null!=Utils.next(i||{}))for(var o=0;o<i.length;++o){var l=i[o];if(n.id==l.item_id){l.ext[1].val&&(n.has_buy=l.ext[1].val,i.splice(o,1));break}n.has_buy=0}else n.has_buy=0;t.push(n)}}}return t.sort(function(t,e){return!(t.limit_count&&t.limit_count>0&&t.has_buy>=t.limit_count&&(!e.limit_count||0==e.limit_count||e.has_buy<e.limit_count))&&(!!(e.limit_count&&e.limit_count>0&&e.has_buy>=e.limit_count&&(!t.limit_count||0==t.limit_count||t.has_buy<t.limit_count))||t.order<e.order)}),t},_onClickCampBtn:function(t){if(this.cur_index!=t){switch(this.cur_index=t,t){case 1:this.cur_camp_type=d.CampType.eNone;break;case 2:this.cur_camp_type=d.CampType.eWater;break;case 3:this.cur_camp_type=d.CampType.eFire;break;case 4:this.cur_camp_type=d.CampType.eWind;break;case 5:this.cur_camp_type=d.CampType.eLight;break;case 6:this.cur_camp_type=d.CampType.eDark}var e=this.getConfig();this.item_scrollview.setData(e,function(t){r.getInstance().openMallBuyWindow(!0,t)})}}}));e.exports=m,cc._RF.pop()},{backpack_controller:"backpack_controller",common_scrollview:"common_scrollview",hero_const:"hero_const",mall_const:"mall_const",mall_controller:"mall_controller",mall_event:"mall_event",mall_item:"mall_item",pathtool:"pathtool",role_controller:"role_controller",role_event:"role_event",seerpalace_const:"seerpalace_const",seerpalace_controller:"seerpalace_controller"}],seerpalace_summon_Item:[function(t,e,i){"use strict";cc._RF.push(e,"84f120IHJdNBpd7CuG+jLbI","seerpalace_summon_Item");var s=t("seerpalace_controller"),n=t("seerpalace_const"),a=cc.Class({extends:BasePanel,ctor:function(){this.ctrl=s.getInstance(),this.prefabPath=PathTool.getPrefabPath("seerpalace","seerpalace_summon_item"),this._is_select=!1;var t=arguments[0];this._clickCallBack=t.parent,this.index=t.index},initConfig:function(){},initPanel:function(){this.effect_node=this.seekChild("effect_node"),this.summon_layer=this.seekChild("summon_layer"),this.check_layer=this.seekChild("check_layer"),this.index&&this.setIndex()},setIndex:function(){var t=this.index,e=n.Index_To_GroupId[t],i=Config.recruit_high_data.data_seerpalace_data[e];if(i&&i.item_once){this.summon_cost=i.item_once,this.group_id=e;var s=n.Book_EffectId[e],a=n.Effect_Pos[e];s&&a&&0!=s&&this.handleCardEffect(!0,s,a)}this.summon_layer.name="guide_card_"+t},getSummonCostItem:function(){return this.summon_cost},getSummonGroupId:function(){return this.group_id},handleCardEffect:function(t,e,i){if(0==t)this.card_effect&&(this.card_effect.skeletonData=null,this.card_effect.clearTracks(),this.card_effect.removeFromParent(),this.card_effect=null);else if(this.effect_node&&!this.card_effect){var s=new cc.Node;s.setAnchorPoint(.5,.5),s.addComponent(sp.Skeleton),this.effect_node.addChild(s),this.card_effect=s.getComponent(sp.Skeleton);var n=PathTool.getSpinePath(Config.effect_data.data_effect_info[e],"action");this.loadRes(n,function(t){this.card_effect.skeletonData=t,this.card_effect.setAnimation(0,"action1",!0)}.bind(this)),this.effect_node.setPosition(i.x,i.y)}},registerEvent:function(){this.check_layer.on("touchend",this._onClickCheckLayer,this),this.summon_layer.on("touchend",this._onClickSummonLayer,this)},_onClickCheckLayer:function(){Utils.playButtonSound(1);this.index&&this.ctrl.openSeerpalacePreviewWindow(!0,this.index)},_onClickSummonLayer:function(){Utils.playButtonSound(1);0==this._is_select&&this._clickCallBack&&this._clickCallBack._onClickSummonCard(this)},setSelectStatus:function(t){1==t?(this.check_layer.y=-70,this.card_effect.setAnimation(0,"action2",!0),this.card_effect.setToSetupPose()):(this.check_layer.y=-100,this.card_effect.setAnimation(0,"action1",!0),this.card_effect.setToSetupPose()),this._is_select=t}});e.exports=a,cc._RF.pop()},{seerpalace_const:"seerpalace_const",seerpalace_controller:"seerpalace_controller"}],seerpalace_summon_panel:[function(t,e,i){"use strict";cc._RF.push(e,"914bc0au5JForoMCyNYI0tk","seerpalace_summon_panel");var s=t("pathtool"),n=t("seerpalace_summon_Item"),a=t("seerpalace_controller"),o=t("backpack_controller"),l=t("seerpalace_const"),r=cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("seerpalace","seerpalace_summon_panel"),this.is_playing=!1,this.summon_list={},this.summon_pos={},this.ctrl=a.getInstance()},initConfig:function(){},initPanel:function(){var t=this,e=this;this.npc_sk=this.seekChild("npcAni",sp.Skeleton),this.ball_effect_sk=this.seekChild("pos_ball").getChildByName("action").getComponent(sp.Skeleton),this.handleNPCEffect(!0),this.handleBallEffect(!0);for(var i=function(i){var s=t.seekChild("main_container").getChildByName("image_stage").getChildByName("pos_node_"+i);s&&(Utils.delayRun(s,3*i/60,function(){var t=e.summon_list[i];t||((t=new n({parent:e,index:i})).setParent(s),t.show(),e.summon_list[i]=t)}),e.summon_pos[i]=s)},a=1;a<5;++a)i(a);e.btn_summon_nd=this.seekChild("btn_summon"),e.btn_summon_lb=this.seekChild("btn_summon_label",cc.Label),e.btn_summon_sp=this.seekChild("icon",cc.Sprite);var o=s.getIconPath("item",l.Good_ZhiHui);this.loadRes(o,function(t){this.btn_summon_sp.spriteFrame=t}.bind(this)),this.btn_summon_sp.node.active=!1;var r=this.seekChild("desk",cc.Sprite);this.loadRes(s.getBigBg("bigbg_77"),function(t){r.spriteFrame=t})},registerEvent:function(){this.btn_summon_nd.on("touchend",this._onClickSummonBtn,this),this.ball_effect_sk.setCompleteListener(function(){0!=this.is_playing&&(this._onSummonAniCallBack(),this.handleBallEffect())}.bind(this)),this.npc_sk.setCompleteListener(function(){1!=this.npc_ani_status&&this._onNPCAniCallBack()}.bind(this))},addToParent:function(t){(t=t||!1)?this.show():this.hide()},onShow:function(t){},onHide:function(){},onDelete:function(){this.ball_effect_sk.skeletonData=null,this.npc_sk.skeletonData=null},handleNPCEffect:function(t){this.npc_ani_status=1;var e=s.getSpinePath("E24110","action");this.loadRes(e,function(t){this.npc_sk.skeletonData=t,this.npc_sk.setAnimation(0,"action1",!0)}.bind(this))},handleBallEffect:function(){var t=s.getSpinePath("E24111","action");this.loadRes(t,function(t){this.ball_effect_sk.skeletonData=t,this.ball_effect_sk.setAnimation(0,"action",!0)}.bind(this))},handleSummonEffect:function(){if(this.ball_effect_sk){var t=s.getSpinePath("E24112","action");this.loadRes(t,function(t){this.ball_effect_sk.skeletonData=t,this.ball_effect_sk.setAnimation(0,"action",!1)}.bind(this))}},_onSummonAniCallBack:function(){var t=this.select_card.getSummonGroupId();this.ctrl.requestSeerpalaceSummon(t),this.is_playing=!1},_onNPCAniCallBack:function(){this.npc_sk&&2==this.npc_ani_status&&(this.npc_sk.setAnimation(0,"action1",!0),this.npc_ani_status=1)},_onClickSummonCard:function(t){this.is_playing||(this.select_card&&this.select_card.setSelectStatus(!1),t&&(this.select_card=t,this.select_card.setSelectStatus(!0)),this.updateSummonBtnLabel(),this.btn_summon_sp.node.active=!0)},updateSummonBtnLabel:function(){if(this.select_card){var t=this.select_card.getSummonCostItem();if(t){var e=t[0][0],i=t[0][1];Utils.getItemConfig(e)&&(this.loadRes(s.getItemRes(e),function(t){this.btn_summon_lb.spriteFrame=t}.bind(this)),this.btn_summon_lb.string=i+" \u53ec\u5524")}}},_onClickSummonBtn:function(){Utils.playButtonSound(1);if(!this.is_playing)if(this.select_card){var t=this.select_card.getSummonCostItem();if(t){var e=t[0][0],i=t[0][1];if(o.getInstance().getModel().getItemNumByBid(e)>=i&&this.npc_sk)this.npc_ani_status=2,this.is_playing=!0,this.npc_sk.setAnimation(0,"action2",!1),this.handleSummonEffect();else{var s=this.select_card.getSummonGroupId();this.ctrl.requestSeerpalaceSummon(s)}}}else message("\u8bf7\u5148\u9009\u62e9\u4e00\u79cd\u5361\u724c")}});e.exports=r,cc._RF.pop()},{backpack_controller:"backpack_controller",pathtool:"pathtool",seerpalace_const:"seerpalace_const",seerpalace_controller:"seerpalace_controller",seerpalace_summon_Item:"seerpalace_summon_Item"}],server_list_item_panel:[function(t,e,i){"use strict";cc._RF.push(e,"59c31EbI0lEDq/g6zEVF8oW","server_list_item_panel");var s=t("pathtool"),n=t("login_controller");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("login","server_cell"),this.ctrl=n.getInstance(),this.model=this.ctrl.getModel()},initConfig:function(){},initPanel:function(){this.server_id_lb=this.seekChild("server_id",cc.Label),this.server_name_lb=this.seekChild("server_name",cc.Label),this.select_bg_nd=this.seekChild("select_bg"),this.recomed_nd=this.seekChild("state_icon"),this.icon_state_sp=this.seekChild("icon_state",cc.Sprite),this.role_info_nd=this.seekChild("role_info"),this.addHeight=!1,this.data&&this.updateView()},registerEvent:function(){this.root_wnd.on("touchend",function(){if(this.data.is_close||gcore.SmartSocket.getTime()-this.data.open_time<0)return this.model.checkReloadServerData(this.data),void(this.data.is_close&&message(Utils.TI18N("\u505c\u670d\u7ef4\u62a4\u4e2d")));this.serverListWindow.onClickEffect(this.itemID,this.data)},this)},onShow:function(t){},onHide:function(){},setData:function(t,e,i){this.tmplID=t,this.itemID=e,i&&(this.serverListWindow=i),this.data=this.serverListWindow.getItemData(e),this.data?(this.show(),this.root_wnd&&this.updateView()):this.hide()},updateItem:function(t){if(this.data&&(this.itemID=t,this.data=this.serverListWindow.getItemData(t),this.data&&this.updateView(),this.serverListWindow.cur_index==this.itemID?this.select_bg_nd.active=!0:this.select_bg_nd.active=!1,null!=this.serverListWindow.scroll_view&&(this.serverListWindow.cur_index||0==this.serverListWindow.cur_index))){var e=this.getPositionY();t<=this.serverListWindow.cur_index?1==this.addHeight&&(this.setPosition(0,e+this.serverListWindow.scroll_view.height),this.addHeight=!1):0==this.addHeight?(this.setPosition(0,e-this.serverListWindow.scroll_view.height),this.addHeight=!0):(this.setPosition(0,e+this.serverListWindow.scroll_view.height),this.addHeight=!1)}},updateView:function(){var t;this.server_name_lb.string=this.data.srv_name,this.server_id_lb.string=this.data.group_num+"\u670d",this.recomed_nd.active=!0,this.data.is_close?t=s.getUIIconPath("login2","login2_1002"):this.data.is_new?t=s.getUIIconPath("login2","login2_1000"):(this.recomed_nd.active=!1,t=s.getUIIconPath("login2","login2_1001")),this.loadRes(t,function(t){this.icon_state_sp.spriteFrame=t}.bind(this)),this.data.roles&&this.data.roles.length?(this.role_info_nd.active=!0,this.role_info_nd.getChildByName("role_sum").getComponent(cc.Label).string=this.data.roles.length):this.role_info_nd.active=!1},getItemID:function(){return this.itemID},updateRoleData:function(t){t&&(this.roles=t,this.rolesNum=t.length,this.roles.sort(function(t,e){return e.lev-t.lev}))},onDelete:function(){}});cc._RF.pop()},{login_controller:"login_controller",pathtool:"pathtool"}],server_list_window:[function(t,e,i){"use strict";cc._RF.push(e,"65739IQHkBPPKJInG6XD3Y9","server_list_window");var s=t("pathtool"),n=t("server_list_item_panel"),a=t("login_controller"),o=t("login_event");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("login","server_panel_view"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Full,this.ctrl=a.getInstance()},initConfig:function(){this.spacing=0,this.spawnCount=10,this.itemTemplate=86,this.items=[],this.cur_index=null},openCallBack:function(){this.scrollView=this.seekChild("server_scroll_view",cc.ScrollView),this.serverListView=this.seekChild("serverListView",cc.ScrollView),this.close_btn_nd=this.seekChild("close_btn"),this.viewHeight=this.scrollView.node.height,this.content=this.scrollView.content,this.bufferZone=390},registerEvent:function(){this.scrollView.node.on("scrolling",this.checkRectIntersectsRect,this),this.close_btn_nd.on("touchend",function(){this.ctrl.openServerList(!1)},this),this.addGlobalEvent(o.LOGIN_EVENT_PLAYER_INFO,function(t){this.setRolesInfo(t.roles)}.bind(this))},checkRectIntersectsRect:function(t){if(!(t.getScrollOffset().y<0)&&!(Math.abs(this.scrollView.content.y-this.lastContentPosY)<20)){for(var e=this.items,i=this.bufferZone,s=this.scrollView.content.y<this.lastContentPosY,n=(this.itemTemplate+this.spacing)*e.length,a=0;a<e.length;++a)if(e[a].data){var o=this.getPositionInView(e[a]),l=0;if(this.scroll_view&&(l=this.scroll_view.height),s){if(o.y<-i&&e[a].getPositionY()+n+l<0){e[a].setPosition(0,e[a].getPositionY()+n);var r=e[a],c=r.itemID-e.length;r.updateItem(c)}}else if(o.y>i&&e[a].getPositionY()-n-l>-this.content.height){var _=e[a].getPositionY()-n;e[a].setPosition(0,_);var h=e[a],d=h.itemID+e.length;h.updateItem(d)}}this.lastContentPosY=this.scrollView.content.y}},openRootWnd:function(t){var e=this;t=Utils.deepCopy(t),this.server_list={};for(var i=0;i<t.length;++i)this.server_list[t[i].group_id]||(this.server_list[t[i].group_id]=[]),this.server_list[t[i].group_id].push(t[i]);for(var n in this.server_list)this.server_list[n].sort(function(t,e){return e.group_num-t.group_num});var a=s.getPrefabPath("login","server_list_item"),o=0,l=function(t){var i=o;e.loadRes(a,function(e){var s=e;this.serverListView.content.addChild(s),s.getChildByName("list_desc").getComponent(cc.Label).string=this.ctrl.getModel().getSrvGroupNameByGroupId(t),s.on("toggle",function(e){this.cur_zone=t,this.initialize()},this),s.x=0,s.y=-s.height/2-i*s.height,0==i&&0==s.getComponent(cc.Toggle).isChecked&&s.getComponent(cc.Toggle).check(),this.serverListView.content.height=i*s.height}.bind(e)),o++};for(var r in this.server_list)l(r)},initialize:function(){this.scrollView.stopAutoScroll(),this.data=this.server_list[this.cur_zone],this.cur_index=null;for(var t=0;t<this.items.length;++t)this.items[t].deleteMe(),this.items[t]=null;this.scroll_view&&(this.scroll_view.destroy(),this.scroll_view=null),this.items=[],this.lastContentPosY=0,this.content.y=this.viewHeight/2,this.content.height=this.data.length*(this.itemTemplate+this.spacing)+this.spacing;for(var e=0;e<this.spawnCount;++e){var i=new n;i.setParent(this.content),i.setPosition(0,-this.itemTemplate*(.5+e)-this.spacing*(e+1)),i.setData(e,e,this),this.items.push(i)}},getPositionInView:function(t){var e=t.root_wnd.parent.convertToWorldSpaceAR(cc.v2(t.getPositionX(),t.getPositionY()));return this.scrollView.node.convertToNodeSpaceAR(e)},getItemData:function(t){if(this.data[t])return this.data[t]},onClickEffect:function(t,e){if(this.cur_index!=t){if(this.scroll_view){this.content.height-=this.scroll_view.height;for(var i=0;i<this.items.length;++i){var s=this.items[i].getItemID();this.items[i].updateItem(s)}this.scroll_view.destroy(),this.scroll_view=null}this.cur_index=t,this.ctrl.getModel().setCurServer(e),this.ctrl.getModel().setIsSocket(!0),this.ctrl.connectServer(this.data.host,this.data.port,this.data.ws)}},addCallBack:function(t){this.callBack=t},setRolesInfo:function(t){this.createView(t);for(var e=0;e<this.items.length;++e){var i=this.items[e].getItemID();this.items[e].updateItem(i)}var s=-(this.cur_index+1)*this.itemTemplate+-this.scroll_view.height/2;this.scroll_view.setPosition(0,s)},createView:function(t){var e,i=new cc.Node;this.scroll_view=i,this.content.addChild(i),e=t.length>1?190:95,i.setContentSize(400,e),this.content.height+=e;var n=s.getPrefabPath("common","common_scroll_view");this.loadRes(n,function(n){var a=this,o=n;o.setAnchorPoint(.5,.5),o.setContentSize(i.getContentSize());var l=o.getChildByName("ScrollView"),r=l.getChildByName("view"),c=r.getChildByName("content");l.setAnchorPoint(.5,.5),l.setPosition(0,0),r.setAnchorPoint(.5,.5),r.setPosition(0,0),l.setContentSize(o.getContentSize()),r.setContentSize(o.getContentSize()),c.width=400,c.height=95*t.length,c.setAnchorPoint(.5,1),c.setPosition(0,e/2),l.getComponent(cc.ScrollView).vertical=!0;var _=s.getPrefabPath("login","role_login_cell");if(t.length)for(var h=function(e){a.loadRes(_,function(i){var s=i;c.addChild(s),s.y=-(47.5+95*e),s.x=0,this.setCellText(s,t[e])}.bind(a))},d=0;d<t.length;++d)h(d);else this.loadRes(_,function(e){var i=e;c.addChild(i),i.y=-(47.5+95*t.length),i.x=0,this.setCellText(i)}.bind(this));i.addChild(o),o.setPosition(0,0)}.bind(this))},setCellText:function(t,e){var i,n=t.getChildByName("background").getChildByName("add").getChildByName("mask").getChildByName("icon").getComponent(cc.Sprite),a=t.getChildByName("background").getChildByName("add").getChildByName("lv").getComponent(cc.Label),o=t.getChildByName("background").getChildByName("add").getChildByName("name").getComponent(cc.Label);e?(i=s.getHeadRes(e.face_id),n.node.scale=.6,a.string="Lv."+e.lev,o.string=e.name,t.on("touchend",function(){this.ctrl.reqLoginRole(e.rid,e.srv_id)},this)):(i=s.getUIIconPath("common","common_90026"),n.node.scale=1,a.string="",o.string="",t.runAction(cc.sequence(cc.delayTime(1),cc.callFunc(function(){this.ctrl.reqCreateRole()},this)))),this.loadRes(i,function(t){n.spriteFrame=t}.bind(this))},closeCallBack:function(){for(var t=0;t<this.items.length;++t)this.items[t].deleteMe(),this.items[t]=null;this.items=null,this.callBack&&this.callBack(),this.ctrl.openServerList(!1)}});cc._RF.pop()},{login_controller:"login_controller",login_event:"login_event",pathtool:"pathtool",server_list_item_panel:"server_list_item_panel"}],sh_client:[function(t,e,i){"use strict";function s(t){"@babel/helpers - typeof";return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}cc._RF.push(e,"68918wpw1tNnJxbu/PsrKLL","sh_client");var n=function(){};n.prototype={logincallback:!1,paycallback:!1,subscallback:!1,shareSdkCallback:!1,shareResultCallback:!1,realnameCallback:!1,bindphoneCallback:!1,login:function(t){this.logincallback=t;var e=new Object;e.func="MSG_LOGIN",console.log("shsdk login url:"+location.href,e),window.parent.postMessage(JSON.stringify(e),"*")},createRole:function(t){var e=new Object;e.params=t,e.func="MSG_CREATE_ROLE",window.parent.postMessage(JSON.stringify(e),"*")},enterGame:function(t){var e=new Object;e.params=t,e.func="MSG_ENTER_GAME",window.parent.postMessage(JSON.stringify(e),"*")},roleUpLevel:function(t){var e=new Object;e.params=t,e.func="MSG_ROLE_UP_LEVEL",window.parent.postMessage(JSON.stringify(e),"*")},pay:function(t,e){this.paycallback=e;var i=new Object;i.func="MSG_PAY",i.params=t,window.parent.postMessage(JSON.stringify(i),"*")},subscribe:function(t,e){this.subscallback=e;var i=new Object;i.func="MSG_SUBSCRIBE",i.params=t,window.parent.postMessage(JSON.stringify(i),"*")},setShareCallback:function(t){this.shareResultCallback=t},shareSdk:function(t,e){this.shareSdkCallback=e;var i=new Object;i.func="MSG_SHARE_SDK",i.params=t,window.parent.postMessage(JSON.stringify(i),"*")},realname:function(t,e){this.realnameCallback=e;var i=new Object;i.func="MSG_REAL_NAME",i.params=t,window.parent.postMessage(JSON.stringify(i),"*")},bindphone:function(t,e){this.bindphoneCallback=e;var i=new Object;i.func="MSG_BIND_PHONE",i.params=t,window.parent.postMessage(JSON.stringify(i),"*")},logout:function(){var t=new Object;t.func="MSG_LOGOUT",window.parent.postMessage(JSON.stringify(t),"*")},dataPlacement:function(t){var e=new Object;e.func="MSG_DATAPLACEMENT",e.params=t,window.parent.postMessage(JSON.stringify(e),"*")},message:function(t){switch(t.func){case"NOTIFY_LOGIN":this.logincallback&&this.logincallback(t.params);break;case"NOTIFY_PAY":this.paycallback&&this.paycallback(t.params);break;case"NOTIFY_SUBSCRIBE":this.subscallback&&this.subscallback(t.params);break;case"NOTIFY_SHARE_SDK":this.shareSdkCallback&&this.shareSdkCallback(t.params);break;case"NOTIFY_SHARE_RESULT":this.shareResultCallback&&this.shareResultCallback(t.params);break;case"NOTIFY_REAL_NAME":this.realnameCallback&&this.realnameCallback(t.params);break;case"NOTIFY_BIND_PHONE":this.bindphoneCallback&&this.bindphoneCallback(t.params)}}};var a=new n;window.addEventListener("message",function(t){try{var e=t.data,i=JSON.parse(e)}catch(t){return void console.log(t)}null!=i&&"object"==s(i)&&i.hasOwnProperty("func")&&a.message(i)}),cc._RF.pop()},{}],sh_rh:[function(t,e,i){"use strict";var s,n;function a(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}cc._RF.push(e,"bb8cdDrxjFMc6VG/GonQwMt","sh_rh"),window.PACKAGE_NAME="\u95ea\u70c1\u4e4b\u5149\u53e3\u888b\u7248",window.SH_RH_PID="0",window.SH_RH_IS_SUBSCRIBE=!1,window.SH_RH_IS_SHARE=!1,window.SH_RH_IS_REALNAME=!1,window.SH_RH_IS_WALLOW=!0,window.SH_RH_IS_SHOW_SUBSCRIBE=!1,window.SH_RH_IS_SHOW_SHARE=!1,window.SH_RH_IS_SHOW_REALNAME=!1,window.SH_RH_IS_SHOW_BINDPHONE=!1;var o=t("login_controller"),l=t("role_controller"),r=t("welfare_controller"),c=function(){this.uid=null};c.initSDK=function(){cli_log.log_activate_device(),cli_log.log_flash(),this.login()},c.login=function(){console.log("PACKAGE_VERSION=====>",PACKAGE_VERSION),console.log("\u8c03\u7528\u6df1\u6d77\u878d\u5408SDK\u767b\u5f55"),window.ShSdk&&(console.log(ShSdk),cli_log&&cli_log.log_loading_end&&cli_log.log_loading_end(),ShSdk&&ShSdk.login(function(t){console.log("\u6df1\u6d77\u878d\u5408SDK\u767b\u5f55\u7ed3\u679c"),window.SH_RH_TOKENID=t.tokenid;for(var e=window.location.href.split("?"),i={},s=0;s<e.length;s++)for(var n=e[s].split("&"),a=0;a<n.length;a++){var l=n[a].split("=");i[l[0]]=l[1]}window.SH_RH_PID=i.pid,window.CHANNEL=window.SH_RH_PID,"PM001318"==window.CHANNEL?window.PLATFORM_NAME="shmix":window.PLATFORM_NAME="sh",null!=i.focus&&(window.SH_RH_IS_SUBSCRIBE=1==Number(i.focus)),null!=i.verify&&(window.SH_RH_IS_REALNAME=1==Number(i.verify)),i[!0]&&(window.SH_RH_IS_WALLOW=1==Number(i.wallow)),this.postFunc(function(t){this.uid=t.msg.uid,this.sign=t.msg.sign;var e={};e.usrName="shrh_"+this.uid,e.password="wx123456",cli_log&&cli_log.log_reg_account&&cli_log.log_reg_account(e.usrName),o.getInstance().loginPlatformRequest(e)}.bind(this)),this.subscribe({apiType:"enabled"}),this.share({apiType:"enabled"}),"shmix"==PLATFORM_NAME&&(this.bindphone({apiType:"enabled"}),this.realname({apiType:"enabled"}))}.bind(this)))},c.postFunc=function(t){var e=cc.loader.getXMLHttpRequest(),i="https://s1-h5mlf-h5sszg.shiyuegame.com/api.php/pf/diai/login/";i=(i=i+"?tokenid="+SH_RH_TOKENID)+"&cps="+SH_RH_PID,e.open("POST",i),e.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),e.send(),e.onreadystatechange=function(){if(4==e.readyState&&e.status>=200&&e.status<=207){var i=JSON.parse(e.responseText);if(-1==i.error)return void message(i.msg);t(i)}}},c.sdkBackLogin=function(){},c.getCurrChannel=function(){return window.CHANNEL},c.getSubChannel=function(){},c.getSign=function(){return this.sign||""},c.getUid=function(){return this.uid||""},c.loginGame=function(){var t,e="shrh_"+this.uid,i=this.sign;t=[{key:"channel",val:SH_RH_PID},{key:"package_name",val:PACKAGE_NAME},{key:"package_version",val:PACKAGE_VERSION},{key:"platform",val:PLATFORM},{key:"account",val:e},{key:"token",val:SH_RH_TOKENID},{key:"sign",val:i}],o.getInstance().cusSDKLogin_2(t)},c.pay=function(e,i,s,n,a,r,c){var _=function(){var i=o.getInstance().getModel().getLoginData();if(""!=i.srv_id){var a=l.getInstance().getRoleVo();if(null!=a){var r="";a&&a.srv_id?r=a.srv_id:i.srv_id&&(r=i.srv_id);var c=r.indexOf("_");r=-1!=c?Number(r.slice(c+1,r.length)):0;var _=this.chargeData[Number(e)];"shmix"==PLATFORM_NAME&&(_=this.chargeData2[Number(e)]),n=_;var h=Math.ceil(Date.now()/1e3),d=SH_RH_PID;d=(d=d+"_"+this.uid)+"_"+h;var u=a.srv_id.split("_"),m=u[0]||"",f=u[1],p=SH_RH_PID,g=SH_RH_PID,v=a.rid+"$$"+m+"$$"+f+"$$"+g+"$$"+s+"$$"+n+"$$"+p+"$$"+h;v=t("base64").Base64.encode(v);var b={game_no:d,order_money:100*e,order_name:n,role_name:a.name,role_id:a.rid,role_level:a.lev,server_id:r,server_name:i.srv_name,ext:v};ShSdk.pay(b,function(t){var e="";e="SUCCESS"==t.ret?"\u5145\u503c\u5b8c\u6210":"\u5173\u95ed\u5145\u503c",message("\u5145\u503c\u8fd4\u56de\uff1a"+e)}.bind(this))}}}.bind(this);t("tips_controller").getInstance().showFirstCharge(_)},c.setRoleInfo=function(t){var e=o.getInstance().getModel().getLoginData();if(""!=e.srv_id){var i=l.getInstance().getRoleVo()||t,s="";i&&i.srv_id?s=i.srv_id:e.srv_id&&(s=e.srv_id);var n=s.indexOf("_");s=-1!=n?Number(s.slice(n+1,s.length)):0;var a=i.rid;"sh"==PLATFORM_NAME&&(a=this.uid),this.role_info={role_id:a||0,role_name:i&&i.name||"",role_level:i&&i.lev||1,server_id:s,server_name:e.srv_name,has_gold:i&&i.gold||0,vip_level:i&&i.vip_lev||0,role_power:i&&i.power||0,create_time:i&&i.reg_time||0}}},c.createRole=function(t){this.setRoleInfo(t),ShSdk.createRole(this.role_info)},c.createRole2=function(t){console.log("\u521b\u89d2\u63d0\u4ea4\u4e8c\u6b21\u4e0a\u62a5----\x3e",t),ShSdk.createRole(t)},c.submitLogin=function(){if(this.setRoleInfo(),console.log("\u89d2\u8272\u767b\u5f55\u63d0\u4ea4\u4e00\u6b21--role_info==>",this.role_info),"SH_RH"==PLATFORM_TYPR)try{ShSdk.enterGame(this.role_info),console.log("\u767b\u5f55\u4e0a\u62a5\u65b9\u6cd5\u6210\u529f-----")}catch(t){ShSdk.neterGame(this.role_info),console.log("\u767b\u5f55\u4e0a\u62a5\u65b9\u6cd5\u6210\u529f------")}},c.roleUpLevel=function(t){this.setRoleInfo(),this.role_info&&0==this.role_info.reg_time||null!=t&&t>1&&(this.role_info.role_level=t,ShSdk.roleUpLevel(this.role_info))},c.subscribe=function(t){var e=t;try{ShSdk.subscribe(e,function(t){console.log("\u5173\u6ce8\u56de\u8c03\uff1a",e,t),"enabled"==e.apiType?0==Number(t.cpStatus)?(window.SH_RH_IS_SHOW_SUBSCRIBE=!1,console.log("\u5173\u6ce8\u56de\u8c03\uff1a\u4e0d\u5141\u8bb8")):(window.SH_RH_IS_SHOW_SUBSCRIBE=!0,console.log("\u5173\u6ce8\u56de\u8c03\uff1a\u5141\u8bb8"),this.subscribe({apiType:"isSubscribe"})):"isSubscribe"==e.apiType?0==Number(t.cpStatus)?window.SH_RH_IS_SUBSCRIBE=!1:window.SH_RH_IS_SUBSCRIBE=!0:"askShow"==e.apiType&&t.cpStatus,e={apiType:"null"}}.bind(this))}catch(t){console.log("subscribe_err:",t)}},c.share=function(t){try{ShSdk.shareSdk(t,function(e){console.log("\u5206\u4eab\u56de\u8c03params",t,e),"enabled"==t.apiType&&(0==Number(e.cpStatus)?(window.SH_RH_IS_SHOW_SHARE=!1,console.log("\u5206\u4eab\u56de\u8c03\uff1a\u4e0d\u5141\u8bb8")):(window.SH_RH_IS_SHOW_SHARE=!0,console.log("\u5206\u4eab\u56de\u8c03\uff1a\u5141\u8bb8"))),e.cpStatus,t={apiType:"null"}}.bind(this))}catch(t){console.log("shareSdk_err:",t)}null==this.share_callback&&(this.shareCallback(),this.share_callback=!0)},c.shareCallback=function(){try{ShSdk.setShareCallback(function(t){"success"==t.msg?(window.SH_RH_IS_SHARE=!0,r.getInstance().shrhShareStatus(),"timeline"==t.type?message("\u5206\u4eab\u670b\u53cb\u5708\u6210\u529f!"):message("\u5206\u4eab\u597d\u53cb\u6210\u529f!")):message("\u5206\u4eab\u5931\u8d25\uff01")})}catch(t){console.log("shareCallback_err:",t)}},c.realname=function(t){ShSdk.realname(t,function(e){console.log("\u5b9e\u540ddata",t,e),"SUCCESS"==e.ret?("enabled"==t.apiType?(window.SH_RH_IS_SHOW_REALNAME=!0,console.log("\u9700\u8981\u5b9e\u540d\u3002\u3002\u3002")):(window.SH_RH_IS_REALNAME=!0,console.log("\u5b9e\u540d\u6210\u529f==>",e)),r.getInstance().shrhRealNameStatus(!0)):"enabled"==t.apiType&&(window.SH_RH_IS_REALNAME=!0,window.SH_RH_IS_SHOW_REALNAME=!1,console.log("\u4e0d\u9700\u8981\u5b9e\u540d\u3002\u3002\u3002")),t={apiType:"null"}})},c.bindphone=function(t){console.log("\u624b\u673a\u7ed1\u5b9a\u56de\u8c03\uff1a",t),ShSdk.bindphone(t,function(e){console.log("\u624b\u673a\u7ed1\u5b9a\u56de\u8c03\uff1a",t,e),"SUCCESS"==e.ret?"enabled"==t.apiType?(window.SH_RH_IS_SHOW_BINDPHONE=!0,console.log("\u624b\u673a\u7ed1\u5b9a\u56de\u8c03\uff1a\u5141\u8bb8")):"askShow"==t.apiType&&r.getInstance().send16698():"enabled"==t.apiType?(window.SH_RH_IS_SHOW_BINDPHONE=!1,console.log("\u624b\u673a\u7ed1\u5b9a\u56de\u8c03\uff1a\u4e0d\u5141\u8bb8")):t.apiType,t={apiType:"null"}})},c.logout=function(){ShSdk.logout()},c.chatMonitor=function(t){},c.sdkSubmitUserData=function(t,e){},c.chargeData=(a(s={},6,"\u666e\u901a\u5145\u503c6\u5143"),a(s,30,"\u666e\u901a\u5145\u503c30\u5143"),a(s,68,"\u666e\u901a\u5145\u503c68\u5143"),a(s,98,"\u666e\u901a\u5145\u503c98\u5143"),a(s,128,"\u666e\u901a\u5145\u503c128\u5143"),a(s,198,"\u666e\u901a\u5145\u503c198\u5143"),a(s,328,"\u666e\u901a\u5145\u503c328\u5143"),a(s,648,"\u666e\u901a\u5145\u503c648\u5143"),a(s,18,"\u7b49\u7ea7\u793c\u5305"),a(s,1,"1\u5143\u793c\u5305"),a(s,3,"3\u5143\u793c\u5305"),a(s,12,"v2\u793c\u5305"),a(s,448,"\u6bcf\u5468\u5e38\u9a7b\u793c\u5305"),a(s,50,"\u4e2d\u6863\u7ea2\u5305"),s),c.chargeData2=(a(n={},6,"60\u94bb\u77f3"),a(n,30,"300\u94bb\u77f3"),a(n,68,"680\u94bb\u77f3"),a(n,98,"980\u94bb\u77f3"),a(n,128,"1280\u94bb\u77f3"),a(n,198,"1980\u94bb\u77f3"),a(n,328,"3280\u94bb\u77f3"),a(n,648,"6480\u94bb\u77f3"),a(n,18,"\u7b49\u7ea7\u793c\u5305"),a(n,1,"1\u5143\u793c\u5305"),a(n,3,"3\u5143\u793c\u5305"),a(n,12,"v2\u793c\u5305"),a(n,448,"\u6bcf\u5468\u5e38\u9a7b\u793c\u5305"),a(n,50,"\u4e2d\u6863\u7ea2\u5305"),n),e.exports=c,cc._RF.pop()},{base64:"base64",login_controller:"login_controller",role_controller:"role_controller",tips_controller:"tips_controller",welfare_controller:"welfare_controller"}],sh_sdk:[function(t,e,i){"use strict";cc._RF.push(e,"027ebFO+T1Dk5fPGU9ZJlNI","sh_sdk"),window.PACKAGE_NAME="\u95ea\u70c1\u4e4b\u5149\u53e3\u888b\u7248",window.SH_SDK_PID="0",window.SH_SDK_AND_PID="P0006089",window.SH_SDK_IOS_PID="P0006090",window.SH_SDK_FOLLOW=!0;var s=t("shsdk"),n=t("role_controller"),a=t("login_controller"),o=t("welfare_event"),l=function(){};l.uid=null,l.sign=null,l.role_info=null,l.initSDK=function(){if(console.log("\u6df1\u6d77SDK\u76f8\u5173"),console.log(window),window.wx){this.initTopInfo();var t=wx.getSystemInfoSync().system;window.PLATFORM="sy",window.PLATFORM_NAME="sy",t.indexOf("iOS")>-1?SH_SDK_PID=SH_SDK_IOS_PID:t.indexOf("Android")>-1&&(SH_SDK_PID=SH_SDK_AND_PID),CHANNEL=SH_SDK_PID,s.init({package_code:SH_SDK_PID}),this.dataPlacement(1e4),this.dataPlacement(2e4),s.share(function(){console.log("ShSdk.share success callback")}),wx.setKeepScreenOn({keepScreenOn:!0}),wx.onShow(function(t){t&&gcore.GlobalEvent.fire(o.Update_SHWX_show_scene_val,t.scene),wx.setKeepScreenOn({keepScreenOn:!0})}),wx.onHide(function(t){wx.setKeepScreenOn({keepScreenOn:!1})}),wx.getSetting({success:function(t){if(cc.log(t),t.authSetting["scope.userInfo"])l.login();else{var e=wx.getSystemInfoSync(),i=wx.createUserInfoButton({type:"text",text:"",style:{left:0,bottom:0,width:e.screenWidth,height:e.screenHeight/2,lineHeight:40,backgroundColor:"",color:"#ffffff",textAlign:"center",fontSize:16,borderRadius:4}});i.show(),i.onTap(function(t){i.hide(),s.unionId(t),l.login(),console.log(t)})}}})}},l.login=function(){this.dataPlacement(3e4),s.login(function(t){this.dataPlacement(30001),window.SH_SDK_TOKENID=t.tokenid,l.postFunc(function(t){console.log(t),l.uid=t.msg.uid,l.sign=t.msg.sign;var e={};e.usrName="sh_"+l.uid,e.password="wx123456",console.log("\u6df1\u6d77\u5c0f\u6e38\u620f\u521d\u59cb\u5316\u6210\u529f\uff0c\u5f00\u59cb\u8bf7\u6c42\u670d\u52a1\u5668\u5217\u8868"),a.getInstance().loginPlatformRequest(e)}.bind(this))})},l.postFunc=function(t){var e=cc.loader.getXMLHttpRequest(),i="https://s1-h5mlf-h5sszg.shiyuegame.com/api.php/pf/diai/login/";i=(i=i+"?tokenid="+SH_SDK_TOKENID)+"&cps="+SH_SDK_PID,e.open("POST",i),e.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),e.send(),e.onreadystatechange=function(){if(4==e.readyState&&e.status>=200&&e.status<=207){var i=JSON.parse(e.responseText);if(cc.log("result==>",i),-1==i.error)return void message(i.msg);l.dataPlacement(4e4),t(i)}}},l.initTopInfo=function(){var t=wx.getMenuButtonBoundingClientRect(),e=wx.getSystemInfoSync();t.top>30?window.WX_FIT=t.top/e.screenHeight*.7||0:window.WX_FIT=t.top/e.screenHeight*.1||0,console.log("\u5fae\u4fe1\u5c0f\u6e38\u620f\u83dc\u5355\u680f\u7684\u9002\u914d\u503c"),cc.log(WX_FIT)},l.loginGame=function(){var t,e="sh_"+l.uid,i=l.sign;console.log("_account==>",e),t=[{key:"channel",val:SH_SDK_PID},{key:"package_name",val:PACKAGE_NAME},{key:"package_version",val:PACKAGE_VERSION},{key:"platform",val:PLATFORM},{key:"account",val:e},{key:"token",val:SH_SDK_TOKENID},{key:"sign",val:i}],console.log("login_data==>",t),a.getInstance().cusSDKLogin_2(t)},l.pay=function(e,i,o,r,c,_,h){var d=function(){var i=n.getInstance().getRoleVo();if(i){var c=Math.ceil(Date.now()/1e3),_=SH_SDK_PID;_=(_=_+"_"+l.uid)+"_"+c,cc.log("\u5145\u503c\u8ba2\u5355\u53f7game_number==>",_),r=r||10*e+"\u94bb\u77f3";var h=a.getInstance().getModel().getLoginData(),d="";i&&i.srv_id?d=i.srv_id:h.srv_id&&(d=h.srv_id);var u=d.indexOf("_");d=-1!=u?Number(d.slice(u+1,d.length)):0;var m=i.srv_id.split("_"),f=m[0]||"",p=m[1],g=SH_SDK_PID,v=SH_SDK_PID,b=i.rid+"$$"+f+"$$"+p+"$$"+v+"$$"+o+"$$"+r+"$$"+g+"$$"+c;cc.log("\u62d3\u5c55\u53c2\u6570_extension==>",b),b=t("base64").Base64.encode(b),cc.log("base64\u62d3\u5c55\u53c2\u6570_extension==>",b);var w={game_no:_,order_money:100*e,order_name:r,role_id:i.rid,role_name:i.name,role_level:i.lev,server_id:d,server_name:h.srv_name,ext:b};console.log("\u5145\u503c\u6570\u636e",w),s.pay(w,function(t){"SUCCESS"==t.ret?(console.log("\u652f\u4ed8\u5b8c\u6210"),wx.showModal({title:"\u652f\u4ed8\u6210\u529f",content:"\u652f\u4ed8\u6210\u529f"})):"YD_TIPS"==t.ret?wx.showModal({title:"\u6e29\u99a8\u63d0\u793a",content:t.msg}):"NOT_ALLOW"==t.ret?wx.showModal({title:"\u652f\u4ed8\u5931\u8d25",content:"\u6682\u4e0d\u652f\u6301\u652f\u4ed8"}):console.log("\u652f\u4ed8\u53d6\u6d88\u6216\u5931\u8d25")}.bind(this))}}.bind(this);t("tips_controller").getInstance().showFirstCharge(d)},l.goShare=function(t){t?s.goShare(t):s.goShare()},l.subscribe=function(){s.subscribe(function(t){console.log("\u516c\u4f17\u53f7\u5173\u6ce8\u72b6\u6001\u83b7\u53d6\u7ed3\u679c",t)})},l.dataPlacement=function(t){s.dataPlacement({action:t})},l.openCustomerServiceConversation=function(){window.wx&&wx.openCustomerServiceConversation()},l.setRoleInfo=function(t){var e=a.getInstance().getModel().getLoginData();if(""!=e.srv_id){var i,s=n.getInstance().getRoleVo()||t;s&&s.srv_id?i=s.srv_id:e.srv_id&&(i=e.srv_id);var o=i.indexOf("_");i=-1!=o?Number(i.slice(o+1,i.length)):0,this.role_info={role_id:s&&s.rid||0,role_name:s&&s.name||"",role_level:s&&s.lev||1,server_id:i,server_name:e.srv_name,has_gold:s&&s.gold||0,vip_level:s&&s.vip_lev||0,role_power:s&&s.power||0,create_time:s&&s.reg_time||0}}},l.submitLogin=function(){gcore.SysEnv.get("shsdk_account")!=this.uid&&(gcore.SysEnv.set("shsdk_account",this.uid),this.setRoleInfo(),console.log("\u89d2\u8272\u767b\u5f55\u63d0\u4ea4\u4e00\u6b21--role_info==>",this.role_info),"SH_SDK"==PLATFORM_TYPR&&(s.enterGame(this.role_info,function(t){console.log("\u89d2\u8272\u4e0a\u62a5\uff0c\u8fd4\u56de\u652f\u4ed8\u60c5\u51b5",t),null!=t.data.msg.sp&&(window.IS_SHOW_CHARGE=t.data.msg.sp),null!=t.data.msg.follow&&(window.SH_SDK_FOLLOW=t.data.msg.follow)}),cc.log("\u767b\u5f55\u4e0a\u62a5\u65b9\u6cd5\u6210\u529f-----")))},l.createRole=function(t){this.dataPlacement(90200),this.setRoleInfo(t),cc.log("\u521b\u89d2\u63d0\u4ea4\u4e00\u6b21\u4e0a\u62a5----\x3e",this.role_info),s.createRole(this.role_info,function(t){console.log("\u89d2\u8272\u4e0a\u62a5\uff0c\u8fd4\u56de\u652f\u4ed8\u60c5\u51b5",t),null!=t.data.msg.sp&&(window.IS_SHOW_CHARGE=t.data.msg.sp),null!=t.data.msg.follow&&(window.SH_SDK_FOLLOW=t.data.msg.follow)}.bind(this))},l.roleUpLevel=function(t){this.setRoleInfo(),this.role_info&&0==this.role_info.create_time||(null!=t&&t>1?(this.role_info.role_level=t,console.log("\u89d2\u8272\u5347\u7ea7\u4fe1\u606f\u4e0a\u62a5",this.role_info),s.roleUpLevel(this.role_info,function(t){console.log("\u89d2\u8272\u4e0a\u62a5\uff0c\u8fd4\u56de\u652f\u4ed8\u60c5\u51b5",t),null!=t.data.msg.sp&&(window.IS_SHOW_CHARGE=t.data.msg.sp),null!=t.data.msg.follow&&(window.SH_SDK_FOLLOW=t.data.msg.follow)}.bind(this)),cc.log("\u89d2\u8272\u5347\u7ea7\u4e0a\u62a5\u63d0\u4ea4---\x3e",this.role_info)):cc.log("\u89d2\u8272\u5347\u7ea7\u4e0a\u62a5\u63d0\u4ea4\u5931\u8d25---\x3e",this.role_info,t))},l.sdkBackLogin=function(){},l.getCurrChannel=function(){},l.getSubChannel=function(){},l.setClipboardData=function(t){wx.setClipboardData({data:t,success:function(t){}})},e.exports=l,cc._RF.pop()},{base64:"base64",login_controller:"login_controller",role_controller:"role_controller",shsdk:"shsdk",tips_controller:"tips_controller",welfare_event:"welfare_event"}],"sha1.min":[function(require,module,exports){(function(process,global){"use strict";function _typeof(t){"@babel/helpers - typeof";return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}cc._RF.push(module,"5d1d39skjhCNby9LOFbXycL","sha1.min"),function(){function t(t){t?(f[0]=f[16]=f[1]=f[2]=f[3]=f[4]=f[5]=f[6]=f[7]=f[8]=f[9]=f[10]=f[11]=f[12]=f[13]=f[14]=f[15]=0,this.blocks=f):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.h0=1732584193,this.h1=4023233417,this.h2=2562383102,this.h3=271733878,this.h4=3285377520,this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0}var h="object"==("undefined"==typeof window?"undefined":_typeof(window))?window:{},s=!h.JS_SHA1_NO_NODE_JS&&"object"==(void 0===process?"undefined":_typeof(process))&&process.versions&&process.versions.node;s&&(h=global);var i=!h.JS_SHA1_NO_COMMON_JS&&"object"==(void 0===module?"undefined":_typeof(module))&&module.exports,e="function"==typeof define&&define.amd,r="0123456789abcdef".split(""),o=[-2147483648,8388608,32768,128],n=[24,16,8,0],a=["hex","array","digest","arrayBuffer"],f=[],u=function(e){return function(i){return new t(!0).update(i)[e]()}},c=function(){var e=u("hex");s&&(e=p(e)),e.create=function(){return new t},e.update=function(t){return e.create().update(t)};for(var i=0;i<a.length;++i){var n=a[i];e[n]=u(n)}return e},p=function p(t){var h=eval("require('crypto')"),s=eval("require('buffer').Buffer"),i=function(e){if("string"==typeof e)return h.createHash("sha1").update(e,"utf8").digest("hex");if(e.constructor===ArrayBuffer)e=new Uint8Array(e);else if(void 0===e.length)return t(e);return h.createHash("sha1").update(new s(e)).digest("hex")};return i};t.prototype.update=function(t){if(!this.finalized){var e="string"!=typeof t;e&&t.constructor===h.ArrayBuffer&&(t=new Uint8Array(t));for(var i,s,a=0,o=t.length||0,l=this.blocks;a<o;){if(this.hashed&&(this.hashed=!1,l[0]=this.block,l[16]=l[1]=l[2]=l[3]=l[4]=l[5]=l[6]=l[7]=l[8]=l[9]=l[10]=l[11]=l[12]=l[13]=l[14]=l[15]=0),e)for(s=this.start;a<o&&s<64;++a)l[s>>2]|=t[a]<<n[3&s++];else for(s=this.start;a<o&&s<64;++a)(i=t.charCodeAt(a))<128?l[s>>2]|=i<<n[3&s++]:i<2048?(l[s>>2]|=(192|i>>6)<<n[3&s++],l[s>>2]|=(128|63&i)<<n[3&s++]):i<55296||i>=57344?(l[s>>2]|=(224|i>>12)<<n[3&s++],l[s>>2]|=(128|i>>6&63)<<n[3&s++],l[s>>2]|=(128|63&i)<<n[3&s++]):(i=65536+((1023&i)<<10|1023&t.charCodeAt(++a)),l[s>>2]|=(240|i>>18)<<n[3&s++],l[s>>2]|=(128|i>>12&63)<<n[3&s++],l[s>>2]|=(128|i>>6&63)<<n[3&s++],l[s>>2]|=(128|63&i)<<n[3&s++]);this.lastByteIndex=s,this.bytes+=s-this.start,s>=64?(this.block=l[16],this.start=s-64,this.hash(),this.hashed=!0):this.start=s}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}},t.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var t=this.blocks,e=this.lastByteIndex;t[16]=this.block,t[e>>2]|=o[3&e],this.block=t[16],e>=56&&(this.hashed||this.hash(),t[0]=this.block,t[16]=t[1]=t[2]=t[3]=t[4]=t[5]=t[6]=t[7]=t[8]=t[9]=t[10]=t[11]=t[12]=t[13]=t[14]=t[15]=0),t[14]=this.hBytes<<3|this.bytes>>>29,t[15]=this.bytes<<3,this.hash()}},t.prototype.hash=function(){var t,e,i=this.h0,s=this.h1,n=this.h2,a=this.h3,o=this.h4,l=this.blocks;for(t=16;t<80;++t)e=l[t-3]^l[t-8]^l[t-14]^l[t-16],l[t]=e<<1|e>>>31;for(t=0;t<20;t+=5)i=(e=(s=(e=(n=(e=(a=(e=(o=(e=i<<5|i>>>27)+(s&n|~s&a)+o+1518500249+l[t]<<0)<<5|o>>>27)+(i&(s=s<<30|s>>>2)|~i&n)+a+1518500249+l[t+1]<<0)<<5|a>>>27)+(o&(i=i<<30|i>>>2)|~o&s)+n+1518500249+l[t+2]<<0)<<5|n>>>27)+(a&(o=o<<30|o>>>2)|~a&i)+s+1518500249+l[t+3]<<0)<<5|s>>>27)+(n&(a=a<<30|a>>>2)|~n&o)+i+1518500249+l[t+4]<<0,n=n<<30|n>>>2;for(;t<40;t+=5)i=(e=(s=(e=(n=(e=(a=(e=(o=(e=i<<5|i>>>27)+(s^n^a)+o+1859775393+l[t]<<0)<<5|o>>>27)+(i^(s=s<<30|s>>>2)^n)+a+1859775393+l[t+1]<<0)<<5|a>>>27)+(o^(i=i<<30|i>>>2)^s)+n+1859775393+l[t+2]<<0)<<5|n>>>27)+(a^(o=o<<30|o>>>2)^i)+s+1859775393+l[t+3]<<0)<<5|s>>>27)+(n^(a=a<<30|a>>>2)^o)+i+1859775393+l[t+4]<<0,n=n<<30|n>>>2;for(;t<60;t+=5)i=(e=(s=(e=(n=(e=(a=(e=(o=(e=i<<5|i>>>27)+(s&n|s&a|n&a)+o-1894007588+l[t]<<0)<<5|o>>>27)+(i&(s=s<<30|s>>>2)|i&n|s&n)+a-1894007588+l[t+1]<<0)<<5|a>>>27)+(o&(i=i<<30|i>>>2)|o&s|i&s)+n-1894007588+l[t+2]<<0)<<5|n>>>27)+(a&(o=o<<30|o>>>2)|a&i|o&i)+s-1894007588+l[t+3]<<0)<<5|s>>>27)+(n&(a=a<<30|a>>>2)|n&o|a&o)+i-1894007588+l[t+4]<<0,n=n<<30|n>>>2;for(;t<80;t+=5)i=(e=(s=(e=(n=(e=(a=(e=(o=(e=i<<5|i>>>27)+(s^n^a)+o-899497514+l[t]<<0)<<5|o>>>27)+(i^(s=s<<30|s>>>2)^n)+a-899497514+l[t+1]<<0)<<5|a>>>27)+(o^(i=i<<30|i>>>2)^s)+n-899497514+l[t+2]<<0)<<5|n>>>27)+(a^(o=o<<30|o>>>2)^i)+s-899497514+l[t+3]<<0)<<5|s>>>27)+(n^(a=a<<30|a>>>2)^o)+i-899497514+l[t+4]<<0,n=n<<30|n>>>2;this.h0=this.h0+i<<0,this.h1=this.h1+s<<0,this.h2=this.h2+n<<0,this.h3=this.h3+a<<0,this.h4=this.h4+o<<0},t.prototype.hex=function(){this.finalize();var t=this.h0,e=this.h1,i=this.h2,s=this.h3,n=this.h4;return r[t>>28&15]+r[t>>24&15]+r[t>>20&15]+r[t>>16&15]+r[t>>12&15]+r[t>>8&15]+r[t>>4&15]+r[15&t]+r[e>>28&15]+r[e>>24&15]+r[e>>20&15]+r[e>>16&15]+r[e>>12&15]+r[e>>8&15]+r[e>>4&15]+r[15&e]+r[i>>28&15]+r[i>>24&15]+r[i>>20&15]+r[i>>16&15]+r[i>>12&15]+r[i>>8&15]+r[i>>4&15]+r[15&i]+r[s>>28&15]+r[s>>24&15]+r[s>>20&15]+r[s>>16&15]+r[s>>12&15]+r[s>>8&15]+r[s>>4&15]+r[15&s]+r[n>>28&15]+r[n>>24&15]+r[n>>20&15]+r[n>>16&15]+r[n>>12&15]+r[n>>8&15]+r[n>>4&15]+r[15&n]},t.prototype.toString=t.prototype.hex,t.prototype.digest=function(){this.finalize();var t=this.h0,e=this.h1,i=this.h2,s=this.h3,n=this.h4;return[t>>24&255,t>>16&255,t>>8&255,255&t,e>>24&255,e>>16&255,e>>8&255,255&e,i>>24&255,i>>16&255,i>>8&255,255&i,s>>24&255,s>>16&255,s>>8&255,255&s,n>>24&255,n>>16&255,n>>8&255,255&n]},t.prototype.array=t.prototype.digest,t.prototype.arrayBuffer=function(){this.finalize();var t=new ArrayBuffer(20),e=new DataView(t);return e.setUint32(0,this.h0),e.setUint32(4,this.h1),e.setUint32(8,this.h2),e.setUint32(12,this.h3),e.setUint32(16,this.h4),t};var y=c();i?module.exports=y:(h.sha1=y,e&&define(function(){return y}))}(),cc._RF.pop()}).call(this,require("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:5}],shsdk_conf:[function(t,e,i){"use strict";cc._RF.push(e,"3313bk9Xf5FQ4/Ge3B9KixG","shsdk_conf"),i.AND_PACKAGE_CODE="P0006089",i.IOS_PACKAGE_CODE="P0006090",i.APP_VERSION="20190712",cc._RF.pop()},{}],shsdk:[function(t,e,i){"use strict";function s(t){"@babel/helpers - typeof";return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}cc._RF.push(e,"1262581WSNLCLODhECBizL7","shsdk");var n=["sh_conf","shsdk_conf","prototype","https://mal.4ulib.com/","","p_order","wxxcxgzh","AND_PACKAGE_CODE","IOS_PACKAGE_CODE","init Error: \u7f3a\u5c11 package_code","log","debug","hasOwnProperty","repay_empty_count_max","repay_times","repay_delay","getSystemInfoSync","IOS","indexOf","toUpperCase","system","ios","package_code","system:IOS","android","system:ANDROID","\u5207\u5305\u7f16\u53f7\uff1a","idfa","idfa:","rand_id","getLaunchOptionsSync","query","zf","1","referrerInfo","appId","\u8f6c\u53d1\u6807\u8bc6","host_url","wxxcx/onshow","scene","data","request","startRepay","sh_user","uid","wxxcx/onshare","share_title","msg","share_img","zf=1&tid=","otid","&","sharequery","sharedata","share success","sharecallback","share fail","shsdk wx.onShareAppMessage","\u6e38\u620f\u5185\u5206\u4eab\u5185\u5bb9","shareAppMessage","\u53f3\u4e0a\u89d2\u5206\u4eab\u5185\u5bb9","onShareAppMessage","shsdk share","showShareMenu","shsdk goShare","split","length","=","toLocaleString","wx","random","getFullYear","-","getMonth","getDate","getHours","getMinutes","getSeconds","dd","getStorageSync","getCookie key:"," val:","setStorageSync","setCookie key:"," ret:","\u767b\u9646\u6210\u529f uid:"," sp:","sp"," tid:","tid"," otid:","tokenid","logincallback","showGonggao","[shsdk\u767b\u5f55\u672a\u5b8c\u6210\uff0c\u516c\u544a\u5185\u5bb9\u4e0d\u663e\u793a]","gonggao","gonggao_navigateto","\u516c\u544a\u4e0d\u8df3\u8f6capp","\u516c\u544a\u5185\u5bb9\uff1a","gonggao_appid","gonggao_path","?","&shuid=","&shtt=","t","?shuid=","pages/index/index?shuid=","\u8df3\u8f6c\u5c0f\u7a0b\u5e8fsuccess\uff1a","\u8df3\u8f6c\u5c0f\u7a0b\u5e8ffail\uff1a","navigateToMiniProgram","object","gonggao content","open_gonggao","\u516c\u544a","gonggao_content","confirm","\u60a8\u7684\u5fae\u4fe1\u7248\u672c\u8fc7\u4f4e\uff0c\u65e0\u6cd5\u4f7f\u7528\u8be5\u529f\u80fd","showModal","onTouchStart","wxxcx/get_gonggao","json","_getGongGao ret:","ret","-2","_getGongGao fail","_getGongGao complete","\u5b9e\u540d\u8ba4\u8bc1","sm","\u5f00\u542f\u5b9e\u540d","force","show_text","\u7528\u6237\u70b9\u51fb\u786e\u5b9a","\u56de\u590d\u4efb\u610f\u6d88\u606f\u7ee7\u7eed","html/images/sm.png","openCustomerServiceConversation","cancel","\u7528\u6237\u70b9\u51fb\u53d6\u6d88","pay","\u63d0\u793a\u4fe1\u606f","shsdk platlogin","wxxcx/login/package_code/","code","shsdk login ret:","0","[shsdk]\u767b\u9646\u5931\u8d25\uff0c\u8bf7\u8054\u7cfb\u5ba2\u670d","showMsg","shsdk login fail","shsdk login complete","shsdk wxlogin","fail","login","shsdk login","\u6388\u6743\u6210\u529f\u6570\u636e","<-this is login tokenid","wxxcx/unid/package_code/","iv","encryptedData","unionId_key","unionId","shsdk unionId ret:","shsdk unionId fail","shsdk unionId complete","\u767b\u9646\u8fd8\u672a\u5b8c\u6210\uff0c\u8bf7\u7a0d\u5019....","_paycallback","pt","sp_type","type","string","wxxcx","reportRoleCallback","CreateRoleInfo","role_level","SetRoleInfo","RoleUpdateLevel","v","APP_VERSION","wxxcx/role","realname","shsdk upload_role_info ret:","\u89d2\u8272\u6570\u636e\u4e0a\u62a5\u7c7b\u578b\uff1a","shsdk upload_role_info fail","shsdk upload_role_info complete","subscribeCallback","\u83b7\u53d6\u516c\u4f17\u53f7\u5173\u6ce8\u72b6\u6001\u5f97\u5230\u7684unionID","unionId is empty\uff0crequest is cancel","wxxcx/getSubscribeStatus/package_code/","subscribe","subscribe_time","shsdk subscribe ret:","shsdk subscribe fail","shsdk subscribe complete","action/gog/package_code/","action","model","shsdk dataPlacement success:","shsdk dataPlacement fail","shsdk dataPlacement complete","\u5145\u503c\u6559\u7a0b","\u5373\u5c06\u8df3\u8f6c\u5b98\u65b9\u3010\u5ba2\u670d\u4f1a\u8bdd\u3011\u5145\u503c\r\n\u7ed9\u5ba2\u670d\u56de\u590d[\u5145\u503c]\u83b7\u53d6\u5145\u503c\u94fe\u63a5","html/images/pay.jpg","env","debug:","zoneId","game","offerId","CNY","buyQuantity","requestMidasPayment fail ","FAIL","paycallback","requestMidasPayment complete","requestMidasPayment","parse","pop","pay_queue_key","push","stringify","remove order data","o_num","error","repay_timer","repay_empty_count","rec:","clear rep","_startRep","_startRep order info","pay/notify/type/wxxcx","shsdk pay ret:","success","paynotifyfail","SUCCESS","wxxcx/ini/package_code/","/pt/","game_no","order_money","order_name","role_id","role_name","server_id","server_name","ext","shsdk p ret:","yd","\u5145\u503c\u5f15\u5bfc\u6587\u5b57:","text","YD_TIPS","P NOT_ALLOW","NOT_ALLOW","shsdk p fail","shsdk p complete","\u7528\u6237\u7b49\u7ea7","init","share","goShare","createRole","enterGame","roleUpLevel","dataPlacement","exports"];window[n[0]]=t(n[1]);var a=function(){};a[n[2]]={host_url:n[3],logincallback:!1,reportRoleCallback:!1,_paycallback:!1,sharecallback:!1,sharequery:n[4],shareIsSet:!1,package_code:null,sh_user:null,idfa:null,system:null,debug:!1,pay_queue_key:n[5],repay_timer:null,repay_delay:6e4,repay_times:10,repay_empty_count:0,repay_empty_count_max:5,package_config:null,sp_type:n[6],otid:n[4],rand_id:null,init:function(t){if(!window[n[0]][n[7]]||!window[n[0]][n[8]])return console[n[10]](n[9]),!1;t[n[12]](n[11])&&(this[n[11]]=t[n[11]]),this[n[11]]&&(this[n[13]]=2,this[n[14]]=2,this[n[15]]=4e3),-1!=wx[n[16]]()[n[20]][n[19]]()[n[18]](n[17])?(this[n[20]]=n[21],this[n[22]]=window[n[0]][n[8]],console[n[10]](n[23])):(this[n[20]]=n[24],this[n[22]]=window[n[0]][n[7]],console[n[10]](n[25])),console[n[10]](n[26]+this[n[22]]);var e=this._getCookie(n[27]);e||(e=this._idfa(),console[n[10]](n[28]+e),this._setCookie(n[27],e)),this[n[27]]=e,this[n[29]]=this._rand_id();var i=wx[n[30]]();console[n[10]](i[n[31]]),i[n[31]][n[32]]==n[33]&&(i[n[34]]||(i[n[34]]={}),i[n[34]][n[35]]=n[32],console[n[10]](n[36],i[n[34]][n[35]])),wx[n[41]]({url:this[n[37]]+n[38],data:{package_code:this[n[22]],system:this[n[20]],idfa:this[n[27]],opt:{scene:i[n[39]],query:i[n[31]],referrer:i[n[34]]}},success:function(t){console[n[10]](n[38],t[n[40]])}}),this[n[42]]()},_getShareInfo:function(t){var e=this,i=e[n[43]]?e[n[43]][n[44]]:n[4];wx[n[41]]({url:e[n[37]]+n[45],data:{package_code:e[n[22]],system:e[n[20]],idfa:e[n[27]],uid:i,type:t},success:function(i){console[n[10]](n[45],i[n[40]]);var s=i[n[40]][n[47]][n[46]],a=i[n[40]][n[47]][n[48]];a=e[n[37]]+a;var o=n[49]+e[n[50]]+n[51]+e[n[52]];e[n[53]]={title:s,imageUrl:a,query:o,success:function(t){console[n[10]](n[54],t),e[n[55]]?e[n[55]]():n[4]},fail:function(t){console[n[10]](n[56],t)}},console[n[10]](n[57],o),1==t?(console[n[10]](n[58],e[n[53]]),wx[n[59]](e[n[53]])):wx[n[61]](function(){return console[n[10]](n[60],e[n[53]]),e[n[53]]})}})},share:function(t,e){console[n[10]](n[62],e);this[n[55]]=t,this[n[52]]=e,wx[n[63]](),this._getShareInfo(0)},goShare:function(t){console[n[10]](n[64],this[n[52]]),t&&this[n[52]]?this[n[52]][n[18]](t)<0?this[n[52]]=this[n[52]]+n[51]+t:this[n[52]]=this[n[52]]:t&&(this[n[52]]=t),this._getShareInfo(1)},_query:function(t){for(var e=t[n[65]](n[51]),i={},s=0;s<e[n[66]];s++){var a=e[s][n[65]](n[67])[0],o=e[s][n[65]](n[67])[1];o||(o=n[4]),i[a]=o}return i},_idfa:function(){var t=new Date;console[n[10]](t[n[68]]());var e=n[69],i=parseInt(9e3*Math[n[70]]()+1e3,10);return e+=t[n[71]](),e+=n[72]+(t[n[73]]()+1),e+=n[72]+t[n[74]](),e+=n[72]+t[n[75]](),e+=n[72]+t[n[76]](),e+=n[72]+t[n[77]](),e+=n[72]+i},_rand_id:function(){var t=new Date;console[n[10]](t[n[68]]());var e=n[78],i=parseInt(9e3*Math[n[70]]()+1e3,10);return e+=t[n[71]](),e+=t[n[73]]()+1,e+=t[n[74]](),e+=t[n[75]](),e+=t[n[76]](),e+=t[n[77]](),e+=i},_getCookie:function(t){var e=!1;try{e=wx[n[79]](t)}catch(t){}return console[n[10]](n[80]+t+n[81]+e),e},_setCookie:function(t,e){var i=!1;try{i=wx[n[82]](t,e)}catch(t){i=!1}console[n[10]](n[83]+t+n[84]+i)},_loginSuccess:function(t){this[n[43]]=t,console[n[10]](n[26]+this[n[22]]),console[n[10]](n[85]+this[n[43]][n[44]]+n[86]+this[n[43]][n[87]]+n[88]+this[n[43]][n[89]]+n[90]+this[n[43]][n[50]]),this[n[50]]=this[n[43]][n[50]];var e={tokenid:this[n[43]][n[91]]};this[n[92]](e),this[n[93]]()},showGonggao:function(){var t=this;if(!t[n[43]])return console[n[10]](n[94]),!1;var e=!1,i=t[n[43]][n[95]],a=function(){if(i[n[96]]!=n[33])return console[n[10]](n[97]),!1;console[n[10]](n[98],i[n[99]],i[n[100]]);var e=n[4];e=i[n[100]]&&i[n[100]][n[18]](n[101])>=0?i[n[100]]+n[102]+t[n[43]][n[44]]+n[103]+t[n[43]][n[104]]:i[n[100]]&&i[n[100]][n[18]](n[101])<0?i[n[100]]+n[105]+t[n[43]][n[44]]+n[103]+t[n[43]][n[104]]:n[106]+t[n[43]][n[44]]+n[103]+t[n[43]][n[104]],wx[n[109]]({appId:i[n[99]],path:e,extraData:{},success:function(t){console[n[10]](n[107],t)},fail:function(t){console[n[10]](n[108],t)}})};wx[n[118]](function(o){!e&&(e=!0,s(t[n[43]][n[95]])==n[110]&&(console[n[10]](n[111],i),i[n[112]]==n[33]&&wx[n[117]]({title:n[113],content:i[n[114]],success:function(t){if(t[n[115]])try{a()}catch(t){return console[n[10]](n[116]),!1}}})))})},_getGongGao:function(t){var e=this;wx[n[41]]({url:e[n[37]]+n[119],data:{system:e[n[20]],u_info:{uid:e[n[43]][n[44]],t:e[n[43]][n[104]]},tid:e[n[43]][n[89]],package_code:e[n[22]],level:t},dataType:n[120],success:function(t){console[n[10]](n[121],t),t[n[40]][n[122]]!=n[123]&&(e[n[43]][n[95]]=t[n[40]][n[122]],e[n[93]]())},fail:function(t){console[n[10]](n[124],t)},complete:function(t){console[n[10]](n[125],t)}})},realname:function(t,e){console[n[10]](n[126],t);var i=this,s=t[n[40]];if(!s[n[47]][n[127]])return!1;console[n[10]](n[128]);var a=!1,o=function(){a&&1!=t[n[40]][n[47]][n[127]][n[129]]||(a=!0,wx[n[117]]({title:n[126],content:s[n[47]][n[127]][n[130]],success:function(t){t[n[115]]?(console[n[10]](n[131]),wx[n[134]]({showMessageCard:!0,sendMessageTitle:n[132],sendMessageImg:i[n[37]]+n[133]})):t[n[135]]&&console[n[10]](n[136])}}))};e==n[137]?o():wx[n[118]](function(t){o()})},showMsg:function(t){wx[n[117]]({title:n[138],content:t})},_platlogin:function(t){var e=this;console[n[10]](n[139],t),wx[n[41]]({url:e[n[37]]+n[140]+e[n[22]],data:{code:t[n[141]],idfa:e[n[27]],system:e[n[20]]},dataType:n[120],success:function(t){console[n[10]](n[142],t);var i=t[n[40]];if(i[n[122]]!=n[143])return e[n[145]](n[144]),!1;e._loginSuccess(i[n[47]]),e._setCookie(n[91],i[n[47]][n[91]])},fail:function(t){console[n[10]](n[146])},complete:function(t){console[n[10]](n[147])}})},_wxlogin:function(){console[n[10]](n[148]);var t=this;wx[n[150]]({success:function(e){t._platlogin(e)},fail:function(t){console[n[10]](n[149],t)},complete:function(t){}})},login:function(t){console[n[10]](n[151]),this[n[92]]=t;this._wxlogin()},unionId:function(t){console[n[10]](n[152],t);var e=this,i=e._getCookie(n[91]);console[n[10]](i,n[153]),wx[n[41]]({url:e[n[37]]+n[154]+e[n[22]],data:{tokenid:i,idfa:e[n[27]],system:e[n[20]],iv:t[n[155]],encryptedData:t[n[156]]},dataType:n[120],success:function(t){e._setCookie(n[157],t[n[40]][n[47]][n[158]]),console[n[10]](n[159],t)},fail:function(t){console[n[10]](n[160])},complete:function(t){console[n[10]](n[161])}})},pay:function(t,e){var i=this;if(!i[n[43]])return console[n[10]](n[162]),!1;var a=t;this[n[163]]=e,t[n[164]]=i[n[165]],this._getPayInfo(t,function(t){s(t[n[166]])==n[167]&&t[n[166]]==n[168]?i._wxPay(t):i._sp(a,t)})},paycallback:function(t){this[n[163]]&&this._paycallback(t)},createRole:function(t,e){this[n[169]]=e,this._uploadRoleInfo(t,n[170])},enterGame:function(t,e){this[n[169]]=e,this._getGongGao(t[n[171]]),this._uploadRoleInfo(t,n[172])},roleUpLevel:function(t,e){this[n[169]]=e,this._uploadRoleInfo(t,n[173])},_uploadRoleInfo:function(t,e){var i=this;t[n[27]]=i[n[27]],t[n[166]]=e,t[n[20]]=i[n[20]],t[n[91]]=i[n[43]][n[91]],t[n[22]]=i[n[22]],t[n[174]]=window[n[0]][n[175]],wx[n[41]]({url:i[n[37]]+n[176],data:t,dataType:n[120],success:function(t){i[n[169]](t),i[n[177]](t,n[150]),console[n[10]](n[178],t,n[179],e)},fail:function(t){console[n[10]](n[180],n[179],e)},complete:function(t){console[n[10]](n[181],n[179],e)}})},subscribe:function(t){var e=this;e[n[182]]=t;var i=e._getCookie(n[157]);if(console[n[10]](n[183],i),!i)return console[n[10]](n[184]),!1;wx[n[41]]({url:e[n[37]]+n[185]+e[n[22]],data:{unionid:i},dataType:n[120],success:function(t){var i={subscribe:t[n[40]][n[47]][n[186]],subscribe_time:t[n[40]][n[47]][n[187]]};e[n[182]](i),console[n[10]](n[188],t)},fail:function(t){console[n[10]](n[189],t)},complete:function(t){console[n[10]](n[190],t)}})},dataPlacement:function(t){wx[n[41]]({url:this[n[37]]+n[191]+this[n[22]],data:{id:this[n[29]],idfa:this[n[27]],action:t[n[192]],system:this[n[20]],model:wx[n[16]]()[n[193]]},dataType:n[120],success:function(t){console[n[10]](n[194],t)},fail:function(t){console[n[10]](n[195],t)},complete:function(t){console[n[10]](n[196],t)}})},_sp_init:!1,_sp:function(t,e){var i=this;wx[n[117]]({title:n[197],content:n[198],complete:function(){wx[n[134]]({showMessageCard:!0,sendMessageTitle:n[132],sendMessageImg:i[n[37]]+n[199]})}})},_wxPay:function(t){var e=this,i=e[n[11]]?1:0;t[n[200]]=i,console[n[10]](n[201],e[n[11]],e[n[20]],t[n[202]]),this[n[11]],wx[n[211]]({mode:n[203],env:i,offerId:t[n[204]],currencyType:n[205],buyQuantity:t[n[206]],platform:e[n[20]],zoneId:t[n[202]],success:function(i){console[n[10]](i),e._push(t),e._platPayNotify(t)},fail:function(t){console[n[10]](n[207],t),e[n[209]]({ret:n[208]})},complete:function(){console[n[10]](n[210])}})},_pop:function(t){var e=JSON[n[212]](wx[n[79]](t));if(s(e)==n[110]){var i=e[n[213]]();return wx[n[82]](t,e),i}return!1},_push:function(t){var e=this[n[214]],i=wx[n[79]](e);try{i=JSON[n[212]](i)}catch(t){i=[]}return i[n[215]](t),wx[n[82]](e,JSON[n[216]](i))},_remove:function(t){var e=this[n[214]],i=wx[n[79]](e);console[n[10]](n[217],i);var s=[];try{i=JSON[n[212]](i)}catch(t){return!1}if(0==i[n[66]])return!1;for(var a=0;a<i[n[66]];a++)i[a][n[218]]!==t[n[218]]?i[a]&&s[n[215]](i[a]):delete i[a];wx[n[82]](e,JSON[n[216]](s))},paynotifyfail:function(t){t[n[219]]++,t[n[219]]<this[n[14]]&&this[n[42]]()},startRepay:function(){var t=this;t[n[220]]||(t._startRepay(),t[n[220]]=setInterval(function(){t._startRepay()?t[n[221]]=0:t[n[221]]++,console[n[10]](n[222]+t[n[221]]),t[n[221]]>=t[n[13]]&&(clearInterval(t[n[220]]),t[n[220]]=null,console[n[10]](n[223]))},t[n[15]]))},_startRepay:function(){console[n[10]](n[224]);var t=this[n[214]],e=wx[n[79]](t);try{e=JSON[n[212]](e)}catch(t){return!1}if(0==e[n[66]])return!1;console[n[10]](n[225],e);for(var i=0;i<e[n[66]];i++){var s=e[i];this._sendPayNotify(s)}return!0},_platPayNotify:function(t){t[n[219]]=0;this._sendPayNotify(t)},_sendPayNotify:function(t){var e=this;wx[n[41]]({url:e[n[37]]+n[226],data:{o_num:t[n[218]],pf:e[n[20]],env:t[n[200]]},dataType:n[120],success:function(i){if(console[n[10]](n[227],i),i[n[40]][n[47]]!=n[228])return e[n[229]](t),!1;e._remove(t),e[n[209]]({ret:n[230]})},fail:function(i){console[n[10]](i),e[n[229]](t)}})},_getPayInfo:function(t,e){var i=this,a=i[n[37]]+n[231]+i[n[22]];s(t[n[164]])==n[167]&&(a+=n[232]+t[n[164]]),wx[n[41]]({url:a,data:{system:i[n[20]],idfa:i[n[27]],uid:i[n[43]][n[44]],game_no:t[n[233]],order_money:t[n[234]],order_name:t[n[235]],role_id:t[n[236]],role_name:t[n[237]],server_id:t[n[238]],server_name:t[n[239]],role_level:t[n[171]],ext:t[n[240]]},dataType:n[120],success:function(t){console[n[10]](n[241],t);var s=t[n[40]];return s[n[47]][n[127]]?(i[n[177]](t,n[137]),!1):s[n[47]][n[242]]?(console[n[10]](n[243],s[n[47]][n[242]][n[244]]),i[n[209]]({ret:n[245],msg:s[n[47]][n[242]][n[244]]}),!1):s[n[122]]!=n[143]?(console[n[10]](n[246]),i[n[209]]({ret:n[247]}),!1):void e(s[n[47]])},fail:function(t){console[n[10]](n[248])},complete:function(t){console[n[10]](n[249])}}),console[n[10]](n[250],t[n[171]])}};var o=new a;e[n[258]]={init:function(t){o[n[251]](t)},login:function(t){o[n[150]](t)},pay:function(t,e){o[n[137]](t,e)},share:function(t,e){o[n[252]](t,e)},goShare:function(t){o[n[253]](t)},unionId:function(t){o[n[158]](t)},createRole:function(t,e){o[n[254]](t,e)},enterGame:function(t,e){o[n[255]](t,e)},roleUpLevel:function(t,e){o[n[256]](t,e)},subscribe:function(t){o[n[186]](t)},dataPlacement:function(t){o[n[257]](t)}},cc._RF.pop()},{}],sign_item:[function(t,e,i){"use strict";cc._RF.push(e,"bbe1bf35rRMFZiUUvy8zfHr","sign_item");var s=t("pathtool");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("welfare","sign_item")},initConfig:function(){},initPanel:function(){this.main_container_nd=this.seekChild("main_container"),this.get_nd=this.seekChild(this.main_container_nd,"get"),this.get_nd.active=!1,this.get2_nd=this.seekChild(this.main_container_nd,"get2"),this.get2_nd.active=!1;var t=this.seekChild("goodcon");this.goods_item=ItemsPool.getInstance().getItem("backpack_item"),this.goods_item.show(),this.goods_item.initConfig(!1,.9,!1,!1),this.goods_item.setPosition(53.5,53.5),this.goods_item.setParent(t),this.touch_nd=this.seekChild("touch")},registerEvent:function(){this.touch_nd.on(cc.Node.EventType.TOUCH_END,function(){this.callback&&this.callback(this)},this)},setData:function(t){this.data=t,this.root_wnd&&this.onShow()},onShow:function(){if(this.touch_nd.name="sign_btn_"+this.data.day,null!=this.data){var t=this.data;t.index;var e={};if((e=Utils.deepCopy(Utils.getItemConfig(t.rewards[0][0]))).quantity=t.rewards[0][1],e.num=e.quantity,e.bid=e.id,this.goods_item.setData(e),null!=t.status)if(0==t.status){if(t.now_day==t.day){if(null==this.effect){this.effect=this.seekChild(this.main_container_nd,"effect",sp.Skeleton);var i=cc.js.formatStr("spine/%s/action.atlas",s.getEffectRes(262));this.loadRes(i,function(t){this.effect.skeletonData=t,this.effect.setAnimation(0,"action",!1)}.bind(this))}this.effect.node.active=!0}else this.effect&&(this.effect.node.active=!1);this.root_wnd.resumeSystemEvents(!0),this.get2_nd.active=!1,this.get_nd.active=!1}else 1==t.status?(this.effect&&(this.effect.node.active=!1),this.get2_nd.active=!0,this.get_nd.active=!1,this.root_wnd.resumeSystemEvents(!0)):2==t.status&&(this.effect&&(this.effect.node.active=!1),this.get2_nd.active=!1,this.get_nd.active=!0,this.root_wnd.pauseSystemEvents(!0));null!=t.is_show&&(1==t.is_show?this.goods_item.showItemEffect(!0,263,PlayerAction.action_2,!0,1.1):this.goods_item.showItemEffect(!1))}},addCallBack:function(t){null==this.callback&&(this.callback=t)},getData:function(){return this.data},getItemPosition:function(){if(this.root_wnd)return this.root_wnd.getPosition()},onHide:function(){},onDelete:function(){this.goods_item&&(this.goods_item.deleteMe(),this.goods_item=null),this.effect&&(this.effect.setToSetupPose(),this.effect.clearTracks())}});cc._RF.pop()},{pathtool:"pathtool"}],sign_panel:[function(t,e,i){"use strict";cc._RF.push(e,"00acdMJC4tMtqMvBfKNOA3e","sign_panel");var s=t("pathtool"),n=t("role_controller"),a=t("welfare_controller"),o=t("common_scrollview"),l=t("timetool"),r=t("sign_item"),c=t("welfare_event");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("welfare","sign_panel")},initConfig:function(){this.ctrl=a.getInstance(),this.model=this.ctrl.getModel(),this.role_vo=n.getInstance().getRoleVo()},initPanel:function(){this.main_container_nd=this.seekChild("main_container"),this.title_con_nd=this.seekChild("title_con"),this.tips_btn_nd=this.seekChild("tips_btn"),this.goods_con_nd=this.seekChild("goods_con");var t=this.title_con_nd.getChildByName("title_img").getComponent(cc.Sprite);this.loadRes(s.getIconPath("welfare/welfare_banner","txt_cn_welfare_banner2"),function(e){t.spriteFrame=e}.bind(this));var e=this.goods_con_nd.getContentSize(),i={item_class:r,start_x:25,space_x:28,start_y:20,space_y:30,item_width:107,item_height:107,row:0,col:5,need_dynamic:!0};this.item_scrollview=new o,this.item_scrollview.createScroll(this.goods_con_nd,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,e,i,cc.v2(.5,.5))},registerEvent:function(){this.addGlobalEvent(c.Update_Sign_Info,function(t){this.createList(t)},this),this.addGlobalEvent(c.Sign_Success,function(t){this.createList(t)},this),this.tips_btn_nd.on(cc.Node.EventType.TOUCH_END,function(e){Utils.playButtonSound(1);var i=e.touch.getLocation(),s=StringUtil.parse(Config.checkin_data.data_const.checkin_rules.desc);t("tips_controller").getInstance().showCommonTips(s,i)}),this.ctrl.sender14100()},createList:function(e){var i=Config.checkin_data.data_award,s=gcore.SmartSocket.getTime(),n=Number(l.dateFtt("MM",s)),a=Utils.deepCopy(i[n]),o=e.day,r=0,c=[];for(var _ in a){var h=a[_];e.status>0?(h.status=_<o?2:_==o?e.status:0,h.now_day=o,r=o):0==e.status&&(h.status=_<=o?2:_==o+1?e.status:0,h.now_day=o+1,r=o+1),c.push(h)}c.sort(Utils.tableLowerSorter(["day"])),this.item_scrollview.setData(c,function(e){var i=e.getData();if(1==i.status&&i.now_day==i.day&&0==this.model.getRechargeCount()){var s=Utils.TI18N("\u5f53\u5929\u5145\u503c<color=#289b14>\u4efb\u610f\u91d1\u989d</c>\u53ef<color=#289b14>\u989d\u5916</c>\u83b7\u5f97\u4e00\u6b21\u5956\u52b1");t("commonalert").show(s,Utils.TI18N("\u786e\u8ba4"),function(){t("vip_controller").getInstance().openVipMainWindow(!0,VIPTABCONST.CHARGE)},Utils.TI18N("\u53d6\u6d88"),null,2)}else i.day>i.now_day?message(Utils.TI18N("\u672a\u8fbe\u5230\u7b7e\u5230\u5929\u6570")):this.ctrl.sender14101()}.bind(this)),this.item_scrollview.addEndCallBack(function(){var t=this.item_scrollview.getItemList(),e=null;for(var i in t){26==t[i].getData().day&&(e=t[i].getItemPosition())}r>=25&&this.item_scrollview.jumpToMove(cc.v2(e.x,e.y+this.item_scrollview.getContentSize().height/2),.1)}.bind(this))},onShow:function(t){},onHide:function(){},onDelete:function(){this.item_scrollview&&(this.item_scrollview.deleteMe(),this.item_scrollview=null)}});cc._RF.pop()},{common_scrollview:"common_scrollview",commonalert:"commonalert",pathtool:"pathtool",role_controller:"role_controller",sign_item:"sign_item",timetool:"timetool",tips_controller:"tips_controller",vip_controller:"vip_controller",welfare_controller:"welfare_controller",welfare_event:"welfare_event"}],skill_act:[function(t,e,i){"use strict";cc._RF.push(e,"eb4f3hW10xIfLrx+mcIDbw1","skill_act");var s={newPos2Gird:function(t,e,i,s){return 0!=t&&null!=t||message("\u4f4d\u7f6e\u4e0d\u80fd\u4e3a0"),31==t||32==t?t=10:2==i&&(t-=GIRD_POS_OFFSET),t-=1,t=Math.max(0,t),1==e?Pos2GridLeft[t]:s?Pos2GridRight[t]:NormalPosGridRight[t]},gridSizeX:function(){return SCREEN_WIDTH/80},gridSizeY:function(){return SCREEN_HEIGHT/80},gridPosToScreenPos:function(t){return cc.v2(t.x*this.gridSizeX(),t.y*this.gridSizeY())},screenPosToGridPos:function(t){return cc.v2(t.x/this.gridSizeX(),t.y/this.gridSizeY())},normalStart:function(t){return cc.callFunc(function(){this.actStart(t)}.bind(this))},normalFinish:function(t){return cc.callFunc(function(){this.actFinish(t)}.bind(this))},actStart:function(e){t("battle_controller").getInstance().getModel().actStart(e)},actFinish:function(e){t("battle_controller").getInstance().getModel().actFinish(e)},addDelay:function(t,e,i,s){return 0==e||null==e?0==s||null==s?cc.sequence(this.normalStart(t),i,this.normalFinish(t)):cc.sequence(this.normalStart(t),i,cc.delayTime(s/30),this.normalFinish(t)):0==s||null==s?cc.sequence(this.normalStart(t),cc.delayTime(e/30),i,this.normalFinish(t)):cc.sequence(this.normalStart(t),cc.delayTime(e/30),i,cc.delayTime(s/30),this.normalFinish(t))},handleAttackerMove:function(e,i){if(null!=e&&null!=e.play_order_index&&null!=e.anime_res){var s=t("battle_controller").getInstance().getModel(),n=e.spine_name,a=null,o=Config.battle_act_data.data_info[n];(a=null==e.play_action_name||null==o||null==o[e.anime_res]||null==o[e.anime_res][e.play_action_name]?Config.battle_act_data.data_info[0].action1.action1:o[e.anime_res][e.play_action_name])&&(1==i?s.moveBack(e,a.back_delay_time,a.back_move_time,a.back_model_x,null,null,null,null,a.is_move_map):(a.shadow_time&&a.shadow_time,1==a.is_move_area?s.moveToArea(e,a):s.moveTo(e,a.move_delay_time,a.move_time,a.move_model_x,a.move_model_y,null,null,0,0,a.is_move_map,a.is_reverse,a.is_col_act)))}},move:function(e,i,s,n){var a=t("battle_controller").getInstance().getModel();0==e.is_die&&1==a.getBuffTag(e)&&e.runAction();var o=cc.moveTo(n/60,i).easing(cc.easeExponentialOut());return this.addDelay(e,s,o)},setAnimationWithEvent:function(e,i,s,n,a,o,l,r){var c=t("battle_controller").getInstance().getModel();return cc.callFunc(function(){var t=function(t){"hit"==t||"Hit"==t||"HIT"==t?e.hit_time<e.hit_num&&s&&(s(),e.hit_time+=1):"back"==t||"Back"==t||"BACK"==t?e.is_attack==i&&(this.handleAttackerMove(e,!0),e.is_attack=null):"attack"==t?(e.in_area_effect?(e.is_area_attack=!0,e.hit_time+=1,c.areaHurt(e)):l&&l(),c.attackPoint(e)):"hit_none"==t?c.actHurt(e):"hit_big"==t?c.actHurt(e,!0):"ready"==t?c.attackReady(e):"shake_point"==t?c.playShakeScreen(e.shake_id):"move"==t?this.handleAttackerMove(e):t.indexOf("hit_num")}.bind(this),_=function(t){t==i&&(e.hit_time<e.hit_num&&s&&(s(),e.hit_time+=1),n?n():(1==e.play_stand&&(e.is_real?this.setAnimation(e,PlayerAction.battle_stand,!0):this.setAnimation(e,PlayerAction.run,!0)),e.is_area_attack=!1,this.actFinish(e)),e.setHallowsRound(),e.in_animation=!1)}.bind(this);e.setAnimationActionFunc(t,_,i),this.setAnimation(e,i,a,function(){e.hit_time=0,e.hit_num=Math.max(1,e.split_hurt||1),e.in_animation=!0,1==o&&e.reverse(-e.obj_type)},r)}.bind(this))},setAnimation:function(t,e,i,s,n){e&&-1==e.indexOf("E")&&(t.reverse(t.obj_type),t.playActionOnce(e,n,i)),s&&s()},attack:function(t,e,i,s,n,a,o,l){var r=null;return n&&(r=cc.callFunc(n)),this.actStart(t),t.is_attack=i,""!=t.shout_trick&&1==t.is_real&&Utils.playEffectSound(AUDIO_TYPE.BATTLE,t.shout_trick),null==r?this.addDelay(t,e,this.setAnimationWithEvent(t,i,s,null,!1,a,o,l)):this.addDelay(t,e,cc.sequence(r,this.setAnimationWithEvent(t,i,s,null,!1,a,o,l)))},effectArea:function(e,i,s,n,a,o,l){null==n&&(n=!0);var r=t("battle_controller").getInstance().getModel(),c=r.getBattleScene();if(null!=c)for(var _=[c.getBattleEffectLayer(1),c.getBattleEffectLayer(2)],h=!1,d=Config.skill_data.data_get_effect_data[l],u=function(t,e,i){i||(t.in_area_effect=null,r.delBattleEffect(e)),this.actFinish(t)}.bind(this),m=0;m<i.length;m++){var f=i[m];if(""!=f){var p="";if(d&&(0==m?p=d.up_action_name:1==m&&(p=d.down_action_name),""==p&&(p=PlayerAction.action)),""!=p){var g=r.addBattleEfffect(_[m],a,s,f,p);0==n&&r.addSceneBuffEffect(e.group,l,f,g),this.actStart(e);var v=null;h||(h=!0,v=function(){o&&o()}.bind(this)),e.in_area_effect=!0;var b=this.setAnimaWithEventFinish(e,p,v,u,g,!n);g.runAction(b)}}}},setAnimaWithEventFinish:function(e,i,s,n,a,o){var l=t("battle_controller").getInstance().getModel();return cc.callFunc(function(){var t=null;s&&(t=function(t){"hit"==t||"Hit"==t||"HIT"==t?a.hit_time<a.hit_num&&s&&(s(),a.hit_time+=1,e.in_area_effect&&(e.area_hit_time=a.hit_time)):"hit_none"==t?l.actHurt(e):"hit_big"==t?l.actHurt(e,!0):"shake_point"==t||t.indexOf("hit_num")}),a.hit_time=0,a.hit_num=1,a.setAnimationActionFunc(t,function(t){t==i&&(a.hit_time<a.hit_num&&s&&(s(),a.hit_time+=1,e.in_area_effect&&(e.area_hit_time=a.hit_time)),n&&n(e,a,o))},i),a.playActionOnce(i,null,o)})},hurt:function(t,e,i,s){if(null!=t&&null!=e){null!=i&&""!=i||(i=PlayerAction.hurt),null==s&&(s=!0);var n=.2,a=18*e.obj_type;e.in_hurt_act=!0,1==s&&""!=t.hit_sound&&1==t.is_real&&Utils.playEffectSound(AUDIO_TYPE.BATTLE,t.hit_sound);e.setAnimationActionFunc(null,function(t){t==i&&(e.in_hurt_act=!1,e.checkIsDied())},i);var o=cc.callFunc(function(){1==e.in_hurt_act&&e.playActionOnce(i,null,!1)}),l=cc.moveBy(.02,-a,0),r=(n=cc.delayTime(n),cc.moveBy(.05,a,0)),c=cc.callFunc(function(){e.is_hurt_play=!1}),_=cc.sequence(o,l,n,r,c);e.runAction(_)}},effectSpineUser:function(t,e,i,s,n,a,o,l,r,c){var _=this;if(null!=n&&0!=n.length&&null!=r){a=a||t;var h=[99,-999],d=!1;s||(s=60),s=s*t.model_height*.01;for(var u=Config.skill_data.data_get_effect_data[r],m=function(o){var r=n[o];if(""!=r){var m="";u&&(0==o?m=u.up_action_name:1==o&&(m=u.down_action_name),""==m&&(m=PlayerAction.action),""!=m&&(0==o||(s=0,d=!0),(p=a.addBattleEfffect(i,s,r,m,o,c))&&(g=p.object,v=cc.callFunc(function(){l&&l()}),b=function(){1==e&&a.delBattleEffect(r,m)},w=a.getLocalZOrder()+h[o],1==u.is_fornt&&(w=t.getLocalZOrder()-999,d=!0),0==d&&t.setLocalZOrder(w),y=_.setAnimaWithEventFinish(t,m,null,b,g,!e),g.runAction(cc.sequence(v,y)))))}},f=0;f<n.length;f++){var p,g,v,b,w,y;m(f)}}},dt:function(t){return cc.delayTime(t/60*2)},changeRotation:function(t,e){var i=t.scene_pos,s=i.x-e.x,n=i.y-e.y,a=-Math.atan(n/s)*(180/Math.PI);t.setRotation(a)},setNotAnimationWithEvent:function(t,e){return cc.callFunc(function(){e&&e(),this.actFinish(t)}.bind(this))},aid_hurt:function(t,e,i){var s=function(){e.is_die||e.resetBaseInfo(),e.in_act=!1,this.actFinish(t)}.bind(this);e.runAction(cc.sequence(cc.callFunc(function(){this.setAnimation(e,i,!1)}.bind(this)),cc.delayTime(.3),cc.callFunc(function(){s()}.bind(this))))},noActAttack:function(t,e,i,s,n){var a=null;return null!=s&&(a=cc.callFunc(function(){s()}.bind(this))),this.actStart(t),null==a?this.addDelay(t,e,this.setNotAnimationWithEvent(t,i),n):this.addDelay(t,e,cc.sequence(a,this.setNotAnimationWithEvent(t,i)),n)},flyItem:function(e,i,s,n,a,o,l,r,c,_,h){if(null!=e&&null!=s&&""!=s){var d=Config.skill_data.data_get_effect_data[c];if(null!=d){var u=t("battle_controller").getInstance().getModel(),m=u.getBattleScene();if(null!=m){var f=m.getBattleRoleLayer(),p=PlayerAction.action;""!=d.up_action_name&&(p=d.up_action_name);var g=this.dt(i),v=cc.callFunc(function(){this.actStart(e);var t=e.scene_pos,i=cc.v2(t.x,t.y+o),r=u.addBattleEfffect(f,i,e.obj_type,s,p);r.playActionOnce(p,null,!0);var c=cc.callFunc(function(){e.in_area_effect=!0}.bind(this)),h=cc.callFunc(function(){a&&a()}.bind(this)),d=cc.callFunc(function(){e.in_area_effect=null,this.actFinish(e),u.delBattleEffect(r)}.bind(this)),m=(l.y-i.y)*Math.abs(_)/(l.x-t.x-_)*e.obj_type,g=cc.v2(l.x+_,l.y-m),v=cc.moveTo(n/60,g),b=cc.callFunc(function(){r.setLocalZOrder(720+l.y+999),this.changeRotation(r,g)}.bind(this));r.runAction(cc.sequence(c,b,v,h,d))}.bind(this));return cc.sequence(g,v)}}}},fadeOut:function(t,e,i){var s=i/30,n=cc.fadeOut(s);return this.addDelay(t,e,n)},fadeIn:function(t,e,i){var s=i/30,n=cc.fadeIn(s);return this.addDelay(t,e,n)},hideUI:function(t,e){var i=cc.callFunc(function(){t.showHpRoot(!1)}.bind(this));return this.addDelay(t,e,i)},showUI:function(t,e){var i=cc.callFunc(function(){t.showHpRoot(!0)}.bind(this));return this.addDelay(t,e,i)},playBuffAbsorbHurt:function(t,e){this.playDmgMessage(t,e,null,!1,0,!0)},playDmgMessage:function(e,i,s,n,a,o){if(0!=i&&null!=e){var l=0;l=2==s?7:1==o?25:i>0?2:1==n?24:1==a?27:4,t("battle_controller").getInstance().getModel().getDmgFontCacheObject(l,function(t,e){this.playDmgFontAction(l,t,e,i)}.bind(this,e))}},playDmgFontAction:function(t,e,i,s){if(null!=e&&null!=e.role){null==e.hurt_delay&&(e.hurt_delay=0);var n=e.hurt_delay%3/5;e.hurt_delay+=1;var a=ViewManager.getInstance().getSceneNode(SCENE_TAG.battle),o=this.getDmgNode(t);if(null!=o){a.addChild(o,10);var l=e.role.convertToWorldSpaceAR(cc.v2(0,0)),r=a.convertToNodeSpaceAR(l),c=o.getChildByName("title"),_=c.getComponent(cc.Sprite);_.atlas=i,_.spriteFrame=7==t||25==t?i.getSpriteFrame("type"+t+"_extend"):s<0?i.getSpriteFrame("type"+t+"_sub"):i.getSpriteFrame("type"+t+"_add");var h=o.getChildByName("label"),d=h.getComponent(cc.RichText);d.imageAtlas=i;for(var u=Math.abs(s)+"",m="",f=0;f<u.length;f++){var p=u[f];"+"==p?p="add":"-"==p&&(p="sub"),m+=cc.js.formatStr("<img src='type%s_%s'/>",t,p)}d.string=m;var g=h.width;c&&(g+=c.width,h.x=c.width),o.x=r.x-.5*g-.5*SCREEN_WIDTH,o.y=r.y+e.model_height+15*e.dmg_index-.5*SCREEN_HEIGHT,o.scale=.5;var v=cc.delayTime(n),b=cc.fadeIn(.01),w=cc.scaleTo(.01*Config.battle_act_data.data_get_act_data.hurt_num_scale_time1.val/60,.01*Config.battle_act_data.data_get_act_data.hurt_num_bigger.val*.5),y=cc.scaleTo(.01*Config.battle_act_data.data_get_act_data.hurt_num_scale_time2.val/60,.01*Config.battle_act_data.data_get_act_data.hurt_num_bigger2.val),C=cc.scaleTo(.01*Config.battle_act_data.data_get_act_data.hurt_num_scale_time3.val/60,.01*Config.battle_act_data.data_get_act_data.hurt_num_smaller.val),k=cc.scaleTo(.01*Config.battle_act_data.data_get_act_data.hurt_num_scale_time4.val/60,.01*Config.battle_act_data.data_get_act_data.hurt_num_bigger3.val),S=cc.delayTime(.01*Config.battle_act_data.data_get_act_data.hurt_num_delay_time.val/60),T=cc.moveBy(.01*Config.battle_act_data.data_get_act_data.hurt_num_move_time.val/60,0,.01*Config.battle_act_data.data_get_act_data.hurt_num_move_distance.val),I=cc.fadeOut(.02*Config.battle_act_data.data_get_act_data.hurt_num_hide_time.val/60),E=cc.callFunc(function(){this.pushBackDmgNode(t,o)}.bind(this)),B=cc.sequence(w,y,C,k,S,cc.spawn(T,I));o.runAction(cc.sequence(v,b,B,E))}}},getDmgNode:function(e){var i=t("battle_role_pool").getInstance().getDmgPools(e),s=null;if(i.size()>0)s=i.get();else{(s=new cc.Node).setAnchorPoint(.5,.5);var n=new cc.Node;n.setAnchorPoint(0,.5),n.name="title",s.addChild(n),n.addComponent(cc.Sprite);var a=new cc.Node;a.setAnchorPoint(0,.5),a.name="label",s.addChild(a);var o=a.addComponent(cc.RichText);o.lineHeight=30,o.fontSize=30}return s},pushBackDmgNode:function(e,i){t("battle_role_pool").getInstance().pushBackDmgPools(e,i)},blackScreen:function(t,e,i,s,n){var a=cc.sequence(cc.callFunc(s),cc.delayTime(i/60),cc.callFunc(n));return cc.sequence(this.dt(e),a)}};e.exports=s,cc._RF.pop()},{battle_controller:"battle_controller",battle_role_pool:"battle_role_pool"}],skill_item:[function(t,e,i){"use strict";cc._RF.push(e,"3c83dYQ0qxEqaYP0hNsEWJ0","skill_item");var s=t("tips_controller");cc.Class({extends:ViewClass,ctor:function(){this.prefabPath=PathTool.getPrefabPath("hero","skill_item"),this.initRootWnd(),this.data=null,this.position=null,this.sp_state=null,this.visible=!0,this.is_show_tips=null,this.bg_status=!0,this.btn_status=!0},initRootWnd:function(){this.prefabPath&&LoaderManager.getInstance().loadRes(this.prefabPath,function(t){this.root_wnd=t,this.scale&&this.setScale(this.scale),this.parent&&this.parent.addChild(this.root_wnd),this.position&&(this.root_wnd.position=this.position),this.initWidget(),this.root_wnd.active=this.visible,this.data&&this.setData(this.data),null!=this.lev_status&&this.setLeveStatus(this.lev_status),null!=this.recommondStatus&&this.showRecommondIcon(this.recommondStatus.bool,this.recommondStatus.qian_type),null!=this.bottomName&&this.showName(this.bottomName.bool,this.bottomName.name,this.bottomName.pos,this.bottomName.fontSize,this.bottomName.is_bg),this.showBG(this.bg_status)}.bind(this))},initWidget:function(){this.background_sp=this.seekChild("background",cc.Sprite),this.skill_icon_sp=this.seekChild("skill_icon",cc.Sprite),this.level_bg_sp=this.seekChild("level_bg",cc.Sprite),this.level_lb=this.seekChild("level",cc.Label),this.btn=this.root_wnd.getComponent(cc.Button),this.registerEvent()},setData:function(t){t||this.root_wnd&&(this.skill_icon_sp.node.active=!1),this.data=t,this.root_wnd&&(this.updateWidget(),this.spriteUnabled(),this.buttonEnabled())},setPosition:function(t,e){var i;void 0===e?(i=t.x,e=t.y):i=t;var s=cc.v2(i,e);this.position=s,this.root_wnd&&(this.root_wnd.position=s)},setScale:function(t){this.scale=t,this.root_wnd&&(this.root_wnd.scale=t)},setShowTips:function(t){this.is_show_tips=t||!1},updateWidget:function(){if(this.skill_config=gdata("skill_data","data_get_skill",this.data),this.skill_config){var t=PathTool.getIconPath("skillicon",this.skill_config.icon);this.loadRes(t,function(t){this.root_wnd&&this.root_wnd.isValid&&(this.skill_icon_sp.spriteFrame=t)}.bind(this)),this.skill_icon_sp.node.active=!0,this.level_lb.string=this.skill_config.level,this.upateStatu()}},addCallBack:function(t){this.callback=t},setVisible:function(t){this.visible=t,this.root_wnd&&(this.root_wnd.active=t)},upateStatu:function(){null!==this.sp_state&&(this.background_sp.setState(this.sp_state),this.skill_icon_sp.setState(this.sp_state),this.level_bg_sp.setState(this.sp_state),this.sp_state=null)},setLeveStatus:function(t){this.lev_status=t,this.root_wnd&&(this.level_lb.node.active=t,this.level_bg_sp.node.active=t)},showUnEnabled:function(t){this.is_unabled=t},spriteUnabled:function(){this.is_unabled?(this.background_sp.setMaterial(0,cc.Material.getBuiltinMaterial("2d-gray-sprite")),this.skill_icon_sp.setMaterial(0,cc.Material.getBuiltinMaterial("2d-gray-sprite")),this.level_bg_sp.setMaterial(0,cc.Material.getBuiltinMaterial("2d-gray-sprite"))):(this.background_sp.setMaterial(0,cc.Material.getBuiltinMaterial("2d-sprite")),this.skill_icon_sp.setMaterial(0,cc.Material.getBuiltinMaterial("2d-sprite")),this.level_bg_sp.setMaterial(0,cc.Material.getBuiltinMaterial("2d-sprite")))},registerEvent:function(){this.root_wnd&&this.root_wnd.on("click",function(t){this.is_show_tips&&this.skill_config&&s.getInstance().showSkillTips(this.skill_config,this.is_unabled||!1,!1,self.tips_hide_flag),this.callback&&this.callback()},this)},showBG:function(t){this.bg_status=t,this.root_wnd&&(this.bg_status?this.background_sp.node.active=!0:this.background_sp.node.active=!1)},buttonEnabled:function(){this.btn.enabled=this.btn_status},showRecommondIcon:function(t,e){var i,s;(this.recommondStatus={bool:t,qian_type:e},null!=this.root_wnd)&&(0==t&&null==this.recommond_icon_sp||(this.recommond_icon_sp||(this.recommond_icon_sp=Utils.createImage(this.root_wnd,null,-30,27.5,cc.v2(.5,.5),!0,10,!0),this.recommond_lb=Utils.createLabel(18,new cc.Color(255,255,255),new cc.Color(10,15,15),-11.1,12.8,"",this.recommond_icon_sp.node,2,cc.v2(.5,.5)),this.recommond_lb.node.setRotation(-45),this.recommond_icon_sp.node.setContentSize(74,72)),1==t?(this.recommond_icon_sp.node.active=!0,1==(e=e||1)?(i=Utils.TI18N("\u63a8\u8350"),s=PathTool.getUIIconPath("common","common_30016"),this.recommond_lb.node.getComponent(cc.LabelOutline).color.fromHEX("#5C1B77")):2==e?(i=Utils.TI18N("\u5df2\u9886\u609f"),s=PathTool.getUIIconPath("common","common_30013"),this.recommond_lb.node.getComponent(cc.LabelOutline).color.fromHEX("#8E2B00")):5==e?(i=Utils.TI18N("\u53ef\u9886\u609f"),s=PathTool.getUIIconPath("common","common_30015"),this.recommond_lb.node.getComponent(cc.LabelOutline).color.fromHEX("#0055A6")):this.recommond_icon.active=!1,this.loadRes(s,function(t){this.recommond_icon_sp.spriteFrame=t}.bind(this)),this.recommond_lb.string=i):this.recommond_icon_sp.node.active=!1))},showName:function(t,e,i,s,n){if(this.bottomName={bool:t,name:e,pos:i,fontSize:s,is_bg:n},null!=this.root_wnd){if(0!=t||this.name){if(!this.name){if(n&&null==this.name_bg){var a=PathTool.getUIIconPath("common","common_2028");this.name_bg=Utils.createImage(this.root_wnd,null,0,-75,cc.v2(.5,.5),!0,0,!0),this.name_bg.node.setContentSize(108,30),this.loadRes(a,function(t){this.name_bg.spriteFrame=t}.bind(this))}s=s||24,this.name=Utils.createLabel(s,new cc.Color(118,69,25),null,0,-75,"",this.root_wnd,1,cc.v2(.5,.5))}e=e||"",this.name.string=e,this.name.node.active=t,i&&this.name.node.setPosition(i)}}},setSelected:function(t){var e=this;if(null!=e.root_wnd&&(e.select_bg||0!=t)){if(!e.select_bg){var i=PathTool.getSelectBg();e.select_bg=Utils.createImage(e.root_wnd,null,0,0,cc.v2(.5,.5),!0,null,!0),this.loadRes(i,function(t){e.select_bg.spriteFrame=t}.bind(this)),e.select_bg.node.setContentSize(e.root_wnd.getContentSize())}e.select_bg.node.active=t}}});cc._RF.pop()},{tips_controller:"tips_controller"}],skill_tips_window:[function(t,e,i){"use strict";cc._RF.push(e,"b601dVzkfxIrZtwSOKV5K3D","skill_tips_window");var s=t("pathtool"),n=t("tips_const");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("tips","skill_tips"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Full},initConfig:function(){this.tips_controller=t("tips_controller").getInstance()},openCallBack:function(){this.background=this.root_wnd.getChildByName("background"),this.main_panel=this.root_wnd.getChildByName("main_panel"),this.container=this.main_panel.getChildByName("container"),this.container_init_size=this.container.getContentSize(),this.base_panel=this.container.getChildByName("base_panel"),this.base_panel_height=this.base_panel.getContentSize().height,this.skill_icon_sp=this.base_panel.getChildByName("skill_icon").getComponent(cc.Sprite),this.skill_name_lb=this.base_panel.getChildByName("name").getComponent(cc.Label),this.skill_type_lb=this.base_panel.getChildByName("skill_type").getComponent(cc.Label),this.line=this.container.getChildByName("line"),this.line_2=this.container.getChildByName("line2"),this.skill_desc_lb=this.container.getChildByName("desc").getComponent(cc.Label),this.extend_desc_rt=this.container.getChildByName("extend_desc").getComponent(cc.RichText),this.buff_desc_rt=this.container.getChildByName("buff_desc").getComponent(cc.RichText),this.next_skill_rt=this.container.getChildByName("next_skill_txt").getComponent(cc.RichText)},registerEvent:function(){this.background.on("touchend",function(t){Utils.playButtonSound(2),this.tips_controller.closeTIpsByType(n.type.SKILL)}.bind(this))},openRootWnd:function(t){this.updateVo(t.skill_vo,t.is_lock,t.not_show_next,t.hide_flag)},updateVo:function(t,e,i,n){this.skill_vo=t;var a=t.level||1;this.skill_name_lb.string=n?t.name:t.name+"  Lv."+a,this.loadRes(s.getIconPath("skillicon",t.icon),function(t){this.skill_icon_sp.spriteFrame=t}.bind(this)),this.skill_type_lb.node.active=!0,"active_skill"==t.type?this.skill_type_lb.string="\u7c7b\u578b\uff1a\u4e3b\u52a8\u6280\u80fd":this.skill_type_lb.string="\u7c7b\u578b\uff1a\u88ab\u52a8\u6280\u80fd";var o=4+this.base_panel_height,l=0;""!=this.skill_vo.des&&(this.skill_desc_lb.string=this.skill_vo.des,this.skill_desc_lb._forceUpdateRenderData(),o=o+(l=this.skill_desc_lb.node.getContentSize().height)+2);var r=0;if(!n){var c="";c=0==this.skill_vo.cd?"<color=#ffeedd>\u65e0\u51b7\u5374\u65f6\u95f4</color>":"<color=#ffeedd>\u51b7\u5374</c><color=#14ff32>"+this.skill_vo.cd+"</c><color=#ffeedd>\u56de\u5408</c>",0!=this.skill_vo.fire_cd&&(c+="<color=#ffeedd>\uff0c\u7b2c</c><color=#14ff32>"+this.skill_vo.fire_cd+"</c><color=#ffeedd>\u56de\u5408\u91ca\u653e</color>"),this.extend_desc_rt.string=c,r=this.extend_desc_rt.node.getContentSize().height}o=o+r+18;var _="",h=0;if(this.skill_vo.buff_des&&this.skill_vo.buff_des[0]&&Utils.next(this.skill_vo.buff_des[0])){this.line.active=!0;for(var d=Config.skill_data.data_get_buff,u=0;u<this.skill_vo.buff_des[0].length;++u){var m=d[this.skill_vo.buff_des[0][u]];0!=u&&(_+="<br/>"),m&&(_+="<color=#ffeedd>\u3010"+m.name+"\u3011</c><br/><color=#A1978B>"+m.desc+"</color> ")}}if(""!=_&&(this.buff_desc_rt.string=_,h=this.buff_desc_rt.node.getContentSize().height,o=o+this.buff_desc_rt.node.getContentSize().height+10),""!=this.skill_vo.open_desc&&!i&&!n){this.line_2.active=!0;var f="";f=e?StringUtil.parse(this.skill_vo.open_desc):0==this.skill_vo.next_id?"\u6280\u80fd\u5df2\u6ee1\u7ea7":StringUtil.parse(this.skill_vo.skill_desc),this.next_skill_rt.string=f,o=o+this.next_skill_rt.node.getContentSize().height+25}o+=20,this.container.setContentSize(cc.size(this.container_init_size.width,o)),this.base_panel.y=-4,this.skill_desc_lb.node.y=this.base_panel.y-this.base_panel.height-2,this.extend_desc_rt.node.y=this.skill_desc_lb.node.y-this.skill_desc_lb.node.height-18,this.line.active&&(this.line.y=-30-this.base_panel_height-l-r),""!=_&&(this.buff_desc_rt.node.y=-38-this.base_panel_height-l-r),this.line_2.active&&(this.line_2.y=-44-this.base_panel_height-l-r-h),""!=this.next_skill_rt.string&&(this.next_skill_rt.node.y=-52-this.base_panel_height-l-r-h)},closeCallBack:function(){this.tips_controller.closeTIpsByType(n.type.SKILL)}});cc._RF.pop()},{pathtool:"pathtool",tips_const:"tips_const",tips_controller:"tips_controller"}],skill_unlock_window:[function(t,e,i){"use strict";cc._RF.push(e,"61526lYdG1CA6UGrWiNxzrq","skill_unlock_window");var s=t("pathtool"),n=t("hero_controller");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("hero","skill_unlock"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Mini,this.skill_bid=arguments[0]||0,this.is_can_close=!1,this.ctrl=n.getInstance()},initConfig:function(){},openCallBack:function(){this.background=this.root_wnd.getChildByName("background"),this.main_panel=this.root_wnd.getChildByName("main_container"),this.star_name=this.main_panel.getChildByName("star_name").getComponent(cc.Label),this.star_desc=this.main_panel.getChildByName("star_desc").getComponent(cc.Label),this.effect_sk=this.main_panel.getChildByName("action").getComponent(sp.Skeleton),this.createDesc(),this.updateDesc()},registerEvent:function(){this.background.on("touchend",function(){Utils.playButtonSound(2),1==this.is_can_close&&this.ctrl.openSkillUnlockWindow(!1)},this)},createDesc:function(){var e=t("skill_item");this.skill_item=new e,this.skill_item.setPosition(cc.v2(0,45)),this.skill_item.setParent(this.main_panel)},updateDesc:function(){if(0!=this.skill_bid){var t=gdata("skill_data","data_get_skill",this.skill_bid);if(t){var e=t.des||"";this.star_desc.string=e,this.star_desc._forceUpdateRenderData(),this.star_desc.node.getContentSize().height>22&&(this.star_desc.horizontalAlign=cc.macro.TextAlignment.LEFT);var i=t.name||"";this.star_name.string=i,this.skill_item.setLeveStatus(!1),this.skill_item.btn_status=!1,this.skill_item.setData(this.skill_bid),this.background.runAction(cc.sequence(cc.delayTime(1),cc.callFunc(function(){this.is_can_close=!0},this)))}}},openRootWnd:function(t){Utils.playButtonSound("c_get"),this.handleEffect()},handleEffect:function(){var t=s.getSpinePath("E51003","action");this.loadRes(t,function(t){this.effect_sk.skeletonData=t,this.effect_sk.setAnimation(0,"action",!0)}.bind(this))},closeCallBack:function(){this.skill_item&&this.skill_item.deleteMe(),this.ctrl.openSkillUnlockWindow(!1)}});cc._RF.pop()},{hero_controller:"hero_controller",pathtool:"pathtool",skill_item:"skill_item"}],soundmanager:[function(t,e,i){"use strict";cc._RF.push(e,"03fc8rWMcFCwa4YduIk1BBp","soundmanager");var s=t("pathtool"),n=t("loadermanager");window.AUDIO_TYPE={COMMON:"common",SCENE:"scene",BATTLE:"battle",DUBBING:"dubbing",Recruit:"recruit",Drama:"drama"},window.SoundManager=cc.Class({extends:cc.Component,properties:{effects:{default:{}},_cur_bg_music:{default:{}},hero_effects:{default:{}}},statics:{instance:null},ctor:function(){this.registerEvent(),this.initSoundSetting()},initSoundSetting:function(){this.music_status="1"==gcore.SysEnv.get("music_status","1"),this.sound_status="1"==gcore.SysEnv.get("sound_status","1"),this.voice_status="1"==gcore.SysEnv.get("voice_status","1")},registerEvent:function(){gcore.GlobalEvent.bind(EventId.VOICE_SETTING,function(t){t&&this.upateSetting(t)}.bind(this))},upateSetting:function(t){if("music_status"==t)(e="1"==gcore.SysEnv.get("music_status","1"))!=this.music_status&&(this.music_status=e,e?this.music_info&&this.playMusic(this.music_info.type,this.music_info.name,this.music_info.loop):this._cur_bg_music&&(this._audio&&this._audio.stop(),n.getInstance().releaseRes(this._cur_bg_music.res_path),this._cur_bg_music=null));else if("sound_status"==t){(e="1"==gcore.SysEnv.get("sound_status","1"))!=this.sound_status&&(this.sound_status=e)}else if("voice_status"==t)var e="1"==gcore.SysEnv.get("voice_status","1")},play:function(t,e){t.type==cc.Node.EventType.TOUCH_END&&(e=e||"c_button1")&&this.playEffect(AUDIO_TYPE.COMMON,e)},playEffect:function(t,e){if(this.sound_status)if(this.effects[e])cc.audioEngine.playEffect(this.effects[e],!1);else{var i=s.getSoundRes(t,e);n.getInstance().loadRes(i,function(t,e){e&&(e.name==t&&(this.effects[t]=e),cc.audioEngine.playEffect(e,!1))}.bind(this,e))}},playEffectOnce:function(t,e){if(this.sound_status){var i=s.getSoundRes(t,e);n.getInstance().loadRes(i,function(t,e){if(e){var i=cc.audioEngine.playEffect(e,!1);cc.audioEngine.setFinishCallback(i,this.finishPlayMusic.bind(this,t,i,e))}}.bind(this,i))}},finishPlayMusic:function(t,e,i){cc.audioEngine.stop(e),cc.audioEngine.uncache(i),n.getInstance().releaseRes(t)},playHeroEffectOnce:function(t,e){if(this.sound_status){if(this.hero_effects[e])return cc.audioEngine.playEffect(this.hero_effects[e],!1);var i=s.getSoundRes(t,e);n.getInstance().loadRes(i,function(t,i){if(i){i.name==e&&(this.hero_effects[e]=i);var s=cc.audioEngine.playEffect(i,!1);this.hero_id=s,cc.audioEngine.setFinishCallback(s,this.finishHeroPlayMusic.bind(this,t,s,i))}}.bind(this,i))}},removeEffectSound:function(t){null==(t=t||this.hero_id)?cc.audioEngine.stopAll():cc.audioEngine.stop(t)},finishHeroPlayMusic:function(t,e,i){gcore.Timer.set(function(){cc.audioEngine.stop(e),cc.audioEngine.uncache(i),n.getInstance().releaseRes(t),this.hero_effects[i.name]=null}.bind(this),1e4,1)},playMusic:function(t,e,i){var a=s.getSoundRes(t,e);this._cur_bg_music&&this._cur_bg_music.res_path==a||(this.music_info={type:t,name:e,loop:i},this.music_status&&n.getInstance().loadRes(a,function(t,e,i){if((!this._cur_bg_music||t!=this._cur_bg_music.res_path)&&(cc.log(t,this.music_info.name,"sound_path"),i)){this._cur_bg_music&&window.AudioSourceUi&&(AudioSourceUi.stop(),n.getInstance().releaseRes(this._cur_bg_music.res_path)),window.AudioSourceUi||(window.AudioSourceUi=cc.find("Canvas/game_views").addComponent(cc.AudioSource));var s=AudioSourceUi;s.clip=i,s.loop=e,s.play(),this._audio=s;var a={};a.res_path=t,a.res_obj=i,this._cur_bg_music=a}}.bind(this,a,i)))},getBackgroundVolume:function(){if(this._audio)return this._audio.volume},setBackgroundVolume:function(t){this._audio&&(this._audio.volume=t)},start:function(){}}),SoundManager.getInstance=function(){return SoundManager.instance||(SoundManager.instance=new SoundManager),SoundManager.instance},e.exports=SoundManager,cc._RF.pop()},{loadermanager:"loadermanager",pathtool:"pathtool"}],source_item:[function(t,e,i){"use strict";cc._RF.push(e,"614d04ihr9CWoQAgqUAGkv7","source_item");cc.Class({extends:ViewClass,ctor:function(){this.parent=arguments[0],this.bid=arguments[1],this.need_item_list=arguments[2],this.prefabPath=PathTool.getPrefabPath("tips","source_item"),this.createRootWind()},createRootWind:function(){LoaderManager.getInstance().loadRes(this.prefabPath,function(t){this.root_wnd=t,this.root_wnd.parent=this.parent,this.initWidgets()}.bind(this))},initWidgets:function(){this.recom_tag_nd=this.seekChild("recom_tag"),this.desc_txt_lb=this.seekChild("desc_txt",cc.Label),this.goto_btn_nd=this.seekChild("goto_btn"),this.btn_title_lb=this.seekChild("btn_title",cc.Label),this.unlock_txt_nd=this.seekChild("unlock_txt"),this.unlock_txt_lb=this.seekChild("unlock_txt",cc.Label),this.goto_btn_nd.on(cc.Node.EventType.TOUCH_END,this.didClickGotoBtn,this),this.source_info&&this.updagetWidgets()},setData:function(t){this.source_info=t,this.root_wnd&&this.updagetWidgets()},updagetWidgets:function(){this.data=this.source_info.infon_data,this.desc_txt_lb.string=this.data.name,null!=this.source_info[1]&&(0==this.source_info[1]?this.recom_tag_nd.active=!1:this.recom_tag_nd.active=!0),this.btn_title_lb.string=Utils.TI18N(Lang.GOTO),this.unlock_txt_lb.string=Utils.TI18N(Lang.NO_OPEN),this.source_info.is_lock?(this.goto_btn_nd.active=!1,this.unlock_txt_nd.active=!0,this.unlock_txt_lb.string=this.source_info.des):(this.goto_btn_nd.active=!0,this.unlock_txt_nd.active=!1),this.root_wnd.y=-this.root_wnd.height*this.source_info.index},didClickGotoBtn:function(){var e=t("backpack_controller");this.close_callback?this.close_callback():e.getInstance().openTipsSource(!1),e.getInstance().gotoItemSources(this.data.evt_type,this.data.extend,this.bid,this.need_item_list),t("hero_controller").getInstance().openHeroBreakPanel(!1),t("hero_controller").getInstance().openArtifactListWindow(!1)}});cc._RF.pop()},{backpack_controller:"backpack_controller",hero_controller:"hero_controller"}],spine_loading_item:[function(t,e,i){"use strict";cc._RF.push(e,"1bb25BmGBJFCpbHBgOQTGGE","spine_loading_item");var s=function(t,e,i){this.anima_id=t,this.anima_name=e,this.finish_cb=[],this.finish_cb.push(i),this.load_finish=!1,this.startUpdate()},n=s.prototype;n.startUpdate=function(){if(H5_RES){var t=this.root_url=H5_RES+"spine/"+this.anima_id+"/",e=this.text_url=t+this.anima_name+".text",i=this.ske_url=t+this.anima_name+".skel",s=this.atlas_url=t+this.anima_name+".atlas";cc.loader.load({url:e,type:"txt"},function(e,n){if(!e){var a=this.texture_names=this.texture_names=JSON.parse(n).testures,o=[];for(var l in a){var r=t+a[l];cc.loader.load(r,function(t,e,n){e||(o.splice(t,0,n),o.length==a.length&&cc.loader.load({url:s,type:"txt"},function(t,e){cc.loader.load({url:i,type:"txt"},function(t,i){var s=this.asset=new sp.SkeletonData;if(s.skeletonJson=i,s.atlasText=e,s.textures=o,s.textureNames=a,this.load_finish=!0,this.finish_cb)for(var n in this.finish_cb)this.finish_cb[n](s)}.bind(this))}.bind(this)))}.bind(this,l))}}}.bind(this))}},n.release=function(){for(var t in this.texture_names){var e=this.root_url+this.texture_names[t];cc.loader.release(e)}cc.loader.release(this.text_url),cc.loader.release(this.ske_url),cc.loader.release(this.atlas_url),delete this.asset},n.addCallback=function(t){this.load_finish?t(this.asset):this.finish_cb.push(t)},e.exports=s,cc._RF.pop()},{}],star_tower_award_item_panel:[function(t,e,i){"use strict";cc._RF.push(e,"022895tOdlBy42TzL8et4Lt","star_tower_award_item_panel");var s=t("pathtool"),n=t("startower_controller"),a=t("common_scrollview");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("startower","star_tower_award_item"),this.ctrl=n.getInstance(),this.model=this.ctrl.getModel()},initConfig:function(){this.reward_list={},this.reward_data=Config.star_tower_data.data_get_floor_award},initPanel:function(){this.main_panel=this.root_wnd.getChildByName("main_panel"),this.sprite_get=this.main_panel.getChildByName("sprite_get"),this.sprite_get.active=!1,this.btn_goto=this.main_panel.getChildByName("btn_goto"),this.btn_goto.getChildByName("Text_4").getComponent(cc.Label).string=Utils.TI18N("\u524d\u5f80"),this.btn_get=this.main_panel.getChildByName("btn_get"),this.btn_get.active=!1,this.btn_get.getChildByName("Text_4").getComponent(cc.Label).string=Utils.TI18N("\u9886\u53d6"),this.good_cons=this.main_panel.getChildByName("good_cons"),this.text_floor=this.main_panel.getChildByName("text_floor").getComponent(cc.Label);var t=this.good_cons.getContentSize(),e={item_class:"backpack_item",start_x:0,space_x:0,start_y:10,space_y:0,item_width:.85*BackPackItem.Width,item_height:.85*BackPackItem.Height,row:1,col:0,scale:.85};this.item_scrollview=new a,this.item_scrollview.createScroll(this.good_cons,cc.v2(0,0),ScrollViewDir.horizontal,ScrollViewStartPos.top,t,e),this.item_scrollview.setClickEnabled(!1)},setData:function(t){if(t){var e=this.model.getRewardData(t.id-1);this.tower_data=e,this.main_panel&&this.updateData()}},updateData:function(){if(this.tower_data&&this.main_panel){this.sprite_get.active=2==this.tower_data.status,this.btn_get.active=1==this.tower_data.status,this.btn_goto.active=0==this.tower_data.status;var t=cc.js.formatStr(Utils.TI18N("\u901a\u8fc7%d\u5c42(%d/%d)"),this.reward_data[this.tower_data.id].tower,this.model.getNowTowerId(),this.reward_data[this.tower_data.id].tower);this.text_floor.string=t;var e=[];for(var i in this.reward_data[this.tower_data.id].award){var s={};s.bid=this.reward_data[this.tower_data.id].award[i][0],s.num=this.reward_data[this.tower_data.id].award[i][1],e.push(s)}this.item_scrollview.setData(e),this.item_scrollview.addEndCallBack(function(){var t=this.item_scrollview.getItemList();for(var e in t)t[e].setDefaultTip()}.bind(this))}},registerEvent:function(){this.btn_goto.on(cc.Node.EventType.TOUCH_END,function(){Utils.playButtonSound(ButtonSound.Normal),this.ctrl.openAwardWindow(!1)},this),this.btn_get.on(cc.Node.EventType.TOUCH_END,function(){Utils.playButtonSound(ButtonSound.Normal),this.ctrl.sender11328(this.tower_data.id)},this)},onShow:function(t){this.updateData()},onHide:function(){},onDelete:function(){this.item_scrollview&&(this.item_scrollview.deleteMe(),this.item_scrollview=null)}});cc._RF.pop()},{common_scrollview:"common_scrollview",pathtool:"pathtool",startower_controller:"startower_controller"}],star_tower_award_window:[function(t,e,i){"use strict";cc._RF.push(e,"66c4cMwBShHK6T0boMvYR8o","star_tower_award_window");var s=t("pathtool"),n=t("startower_event"),a=t("common_scrollview"),o=t("star_tower_award_item_panel");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("startower","star_tower_award"),this.viewTag=SCENE_TAG.ui,this.win_type=WinType.Big,this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){},openCallBack:function(){this.background=this.root_wnd.getChildByName("background"),this.background.scale=FIT_SCALE,this.main_panel=this.root_wnd.getChildByName("main_panel"),this.title=this.main_panel.getChildByName("title").getComponent(cc.Label),this.title.string=Utils.TI18N("\u5956\u52b1\u603b\u89c8"),this.close_btn=this.main_panel.getChildByName("close_btn"),this.title_icon=this.main_panel.getChildByName("title_icon").getComponent(cc.Sprite),this.loadRes(s.getBigBg("bigbg_71"),function(t){this.title_icon.spriteFrame=t}.bind(this)),this.updateAwardList()},registerEvent:function(){this.close_btn.on(cc.Node.EventType.TOUCH_END,function(){Utils.playButtonSound(ButtonSound.Close),this.ctrl.openAwardWindow(!1)},this),this.background.on(cc.Node.EventType.TOUCH_END,function(){Utils.playButtonSound(ButtonSound.Close),this.ctrl.openAwardWindow(!1)},this),this.addGlobalEvent(n.Update_Reward_Event,function(){if(this.list_view){var t=Config.star_tower_data.data_get_floor_award,e=[];for(var i in t)e.push(t[i]);this.list_view.setData(Utils.deepCopy(e))}}.bind(this))},openRootWnd:function(t){},updateAwardList:function(){var t=cc.size(620,585);if(!this.list_view){var e={item_class:o,start_x:0,space_x:0,start_y:0,space_y:0,item_width:620,item_height:173,row:1,col:1,need_dynamic:!0};this.list_view=new a,this.list_view.createScroll(this.main_panel,cc.v2(28,66),ScrollViewDir.vertical,ScrollViewStartPos.top,t,e,cc.v2(0,0))}var i=Config.star_tower_data.data_get_floor_award,s=[];for(var n in i)s.push(i[n]);this.list_view.setData(Utils.deepCopy(s))},closeCallBack:function(){this.list_view&&(this.list_view.deleteMe(),this.list_view=null),this.ctrl.openAwardWindow(!1)}});cc._RF.pop()},{common_scrollview:"common_scrollview",pathtool:"pathtool",star_tower_award_item_panel:"star_tower_award_item_panel",startower_event:"startower_event"}],star_tower_get_window:[function(t,e,i){"use strict";cc._RF.push(e,"e9f7duCOKJFep0xXdQIoLxz","star_tower_get_window");var s=t("pathtool");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("startower","star_tower_get"),this.viewTag=SCENE_TAG.ui,this.win_type=WinType.Mini,this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){this.tower=0},openCallBack:function(){this.background=this.root_wnd.getChildByName("background"),this.background.active=!0,this.background.scale=FIT_SCALE,this.main_panel=this.root_wnd.getChildByName("main_container"),this.ok_btn=this.main_panel.getChildByName("ok_btn"),this.ok_btn.getChildByName("Label").getComponent(cc.Label).string=Utils.TI18N("\u77e5\u9053\u4e86"),this.createDesc(),this.updateDesc()},registerEvent:function(){this.ok_btn.on(cc.Node.EventType.TOUCH_END,function(){Utils.playButtonSound(ButtonSound.Close),this.ctrl.openGetWindow(!1)},this)},createDesc:function(){this.main_panel.getContentSize(),gdata("color_data","data_color4",1),gdata("color_data","data_color4",9);this.star_name=Utils.createLabel(26,new cc.Color(139,71,21,255),null,this.main_panel.width/2,385,"",this.main_panel,2,cc.v2(.5,0)),this.star_desc=Utils.createRichLabel(26,new cc.Color(100,50,35,255),cc.v2(.5,1),cc.v2(this.main_panel.width/2,360),30,500),this.main_panel.addChild(this.star_desc.node)},updateDesc:function(){if(0!=this.tower){var t=Config.star_tower_data.data_award_list,e=null;for(var i in t){if(t[i].lev&&t[i].lev==this.tower)if(t[i].extend&&t[i].extend[0])e=gdata("item_data","data_get_data",t[i].extend[0])}if(e){this.head_icon||(this.head_icon=ItemsPool.getInstance().getItem("backpack_item"),this.head_icon.setParent(this.head_icon),this.head_icon.initConfig(!1,1.2,!1,!0),this.head_icon.show(),this.head_icon.setData(e));var s=e.desc||"";if(this.star_desc.string=s,e.eqm_set){var n=Config.star_data.data_star_name[e.eqm_set]||"";this.star_name.string=n}}}},openRootWnd:function(t){this.handleEffect(!0),this.tower=t},handleEffect:function(t){},closeCallBack:function(){this.ctrl.openGetWindow(!1),this.handleEffect(!1),this.head_icon&&(this.head_icon.onDelete(),this.head_icon=null)}});cc._RF.pop()},{pathtool:"pathtool"}],star_tower_item_panel:[function(t,e,i){"use strict";cc._RF.push(e,"bd66dbYinhHpoKANNMTsluW","star_tower_item_panel");var s=t("pathtool"),n=t("startower_controller"),a=t("battle_drama_controller");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("startower","star_tower_item"),this.ctrl=n.getInstance(),this.model=this.ctrl.getModel()},initConfig:function(){this.is_lock=!1,this.is_open_tower=!0,this.star_list={},this.config=Config.star_tower_data.data_tower_base,this.itemNum=6},initPanel:function(){this.main_panel=this.root_wnd.getChildByName("main_panel"),this.background=this.main_panel.getChildByName("bg"),this.select_bg=this.main_panel.getChildByName("select_bg"),this.select_bg.active=!1,this.tower_name=this.main_panel.getChildByName("name").getComponent(cc.Label),this.lock_icon=this.main_panel.getChildByName("lock"),this.pass_icon=this.main_panel.getChildByName("pass_icon"),this.pass_icon.active=!1,this._floorAward=this.main_panel.getChildByName("floorAward"),this._firstAward=this._floorAward.getChildByName("firstAward"),this._floorAward.active=!1,this.countVisible(!1),this.come_label=this.main_panel.getChildByName("Image_4"),this.come_label.active=!1},countVisible:function(t){var e=this.main_panel.getChildByName("countBG");e.active=t,this._textCount=e.getChildByName("textCount").getComponent(cc.Label),this._textCount.active=t,this._dianmond=e.getChildByName("dianmond"),this.loadRes(s.getItemRes(15),function(t){this._dianmond.getComponent(cc.Sprite).spriteFrame=t}.bind(this)),this._dianmond.active=!1},setData:function(t){if(t){var e=this.config[t];this.data=e,this.main_panel&&this.updateData()}},updateData:function(){if(this.main_panel&&null!=this.data){var t=this.data.name||"";this.tower_name.string=t,this.main_panel.name="guildsign_startower_"+this.data.lev,this.updateMessage()}},sweepCount:function(t){this.pass_icon.active=!1,this.countVisible(!1);var e=this.model.getNowTowerId()||0;if(t&&t.lev==e){var i=this.model.getTowerLessCount()||0,s=this.model.getBuyCount();if(i<=0)if(s>=0){this.countVisible(!0),this._dianmond.active=!0;var n=this.model.getBuyCount()||0;if(Config.star_tower_data.data_tower_buy[n+1]){var a=Config.star_tower_data.data_tower_buy[n+1].expend[0][1]||0,o=cc.js.formatStr(Utils.TI18N("   %d\u626b\u8361"),a);this._textCount.string=o}else this.countVisible(!1),this._dianmond.active=!1,this.pass_icon.active=!0}else this.countVisible(!1),this._dianmond.active=!1,this.pass_icon.active=!0;else{o=cc.js.formatStr(Utils.TI18N("\u53ef\u626b\u8361%d\u6b21"),i);this._textCount.string=o,this.countVisible(!0),this._dianmond.active=!1,this.pass_icon.active=!1}}t.lev!=e&&t.lev<e&&(this.pass_icon.active=!0);var l=e=this.model.getNowTowerId()||0;l=e+this.itemNum>=this.config.length?this.config.length:e+this.itemNum;var r=e;if(r=e+1>=this.config.length?this.config.length:e+1,this.data.lev>r&&this.data.lev<=l){var c=this.config[this.data.lev].item_show[0];if(c){var _=c[0];a=c[1];if(null==this.goods_item)(h=ItemsPool.getInstance().getItem("backpack_item")).setParent(this._floorAward),h.initConfig(null,.6,!1,!0),h.setPosition(62,51),h.show(),this.goods_item=h;var h=this.goods_item;this._firstAward.zIndex=10;var d={bid:_,num:a};h.setData(d),this._floorAward.active=!0}else this._floorAward.active=!1}else this._floorAward.active=!1},updateMessage:function(){if(this.data){var t=this.model.getNowTowerId()||0,e=!1;if(this.data.lev<=t&&(e=!0),this.is_pass=e,this.sweepCount(this.data),this.is_lock=this.data.lev>t+1,this.lock_icon.active=this.is_lock,this.come_label.active=!1,this.is_open_tower=!0,0==this.is_pass&&0==this.is_lock){var i=this.data.limit_dun_id||0,s=a.getInstance().getModel().getDramaData();if(0!=i&&s&&s.max_dun_id&&s.max_dun_id<i)return void(this.is_open_tower=!1);this.data.lev==t+1?(this.come_label.active=!0,this.setSelectStatus(!0)):this.setSelectStatus(!1)}else this.setSelectStatus(!1)}},registerEvent:function(){this.main_panel.on(cc.Node.EventType.TOUCH_END,function(){Utils.playButtonSound(ButtonSound.Normal),this.clickHandler()},this)},clickHandler:function(){this.call_fun&&this.call_fun(this.data)},addCallBack:function(t){this.call_fun=t},setSelectStatus:function(t){this.select_bg.active=t},setVisibleStatus:function(t){this.active=t},getData:function(){return this.data},onShow:function(t){this.updateData()},onHide:function(){},onDelete:function(){this.come_label,this.goods_item&&(this.goods_item.deleteMe(),this.goods_item=null)}});cc._RF.pop()},{battle_drama_controller:"battle_drama_controller",pathtool:"pathtool",startower_controller:"startower_controller"}],star_tower_list:[function(t,e,s){"use strict";cc._RF.push(e,"b5f7bxGxstOdZW8ILFgEQLI","star_tower_list");var n=t("loadermanager"),a=t("pathtool"),o=t("common_scrollview_single"),l=t("startower_controller"),r=t("role_controller"),c=t("playerhead");cc.Class({extends:BaseClass,ctor:function(){this.initConfig()},initConfig:function(){this.parent=null,this.prefabPath=a.getPrefabPath("startower","star_tower_scroll_view"),this.pos=cc.v2(0,0),this.dir=ScrollViewDir.vertical,this.start_pos=ScrollViewStartPos.bottom,this.size=cc.size(100,100),this.ap=cc.v2(.5,0),this.cellList=[],this.cacheList=[],this.activeCellIdx=[],this.selectCellIndex=1,this.handler={},this.start_x=325,this.space_x=0,this.start_y=185,this.space_y=0,this.item_width=300,this.item_height=120,this.col=1,this.bg_param=3},createScroll:function(t,e,i){this.parent=t,this.pos=e||cc.v2(0,0),this.size=i||cc.size(100,100),this.cacheMaxSize=(Math.ceil(this.size.height/(this.item_height+this.space_y))+1)*this.col,n.getInstance().loadRes(this.prefabPath,function(t){var e=t;this.createRootWnd(e)}.bind(this))},createRootWnd:function(t){this.root_wnd=t,this.scroll_view=t.getChildByName("ScrollView"),this.scroll_view_mask=this.scroll_view.getChildByName("view"),this.scroll_view_con=this.scroll_view_mask.getChildByName("content"),this.scroll_view.zIndex=2,this.root_wnd.setContentSize(this.size),this.root_wnd.setAnchorPoint(this.ap.x,this.ap.y),this.root_wnd.setPosition(this.pos),this.scroll_view.setContentSize(this.size),this.scroll_view_mask.setContentSize(this.size),this.scroll_view_con.setContentSize(this.size),this.arrow_btn=this.scroll_view_con.getChildByName("arrow_btn"),this.arrow_btn.active=!0,this.arrow_btn.zIndex=10;var e=r.getInstance().getRoleVo();this.head=new c,this.head.show(),this.head.setScale(.6),this.head.setPosition(47,0),this.head.setParent(this.arrow_btn),this.head.setHeadRes(e.face_id),this.scroll_view_compend=this.scroll_view.getComponent(cc.ScrollView),this.dir==ScrollViewDir.vertical?this.scroll_view_compend.vertical=!0:this.scroll_view_compend.horizontal=!0,this.container=this.scroll_view_con,this.parent&&this.parent.addChild(t),this.setInnerContainer(),this.updateBgList(),this.registerEvent(),null!=this.select_index&&this.reloadData(this.select_index)},registerEvent:function(){this.scroll_view_compend.node.on("scrolling",this.checkRectIntersectsRect,this),this.arrow_btn.on(cc.Node.EventType.TOUCH_END,function(){Utils.playButtonSound(ButtonSound.Normal),this.moveToArrowNewPosition()},this)},registerScriptHandlerSingle:function(t,e){this.handler[e]=t},numberOfCells:function(){if(this.handler[ScrollViewFuncType.NumberOfCells])return this.handler[ScrollViewFuncType.NumberOfCells]()},updateCellByIndex:function(t,e){this.handler[ScrollViewFuncType.UpdateCellByIndex]&&this.handler[ScrollViewFuncType.UpdateCellByIndex](t,e)},createNewCell:function(){if(this.handler[ScrollViewFuncType.CreateNewCell])return this.handler[ScrollViewFuncType.CreateNewCell](this.item_width,this.item_height)},onCellTouched:function(t,e){this.handler[ScrollViewFuncType.OnCellTouched]&&this.handler[ScrollViewFuncType.OnCellTouched](t,e)},setClickEnabled:function(t){this.scroll_view.setClickEnabled(t)},setSwallowTouches:function(t){this.scroll_view.setSwallowTouches(t)},checkRectIntersectsRect:function(t){this.dir==ScrollViewDir.vertical&&this.checkOverShowByVertical()},checkOverShowByVertical:function(){if(null!=this.cellList){var t=this.container.y;if(this.scroll_view_bg){var e=this.scroll_view_bg.getContainer();e&&(e.y=t/this.bg_param,this.scroll_view_bg.checkOverShowByVerticalBottom())}for(var i=-t,s=this.size.height+i,n=Math.ceil(this.cellList.length/this.col),a=n,o=n-1;o>=0;o--){var l=o*this.col;if(a=o,(_=this.cellList[l])&&_.y<=s)break}var r=1;if(i>0)for(var c=a;c>=0;c--){var _;l=c*this.col;if((_=this.cellList[l])&&_.y+this.item_height<i){r=c+1;break}}var h=this.numberOfCells();for(o=0;o<n;o++)if(o<=a&&o>=r)for(c=0;c<this.col;c++){l=o*this.col+c;this.activeCellIdx[l]||l<=h&&(this.updateCellAtIndex(l),this.activeCellIdx[l]=!0)}else for(c=0;c<this.col;c++){(l=o*this.col+c)<=h&&(this.activeCellIdx[l]=!1)}this.updateArrowPos(s,i)}},updateMove:function(t){var e=this.checkPosition(t.x,t.y),i=cc.moveTo(.1,e.x,e.y).easing(cc.easeBackOut());this.container.runAction(i)},jumpToMove:function(t,e,i){var s=this.checkPosition(t.x,t.y);e=e||1;var n=cc.moveTo.create(e,cc.v2(s.x,s.y));this.container.runAction(cc.sequence.create(n,cc.callFunc.create(function(){i&&i()})))},checkPosition:function(t,e){var i=this.container.x,s=this.container.y;return this.dir==ScrollViewDir.horizontal?i+=t:this.dir==ScrollViewDir.vertical&&(s+=e),i>0?i=0:i<this.size.width-this.container_size.width&&(i=this.size.width-this.container_size.width),s>0?s=0:s<this.size.height-this.container_size.height&&(s=this.size.height-this.container_size.height),cc.v2(i,s)},setInnerContainer:function(){if(this.root_wnd){var t=this.numberOfCells(),e=this.size.width,i=Math.ceil(t/this.col),s=i*this.item_height+2*this.start_y+(i-1)*this.space_y;s+=453,s=Math.max(s,this.size.height),this.container_size=cc.size(e,s),this.scroll_view_con&&this.scroll_view_con.setContentSize(this.container_size),this.start_pos==ScrollViewStartPos.bottom&&this.scroll_view_compend.scrollToBottom(0)}},resetCurrentItems:function(){for(var t in this.activeCellIdx)this.activeCellIdx[t]&&this.updateCellAtIndex(t)},resetItemByIndex:function(t){this.activeCellIdx[t]&&this.updateCellAtIndex(t)},getActiveCellList:function(){var t=[];for(var e in this.activeCellIdx)this.activeCellIdx[e]&&this.cellList[e]&&this.cellList[e].cell&&t.push(this.cellList[e].cell);return t},getCellByIndex:function(t){if(this.cellList[t]&&this.cellList[t].cell)return this.cellList[i].cell},getCellXYByIndex:function(t){},reloadData:function(t){if(null!=this.root_wnd){for(var e in this.cellList=[],this.activeCellIdx=[],this.cacheList)this.cacheList[e].setPosition(-1e4,0);var i=this.numberOfCells();if(0!=i){for(e=0;e<i;e++){var s=this.getCacheCellByIndex(e),o=this.cellList.length,l=this.getCellPosition(o),r={cell:s,x:l.x,y:l.y};this.cellList.push(r)}if(null==t)for(var c=this.cacheMaxSize-this.col,_=i<c&&i||c,h=0;h<_;h++)this.updateCellAtIndex(h),this.activeCellIdx[h]=!0;else this.selectCellByIndex(t);gcore.Timer.set(function(){null==this.bottom_bg&&(this.bottom_bg=Utils.createImage(this.container,null,this.start_x+.5*this.item_width-19,15,cc.v2(.5,0),!1,3,!1),n.getInstance().loadRes(a.getBigBg("bigbg_28"),function(t){this.bottom_bg.spriteFrame=t}.bind(this)))}.bind(this),1/cc.game.getFrameRate(),1),gcore.Timer.set(function(){if(null==this.top_bg){var t=this.cellList[i-1].y+this.item_height;this.top_bg=Utils.createImage(this.container,null,this.start_x+.5*this.item_width-10,t,cc.v2(.5,0),!1,3,!1),n.getInstance().loadRes(a.getBigBg("bigbg_29"),function(t){this.top_bg.spriteFrame=t,this.moveToArrowNewPosition()}.bind(this))}}.bind(this),2/cc.game.getFrameRate(),1),this.moveToArrowNewPosition(),gcore.Timer.set(function(){this.moveToArrowNewPosition()}.bind(this),3/cc.game.getFrameRate(),1)}}else this.select_index=t},jumpToMoveByY:function(t){if(t){var e=t-.5*this.size.height;e<0&&(e=0);var i=e/(this.container_size.height-this.size.height);i>1&&(i=1),1==i&&this.checkOverShowByVertical(),this.scroll_view_compend.scrollToPercentVertical(i,.5,!0)}},updateBgList:function(){if(null==this.scroll_view_bg){var t=this.container_size.height/this.bg_param,e=this.size;this.bg_max_count=Math.ceil(t/955)+1;var i={start_x:0,space_x:0,start_y:322,space_y:0,item_width:720*FIT_SCALE,item_height:955,row:0,col:1};this.scroll_view_bg=new o,this.scroll_view_bg.createScroll(this.root_wnd,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.bottom,e,i,cc.v2(.5,0)),this.scroll_view_bg.time_show_index=this.bg_max_count+1,this.scroll_view_bg.registerScriptHandlerSingle(this.createNewCellBg.bind(this),ScrollViewFuncType.CreateNewCell),this.scroll_view_bg.registerScriptHandlerSingle(this.numberOfCellsBg.bind(this),ScrollViewFuncType.NumberOfCells),this.scroll_view_bg.setClickEnabled(!1)}this.scroll_view_bg.reloadData()},createNewCellBg:function(){this.scroll_view_bg&&null==this.scroll_view_bottom_bg&&gcore.Timer.set(function(){if(null==this.scroll_view_bottom_bg){var t=this.scroll_view_bg.getContainer();this.scroll_view_bottom_bg=Utils.createImage(t,null,this.container_size.width/2,0,cc.v2(.5,0),!1,1,!1),this.scroll_view_bottom_bg.node.scaleX=2*FIT_SCALE,this.scroll_view_bottom_bg.node.scaleY=2,n.getInstance().loadRes(a.getBigBg("bigbg_27"),function(t){this.scroll_view_bottom_bg.spriteFrame=t}.bind(this))}}.bind(this),3/cc.game.getFrameRate(),1);var t=Utils.createImage(null,null,null,null,cc.v2(.5,.5),!1,0,!1);return t.node.scaleY=2,t.node.scaleX=2*FIT_SCALE,n.getInstance().loadRes(a.getBigBg("bigbg_36"),function(e){t.spriteFrame=e}.bind(this)),t.node},numberOfCellsBg:function(){return this.bg_max_count||0},moveToArrowNewPosition:function(){var t=l.getInstance().getModel().getNowTowerId()||0,e=this.cellList[t];e&&(this.jumpToMoveByY(e.y),this.setNowArrowPos())},setNowArrowPos:function(){if(this.arrow_btn){var t=l.getInstance().getModel().getNowTowerId()||0;t+=1;var e=this.numberOfCells();t>e&&(t=e);var i=this.cellList[t];if(i){var s=i.x+this.item_width-5,n=i.y+.5*this.item_height;this.arrow_height=n,this.arrow_btn.setPosition(s,n)}}},updateArrowPos:function(t,e){if(this.arrow_height){t-140<=this.arrow_height?this.arrow_btn.y=t-140:e+245>=this.arrow_height?this.arrow_btn.y=e+245:this.arrow_btn.y=this.arrow_height}},selectCellByIndex:function(t){var e,i=this.cacheMaxSize-this.col,s=this.numberOfCells();if(s<i)for(var n=0;n<s;n++)this.updateCellAtIndex(n),this.activeCellIdx[n]=!0;else(e=t<=1?0:this.cellList[t].y+this.item_height-.5*this.size.height)<0&&(e=0),this.container.y=-e,this.checkOverShowByVertical()},getCellPosition:function(t){var e=cc.v2(0,0);return{x:this.start_x+this.item_width*e.x+(this.item_width+this.space_x)*((t-1)%this.col),y:this.start_y+this.item_height*e.y+Math.floor((t-1)/this.col)*(this.item_height+this.space_y)}},getCacheCellByIndex:function(t){var e=t%this.cacheMaxSize;if(this.cacheList[e])return this.cacheList[e];var i=this.createNewCell();return i&&(i.setAnchorPoint(0,0),i.setPosition(-1e4,0),this.cacheList[e]=i,i.setParent(this.container)),i},updateCellAtIndex:function(t){if(this.cellList[t]){var e=this.cellList[t];e.cell.setPosition(e.x,e.y),this.updateCellByIndex(e.cell,t)}},getMaxSize:function(){return this.container_size},getContainer:function(){return this.container},deleteMe:function(){this.DeleteMe()},DeleteMe:function(){for(var t in this.head&&(this.head.deleteMe(),this.head=null),this.cacheList)this.cacheList[t].onDelete&&this.cacheList[t].onDelete();this.scroll_view_bg&&(this.scroll_view_bg.deleteMe(),this.scroll_view_bg=null),this.cellList=null,this.activeCellIdx=null,this.cacheList=null}});cc._RF.pop()},{common_scrollview_single:"common_scrollview_single",loadermanager:"loadermanager",pathtool:"pathtool",playerhead:"playerhead",role_controller:"role_controller",startower_controller:"startower_controller"}],star_tower_main_window:[function(t,e,i){"use strict";cc._RF.push(e,"0fa731mHdRMY44K1aWtsVAq","star_tower_main_window");var s=t("pathtool"),n=t("baserole"),a=t("startower_event"),o=t("role_controller"),l=t("commonalert");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("startower","star_tower_main"),this.viewTag=SCENE_TAG.ui,this.win_type=WinType.Big,this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){this.data=null,this.item_list={}},openCallBack:function(){this.background=this.root_wnd.getChildByName("background"),this.background.scale=FIT_SCALE,this.main_panel=this.root_wnd.getChildByName("main_panel"),this.top_bg=this.main_panel.getChildByName("top_bg"),this.top_bg.scale=2,this.loadRes(s.getBigBg("bigbg_26"),function(t){this.top_bg&&(this.top_bg.getComponent(cc.Sprite).spriteFrame=t)}.bind(this)),this.title=this.main_panel.getChildByName("title").getComponent(cc.Label),this.top_panel=this.main_panel.getChildByName("top_panel"),this.award_panel=this.main_panel.getChildByName("award_panel"),this.fight_btn=this.main_panel.getChildByName("btn1"),this.fight_btn.getChildByName("Label").getComponent(cc.Label).string=Utils.TI18N("\u6311\u6218"),this.close_btn=this.main_panel.getChildByName("close_btn"),this.clean_btn=this.main_panel.getChildByName("btn2"),this.clean_label=this.clean_btn.getChildByName("Label").getComponent(cc.RichText),this._dianmond=this.clean_btn.getChildByName("dianmond"),this.loadRes(s.getItemRes(15),function(t){this._dianmond.getComponent(cc.Sprite).spriteFrame=t}.bind(this)),this._dianmond.active=!1,this.video_btn=this.top_panel.getChildByName("video_btn"),this.video_btn.getChildByName("label").getComponent(cc.Label).string=Utils.TI18N("\u901a\u5173\u5f55\u50cf"),this.award_panel.getChildByName("label").getComponent(cc.Label).string=Utils.TI18N("\u6311\u6218\u5956\u52b1"),this.no_label=Utils.createLabel(24,new cc.Color(104,69,42,255),null,435,20,"",this.main_panel,0,cc.v2(0,0)),this.no_label.string=Utils.TI18N("\u6311\u6218\u6210\u529f\u53ef\u8fdb\u884c\u626b\u8361"),this.data&&this.updateDate()},updateDate:function(){if(this.data){var t=this.data.name||"";this.title.string=t,this.updateModel(this.data),this.data&&this.ctrl.sender11325(this.data.lev),this.changeClearTitleText(),this.updateDesc(),this.updateGoodsList()}},changeClearTitleText:function(){var t=this.model.getBuyCount()||0,e=this.model.getTowerLessCount();this.model.getNowTowerId();if(this._dianmond.active=!1,this.clean_label.node.x=0,e>0)this.clean_label.string=Utils.TI18N("<outline=1,color=#2B610D>\u626b\u8361</outline>");else{var i=Config.star_tower_data.data_tower_buy[t+1];if(i){var s=cc.js.formatStr(Utils.TI18N("<outline=1,color=#2B610D>%s%s</outline>"),i.expend[0][1],Utils.TI18N("\u626b\u8361"));this.clean_label.string=s,this._dianmond.active=!0,this.clean_label.node.x=10}else this.clean_label.string=Utils.TI18N("<outline=1,color=#2B610D>\u626b\u8361</outline>")}},updateModel:function(t){t&&(this.partner_model||(this.partner_model=new n,this.partner_model.setParent(this.top_panel),this.partner_model.node.setPosition(313,310),this.partner_model.setData(n.type.unit,t.unit_id,PlayerAction.show,!0,.72)))},registerEvent:function(){this.close_btn.on(cc.Node.EventType.TOUCH_END,function(){Utils.playButtonSound(ButtonSound.Close),this.ctrl.openStarTowerMainView(!1)},this),this.background.on(cc.Node.EventType.TOUCH_END,function(){Utils.playButtonSound(ButtonSound.Close),this.ctrl.openStarTowerMainView(!1)},this),this.fight_btn.on(cc.Node.EventType.TOUCH_END,function(){if(Utils.playButtonSound(ButtonSound.Normal),this.data){var t=this.data.lev||0;this.ctrl.sender11322(t)}},this),this.clean_btn.on(cc.Node.EventType.TOUCH_END,function(){if(Utils.playButtonSound(ButtonSound.Normal),this.data)if((this.model.getTowerLessCount()||0)<=0)this.openBuyCountPanel();else{var t=this.data.lev||0;this.ctrl.sender11324(t)}},this),this.video_btn.on(cc.Node.EventType.TOUCH_END,function(){Utils.playButtonSound(ButtonSound.Normal),this.video_data&&(this.video_data.tower_replay_data&&null!=Utils.next(this.video_data.tower_replay_data)?this.ctrl.openVideoWindow(!0,this.video_data,this.data.lev):message(Utils.TI18N("\u6682\u65f6\u6ca1\u6709\u73a9\u5bb6\u901a\u8fc7\u6b64\u5173\uff0c\u52aa\u529b\u6210\u4e3a\u7b2c\u4e00\u540d\u5427\uff01")))},this),this.addGlobalEvent(a.Video_Data_Event,function(t){this.video_data=t,this.updateVideoData(t)}.bind(this)),this.addGlobalEvent(a.Fight_Success_Event,function(t){this.data&&this.ctrl.sender11325(this.data.lev),this.updateGoodsList()}.bind(this)),this.addGlobalEvent(a.Count_Change_Event,function(t){this.changeClearTitleText()}.bind(this))},openBuyCountPanel:function(){Config.star_tower_data.data_tower_const.free_times.val;var t=this.model.getBuyCount()||0,e=o.getInstance().getRoleVo(),i=Config.star_tower_data.data_tower_vip[e.vip_lev],n=function(){var t=this.data.lev||0;this.ctrl.sender11324(t)}.bind(this);if(i&&i.buy_count)if(t>=i.buy_count)message(Utils.TI18N("\u672c\u65e5\u626b\u8361\u6b21\u6570\u5df2\u8fbe\u4e0a\u9650"));else{var a=Config.star_tower_data.data_tower_buy[t+1];if(a&&a.expend&&a.expend[0]&&a.expend[0][0]){var r=a.expend[0][0],c=a.expend[0][1]||0,_=Utils.getItemConfig(r);if(_&&_.icon){var h=s.getItemRes(_.icon),d=cc.js.formatStr(Utils.TI18N("\u662f\u5426\u82b1\u8d39<img src='%s'/> %s\u8d2d\u4e70\u4e00\u6b21\u6311\u6218\u6b21\u6570\uff1f"),_.icon,c);l.show(d,Utils.TI18N("\u786e\u5b9a"),n,Utils.TI18N("\u53d6\u6d88"),null,null,null,{resArr:[h]})}}}},updateVideoData:function(t){if(t){this.fast_desc||(this.fast_desc=Utils.createRichLabel(24,new cc.Color(104,69,42,255),cc.v2(0,1),cc.v2(20,-12),30,300),this.fast_desc.horizontalAlign=cc.macro.TextAlignment.LEFT,this.top_panel.addChild(this.fast_desc.node)),this.power_desc||(this.power_desc=Utils.createRichLabel(24,new cc.Color(104,69,42,255),cc.v2(0,1),cc.v2(20,-52),30,300),this.power_desc.horizontalAlign=cc.macro.TextAlignment.LEFT,this.top_panel.addChild(this.power_desc.node)),this.fast_desc.string=Utils.TI18N("\u6700\u5feb\u901a\u5173\uff1a\u6682\u65e0"),this.power_desc.string=Utils.TI18N("\u6700\u4f4e\u6218\u529b\uff1a\u6682\u65e0");var e=t.tower_replay_data||{};for(var i in e){var s=e[i];if(s&&1==s.type){var n=cc.js.formatStr(Utils.TI18N("\u6700\u5feb\u901a\u5173\uff1a%s"),s.name);this.fast_desc.string=n}else{n=cc.js.formatStr(Utils.TI18N("\u6700\u4f4e\u6218\u529b\uff1a%s"),s.name);this.power_desc.string=n}}}},updateDesc:function(){if(this.data){this.boss_desc=Utils.createRichLabel(24,new cc.Color(104,69,42,255),cc.v2(0,1),cc.v2(20,110),30,620),this.boss_desc.horizontalAlign=cc.macro.TextAlignment.LEFT,this.top_panel.addChild(this.boss_desc.node),this.boss_power=Utils.createRichLabel(24,new cc.Color(104,69,42,255),cc.v2(0,0),cc.v2(20,15),30,620),this.boss_power.horizontalAlign=cc.macro.TextAlignment.LEFT,this.top_panel.addChild(this.boss_power.node);var t=this.data.desc||"";this.boss_desc.string=Utils.TI18N("\u602a\u7269\u7279\u70b9\uff1a")+t;var e=this.data.recommend||0,i=cc.js.formatStr(Utils.TI18N("\u63a8\u8350\u6218\u529b\uff1a<color=#289b14>%s</c>"),e);this.boss_power.string=i}},updateGoodsList:function(){if(this.data){for(var t in this.item_list)this.item_list[t].setVisible(!1);var e=[];if((this.model.getNowTowerId()||0)<this.data.lev){var i=0,s=0;this.data.first_show[0]&&this.data.first_show[0][0]&&this.data.first_show[0][1]&&(i=this.data.first_show[0][0],s=this.data.first_show[0][1]),e.push({0:i,1:s,2:!0})}for(var n in this.data.award)e.push(this.data.award[n]);var a=1;for(var o in e){if(!this.item_list[a]){var l=ItemsPool.getInstance().getItem("backpack_item");l.setParent(this.award_panel),l.initConfig(!0,.9,!1,!0),l.show(),this.item_list[a]=l}this.item_list[a].setPosition(90+150*(a-1),70),this.item_list[a].setData({bid:e[o][0],num:e[o][1]}),this.item_list[a].setVisible(!0),this.item_list[a].showBiaoQian(!1),e[o]&&e[o][2]&&1==e[o][2]&&this.item_list[a].showBiaoQian(!0,Utils.TI18N("\u9996\u901a")),a+=1}var r=this.model.getNowTowerId()||0;this.data.lev>r?(this.clean_btn.active=!1,this.fight_btn.setPosition(338,78),this.no_label.string=Utils.TI18N("\u6311\u6218\u6210\u529f\u53ef\u8fdb\u884c\u626b\u8361")):(this.clean_btn.active=!0,this.no_label.string="",this.fight_btn.setPosition(178,78))}},openRootWnd:function(t){this.data=t,this.updateDate()},closeCallBack:function(){for(var t in this.ctrl.openStarTowerMainView(!1),this.partner_model&&(this.partner_model.deleteMe(),this.partner_model=null),this.item_list)this.item_list[t].deleteMe();this.item_list=null}});cc._RF.pop()},{baserole:"baserole",commonalert:"commonalert",pathtool:"pathtool",role_controller:"role_controller",startower_event:"startower_event"}],star_tower_result_window:[function(t,e,i){"use strict";cc._RF.push(e,"8eabaZanH5O/KEvhjISKlEM","star_tower_result_window");var s=t("pathtool"),n=(t("startower_controller"),t("common_scrollview")),a=t("timetool"),o=(t("battle_model"),t("mainui_controller"));t("battle_const"),cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("battle","battle_result_view"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Tips,this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){this.result=null,this.fight_type=null,this.item_list=[],this.dungeon_data=null},openCallBack:function(){this.background=this.root_wnd.getChildByName("background"),this.background.scale=FIT_SCALE,this.source_container=this.root_wnd.getChildByName("container"),this.title_container=this.source_container.getChildByName("title_container"),this.title_width=this.title_container.width,this.title_height=this.title_container.height,this.handleEffect(!0),this.time_label=this.seekChild("time_lb",cc.Label),this.time_label.node.active=!1,this.comfirm_btn=this.source_container.getChildByName("comfirm_btn"),this.comfirm_btn.getChildByName("Label").getComponent(cc.Label).string=Utils.TI18N("\u786e\u5b9a"),this.comfirm_btn.x=190,this.comfirm_btn.y=54,this.return_btn=this.source_container.getChildByName("return_btn"),this.return_btn.active=!0,this.return_btn.getChildByName("Label").getComponent(cc.Label).string=Utils.TI18N("\u56de\u5230\u8bd5\u70bc\u5854"),this.harm_btn=this.source_container.getChildByName("harm_btn"),this.harm_btn.active=!1,this.harm_btn.y=484;var t=this.seekChild(this.source_container,"background"),e=this.seekChild(this.source_container,"Sprite_2"),i=this.seekChild(this.source_container,"Sprite_3"),a=this.seekChild(this.source_container,"Sprite_4");t.height=400,t.y=302.5,e.y=100,i.y=92,a.y=92;var o=Utils.createImage(this.source_container,null,360,462,cc.v2(.5,1),!0,0,!1);o.node.scaleX=5;var l=s.getCommonIcomPath("common_90044");this.loadRes(l,function(t){o.spriteFrame=t}.bind(this)),this.pass_time=Utils.createRichLabel(24,new cc.Color(255,180,0,255),cc.v2(.5,.5),cc.v2(360,440),30,1e3),this.pass_time.string=Utils.TI18N("\u901a\u5173\u65f6\u95f4\uff1a00:00:00"),this.source_container.addChild(this.pass_time.node),this.gain_label=Utils.createRichLabel(22,new cc.Color(255,255,255,255),cc.v2(.5,.5),cc.v2(360,100),30,1e3),this.gain_label.handleTouchEvent=!1,this.source_container.addChild(this.gain_label.node),this.seekChild("scroll_view").active=!1;var r=cc.size(SCREEN_WIDTH,190);this.scroll_view=new n,this.scroll_view.createScroll(this.source_container,cc.v2(this.source_container.width/2,this.source_container.height/2-30),null,null,r,{item_class:"backpack_item",start_x:94,space_x:20,start_y:0,space_y:10,item_width:156,item_height:156,row:4,col:4,need_dynamic:!0},cc.v2(.5,.5))},registerEvent:function(){Utils.onTouchEnd(this.comfirm_btn,function(){this.ctrl.openResultWindow(!1)}.bind(this),1),Utils.onTouchEnd(this.return_btn,function(){this.ctrl.openResultWindow(!1);var e=t("mainui_const");o.getInstance().changeMainUIStatus(e.btn_index.main_scene,e.sub_type.startower)}.bind(this),1),Utils.onTouchEnd(this.harm_btn,function(){this.data&&null!=Utils.next(this.data)&&t("battle_controller").getInstance().openBattleHarmInfoView(!0,this.data)}.bind(this),1)},setData:function(t,e,i){if(t){this.data=t||{},this.dungeon_data=i,this.fight_type=e,this.result=t.result;var n=t.timer||0,o=[],l={},r=this.data.first_award||{};for(var c in this.harm_btn.active=!0,r)r[c].is_first=!0,o.push(r[c]);for(var _ in this.data.award)this.data.award[_].is_first=!1,o.push(this.data.award[_]);var h="";if(l&&null!=Utils.next(l||{}))for(var c in l)if(Utils.getItemConfig(l[c].item_id)){var d=Utils.getItemConfig(l[c].item_id).icon;h+=cc.js.formatStr("<div><img src='%s' scale=0.4 /></div><color=#ffffff fontsize=24>+%s            </color>",s.getItemRes(d),l[c].num)}this.gain_label&&(this.gain_label.string=h),this.reward_list=o,this.result=this.data.result,this.is_guide=this.data.is_guide,this.pass_time.string=cc.js.formatStr(Utils.TI18N("\u901a\u5173\u65f6\u95f4\uff1a%s"),a.getTimeFormat(n)),this.rewardViewUI()}},handleEffect:function(t){if(0==t)this.play_effect&&(this.play_effect.setToSetupPose(),this.play_effect.clearTracks(),this.play_effect=null);else if(this.title_container&&null==this.play_effect){this.play_effect=this.title_container.getComponent(sp.Skeleton);var e=cc.js.formatStr("spine/%s/action.atlas",s.getEffectRes(103));this.loadRes(e,function(t){this.play_effect.skeletonData=t,this.play_effect.setAnimation(1,PlayerAction.action_2,!1)}.bind(this))}},rewardViewUI:function(){var t=[];for(var e in this.reward_list)t.push({bid:this.reward_list[e].item_id,num:this.reward_list[e].num});this.scroll_view.setData(t),this.scroll_view.addEndCallBack(function(){var t=this.scroll_view.getItemList();for(var e in t){var i=t[e],s=i.getItemData();for(var n in this.reward_list)s&&s.bid==this.reward_list[n].item_id&&s.num==this.reward_list[n].num&&this.reward_list[n].is_first&&1==this.reward_list[n].is_first&&i.showBiaoQian(!0,Utils.TI18N("\u9996\u901a"))}}.bind(this)),this.ItemAciton()},ItemAciton:function(){if(this.item_list&&null!=Utils.next(this.item_list||[])){for(var t in this.item_list)this.item_list[t]&&gcore.Timer.set(function(){this.item_list[t].setVisible(!0);var e=cc.scaleTo(.1,1);this.item_list[t].runAction(cc.sequence(e,cc.callFunc(function(){1,this.item_list.length})))}.bind(this),.1*(t-1),1)}},updateTimer:function(){},openRootWnd:function(t,e,i){this.setData(t,e,i)},closeCallBack:function(){this.handleEffect(!1),this.close_result_reward&&(gcore.Timer.del(this.close_result_reward),this.close_result_reward=null),this.scroll_view&&(this.scroll_view.deleteMe(),this.scroll_view=null),o.getInstance().checkIsInDramaUIFight(),this.result=null,this.fight_type=null,this.item_list=null,this.dungeon_data=null,this.ctrl.openResultWindow(!1)}});cc._RF.pop()},{battle_const:"battle_const",battle_controller:"battle_controller",battle_model:"battle_model",common_scrollview:"common_scrollview",mainui_const:"mainui_const",mainui_controller:"mainui_controller",pathtool:"pathtool",startower_controller:"startower_controller",timetool:"timetool"}],star_tower_video_window:[function(t,e,i){"use strict";cc._RF.push(e,"ffbeafai+ZB0Jf5u5nXKpIa","star_tower_video_window");var s=t("pathtool"),n=t("battle_controller"),a=t("role_controller"),o=t("playerhead"),l=t("timetool");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("startower","star_tower_video"),this.viewTag=SCENE_TAG.ui,this.win_type=WinType.Mini,this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){this.first_id=0,this.next_id=0},openCallBack:function(){this.background=this.root_wnd.getChildByName("background"),this.background.scale=FIT_SCALE,this.main_panel=this.root_wnd.getChildByName("main_container"),this.title_con=this.main_panel.getChildByName("title_con"),this.title=this.title_con.getChildByName("title_label").getComponent(cc.Label),this.title.string=Utils.TI18N("\u5f55\u50cf"),this.close_btn=this.main_panel.getChildByName("close_btn"),this.info_con=this.main_panel.getChildByName("info_con"),this.first_btn=this.info_con.getChildByName("btn1"),this.first_btn.getChildByName("Label").getComponent(cc.Label).string=Utils.TI18N("\u67e5\u770b"),this.two_btn=this.info_con.getChildByName("btn2"),this.two_btn.getChildByName("Label").getComponent(cc.Label).string=Utils.TI18N("\u67e5\u770b"),this.my_look=this.info_con.getChildByName("btn4"),this.my_look.getChildByName("Label").getComponent(cc.Label).string=Utils.TI18N("\u67e5\u770b"),this.share_btn=this.info_con.getChildByName("btn3"),this.info_con.getChildByName("qian_title_1").getComponent(cc.Label).string=Utils.TI18N("\u6700\u5feb"),this.info_con.getChildByName("qian_title_2").getComponent(cc.Label).string=Utils.TI18N("\u6700\u4f4e"),this.share_panel=this.main_panel.getChildByName("share_panel"),this.share_panel.active=!1,this.share_btn1=this.share_panel.getChildByName("share_btn1"),this.share_btn1.getChildByName("Label").getComponent(cc.Label).string=Utils.TI18N("\u4e16\u754c\u9891\u9053"),this.share_btn2=this.share_panel.getChildByName("share_btn2"),this.share_btn2.getChildByName("Label").getComponent(cc.Label).string=Utils.TI18N("\u516c\u4f1a\u9891\u9053"),this.createDesc(),this.updateInfo()},registerEvent:function(){this.close_btn.on(cc.Node.EventType.TOUCH_END,function(){Utils.playButtonSound(2),this.ctrl.openVideoWindow(!1)},this),this.background.on(cc.Node.EventType.TOUCH_END,function(){Utils.playButtonSound(2),this.ctrl.openVideoWindow(!1)},this),this.first_btn.on(cc.Node.EventType.TOUCH_END,function(){Utils.playButtonSound(1),0!=this.first_id&&n.getInstance().csRecordBattle(this.first_id)},this),this.two_btn.on(cc.Node.EventType.TOUCH_END,function(){Utils.playButtonSound(1),0!=this.next_id&&n.getInstance().csRecordBattle(this.next_id)},this),this.two_btn.on(cc.Node.EventType.TOUCH_END,function(){Utils.playButtonSound(1),0!=this.next_id&&n.getInstance().csRecordBattle(this.next_id)},this),this.my_look.on(cc.Node.EventType.TOUCH_END,function(){Utils.playButtonSound(1),this.data&&this.data.m_replay_id&&0!=this.data.m_replay_id&&n.getInstance().csRecordBattle(this.data.m_replay_id)},this),this.share_btn1.on(cc.Node.EventType.TOUCH_END,function(){Utils.playButtonSound(1),this.data&&(this.ctrl.sender11333(this.data.m_replay_id,1,this.click_tower),this.showSharePanel(!1))},this),this.share_btn2.on(cc.Node.EventType.TOUCH_END,function(){Utils.playButtonSound(1),this.data&&(this.ctrl.sender11333(this.data.m_replay_id,4,this.click_tower),this.showSharePanel(!1))},this),this.share_btn.on(cc.Node.EventType.TOUCH_END,function(){Utils.playButtonSound(1);var t=!0;this.share_panel&&(t=!this.share_panel.active),this.showSharePanel(t)},this)},showSharePanel:function(t){(0!=t||this.share_panel)&&(this.share_panel.active=t)},updateInfo:function(){if(this.data&&this.main_panel){var t=cc.js.formatStr(Utils.TI18N("\u65f6\u95f4\uff1a%s"),l.getTimeFormat(this.data.my_time));this.my_time.string=t;var e=this.data.tower_replay_data||{};for(var i in e){var s=e[i];if(s&&1==s.type){t=cc.js.formatStr(Utils.TI18N("\u901a\u5173\u65f6\u95f4\uff1a%s"),l.getTimeFormat(s.time));this.fast_desc.string=t,this.top_name.string=s.name,this.top_head.setHeadRes(s.face_id),this.first_id=s.replay_id}else{t=cc.js.formatStr(Utils.TI18N("\u6700\u4f4e\u6218\u529b\uff1a%s"),s.power);this.power_desc.string=t,this.bottom_name.string=s.name,this.bottom_head.setHeadRes(s.face_id),this.next_id=s.replay_id}}var n=a.getInstance().getRoleVo();this.my_head.setHeadRes(n.face_id),null!=this.data.m_replay_id&&0==this.data.m_replay_id&&(this.my_look.active=!1,this.share_btn.active=!1,this.my_time.string=Utils.TI18N("\u6682\u672a\u901a\u5173"))}},createDesc:function(){this.top_head=new o,this.top_head.show(),this.top_head.setPosition(90,295),this.top_head.setParent(this.info_con),this.bottom_head=new o,this.bottom_head.show(),this.bottom_head.setPosition(90,175),this.bottom_head.setParent(this.info_con),this.my_head=new o,this.my_head.show(),this.my_head.setPosition(90,62),this.my_head.setParent(this.info_con),this.top_name=Utils.createLabel(24,new cc.Color(104,69,42,255),null,165,300,"",this.info_con,2,cc.v2(0,0)),this.bottom_name=Utils.createLabel(24,new cc.Color(104,69,42,255),null,165,183,"",this.info_con,2,cc.v2(0,0)),this.fast_desc=Utils.createRichLabel(24,new cc.Color(104,69,42,255),cc.v2(0,1),cc.v2(165,290),30,300),this.fast_desc.horizontalAlign=cc.macro.TextAlignment.LEFT,this.info_con.addChild(this.fast_desc.node),this.power_desc=Utils.createRichLabel(24,new cc.Color(104,69,42,255),cc.v2(0,1),cc.v2(165,170),30,300),this.power_desc.horizontalAlign=cc.macro.TextAlignment.LEFT,this.info_con.addChild(this.power_desc.node),this.my_name=Utils.createLabel(24,new cc.Color(104,69,42,255),null,165,60,"",this.info_con,2,cc.v2(0,0)),this.my_name.string=Utils.TI18N("\u6211\u7684\u901a\u5173\u5f55\u50cf"),this.my_time=Utils.createRichLabel(24,new cc.Color(104,69,42,255),cc.v2(0,1),cc.v2(165,55),30,300),this.my_time.horizontalAlign=cc.macro.TextAlignment.LEFT,this.info_con.addChild(this.my_time.node)},openRootWnd:function(t){t&&(this.data=t[0],this.click_tower=t[1],this.updateInfo())},closeCallBack:function(){this.ctrl.openVideoWindow(!1),this.bottom_head&&(this.bottom_head.onDelete(),this.bottom_head=null),this.my_head&&(this.my_head.onDelete(),this.my_head=null),this.top_head&&(this.top_head.onDelete(),this.top_head=null)}});cc._RF.pop()},{battle_controller:"battle_controller",pathtool:"pathtool",playerhead:"playerhead",role_controller:"role_controller",timetool:"timetool"}],star_tower_window_window:[function(t,e,i){"use strict";cc._RF.push(e,"87c87ZEpdxP2ZcIwygiwitT","star_tower_window_window");var s=t("pathtool"),n=t("rank_constant"),a=t("rank_controller"),o=t("role_controller"),l=t("startower_event"),r=t("commonalert"),c=t("star_tower_list");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("startower","star_tower_window"),this.viewTag=SCENE_TAG.ui,this.win_type=WinType.Full,this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){this.tab_list={},this.select_type=1,this.view_list={},this.is_change=!1,this.top3_item_list={}},openCallBack:function(){this.mainContainer=this.root_wnd.getChildByName("main_container"),this.container=this.mainContainer.getChildByName("container"),this.topBg=this.root_wnd.getChildByName("bg"),this.topBg.scale=FIT_SCALE,this.top_panel=this.root_wnd.getChildByName("top_panel"),this.top_panel.top=this.topBg.top+this.topBg.height/2*FIT_SCALE,this.btnRule=this.top_panel.getChildByName("btnRule"),this.top_panel.getChildByName("title").getComponent(cc.Label).string=Utils.TI18N("\u8bd5\u7ec3\u5854"),this.black_bg=this.mainContainer.getChildByName("black_bg"),this.close_btn=this.black_bg.getChildByName("close_btn"),this.close_btn.getChildByName("label").getComponent(cc.Label).string=Utils.TI18N("\u8fd4\u56de"),this.cost_panel=this.black_bg.getChildByName("cost_panel"),this.add_btn=this.cost_panel.getChildByName("add_btn"),this.less_label=Utils.createRichLabel(24,new cc.Color(255,255,255,255),cc.v2(0,1),cc.v2(0,65),30,220),this.less_label.horizontalAlign=cc.macro.TextAlignment.LEFT,this.cost_panel.addChild(this.less_label.node),this.award_btn=this.mainContainer.getChildByName("award_btn"),this.award_btn.getChildByName("label").getComponent(cc.Label).string=Utils.TI18N("\u5956\u52b1"),this.rank_btn=this.mainContainer.getChildByName("rank_btn"),this.rank_btn.getChildByName("label").getComponent(cc.Label).string=Utils.TI18N("\u6392\u884c"),this.scroll_height=1100*FIT_SCALE,this.updateTowerList(),this.rank_container=this.mainContainer.getChildByName("rank_container"),this.rank_container.getChildByName("rank_desc_label").getComponent(cc.Label).string=Utils.TI18N("\u6392\u884c\u524d\u4e09"),this.rank_top3_btn=this.rank_container.getChildByName("rank_btn")},registerEvent:function(){this.close_btn.on(cc.Node.EventType.TOUCH_END,function(){Utils.playButtonSound(2),this.ctrl.openMainView(!1)},this),this.award_btn.on(cc.Node.EventType.TOUCH_END,function(){Utils.playButtonSound(1),this.ctrl.openAwardWindow(!0)},this),this.rank_btn.on(cc.Node.EventType.TOUCH_END,function(){Utils.playButtonSound(1),a.getInstance().openRankView(!0,n.RankType.tower)},this),this.rank_top3_btn.on(cc.Node.EventType.TOUCH_END,function(){Utils.playButtonSound(1),a.getInstance().openRankView(!0,n.RankType.tower)},this),this.btnRule.on(cc.Node.EventType.TOUCH_END,function(e){Utils.playButtonSound(1);var i=Config.star_tower_data.data_tower_const.rule_desc,s=e.touch.getLocation();t("tips_controller").getInstance().showCommonTips(i.desc,s)},this),this.add_btn.on(cc.Node.EventType.TOUCH_END,function(){Utils.playButtonSound(1);var e=this.model.getBuyCount()||0,i=o.getInstance().getRoleVo(),n=Config.star_tower_data.data_tower_vip[i.vip_lev];if(n&&n.buy_count)if(e>=n.buy_count)message(Utils.TI18N("\u672c\u65e5\u8d2d\u4e70\u6b21\u6570\u5df2\u8fbe\u4e0a\u9650"));else{var a=Config.star_tower_data.data_tower_buy[e+1];if(a&&a.expend&&a.expend[0]&&a.expend[0][0]){var l=a.expend[0][0],c=a.expend[0][1]||0,_=Utils.getItemConfig(l);if(_&&_.icon){var h=s.getItemRes(_.icon),d=cc.js.formatStr(Utils.TI18N("\u662f\u5426\u82b1\u8d39<img src='%s'/> %s\u8d2d\u4e70\u4e00\u6b21\u6311\u6218\u6b21\u6570\uff1f"),_.icon,c);r.show(d,Utils.TI18N("\u786e\u5b9a"),function(){t("startower_controller").getInstance().sender11321()},Utils.TI18N("\u53d6\u6d88"),null,null,null,{resArr:[h]})}}}},this),this.addGlobalEvent(l.Update_All_Data,function(){this.updateCount(),this.updataRewardRedPoint()}.bind(this)),this.addGlobalEvent(l.Update_Top3_rank,function(t){this.updateTop3Info(t)}.bind(this)),this.addGlobalEvent(l.Update_First_Reward_Msg,function(){this.updataRewardRedPoint()}.bind(this)),this.addGlobalEvent(l.Fight_Success_Event,function(){this.select_vo&&(this.list_view.resetCurrentItems(),this.list_view.moveToArrowNewPosition())}.bind(this)),this.addGlobalEvent(l.Count_Change_Event,function(){this.updateCount();var t=this.model.getNowTowerId()||0,e=this.list_view.getActiveCellList();for(var i in e)if(e[i].index==t){e[i].getData()&&e[i].sweepCount(e[i].getData());break}}.bind(this))},updataRewardRedPoint:function(){var e=this.model.getRewardData(),i=!1;for(var s in e)if(1==e[s].status){i=!0;break}Utils.addRedPointToNodeByStatus(this.award_btn,i);var n=t("scene_const");t("mainscene_controller").getInstance().setBuildRedStatus(n.CenterSceneBuild.startower,{bid:1,status:i})},updateCount:function(){var t=this.model.getTowerLessCount()||0,e=Config.star_tower_data.data_tower_const.free_times.val||0,i=cc.js.formatStr(Utils.TI18N("\u5269\u4f59\u6311\u6218\u6b21\u6570\uff1a%s/%s"),t,e);this.less_label.string=i},openRootWnd:function(t){if(this.ctrl.sender11320(),this.ctrl.requestStarTowerRank(),this.list_view){var e=this.model.getNowTowerId();this.list_view.reloadData(e)}},updateTowerList:function(){if(this.max_count=Config.star_tower_data.data_tower_base_length,!this.list_view){var t=cc.size(SCREEN_WIDTH*FIT_SCALE,this.scroll_height);this.list_view=new c,this.list_view.createScroll(this.container,cc.v2(0,this.black_bg.y-90),t),this.list_view.registerScriptHandlerSingle(this.createNewCell.bind(this),ScrollViewFuncType.CreateNewCell),this.list_view.registerScriptHandlerSingle(this.numberOfCells.bind(this),ScrollViewFuncType.NumberOfCells),this.list_view.registerScriptHandlerSingle(this.updateCellByIndex.bind(this),ScrollViewFuncType.UpdateCellByIndex),this.list_view.registerScriptHandlerSingle(this.onCellTouched.bind(this),ScrollViewFuncType.OnCellTouched)}},createNewCell:function(){var t=Utils.createClass("star_tower_item_panel",this);return t.show(),t.addCallBack(function(){this.onCellTouched(t)}.bind(this)),t},numberOfCells:function(){return this.max_count||0},updateCellByIndex:function(t,e){t.index=e,t.setData(e)},onCellTouched:function(t){var e=t.index;if(e>this.model.getNowTowerId()+1)message(Utils.TI18N("\u5f53\u524d\u5173\u5361\u672a\u5f00\u542f"));else{var i=Config.star_tower_data.data_tower_base[e];i&&(this.select_vo=i,this.select_item=t,this.data=i,this.clickFun(i))}},clickFun:function(t){t&&this.ctrl.openStarTowerMainView(!0,t)},updateTop3Info:function(t){if(null!=t&&null!=Utils.next(t))for(var e in t){if(!this.top3_item_list[t[e].rank]){var i=this.createSingleRankItem(t[e].rank);this.rank_container.addChild(i),this.top3_item_list[t[e].rank]=i}(i=this.top3_item_list[t[e].rank])&&(i.setPosition(0,120-(t[e].rank-1)*i.getContentSize().height),i.label.string=t[e].name,i.value.string=(t[e].tower||0)+Utils.TI18N("\u5c42"))}},createSingleRankItem:function(t){var e=new cc.Node;e.setAnchorPoint(0,0),e.setContentSize(180,40);var i=Utils.createImage(e,null,30,20,cc.v2(.5,.5)),n=s.getCommonIcomPath("common_300"+t);this.loadRes(n,function(t){i.spriteFrame=t}.bind(this)),i.node.scale=.5;var a=Utils.createLabel(20,new cc.Color(137,237,255,255),null,60,20,"",e,0,cc.v2(0,.5)),o=Utils.createLabel(20,new cc.Color(137,237,255,255),null,188,20,"",e,0,cc.v2(0,.5));return e.label=a,e.value=o,e},closeCallBack:function(){this.ctrl.openMainView(!1),this.list_view&&(this.list_view.deleteMe(),this.list_view=null),this.select_item=null,this.lock_icon&&(this.lock_icon.onDelete(),this.lock_icon=null)}});cc._RF.pop()},{commonalert:"commonalert",mainscene_controller:"mainscene_controller",pathtool:"pathtool",rank_constant:"rank_constant",rank_controller:"rank_controller",role_controller:"role_controller",scene_const:"scene_const",star_tower_list:"star_tower_list",startower_controller:"startower_controller",startower_event:"startower_event",tips_controller:"tips_controller"}],start_work_panel:[function(t,e,i){"use strict";cc._RF.push(e,"9dad7RkZ2lJTK2UDMv+lbvw","start_work_panel");var s=t("pathtool"),n=t("action_event"),a=t("timetool"),o=t("action_controller");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("welfare","start_work_panel"),this.holiday_bid=arguments[0]},initConfig:function(){this.btn_reward_list={}},initPanel:function(){var t=this.seekChild("main_container"),e=this.seekChild("bg");this.loadRes(s.getBigBg("welfare/welfare_startwork"),function(t){e.getComponent(cc.Sprite).spriteFrame=t}.bind(this)),this.holiday_time_lb=this.seekChild(t,"Text_7",cc.Label),this.holiday_time_lb.string=Utils.TI18N("\u6d3b\u52a8\u65f6\u95f4\uff1a"),this.seekChild(t,"Text_8",cc.Label).string=Utils.TI18N("\u6d3b\u52a8\u8bf4\u660e\uff1a\u5468\u516d\u3001\u5468\u65e5\u3001\u5468\u4e00\u767b\u5f55\u53ef\u9886\u53d6");for(var i=1;i<4;i++){var n={};n.btn=this.seekChild(t,"week_gift_"+i),n.flag=n.btn.getChildByName("flag"),n.flag_sp=n.btn.getChildByName("flag").getComponent(cc.Sprite),n.round=n.btn.getChildByName("Sprite_2"),n.round_sp=n.btn.getChildByName("Sprite_2").getComponent(cc.Sprite),n.flag.active=!1,n.text_1=n.btn.getChildByName("reward_bg").getChildByName("text_1").getComponent(cc.Label),n.text_2=n.btn.getChildByName("reward_bg").getChildByName("text_2").getComponent(cc.Label),this.btn_reward_list[i]=n}this.list_index=1,this.startUpdate(3,function(){var t=this.list_index;this.btn_reward_list[t]&&this.btn_reward_list[t].round_sp&&this.creatImage(t),this.list_index+=1}.bind(this),1e3/30)},creatImage:function(t){this.loadRes(s.getUIIconPath("startwork","startwork0"+(t+1)),function(e){this.btn_reward_list[t].round_sp.spriteFrame=e}.bind(this))},registerEvent:function(){var t=this;this.addGlobalEvent(n.UPDATE_HOLIDAY_SIGNLE,function(t){t.bid==this.holiday_bid&&(this.data=t,this.signReward(t),this.holidayTime(t))},this);var e=function(e){t.btn_reward_list[e].btn.on(cc.Node.EventType.TOUCH_END,function(){Utils.playButtonSound(1);var t=Number(e)-1;this.data&&this.data.aim_list[t]&&null!=this.data.aim_list[t].aim&&o.getInstance().cs16604(this.holiday_bid,this.data.aim_list[t].aim)},t)};for(var i in this.btn_reward_list)e(i)},onShow:function(t){this.holiday_bid=t.bid,o.getInstance().cs16603(this.holiday_bid)},setVisibleStatus:function(t){t=t||!1,this.setVisible(t),1==t&&o.getInstance().cs16603(this.holiday_bid)},signReward:function(t){var e=this;if(t.aim_list&&null!=Utils.next(t.aim_list)){this.stopRoundAction();var i=function(i){var n=t.aim_list[i],c=Number(i)+1;if(1==n.status?(e.btn_reward_list[c].flag.active=!1,a=cc.skewTo(.3,3,0),o=cc.skewTo(.3,-3,0),l=cc.skewTo(.4,0,0),r=cc.sequence(a,o,l,cc.delayTime(1)),e.btn_reward_list[c].round.runAction(cc.repeatForever(r))):2==n.status?(e.btn_reward_list[c].flag.active=!0,e.loadRes(s.getUIIconPath("startwork","txt_cn_startwork02"),function(t){this.btn_reward_list[c].flag_sp.spriteFrame=t}.bind(e))):3==n.status?(e.btn_reward_list[c].flag.active=!0,e.loadRes(s.getUIIconPath("startwork","txt_cn_startwork01"),function(t){this.btn_reward_list[c].flag_sp.spriteFrame=t}.bind(e))):e.btn_reward_list[c].flag.active=!1,n.item_list)for(var _ in n.item_list){var h=n.item_list[_];if(1==_){var d=Utils.getItemConfig(h.bid);if(d){var u=cc.js.formatStr("%s*%s",d.name,h.num);e.btn_reward_list[c].text_1.string=u}}else{var m=Utils.getItemConfig(h.bid);if(m){var f=cc.js.formatStr("%s*%s",m.name,h.num);e.btn_reward_list[c].text_2.string=f}}}};for(var n in t.aim_list){var a,o,l,r;i(n)}}},stopRoundAction:function(){for(var t in this.btn_reward_list){var e=this.btn_reward_list[t];e.round&&e.round.stopAllActions()}},holidayTime:function(t){if(t.args){var e,i;for(var s in t.args){var n=t.args[s];1==n.args_key?e=n.args_val:i=n.args_val}if(e&&i){var o=cc.js.formatStr(Utils.TI18N("\u6d3b\u52a8\u65f6\u95f4\uff1a%s \u81f3 %s"),a.getYMD2(e),a.getYMD2(i));this.holiday_time_lb.string=o}}},onHide:function(){},onDelete:function(){this.stopRoundAction()}});cc._RF.pop()},{action_controller:"action_controller",action_event:"action_event",pathtool:"pathtool",timetool:"timetool"}],startower_controller:[function(t,e,i){"use strict";cc._RF.push(e,"2c1e7feMMhAvpohtfoZsaA6","startower_controller");var s=t("mainui_controller"),n=t("battle_event"),a=t("battle_controller"),o=t("battle_const"),l=t("startower_event"),r=t("levupgrade_controller"),c=cc.Class({extends:BaseController,ctor:function(){},initConfig:function(){var e=t("startower_model");this.model=new e,this.model.initConfig()},getModel:function(){return this.model},registerEvents:function(){},registerProtocals:function(){this.RegisterProtocal(11320,this.handle11320),this.RegisterProtocal(11321,this.handle11321),this.RegisterProtocal(11322,this.handle11322),this.RegisterProtocal(11323,this.handle11323),this.RegisterProtocal(11324,this.handle11324),this.RegisterProtocal(11325,this.handle11325),this.RegisterProtocal(11326,this.handle11326),this.RegisterProtocal(11333,this.handle11333),this.RegisterProtocal(11327,this.handle11327),this.RegisterProtocal(11328,this.handle11328),this.RegisterProtocal(11329,this.handle11329)},checkIsOpen:function(t){var e=Config.star_tower_data.data_tower_const.open_floor;if(null==e)return!1;var i=s.getInstance().checkIsOpenByActivate(e.val);return 0==i&&1==t&&message(e.desc),i},openMainView:function(t){if(t){if(!this.checkIsOpen(!0))return;this.main_view||(this.main_view=Utils.createClass("star_tower_window_window",this)),this.main_view&&0==this.main_view.isOpen()&&this.main_view.open()}else this.main_view&&(this.main_view.close(),this.main_view=null)},openStarTowerMainView:function(t,e){t?(this.star_tower_window||(this.star_tower_window=Utils.createClass("star_tower_main_window",this)),this.star_tower_window&&0==this.star_tower_window.isOpen()&&this.star_tower_window.open(e)):this.star_tower_window&&(this.star_tower_window.close(),this.star_tower_window=null)},openAwardWindow:function(t){t?(this.award_window||(this.award_window=Utils.createClass("star_tower_award_window",this)),this.award_window&&0==this.award_window.isOpen()&&this.award_window.open()):this.award_window&&(this.award_window.close(),this.award_window=null)},openVideoWindow:function(t,e,i){t?(this.video_window||(this.video_window=Utils.createClass("star_tower_video_window",this)),this.video_window&&0==this.video_window.isOpen()&&this.video_window.open([e,i])):this.video_window&&(this.video_window.close(),this.video_window=null)},getResultWindow:function(){return this.result_window},openResultWindow:function(t,e){1==t?(r.getInstance().waitForOpenLevUpgrade(!0),this.result_window||(this.result_window=Utils.createClass("star_tower_result_window",this)),this.result_window&&0==this.result_window.isOpen()&&this.result_window.open(e,o.Fight_Type.StarTower)):(this.result_window&&(this.result_window.close(),this.result_window=null),1==this.is_show_lock&&this.show_data||gcore.GlobalEvent.fire(n.CLOSE_RESULT_VIEW),this.is_show_lock=!1,this.show_data=null)},openGetWindow:function(t,e){1==t?(this.get_window||(this.get_window=Utils.createClass("star_tower_get_window",this)),this.get_window&&0==this.get_window.isOpen()&&this.get_window.open(e)):this.get_window&&(this.get_window.close(),this.get_window=null)},sender11320:function(){this.SendProtocal(11320,{})},handle11320:function(t){this.model.setStarTowerData(t)},sender11321:function(){this.SendProtocal(11321,{})},handle11321:function(t){message(t.msg),this.model.updateLessCount(t)},sender11322:function(t){var e={};e.tower=t,this.SendProtocal(11322,e)},handle11322:function(t){message(t.msg),this.openStarTowerMainView(!1)},handle11323:function(t){1==t.result?(a.getInstance().openFinishView(!0,o.Fight_Type.StarTower,t),this.model.updateMaxTower(t),this.model.updateLessCount(t)):a.getInstance().openFailFinishView(!0,o.Fight_Type.StarTower,t.result,t)},sender11324:function(t){var e={};e.tower=t,this.SendProtocal(11324,e)},handle11324:function(t){message(t.msg),this.model.updateLessCount(t)},sender11325:function(t){var e={};e.tower=t,this.SendProtocal(11325,e)},handle11325:function(t){message(t.msg),gcore.GlobalEvent.fire(l.Video_Data_Event,t)},handle11326:function(t){this.show_data=t,this.is_show_lock=!0},sender11333:function(t,e,i){var s={};s.replay_id=t,s.channel=e,s.tower=i,this.SendProtocal(11333,s)},handle11333:function(t){message(t.msg),1==t.result&&this.openVideoWindow(!1)},requestStarTowerRank:function(){this.SendProtocal(11327,{})},handle11327:function(t){gcore.GlobalEvent.fire(l.Update_Top3_rank,t.rank_lists)},sender11328:function(t){var e={};e.id=t,this.SendProtocal(11328,e)},handle11328:function(t){message(t.msg),1==t.result&&gcore.GlobalEvent.fire(l.Update_Reward_Event)},handle11329:function(t){this.model.setRewardData(t.award_list),gcore.GlobalEvent.fire(l.Update_First_Reward_Msg)},__delete:function(){null!=this.model&&(this.model.DeleteMe(),this.model=null)},getStarTowerRoot:function(){if(this.main_view)return this.main_view.root_wnd},getStarTowerChallengeRoot:function(){if(this.star_tower_window)return this.star_tower_window.root_wnd}});e.exports=c,cc._RF.pop()},{battle_const:"battle_const",battle_controller:"battle_controller",battle_event:"battle_event",levupgrade_controller:"levupgrade_controller",mainui_controller:"mainui_controller",startower_event:"startower_event",startower_model:"startower_model"}],startower_event:[function(t,e,i){"use strict";cc._RF.push(e,"cf85dPu35NM56LNRLOGpoua","startower_event"),e.exports={Update_All_Data:"Update_All_Data",Video_Data_Event:"Video_Data_Event",Fight_Success_Event:"Fight_Success_Event",Count_Change_Event:"Count_Change_Event",Update_Top3_rank:"Update_Top3_rank",Update_Reward_Event:"Update_Reward_Event",Update_First_Reward_Msg:"Update_First_Reward_Msg"},cc._RF.pop()},{}],startower_model:[function(t,e,i){"use strict";cc._RF.push(e,"2481eZrVBpP7rPNob1XwV5e","startower_model");var s=t("startower_event");cc.Class({extends:BaseClass,ctor:function(){this.ctrl=t("startower_controller").getInstance(),this.initConfig()},properties:{},initConfig:function(){this.max_tower=0,this.less_count=0,this.buy_count=0,this.reward_list=[]},setStarTowerData:function(t){var e={0:2,1:1,2:3};if(this.max_tower=t.max_tower||0,this.less_count=t.count||0,this.buy_count=t.buy_count||0,null!=Utils.next(t.award_list))for(var i in t.award_list){var n={};n.id=t.award_list[i].id,n.status=t.award_list[i].status,n.sort=e[n.status],this.reward_list[t.award_list[i].id-1]=n}this.reward_list.sort(Utils.tableLowerSorter(["sort","id"])),this.updateRedPoint(),gcore.GlobalEvent.fire(s.Update_All_Data)},setRewardData:function(t){if(this.reward_list&&t[0]){var e={0:2,1:1,2:3};for(var i in this.reward_list)if(this.reward_list[i].id==t[0].id){this.reward_list[i].status=t[0].status,this.reward_list[i].sort=e[t[0].status];break}this.reward_list.sort(Utils.tableLowerSorter(["sort","id"]))}},sortFunc:function(t){return t.sort(function(t,e){return t.sort!=e.sort?!(!t.sort||!e.sort)&&t.sort-e.sort:t.id-e.id}),t},getRewardData:function(t){if(this.reward_list)return null==t?this.reward_list||{}:this.reward_list[t]||{}},updateRedPoint:function(){RedMgr.getInstance().addCalHandler(this.checkRedPoint.bind(this),RedIds.StarTower)},checkRedPoint:function(){if(this.ctrl.checkIsOpen()){var e=!1;for(var i in this.reward_list)if(1==this.reward_list[i].status){e=!0;break}e=e||this.less_count>0;var s=t("scene_const");t("mainscene_controller").getInstance().setBuildRedStatus(s.CenterSceneBuild.startower,{bid:1,status:e})}},updateMaxTower:function(t){t&&t.max_tower&&this.max_tower<t.max_tower&&(this.max_tower=t.max_tower),gcore.GlobalEvent.fire(s.Fight_Success_Event)},updateLessCount:function(t){null!=t.count&&(this.less_count=t.count||0,this.updateRedPoint()),null!=t.buy_count&&(this.buy_count=t.buy_count),gcore.GlobalEvent.fire(s.Count_Change_Event)},getNowTowerId:function(){return this.max_tower||0},getTowerLessCount:function(){return this.less_count},getBuyCount:function(){return this.buy_count}});cc._RF.pop()},{mainscene_controller:"mainscene_controller",scene_const:"scene_const",startower_controller:"startower_controller",startower_event:"startower_event"}],stone_dungeon_controller:[function(t,e,i){"use strict";cc._RF.push(e,"468cdO454JJ27qtFdOjsLqw","stone_dungeon_controller");var s=t("stone_dungeon_event"),n=cc.Class({extends:BaseController,ctor:function(){},initConfig:function(){var e=t("stone_dungeon_model");this.model=new e,this.model.initConfig()},getModel:function(){return this.model},registerEvents:function(){},registerProtocals:function(){this.RegisterProtocal(13030,this.on13030),this.RegisterProtocal(13031,this.on13031),this.RegisterProtocal(13032,this.on13032)},openStoneDungeonView:function(e){if(e){var i=Config.dailyplay_data.data_exerciseactivity[1];if(null==i)return void message(Utils.TI18N("\u65e5\u5e38\u526f\u672c\u6570\u636e\u5f02\u5e38"));if(0==t("mainui_controller").getInstance().checkIsOpenByActivate(i.activate))return void message(i.lock_desc);this.stoneDungeonView||(this.stoneDungeonView=Utils.createClass("stone_dungeon_window",this)),this.stoneDungeonView&&0==this.stoneDungeonView.isOpen()&&this.stoneDungeonView.open()}else this.stoneDungeonView&&(this.stoneDungeonView.close(),this.stoneDungeonView=null)},send13030:function(){this.SendProtocal(13030,{})},on13030:function(t){this.model.setChangeSweepCount(t.list),this.model.setPassClearanceID(t.pass_list),gcore.GlobalEvent.fire(s.Update_StoneDungeon_Data,t)},send13031:function(t){this.SendProtocal(13031,{id:t})},on13031:function(t){message(t.msg)},send13032:function(t){this.SendProtocal(13032,{id:t})},on13032:function(t){message(t.msg)},getStoneDungeonRoot:function(t){if(t)this.stoneDungeonView?this.stoneDungeonView.getRootWnd(t):t(null);else if(this.stoneDungeonView)return this.stoneDungeonView.root_wnd}});e.exports=n,cc._RF.pop()},{mainui_controller:"mainui_controller",stone_dungeon_event:"stone_dungeon_event",stone_dungeon_model:"stone_dungeon_model"}],stone_dungeon_event:[function(t,e,i){"use strict";cc._RF.push(e,"c9dfan5dbFIfKt52OYagEFt","stone_dungeon_event"),e.exports={Update_StoneDungeon_Data:"Stone_dungeonEvent.Updata_StoneDungeon_Data"},cc._RF.pop()},{}],stone_dungeon_item:[function(t,e,i){"use strict";cc._RF.push(e,"e20d8x3o6VCnaZ5M6KHlYYd","stone_dungeon_item");var s=t("pathtool"),n=t("stone_dungeon_controller"),a=t("role_controller");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("stonedungeon","stone_dungeon_item"),this.ctrl=n.getInstance(),this.model=n.getInstance().getModel()},initConfig:function(){this.item_list=[],this.role_vo=a.getInstance().getRoleVo()},initPanel:function(){this.Image_bg=this.root_wnd.getChildByName("Image_bg").getComponent(cc.Sprite),this.loadRes(s.getCommonIcomPath("common_1029"),function(t){this.Image_bg.spriteFrame=t}.bind(this)),this.item_scrollView=this.root_wnd.getChildByName("item_scrollview"),this.content=this.item_scrollView.getChildByName("content"),this.diff_lev=this.root_wnd.getChildByName("diff_lev").getComponent(cc.Sprite),this.diff_text=this.root_wnd.getChildByName("diff_lev").getChildByName("Text_1").getComponent(cc.Label),this.jian=this.root_wnd.getChildByName("Sprite_1"),this.jian.active=!1,this.textNumber=this.root_wnd.getChildByName("textNumber").getComponent(cc.Label),this.btnChange=this.root_wnd.getChildByName("btnChange"),this.textChange=this.btnChange.getChildByName("btn_label").getComponent(cc.RichText),this.textChange.string=Utils.TI18N("<color=#ffffff><outline color=#6c2b00 width=2>\u6311\u6218</outline></color>"),this.btnChange.sprite=this.btnChange.getComponent(cc.Sprite),this.btnClear=this.root_wnd.getChildByName("btnClear"),this.textClear=this.btnClear.getChildByName("btn_label").getComponent(cc.RichText),this.textClear.string=Utils.TI18N("<color=#ffffff><outline color=#2b610d width=2>\u626b\u8361</outline></color>"),this.btnClear.active=!1,this.dungeonData&&this.setChangeData()},registerEvent:function(){Utils.onTouchEnd(this.btnClear,function(){this.ctrl.send13032(this.dungeonData.id)}.bind(this),1),Utils.onTouchEnd(this.btnChange,function(){this.role_vo.lev<this.dungeonData.lev_limit?message(this.dungeonData.lev_limit+Utils.TI18N("\u7ea7\u5f00\u542f")):this.ctrl.send13031(this.dungeonData.id)}.bind(this),1)},setExtendData:function(t){this.expend=t.expend,this.free_count=t.count,this.title_pos=t.title_pos},setData:function(t){this.dungeonData=t,this.setChangeData(t)},setChangeData:function(){if(this.root_wnd){this.btnChange.name="stone_change_btn_"+this.dungeonData.id,""!=this.dungeonData.title_name?this.diff_text.string=this.dungeonData.title_name:this.diff_text.string="",this.title_pos==this.dungeonData.difficulty?this.jian.active=!0:this.jian.active=!1,this.btnChange.active=!1,this.btnClear.active=!1;var t=gdata("color_data","data_color16",253+this.dungeonData.difficulty);this.diff_text.node.color.fromHEX(t),this.textNumber.string=cc.js.formatStr(Utils.TI18N("\u6218\u529b%d\u5f00\u542f"),this.dungeonData.power||0),this.textNumber.node.active=!0;var e=1,i=this.model.getPassClearanceID(this.dungeonData.id);if(this.btnChange.getComponent(cc.Button).interactable=!0,this.btnChange.getComponent(cc.Button).enableAutoGrayEffect=!1,i&&1==i.status)this.role_vo.max_power>=this.dungeonData.power?(this.textNumber.node.active=!1,this.btnClear.active=!0,0==this.free_count?(this.textClear.string=cc.js.formatStr(Utils.TI18N("<img src='%s'/><color=#ffffff><outline color=#2b610d width=2>%s \u626b\u8361</outline></color>"),15,this.expend),this.loadRes(s.getItemRes(15),function(t){this.textClear.spriteFrame=t}.bind(this))):this.textClear.string=Utils.TI18N("<color=#ffffff><outline color=#2b610d width=2>\u626b\u8361</outline></color>")):(this.btnClear.active=!1,this.btnChange.active=!0,this.textChange.string=Utils.TI18N("<color=#ffffff >\u672a\u5f00\u542f</color>"),this.btnChange.getComponent(cc.Button).interactable=!1,this.btnChange.getComponent(cc.Button).enableAutoGrayEffect=!0),e=null;else if(this.btnClear.active=!1,this.role_vo.max_power>=this.dungeonData.power){this.textNumber.node.active=!1,this.btnChange.active=!0;var n=!1;if(this.role_vo.lev<this.dungeonData.lev_limit){var a=cc.js.formatStr(Utils.TI18N("<color=#ffffff >%d\u7ea7\u5f00\u542f</color>"),this.dungeonData.lev_limit);this.textChange.string=a,n=!0}else 0==this.free_count?(this.textChange.string=cc.js.formatStr(Utils.TI18N("<img src='%s'/><color=#ffffff><outline color=#6c2b00 width=2>%s \u6311\u6218</outline></color>"),15,this.expend),this.loadRes(s.getItemRes(15),function(t){this.textChange.spriteFrame=t}.bind(this))):this.textChange.string=Utils.TI18N("<color=#ffffff><outline color=#6c2b00 width=2>\u6311\u6218</outline></color>");this.btnChange.getComponent(cc.Button).interactable=!n,this.btnChange.getComponent(cc.Button).enableAutoGrayEffect=n}else{this.btnChange.active=!0;a=Utils.TI18N("<color=#ffffff >\u672a\u5f00\u542f</color>");this.role_vo.lev<this.dungeonData.lev_limit&&(a=cc.js.formatStr(Utils.TI18N("<color=#ffffff >%d\u7ea7\u5f00\u542f</color>"),this.dungeonData.lev_limit)),this.textChange.string=a,this.btnChange.getComponent(cc.Button).interactable=!1,this.btnChange.getComponent(cc.Button).enableAutoGrayEffect=!0}for(var o in this.loadRes(s.getUIIconPath("activity",this.dungeonData.pis_str),function(t){this.diff_lev.spriteFrame=t}.bind(this)),this.item_list)this.item_list[o].setVisible(!1);this.firstAward(e),this.showAward(e),this.item_scrollView&&(this.item_scrollView.off(cc.Node.EventType.TOUCH_START,this.item_scrollView._onTouchBegan,this.item_scrollView,!0),this.item_scrollView.off(cc.Node.EventType.TOUCH_MOVE,this.item_scrollView._onTouchMoved,this.item_scrollView,!0),this.item_scrollView.off(cc.Node.EventType.TOUCH_END,this.item_scrollView._onTouchEnded,this.item_scrollView,!0),this.item_scrollView.off(cc.Node.EventType.TOUCH_CANCEL,this.item_scrollView._onTouchCancelled,this.item_scrollView,!0))}},firstAward:function(t){if(t&&this.dungeonData.first_items[0]){if(!this.item_list[0]){var e=ItemsPool.getInstance().getItem("backpack_item");e.setParent(this.content),e.initConfig(null,.8,!1,!1),e.setAnchorPoint(0,.5),e.show(),this.item_list[0]=e}this.item_list[0]&&(this.item_list[0].setVisible(!0),this.item_list[0].setPosition(cc.v2(4,0)),this.item_list[0].setData({bid:this.dungeonData.first_items[0][0],num:this.dungeonData.first_items[0][1]}),this.item_list[0].setDefaultTip())}},showAward:function(t){var e=t?1:0;this.dungeonData.first_items[0]||(e=0,t=null);var i=135*(this.dungeonData.show_items.length+e)*.8+5*(this.dungeonData.show_items.length+e);for(var s in this.content.setContentSize(cc.size(i,this.content.getContentSize().height)),this.item_scrollView.setContentSize(cc.size(i,this.content.getContentSize().height)),this.dungeonData.show_items){s=parseInt(s);if(!this.item_list[1+s]){var n=ItemsPool.getInstance().getItem("backpack_item");n.setAnchorPoint(0,.5),n.initConfig(null,.8,!1,!1),n.setParent(this.content),n.show(),this.item_list[1+s]=n}this.item_list[1+s]&&(t?this.item_list[1+s].setPosition(4*(s+1)+109*s+54.5,0):this.item_list[1+s].setPosition(4*s+109*s+54.5,0),this.item_list[1+s].setVisible(!0),this.item_list[1+s].setData({bid:this.dungeonData.show_items[s][0],num:this.dungeonData.show_items[s][1]}),this.item_list[1+s].setDefaultTip())}},onShow:function(t){},onHide:function(){},onDelete:function(){if(this.item_list){for(var t in this.item_list){var e=this.item_list[t];e&&(e.deleteMe(),e=null)}this.item_list=null}}});cc._RF.pop()},{pathtool:"pathtool",role_controller:"role_controller",stone_dungeon_controller:"stone_dungeon_controller"}],stone_dungeon_model:[function(t,e,i){"use strict";cc._RF.push(e,"28775ubKnJDb7l3GSeOCKkh","stone_dungeon_model");var s=t("mainui_controller");cc.Class({extends:BaseClass,ctor:function(){this.change_count={},this.passClearanceId={}},properties:{},initConfig:function(){},setPassClearanceID:function(t){if(t&&null!=Utils.next(t))for(var e in t)this.passClearanceId[t[e].id]={status:1}},getPassClearanceID:function(t){return this.passClearanceId?this.passClearanceId[t]:null},setChangeSweepCount:function(t){if(t&&null!=Utils.next(t))for(var e in t)this.change_count[t[e].type]=t[e].day_num;this.updateRedPoint()},getChangeSweepCount:function(t){return this.change_count&&null!=this.change_count[t]?this.change_count[t]:2},updateRedPoint:function(){RedMgr.getInstance().addCalHandler(this.checkRed.bind(this),RedIds.StoneDungeon)},checkRed:function(){var e=this.checkRedStatus(),i=t("mainui_const"),n=t("scene_const");s.getInstance().setBtnRedPoint(i.btn_index.esecsice,{bid:n.RedPointType.dungeonstone,status:e})},checkRedStatus:function(){var t=Config.dungeon_stone_data.data_type_open;if(t&&t[1]&&t[1].activate){if(0==(n=s.getInstance().checkIsOpenByActivate(t[1].activate)))return!1;if(!this.change_count)return;for(var e=Config.dungeon_stone_data.data_type_open_length,i=1;i<=e;i++){var n=s.getInstance().checkIsOpenByActivate(t[i].activate)||!1;if((this.change_count[i]||0)<2&&1==n)return!0}return!1}return!1}});cc._RF.pop()},{mainui_const:"mainui_const",mainui_controller:"mainui_controller",scene_const:"scene_const"}],stone_dungeon_tab:[function(t,e,i){"use strict";cc._RF.push(e,"13389YR1bxA+46WkBW1uBn3","stone_dungeon_tab");var s=t("pathtool"),n=t("mainui_controller");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("stonedungeon","stone_dungeon_tab")},initConfig:function(){this.item_list=[]},initPanel:function(){this.normal=this.root_wnd.getChildByName("normal").getComponent(cc.Sprite),this.title=this.root_wnd.getChildByName("title").getComponent(cc.Label),this.condite=this.root_wnd.getChildByName("condite"),this.condite_img=this.condite.getComponent(cc.Sprite),this.loadRes(s.getUIIconPath("activity","txt_cn_activity_3"),function(t){this.condite_img.spriteFrame=t}.bind(this)),this.redpoint=this.root_wnd.getChildByName("redpoint"),this.select=this.root_wnd.getChildByName("select"),this.select_img=this.select.getComponent(cc.Sprite),this.loadRes(s.getUIIconPath("activity","activity_7"),function(t){this.select_img.spriteFrame=t}.bind(this)),this.select.active=!1,this.effect=this.root_wnd.getChildByName("seleEff").getComponent(sp.Skeleton);var t=s.getSpinePath(s.getEffectRes(547),"action");this.loadRes(t,function(t){this.effect.skeletonData=t,this.effect.setAnimation(0,PlayerAction.action,!0)}.bind(this)),this.effect.node.active=!1,this.data&&this.updateInfo()},registerEvent:function(){this.root_wnd.on(cc.Node.EventType.TOUCH_START,function(t){var e=t.getTouches();this.touch_began=e[0].getLocation()},this),this.root_wnd.on(cc.Node.EventType.TOUCH_END,function(t){var e=t.getTouches();this.touch_end=e[0].getLocation();var i=!0;null!=this.touch_began&&(i=Math.abs(this.touch_end.x-this.touch_began.x)<=20&&Math.abs(this.touch_end.y-this.touch_began.y)<=20),1==i&&(Utils.playButtonSound(1),this.callback&&this.callback(this))},this)},setData:function(t){t&&null!=Utils.next(t)&&(this.data=t,this.updateInfo())},updateInfo:function(){if(this.root_wnd){var t=s.getUIIconPath("activity","activity_tab_"+this.data.id,!1,!1);this.loadRes(t,function(t){this.normal.spriteFrame=t}.bind(this)),this.title.string=Config.dungeon_stone_data.data_type_open[this.data.id].name,1==this.data.id&&this.setSelect(!0);var e=n.getInstance().checkIsOpenByActivate(Config.dungeon_stone_data.data_type_open[this.data.id].activate);this.condite.active=1!=e}},setSelect:function(t){this.select&&this.effect&&(this.select.active=t,this.effect.node.active=t)},setSelectRedPoint:function(t){this.redpoint&&(this.redpoint.active=t)},getData:function(){return this.data},addCallBack:function(t){this.callback=t},onShow:function(t){},onHide:function(){},onDelete:function(){this.effect&&(this.effect.setToSetupPose(),this.effect.clearTracks())}});cc._RF.pop()},{mainui_controller:"mainui_controller",pathtool:"pathtool"}],stone_dungeon_window:[function(t,e,i){"use strict";cc._RF.push(e,"09ce7eDPQhM8KRslRou8T7R","stone_dungeon_window");var s=t("pathtool"),n=t("stone_dungeon_controller"),a=t("common_scrollview"),o=t("stone_dungeon_event"),l=t("role_controller"),r=t("mainui_controller");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("stonedungeon","stone_dungeon_window"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Big,this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){this.role_vo=l.getInstance().getRoleVo(),this.first_come_in=!0,this.cur_index=1,this.tab_list=[]},openCallBack:function(){this.background=this.root_wnd.getChildByName("background"),this.background.scale=FIT_SCALE,this.main_container=this.root_wnd.getChildByName("main_container"),this.background_img=this.main_container.getChildByName("background").getComponent(cc.Sprite),this.loadRes(s.getCommonIcomPath("common_1003"),function(t){this.background_img.spriteFrame=t}.bind(this)),this.Image_2_0=this.main_container.getChildByName("Image_2_0").getComponent(cc.Sprite),this.Image_2=this.main_container.getChildByName("Image_2").getComponent(cc.Sprite),this.loadRes(s.getCommonIcomPath("common_1013"),function(t){this.Image_2_0.spriteFrame=t,this.Image_2.spriteFrame=t}.bind(this)),this.Image_3=this.main_container.getChildByName("Image_3").getComponent(cc.Sprite),this.loadRes(s.getUIIconPath("activity","activity_8"),function(t){this.Image_3.spriteFrame=t}.bind(this)),this.Image_1=this.main_container.getChildByName("Image_1").getComponent(cc.Sprite),this.loadRes(s.getCommonIcomPath("common_1002"),function(t){this.Image_1.spriteFrame=t}.bind(this)),this.textCount=this.main_container.getChildByName("textCount").getComponent(cc.Label),this.banner_node=this.main_container.getChildByName("banner"),this.banner_node.scale=2,this.banner=this.banner_node.getComponent(cc.Sprite),this.close_btn=this.main_container.getChildByName("close_btn"),this.btnRule=this.main_container.getChildByName("btnRule"),this.scoreView=this.main_container.getChildByName("scoreView"),this.scoreView_img=this.scoreView.getChildByName("background").getComponent(cc.Sprite),this.loadRes(s.getCommonIcomPath("common_1034"),function(t){this.scoreView_img.spriteFrame=t}.bind(this)),this.tab_container=this.main_container.getChildByName("tab_container");var e={item_class:t("stone_dungeon_tab"),start_x:0,space_x:32,start_y:0,space_y:0,item_width:120,item_height:136,row:1,col:0},i=this.tab_container.getContentSize();this.tabScrollview=new a,this.tabScrollview.createScroll(this.tab_container,cc.v2(0,0),ScrollViewDir.horizontal,ScrollViewStartPos.top,i,e);e={item_class:t("stone_dungeon_item"),start_x:0,space_x:0,start_y:0,space_y:0,item_width:616,item_height:125,row:0,col:1,once_num:5},i=cc.size(616,490);this.itemScrollview=new a,this.itemScrollview.createScroll(this.scoreView,cc.v2(0,-255),ScrollViewDir.vertical,ScrollViewStartPos.top,i,e,cc.v2(.5,.5))},registerEvent:function(){this.close_btn.on(cc.Node.EventType.TOUCH_END,function(t){n.getInstance().openStoneDungeonView(!1)},this),this.addGlobalEvent(o.Update_StoneDungeon_Data,function(t){this.changeDungeonData(this.cur_index,1),this.first_come_in=!1,this.redPointStatus()}.bind(this)),this.btnRule.on(cc.Node.EventType.TOUCH_END,function(e){var i=Config.dungeon_stone_data.data_const.desc_rule;Utils.playButtonSound(1);var s=e.touch.getLocation();t("tips_controller").getInstance().showCommonTips(i.desc,s)},this)},redPointStatus:function(){for(var t=[],e=Config.dungeon_stone_data.data_type_open_length,i=Config.dungeon_stone_data.data_const.dungeon_type.val,s=0;s<e;s++){var n=this.model.getChangeSweepCount(i[s]);t[i[s]]=!1;var a=r.getInstance().checkIsOpenByActivate(Config.dungeon_stone_data.data_type_open[i[s]].activate);n<2&&1==a&&(t[i[s]]=!0);var o=this.tab_list[s];o&&o.setSelectRedPoint(t[i[s]]||!1)}for(a=!1,s=1;s<=e;s++)a=a||t[s]||!1;return a},changeDungeonData:function(t,e){t=Config.dungeon_stone_data.data_type_open[t].id||1;var i=this.model.getChangeSweepCount(t),s="",n=1;if(i>=2)if(n=0,i>=Config.dungeon_stone_data.data_buy[t].length)s=cc.js.formatStr(Utils.TI18N("\u4eca\u65e5\u5df2\u65e0\u6b21\u6570"));else{var a=1;for(var o in Config.dungeon_stone_data.data_buy[t])Config.dungeon_stone_data.data_buy[t][o].vip<=this.role_vo.vip_lev&&(a=o);var l=a-i;l<=0&&(l=0),s=cc.js.formatStr(Utils.TI18N("\u4eca\u65e5\u5269\u4f59\u6b21\u6570: %d"),l)}else s=cc.js.formatStr(Utils.TI18N("\u4eca\u65e5\u514d\u8d39\u6b21\u6570: %d"),Config.dungeon_stone_data.data_const.free_num.val-i);if(this.textCount.string=s,this.itemScrollview){var r=[];for(var o in Config.dungeon_stone_data.data_award_list)Config.dungeon_stone_data.data_award_list[o].dun_type==t&&r.push(Config.dungeon_stone_data.data_award_list[o]);r.sort(function(t,e){return t.id-e.id});var c=this.getPoerTitle(r);i+=1;var _=Object.keys(Config.dungeon_stone_data.data_buy[t]);i>=_.length&&(i=_.length);var h={title_pos:c,count:n,expend:Config.dungeon_stone_data.data_buy[t][i].cost},d=this.itemScrollview.getItemList();if(1==e&&0==this.first_come_in)for(var o in d)d[o].setExtendData(h),d[o].setChangeData(r[o]);else this.itemScrollview.setData(r,null,h),this.itemScrollview.jumpToMove(cc.v2(0,125*(c-1)),.2)}},getPoerTitle:function(t){var e=-1,i=t.length;for(var s in t){var n=this.model.getPassClearanceID(t[s].id);this.role_vo.max_power>=t[s].power&&n&&1==n.status&&(e=parseInt(s))}if(e+1>=i)e=i;else{if(!(t[e+1]&&this.role_vo.max_power>=t[e+1].power&&this.role_vo.lev>=t[e+1].lev_limit))return e+1;e+=2}return e},openRootWnd:function(t){this.ctrl.send13030();for(var e=Config.dungeon_stone_data.data_const.dungeon_type.val,i=[],n=0;n<e.length;n++)i.push({id:e[n]});var a=s.getIconPath("activity/activity_big","activity_banner_1",!1,!1);this.loadRes(a,function(t){this.banner.spriteFrame=t}.bind(this));var o=function(t){if(0!=r.getInstance().checkIsOpenByActivate(Config.dungeon_stone_data.data_type_open[t.getData().id].activate)){if(this.cur_index!=t.getData().id){var e=this.tabScrollview.getItemList();for(var i in e)e[i].getData().id==t.getData().id?e[i].setSelect(!0):e[i].setSelect(!1);this.cur_index=t.getData().id,this.changeDungeonData(t.getData().id);var n=s.getIconPath("activity/activity_big","activity_banner_"+Config.dungeon_stone_data.data_type_open[t.getData().id].id,!1,!1);this.loadRes(n,function(t){this.banner.spriteFrame=t}.bind(this))}}else message(Config.dungeon_stone_data.data_type_open[t.getData().id].desc)}.bind(this);this.tabScrollview.setData(i,o),this.tabScrollview&&this.tabScrollview.addEndCallBack(function(){var t=this.tabScrollview.getItemList();for(var e in t)this.tab_list.push(t[e]);this.redPointStatus()}.bind(this))},closeCallBack:function(){for(var t in n.getInstance().openStoneDungeonView(!1),this.tabScrollview&&(this.tabScrollview.DeleteMe(),this.tabScrollview=null),this.itemScrollview&&(this.itemScrollview.DeleteMe(),this.itemScrollview=null),this.tab_list)this.tab_list[t].deleteMe&&(this.tab_list[t].deleteMe(),this.tab_list[t]=null);this.tab_list=[]}});cc._RF.pop()},{common_scrollview:"common_scrollview",mainui_controller:"mainui_controller",pathtool:"pathtool",role_controller:"role_controller",stone_dungeon_controller:"stone_dungeon_controller",stone_dungeon_event:"stone_dungeon_event",stone_dungeon_item:"stone_dungeon_item",stone_dungeon_tab:"stone_dungeon_tab",tips_controller:"tips_controller"}],story_controller:[function(t,e,i){"use strict";cc._RF.push(e,"ee4c9A9elhKrYRxAgCA1AbY","story_controller");var s=t("story_view"),n=cc.Class({extends:BaseController,ctor:function(){},initConfig:function(){var e=t("story_model");this.model=new e(this),this.model.initConfig(),this.view=new s(this)},getModel:function(){return this.model},registerEvents:function(){},registerProtocals:function(){this.RegisterProtocal(11101,this.handle11101.bind(this)),this.RegisterProtocal(11102,this.handle11102.bind(this)),this.RegisterProtocal(11100,this.handle11100.bind(this))},handle11101:function(t){cc.log("\u6536\u5230\u670d\u52a1\u7aef\u6267\u884c\u5267\u60c5\u534f\u8bae"),cc.log(t),this.model.setCurStory(t)},send11102:function(t){var e={};e.drama_bid=t,this.SendProtocal(11102,e)},handle11102:function(t){this.model&&1==t.code&&gcore.GlobalEvent.fire(StoryEvent.SKIP_STORY)},send11100:function(t,e){cc.log("\u901a\u77e5\u670d\u52a1\u7aef\u5267\u60c5\u6b65\u9aa4--"+t+"--"+e);var i={};i.drama_bid=t,i.step_id=e,this.SendProtocal(11100,i)},handle11100:function(t){this.view&&this.view.playStepOver()},isInStory:function(){return!!this.model&&this.model.isStoryState()}});e.exports=n,cc._RF.pop()},{story_model:"story_model",story_view:"story_view"}],story_event:[function(t,e,i){"use strict";cc._RF.push(e,"cbc77Y9GxNLnIffL0wU6QyG","story_event");var s=s||{};s.SHOW_BLACK_SCREEN="StoryEvent.SHOW_BLACK_SCREEN",s.READ_CONFIG_COMPLETE="StoryEvent.READ_CONFIG_COMPLETE",s.STORY_OVER="StoryEvent.STORY_OVER",s.PLAY_NEXT_ACT="StoryEvent.PLAY_NEXT_ACT",s.SKIP_STORY="storyevent.skip_story",s.UNIT_MORPH="storyevent.unit_morph",s.BATTLE_RESULT_OVER="StoryEvent.BATTLE_RESULT_OVER",s.PREPARE_PLAY_PLOT="StoryEvent.PREPARE_PLAY_PLOT",e.exports=s,cc._RF.pop()},{}],story_model:[function(t,e,i){"use strict";cc._RF.push(e,"b84b3Koa55LQ76IHhuo5iUi","story_model");var s=t("story_event"),n=t("role_controller");cc.Class({extends:BaseClass,ctor:function(){this.ctrl=arguments[0]},properties:{},initConfig:function(){this.save_drama_list=null,this.cur_story_bid=null,this.cur_story=null,this.cur_act_list=null,this.is_story_state=!1,this.is_story_fight=!1,this.temp_story_list=[]},setCurStory:function(t){for(var e in this.save_drama_list||this.initDrama(),this.save_drama_list)if(this.save_drama_list[t.drama_bid])return;if(this.is_story_state){if(cc.log("model\u7f13\u5b58\u5267\u60c5"),this.cur_story_bid==t.drama_bid)return;for(var i in this.temp_story_list){if(this.temp_story_list[i].drama_bid==t.drama_bid)return}this.temp_story_list.push(t)}else this.cur_story_bid=t.drama_bid,this.cur_story=Config.drama_data.data_get[t.drama_bid],this.cur_story&&this.cur_story.act?(this.cur_act_list=this.cur_story.act,gcore.GlobalEvent.fire(s.READ_CONFIG_COMPLETE)):this.ctrl.send11100(this.cur_story_bid,0)},isPlayNextStory:function(){if(this.temp_story_list.length>0){var t=this.temp_story_list.shift();this.setCurStory(t)}},getCurStoryBid:function(){return this.cur_story_bid},getCurStory:function(){return this.cur_story},getCurActList:function(){return this.cur_act_list},setStoryState:function(t){this.is_story_state=t,t||(gcore.GlobalEvent.fire(s.STORY_OVER),this.isPlayNextStory())},isStoryState:function(){return this.is_story_state},setStoryFight:function(t){this.is_story_fight=t},isStoryFight:function(){return this.is_story_fight},clearActData:function(){this.cur_story_bid=null,this.cur_story=null,this.cur_act_list=null},saveDrama:function(t){if(!this.save_drama_list[t]){this.save_drama_list[t]=!0;var e=n.getInstance().getRoleVo();cc.sys.localStorage.setItem("drama_data"+e.srv_id+e.rid,JSON.stringify(this.save_drama_list))}},initDrama:function(){var t=n.getInstance().getRoleVo(),e=cc.sys.localStorage.getItem("drama_data"+t.srv_id+t.rid);this.save_drama_list=e&&JSON.parse(e)||{}}});cc._RF.pop()},{role_controller:"role_controller",story_event:"story_event"}],story_talk:[function(t,e,i){"use strict";cc._RF.push(e,"aff996Wx4lG7ZTry6t+wHme","story_talk");var s=t("pathtool"),n=t("story_event");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("drama","dramatalk_view"),this.talk_view=arguments[0]},initConfig:function(){this.item_info_list=[],this.item_show_list=[],this.head_item_height=192,this.item_height=140},initPanel:function(){this.head_msg_nd=this.seekChild("head_msg"),this.item_nd=this.seekChild("talk_item"),this.items_con_nd=this.seekChild("items_con"),this.mask_bg_nd=this.seekChild("mask_bg"),this.image_bg_nd=this.seekChild("image_bg"),this.mask_bg_nd.scale=FIT_SCALE,this.image_bg_nd.width=this.image_bg_nd.width*FIT_SCALE,this.left_ani_nd=this.seekChild("left_ani"),this.left_ani_sp=this.seekChild("left_ani",sp.Skeleton),this.items_con_nd.on(cc.Node.EventType.TOUCH_END,this.onClickMsgCon,this),this.mask_bg_nd.on(cc.Node.EventType.TOUCH_END,this.onClickMaskBg,this),this.statu||(this.root_wnd.active=!1)},registerEvent:function(){},onShow:function(t){if(this.item_info_list.length>0)for(var e in this.item_info_list)this.addMessageItem(this.item_info_list[e]);t&&t()},onHide:function(){},onDelete:function(){},addMessage:function(t,e,i,s,n){var a={type:t=t||1,bid:e,actiontype:i=i||1,name:s,msg:n,index:this.item_info_list.length};this.item_info_list.push(a),this.root_wnd&&this.addMessageItem(a)},addMessageItem:function(t){var e=this.item_info_list.length;if(this.max_height=(e-1)*this.item_height+this.head_item_height,this.max_height=Math.max(this.max_height,this.items_con_nd.height),this.items_con_nd.height=this.max_height,this.refreshTopItem(t),t&&this.item_info_list.length>1){var i=this.item_info_list[this.item_info_list.length-2];this.updateNomalMsgs(),this.createNormalItem(i)}this.showRoleSpine(t.type,t.bid,t.actiontype)},createNormalItem:function(t){var e={},i=e.item_nd=cc.instantiate(this.item_nd),s=e.act_nd=this.seekChild(i,"nor_msg"),n=(e.name_lb=this.seekChild(i,"nor_name",cc.Label),e.msg_rt=this.seekChild(i,"msg_txt",cc.RichText));s.string=t.name,n.string=t.msg,this.items_con_nd.addChild(i),i.position=cc.v2(0,-this.head_item_height),this.item_show_list.push(e),this.runNodeAct(i)},updateNomalMsgs:function(){for(var t in this.item_show_list)this.item_show_list[t].item_nd.y-=this.item_height,this.runNodeAct(this.item_show_list[t].item_nd)},refreshTopItem:function(t){var e=this.seekChild(this.head_msg_nd,"msg_con"),i=this.seekChild(this.head_msg_nd,"name",cc.Label),s=this.seekChild(this.head_msg_nd,"msg_txt",cc.RichText);this.runNodeAct(e),i.string=t.name,s.string=t.msg,this.can_click=!1;var n=cc.callFunc(function(){this.can_click=!0},this),a=cc.delayTime(.5),o=cc.sequence(a,n);this.root_wnd.runAction(o)},runNodeAct:function(t){if(t){t.y+=t.height;var e=cc.moveBy(.2,cc.v2(0,-t.height));t.runAction(e)}},showRoleSpine:function(t,e,i){var n=this.getSpineActionName(i),a=s.getEffectRes(e),o=s.getSpinePath(a);this.loadRes(o,function(t,e){this.left_ani_sp.skeletonData=e,this.left_ani_sp.setAnimation(0,t,!0)}.bind(this,n))},getSpineActionName:function(t){return t&&"number"==typeof t&&"action"+t,"action"},clearData:function(){for(var t in this.item_info_list=[],this.item_show_list)this.item_show_list[t].item_nd.destroy();this.item_show_list=[],this.items_con_nd.height=680},onClickMsgCon:function(){this.can_click&&this.playNextAcrt()},playNextAcrt:function(){gcore.GlobalEvent.fire(n.PLAY_NEXT_ACT)},onClickMaskBg:function(){this.can_click&&this.playNextAcrt()},changeStatus:function(t){this.statu=t,t?this.root_wnd&&(this.root_wnd.active=!0):this.root_wnd&&(this.root_wnd.active=!1)}});cc._RF.pop()},{pathtool:"pathtool",story_event:"story_event"}],story_view:[function(t,e,i){"use strict";function s(t){"@babel/helpers - typeof";return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}cc._RF.push(e,"65e1efmZ5JLibI8wyVHsEb/","story_view");t("pathtool");var n=t("battle_controller"),a=t("story_event"),o=t("story_talk"),l=t("battle_const"),r=t("startower_controller"),c=t("levupgrade_controller"),_=t("guide_const"),h=t("mainui_controller"),d=t("mainui_const");cc.Class({extends:BaseView,ctor:function(){this.viewTag=SCENE_TAG.msg,this.ctrl=arguments[0],this.model=this.ctrl.getModel(),this.initRootWind()},initRootWind:function(){this.root_wnd=new cc.Node;var t=this.root_wnd.addComponent(cc.Widget);t.isAlignBottom=!0,t.isAlignTop=!0,t.top=0,t.bottom=0,this.event_block=this.root_wnd.addComponent(cc.BlockInputEvents),this.event_block.enabled=!1,ViewManager.getInstance().addToSceneNode(this.root_wnd,this.viewTag),this.openCallBack(),this.registerEvent()},initConfig:function(){this.cur_drama=null,this.cur_act_list={},this.cur_step=0,this.talk=null,this.is_next_action=!1,this.battle_ctrl=n.getInstance(),this.battle_ctrl.getIsNoramalBattle()?this.battle_model=this.battle_ctrl.getHookModel():this.battle_model=this.battle_ctrl.getModel(),this.cur_bubble=null},openCallBack:function(){},registerEvent:function(){this.addGlobalEvent(a.READ_CONFIG_COMPLETE,function(){var t=n.getInstance().getFinishView(l.Fight_Type.Darma),e=r.getInstance().getResultWindow(),i=c.getInstance().waitLevupgrade();t||e||i?(cc.log("\u7f13\u5b58\u5267\u60c5\u56e0\u7d20"),cc.log(!!t),cc.log(e),cc.log(i),i&&c.getInstance().logStatus(),this.can_play_drama_event||(this.can_play_drama_event=this.addGlobalEvent(a.PREPARE_PLAY_PLOT,function(){this.can_play_drama_event&&this.removeGlobalEvent(this.can_play_drama_event),this.can_play_drama_event=null,this.playAct()}.bind(this)))):(cc.log("\u6b63\u5e38\u6267\u884c\u5f15\u5bfc"),this.playAct())}.bind(this)),this.addGlobalEvent(a.PLAY_NEXT_ACT,function(){this.playNextAct()}.bind(this)),this.addGlobalEvent(a.SKIP_STORY,function(){this.storyOverHandler()}.bind(this))},openRootWnd:function(t){},closeCallBack:function(){},doSomeThingForDrama:function(){if(!this.cur_drama||this.cur_drama.bid!=_.special_id.guild&&this.cur_drama.bid!=_.special_id.seerpalace&&this.cur_drama.bid!=_.special_id.stronger){var t=h.getInstance().getMainUIIndex();t!=d.btn_index.drama_scene&&t!=d.btn_index.main_scene?h.getInstance().changeMainUIStatus(d.btn_index.main_scene):this.cur_drama&&this.cur_drama.bid!=_.special_id.guild&&this.cur_drama.bid!=_.special_id.market&&this.cur_drama.bid!=_.special_id.seerpalace&&this.cur_drama.bid!=_.special_id.stronger&&Utils.closeAllWindow()}},playAct:function(){this.cur_drama=this.model.getCurStory(),game.finish_loading?(cc.log("\u5f53\u524d\u6267\u884c\u5267\u60c5\u914d\u7f6e\u6570\u636e"),cc.log(this.cur_drama),this.cur_drama&&(this.event_block.enabled=!0,this.talk?this.readyAct():(this.talk=new o(this),this.talk.setParent(this.root_wnd),this.talk.show(function(){this.addTicket(this.readyAct.bind(this),.1)}.bind(this))))):this.addGlobalEvent(EventId.LOADING_FINISH,function(){this.cur_drama&&this.playAct()}.bind(this))},readyAct:function(){var t=this.cur_drama.act;if(this.cur_act_list=Utils.deepCopy(t),this.doSomeThingForDrama(),this.model.setStoryState(!0),!this.cur_act_list||0==this.cur_act_list.length)return this.storyOverHandler(),void this.ctrl.send11100(this.model.getCurStoryBid(),0);this.cur_step=0,this.playNextAct()},playNextAct:function(){if(this.model.isStoryState())if(this.is_next_action=!1,this.cur_step>0&&this.ctrl.send11100(this.model.getCurStoryBid(),this.cur_step),this.cur_bubble=null,this.cur_step+=1,this.cur_act_list&&this.cur_act_list.length>0){this.hasTicket("delayPlayStory")&&this.delTicker("delayPlayStory");var t=this.cur_act_list.shift();"object"==s(t)?this.actLonelyPlayer(t,!1,this.cur_step):(cc.log("\u7279\u6b8a\u7684\u5267\u60c5\u6570\u636eHHHHH"),cc.log(t))}else this.ctrl.send11100(this.model.getCurStoryBid(),this.cur_step),this.storyOverHandler()},storyOverHandler:function(){this.talk&&(this.talk.clearData(),this.talk.changeStatus(!1)),this.cur_drama&&null!=this.cur_drama.bid&&this.model.saveDrama(this.cur_drama.bid),this.event_block.enabled=!1,this.clearDramaData()},clearDramaData:function(){this.cur_step=0,this.model.setStoryState(!1),this.model.clearActData(),this.cur_drama=null,this.is_next_action=!1},actLonelyPlayer:function(t,e,i){var s=!1;switch((t=Utils.deepCopy(t))[0]){case"unit_dialog":this.showTalk(t[3],t[4],t[5],t[6],t[7]),this.playActSound(t[8]),s=!0;break;case"unit_opening":this.playWelcom(!0,t[3]),this.playActSound(t[4]);break;case"comic_begin":this.playStartManga(!0,t[3],t[4]),this.playActSound(t[5]);break;case"unit_black":this.showBlackCurtain(!0,t[3]),this.playActSound(t[4])}if(this.waiting_timer&&(gcore.Timer.del(this.waiting_timer),this.waiting_timer=null),!e&&s){var n=(t[1]||0)+(t[2]||0);0==n?this.playNextAct():this.addTicket(this.playNextAct.bind(this),n,"delayPlayStory"),this.waiting_timer=gcore.Timer.set(function(){}.bind(this),1e3*(n+3))}else this.storyOverHandler()},playActSound:function(t){t&&Utils.playEffectSound(AUDIO_TYPE.Drama,t)},playWelcom:function(){},showTalk:function(t,e,i,s,n){this.is_next_action=!0,this.talk.changeStatus(!0),this.talk.addMessage(t,e,i,s,n)},playStartManga:function(){},showBlackCurtain:function(){},playStepOver:function(){}});cc._RF.pop()},{battle_const:"battle_const",battle_controller:"battle_controller",guide_const:"guide_const",levupgrade_controller:"levupgrade_controller",mainui_const:"mainui_const",mainui_controller:"mainui_controller",pathtool:"pathtool",startower_controller:"startower_controller",story_event:"story_event",story_talk:"story_talk"}],string_util:[function(t,e,i){"use strict";cc._RF.push(e,"e783aY1FgZLkIb8Lnntomdo","string_util"),window.StringUtil={regex:/(<.*?>|#\d*|[^<>#]+)/gi,parse:function(t,e){return t},parseStr:function(t,e){var i=t.match(/(<.*?>|#\d*|[^<>#]+)/gi);t="";for(var s=[],n=[],a=0,o=i.length;a<o;a++){var l=i[a];if("</div>"==l)s.length>0&&(t+=s.pop());else if(l.length>1&&"#"==l.charAt(0)){t+="<img src='"+l.substr(1)+"' />"}else if(l.length>4&&"<"==l.charAt(0)){var r=l.substr(1,3),c=l.substr(l.length-2,2),_="";if("ass"==r)(u=l.match(/<assets=(\d+)/i))&&2==u.length&&(t+="<img src='"+u[1]+"' />",n.push(u[1]));else if("img"==r){if(!(u=l.match(/\w+=[^\s>]+/gi)))continue;for(var h=0,d=u.length;h<d;h++){(m=u[h].split("=")).length<2||"src"==m[0]&&(t+="<img src='"+m[1].replace(/^['"]|['"]$/gi,"")+"' />",n.push(m[1]))}}else{var u;if(!(u=l.match(/\w+=[^\s>]+/gi)))continue;for(h=0,d=u.length;h<d;h++){var m;if(!((m=u[h].split("=")).length<2)){var f=m[1].replace(/^['"]|['"]$/gi,"");if("fontcolor"==m[0]||"fontColor"==m[0])t+="<color="+f+" >",_="</color>"+_;else if("fontsize"==m[0])t+="<size="+f+" >",_="</size>"+_;else if("click"==m[0])t+="<on click='"+(e||f)+"' param='"+f+"' >",_="</on>"+_;else if("href"==m[0])t+="<u><on click='"+(e||f)+"' param='"+f+"' >",_="</on></u>"+_;else if("outline"==m[0]){var p=m[1].split(",");if(p.length<2)continue;var g="#fffff",v=1;p[0].length>3?(g=p[0],v=p[1]):(g=p[1],v=p[0]),t+="<outline color="+g+" width="+v+" >",_="</outline>"+_}}}}"/>"==c?t+=_:s.push(_)}else t+=l}return{string:t,resArr:n}},richtextSetString:function(t,e,i){t.string=this.parse(e),this.richtextClick(t,i)},richtextClick:function(t,e){e=e||"handler";for(var i=0;i<t._labelSegments.length;++i){var s=t._labelSegments[i];s._clickHandler&&(s._clickParam=s._clickParam||s._clickHandler,s._clickHandler=e)}},splitStr:function(t){},util_num_chn:["\u96f6","\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d","\u4e03","\u516b","\u4e5d","\u5341"],util_num_std:["\u96f6","\u5341","\u767e","\u5343","\u4e07","\u4ebf"],numToChinese:function(t){return t}},e.exports=StringUtil,cc._RF.pop()},{}],strong_main_window:[function(t,e,i){"use strict";cc._RF.push(e,"1533c7/MopOpqQGfjv/Ukj+","strong_main_window");var s=t("stronger_controller"),n=t("pathtool"),a=t("hero_controller"),o=cc.Class({extends:BaseView,ctor:function(){this.prefabPath=n.getPrefabPath("stronger","stronger_main_window"),this.win_type=WinType.Full,this.ctrl=s.getInstance(),this.partner_id=arguments[0]},initConfig:function(){this.view_list={},this.getZiyuanIndex=null,this.zhenrongIndex=null,this.wentiIndex=null},openCallBack:function(){this.bianqiangScrollView=this.seekChild("bianqiangScrollView",cc.ScrollView),this.container=this.seekChild("container"),this.communal_nd=this.seekChild("communal"),this.background_nd=this.seekChild("background"),this.background_nd.scale=FIT_SCALE,this.tab_container_nd=this.seekChild("tab_container"),this.ziyuan_sv=this.seekChild("ziyuan_ScrollView",cc.ScrollView),this.zhenrong_sv=this.seekChild("zhenrong_ScrollView",cc.ScrollView),this.wenti_sv=this.seekChild("wenti_ScrollView",cc.ScrollView),this.back_nd=this.seekChild("close_btn")},registerEvent:function(){for(var t=this,e=function(e){t.tab_container_nd.getChildByName("tab_btn_"+e).on("touchend",function(){Utils.playButtonSound(1),this.createSubPanel(e)},t)},i=1;i<=4;++i)e(i);this.back_nd.on("touchend",function(){this.ctrl.openMainWin(!1),Utils.playButtonSound(2)},this)},openRootWnd:function(t){t=t||1,this.ctrl.setIsFirst(!1),this.createSubPanel(t)},createSubPanel:function(e){var i=this.view_list[e];if(!i)switch(e){case 1:(i=new(t("stronger_panel"))(this.partner_id)).setPosition(0,15),i.setParent(this.container),this.view_list[e]=i;break;case 2:this.view_list[e]=this.ziyuan_sv.content,this.resourcePanel();break;case 3:this.view_list[e]=this.zhenrong_sv.content,this.recommandPanel();break;case 4:this.view_list[e]=this.wenti_sv.content,this.problemPanel()}1==e?(i.show(),this.communal_nd.active=!1):(this.view_list[1].hide(),this.communal_nd.active=!0,this.ziyuan_sv.node.active=!1,this.zhenrong_sv.node.active=!1,this.wenti_sv.node.active=!1,2==e?this.ziyuan_sv.node.active=!0:3==e?this.zhenrong_sv.node.active=!0:4==e&&(this.wenti_sv.node.active=!0))},resourcePanel:function(){var t=n.getPrefabPath("stronger","stronger_item"),e=this,i=[];for(var s in Config.stronger_data.data_resource_one)i.push(Config.stronger_data.data_resource_one[s]);this.startUpdate(i.length,function(s){var a=s,o=new cc.Node;o.setAnchorPoint(.5,1),this.ziyuan_sv.content.addChild(o);var l=o;this.loadRes(t,function(t){var s=this,o=i[a],r=t;l.addChild(r),l.setContentSize(r.getContentSize());var c=r.getChildByName("top").getChildByName("main_container");c.getChildByName("name").getComponent(cc.Label).string=i[a].name,c.getChildByName("title").getComponent(cc.Label).string=i[a].desc;var _=n.getIconPath("item",o.icon),h=n.getUIIconPath("common","common_1078");this.loadRes(_,function(t){c.getChildByName("goods_icon").getComponent(cc.Sprite).spriteFrame=t}.bind(this)),this.ziyuan_sv.content.getComponent(cc.Layout).updateLayout();for(var d=n.getPrefabPath("stronger","stronger_sec_item"),u=function(t){var e=new cc.Node;r.getChildByName("bottom").addChild(e),s.loadRes(d,function(i){var s=i;e.addChild(s),e.setContentSize(s.getContentSize());var n=Config.stronger_data.data_resource_two[o.sub_list[t]];s.getChildByName("main_container").getChildByName("title").getComponent(cc.Label).string=n.desc,s.getChildByName("main_container").getChildByName("name").getComponent(cc.Label).string=n.name,s.getChildByName("main_container").getChildByName("btn").on("click",function(){Utils.playButtonSound(1),this.ctrl.clickCallBack(n.evt_type)}.bind(this)),this.loadRes(h,function(t){s.getChildByName("main_container").getChildByName("background").getComponent(cc.Sprite).spriteFrame=t}.bind(this)),this.loadRes(_,function(t){s.getChildByName("main_container").getChildByName("goods_icon").getComponent(cc.Sprite).spriteFrame=t}.bind(this))}.bind(s))},m=0;m<o.sub_list.length;++m)u(m);c.getChildByName("btn").on("toggle",function(t){var i;if(t.isChecked?(c.getChildByName("btn").getChildByName("btn_name").getComponent(cc.Label).string="\u6536\u8d77",i=n.getUIIconPath("common","common_1020")):(c.getChildByName("btn").getChildByName("btn_name").getComponent(cc.Label).string="\u5c55\u5f00",i=n.getUIIconPath("common","common_1029")),this.loadRes(i,function(t){c.getChildByName("bg").getComponent(cc.Sprite).spriteFrame=t}.bind(this)),this.getZiyuanIndex==a)this.getZiyuanIndex=null;else{if(this.getZiyuanIndex&&this.getZiyuanIndex!=a)this.view_list[2].children[this.getZiyuanIndex-1].children[0].getChildByName("top").getChildByName("main_container").getChildByName("btn").getComponent(cc.Toggle).isChecked=!1;this.getZiyuanIndex=a}Utils.playButtonSound(1),e.getZiyuanIndex&&this.ziyuan_sv.content.getComponent(cc.Layout).scheduleOnce(function(){e.ziyuan_sv.scrollToOffset(cc.v2(0,Math.abs(e.view_list[2].children[e.getZiyuanIndex-1].y)))},.1),r.getChildByName("bottom").getComponent(cc.Layout).updateLayout(),r.getComponent(cc.Layout).updateLayout(),l.setContentSize(r.getContentSize())}.bind(this))}.bind(this))}.bind(this))},recommandPanel:function(){var t=n.getPrefabPath("stronger","recommand_item"),e=[];for(var i in Config.stronger_data.data_recommand)e.push(Config.stronger_data.data_recommand[i]);this.startUpdate(e.length,function(i){var s=i,o=new cc.Node;o.setAnchorPoint(.5,1),this.zhenrong_sv.content.addChild(o);var l=o;this.loadRes(t,function(t){var i=this,o=t;l.addChild(o),l.setContentSize(o.getContentSize());var r=o.getChildByName("main_container");r.getChildByName("title").getComponent(cc.Label).string=e[s].name;var c=StringUtil.parse(e[s].desc);o.getChildByName("messagePanel").getChildByName("desc").getComponent(cc.RichText).string=c,r.getChildByName("btn").on("toggle",function(t){var e;e=t.isChecked?n.getUIIconPath("common","common_1020"):n.getUIIconPath("common","common_1029"),this.loadRes(e,function(t){r.getChildByName("bg").getComponent(cc.Sprite).spriteFrame=t}.bind(this)),s==this.zhenrongIndex?this.zhenrongIndex=null:(this.zhenrongIndex&&s!=this.zhenrongIndex&&(this.view_list[3].children[this.zhenrongIndex-1].children[0].getChildByName("main_container").getChildByName("btn").getComponent(cc.Toggle).isChecked=!1),this.zhenrongIndex=s),Utils.playButtonSound(1),o.getComponent(cc.Layout).updateLayout(),l.setContentSize(o.getContentSize())},this),o.getChildByName("messagePanel").on("touchend",function(){r.getChildByName("btn").getComponent(cc.Toggle).isChecked=!1},this);for(var _=function(t){var n=e[s].hero_list[0][t],l=Utils.deepCopy(Config.partner_data.data_partner_base[n]);if(l){var r=ItemsPool.getInstance().getItem("hero_exhibition_item");r.setData(l),r.setParent(o.getChildByName("main_container").getChildByName("scroll_con")),r.show(),r.setScale(.73),r.setPosition(60+95*t,0),r.addCallBack(function(){l.bid&&a.getInstance().openHeroTipsPanelByBid(l.bid)}.bind(i))}},h=0;h<e[s].hero_list[0].length;++h)_(h)}.bind(this))}.bind(this))},problemPanel:function(){var t=[];for(var e in Config.stronger_data.data_problem)t.push(Config.stronger_data.data_problem[e]);this.startUpdate(t.length,function(e){var i=e,s=n.getPrefabPath("stronger","problem_item");this.loadRes(s,function(e){var s=e;this.wenti_sv.content.addChild(s);var a=s.getChildByName("main_container");a.getChildByName("name").getComponent(cc.Label).string=t[i].name,s.getChildByName("msgBottom").getChildByName("desc").getComponent(cc.RichText).string=StringUtil.parse(t[i].desc);var o=s.getChildByName("msgBottom").getChildByName("desc").height;s.getChildByName("msgBottom").height=o+25,a.getChildByName("btn").on("toggle",function(t){var e,s;t.isChecked?(e=n.getUIIconPath("common","common_1020"),s="\u6536\u8d77"):(e=n.getUIIconPath("common","common_1029"),s="\u67e5\u770b"),a.getChildByName("btn").getChildByName("Label").getComponent(cc.Label).string=s,this.loadRes(e,function(t){a.getChildByName("bg").getComponent(cc.Sprite).spriteFrame=t}.bind(this)),i==this.wentiIndex?this.wentiIndex=null:(this.wentiIndex&&this.wentiIndex!=i&&(this.view_list[4].children[this.wentiIndex-1].getChildByName("main_container").getChildByName("btn").getComponent(cc.Toggle).isChecked=!1),this.wentiIndex=i),Utils.playButtonSound(1)},this)}.bind(this))}.bind(this))},closeCallBack:function(){this.view_list[1]&&this.view_list[1].deleteMe(),this.ctrl.openMainWin(!1)}});e.exports=o,cc._RF.pop()},{hero_controller:"hero_controller",pathtool:"pathtool",stronger_controller:"stronger_controller",stronger_panel:"stronger_panel"}],stronger_controller:[function(t,e,i){"use strict";cc._RF.push(e,"1d70awzjyFOELEx5kpJ0r1p","stronger_controller");var s=t("jump_controller"),n=t("stronger_event"),a=cc.Class({extends:BaseController,ctor:function(){},initConfig:function(){var e=t("stronger_model");this.model=new e,this.model.initConfig(),this.is_first=!0},getModel:function(){return this.model},registerEvents:function(){},registerProtocals:function(){this.RegisterProtocal(11070,this.on11070.bind(this))},on11070:function(t){this.model.setDataByBid(t),gcore.GlobalEvent.fire(n.UPDATE_SCROE,t)},openMainWin:function(e,i,s){if(e){if(!this.main_win){var n=t("strong_main_window");this.main_win=new n(s)}this.main_win.open(i)}else this.main_win&&(this.main_win.close(),this.main_win=null)},setIsFirst:function(t){this.is_first=t},sender11070:function(t){var e={};e.partner_bid=t,this.SendProtocal(11070,e)},getStrongerRoot:function(){if(this.main_win)return this.main_win.root_wnd},clickCallBack:function(e){if(e)if(200==e)s.getInstance().jumpViewByEvtData([19]);else if(201==e)s.getInstance().jumpViewByEvtData([20]);else if(202==e)s.getInstance().jumpViewByEvtData([32]);else if(203==e){if(this.main_win&&this.main_win.view_list[1]){var i=this.main_win.view_list[1].getCurHero();if(i){var n=i.getData(),a=t("hero_controller"),o=t("hero_const"),l=a.getInstance().getModel().getAllHeroArray();a.getInstance().openHeroMainInfoWindow(!0,n,l,{show_model_type:o.BagTab.eBagHero})}}}else if(204==e)s.getInstance().jumpViewByEvtData([24]);else if(100==e)s.getInstance().jumpViewByEvtData([30]);else if(120==e)s.getInstance().jumpViewByEvtData([1]);else if(121==e){var r=t("backpack_const");s.getInstance().jumpViewByEvtData([8,r.item_tab_type.HERO])}else if(122==e){var c=t("mall_const");s.getInstance().jumpViewByEvtData([15,c.MallType.Recovery])}else if(123==e||162==e)s.getInstance().jumpViewByEvtData([35]);else if(125==e);else if(126==e)s.getInstance().jumpViewByEvtData([18]);else if(128==e);else if(129==e)s.getInstance().jumpViewByEvtData([41]);else if(130==e){var _=t("task_const");s.getInstance().jumpViewByEvtData([41,_.type.feat])}else if(131==e)s.getInstance().jumpViewByEvtData([7]);else if(132==e)s.getInstance().jumpViewByEvtData([11]);else if(134==e)s.getInstance().jumpViewByEvtData([6]);else if(135==e);else if(138==e){c=t("mall_const");s.getInstance().jumpViewByEvtData([15,c.MallType.GodShop])}else if(144==e){r=t("backpack_const");s.getInstance().jumpViewByEvtData([8,r.item_tab_type.PROPS])}else if(145==e){if(t("role_controller").getInstance().getRoleVo().isHasGuild())s.getInstance().jumpViewByEvtData([13]);else{var h=t("mainui_controller"),d=t("mainui_const");h.getInstance().changeMainUIStatus(d.btn_index.guild)}}else if(146==e){if(t("role_controller").getInstance().getRoleVo().isHasGuild())s.getInstance().jumpViewByEvtData([31]);else{h=t("mainui_controller"),d=t("mainui_const");h.getInstance().changeMainUIStatus(d.btn_index.guild)}}else if(150==e)s.getInstance().jumpViewByEvtData([27]);else if(151==e)s.getInstance().jumpViewByEvtData([25]);else if(152==e)s.getInstance().jumpViewByEvtData([17]);else if(153==e){var u=Config.dailyplay_data.data_exerciseactivity[2];if(null==u)return void message(Utils.TI18N("\u65e0\u5c3d\u8bd5\u70bc\u6570\u636e\u5f02\u5e38"));if(0==(h=t("mainui_controller")).getInstance().checkIsOpenByActivate(u.activate))return void message(u.lock_desc);t("endless_trail_controller").getInstance().checkIsOpen()&&s.getInstance().jumpViewByEvtData([43])}else if(154==e)s.getInstance().jumpViewByEvtData([26]);else if(155==e)s.getInstance().jumpViewByEvtData([23]);else if(156==e)s.getInstance().jumpViewByEvtData([22]);else if(157==e)s.getInstance().jumpViewByEvtData([5]);else if(158==e)s.getInstance().jumpViewByEvtData([3]);else if(159==e)s.getInstance().jumpViewByEvtData([36]);else if(160==e)s.getInstance().jumpViewByEvtData([12]);else if(402==e)s.getInstance().jumpViewByEvtData([4]);else if(404==e)s.getInstance().jumpViewByEvtData([19]);else if(405==e)s.getInstance().jumpViewByEvtData([40]);else if(406==e){c=t("mall_const");s.getInstance().jumpViewByEvtData([15,c.MallType.GuessShop])}else if(407==e)s.getInstance().jumpViewByEvtData([34]);else if(408==e||161==e){var m=t("forgehouse_const");s.getInstance().jumpViewByEvtData([26,m.Tab_Index.Artifact])}else if(409==e)s.getInstance().jumpViewByEvtData([20]);else if(410==e){c=t("mall_const");s.getInstance().jumpViewByEvtData([15,c.MallType.EliteShop])}else if(411==e){var f=t("action_const");s.getInstance().jumpViewByEvtData([45,f.ActionRankCommonType.time_summon])}else 412==e?t("vedio_controller").getInstance().openVedioMainWindow(!0):413==e&&t("vedio_controller").getInstance().openVedioMyselfWindow(!0)}});e.exports=a,cc._RF.pop()},{action_const:"action_const",backpack_const:"backpack_const",endless_trail_controller:"endless_trail_controller",forgehouse_const:"forgehouse_const",hero_const:"hero_const",hero_controller:"hero_controller",jump_controller:"jump_controller",mainui_const:"mainui_const",mainui_controller:"mainui_controller",mall_const:"mall_const",role_controller:"role_controller",strong_main_window:"strong_main_window",stronger_event:"stronger_event",stronger_model:"stronger_model",task_const:"task_const",vedio_controller:"vedio_controller"}],stronger_event:[function(t,e,i){"use strict";cc._RF.push(e,"97504uew/VBNq17H3oNZvt0","stronger_event"),e.exports={UPDATE_SCROE:"StrongerEvent.UPDATE_SCROE"},cc._RF.pop()},{}],stronger_model:[function(t,e,i){"use strict";cc._RF.push(e,"231aef4fC1Mf6405z4vt63b","stronger_model");var s=t("battle_drama_controller"),n=t("guild_controller"),a=t("role_controller");cc.Class({extends:BaseClass,ctor:function(){},properties:{},initConfig:function(){this.scroe_list={},this.max_list={}},setDataByBid:function(t){this.scroe_list[t.partner_bid]||(this.scroe_list[t.partner_bid]={}),this.scroe_list[t.partner_bid]=t.partner_score,this.max_list[t.partner_bid]||(this.max_list[t.partner_bid]={}),this.max_list[t.partner_bid]=t.stronger_partner_score},getTotalAndMaxValByBid:function(t){var e=0;if(this.scroe_list[t])for(var i=0;i<this.scroe_list[t].length;++i){e+=this.scroe_list[t][i].val}var s=0;if(this.max_list[t])for(var n=0;n<this.max_list[t].length;++n){s+=this.max_list[t][n].val}return{total:e,max:s}},getStrongerValByBid:function(t,e){for(var i=this.scroe_list[t]||{},s=this.max_list[t]||{},n=0,a=0,o=0;o<i.length;++o){var l=i[o];if(l.id_2==e){n=l.val;break}}for(var r=0;r<s.length;++r){var c=s[r];if(c.id_2==e){a=c.val;break}}return{scroe_val:n,max_val:a}},checkStrongItemIsOpen:function(t){var e=!1;if(t)if(t[0]&&"dugeon"==t[0]){var i=s.getInstance().getModel().getDramaData();if(i&&t[1]){var o=t[1];i.max_dun_id>=o&&(e=!0)}}else if(t[0]&&"lev"==t[0]){var l=a.getInstance().getRoleVo();if(l&&t[1]){var r=t[1];l.lev>=r&&(e=!0)}}else if(t[0]&&"guild"==t[0]){var c=a.getInstance().getRoleVo();if(c&&0!=c.gid&&""!=c.gsrv_id){var _=n.getInstance().getModel().getMyGuildInfo();if(_){var h=t[1];_.lev>=h&&(e=!0)}}}return e}});cc._RF.pop()},{battle_drama_controller:"battle_drama_controller",guild_controller:"guild_controller",role_controller:"role_controller"}],stronger_panel:[function(t,e,i){"use strict";cc._RF.push(e,"1158fjTQ45DN5n4eq7HPIef","stronger_panel");var s=t("pathtool"),n=t("hero_controller"),a=t("stronger_controller"),o=(t("hero_const"),t("Stronger_panel_item")),l=t("common_scrollview"),r=t("stronger_event"),c=cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("stronger","stronger_panel"),this.partner_id=arguments[0]||0,this.ctrl=a.getInstance(),this.model=a.getInstance().getModel(),this.partner_id_indedx=0,this.partnerList=[],this.cur_hero_item=null},initConfig:function(){},initPanel:function(){this.hero_con_nd=this.seekChild("hero_con"),this.selected_nd=this.seekChild("selected_nd"),this.scroll_con_nd=this.seekChild("scroll_con"),this.now_hero_val_lb=this.seekChild("now_hero_val",cc.Label),this.loadingbar_exp_lb=this.seekChild("loadingbar_exp",cc.Label),this.loadingbar_bg_pb=this.seekChild("loadingbar_bg",cc.ProgressBar);var t=cc.size(this.scroll_con_nd.width,this.scroll_con_nd.height),e={item_class:o,start_x:0,space_x:10,start_y:0,space_y:8,item_width:617,item_height:142,row:0,col:1};this.item_scroll=new l,this.item_scroll.createScroll(this.scroll_con_nd,cc.v2(-t.width/2,0),ScrollViewDir.vertical,ScrollViewStartPos.top,t,e,cc.v2(0,0)),this.createHeroList()},registerEvent:function(){var t=this;this.addGlobalEvent(r.UPDATE_SCROE,function(e){if(t.cur_hero_item){var i=t.cur_hero_item.getData();i.bid==e.partner_bid&&this.refreshViewByHero(i)}}.bind(this))},onShow:function(t){},onHide:function(){},createHeroList:function(){var t=this,e=n.getInstance().getModel().getMyPosList(),i=[];for(var s in e){var a=e[s],o=n.getInstance().getModel().getHeroById(a.id);0==this.partner_id&&0==i.length&&(this.partner_id=o.partner_id),i.push(o)}if(0!=i.length){for(var l=function(e){var s=ItemsPool.getInstance().getItem("hero_exhibition_item");s.setData(i[e]),s.setParent(t.hero_con_nd),s.show(),s.setScale(.8),s.setPosition(60+110*e,0),s.addCallBack(function(){e!=this.partner_id_indedx&&this._onClickHero(e)}.bind(t)),t.partnerList[e]=s},r=0;r<i.length;r++)l(r);this._onClickHero(this.partner_id_indedx)}},_onClickHero:function(t){this.partner_id_indedx=t,this.selected_nd&&this.selected_nd.setPosition(60+110*t,-10);var e=this.partnerList[t].getData();this.cur_hero_item=this.partnerList[t],this.ctrl.sender11070(e.partner_id)},refreshViewByHero:function(t){this.now_hero_val_lb.string=t.name;var e=this.model.getTotalAndMaxValByBid(t.bid),i=e.total,s=e.max;this.loadingbar_exp_lb.string=i+"/"+s,this.loadingbar_bg_pb.progress=i/s,this.refreshItemList(t.bid)},refreshItemList:function(t){var e=[];for(var i in Config.stronger_data.data_stronger_two){for(var s=Config.stronger_data.data_stronger_two[i],n=!0,a=0;a<s.limit.length;++a){var o=s.limit[a];if(0==this.model.checkStrongItemIsOpen(o)){n=!1;break}}if(n){var l=Utils.deepCopy(s),r=this.model.getStrongerValByBid(t,s.id);l.score_val=r.scroe_val,l.max_val=r.max_val,e.push(l)}}this.item_scroll.setData(e)},getCurHero:function(){return this.cur_hero_item},onDelete:function(){if(this.item_scroll&&(this.item_scroll.deleteMe(),this.item_scroll=null),this.partnerList){for(var t=0;t<this.partnerList.length;++t)this.partnerList[t].deleteMe();this.partnerList=null}}});e.exports=c,cc._RF.pop()},{Stronger_panel_item:"Stronger_panel_item",common_scrollview:"common_scrollview",hero_const:"hero_const",hero_controller:"hero_controller",pathtool:"pathtool",stronger_controller:"stronger_controller",stronger_event:"stronger_event"}],subscription_wechat_panel:[function(t,e,i){"use strict";cc._RF.push(e,"4d3e0F4tARKHadc0IE0aPF6","subscription_wechat_panel");var s=t("pathtool"),n=t("welfare_event"),a=t("role_controller");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("welfare","subscription_wechat_panel")},initConfig:function(){this.ctrl=t("welfare_controller").getInstance(),this.item_list=[],this.item_list_2=[]},initPanel:function(){"SH_RH"==PLATFORM_TYPR&&0==window.SH_RH_IS_SUBSCRIBE&&SDK.subscribe({apiType:"isSubscribe"}),this.main_container=this.seekChild("main_container"),this.shrh_container=this.seekChild("shrh_container"),this.shrh_container.active="SH_RH"==PLATFORM_TYPR||"SH_SDK"==PLATFORM_TYPR,this.main_container.active="SH_RH"!=PLATFORM_TYPR&&"SH_SDK"!=PLATFORM_TYPR,this.item_container=this.seekChild("item_container"),this.bg_sp=this.seekChild("bg",cc.Sprite),this.loadRes(s.getBigBg("welfare/txt_cn_subscription_wechat","jpg"),function(t){this.bg_sp.spriteFrame=t}.bind(this)),this.code_sprite=this.seekChild("code_sprite",cc.Sprite),this.loadRes(s.getIconPath("welfare/welfare_banner","txt_cn_welfare_bg4"),function(t){this.code_sprite.spriteFrame=t}.bind(this)),this.save_btn=this.seekChild("save_btn"),this.bg_2=this.seekChild(this.shrh_container,"bg_2",cc.Sprite),this.loadRes(s.getBigBg("welfare/txt_cn_shrh_subscription","jpg"),function(t){this.bg_2.spriteFrame=t}.bind(this)),this.item_container_2=this.seekChild(this.shrh_container,"item_container_2"),this.go_btn=this.seekChild(this.shrh_container,"go_btn"),this.get_btn=this.seekChild(this.shrh_container,"get_btn"),this.get_btn_btn=this.seekChild(this.shrh_container,"get_btn",cc.Button),this.get_btn_lo=this.seekChild(this.get_btn,"Text_6",cc.LabelOutline),this.get_btn_lb=this.seekChild(this.get_btn,"Text_6",cc.Label),this.desc=this.seekChild(this.shrh_container,"txt_2",cc.Label),this.desc.string=Utils.TI18N("1.\u70b9\u51fb\u4e0b\u65b9\u201c\u524d\u5f80\u5173\u6ce8\u201d\u6309\u94ae\u524d\u5f80\u516c\u4f17\u53f7\n2.\u70b9\u51fb\u5173\u6ce8\u5e76\u8fdb\u5165\u516c\u4f17\u53f7\n3.\u5173\u6ce8\u83b7\u53d6\u66f4\u591a\u6e38\u620f\u6700\u65b0\u6d3b\u52a8\u8baf\u606f\n4.\u5173\u6ce8\u540e\u5373\u53ef\u9886\u53d6\u4e0b\u65b9\u5956\u52b1"),this.copy_btn=this.seekChild(this.shrh_container,"copy_btn"),this.copy_btn_2=this.seekChild(this.shrh_container,"copy_btn_2"),this.input=this.shrh_container.getChildByName("editbox").getComponent(cc.EditBox),"SH_SDK"==PLATFORM_TYPR?(this.go_btn.active=!1,this.copy_btn.active=this.copy_btn_2.active=this.input.node.active=!0,this.get_btn.x=360,this.desc.string=Utils.TI18N("1.\u5fae\u4fe1\u641c\u7d22\u3010\u5251\u9b42\u4e4b\u5149H5\u3011\n2.\u53ef\u641c\u7d22\u516c\u4f17\u53f7\uff1a\u201cjianhun236\u201d\n3.\u70b9\u51fb\u3010\u5251\u9b42\u4e4b\u5149H5\u3011\u5e76 \u5173\u6ce8\n4.\u70b9\u51fb\u83dc\u5355\u680f \u798f\u5229\u793c\u5305-\u5173\u6ce8\u793c\u5305 \u9886\u53d6\u793c\u5305")):"SH_RH"==PLATFORM_TYPR&&(window.SH_RH_IS_SUBSCRIBE?(this.get_btn_lo.enabled=!0,Utils.setGreyButton(this.get_btn_btn,!1)):(Utils.setGreyButton(this.get_btn_btn),this.get_btn_lo.enabled=!1)),1==this.ctrl.getModel().getSubscriptionAwardStatus()&&(Utils.setGreyButton(this.get_btn_btn),this.get_btn_lo.enabled=!1,this.get_btn_lb.string=Utils.TI18N("\u5df2\u9886\u53d6")),"SH_RH"!=PLATFORM_TYPR&&"SH_SDK"!=PLATFORM_TYPR&&this.ctrl.tellServerWechatStatus()},registerEvent:function(){Utils.onTouchEnd(this.save_btn,function(){this.savePhotoPicture()}.bind(this),1),Utils.onTouchEnd(this.go_btn,function(){"SH_RH"==PLATFORM_TYPR&&SDK.subscribe({apiType:"askShow"})}.bind(this),1),this.get_btn.on("click",function(){if(Utils.playButtonSound(1),"SH_RH"==PLATFORM_TYPR)window.SH_RH_IS_SUBSCRIBE&&this.ctrl.send16694(0);else if("SH_SDK"==PLATFORM_TYPR){var t=this.input.string;""==(t=t.replace("\n",""))?message(Utils.TI18N("\u8bf7\u8f93\u5165\u5151\u6362\u7801")):a.getInstance().sender10945(t)}}.bind(this)),Utils.onTouchEnd(this.copy_btn,function(){SDK&&SDK.setClipboardData&&SDK.setClipboardData("\u5251\u9b42\u4e4b\u5149H5")}.bind(this),1),Utils.onTouchEnd(this.copy_btn_2,function(){SDK&&SDK.setClipboardData&&SDK.setClipboardData("jianhun236")}.bind(this),1),this.addGlobalEvent(n.Update_SHRH_Award_Status,function(t){Utils.setGreyButton(this.get_btn_btn),this.get_btn_lo.enabled=!1,this.get_btn_lb.string=Utils.TI18N("\u5df2\u9886\u53d6")}.bind(this))},onShow:function(t){this.setItemList()},savePhotoPicture:function(){if(!this.poste_picture){var e=t("viewmanager").getInstance().getSceneNode(SCENE_TAG.loading);this.poste_picture=Utils.createImage(e,null,0,0,cc.v2(.5,.5)),this.poste_picture.type=cc.Sprite.Type.SIMPLE,this.poste_picture.sizeMode=cc.Sprite.SizeMode.CUSTOM,this.poste_picture.node.setContentSize(720,1280),this.poste_picture.node.scale=FIT_SCALE,this.savePhotoText(this.poste_picture.node,!1),this.loadRes(s.getBigBg("welfare/txt_cn_subscription_wechat_1"),function(t){this.poste_picture.spriteFrame=t,this.save_layout&&(this.save_layout.active=!0);this.time_1&&(gcore.Timer.del(this.time_1),this.time_1=null),this.time_1=gcore.Timer.set(function(){if(this.poste_picture&&(this.poste_picture.node.removeFromParent(),this.poste_picture=null,this.item_list_2))for(var t in this.item_list_2)this.item_list_2[t]&&(this.item_list_2[t].deleteMe(),this.item_list_2[t]=null)}.bind(this),1e3,1)}.bind(this))}},savePhotoText:function(t,e){if(t){this.save_layout=new cc.Node,this.save_layout.setPosition(0,0),this.save_layout.setContentSize(cc.size(100,100)),this.save_layout.setParent(t),this.save_layout.active=e;Utils.createLabel(24,new cc.Color(247,253,255,255),new cc.Color(20,53,108,255),-300,90,Utils.TI18N("\u5fae\u4fe1\u641c\u7d22:"),this.save_layout,2,cc.v2(0,.5));var i=cc.js.formatStr(Utils.TI18N("%s (%s)\u516c\u4f17\u53f7"),WECHAT_SUBSCRIPTION_NAME,WECHAT_SUBSCRIPTION),n=(Utils.createLabel(24,new cc.Color(247,253,255,255),new cc.Color(20,53,108,255),-300,50,i,this.save_layout,2,cc.v2(0,.5)),Utils.createLabel(24,new cc.Color(247,253,255,255),new cc.Color(20,53,108,255),-300,10,Utils.TI18N("\u5173\u6ce8\u70b9\u51fb\u300c\u798f\u5229\u8865\u7ed9\u300d\u9886\u53d6\u793c\u5305\u7801"),this.save_layout,2,cc.v2(0,.5)),Utils.createImage(this.save_layout,null,0,-340,cc.v2(.5,.5)));this.loadRes(s.getIconPath("welfare/welfare_banner","txt_cn_welfare_bg4"),function(t){n.spriteFrame=t}.bind(this));var a=new cc.Node;a.setPosition(-215,-160),a.setAnchorPoint(0,0),a.setContentSize(cc.size(430,174)),a.setParent(t),this.setCopyItemList(a)}},setCopyItemList:function(t){var e=this.ctrl.getWechatData();if(null==this.item_list_2&&(this.item_list_2=[]),null!=e&&null!=e){var i=0;for(var s in e.items){var n=e.items[s];if(!this.item_list_2[s]){var a=ItemsPool.getInstance().getItem("backpack_item");a.initConfig(!1,1,!1,!0),a.show(),a.setParent(t),a.setData({bid:n.bid,num:n.num}),a.setPosition(134*i+85,77),this.item_list_2[s]=a,i+=1}}}},setItemList:function(){if("SH_RH"==PLATFORM_TYPR||"SH_SDK"==PLATFORM_TYPR){if(null==(n=this.ctrl.getModel().getSubscriptionAward()))return;var t=0;for(var e in n){var i=n[e];if(!this.item_list[e]){var s=ItemsPool.getInstance().getItem("backpack_item");s.initConfig(!1,.8,!1,!0),s.show(),s.setParent(this.item_container_2),s.setData({bid:i.bid,num:i.num}),s.setPosition(120*t-120,80),this.item_list[e]=s,t+=1}}}else{var n;if(null==(n=this.ctrl.getWechatData())||null==n.items)return;t=0;for(var e in n.items){var a=n.items[e];if(!this.item_list[e]){var o=ItemsPool.getInstance().getItem("backpack_item");o.initConfig(!1,1,!1,!0),o.show(),o.setParent(this.item_container),o.setData({bid:a.bid,num:a.num}),o.setPosition(134*t+85,77),this.item_list[e]=o,t+=1}}}},setVisibleStatus:function(t){this.setVisible(t)},onHide:function(){},onDelete:function(){if(this.item_list){for(var t in this.item_list)this.item_list[t].deleteMe(),this.item_list[t]=null;this.item_list=null}if(this.item_list_2){for(var t in this.item_list_2)this.item_list_2[t]&&(this.item_list_2[t].deleteMe(),this.item_list_2[t]=null);this.item_list_2=null}this.poste_picture&&(this.poste_picture.node.destroy(),this.poste_picture=null),this.time_1&&(gcore.Timer.del(this.time_1),this.time_1=null)}});cc._RF.pop()},{pathtool:"pathtool",role_controller:"role_controller",viewmanager:"viewmanager",welfare_controller:"welfare_controller",welfare_event:"welfare_event"}],supre_yueka_panel:[function(t,e,i){"use strict";cc._RF.push(e,"cfcf7nkHq9DNLGb+WqqWvBv","supre_yueka_panel");var s=t("pathtool"),n=t("welfare_controller"),a=t("welfare_event"),o=t("timetool");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("welfare","yueka_panel")},initConfig:function(){this.ctrl=n.getInstance(),this.card_data=Config.charge_data.data_constant,this.card1_add_count=this.card_data.month_card1_sun.val,this.item_bid_1=this.card_data.month_card1_items.val[0][0],this.item_num_1=this.card_data.month_card1_items.val[0][1],this.add_get_day_1=this.card_data.month_card1_cont_day.val,this.current_day=0},initPanel:function(){this.main_container=this.seekChild("main_container");var t=this.seekChild(this.main_container,"bg",cc.Sprite),e=s.getBigBg("txt_cn_welfare_yueka_bg1",null,"welfare");this.loadRes(e,function(e){t.spriteFrame=e}.bind(this)),this.btn_1_nd=this.seekChild(this.main_container,"btn_1"),this.seekChild(this.btn_1_nd,"Text_1",cc.Label).string=Utils.TI18N("\u5145\u503c\u6fc0\u6d3b"),this.bar_pb=this.seekChild(this.main_container,"bar",cc.ProgressBar),this.bar_pb.progress=0,this.current_change_lb=this.seekChild("current_change",cc.Label),this.btn_rule_nd=this.seekChild("btn_rule"),this.btn_rule_nd.active=!0,this.image_get_nd=this.seekChild("image_get"),this.image_get_nd.active=!1,this.text_day_lb=this.seekChild(this.image_get_nd,"text_day",cc.Label),this.text_day_lb.string="",this.text_time_lb=this.seekChild(this.image_get_nd,"text_time",cc.Label),this.btn_get_nd=this.seekChild(this.image_get_nd,"btn_get"),this.btn_get_btn=this.seekChild(this.image_get_nd,"btn_get",cc.Button),this.btn_get_lb=this.seekChild(this.btn_get_nd,"Text_4",cc.Label),this.btn_get_lo=this.seekChild(this.btn_get_nd,"Text_4",cc.LabelOutline),this.btn_get_lb.string="\u9886\u53d6";var i=this.seekChild(this.main_container,"Image_1_0");this.text_1_rt=this.seekChild(i,"text_1",cc.RichText),this.text_2_rt=this.seekChild(this.main_container,"text_2",cc.RichText),this.text_3_rt=this.seekChild(this.main_container,"text_3",cc.RichText),this.text_1_rt.string=cc.js.formatStr(Utils.TI18N("<outline width=1 color=#110800>\u4efb\u610f\u7d2f\u8ba1\u5145\u503c\u8fbe\u5230</outline><color=#ffb502> %d\u5143 </c><outline width=1,color=#110800>\u5373\u53ef\u6fc0\u6d3b</outline>"),this.card1_add_count);var n=Utils.getItemConfig(this.card_data.month_card1_return.val[0][0]);this.text_2_rt.string=cc.js.formatStr(Utils.TI18N("<outline width=1 color=#110800>\u5145\u503c\u9001\u8d85\u503c\u6708\u5361,</outline><outline width=1 color=#000000><color=#ffb502 > \u8fd4\u8fd8%d </c></outline><img src=%s visible=true scale=0.30 />"),this.card_data.month_card1_return.val[0][1],s.getItemRes(n.icon));n=Utils.getItemConfig(this.item_bid_1);this.text_3_rt.string=cc.js.formatStr(Utils.TI18N("<outline width=1 color=#110800>\u6bcf\u65e5\u53ef\u9886\u53d6</outline><color=#ffb502 ><outline width=1 color=#000000> %d</outline> </c><img src=%s visible=true scale=0.30 /><outline width=1 color=#110800>\u6301\u7eed </outline><color=#ffb502 ><outline width=1 color=#000000>%d\u5929</outline></c>"),this.item_num_1,s.getItemRes(n.icon),this.add_get_day_1)},registerEvent:function(){this.addGlobalEvent(a.Update_Yueka,function(t){var e=100,i=100,s=null,n=null,a=0,l=0,r=0;if(0==t.card1_is_reward)this.image_get_nd.active=!1,this.btn_1_nd.active=!0,e=this.card1_add_count,i=t.card1_acc;else if(1==t.card1_is_reward||2==t.card1_is_reward){s=this.item_bid_1,n=this.item_num_1,l=t.card1_days,a=this.add_get_day_1,r=t.card1_end_time,this.current_day=l,this.image_get_nd.active=!0,this.btn_1_nd.active=!1,1==t.card1_is_reward?(Utils.setGreyButton(this.btn_get_btn,!1),this.btn_get_lb.string=Utils.TI18N("\u9886\u53d6"),this.btn_get_lo.enabled=!0):2==t.card1_is_reward&&(Utils.setGreyButton(this.btn_get_btn,!0),this.btn_get_lb.string=Utils.TI18N("\u5df2\u9886\u53d6"),this.btn_get_lo.enabled=!1);var c=r-86400*a,_=cc.js.formatStr("%s - %s",o.getMD2(c),o.getMD2(r-1));this.text_time_lb.string=_}this.bar_pb.progress=i/e;_=cc.js.formatStr(Utils.TI18N("\u5f53\u524d\u5145\u503c\uff1a%d / %d"),i,e);this.current_change_lb.string=_,s&&n&&(this.reward_item||(this.reward_item=ItemsPool.getInstance().getItem("backpack_item"),this.reward_item.initConfig(null,1,!1,!0),this.reward_item.show(),this.reward_item.setPosition(-260,0),this.reward_item.setParent(this.image_get_nd)),this.reward_item&&this.reward_item.setData({bid:s,num:n})),this.text_day_lb.string=this.current_day},this),this.addGlobalEvent(a.Update_Get_Yueka,function(t){1==t&&(Utils.setGreyButton(this.btn_get_btn,!0),this.btn_get_lb.string=Utils.TI18N("\u5df2\u9886\u53d6"),this.btn_get_lo.enabled=!1,this.current_day=this.current_day+1,this.text_day_lb.string=this.current_day)},this),Utils.onTouchEnd(this.btn_1_nd,function(){t("vip_controller").getInstance().openVipMainWindow(!0,VIPTABCONST.CHARGE)}.bind(this),1),Utils.onTouchEnd(this.btn_get_nd,function(){this.ctrl.sender16706(1)}.bind(this),1),Utils.onTouchEnd(this.btn_rule_nd,function(){cc.log(VIPTABCONST.VIP),t("vip_controller").getInstance().openVipMainWindow(!0,VIPTABCONST.VIP)}.bind(this),1),this.ctrl.sender16705()},onShow:function(t){},setVisibleStatus:function(t){t=t||!1,this.setVisible(t)},onHide:function(){},onDelete:function(){this.reward_item&&(this.reward_item.deleteMe(),this.reward_item=null)}});cc._RF.pop()},{pathtool:"pathtool",timetool:"timetool",vip_controller:"vip_controller",welfare_controller:"welfare_controller",welfare_event:"welfare_event"}],sureveyquest_window:[function(t,e,i){"use strict";cc._RF.push(e,"68669Ad5XpC4Lw+4ffTXOFr","sureveyquest_window");var s=t("pathtool"),n=t("welfare_event"),a=t("welfare_const");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("welfare","surveyquest_window"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Big,this.ctrl=arguments[0]},initConfig:function(){this.topic_length=10,this.index_count=-1,this.answer_ret_temp=null,this.topic_layout={},this.answer_list=[]},openCallBack:function(){this.background=this.root_wnd.getChildByName("background"),this.main_container=this.root_wnd.getChildByName("main_container"),this.btn_start=this.main_container.getChildByName("btn_start"),this.btn_start.label=this.btn_start.getChildByName("Text_9").getComponent(cc.Label),this.btn_close=this.main_container.getChildByName("btn_close"),this.answer_content=this.main_container.getChildByName("answer_content"),this.answer_content.active=!1,this.titleTopic=this.main_container.getChildByName("titleTopic").getComponent(cc.Label),this.topic_layout_nd=this.answer_content.getChildByName("topic_layout"),this.scroll=this.answer_content.getChildByName("answer_scroll"),this.content=this.answer_content.getChildByName("answer_scroll").getChildByName("content"),this.main_container.getChildByName("Text_10").getComponent(cc.Label).string=Utils.TI18N("\u5c0f\u52a9\u624b\u7684\u5192\u9669\u8c03\u67e5"),this.text_prompt=this.main_container.getChildByName("text_prompt"),this.start_title=this.text_prompt.getChildByName("Text_8").getComponent(cc.Label),this.start_title.string="",this.start_memo=this.text_prompt.getChildByName("Text_8_0").getComponent(cc.Label),this.start_memo.string="",this.suggest_panel=this.main_container.getChildByName("suggest_panel"),this.text_field_eb=this.suggest_panel.getChildByName("text_Field").getComponent(cc.EditBox),this.suggest_panel.active=!1,this.reward_panel=this.main_container.getChildByName("reward_panel"),this.reward_panel.active=!1},registerEvent:function(){this.btn_start.on("click",function(){Utils.playButtonSound(1);var t=this.ctrl.getModel().getQuestOpenData();if(t&&0!=t.flag)this.ctrl.sender24604();else if(!(this.index_count>this.topic_length)){if(this.questNaire_list){var e=this.questNaire_list[this.index_count],i={};if(i.id=e.id,i.topic_type=e.topic_type,e.specific_type!=a.QuestConst.fill_blank){var s=!1;for(var n in this.topic_layout)if(this.topic_layout[n].active&&this.topic_layout[n].getChildByName("checkmark").active){s=!0;break}if(!s&&1==e.must)return void message(Utils.TI18N("\u5fc5\u987b\u9009\u62e9\u4e00\u4e2a\u7b54\u6848"));var o="";for(var l in this.topic_layout)this.topic_layout[l].active&&this.topic_layout[l].getChildByName("checkmark").active&&(o+=l);i.ret=o}else{if(1==e.must&&""==this.text_field_eb.string)return void message(Utils.TI18N("\u5f53\u524d\u9898\u5fc5\u586b"));i.ret=this.text_field_eb.string}this.answer_list.push(i)}this.index_count=this.index_count+1,0==this.index_count&&this.ctrl.sender24602(),this.questNaire_list&&(this.index_count==this.questNaire_list.length?this.ctrl.sender24603(this.answer_list):this.startTopicAnswer(this.questNaire_list))}},this),this.btn_close.on("click",function(){Utils.playButtonSound(2),this.ctrl.openSureveyQuestView(!1)},this),this.addGlobalEvent(n.Get_SureveyQuest_Basic,function(t){if(t&&null!=Utils.next(t)){var e=this.ctrl.getModel().getQuestOpenData();if(!e||0!=e.status){this.answer_reward_list=t.rewards;var i=this.ctrl.getModel().getQuestOpenData();i&&(0==i.flag?(this.start_title.string=Utils.TI18N("\u4eb2\u7231\u7684\u5192\u9669\u8005\u5927\u4eba\uff1a"),this.start_memo.string=Utils.TI18N("\u8f9b\u82e6\u60a8\u53c2\u52a0\u5c0f\u52a9\u624b\u7684\u5192\u9669\u8c03\u67e5\uff0c\u5c0f\u52a9\u624b\u4e3a\u5927\u4eba\n\n\u51c6\u5907\u4e86\u5c0f\u5c0f\u8c22\u793c\uff0c\u653e\u5728\u4e86\u95ee\u5377\u7684\u6700\u540e\u54e6~")):this.getRewardList(i.flag))}}}.bind(this)),this.addGlobalEvent(n.Get_SureveyQuest_Topic_Content,function(t){if(t&&null!=Utils.next(t)){var e=this.ctrl.getModel().getQuestOpenData();e&&0==e.status||(this.topic_length=t.questionnaire_list.length,t.questionnaire_list.sort(function(t,e){return t.sort-e.sort}),this.questNaire_list=t.questionnaire_list,this.startTopicAnswer(this.questNaire_list))}}.bind(this)),this.addGlobalEvent(n.SureveyQuest_Submit,function(){this.answer_content.active=!1,this.suggest_panel.active=!1,this.titleTopic.node.active=!1,this.getRewardList()},this),this.addGlobalEvent(n.Get_SureveyQuest_Get_Reward,function(t){if(t&&null!=Utils.next(t)){var e=this.ctrl.getModel().getQuestOpenData();e&&0==e.status||(this.btn_start.label.string=Utils.TI18N("\u5df2\u5b8c\u6210"),this.btn_start.label.node.getComponent(cc.LabelOutline).enabled=!1,this.btn_start.getComponent(cc.Button).interactable=!1,this.btn_start.getComponent(cc.Button).enableAutoGrayEffect=!0)}},this)},openRootWnd:function(t){1==this.ctrl.getModel().getQuestOpenData().flag?this.ctrl.setWelfareStatus(a.WelfareIcon.quest,!0):this.ctrl.setWelfareStatus(a.WelfareIcon.quest,!1),this.ctrl.sender24601()},startTopicAnswer:function(t){var e=this;if(this.scroll.getComponent(cc.ScrollView).scrollToTop(0),this.text_prompt.active=!1,t&&null!=Utils.next(t)&&t[this.index_count]){var i=t[this.index_count].specific_type;if(i==a.QuestConst.single?this.selectNum=a.QuestConst.single:i==a.QuestConst.multiple&&(this.selectNum=a.QuestConst.multiple),this.titleTopic.string=t[this.index_count].title,i==a.QuestConst.fill_blank)return this.answer_content.active=!1,this.suggest_panel.active=!0,void(this.text_field_eb.string="");this.answer_content.active=!0,this.suggest_panel.active=!1;for(var n=t[this.index_count].option.replace(/\\r/g,""),o=[],l=0;l<n.length;++l)'"'==n[l]&&o.push(l);for(var r={},c=0;c<o.length/4;++c){var _=4*c,h=n.slice(o[_]+1,o[_+1]),d=n.slice(o[_+2]+1,o[_+3]);/[a-z]/i.test(h)&&(r[h]=d)}for(var u in this.topic_layout)this.topic_layout[u]&&(this.topic_layout[u].active=!1,this.topic_layout[u].getChildByName("checkmark").active=!1);var m=5,f=function(t){var n=e.topic_layout[t];null==n&&(n=cc.instantiate(e.topic_layout_nd),e.content.addChild(n),n.background_sp=n.getChildByName("Background").getComponent(cc.Sprite),n.label=n.getChildByName("Background").getChildByName("label").getComponent("cc.Label"),n.getChildByName("checkmark").active=!1,e.topic_layout[t]=n,n.on("touchend",function(e){this.setButtonState(t)},e)),n.active=!0,0;var o=void 0;o=i==a.QuestConst.single?s.getUIIconPath("common","common_1030"):s.getUIIconPath("common","common_1044"),n.label.string=r[t],n.label._forceUpdateRenderData();var l=m;m=n.label.node.height>40?l+n.label.node.height+30:l+40+30,n.setPosition(-243,-l),e.loadRes(o,function(t){n.background_sp.spriteFrame=t}.bind(e))};for(var p in r)f(p);this.content.height=m-30,this.index_count!=this.topic_length&&(this.btn_start.label.string=Utils.TI18N("\u4e0b\u4e00\u9875"))}},setButtonState:function(t){if(this.selectNum==a.QuestConst.single){for(var e in this.topic_layout)this.topic_layout[e].active&&(this.topic_layout[e].getChildByName("checkmark").active=!1);this.topic_layout[t].getChildByName("checkmark").active=!0}else if(this.selectNum==a.QuestConst.multiple){this.topic_layout[t].getChildByName("checkmark").active=!this.topic_layout[t].getChildByName("checkmark").active;var i=0;for(var s in this.topic_layout)this.topic_layout[s].active&&this.topic_layout[s].getChildByName("checkmark").active&&i++;i>this.selectNum&&(i==this.selectNum+1&&(this.topic_layout[t].getChildByName("checkmark").active=!1),message(Utils.TI18N("\u6700\u591a\u9009\u62e9\u4e09\u4e2a\u9009\u9879")))}},getRewardList:function(t){if(t=t||1,this.reward_panel.active=!0,this.end_memo=this.reward_panel.getChildByName("Text_1").getComponent(cc.Label),this.end_memo.string=Utils.TI18N("\u4eb2\u7231\u7684\u5192\u9669\u8005\u5927\u4eba~\n\n\u8bf7\u6536\u4e0b\u5c0f\u52a9\u624b\u7684\u4e00\u70b9\u5fc3\u610f"),2==t?(this.btn_start.label.string=Utils.TI18N("\u5df2\u5b8c\u6210"),this.btn_start.label.node.getComponent(cc.LabelOutline).enabled=!1,this.btn_start.getComponent(cc.Button).interactable=!1,this.btn_start.getComponent(cc.Button).enableAutoGrayEffect=!0):this.btn_start.label.string=Utils.TI18N("\u9886\u53d6\u5956\u52b1"),this.answer_reward_list){var e=this.reward_panel.getChildByName("good_cons").getChildByName("content");this.award_item=[];for(var i=0;i<this.answer_reward_list.length;++i){var s=this.answer_reward_list[i].bid,n=this.answer_reward_list[i].num,a=ItemsPool.getInstance().getItem("backpack_item");a.setParent(e);var o=60+120*i+10*i;a.setPosition(o,60),a.show(),a.setData({bid:s,num:n}),this.award_item.push(a)}e.width=120*this.answer_reward_list.length+10*(this.answer_reward_list.length-1)}},closeCallBack:function(){if(this.award_item){for(var t=0;t<this.award_item.length;++t)this.award_item[t]&&(this.award_item[t].deleteMe(),this.award_item[t]=null);this.award_item=null}this.ctrl.openSureveyQuestView(!1)}});cc._RF.pop()},{pathtool:"pathtool",welfare_const:"welfare_const",welfare_event:"welfare_event"}],sys_controller:[function(t,e,i){"use strict";cc._RF.push(e,"46939PBCCVJr6c6VCwcZI01","sys_controller");var s=t("partner_const"),n=t("action_const"),a=t("role_controller"),o=(t("role_event"),t("adventureactivity_controller")),l=t("adventureactivity_const"),r=cc.Class({extends:BaseController,ctor:function(){this.initAttrProtocalsFunList()},registerEvents:function(){this.role_vo=a.getInstance().getRoleVo(),this.role_vo&&(this.role_assets_event=this.role_vo.bind(EventId.UPDATE_ROLE_ATTRIBUTE,function(t,e){"lev"!=t&&"open_day"!=t||this.requestAttrProtocals()}.bind(this))),this.login_event_success=gcore.GlobalEvent.bind(EventId.EVT_RE_LINK_GAME,function(){var e=t("guide_controller");if(!a.getInstance().checkRoleSetNameViewIsOpen()&&!e.getInstance().isInGuide()){var i=t("mainui_controller"),s=t("mainui_const");i.getInstance().changeMainUIStatus(s.btn_index.main_scene)}this.resetAttrProtocals(),this.requestReLinkProtocals()}.bind(this))},requestLoginProtocals:function(t){var e=[function(){this.SendProtocal(24600,{})}.bind(this),function(){var t=0;"SH_SDK"==PLATFORM_TYPR&&(t=1),this.SendProtocal(16691,{id:t})}.bind(this),function(){var t=0;"SH_SDK"==PLATFORM_TYPR&&(t=1),this.SendProtocal(16693,{id:t})}.bind(this),function(){"SH_SDK"==PLATFORM_TYPR&&this.SendProtocal(16695,{})}.bind(this),function(){this.SendProtocal(10500,{})}.bind(this),function(){this.SendProtocal(10501,{})}.bind(this),function(){this.SendProtocal(10325,{})}.bind(this),function(){this.SendProtocal(13006,{})}.bind(this),function(){this.SendProtocal(13008,{})}.bind(this),function(){this.SendProtocal(13011,{})}.bind(this),function(){this.SendProtocal(13017,{})}.bind(this),function(){this.SendProtocal(20700,{})}.bind(this),function(){this.SendProtocal(30001,{})}.bind(this),function(){this.SendProtocal(10317,{})}.bind(this),function(){this.SendProtocal(21100,{})}.bind(this),function(){this.SendProtocal(13601,{})}.bind(this),function(){this.SendProtocal(16637,{})}.bind(this),function(){this.SendProtocal(24700,{})}.bind(this),function(){this.SendProtocal(21012,{})}.bind(this),function(){this.SendProtocal(21010,{})}.bind(this),function(){this.SendProtocal(23606,{})}.bind(this),function(){this.SendProtocal(24204,{})}.bind(this),function(){this.SendProtocal(24220,{})}.bind(this),function(){this.SendProtocal(11e3,{})}.bind(this),function(){this.SendProtocal(11040,{})}.bind(this),function(){this.SendProtocal(11037,{})}.bind(this),function(){this.SendProtocal(11213,{type_list:[{type:s.Fun_Form.Drama},{type:s.Fun_Form.Arena}]})}.bind(this),function(){this.SendProtocal(24410,{})}.bind(this),function(){this.SendProtocal(24400,{})}.bind(this),function(){this.SendProtocal(24405,{})}.bind(this),function(){this.SendProtocal(19807,{})}.bind(this),function(){this.SendProtocal(19804,{})}.bind(this),function(){this.SendProtocal(19800,{})}.bind(this),function(){this.SendProtocal(19802,{})}.bind(this),function(){this.SendProtocal(10800,{})}.bind(this),function(){this.SendProtocal(10926,{})}.bind(this),function(){this.SendProtocal(23200,{})}.bind(this),function(){this.SendProtocal(23214,{})}.bind(this),function(){this.SendProtocal(13030,{})}.bind(this),function(){this.SendProtocal(10400,{})}.bind(this),function(){this.SendProtocal(16400,{})}.bind(this),function(){this.SendProtocal(20300,{})}.bind(this),function(){this.SendProtocal(19906,{})}.bind(this),function(){this.SendProtocal(16707,{})}.bind(this),function(){this.SendProtocal(16710,{})}.bind(this),function(){this.SendProtocal(16712,{})}.bind(this),function(){this.SendProtocal(30102,{})}.bind(this),function(){this.SendProtocal(21006,{})}.bind(this),function(){this.SendProtocal(24502,{})}.bind(this),function(){this.SendProtocal(14100,{})}.bind(this),function(){this.SendProtocal(16705,{})}.bind(this),function(){this.SendProtocal(21008,{})}.bind(this),function(){this.SendProtocal(16635,{})}.bind(this),function(){this.SendProtocal(16697,{})}.bind(this),function(){this.SendProtocal(16633,{})}.bind(this),function(){this.SendProtocal(23205,{})}.bind(this),function(){this.SendProtocal(13040,{})}.bind(this),function(){this.SendProtocal(11320,{})}.bind(this),function(){this.SendProtocal(16687,{bid:n.ActionRankCommonType.open_server})}.bind(this),function(){this.SendProtocal(16687,{bid:n.ActionRankCommonType.high_value_gift})}.bind(this),function(){this.SendProtocal(16687,{bid:n.ActionRankCommonType.mysterious_store})}.bind(this),function(){this.SendProtocal(21020,{})}.bind(this),function(){this.SendProtocal(25300,{})}.bind(this),function(){this.SendProtocal(25303,{})}.bind(this),function(){this.SendProtocal(16730,{})}.bind(this),function(){this.guildRedBagProtocal()}.bind(this),function(){this.adventrueProtocal()}.bind(this),function(){this.endlessProtocal()}.bind(this),function(){this.voyageProtocal()}.bind(this),function(){this.SendProtocal(19804,{})}.bind(this)],i=0;this.ping_timer_id=gcore.Timer.set(function(){e[i](),++i==e.length-1&&t&&t()}.bind(this),20,e.length)},requestReLinkProtocals:function(){var t=[function(){this.SendProtocal(10500,{})}.bind(this),function(){this.SendProtocal(10501,{})}.bind(this),function(){this.SendProtocal(13006,{})}.bind(this),function(){this.SendProtocal(13008,{})}.bind(this),function(){this.SendProtocal(13011,{})}.bind(this),function(){this.SendProtocal(13017,{})}.bind(this),function(){this.SendProtocal(24204,{})}.bind(this),function(){this.SendProtocal(11e3,{})}.bind(this),function(){this.SendProtocal(11040,{})}.bind(this),function(){this.SendProtocal(11037,{})}.bind(this),function(){this.SendProtocal(11213,{type_list:[{type:s.Fun_Form.Drama},{type:s.Fun_Form.Arena}]})}.bind(this),function(){this.SendProtocal(24410,{})}.bind(this),function(){this.SendProtocal(24400,{})}.bind(this),function(){this.SendProtocal(24405,{})}.bind(this),function(){this.SendProtocal(23200,{})}.bind(this),function(){this.SendProtocal(10400,{})}.bind(this),function(){this.SendProtocal(16400,{})}.bind(this),function(){this.SendProtocal(20300,{})}.bind(this),function(){this.SendProtocal(21006,{})}.bind(this),function(){this.SendProtocal(16705,{})}.bind(this),function(){this.SendProtocal(24700,{})}.bind(this),function(){this.SendProtocal(25300,{})}.bind(this),function(){this.guildRedBagProtocal()}.bind(this),function(){this.adventrueProtocal()}.bind(this),function(){this.endlessProtocal()}.bind(this),function(){this.voyageProtocal()}.bind(this),function(){this.arenaProtocal()}.bind(this),function(){this.SendProtocal(30001,{})}.bind(this)],e=0;this.ping_timer_id=gcore.Timer.set(function(){t[e](),e++}.bind(this),10,t.length)},initAttrProtocalsFunList:function(t){!t&&this.attr_fun_list||(this.attr_fun_list=[{func:function(){this.adventrueProtocal()}.bind(this),req_flag:!1},{func:function(){this.arenaProtocal()}.bind(this),req_flag:!1},{func:function(){this.endlessProtocal()}.bind(this),req_flag:!1},{func:function(){this.voyageProtocal()}.bind(this),req_flag:!1}])},checkProtocalIsCanRequest:function(t){return!(!this.attr_fun_list||!this.attr_fun_list[t]||this.attr_fun_list[t].req_flag)},guildRedBagProtocal:function(){this.role_vo&&0!=this.role_vo.gid&&""!=this.role_vo.gsrv_id&&this.SendProtocal(13534,{})},adventrueProtocal:function(t){var e=t;null==e&&(e=o.getInstance().isOpenActivity(l.Ground_Type.adventure)),0!=e&&this.checkProtocalIsCanRequest(0)&&(this.SendProtocal(20600,{}),this.SendProtocal(20601,{}),this.SendProtocal(20604,{}),this.SendProtocal(20634,{}),this.attr_fun_list[0]&&(this.attr_fun_list[0].req_flag=!0))},endlessProtocal:function(){var e=Config.endless_data.data_const.open_lev;e&&(t("mainui_controller").getInstance().checkIsOpenByActivate(e.val)&&this.checkProtocalIsCanRequest(2)&&(this.SendProtocal(23900,{}),this.SendProtocal(23903,{}),this.SendProtocal(23906,{}),this.attr_fun_list[2]&&(this.attr_fun_list[2].req_flag=!0)))},voyageProtocal:function(){var t=Config.shipping_data.data_const.guild_lev;!t||!this.role_vo||t.val>this.role_vo.lev||this.checkProtocalIsCanRequest(3)&&(this.SendProtocal(23800,{}),this.SendProtocal(23805,{}),this.SendProtocal(23821,{}),this.attr_fun_list[3]&&(this.attr_fun_list[3].req_flag=!0))},resetAttrProtocals:function(){this.initAttrProtocalsFunList(!0)},requestAttrProtocals:function(){if(this.attr_fun_list)for(var t in this.attr_fun_list){var e=this.attr_fun_list[t];e.req_flag||e.func()}},arenaProtocal:function(){var t=Config.arena_data.data_const.limit_lev;!t||!this.role_vo||this.role_vo.lev<t.val||this.checkProtocalIsCanRequest(1)&&(this.SendProtocal(20208,{}),this.SendProtocal(20200,{}),this.SendProtocal(20250,{}),this.SendProtocal(20223,{}),this.attr_fun_list[1]&&(this.attr_fun_list[1].req_flag=!0))}});e.exports=r,cc._RF.pop()},{action_const:"action_const",adventureactivity_const:"adventureactivity_const",adventureactivity_controller:"adventureactivity_controller",guide_controller:"guide_controller",mainui_const:"mainui_const",mainui_controller:"mainui_controller",partner_const:"partner_const",role_controller:"role_controller",role_event:"role_event"}],task_const:[function(t,e,i){"use strict";cc._RF.push(e,"b59f7ec4O9ANKGC1/ieYxNM","task_const");e.exports={type:{quest:1,feat:2,action:3},action_status:{normal:0,un_activity:1,activity:2,finish:3},update_type:{quest:1,feat:2,activity:3},task_type:{main:1,branch:2,daily:3},task_status:{un_finish:0,finish:1,completed:2,over:3}},cc._RF.pop()},{}],task_controller:[function(t,e,i){"use strict";cc._RF.push(e,"4f6bfKZYWRDXpwlXMiaunHe","task_controller");var s=t("role_controller"),n=t("task_const"),a=t("mainui_const"),o=t("mainui_controller"),l=t("jump_controller"),r=cc.Class({extends:BaseController,ctor:function(){},initConfig:function(){var e=t("task_model");this.model=new e(this),this.model.initConfig()},getModel:function(){return this.model},registerEvents:function(){null==this.init_quest_event&&(this.init_quest_event=gcore.GlobalEvent.bind(EventId.EVT_ROLE_CREATE_SUCCESS,function(){if(gcore.GlobalEvent.unbind(this.init_quest_event),this.init_quest_event=null,null==this.notice_view){var e=t("task_notice_view");this.notice_view=new e,this.notice_view.open()}this.role_vo=s.getInstance().getRoleVo(),null==this.role_assets_event&&(this.role_assets_event=this.role_vo.bind(EventId.UPDATE_ROLE_ATTRIBUTE,function(t,e){"activity"==t&&this.model.checkQuestAndFeatStatus(n.update_type.activity)}.bind(this)))}.bind(this))),null==this.re_link_game_event&&(this.re_link_game_event=gcore.GlobalEvent.bind(EventId.EVT_RE_LINK_GAME,function(){t("guide_controller").getInstance().isInGuide()||this.openTaskMainWindow(!1)}.bind(this)))},requestBaseQuestData:function(){this.SendProtocal(10400,{}),this.SendProtocal(16400,{}),this.requestActivityInfo()},registerProtocals:function(){this.RegisterProtocal(10400,this.on10400),this.RegisterProtocal(10403,this.on10403),this.RegisterProtocal(10406,this.on10406),this.RegisterProtocal(10409,this.on10409),this.RegisterProtocal(16400,this.on16400),this.RegisterProtocal(16401,this.on16401),this.RegisterProtocal(16402,this.on16402),this.RegisterProtocal(20300,this.on20300),this.RegisterProtocal(20301,this.on20301),this.RegisterProtocal(30001,this.on30001),this.RegisterProtocal(30002,this.on30002)},openTaskMainWindow:function(e,i){if(0==e)null!=this.task_main_window&&(this.task_main_window.close(),this.task_main_window=null);else{if(null==this.task_main_window){var s=t("task_main_window");this.task_main_window=new s}this.task_main_window.open(i)}},handleTaskProgress:function(t,e,i){if(e=e||1,null!=t.config.progress&&null!=Utils.next(t.config.progress)){var s=t.config.progress[e];if(null!=s){var n=t.config.extra;this.gotoTagertFun(s,n,i)}else null!=t.id&&cc.log("=================> \u5904\u7406\u4efb\u52a1id\u4e3a "+t.id+" \u7684\u7b2c "+e+" \u4e2a\u8fdb\u5ea6\u8981\u6c42\u65f6\u51fa\u9519")}else null!=t.id&&cc.log("=================> \u5904\u7406\u4efb\u52a1\u8fdb\u5ea6\u65f6\u51fa\u9519,\u4efb\u52a1id\u4e3a "+t.id+" \u7684\u6ca1\u6709\u914d\u7f6e\u4efb\u52a1\u8fdb\u5ea6")},gotoTagertFun:function(e,i,s){if(null!=e){var n=Config.quest_data.data_progress_lable;if(e.cli_label==n.evt_recruit)l.getInstance().jumpViewByEvtData([1]);else if(e.cli_label==n.evt_partner)if(i&&Utils.next(i)){var r=i[0],c=i[1];l.getInstance().jumpViewByEvtData([2,r,c])}else{t("partnersummon_controller").getInstance().openPartnerSummonWindow(!0)}else if(e.cli_label==n.evt_arena_fight||e.cli_label==n.evt_arena_fight_result||e.cli_label==n.evt_arena_score||e.cli_label==n.evt_arena_rank)l.getInstance().jumpViewByEvtData([3]);else if(e.cli_label==n.evt_friend_present||e.cli_label==n.evt_friend)l.getInstance().jumpViewByEvtData([4]);else if(e.cli_label==n.evt_dungeon_pass)l.getInstance().jumpViewByEvtData([5]);else if(e.cli_label==n.evt_levup||e.cli_label==n.evt_get_item||e.cli_label==n.evt_dungeon_enter)l.getInstance().jumpViewByEvtData([5]);else if(e.cli_label==n.evt_loss_silver_coin)l.getInstance().jumpViewByEvtData([6]);else if(e.cli_label==n.evt_gain_gold)l.getInstance().jumpViewByEvtData([7]);else if(e.cli_label==n.evt_eqm_sell)l.getInstance().jumpViewByEvtData([8]);else if(e.cli_label==n.evt_say)l.getInstance().jumpViewByEvtData([9]);else if(e.cli_label==n.evt_friend_sns)l.getInstance().jumpViewByEvtData([10]);else if(e.cli_label==n.evt_dungeon_fast_combat)l.getInstance().jumpViewByEvtData([11]);else if(e.cli_label==n.evt_adventure_explore||e.cli_label==n.evt_adventure_plunder||e.cli_label==n.evt_adventure_goto_floor||e.cli_label==n.evt_adventure_box||e.cli_label==n.evt_adventure_finger_guessing||e.cli_label==n.evt_adventure_answer_all_right||e.cli_label==n.evt_adventure_plunder_result||e.cli_label==n.evt_adventure_kill_mon);else if(e.cli_label==n.evt_boss_fight||e.cli_label==n.evt_boss_fight_result);else if(e.cli_label==n.evt_world_boss_fight||e.cli_label==n.evt_world_boss_fight_ko);else if(e.cli_label==n.evt_star_tower_pass)l.getInstance().jumpViewByEvtData([12]);else if(e.cli_label==n.evt_guild_dun_fight||e.cli_label==n.evt_guild_dun_fight_ko)l.getInstance().jumpViewByEvtData([31]);else if(e.cli_label==n.evt_guild_donate)l.getInstance().jumpViewByEvtData([13]);else if(e.cli_label==n.evt_partner_enchant_eqm||e.cli_label==n.evt_partner_levelup||e.cli_label==n.evt_partner_eqm||e.cli_label==n.evt_partner_artifact||e.cli_label==n.evt_eqm_compound)l.getInstance().jumpViewByEvtData([19]);else if(e.cli_label==n.evt_star_divination)AuguryController.getInstance().openMainView(!0);else if(e.cli_label==n.evt_dungeon_auto)l.getInstance().jumpViewByEvtData([5]);else if(e.cli_label==n.evt_guild_join)l.getInstance().jumpViewByEvtData([14]);else if(e.cli_label==n.evt_gain_guild)l.getInstance().jumpViewByEvtData([14]);else if(e.cli_label==n.evt_loss_guild)l.getInstance().jumpViewByEvtData([15,MallConst.MallType.UnionShop]);else if(e.cli_label==n.evt_power)l.getInstance().jumpViewByEvtData([16]);else if(e.cli_label==n.evt_star_natal||e.cli_label==n.evt_star_level_up||e.cli_label==n.evt_star_natal_level_up)StarlifeController.getInstance().openMainView(!0);else if(e.cli_label==n.evt_formation_open||e.cli_label==n.evt_formation_level_up);else if(e.cli_label==n.evt_dungeon_stone_fight)l.getInstance().jumpViewByEvtData([17]);else if(e.cli_label==n.evt_shipping)l.getInstance().jumpViewByEvtData([18]);else if(e.cli_label==n.evt_escort_enter||e.cli_label==n.evt_escort_fight)o.getInstance().changeMainUIStatus(a.btn_index.main_scene,a.sub_type.escort);else if(e.cli_label==n.evt_endless_fight)l.getInstance().jumpViewByEvtData([43]);else if(e.cli_label==n.evt_mystery_buy){t("mall_controller");1==e.target?l.getInstance().jumpViewByEvtData([15,MallConst.MallType.GodShop]):2==e.target?l.getInstance().jumpViewByEvtData([15,MallConst.MallType.Recovery]):3==e.target?l.getInstance().jumpViewByEvtData([15,MallConst.MallType.ScoreShop]):4==e.target?l.getInstance().jumpViewByEvtData([6]):l.getInstance().jumpViewByEvtData([15,MallConst.MallType.Recovery])}else e.cli_label==n.evt_partner_star?l.getInstance().jumpViewByEvtData([19]):e.cli_label==n.evt_hallows_all_step||e.cli_label==n.evt_hallows_step||e.cli_label==n.evt_hallows_activate?l.getInstance().jumpViewByEvtData([20]):e.cli_label==n.evt_guild_war?l.getInstance().jumpViewByEvtData([21]):e.cli_label==n.evt_endless_pass?Endless_trailController.getInstance().openEndlessMainWindow(!0):e.cli_label==n.evt_partner_decompose?l.getInstance().jumpViewByEvtData([22]):e.cli_label==n.evt_partner_star_up?l.getInstance().jumpViewByEvtData([23]):e.cli_label==n.evt_star_tower_floor_pass?l.getInstance().jumpViewByEvtData([12]):e.cli_label==n.evt_recruit_high?l.getInstance().jumpViewByEvtData([24]):e.cli_label==n.evt_expedition_fight?l.getInstance().jumpViewByEvtData([25]):e.cli_label==n.evt_primus_fight?l.getInstance().jumpViewByEvtData([27]):e.cli_label==n.evt_equipment_compound?l.getInstance().jumpViewByEvtData([26]):e.cli_label==n.evt_fragment_synthesis?l.getInstance().jumpViewByEvtData([8,3]):e.cli_label==n.evt_dungeon_ext_reward?l.getInstance().jumpViewByEvtData([46]):e.cli_label==n.evt_artifact_compose&&l.getInstance().jumpViewByEvtData([26,2])}},on10400:function(t){this.model.addTaskList(t.quest_list,!1,!0)},on10403:function(t){this.model.addTaskList(t.quest_list)},on10409:function(t){this.model.addTaskList(t.quest_list,!0)},on10406:function(t){message(t.msg),1==t.flag&&this.model.setTaskCompleted(t.id)},requestSubmitTask:function(t){var e={};e.id=t,this.SendProtocal(10406,e)},on16400:function(t){this.model.addFeatList(t.feat_list,!1,!0)},on16401:function(t){this.model.addFeatList(t.feat_list,!0)},on16402:function(t){message(t.msg),1==t.code&&this.model.setFeatCompleted(t.id)},requestSubmitFeat:function(t){var e={};e.id=t,this.SendProtocal(16402,e)},requestActivityInfo:function(){this.SendProtocal(20300,{})},on20300:function(t){this.model.updateActivityData(t.activity_box)},requestGetActivityAwards:function(t){var e={};e.activity=t,this.SendProtocal(20301,e)},on20301:function(t){message(t.msg),1==t.code&&this.model.updateSingleActivityData(t.activity)},send30001:function(){this.SendProtocal(30001,{})},on30001:function(t){cc.log("30001",t),this.model.setMainTaskData(t)},send30002:function(t){var e={};e.id=t,this.SendProtocal(30002,e)},on30002:function(t){cc.log("3002",t),message(t.msg),t.code}});e.exports=r,cc._RF.pop()},{guide_controller:"guide_controller",jump_controller:"jump_controller",mainui_const:"mainui_const",mainui_controller:"mainui_controller",mall_controller:"mall_controller",partnersummon_controller:"partnersummon_controller",role_controller:"role_controller",task_const:"task_const",task_main_window:"task_main_window",task_model:"task_model",task_notice_view:"task_notice_view"}],task_event:[function(t,e,i){"use strict";cc._RF.push(e,"03156zKW1hKWp1mOeYiwEIX","task_event"),e.exports={UpdateActivityInfo:"UpdateActivityInfo",UpdateSingleQuest:"UpdateSingleQuest",UpdateTaskList:"UpdateTaskList",UpdateFeatList:"UpdateFeatList",UpdateUIRedStatus:"UpdateUIRedStatus",UpdateMainQuestTask:"UpdateMainQuestTask"},cc._RF.pop()},{}],task_guide_window:[function(t,e,i){"use strict";cc._RF.push(e,"f400dE4DSJL9a6LH1XJW6Eq","task_guide_window");var s=t("pathtool"),n=t("guide_controller"),a=t("guide_const"),o=t("guide_event"),l=t("task_event"),r=t("task_controller");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("drama","task_guide_view"),this.viewTag=SCENE_TAG.msg},initConfig:function(){this.ctrl=n.getInstance(),this.model=this.ctrl.getModel(),this.task_ctrl=r.getInstance(),this.task_model=this.task_ctrl.getModel(),this.step=0,this.timer_hander=null},openCallBack:function(){game.views_js&&game.views_js.cancelTouch(),this.root_wg=this.root_wnd.getComponent(cc.Widget),window.FIT_SCALE>1&&(this.root_wg.isAlignTop=!0,this.root_wg.isAlignBottom=!0),this.background_nd=this.seekChild("background"),this.clip_con_nd=this.seekChild("clip_con"),this.effect_con_nd=this.seekChild("effect_con"),this.effect_con_sk=this.seekChild("effect_con",sp.Skeleton)},registerEvent:function(){this.addGlobalEvent(o.TaskNextStep,function(t){"quick_btn"!=t&&"quick_add_btn"!=t&&"compound_btn"!=t||(this.target_name==t?(this.step+=1,this.findRootWndByCondition()):this.handleEffect(!1)),"challenge_btn"==t&&(this.target_name==t?this.root_name=this.target_data[this.step+1][0]:this.handleEffect(!1))},this),this.addGlobalEvent(o.CloseTaskEffect,function(){this.handleEffect(!1),this.model.setTaskGuideLastPos(null),this.step=10,window.TASK_TIPS=!1},this),this.addGlobalEvent(l.UpdateMainQuestTask,function(t){this.config&&this.effect_con_nd&&(this.effect_con_nd.active=t.finish<1,window.TASK_TIPS=this.effect_con_nd.active)},this),this.addGlobalEvent(o.OpenTaskEffect,function(t){if(t.task_tips)return this.target_root_wnd=t,this.effect_con_nd.active=!1,this.step+=1,void this.findTargetNode();"guide_main_view"!=t.name&&0!=window.TASK_TIPS&&"arena_loop_match_window"!=t.name&&"forge_house_window"!=this.root_name&&"guildboss_main_window"!=this.root_name&&(this.target_root_wnd=t,this.effect_con_nd.active=!1,this.step+=1,"battle_drama_reward_window"==t.name&&(this.step=0),this.findTargetNode())},this)},openRootWnd:function(t){this.config=t,this.target_data=t.drama_eff,cc.log("target",this.target_data),this.step=0,this.model.setTaskGuideLastPos(null),this.timer_hander&&this.removeTimer(),this.getTaskTipsEffectNd(),this.findRootWndByCondition()},setVisibleStatus:function(t,e){this.setVisible(t),this.model.setTaskGuideLastPos(null),this.timer_hander&&this.removeTimer(),this.config=e,this.target_data=e.drama_eff,cc.log("target",this.target_data),this.step=0,this.getTaskTipsEffectNd(),this.findRootWndByCondition()},getTaskTipsEffectNd:function(){var e=t("mainui_controller").getInstance().getTaskTipsPanel();this.target=this.seekChild(e,"main"),this.drawTargetRect()},handleEffect:function(t){if(0==t)this.effect_con_sk&&(this.effect_con_sk.setToSetupPose(),this.effect_con_sk.clearTracks());else if(this.effect_con_sk){var e=s.getEffectRes(240),i=s.getSpinePath(e);this.loadRes(i,function(t){this.effect_con_sk.skeletonData=t,this.effect_con_sk.setAnimation(0,PlayerAction.action_1,!0)}.bind(this))}},findRootWndByCondition:function(e){if(this.effect_con_nd.active&&(this.effect_con_nd.active=!1),this.target_data&&this.target_data[0]){if(null==this.target_data[this.step])return this.handleEffect(!1),void(window.TASK_TIPS=!1);var i=this.target_data[this.step][0];cc.log(i),this.root_name=i;var s=null;if("partner"==i)s=(n=t("hero_controller")).getInstance().getHeroBagRoot();else if("battletopscene"==i){s=t("battle_controller").getInstance().getDramaFightUI()}else if("battlesceneview"==i){s=t("battle_controller").getInstance().getCtrlBattleScene()}else if("adventurescene"==i)s=AdventureController.getInstance().getAdventureRoot();else if("partnerform"==i)s=n.getInstance().getHeroFormRoot();else if("partnereinfoview"==i){s=(n=t("hero_controller")).getInstance().getHeroMianInfoRoot()}else if("partnergofight"==i){var n;s=(n=t("hero_controller")).getInstance().getHeroGoFightRoot()}else if("adventureevtview"==i)s=AdventureController.getInstance().getAdventureEvtRoot();else if("esecsiceview"==i){s=t("esecsice_controller").getInstance().getEsecsiceRoot()}else if("stonedunview"==i){s=t("stone_dungeon_controller").getInstance().getStoneDungeonRoot()}else if("varietystoreview"==i){s=t("mall_controller").getInstance().getVarietyStoreRoot()}else if("summon"==i){s=t("partnersummon_controller").getInstance().getSummonItemRoot()}else if("summonshow"==i){s=t("partnersummon_controller").getInstance().getSummonShowRoot()}else if("summonresult"==i){s=t("partnersummon_controller").getInstance().getSummonResultRoot()}else if("arenaloopview"==i){s=t("arena_controller").getInstance().getArenaRoot()}else if("voyageview"==i){s=t("voyage_controller").getInstance().getVoyageMainRoot()}else if("voyagedispatchview"==i){s=t("voyage_controller").getInstance().getVoyageDispatchRoot()}else if("forge_house_window"==i){s=t("forgehouse_controller").getInstance().getForgeHouseRoot()}else if("forge_artifact_panel"==i){s=t("forgehouse_controller").getInstance().getForgeArtifactRoot()}else if("guild_main_window"==i){s=t("guild_controller").getInstance().getGuildMainRootWnd()}else if("guildboss_main_window"==i){s=t("guildboss_controller").getInstance().getGuildBossMainRootWnd()}else if("battle_drama_reward_window"==i){s=t("battle_drama_controller").getInstance().getDramaBattlePassRewardRoot()}else if("backpack_window_3"==i){s=t("backpack_controller").getInstance().getBackpackRoot()}else if("backpack_comp_tips_window"==i){s=t("tips_controller").getInstance().getCompTipsRoot()}this.target_root_wnd=s,this.target_root_wnd?(gcore.Timer.set(function(){this.findTargetNode()}.bind(this),50,1),this.timer_hander&&this.removeTimer()):this.timer_hander||(this.effect_con_nd.active=!1,this.timer_hander=this.startUpdate(10,this.findRootWndByCondition.bind(this),300)),e&&e>=10&&(this.effect_con_nd.active=!1,this.step=10,window.TASK_TIPS=!1)}else window.TASK_TIPS=!1},delayPlayNextGuide:function(t){this.hasTicket("delayPlayNextGuide")&&this.delTicker("delayPlayNextGuide"),this.addTicket(this.findTargetNode.bind(this),t,"delayPlayNextGuide")},removeTimer:function(){this.timer_hander&&(this.stopUpdate(this.timer_hander),this.time_num=0,this.timer_hander=null)},findTargetNode:function(t){if(!this.target_data[this.step])return this.effect_con_nd.active=!1,void(window.TASK_TIPS=!1);var e=this.target_data[this.step][1],i=a.NodeKeys[e],s=a.getNameInfo(e);if(i||(i=e),s&&2==s.length)"tag"==s[0]&&(this.target=this.seekChildByTag(this.target_root_wnd,s[1]),this.target_name=s[1]);else{if("arenaloopview"==this.target_data[this.step][0])this.target=this.seekChildByTag(this.target_root_wnd,i);else if("forge_house_window"==this.target_data[this.step][0]&&"tab_btn_2"==i){var n=this.seekChild(this.target_root_wnd,"top_container");this.target=this.seekChild(n,i)}else this.target=this.seekChild(this.target_root_wnd,i);this.target_name=i}cc.log("targe",this.target),this.target?(this.removeTimer(),this.drawTargetRect()):this.timer_hander||(this.time_num=0,this.timer_hander=this.startUpdate(6,this.findTargetNode.bind(this),1e3)),t&&t>=5&&(this.removeTimer(),this.effect_con_nd.active=!1,this.model.setTaskGuideLastPos(null),window.TASK_TIPS=!1)},drawTargetRect:function(){if(this.target){this.clip_con_nd.active=!0,this.effect_con_nd.active=!0;var t=this.target.convertToWorldSpaceAR(cc.v2(0,0)),e=this.root_wnd.convertToNodeSpaceAR(t);e.y<t.y&&(e.y=t.y);var i=e.x+(.5-this.target.anchorX)*this.target.width,n=e.y+(.5-this.target.anchorY)*this.target.height,o=cc.v2(i,n);if(cc.log(o),this.clip_con_nd.position=o,this.clip_con_nd.width=this.target.width,this.clip_con_nd.height=this.target.height,this.show_guide_step=!0,this.show_guide_step){var l=this.model.getTaskGuideLastPos(),r=PlayerAction.action_1;l&&(r=PlayerAction.action_2);var c=s.getEffectRes(240),_=s.getSpinePath(c);if(this.loadRes(_,function(t,e){this.effect_con_sk.skeletonData=e,this.effect_con_sk.setAnimation(0,t,!0)}.bind(this,r)),this.effect_con_nd.stopAllActions(),l){var h=this.calDistanch(o,l)/a.Finger_Speed,d=cc.callFunc(function(){this.effect_con_sk.setAnimation(0,PlayerAction.action_1,!0),this.finish_action=!0},this),u=cc.moveTo(h,o),m=cc.sequence(u,d);this.effect_con_nd.runAction(m),this.finish_action=!1}else this.effect_con_nd.position=o}this.model.setTaskGuideLastPos(o)}},calDistanch:function(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))},playNextGuide:function(){this.saveGuideStep(),this.act_list&&0!=this.act_list.length?(this.target_data=this.act_list.shift(),this.guide_step=this.guide_step+1,cc.log("\u5f53\u524d\u6b65\u9aa4\u7684\u6570\u636e"),cc.log(this.target_data),this.guide_cache_data[this.act_config.id]&&this.guide_cache_data[this.act_config.id][this.guide_step]&&!this.cur_zone_list[this.guide_step]?this.playNextGuide():this.target_data&&this.findRootWndByCondition()):this.endPlayGuide()},endPlayGuide:function(t){cc.log("\u7ed3\u675f\u5f53\u524d\u5f15\u5bfc---"+this.act_config.id),this.step=0,this.model&&this.model.setTaskGuideLastPos(null)},saveGuideStep:function(){},getEffectActive:function(){return!!this.effect_con_nd&&this.effect_con_nd.active},closeCallBack:function(){this.removeTimer(),this.ctrl.openTaskGuideWindow(!1)}});cc._RF.pop()},{arena_controller:"arena_controller",backpack_controller:"backpack_controller",battle_controller:"battle_controller",battle_drama_controller:"battle_drama_controller",esecsice_controller:"esecsice_controller",forgehouse_controller:"forgehouse_controller",guide_const:"guide_const",guide_controller:"guide_controller",guide_event:"guide_event",guild_controller:"guild_controller",guildboss_controller:"guildboss_controller",hero_controller:"hero_controller",mainui_controller:"mainui_controller",mall_controller:"mall_controller",partnersummon_controller:"partnersummon_controller",pathtool:"pathtool",stone_dungeon_controller:"stone_dungeon_controller",task_controller:"task_controller",task_event:"task_event",tips_controller:"tips_controller",voyage_controller:"voyage_controller"}],task_item:[function(t,e,i){"use strict";cc._RF.push(e,"ce126O5KCVEQYu6H1HFG5om","task_item");var s=t("pathtool"),n=t("task_const"),a=t("task_event"),o=t("task_controller"),l=cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("task","task_item"),this.item_list=[]},initPanel:function(){this.btn_img_res="common_1098",this.container=this.root_wnd.getChildByName("container"),this.task_desc=this.container.getChildByName("task_desc").getComponent(cc.Label),this.btn_container=this.container.getChildByName("btn_container"),this.goto_btn=this.btn_container.getChildByName("goto_btn"),this.goto_btn_label=this.goto_btn.getChildByName("label").getComponent(cc.Label),this.goto_btn_label.string=Utils.TI18N("\u524d\u5f80"),this.goto_btn_img=this.goto_btn.getComponent(cc.Sprite),this.progress=this.btn_container.getChildByName("progress").getComponent(cc.ProgressBar),this.value=this.btn_container.getChildByName("value").getComponent(cc.Label),this.value.string=Utils.TI18N("0/0"),this.progress.progress=0,this.completed_img=this.container.getChildByName("completed_img")},registerEvent:function(){this.goto_btn&&this.goto_btn.on(cc.Node.EventType.TOUCH_END,function(){if(null!=this.data&&null!=this.data.config)if(this.data.finish==n.task_status.un_finish){if(null!=this.data.progress)for(var t in this.data.progress){if(0==this.data.progress[t].finish){o.getInstance().handleTaskProgress(this.data,t);break}}}else this.data.finish==n.task_status.finish&&(this.data.type==n.type.quest?o.getInstance().requestSubmitTask(this.data.id):this.data.type==n.type.feat&&o.getInstance().requestSubmitFeat(this.data.id))},this)},addCallBack:function(t){this.callback=t},registerScriptHandler:function(t){"enter"==t||"exit"==t&&null!=this.data&&(null!=this.update_self_event&&(this.data.unbind(this.update_self_event),this.update_self_event=null),this.data=null)},setData:function(t){this.data=t,null!=this.root_wnd&&this.onShow()},onShow:function(){null==this.update_self_event&&(this.update_self_event=this.data.bind(a.UpdateSingleQuest,function(){this.updateSelf()}.bind(this))),this.fillAwardsItems(),this.updateSelf()},fillAwardsItems:function(){if(null!=this.data&&null!=this.data.config&&null!=this.data.config.commit_rewards){for(var t in this.item_list){(e=this.item_list[t]).setVisible(!1)}for(var t in this.data.config.commit_rewards){var e,i=this.data.config.commit_rewards[t],s=i[0],n=i[1];if(null==(e=this.item_list[t])){(e=ItemsPool.getInstance().getItem("backpack_item")).initConfig(!1,.7,!1,!0);var a=(.7*BackPackItem.Width+20)*t+58;e.setPosition(a,54),e.show(),e.setParent(this.container),this.item_list[t]=e}else e.setVisible(!0);e.setData({bid:s,num:n})}}},changeImg:function(t){this.loadRes(t,function(t){this.goto_btn_img.spriteFrame=t}.bind(this))},updateSelf:function(){if(null!=this.data){this.id=this.data.id,this.finish_sort=this.data.finish_sort,this.completed_img.active=this.data.finish==n.task_status.completed,this.btn_container.active=this.data.finish!=n.task_status.completed;var t="";if(this.data.finish==n.task_status.un_finish?(this.goto_btn_label.string=Utils.TI18N("\u524d\u5f80"),t="common_1098",this.goto_btn_label.node.color=new cc.Color(37,85,5,255)):this.data.finish==n.task_status.finish&&(this.goto_btn_label.string=Utils.TI18N("\u63d0\u4ea4"),t="common_1027",this.goto_btn_label.node.color=new cc.Color(113,40,4)),this.btn_img_res!=t&&""!=t&&(this.btn_img_res=t,this.changeImg(s.getCommonIcomPath(t))),this.data.finish!=n.task_status.completed&&null!=this.data.progress){var e=this.data.progress[0];null!=e&&(this.value.string=cc.js.formatStr("%s/%s",Utils.getMoneyString(e.value),Utils.getMoneyString(e.target_val)),this.progress.progress=e.value/e.target_val)}this.task_desc.string=this.data.getTaskContent()}},suspendAllActions:function(){null!=this.data&&(null!=this.update_self_event&&(this.data.unbind(this.update_self_event),this.update_self_event=null),this.data=null)},onDelete:function(){for(var t in this.item_list){var e=this.item_list[t];e&&e.deleteMe()}this.item_list=null,this.suspendAllActions()}});e.exports=l,cc._RF.pop()},{pathtool:"pathtool",task_const:"task_const",task_controller:"task_controller",task_event:"task_event"}],task_main_window:[function(t,e,i){"use strict";cc._RF.push(e,"cb70eu4b8ZLnrpvEbKR3MB+","task_main_window");t("pathtool");var s=t("task_controller"),n=t("task_event"),a=t("task_const"),o=cc.Class({extends:CommonWindowTab,ctor:function(){this.ctrl=s.getInstance(),this.model=this.ctrl.getModel(),this.win_type=WinType.Full,this.tab_info_list=[{label:Utils.TI18N("\u65e5\u5e38"),index:a.type.quest,status:!0,notice:Utils.TI18N("\u65e5\u5e38\u4efb\u52a111\u7ea7\u5f00\u542f")},{label:Utils.TI18N("\u6210\u5c31"),index:a.type.feat,status:!0,notice:Utils.TI18N("\u65e5\u5e38\u4efb\u52a115\u7ea7\u5f00\u542f")}],this.title_str=Utils.TI18N("\u65e5\u5e38"),this.cur_index=1,this.cur_panel=null,this.panel_list=[];var e=t("action_controller");e.getInstance().action_operate&&e.getInstance().action_operate.setVisible(!1)},registerEvent:function(){this.addGlobalEvent(n.UpdateUIRedStatus,function(t,e){this.updateUIRedStatus(t)}.bind(this))},selectedTabCallBack:function(t){t==a.type.quest?this.changeTitleName(Utils.TI18N("\u65e5\u5e38")):t==a.type.feat&&this.changeTitleName(Utils.TI18N("\u6210\u5c31")),this.changePanel(t)},openRootWnd:function(t){t=t||a.type.quest,this.setSelecteTab(t,!0),this.updateUIRedStatus(a.update_type.feat),this.updateUIRedStatus(a.update_type.quest)},updateUIRedStatus:function(t){if(t==a.update_type.feat){var e=this.model.getRedStatus(a.update_type.feat);this.setTabTips(e,a.type.feat)}else{var i=this.model.getRedStatus(a.update_type.quest);0==i&&(i=this.model.getRedStatus(a.update_type.activity)),this.setTabTips(i,a.type.quest)}},changePanel:function(e){if(null!=this.cur_panel&&(this.cur_panel.addToParent(!1),this.cur_panel=null),null==this.panel_list[e]){if(e==a.type.quest){var i=t("task_panel");this.panel_list[e]=new i}else if(e==a.type.feat){var s=t("feat_panel");this.panel_list[e]=new s}this.panel_list[e].setParent(this.container),this.panel_list[e].show()}this.cur_panel=this.panel_list[e],null!=this.cur_panel&&this.cur_panel.addToParent(!0)},closeCallBack:function(){for(var e in this.panel_list)this.panel_list[e].deleteMe(),this.panel_list[e]=null;this.panel_list=null;var i=t("action_controller");i.getInstance().action_operate&&i.getInstance().action_operate.setVisible(!0),this.ctrl.openTaskMainWindow(!1)}});e.exports=o,cc._RF.pop()},{action_controller:"action_controller",feat_panel:"feat_panel",pathtool:"pathtool",task_const:"task_const",task_controller:"task_controller",task_event:"task_event",task_panel:"task_panel"}],task_model:[function(t,e,i){"use strict";cc._RF.push(e,"cbaefStWFJBmJI1Ps8JScv/","task_model");var s=t("task_const"),n=t("role_controller"),a=t("task_event"),o=t("task_vo");cc.Class({extends:BaseClass,ctor:function(){this.ctrl=arguments[0]},properties:{},initConfig:function(){this.task_list=[],this.feat_list={},this.task_status_list=[],this.update_feat_status_list=[],this.finish_feat_list=[]},checkQuestAndFeatStatus:function(e){var i=!1;if(e==s.update_type.activity){var o=n.getInstance().getRoleVo();if(null!=o&&null!=this.activity_data)for(var l in Config.activity_data.data_get){var r=Config.activity_data.data_get[l];if(o.activity>=r.activity&&!this.activity_data[r.activity]){i=!0;break}}}else if(e==s.update_type.quest){if(null!=this.task_list)for(var c in this.task_list){if((r=this.task_list[c]).finish==s.task_status.finish){i=!0;break}}}else if(e==s.update_type.feat&&null!=this.feat_list)for(var c in this.feat_list){if((r=this.feat_list[c]).finish==s.task_status.finish){i=!0;break}}null==this.red_status_list&&(this.red_status_list=[]),(null==this.red_status_list[e]||null!=this.red_status_list[e]&&this.red_status_list[e]!=i)&&(this.red_status_list[e]=i,gcore.GlobalEvent.fire(a.UpdateUIRedStatus,e,i));var _=0;1==i&&(_=1);var h=t("mainui_const");t("mainui_controller").getInstance().setFunctionTipsStatus(h.icon.daily,{bid:e,num:_})},getRedStatus:function(t){return null!=this.red_status_list&&this.red_status_list[t]},updateActivityData:function(t){for(var e in this.activity_data={},t){var i=t[e];this.activity_data[i.activity]=!0}this.checkQuestAndFeatStatus(s.update_type.activity),gcore.GlobalEvent.fire(a.UpdateActivityInfo,this.activity_data)},updateSingleActivityData:function(t){null!=this.activity_data&&(this.activity_data[t]=!0,this.checkQuestAndFeatStatus(s.update_type.activity),gcore.GlobalEvent.fire(a.UpdateActivityInfo,this.activity_data))},getActivityData:function(){return this.activity_data},addTaskList:function(t,e,i){var n=!1,l=[];for(var r in 1==i&&(this.task_list=[]),t){var c=t[r];null!=gdata("quest_data","data_get",[c.id])&&(null==this.task_list[c.id]?(this.task_list[c.id]=new o(c.id,s.type.quest),n=!0):1==c.finish&&1==e&&l.push(c.id),this.task_list[c.id].updateData(c))}this.checkQuestAndFeatStatus(s.update_type.quest),gcore.GlobalEvent.fire(a.UpdateTaskList,n,l)},setTaskCompleted:function(t){var e=this.task_list[t];null!=e&&(e.setCompletedStatus(s.task_status.completed),this.checkQuestAndFeatStatus(s.update_type.quest),gcore.GlobalEvent.fire(a.UpdateTaskList,!1))},getTaskList:function(){var t=[];for(var e in this.task_list)t.push(this.task_list[e]);return Utils.next(t)&&t.sort(Utils.tableLowerSorter(["finish_sort","id"])),t},getTaskById:function(t){return this.task_list[t]},getFeatById:function(t){return this.feat_list[t]},addFeatList:function(t,e,i){var n=!1,a=[];for(var l in 1==i&&(this.feat_list={}),t){var r=t[l];null!=gdata("feat_data","data_get",[r.id])&&(null==this.feat_list[r.id]?(this.feat_list[r.id]=new o(r.id,s.type.feat),n=!0):1==r.finish&&1==e&&a.push(r.id),this.feat_list[r.id].updateData(r))}this.checkQuestAndFeatStatus(s.update_type.feat),this.needUpdateFeat(n,a)},setFeatCompleted:function(t){var e=this.feat_list[t];null!=e&&(e.setCompletedStatus(s.task_status.completed),this.checkQuestAndFeatStatus(s.update_type.feat),this.needUpdateFeat(!1))},needUpdateFeat:function(t,e){gcore.GlobalEvent.fire(a.UpdateFeatList,e)},getFeatList:function(){var t=[];for(var e in this.feat_list){var i=this.feat_list[e];i.finish!=s.task_status.completed&&t.push(i)}return Utils.next(t)&&t.sort(Utils.tableLowerSorter(["finish_sort","id"])),t},setMainTaskData:function(t){this.main_task_data=t,gcore.GlobalEvent.fire(a.UpdateMainQuestTask,t)},getMainTaskData:function(){return this.main_task_data}});cc._RF.pop()},{mainui_const:"mainui_const",mainui_controller:"mainui_controller",role_controller:"role_controller",task_const:"task_const",task_event:"task_event",task_vo:"task_vo"}],task_notice_view:[function(t,e,i){"use strict";cc._RF.push(e,"e99398X3ZxIIo4+4wEYdA5Z","task_notice_view");var s=t("pathtool"),n=t("task_controller"),a=t("task_event"),o=t("task_const"),l=t("loadermanager"),r=t("viewclass"),c=cc.Class({extends:r,ctor:function(){this.prefabPath=s.getPrefabPath("task","task_notice_item"),this.viewTag=SCENE_TAG.msg,this.finish_list=[],this.base_view_event_list={},this.res_list={}},open:function(t){if(this.open_params=t,this.root_wnd)this.openRootWnd();else{var e=this;l.getInstance().loadRes(this.prefabPath,function(t){t instanceof cc.Prefab?this.is_close||(this.root_wnd=t,this.root_wnd.setPosition(.5*-SCREEN_WIDTH,.5*-SCREEN_HEIGHT),ViewManager.getInstance().addToSceneNode(this.root_wnd,this.viewTag),e.fastShowThenHide&&(e.fastShowThenHide=!1,e.setVisible(!1)),this.openCallBack(),this.registerEvent(),e.openRootWnd(e.open_params)):cc.log("\u4f60\u8f7d\u5165\u7684\u4e0d\u662f\u9884\u5236\u8d44\u6e90")}.bind(this))}},openCallBack:function(){this.container=this.root_wnd.getChildByName("container");var t=this.root_wnd.getContentSize();this.root_wnd.setPosition(-t.width/2,.5*SCREEN_HEIGHT-t.height),this.container.active=!1,this.task_img=this.container.getChildByName("task_img").getComponent(cc.Sprite),this.task_name=this.container.getChildByName("task_name").getComponent(cc.Label),this.task_desc=this.container.getChildByName("task_desc").getComponent(cc.Label),this.target_height=this.container.getContentSize().height},openRootWnd:function(){},registerEvent:function(){this.addGlobalEvent(a.UpdateTaskList,function(t,e){this.fillFinishData(e,o.type.quest)}.bind(this)),this.addGlobalEvent(a.UpdateFeatList,function(t){this.fillFinishData(t,o.type.feat)}.bind(this)),this.container.on(cc.Node.EventType.TOUCH_END,function(){this.doMoveOut(),this.cur_info&&n.getInstance().openTaskMainWindow(!0,this.cur_info.type)},this)},fillFinishData:function(t,e){if(null!=t&&null!=Utils.next(t)){for(var i in t){var s=t[i];this.finish_list.push({id:s,type:e})}this.doMoveFinishItem()}},doMoveFinishItem:function(){if(1!=this.be_in_show&&null!=this.finish_list&&null!=Utils.next(this.finish_list)){this.be_in_show=!0;var t=this.finish_list.splice(0,1);if(t=t[0]){var e=n.getInstance().getModel();t.type==o.type.quest?this.cur_info=e.getTaskById(t.id):t.type==o.type.feat&&(this.cur_info=e.getFeatById(t.id))}if(this.cur_info&&this.cur_info.config){var i="quest_item_icon";this.cur_info.type==o.type.feat?(this.task_name.string=Utils.TI18N("\u6210\u5c31\u8fbe\u6210"),i="quest_item_icon_2"):(this.task_name.string=Utils.TI18N("\u65e5\u5e38\u5b8c\u6210"),i="quest_item_icon"),this.task_desc.string=this.cur_info.getTaskContent();var a=s.getBigBg("quest/"+i);this.loadRes(a,function(t){this.task_img.spriteFrame=t}.bind(this)),this.doMoveIn()}}},doMoveIn:function(){this.container.active=!0,this.container.opacity=0,this.container.y=this.target_height;var t=cc.fadeIn(.3),e=cc.moveTo(.3,cc.v2(0,0)),i=cc.delayTime(3),s=cc.fadeOut(.3),n=cc.moveTo(.3,cc.v2(0,this.target_height)),a=cc.callFunc(function(){this.doMoveOut()},this);this.container.runAction(cc.sequence(cc.spawn(t,e),i,cc.spawn(s,n),a),this)},doMoveOut:function(){this.be_in_show=!1,this.container.stopAllActions(),this.container.active=!1,this.container.opacity=0,this.container.y=this.target_height},onDelete:function(){}});e.exports=c,cc._RF.pop()},{loadermanager:"loadermanager",pathtool:"pathtool",task_const:"task_const",task_controller:"task_controller",task_event:"task_event",viewclass:"viewclass"}],task_panel:[function(t,e,i){"use strict";cc._RF.push(e,"99ea796jU5N6oPNC6Sqe62d","task_panel");var s=t("pathtool"),n=t("task_controller"),a=t("task_event"),o=t("task_const"),l=(t("role_event"),t("role_controller")),r=t("common_scrollview"),c=t("task_item"),_=cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("task","task_panel"),this.box_list=[109,108,108,110],this.ctrl=n.getInstance(),this.model=this.ctrl.getModel(),this.role_vo=l.getInstance().getRoleVo(),this.is_new=null,this.need_update=null},initPanel:function(){this.container=this.root_wnd.getChildByName("container");var t=this.container.getChildByName("activity_container");this.progress=t.getChildByName("progress_container").getChildByName("progress").getComponent(cc.ProgressBar),this.value=t.getChildByName("value").getComponent(cc.Label),this.value.string="0/100",this.awards_list=[];for(var e=1;e<=Config.activity_data.data_get_length;e++){var i=t.getChildByName("awards_"+e);null!=i&&(i.effect_container=i.getChildByName("effect_container"),i.effect_container.skeleton=i.effect_container.getComponent(sp.Skeleton),i.target_value=i.getChildByName("target_value").getComponent(cc.Label),i.is_show_tips=!0,i.status=o.action_status.normal,null!=gdata("activity_data","data_get",[e])&&(i.config=gdata("activity_data","data_get",[e]),i.target_value.string=i.config.activity),this.awards_list[e]=i)}this.quest_container=this.container.getChildByName("quest_container");var s=this.quest_container.getContentSize(),n=cc.size(s.width,s.height-20),a={item_class:c,start_x:6,space_x:0,start_y:0,space_y:2,item_width:610,item_height:148,row:0,col:1,need_dynamic:!0};this.item_scrollview=new r,this.item_scrollview.createScroll(this.quest_container,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,n,a,cc.v2(.5,.5)),this.updateTaskList(this.is_new),this.updateActivity(this.need_update)},addToParent:function(t){null==this.root_wnd?this.active_value=t:this.root_wnd.active=t,1==t&&(this.ctrl.requestActivityInfo(),this.updateTaskList(!0),this.updateActivity(!1))},handleDynamicEvent:function(t){t||(null!=this.role_assets_event&&(null!=this.role_vo&&this.role_vo.unbind(this.role_assets_event),this.role_assets_event=null),null!=this.update_activity_event&&(gcore.GlobalEvent.unbind(this.update_activity_event),this.update_activity_event=null),null!=this.update_task_list&&(gcore.GlobalEvent.unbind(this.update_task_list),this.update_task_list=null))},setPosition:function(t,e){this.x=t,this.y=e,this.root_wnd&&this.root_wnd.setPosition(this.x,this.y)},setVisible:function(t){this.root_wnd&&(this.root_wnd.active=t)},registerEvent:function(){for(var e in this.awards_list){this.awards_list[e].on(cc.Node.EventType.TOUCH_END,function(e){var i=e.currentTarget;null!=i.config&&(1==i.is_show_tips?t("commonalert").showItemApply(Utils.TI18N("\u5f53\u524d\u6d3b\u8dc3\u5ea6\u5956\u52b1"),i.config.rewards,null,Utils.TI18N("\u786e\u5b9a"),null,null,Utils.TI18N("\u5956\u52b1"),null,null,!0,null,null,{off_y:50}):this.role_vo&&this.role_vo.activity>=i.config.activity&&this.ctrl.requestGetActivityAwards(i.config.activity))}.bind(this))}null!=this.role_vo&&null==this.role_assets_event&&(this.role_assets_event=this.role_vo.bind(EventId.UPDATE_ROLE_ATTRIBUTE,function(t,e){"activity"==t&&this.updateActivity(!0)}.bind(this))),null==this.update_activity_event&&(this.update_activity_event=gcore.GlobalEvent.bind(a.UpdateActivityInfo,function(t){this.updateActivityData(t)}.bind(this))),null==this.update_task_list&&(this.update_task_list=gcore.GlobalEvent.bind(a.UpdateTaskList,function(t){this.updateTaskList(t)}.bind(this))),this.ctrl.requestActivityInfo()},updateActivity:function(t){if(this.need_update=t,null!=this.root_wnd&&null!=this.role_vo){var e=gdata("activity_data","data_get",[Config.activity_data.data_get_length]),i=100;null!=e&&(i=e.activity),this.value.string=this.role_vo.activity+"/"+i,this.progress.progress=this.role_vo.activity/i,1==t&&this.updateActivityData(this.model.getActivityData())}},updateActivityData:function(t){if(null!=this.role_vo){var e=t,i=function(t){return null!=e&&e[t]};for(var s in this.awards_list){var n=this.awards_list[s];if(n&&n.config&&n.effect_container){1==i(n.config.activity)?(n.is_show_tips=!0,n.status=o.action_status.finish):n.config.activity<=this.role_vo.activity?(n.is_show_tips=!1,n.status=o.action_status.activity):(n.is_show_tips=!0,n.status=o.action_status.un_activity);var a=PlayerAction.action_1;if(n.status==o.action_status.finish?a=PlayerAction.action_3:n.status==o.action_status.activity&&(a=PlayerAction.action_2),n.effect_container.skeleton.skeletonData)n.box_action!=a&&(n.effect_container.skeleton.setAnimation(0,a,!0),n.box_action=a);else{var l=gdata("effect_data","data_effect_info",this.box_list[s-1]),r=cc.js.formatStr("spine/%s/action.atlas",l),c=n.effect_container.skeleton;this.createEffect(c,r,a)}}}}},createEffect:function(t,e,i){this.loadRes(e,function(e){t.skeletonData=e,t.setAnimation(0,i,!0)}.bind(this))},updateTaskList:function(t){if(this.is_new=t,null!=this.root_wnd){var e=this.model.getTaskList();this.item_scrollview.setData(e)}},onDelete:function(){null!=this.role_assets_event&&(null!=this.role_vo&&this.role_vo.unbind(this.role_assets_event),this.role_assets_event=null),null!=this.update_activity_event&&(gcore.GlobalEvent.unbind(this.update_activity_event),this.update_activity_event=null),null!=this.update_task_list&&(gcore.GlobalEvent.unbind(this.update_task_list),this.update_task_list=null),this.item_scrollview&&(this.item_scrollview.deleteMe(),this.item_scrollview=null)}});e.exports=_,cc._RF.pop()},{common_scrollview:"common_scrollview",commonalert:"commonalert",pathtool:"pathtool",role_controller:"role_controller",role_event:"role_event",task_const:"task_const",task_controller:"task_controller",task_event:"task_event",task_item:"task_item"}],task_tips_panel:[function(t,e,i){"use strict";cc._RF.push(e,"2278aaKmj1Ac4i6bb+woDTS","task_tips_panel");var s=t("pathtool"),n=t("hallows_controller"),a=t("task_controller"),o=(t("hallows_event"),t("guide_controller")),l=t("guide_event"),r=t("task_event");a=t("task_controller"),cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("mainui","task_tips_panel"),this.mainui=arguments[0]},initConfig:function(){this.hallow_ctrl=n.getInstance(),this.hallow_model=this.hallow_ctrl.getModel(),this.task_ctrl=a.getInstance(),this.task_model=this.task_ctrl.getModel(),this.hallow_id="",this.task_list=[],this.task_data=null,this.red_color=new cc.Color(163,32,0,255),this.green_color=new cc.Color(0,64,5,255),this.new_player_status=!1},initPanel:function(){this.main=this.seekChild("main"),this.icon=this.seekChild("icon"),this.title_lb=this.seekChild("title",cc.Label),this.progress_pb=this.seekChild("progress",cc.ProgressBar),this.progress_lb=this.seekChild("pro_label",cc.Label),this.get_nd=this.seekChild("get_sp"),this.effect_sk=this.seekChild("effect",sp.Skeleton),this.finish_sk=this.seekChild("finish",sp.Skeleton),this.backpack_item=ItemsPool.getInstance().getItem("backpack_item"),this.backpack_item.setParent(this.icon),this.backpack_item.initConfig(!1,.65,!1,!0),this.backpack_item.show(),this.open_status&&this.getTaskList()},registerEvent:function(){Utils.onTouchEnd(this.main,function(){this.task_data&&(0==this.task_data.finish?(window.TASK_TIPS=!0,this.task_data&&this.config&&(a.getInstance().gotoTagertFun(this.config.progress[0],this.config.extra),this.changeTaskGuideWindow(!0))):1==this.task_data.finish?(this.task_data&&this.config&&this.task_ctrl.send30002(this.task_data.id),window.TASK_TIPS=!1):2==this.task_data.finish&&(this.getTaskList(),window.TASK_TIPS=!1))}.bind(this),1),this.addGlobalEvent(r.UpdateMainQuestTask,function(t){2==t.finish?this.mainui&&this.mainui.deleteTaskTip():this.getTaskList()},this),this.addGlobalEvent(l.NewPlayerGuideStart,function(){this.handleEffect(!1),this.new_player_status=!0},this),this.addGlobalEvent(l.NewPlayerGuideClose,function(){this.new_player_status=!1,this.handleEffect(!0)},this)},onShow:function(t){this.getTaskList()},getTaskList:function(){if(null!=this.root_wnd){if(this.task_data=this.task_model.getMainTaskData(),cc.log(this.task_data),null!=this.task_data)if(2!=this.task_data.finish){var t=gdata("main_quest_data","data_task",this.task_data.id);if(this.config=t,cc.log(this.task_data,t),t){this.title_lb.string=t.desc;var e=this.task_data.value||0,i=this.task_data.target_val||0;this.progress_lb.string=e+"/"+i,this.progress_pb.progress=e/i;var s=t.items;if(s&&s[0])Utils.getItemConfig(s[0][0])&&this.backpack_item.setData({bid:s[0][0],num:s[0][1]})}else this.title_lb.string="";var n=this.config.is_show_eff;this.handleEffect(this.task_data.finish<1&&n),this.handleFinishEffect(this.task_data.finish>=1),this.changeStatusSp(this.task_data.finish>=1)}else this.mainui.deleteTaskTip()}else this.open_status=!0},handleEffect:function(t){if(0==t)this.effect_sk&&(this.effect_sk.setToSetupPose(),this.effect_sk.clearTracks());else{if(o.getInstance().isInGuide())return;if(this.effect_sk&&0==this.new_player_status){var e=s.getEffectRes(240),i=s.getSpinePath(e);this.loadRes(i,function(t){this.effect_sk.skeletonData=t,this.effect_sk.setAnimation(0,PlayerAction.action_1,!0)}.bind(this))}}},handleFinishEffect:function(t){if(0==t)this.finish_sk&&(this.finish_sk.setToSetupPose(),this.finish_sk.clearTracks());else if(this.finish_sk){window.TASK_TIPS=!1;var e=s.getSpinePath("E99999");this.loadRes(e,function(t){this.finish_sk.skeletonData=t,this.finish_sk.setAnimation(0,PlayerAction.action,!0)}.bind(this))}},changeStatusSp:function(t){this.get_nd.active=t},changeTaskGuideWindow:function(t){null!=this.config.drama_eff[0]?(o.getInstance().getTaskGuideWindow()?o.getInstance().getTaskGuideWindow().setVisibleStatus(t,this.config):o.getInstance().openTaskGuideWindow(!0,this.config),this.handleEffect(!t)):window.TASK_TIPS=!1},onHide:function(){},onDelete:function(){this.handleEffect(!1),this.handleFinishEffect(!1),this.backpack_item&&this.backpack_item.deleteMe(),this.backpack_item=null}});cc._RF.pop()},{guide_controller:"guide_controller",guide_event:"guide_event",hallows_controller:"hallows_controller",hallows_event:"hallows_event",pathtool:"pathtool",task_controller:"task_controller",task_event:"task_event"}],task_vo:[function(t,e,i){"use strict";cc._RF.push(e,"56374yq0MVOq5n5TehZh9Lc","task_vo");var s=t("task_const"),n=t("task_event"),a=cc.Class({extends:gcore.BaseEvent,ctor:function(){this.id=arguments[0],this.type=arguments[1]||s.type.quest,this.type==s.type.quest?this.config=gdata("quest_data","data_get",[this.id]):this.type==s.type.feat?this.config=gdata("feat_data","data_get",[this.id]):(this.type,s.type.action),this.finish=s.task_status.un_finish,this.finish_sort=0},_delete:function(){},getTaskContent:function(){return this.config.desc},getTaskName:function(){return this.config&&this.config.name||""},setCompletedStatus:function(t){this.finish=t,this.setFinishSort(),this.dispatchUpdate()},updateData:function(t){this.finish=t.finish,this.progress=t.progress,this.setFinishSort(),this.dispatchUpdate()},dispatchUpdate:function(){this.fire(n.UpdateSingleQuest,this.id)},setFinishSort:function(){this.finish==s.task_status.un_finish?this.finish_sort=1:this.finish==s.task_status.finish?this.finish_sort=0:this.finish==s.task_status.completed?this.finish_sort=2:this.finish_sort=3}});e.exports=a,cc._RF.pop()},{task_const:"task_const",task_event:"task_event"}],time_summon_award_window:[function(t,e,i){"use strict";cc._RF.push(e,"6417eAtnHFBfbf4YxokUybm","time_summon_award_window");var s=t("pathtool"),n=t("timesummon_const"),a=t("timetool");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("action","action_time_summon_award"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Mini,this.ctrl=arguments[0]},initConfig:function(){this.up_item_list=[]},openCallBack:function(){this.background=this.root_wnd.getChildByName("background");var t=this.root_wnd.getChildByName("container");this.container=t,t.getChildByName("win_title").getComponent(cc.Label).string=Utils.TI18N("\u5956\u52b1\u8be6\u60c5"),this.time_label=t.getChildByName("time_label").getComponent(cc.Label),this.close_btn=t.getChildByName("close_btn");var e=t.getChildByName("list_panel");this.scroll_size=e.getContentSize(),this.view_content=this.seekChild("content")},registerEvent:function(){this.close_btn.on("click",function(){Utils.playButtonSound(2),this.ctrl.openTimeSummonAwardView(!1)},this)},openRootWnd:function(t){this.text_elite=t.text_elite||null,this.group_id=t.group_id,this.data=t.data,this.setData()},setData:function(){if(null!=this.group_id){var t=0,e=Config.recruit_holiday_data.data_probability[this.group_id];1==this.text_elite&&(e=Config.recruit_holiday_elite_data.data_probability[this.group_id]);var i=0;if(e){var o=[];for(var l in e){var r=e[l];1==r.is_up&&o.push(r)}this.title_bg_1||(this.title_bg_1=Utils.createImage(this.view_content,null,0,0,cc.v2(.5,1),null,null,!0),this.title_bg_1.node.setContentSize(cc.size(610,44)),Utils.createLabel(24,new cc.Color(255,242,199,255),null,-295,-22,Utils.TI18N("\u672c\u671fUP\u5185\u5bb9"),this.title_bg_1.node,null,cc.v2(0,.5)));for(var c=o.length,_=.5*this.view_content.width-69.5*c+69.5,h=0;h<o.length;++h){var d=o[h],u=this.up_item_list[h];if(null==u){(u=ItemsPool.getInstance().getItem("backpack_item")).setDefaultTip(!0),u.setParent(this.view_content),this.up_item_list[h]=u;var m=-305+_+139*h;u.setPosition(m,-25)}u.show(),u.setData({bid:d.id,num:d.num})}t=i=189}var f=0;if(this.data){var p=Config.recruit_holiday_data.data_action[this.data.camp_id];if(1==this.text_elite&&(p=Config.recruit_holiday_elite_data.data_action[this.data.camp_id]),p)this.title_bg_2||(this.title_bg_2=Utils.createImage(this.view_content,null,0,0,cc.v2(.5,1),null,null,!0),this.title_bg_2.node.setContentSize(cc.size(610,44)),Utils.createLabel(24,new cc.Color(255,242,199,255),null,-295,-22,Utils.TI18N("\u5185\u5bb9\u8be6\u60c5"),this.title_bg_2.node,null,cc.v2(0,.5))),this.award_desc||(this.award_desc=Utils.createRichLabel(24,new cc.Color(100,50,35),cc.v2(.5,1),cc.v2(0,-184),34,580,this.view_content),this.award_desc.horizontalAlign=cc.macro.TextAlignment.LEFT),this.award_desc.string=p.desc||"",t+=f=this.award_desc.node.getContentSize().height+54+10}var g=-i-f-54,v=0;if(e)for(var b in this.title_bg_3||(this.title_bg_3=Utils.createImage(this.view_content,null,0,0,cc.v2(.5,1),null,null,!0),this.title_bg_3.node.setContentSize(cc.size(610,44)),Utils.createLabel(24,new cc.Color(255,242,199,255),null,-295,-22,Utils.TI18N("\u6982\u7387\u516c\u793a"),this.title_bg_3.node,null,cc.v2(0,.5))),v=54,t+=54,e){var w=e[b],y=this.createTimeSummonAwardItem();this.view_content.addChild(y),y.name_text.string=w.name,1==w.is_chip?y.type_text.string=Utils.TI18N("\u788e\u7247"):y.type_text.string=Utils.TI18N("\u82f1\u96c4"),y.num_text.string=w.probability+"%",1==w.is_up?(y.star_text.string=w.star+" UP!",y.star_text.node.color=n.Up_Text_Color,y.name_text.node.color=n.Up_Text_Color,y.type_text.node.color=n.Up_Text_Color,y.num_text.node.color=n.Up_Text_Color):(y.star_text.string=w.star,y.star_text.node.color=n.Not_Up_Text_Color,y.name_text.node.color=n.Not_Up_Text_Color,y.type_text.node.color=n.Not_Up_Text_Color,y.num_text.node.color=n.Not_Up_Text_Color),v=v+30+10,t=t+30+10;var C=g-40*(b-1);y.setPosition(cc.v2(0,C));var k=this.lookHeroInfo();this.title_bg_3.node.addChild(k),k.setPosition(228,-22),k.on("touchend",function(){this.ctrl.openTimeSummonpreviewWindow(!0,this.group_id,this.text_elite)},this)}this.view_content.height=t,this.title_bg_1&&(this.title_bg_1.node.y=0);for(var S=0;S<this.up_item_list.length;++S){var T=this.up_item_list[S];T.setPosition(T.getPositionX(),-117.5)}if(this.title_bg_2&&(this.title_bg_2.node.y=-i),this.award_desc&&(this.award_desc.node.y=-i-54),this.title_bg_3&&(this.title_bg_3.node.y=-i-f),this.loadRes(s.getUIIconPath("common","common_90025"),function(t){this.title_bg_1&&(this.title_bg_1.spriteFrame=t),this.title_bg_2&&(this.title_bg_2.spriteFrame=t),this.title_bg_3&&(this.title_bg_3.spriteFrame=t)}.bind(this)),this.data){var I=a.getYMD(this.data.start_time),E=a.getYMD(this.data.end_time);this.time_label.string=cc.js.formatStr(Utils.TI18N("\u6982\u7387\u6709\u6548\u671f\uff1a%s~%s"),I,E)}}},createTimeSummonAwardItem:function(){var t=new cc.Node,e=cc.size(584,30);t.setAnchorPoint(cc.v2(.5,1)),t.setContentSize(e);var i=new cc.Color(255,255,255);return t.star_text=Utils.createLabel(24,i,null,-e.width/2,-e.height/2,"",t,null,cc.v2(0,.5)),t.name_text=Utils.createLabel(24,i,null,-e.width/2+160,-e.height/2,"",t,null,cc.v2(0,.5)),t.type_text=Utils.createLabel(24,i,null,-e.width/2+320,-e.height/2,"",t,null,cc.v2(0,.5)),t.num_text=Utils.createLabel(24,i,null,e.width/2,-e.height/2,"",t,null,cc.v2(1,.5)),t},lookHeroInfo:function(){var t=new cc.Node;this.loadRes(s.getUIIconPath("common","common_1098"),function(e){var i=t.addComponent(cc.Sprite);i.type=cc.Sprite.Type.SLICED,i.sizeMode=cc.Sprite.SizeMode.CUSTOM,i.spriteFrame=e,t.setContentSize(cc.size(107,34))}.bind(this));var e=(new cc.Node).addComponent(cc.Label);e.fontSize=20,e.string="\u67e5\u770b\u8be6\u60c5",e.horizontalAlign=cc.macro.TextAlignment.CENTER,e.verticalAlign=cc.macro.TextAlignment.CENTER,e.lineHeight=22;var i=Config.color_data.data_color16[175];return e.node.color=(new cc.Color).fromHEX(i),t.addChild(e.node),t},closeCallBack:function(){if(this.up_item_list){for(var t=0;t<this.up_item_list.length;++t)this.up_item_list[t]&&(this.up_item_list[t].deleteMe(),this.up_item_list[t]=null);this.up_item_list=null}this.ctrl.openTimeSummonAwardView(!1)}});cc._RF.pop()},{pathtool:"pathtool",timesummon_const:"timesummon_const",timetool:"timetool"}],time_summon_preview_window:[function(t,e,i){"use strict";cc._RF.push(e,"8a1fduex61JA4dhgxDGB8wC","time_summon_preview_window");var s=t("pathtool"),n=t("common_scrollview");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("seerpalace","seerpalace_preview_window"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Mini,this.is_full_screen=!1,this.ctrl=arguments[0]},initConfig:function(){},openCallBack:function(){this.background=this.root_wnd.getChildByName("background");var t=this.root_wnd.getChildByName("container");this.container=t,t.getChildByName("win_title").getComponent(cc.Label).string=Utils.TI18N("\u5956\u52b1\u9884\u89c8");var e=t.getChildByName("list_panel");this.viewContent=this.seekChild("content"),e.active=!1,this.scroll_view_size=e.getContentSize();var i={item_class:"backpack_item",start_x:30,space_x:30,start_y:8,space_y:28,item_width:.9*BackPackItem.Width,item_height:.9*BackPackItem.Height,row:0,col:4,need_dynamic:!0,bottom:20,scale:.9,is_hide_effect:!0};this.item_scrollview=new n;var s=e.getContentSize(),a=e.getPosition();this.item_scrollview.createScroll(t,a,ScrollViewDir.vertical,ScrollViewStartPos.top,s,i,cc.v2(0,0))},registerEvent:function(){this.background.on("touchend",this._onClickBtnClose,this)},setData:function(e){var i=e.index,s={};if(s=e.bool?Config.recruit_holiday_elite_data.data_hero_show[i]:Config.recruit_holiday_data.data_hero_show[i]){for(var n=[],a=0;a<s.length;++a)n.push(s[a]);n.sort(function(t,e){return t.id-e.id}),this.item_scrollview.setData(n,function(e){t("tips_controller").getInstance().showGoodsTips(Utils.getItemConfig(e.data.id))},{scale:.9,isSummonNumber:!0})}},openRootWnd:function(t){this.setData(t)},_onClickBtnClose:function(){Utils.playButtonSound(2),this.ctrl.openTimeSummonpreviewWindow(!1)},closeCallBack:function(){this.item_scrollview&&(this.item_scrollview.deleteMe(),this.item_scrollview=null),this.ctrl.openTimeSummonpreviewWindow(!1)}});cc._RF.pop()},{common_scrollview:"common_scrollview",pathtool:"pathtool",tips_controller:"tips_controller"}],time_summon_progress_window:[function(t,e,i){"use strict";cc._RF.push(e,"40df15wFWhEyLZdjJ6H4ndP","time_summon_progress_window");var s=t("pathtool");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("action","action_time_summon_progress"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Mini,this.ctrl=arguments[0]},initConfig:function(){this.award_item_list={}},openCallBack:function(){var t=this.root_wnd.getChildByName("container");this.container=t,t.getChildByName("win_title").getComponent(cc.Label).string=Utils.TI18N("\u67e5\u770b\u5956\u52b1"),this.close_btn=t.getChildByName("close_btn"),this.summon_num_txt=t.getChildByName("title_txt_1").getComponent(cc.Label),this.progress=t.getChildByName("progress").getComponent(cc.ProgressBar),t.getChildByName("time_label").getComponent(cc.Label).string=Utils.TI18N("\u9650\u5b9a\u53ec\u5524\u671f\u95f4\u8fbe\u5230\u6307\u5b9a\u62db\u52df\u6b21\u6570\u53ef\u83b7\u5bf9\u5e94\u5956\u52b1")},registerEvent:function(){this.close_btn.on("click",function(){Utils.playButtonSound(2),this.ctrl.openTimeSummonProgressView(!1)},this)},openRootWnd:function(t){this.cur_times=t.times,this.camp_id=t.camp_id,this.setData()},setData:function(){if(null!=this.cur_times&&null!=this.camp_id){this.summon_num_txt.string=cc.js.formatStr(Utils.TI18N("\u5f53\u524d\u5df2\u62db\u52df\u6b21\u6570\uff1a%d"),this.cur_times);var e=Config.recruit_holiday_data.data_award[this.camp_id];t("elitesummon_controller").getInstance().getModel().isHolidayHasID(this.camp_id)&&(e=Config.recruit_holiday_elite_data.data_award[this.camp_id]);if(e){var i=483.5/(Utils.getArrLen(e)-1);for(var s in e){var n=e[s],a=this.award_item_list[s];null==a&&(a=this.creatorTimeSummonProgressItem(),this.container.addChild(a),this.award_item_list[s]=a),a.active=!0;var o=n.reward[0];a.award_item.setData({bid:o[0],num:o[1]}),a.times_txt.string=n.times,n.times<=this.cur_times?a.award_item.setReceivedIcon(!0):a.award_item.setReceivedIcon(!1);var l=100+(s-1)*i;a.setPosition(cc.v2(-this.container.width/2+l,-65))}var r=0,c=0;for(var _ in e){var h=e[_];if(1==_){if(this.cur_times<=h.times){c=this.cur_times/h.times*39.5;break}c=39.5}else{if(this.cur_times<=h.times){c+=(this.cur_times-r)/(h.times-r)*i;break}c+=i}r=h.times}this.progress.progress=c/523}}},creatorTimeSummonProgressItem:function(){var t=cc.size(84,122),e=new cc.Node;e.setContentSize(t),e.setAnchorPoint(cc.v2(.5,0));var i=ItemsPool.getInstance().getItem("backpack_item");i.initConfig(!1,.7,!0,!0),i.setPosition(0,-41.65+t.height),i.setParent(e),i.show(),e.award_item=i,e.times_txt=Utils.createLabel(22,new cc.Color(100,50,35),null,0,-5,"1",e,null,cc.v2(.5,1));var n=Utils.createImage(e,null,0,t.height-86,cc.v2(.5,1)),a=Utils.createImage(e,null,0,0,cc.v2(.5,0));return this.loadRes(s.getUIIconPath("timesummon","timesummon_1004"),function(t){n.spriteFrame=t}.bind(this)),this.loadRes(s.getUIIconPath("timesummon","timesummon_1005"),function(t){a.spriteFrame=t}.bind(this)),e},closeCallBack:function(){if(this.award_item_list)for(var t in this.award_item_list)this.award_item_list[t].award_item&&(this.award_item_list[t].award_item.deleteMe(),this.award_item_list[t].award_item=null);this.award_item_list=null,this.ctrl.openTimeSummonProgressView(!1)}});cc._RF.pop()},{elitesummon_controller:"elitesummon_controller",pathtool:"pathtool"}],timesummon_const:[function(t,e,i){"use strict";var s;function n(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}cc._RF.push(e,"c6812zRmjpDnp+jQhUMKJ+W","timesummon_const");var a={};a.Not_Up_Text_Color=new cc.Color(100,50,35),a.Up_Text_Color=new cc.Color(192,62,11),a.Action_Group=(n(s={},1,[PlayerAction.action_1,PlayerAction.action_1]),n(s,2,[PlayerAction.action_3,PlayerAction.action_4]),n(s,3,[PlayerAction.action_2,PlayerAction.action_5]),n(s,4,[PlayerAction.action_3,PlayerAction.action_3]),n(s,5,[PlayerAction.action_2,PlayerAction.action_2]),s),e.exports=a,cc._RF.pop()},{}],timesummon_controller:[function(t,e,i){"use strict";cc._RF.push(e,"e66e9PqqoRA05MdeWM280KE","timesummon_controller");var s=t("timesummon_event"),n=cc.Class({extends:BaseController,ctor:function(){},initConfig:function(){var e=t("timesummon_model");this.model=new e,this.model.initConfig()},getModel:function(){return this.model},registerEvents:function(){},requestTimeSummonData:function(){this.SendProtocal(23216,{})},requestTimeSummon:function(t,e){var i={};i.times=t,i.recruit_type=e,this.SendProtocal(23217,i)},requestSummonGetAward:function(){this.SendProtocal(23218,{})},send23219:function(t){var e={};e.bid=t,this.SendProtocal(23219,e)},registerProtocals:function(){this.RegisterProtocal(23216,this.handle23216),this.RegisterProtocal(23217,this.handle23217),this.RegisterProtocal(23218,this.handle23218),this.RegisterProtocal(23219,this.handle23219)},handle23216:function(t){t&&gcore.GlobalEvent.fire(s.Update_Summon_Data_Event,t)},handle23217:function(t){message(t.msg)},handle23218:function(t){message(t.msg)},handle23219:function(e){(message(e.msg),0==e.flag)&&t("battle_controller").getInstance().csFightExit()},openTimeSummonAwardView:function(e,i,s,n){if(1==e){if(null==this.summon_award_view){var a=t("time_summon_award_window");this.summon_award_view=new a(this)}0==this.summon_award_view.isOpen()&&this.summon_award_view.open({group_id:i,data:s,text_elite:n})}else this.summon_award_view&&(this.summon_award_view.close(),this.summon_award_view=null)},openTimeSummonProgressView:function(e,i,s){if(1==e){if(null==this.summon_progress_view){var n=t("time_summon_progress_window");this.summon_progress_view=new n(this)}0==this.summon_progress_view.isOpen()&&this.summon_progress_view.open({times:i,camp_id:s})}else this.summon_progress_view&&(this.summon_progress_view.close(),this.summon_progress_view=null)},openTimeSummonpreviewWindow:function(e,i,s){if(1==e){if(null==this.SummonpreviewWindow){var n=t("time_summon_preview_window");this.SummonpreviewWindow=new n(this)}0==this.SummonpreviewWindow.isOpen()&&this.SummonpreviewWindow.open({index:i,bool:s})}else this.SummonpreviewWindow&&(this.SummonpreviewWindow.close(),this.SummonpreviewWindow=null)}});e.exports=n,cc._RF.pop()},{battle_controller:"battle_controller",time_summon_award_window:"time_summon_award_window",time_summon_preview_window:"time_summon_preview_window",time_summon_progress_window:"time_summon_progress_window",timesummon_event:"timesummon_event",timesummon_model:"timesummon_model"}],timesummon_event:[function(t,e,i){"use strict";cc._RF.push(e,"61199WUL0pDOoD+ssmLrPht","timesummon_event"),e.exports={Update_Summon_Data_Event:"TimesummonEvent.Update_Summon_Data_Event"},cc._RF.pop()},{}],timesummon_model:[function(t,e,i){"use strict";cc._RF.push(e,"2aff9I+TwhH/oHN8tHXyZTo","timesummon_model");var s=t("timesummon_const");cc.Class({extends:BaseClass,ctor:function(){},properties:{},initConfig:function(){},getEffectAction:function(t){for(var e=1,i=0;i<t.length;++i){var n=t[i],a=Utils.getItemConfig(n.base_id);a&&(102==a.type?4==a.eqm_jie&&e<2?e=2:5==a.eqm_jie&&e<3&&(e=3):3==a.eqm_jie&&e<=1?e=1:4==a.eqm_jie&&e<4?e=4:5==a.eqm_jie&&e<5&&(e=5))}var o=s.Action_Group[e];return[o[0],o[1]]}});cc._RF.pop()},{timesummon_const:"timesummon_const"}],timetool:[function(t,e,i){"use strict";cc._RF.push(e,"3d6deCXZRlBIYTw21ghxclG","timetool");var s={getTimeFormat:function(t){t=Number(t)||0;var e=Math.floor(t/3600),i=Math.floor(t%3600/60),s=t%3600%60;return(e=e<10&&"0"+e||e)+":"+(i=i<10&&"0"+i||i)+":"+(s=s<10&&"0"+s||s)},getMinSecTime:function(t){t=Number(t)||0;var e=Math.floor(t/3600),i=Math.floor(t%3600/60),s=Math.floor(t%3600%60);return(i=(i=60*e+i)<10&&"0"+i||i)+":"+(s=s<10&&"0"+s||s)},getTimeFormatII:function(t){t=Number(t)||0;var e=Math.floor(t/3600),i=Math.floor(t%3600/60),s=Math.floor(t%3600%60);return s<=0?i<=0?e+"\u5c0f\u65f6":e+cc.js.formatStr("\u5c0f\u65f6%s\u5206",i):e+cc.js.formatStr("\u5c0f\u65f6%s\u5206%s\u79d2",i,s)},GetTimeFormatTwo:function(t,e){t=Number(t)||0;var i=Math.floor(t/3600),s=Math.floor(t%3600/60),n=Math.floor(t%3600%60),a=i<10&&"0"+i||i,o=s<10&&"0"+s||s,l=n<10&&"0"+n||n;return i<=0?null!=e?o+":"+l:o+"\u5206"+l+"\u79d2":null!=e?a+":"+o:a+"\u5c0f\u65f6"+o+"\u5206"},getTimeFormatIII:function(t){t=Number(t)||0;var e=Math.floor(t/3600),i=Math.floor(t%3600/60);return(e=e<10&&"0"+e||e)+":"+(i=i<10&&"0"+i||i)},getTimeMs:function(t,e){t=Number(t)||0;var i=Math.floor(t/3600),s=Math.floor(t%3600/60),n=Math.floor(t%3600%60);if(null!=e){n=n<10&&"0"+n||n;var a=60*i+s;return(a=a<10&&"0"+a||a)+":"+n}return cc.js.formatStr("%s\u5206%s\u79d2",60*i+s,n)},getYMDHMS:function(t){return this.dateFtt("yyyy-MM-dd hh:mm:ss",t)},getMDHMS:function(t){return this.dateFtt("MM-dd hh:mm:ss",t)},getMD:function(t){return this.dateFtt("MM.dd",t)},getMDHM:function(t){return this.dateFtt("MM-dd hh:mm",t)},getHMS:function(t){return this.dateFtt("hh:mm:ss",t)},getYDHM:function(t){return this.dateFtt("yyyy hh:mm:ss",t)},getHM:function(t){return this.dateFtt("hh:mm",t)},getMS:function(t){return this.dateFtt("mm:ss",t)},getYMD:function(t){return this.dateFtt("yyyy-MM-dd",t)},getYMD2:function(t){return this.dateFtt("yyyy"+Utils.TI18N("\u5e74")+"MM"+Utils.TI18N("\u6708")+"dd"+Utils.TI18N("\u65e5"),t)},getMD2:function(t){return this.dateFtt("MM",t)+"\u6708"+this.dateFtt("dd",t)+"\u65e5"},getOneDayLessTime:function(){},dateFtt:function(t,e){if(null==e)return 0;var i=new Date(1e3*e),s={"M+":i.getMonth()+1,"d+":i.getDate(),"h+":i.getHours(),"m+":i.getMinutes(),"s+":i.getSeconds(),"q+":Math.floor((i.getMonth()+3)/3),S:i.getMilliseconds()};for(var n in/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(i.getFullYear()+"").substr(4-RegExp.$1.length))),s)new RegExp("("+n+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?s[n]:("00"+s[n]).substr((""+s[n]).length)));return t},day2s:function(){return 86400},getDayDifference:function(t){},getTimeFormatDay:function(t){t=Number(t)||0;var e=Math.floor(t/s.day2s()),i=Math.floor(t%s.day2s()),n=Math.floor(i/3600),a=Math.floor(i%3600/60),o=Math.floor(i%3600%60),l="";return e>=1&&(l=e+"\u5929"),e>=1?n>0?l+n+"\u5c0f\u65f6":l:o<=0&&a<=0?n<=0?"":l+n+"\u5c0f\u65f6":l+n+cc.js.formatStr("\u5c0f\u65f6%s\u5206",a)},getTimeDayOrTime:function(t){t=Number(t)||0;var e=Math.floor(t/s.day2s());return e>=1?e+"\u5929":e<1?os.date("%X ",t):void 0},getTimeFormatDayII:function(t){t=Number(t)||0;var e=Math.floor(t/86400),i=Math.floor(t%86400),s=Math.floor(i/3600),n=Math.floor(i%3600/60),a=Math.floor(i%3600%60),o="",l="",r="";return a>=1&&(r=a+"\u79d2"),n>=1&&(l=n+"\u5206"),s>=1&&(o=s+"\u5c0f\u65f6"),e>=1?e+"\u5929"+o:s>=1?o+l:l+r},getTimeFormatDayIII:function(t){t=Number(t)||0;var e=Math.floor(t/86400),i=Math.floor(t%86400),s=Math.floor(i/3600),n=Math.floor(i%3600/60),a=Math.floor(i%3600%60);return e>=1?s>=1?e+"\u5929"+(s+"\u5c0f\u65f6"):void 0:s+"\u5c0f\u65f6"+(n+"\u5206")+(a+"\u79d2")},getTimeFormatDayIV:function(t){t=Number(t)||0;var e=Math.floor(t/86400);if(!(e>=1)){var i=Math.floor(t%86400),s=Math.floor(i/3600),n=Math.floor(i%3600/60),a=Math.floor(i%3600%60);return s<10&&(s="0"+s),n<10&&(n="0"+n),a<10&&(a="0"+a),s+":"+n+":"+a}},getTimeName:function(t){t=Number(t)||0;Math.floor(t/s.day2s());var e=Math.floor(t%s.day2s());Math.floor(e/3600),Math.floor(e%3600/60);return Math.floor(e%3600%60)},getTimeFormatDayIIIIII:function(t){t=Number(t)||0;var e=Math.floor(t/s.day2s()),i=Math.floor(t%s.day2s()),n=Math.floor(i/3600),a=Math.floor(i%3600/60),o=Math.floor(i%3600%60),l="";return e>=1&&(l=e+"\u5929"),e>=1?l+n+"\u5c0f\u65f6":o<=0&&a<=0?n<=0?"":l+n+"\u5c0f\u65f6":l+n+cc.js.formatStr("\u5c0f\u65f6%s\u5206",a)},getTimeFormatDayIIIIIIII:function(t){t=Number(t)||0;var e=Math.floor(t/86400),i=Math.floor(t%86400),s=Math.floor(i/3600),n=Math.floor(i%3600/60),a=Math.floor(i%3600%60);return s<10&&(s="0"+s),n<10&&(n="0"+n),a<10&&(a="0"+a),e>=1?e+"\u5929"+s+":"+n+":"+a:s+":"+n+":"+a},getTimeForFunction:function(t){t=Number(t)||0;var e=Math.floor(t/s.day2s()),i=Math.floor(t%s.day2s()),n=Math.floor(i/3600),a=Math.floor(i%3600/60),o=Math.floor(i%3600%60);if(e>=1)return e+"\u5929"+n+"\u5c0f\u65f6";var l=a<10&&"0"+a||a,r=o<10&&"0"+o||o;return n>=1?(n<10&&"0"+n||n)+":"+l+":"+r:l+":"+r},getDayOrHour:function(t){t=Number(t)||0;var e=Math.floor(t/s.day2s()),i=Math.floor(t%s.day2s()),n=Math.floor(i/3600),a=Math.floor(i%3600/60),o=Math.floor(i%3600%60);return e>=1?e+"\u5929":n>=1?n+"\u5c0f\u65f6":a>=1?a+"\u5206\u949f":o>=1?o+"\u79d2":void 0},getTimeFormatFriendShowTime:function(t){t=Number(t)||0;var e=Math.floor(t/s.day2s());if(e>=3)return Utils.TI18N("3\u5929\u4ee5\u4e0a");if(e>0)return e+Utils.TI18N("\u5929\u524d");var i=Math.floor(t%s.day2s()),n=Math.ceil(i/3600);return n<=0&&(n=1),n+Utils.TI18N("\u5c0f\u65f6\u524d")}};e.exports=s,cc._RF.pop()},{}],tips_const:[function(t,e,i){"use strict";cc._RF.push(e,"d1630AlF1lBI65/ILUT/VyJ","tips_const");e.exports={type:{GOODS:1,EQUIP:2,HEAD_CIRCLE:3,COMMON:4,SKILL:5,ADVENTURE_BUFF:6},eqmTips:{normal:0,backpack:1,partner:2,other:3},eqmBtnTypes:{LEFT:1,RIGHT:2}},cc._RF.pop()},{}],tips_controller:[function(t,e,i){"use strict";cc._RF.push(e,"b6e1cg9UO9KNJp1fOS36aj/","tips_controller");var s=t("tips_const"),n=cc.Class({extends:BaseController,ctor:function(){},initConfig:function(){var e=t("tips_model");this.model=new e,this.model.initConfig(),this.tips_list={}},getModel:function(){return this.model},registerEvents:function(){null==this.re_link_game&&(this.login_event_success=gcore.GlobalEvent.bind(EventId.EVT_RE_LINK_GAME,function(){this.closeAllTips()}.bind(this)))},registerProtocals:function(){},closeTIpsByType:function(t){var e=this.tips_list[t];e&&e.close(),this.tips_list[t]=null},closeAllTips:function(){for(var t in this.tips_list){var e=this.tips_list[t];e&&e.close&&(e.close(),e=null)}this.tips_list={}},showGoodsTips:function(e,i,n){if(null!=e&&null==this.tips_list[s.type.GOODS]){var a=new(t("backpack_tips"));a.open({data:e,show:i,is_special_source:n}),this.tips_list[s.type.GOODS]=a}},showEquipTips:function(e,i,n){if(null!=e&&null==this.tips_list[s.type.EQUIP]){var a=new(t("equip_tips"));a.open({data:e,type:i,partner:n}),this.tips_list[s.type.EQUIP]=a}},showHeadCircleTips:function(e){if(null!=e){this.closeTIpsByType(s.type.HEAD_CIRCLE);var i=new(t("head_circle_tips"));i.open(e),this.tips_list[s.type.HEAD_CIRCLE]=i}},showCommonTips:function(e,i,n,a,o){null!=this.common_tips&&(this.common_tips.close(),this.common_tips=null),o=o||400;var l=t("common_tips");return this.common_tips=new l(a),this.common_tips.open(),this.common_tips.showTips(e,o,n||24),this.common_tips.addCallBack(function(){this.adjustTipsPosition(this.common_tips,i)}.bind(this)),this.tips_list[s.type.COMMON]=this.common_tips,this.common_tips},showAdventureBuffTips:function(e,i,n){this.adventure_buff_tips&&(this.adventure_buff_tips.close(),this.adventure_buff_tips=null);var a=t("adventure_buff_tips");return this.adventure_buff_tips=new a(e,n),this.adventure_buff_tips.open(),this.adventure_buff_tips.showTips(),this.adventure_buff_tips.addCallBack(function(){this.adjustTipsPosition(this.adventure_buff_tips,i)}.bind(this)),this.tips_list[s.type.ADVENTURE_BUFF]=this.adventure_buff_tips,this.adventure_buff_tips},showBackPackCompTips:function(t,e){1==t?(this.comp_tips||(this.comp_tips=Utils.createClass("backpack_comp_tips_window",this)),this.comp_tips.open(e)):this.comp_tips&&(this.comp_tips.close(),this.comp_tips=null)},showCompChooseTips:function(t,e){1==t?(this.choose_tips||(this.choose_tips=Utils.createClass("comp_choose_tips_window",this)),this.choose_tips.open(e)):this.choose_tips&&(this.choose_tips.close(),this.choose_tips=null)},adjustTipsPosition:function(t,e,i){var s=cc.size(SCREEN_WIDTH,SCREEN_HEIGHT),n=i||t.getBgContentSize(),a=cc.size(n.width,n.height),o=ViewManager.getInstance().getSceneNode(SCENE_TAG.msg).convertToNodeSpaceAR(e),l=o.x,r=o.y-a.height/2;l+a.width/2>s.width/2?l-=a.width/2:l-a.width/2<-s.width/2&&(l+=a.width/2),r>s.height/2?r=s.height/2:r-a.height<-s.height/2&&(r+=a.height),t.setPosition(l,r)},showSkillTips:function(e,i,n,a){"number"==typeof e&&(e=Config.skill_data.data_get_skill[e]);var o=new(t("skill_tips_window")),l={skill_vo:e,is_lock:i,not_show_next:n,hide_flag:a};o.open(l),this.tips_list[s.type.SKILL]=o},getCompTipsRoot:function(){if(this.comp_tips)return this.comp_tips.root_wnd},showFirstCharge:function(e){var i=t("newfirstcharge_controller");i.getInstance().getNewFirstChargeView()?e():.1*t("role_controller").getInstance().getRoleVo().vip_exp>=6?e():t("commonalert").show(Utils.TI18N("\u60a8\u67094\u500d\u5145\u503c\u8fd4\u5229\u672a\u4f7f\u7528\uff0c\u662f\u5426\u524d\u5f80?"),Utils.TI18N("\u7acb\u5373\u524d\u5f80"),function(){i.getInstance().openNewFirstChargeView(!0)},Utils.TI18N("\u7ee7\u7eed\u5145\u503c"),e)},showWeekCardTips:function(e,i){if(1==e){if(!this.weekcard_tips){var s=t("week_card_tips_window");this.weekcard_tips=new s(this)}this.weekcard_tips.open(i)}else this.weekcard_tips&&(this.weekcard_tips.close(),this.weekcard_tips=null)}});e.exports=n,cc._RF.pop()},{adventure_buff_tips:"adventure_buff_tips",backpack_tips:"backpack_tips",common_tips:"common_tips",commonalert:"commonalert",equip_tips:"equip_tips",head_circle_tips:"head_circle_tips",newfirstcharge_controller:"newfirstcharge_controller",role_controller:"role_controller",skill_tips_window:"skill_tips_window",tips_const:"tips_const",tips_model:"tips_model",week_card_tips_window:"week_card_tips_window"}],tips_model:[function(t,e,i){"use strict";cc._RF.push(e,"542f2FMaX9BUJjDeLPVpvqF","tips_model");cc.Class({extends:BaseClass,ctor:function(){},properties:{},initConfig:function(){}});cc._RF.pop()},{}],tips_source_window:[function(t,e,i){"use strict";cc._RF.push(e,"6ba00hIUqpLAbQIwVTzHpit","tips_source_window");var s=t("pathtool"),n=t("backpack_const");cc.Class({extends:BaseView,ctor:function(){this.ctrl=arguments[0],this.model=this.ctrl.getModel(),this.prefabPath=s.getPrefabPath("backpack","item_source_view"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Tips,this.source_items=[]},initConfig:function(){},openCallBack:function(){},registerEvent:function(){},openRootWnd:function(t){this.item_config=t.data,this.need_list=t.item_list,this.item_config&&this.initWidgets()},closeCallBack:function(){if(this.back_item&&this.back_item.deleteMe(),this.back_item=null,this.source_items)for(var t in this.source_items)this.source_items[t].deleteMe();this.source_items=[],this.ctrl.openTipsSource(!1)},initWidgets:function(){this.background=this.root_wnd.getChildByName("bg").getChildByName("background").getChildByName("background"),this.title_label_lb=this.seekChild("title_label",cc.Label),this.close_btn_nd=this.seekChild("close_btn"),this.items_content_nd=this.seekChild("items_content"),this.item_conten_nd=this.seekChild("item_conten"),this.item_name_nd=this.seekChild("item_name"),this.item_name_lb=this.item_name_nd.getComponent(cc.Label),this.item_own_nd=this.seekChild("own_num"),this.item_own_lb=this.seekChild("own_num",cc.Label),this.item_dec_rt=this.seekChild("item_dec",cc.RichText),this.item_own_nd.active=!1,this.close_btn_nd.on(cc.Node.EventType.TOUCH_END,this.didCloseBtn,this),this.background.on(cc.Node.EventType.TOUCH_END,this.didCloseBtn,this),this.updateWidgets(),this.createBackPackItem(),this.createSourceList()},updateWidgets:function(){var t;if(null!=(t=this.item_config.config?this.item_config.config:this.item_config)){this.item_bid=t.id,this.title_label_lb.string=Utils.TI18N(Lang.GET_WAYS),this.item_name_lb.string=t.name;var e=n.quality_color(t.quality),i=this.item_name_nd.color;i.fromHEX(e),this.item_name_nd.color=i,this.item_dec_rt.string=StringUtil.parse(t.desc);var s=this.model.getItemNumByBid(this.item_bid),a=cc.js.formatStr(Lang.ITEM_HAVE,s);this.item_own_nd.active=!0,this.item_own_lb.string=a}},createBackPackItem:function(){this.back_item=ItemsPool.getInstance().getItem("backpack_item"),this.back_item.setParent(this.item_conten_nd),this.back_item.show(),this.back_item.setData(this.item_config)},createSourceList:function(){var e;if(this.item_config&&(e=this.item_config.config?this.item_config.config:this.item_config)){var i=e.source;if(i&&null!=Utils.next(i)){var s=[];for(var n in i){(l=Config.source_data.data_source_data[i[n][0]])&&"evt_league_help"!=l.evt_type?s.push(i[n]):this.extend_data&&null!=Utils.next(this.extend_data)&&"evt_league_help"==this.extend_data[0]&&this.extend_data[1]&&s.push(i[n])}var a=Math.max(this.items_content_nd.height,115*s.length);this.items_content_nd.height=a;var o=[];for(var n in s){var l=Config.source_data.data_source_data[s[n][0]],r=this.getSourceInfo(l.lev_limit);s[n].id=l.id,s[n].infon_data=l,s[n].is_lock=r.is_lock,s[n].des=r.des,s[n].index=n,o.push(s[n])}if(o.sort(Utils.tableLowerSorter(["is_lock"])),o&&null!=Utils.next(o||{})){var c=t("source_item");for(var n in o){var _=new c(this.items_content_nd,e.id,this.need_list);this.source_items.push(_),_.setData(o[n])}}}}},getSourceInfo:function(e){if(e&&e[0]){var i={is_lock:!0,des:""};switch(e[0]){case"dungeon":var s=t("battle_drama_controller").getInstance().getModel().getDramaData();if(s&&e[1]){s.max_dun_id>=e[1]&&(i.is_lock=!1);var n=Config.dungeon_data.data_drama_dungeon_info[e[1].toString()];n&&(i.des=Utils.TI18N(Lang.COMPASS+n.name+Lang.LOCK))}break;case"lev":(a=t("role_controller").getInstance().getRoleVo())&&e[1]&&a.lev>=e[1]&&(i.is_lock=!1),i.des=e[1]+Utils.TI18N(Lang.LEV_LOCK);break;case"guild":var a,o=t("guild_controller");if((a=t("role_controller").getInstance().getRoleVo())&&a.gid&&a.gsrv_id){var l=o.getInstance().getModel().getMyGuildInfo();l&&e[1]&&(l.lev>=e[1]?i.is_lock=!1:i.des=Utils.TI18N(Lang.GUILD+e[1]+Lang.LEV_LOCK))}else i.des=Utils.TI18N(Lang.NOT_GUILD)}return i}},didCloseBtn:function(){this.ctrl.openTipsSource(!1)}});cc._RF.pop()},{backpack_const:"backpack_const",battle_drama_controller:"battle_drama_controller",guild_controller:"guild_controller",pathtool:"pathtool",role_controller:"role_controller",source_item:"source_item"}],toggle_item:[function(t,e,i){"use strict";cc._RF.push(e,"2a1cbxhHbRGIq6nkm5AKBVE","toggle_item");cc.Class({extends:ViewClass,ctor:function(){this.prefabPath=PathTool.getPrefabPath("backpack","toggle_item"),this.initRootWnd(),this.data=null},initRootWnd:function(){this.prefabPath&&LoaderManager.getInstance().loadRes(this.prefabPath,function(t){this.root_wnd=t,this.parent&&this.parent.addChild(this.root_wnd),this.position&&this.setPosition(this.position),this.scale&&(this.root_wnd.scale=this.scale),this.initWidget(),this.root_wnd.active=this.visible,null!=this.is_select&&this.setSelected(this.is_select)}.bind(this))},initWidget:function(){this.toggle_tg=this.seekChild("toggle",cc.Toggle),this.toggle_tg.node.on(cc.Node.EventType.TOUCH_END,function(){this.call_back&&(this.data?(this.call_back(!this.data.select),this.data.select=!this.data.select):this.call_back(this.toggle_tg.isChecked))},this)},setData:function(t){this.data=t,this.root_wnd&&this.updateWidget()},updateWidget:function(){this.data},setPosition:function(t){this.position=t,this.root_wnd&&this.root_wnd.setPosition(t.x-60,t.y-60)},setScale:function(t){this.scale=t,this.root_wnd&&(this.root_wnd.scale=t)},setSelected:function(t){this.is_select=t,this.toggle_tg&&Utils.delayRun(this.toggle_tg.node,1/60,function(){t?this.toggle_tg.check():this.toggle_tg.uncheck()}.bind(this))},isSelected:function(){return!this.toggle_tg.isChecked},addClickCallBack:function(t){this.call_back=t},setVisible:function(t){this.visible=t,this.root_wnd&&(this.root_wnd.active=t)}});cc._RF.pop()},{}],untie_reward_1_window:[function(t,e,i){"use strict";cc._RF.push(e,"a0374EYcWhKwaGWZMusMzun","untie_reward_1_window");var s=t("pathtool"),n=t("common_scrollview");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("orderaction","untie_reward_window"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Mini,this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){},openCallBack:function(){this.root_wnd.getChildByName("background").scale=FIT_SCALE,this.main_container=this.root_wnd.getChildByName("main_container"),this.main_container.getChildByName("title_con").getChildByName("title_label").getComponent(cc.Label).string=Utils.TI18N("\u5956\u52b1\u603b\u89c8"),this.btn_buy=this.main_container.getChildByName("btn_buy");var t=this.btn_buy.getChildByName("Text_1").getComponent(cc.Label);t.string=Utils.TI18N("\u89e3\u9501\u9886\u53d6"),1==this.model.getGiftStatus()&&(t.string=Utils.TI18N("\u67e5\u770b\u8fdb\u9636\u5361")),this.commonShowReward(),this.btn_close=this.main_container.getChildByName("btn_close")},registerEvent:function(){Utils.onTouchEnd(this.btn_close,function(){this.ctrl.openUntieRewardView(!1)}.bind(this),2),Utils.onTouchEnd(this.btn_buy,function(){this.ctrl.openBuyCardView(!0)}.bind(this),1)},commonShowReward:function(){var t=this.main_container.getChildByName("goods_1"),e=t.getContentSize();this.item_good_1=new n,this.item_good_1.createScroll(t,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,e,{item_class:"backpack_item",start_x:32,space_x:20,start_y:0,space_y:0,item_width:120,item_height:120,row:1,col:4});var i=this.model.getCurPeriod();if(Config.holiday_war_order_data.data_lev_reward_list[i]){for(var s=Object.keys(Config.holiday_war_order_data.data_lev_reward_list[i]).length,a=[],o={},l=1;l<=s;l++)if(Config.holiday_war_order_data.data_lev_reward_list[i][l]&&Config.holiday_war_order_data.data_lev_reward_list[i][l].reward){for(var r in Config.holiday_war_order_data.data_lev_reward_list[i][l].reward){o[(c=Config.holiday_war_order_data.data_lev_reward_list[i][l].reward[r])[0]]?o[c[0]]=o[c[0]]+c[1]:o[c[0]]=c[1]}for(var r in Config.holiday_war_order_data.data_lev_reward_list[i][l].rmb_reward){var c;o[(c=Config.holiday_war_order_data.data_lev_reward_list[i][l].rmb_reward[r])[0]]?o[c[0]]=o[c[0]]+c[1]:o[c[0]]=c[1]}}var _=Config.holiday_war_order_data.data_price_list;for(var h in o){var d=0;_[h]&&(d=_[h].sort||0),a.push({bid:h,num:o[h],sort:d})}a.sort(function(t,e){return t.sort-e.sort}),this.item_good_1.setData(a),this.item_good_1.addEndCallBack(function(){var t=this.item_good_1.getItemList();for(var e in t)t[e].setDefaultTip()}.bind(this))}},openRootWnd:function(t){},closeCallBack:function(){this.item_good_1&&(this.item_good_1.deleteMe(),this.item_good_1=null),this.ctrl.openUntieRewardView(!1)}});cc._RF.pop()},{common_scrollview:"common_scrollview",pathtool:"pathtool"}],untie_reward_window:[function(t,e,i){"use strict";cc._RF.push(e,"1cc3aNXyqZBqaMstYL5Sd6L","untie_reward_window");var s=t("pathtool"),n=t("orderaction_event");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("orderaction","untie_reward_window1"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Mini,this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){},openCallBack:function(){this.background=this.root_wnd.getChildByName("background"),this.background.scale=FIT_SCALE;var t=this.root_wnd.getChildByName("main_container");this.image_bg=t.getChildByName("Sprite_1").getComponent(cc.Sprite),t.getChildByName("Text_3").getComponent(cc.Label).string=Utils.TI18N("\u8fdb\u9636\u8d60\u793c");var e=t.getChildByName("Text_3_0").getComponent(cc.Label);e.string=Utils.TI18N("\u6fc0\u6d3b\u53ef\u76f4\u63a5\u9886\u53d6\u5956\u52b1");var i=t.getChildByName("Text_3_1").getComponent(cc.Label);i.string=Utils.TI18N("\u6d3b\u52a8\u671f\u95f4\u53ef\u9886\u53d6\u5956\u52b1");var n=s.getBigBg("orderaction/orderaction_banner4");2==this.model.getCurPeriod()&&(n=s.getBigBg("orderaction/orderaction_banner5"),this.image_bg.node.setContentSize(cc.size(651,666)),this.image_bg.node.setPosition(cc.v2(0,4)),e.node.color=i.node.color=new cc.Color(158,1,18,255)),this.loadRes(n,function(t){this.image_bg.spriteFrame=t}.bind(this)),this.btn_change=t.getChildByName("btn_change"),this.btn_change_btn=this.btn_change.getComponent(cc.Button),this.btn_change_label=this.btn_change.getChildByName("Text_6").getComponent(cc.Label),this.btn_change_label.string=Utils.TI18N("\uffe5198\u8d2d\u4e70"),1==this.model.getGiftStatus()&&(this.btn_change_btn.interactable=!1,this.btn_change_btn.enableAutoGrayEffect=!0,this.btn_change_label.node.getComponent(cc.LabelOutline).enabled=!1),this.goods_1=t.getChildByName("goods_1"),this.goods_content_1=this.goods_1.getChildByName("content"),this.goods_2=t.getChildByName("goods_2"),this.goods_content_2=this.goods_2.getChildByName("content"),this.setData(),this.btn_close=t.getChildByName("btn_close")},registerEvent:function(){this.addGlobalEvent(n.OrderAction_BuyGiftCard_Event,function(){1==this.model.getGiftStatus()&&(this.btn_change_btn.interactable=!1,this.btn_change_btn.enableAutoGrayEffect=!0,this.btn_change_label.node.getComponent(cc.LabelOutline).enabled=!1)}.bind(this)),Utils.onTouchEnd(this.btn_close,function(){this.ctrl.openBuyCardView(!1)}.bind(this),2),Utils.onTouchEnd(this.background,function(){this.ctrl.openBuyCardView(!1)}.bind(this),2),Utils.onTouchEnd(this.btn_change,function(){this.changeWarn()}.bind(this),1)},setData:function(){var t=Config.holiday_war_order_data.data_advance_card_list,e=this.model.getCurPeriod();if(t&&t[e]&&t[e][1]){var i=t[e][1].reward_1||{},s={scale:.7,space_x:3,max_count:4,is_center:!0};this.item_list1=Utils.commonShowSingleRowItemList(this.goods_1,this.item_list1,i,s,this.goods_content_1);i=t[e][1].reward_2||{},s={scale:.7,max_count:4,is_center:!0};this.item_list2=Utils.commonShowSingleRowItemList(this.goods_2,this.item_list2,i,s,this.goods_content_2)}},changeWarn:function(){if(1!=this.model.getGiftStatus()){var e=this.model.getCurDay(),i=Config.charge_data.data_charge_data,s=Config.holiday_war_order_data.data_advance_card_list,n=this.model.getCurPeriod();if(s&&s[n]&&s[n][1]){var a=null;if(e>=25&&(a=30==e?Utils.TI18N("\u6d3b\u52a8\u5c06\u5728\u4eca\u5929\u7ed3\u675f\uff0c\u662f\u5426\u786e\u8ba4\u5145\u503c"):cc.js.formatStr(Utils.TI18N("\u6d3b\u52a8\u5c06\u5728 %d \u5929\u540e\u7ed3\u675f\uff0c\u662f\u5426\u786e\u8ba4\u5145\u503c"),30-e)),a){t("commonalert").show(a,Utils.TI18N("\u786e\u5b9a"),function(){var t=s[n][1].charge_id||null;t&&i[t]&&SDK.pay(i[t].val,1,i[t].id,i[t].name)}.bind(this),Utils.TI18N("\u53d6\u6d88"),null,Utils.TI18N("\u5956\u52b1"))}else{var o=s[n][1].charge_id||null;o&&i[o]&&SDK.pay(i[o].val,1,i[o].id,i[o].name)}}}},openRootWnd:function(t){},closeCallBack:function(){if(this.item_list1){for(var t in this.item_list1)this.item_list1[t].deleteMe();this.item_list1=null}if(this.item_list2){for(var t in this.item_list2)this.item_list2[t].deleteMe();this.item_list2=null}this.ctrl.openBuyCardView(!1)}});cc._RF.pop()},{commonalert:"commonalert",orderaction_event:"orderaction_event",pathtool:"pathtool"}],"use_v2.0.x_cc.Toggle_event":[function(t,e,i){"use strict";cc._RF.push(e,"baaf0ig+4RHz7nAFJKx1tMi","use_v2.0.x_cc.Toggle_event"),cc.Toggle&&(cc.Toggle._triggerEventInScript_check=!0),cc._RF.pop()},{}],user_panel:[function(t,e,i){"use strict";cc._RF.push(e,"801340Zc3JLaKbU6MnFO8Jo","user_panel");var s=t("pathtool"),n=t("login_controller"),a=t("login_event");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("login","user_panel")},initPanel:function(){this.btn_login=this.root_wnd.getChildByName("btn_login"),this.btn_regist=this.root_wnd.getChildByName("btn_regist"),this.user_name_input=this.root_wnd.getChildByName("user_name_input").getComponent(cc.EditBox),this.password_input=this.root_wnd.getChildByName("password_input").getComponent(cc.EditBox),this.user_name_input.string=gcore.SysEnv.get("user_name")||Utils.randomStr(3,12),this.password_input.string=gcore.SysEnv.get("password")||Utils.randomStr(6)},registerEvent:function(){this.btn_login.on(cc.Node.EventType.TOUCH_END,function(t){if(""!=this.user_name_input.string)if(""!=this.password_input.string){var e=n.getInstance().getModel().getLoginInfo();e.account=this.user_name_input.string,e.password=this.password_input.string,gcore.SysEnv.set("user_name",e.account),gcore.SysEnv.set("password",e.password),n.getInstance().changeLoginWindowIndex(2),gcore.GlobalEvent.fire(a.LOGIN_EVENT_ACCOUNT_LOGIN_SUCCESS)}else message("\u8bf7\u8f93\u5165\u5bc6\u7801");else message("\u8bf7\u8f93\u5165\u7528\u6237\u540d")}.bind(this)),this.btn_regist.on(cc.Node.EventType.TOUCH_END,function(t){var e=n.getInstance().getModel().getLoginInfo();e.account=Utils.randomStr(3,12),e.password=Utils.randomStr(6),gcore.SysEnv.set("user_name",e.account),gcore.SysEnv.set("password",e.password),n.getInstance().changeLoginWindowIndex(2),gcore.GlobalEvent.fire(a.LOGIN_EVENT_ACCOUNT_LOGIN_SUCCESS)}.bind(this))},onShow:function(){cc.log("\u6253\u5f00 UserPanel")},onHide:function(){cc.log("\u5173\u95ed UserPanel")},onDelete:function(){}});cc._RF.pop()},{login_controller:"login_controller",login_event:"login_event",pathtool:"pathtool"}],utils:[function(t,e,i){"use strict";function s(t){"@babel/helpers - typeof";return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}cc._RF.push(e,"f0aceSvUh9H3pEhpfGg4ahd","utils");var n=t("soundmanager");window.Utils={_effect_once_playing:!1,_effect_once_last:null,_effect_once_list:null,keyfind:function(t,e,i){for(var s=0,n=i.length;s<n;s++)if(i[s][t]==e)return i[s];return null},deepCopy:function(t){var e=t instanceof Array?[]:{};for(var i in t)e[i]="object"===s(t[i])?this.deepCopy(t[i]):t[i];return e},randomNum:function(t,e){return e>t?Math.round(Math.random()*(e-t))+t:t},randomStr:function(t,e,i){for(var s=this.randomNum(t,e),n="",a=(i=i||"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ").length,o=0;o<s;o++){var l=this.randomNum(1,a)-1;n+=i.charAt(l)}return n},TI18N:function(t){return t},getUnitConfig:function(t){return gdata("unit_data","data_unit1",t,!1)||gdata("unit_data","data_unit2",t,!1)||gdata("unit_data","data_unit3",t)},getItemConfig:function(t){return gdata("item_data","data_unit1",t,!1)||gdata("item_data","data_unit2",t,!1)||gdata("item_data","data_unit3",t,!1)||gdata("item_data","data_unit4",t,!1)||gdata("item_data","data_unit5",t,!1)},getNorKey:function(){for(var t="",e=0;e<arguments.length;e++){var i=e<0||arguments.length<=e?void 0:arguments[e];""!=t&&(t+="_"),t+=i}return t},closeAllWindow:function(){for(var t=[],e=0;e<BaseView.winMap.length;e++){var i=BaseView.winMap[e];t.push(i)}for(var s=0;s<t.length;s++){var n=t[s];n.close&&n.close({close_win:!0})}BaseView.winMap=[]},hideAllWindowForBattle:function(){for(var t=0;t<BaseView.winMap.length;t++){var e=BaseView.winMap[t];e&&!e.is_before_battle&&(e.enter_battle_status=e.getVisible(),e.is_before_battle=!0,1==e.enter_battle_status&&e.setVisible(!1))}},showAllWindowForBattle:function(){for(var t=!0,e=0;e<BaseView.winMap.length;e++){var i=BaseView.winMap[e];i&&(null==i.enter_battle_status&&(i.enter_battle_status=!0),i.setVisible(i.enter_battle_status),1==t&&i.win_type==WinType.Full&&1==i.enter_battle_status&&(t=!1),i.is_before_battle=!1)}return t},isEmpty:function(t){for(var e in t)return!1;return!0},next:function(t){for(var e in t)if(null!=t[e])return!0;return null},tableLowerSorter:function(t){return function(e,i){if(null==e||null==i)return 1;for(var s=0;s<t.length;s++){var n=t[s];if(null==e[n]||null==i[n])return 1;if(e[n]!=i[n])return e[n]-i[n]}return 1}},tableUpperSorter:function(t){return function(e,i){if(null==e||null==i)return-1;for(var s=0;s<t.length;s++){var n=t[s];if(null==e[n]||null==i[n])return-1;if(e[n]!=i[n])return i[n]-e[n]}return-1}},tableCommonSorter:function(t){return function(e,i){if(null==e||null==i)return-1;for(var s=0;s<t.length;s++){var n=t[s];if(null==e[n[0]]||null==i[n[0]])return-1;if(n[1]||!1){if(e[n[0]]!=i[n[0]])return i[n[0]]-e[n[0]]}else if(e[n[0]]!=i[n[0]])return e[n[0]]-i[n[0]]}return-1}},createClass:function(e,i){return null!=e&&""!=e||cc.error("\u521b\u5efa\u7a97\u4f53\u5931\u8d25,\u6ca1\u6709\u7ed9\u5177\u4f53\u540d\u5b57 ========>>"),new(t(e))(i)},playEffectOnce:function(t,e,i,s,n,a,o){if(null!=s)if(a=a||PlayerAction.action,o=o||1,1==this._effect_once_playing){if(this.effect_object&&this.effect_object.node&&this.effect_object.node.parent)this._effect_once_last!=t&&(null==this._effect_once_list&&(this._effect_once_list=[]),this._effect_once_list.push({effect_name:t,x:e,y:i,parent:s,finish_call:n,action_name:a,scale:o}));else if(this.effect_object&&this.effect_object.node&&(this.effect_object.node.destroy(),LoaderManager.getInstance().releaseRes(this.effect_object.res_path)),this.effect_object=null,this._effect_once_last=null,this._effect_once_playing=!1,null==this._effect_once_list&&(this._effect_once_list=[]),this._effect_once_list.push({effect_name:t,x:e,y:i,parent:s,finish_call:n,action_name:a,scale:o}),this._effect_once_list&&this._effect_once_list.length>0){var l=this._effect_once_list.shift();l&&this.playEffectOnce(l.effect_name,l.x,l.y,l.parent,l.finish_call,l.action_name,l.scale)}}else{this._effect_once_playing=!0,this._effect_once_last=t;var r=function(){if(n&&n(),this._effect_once_playing=!1,this._effect_once_last=null,this.effect_object&&(this.effect_object.node&&this.effect_object.node.destroy(),LoaderManager.getInstance().releaseRes(this.effect_object.res_path),this.effect_object=null),this._effect_once_list&&this._effect_once_list.length>0){var t=this._effect_once_list.shift();t&&this.playEffectOnce(t.effect_name,t.x,t.y,t.parent,t.finish_call,t.action_name,t.scale)}}.bind(this);this.effect_object={node:null,effect:null,res_path:null};var c=new cc.Node("once_effect");c.setAnchorPoint(.5,.5),1!=o&&(c.scale=o),c.setPosition(e,i),s.addChild(c);var _=c.addComponent(sp.Skeleton),h=PathTool.getSpinePath(t,"action");this.effect_object.node=c,this.effect_object.effect=_,this.effect_object.res_path=h,_.setCompleteListener(function(t,e){(t.animation?t.animation.name:"")==a&&r()}.bind(this)),LoaderManager.getInstance().loadRes(h,function(t){_.skeletonData=t,_.setAnimation(0,a,!1)}.bind(this))}},getByteLen:function(t){for(var e=0,i=0;i<t.length;i++){null!=t.charAt(i).match(/[^\x00-\xff]/gi)?e+=2:e+=1}return e},setGreyButton:function(t,e){null==e&&(e=!0),t&&(t.interactable=!e,t.enableAutoGrayEffect=e)},getTimeInterval:function(t){if(t>=0)return t-gcore.SmartSocket.getTime()},changeIntevalToDate:function(t,e){if(t>=0){var i=Math.floor(t/86400),s=t%86400,n=Math.floor(s/3600),a=s%3600,o=Math.floor(a/60),l=Math.ceil(a%60);if(e)return{D:i,H:n,M:o,S:l};var r=function(t){return t<10?"0"+t:t};return{D:i,H:r(n),M:r(o),S:r(l)}}},getMoneyString:function(t,e){return null==e&&(e=!0),null==t?0:t<1e5?e?this.moneyFormat(t):t:t<1e8?(t=Math.floor(1e-4*t),e?cc.js.formatStr(Utils.TI18N("%s\u4e07"),this.moneyFormat(t)):cc.js.formatStr(Utils.TI18N("%s\u4e07"),t)):(t=Math.floor(1e-8*t),e?cc.js.formatStr(Utils.TI18N("%s\u4ebf"),this.moneyFormat(t)):cc.js.formatStr(Utils.TI18N("%s\u4ebf"),t))},moneyFormat:function(t){var e="";if(t<0&&(e="-",t*=-1),t<1e3)return String(t);var i=this.moneySplit(String(t),""),s=i.length,n=s%3;for(0==n&&(n=4);n<s;)i.splice(n,0,","),n+=4,s+=1;return e+this.Join(i,"")},moneySplit:function(t,e){if(0==e.length){for(var i=[],s=0;s<t.length;s++)i.push(t.substring(s,s+1));return i}return this.Split(t,e)},Split:function(t,e){for(var i={},s=0;;){var n=t.indexOf(e,s),a=e.length+n;if(-1==n)break;i[Object.keys(i).length+1]=t.substring(s,n-1),s=a+1}return s<=t.length&&(i[Object.keys(i).length+1]=t.substr(s)),i},Join:function(t,e){return null==e?t.join(""):t.join(e)},transformNameByServ:function(e,i){var s=e;if(null==i||null==e)return s;if(e&&-1!=s.indexOf("\u3010"))return s;if(!t("role_controller").getInstance().isTheSameSvr(i)){var n=t("role_controller").getInstance().getRoleVo();if(n){var a=this.Split(i,"_"),o=this.Split(n.srv_id,"_");a[2]&&o[1]&&a[1]!=o[1]?s=cc.js.formatStr(Utils.TI18N("[\u5f02\u57df]%s"),s):Object.keys(a).length>1&&(s=cc.js.formatStr(Utils.TI18N("[S%s]%s"),a[Object.keys(a).length],s)),"robot_1"==i&&(s=e)}}return s},splitDataStr:function(e){for(var i=e;-1!=i.indexOf("{");){var s=i.indexOf("{"),n=i.indexOf("}"),a=i.substring(s,n+1),o=a.substring(1,a.length-1),l=this.Split(o,":"),r=cc.js.formatStr("<color=%s>%s</color>",gdata("color_data","data_color3",parseInt(l[1])),l[2]);i=i.replace(a,r)}var c=t("role_controller").getInstance().getRoleVo();return c&&(i=i.replace(/~n/g,c.name)),i},createLabel:function(t,e,i,s,n,a,o,l,r,c){t=t||20;var _=new cc.Node;_.setAnchorPoint(r||cc.v2(0,0));var h=_.addComponent(cc.Label);if(h.fontSize=t,h.horizontalAlign=cc.macro.TextAlignment.CENTER,h.verticalAlign=cc.macro.TextAlignment.CENTER,null==e&&(e=new cc.Color(255,255,255,255)),_.color=e,i){var d=_.addComponent(cc.LabelOutline);d.color=i,d.width=l||1}return s=s||0,n=n||0,_.setPosition(s,n),null!=a&&(h.string=a),o&&o.addChild(_),h},createRichLabel:function(t,e,i,s,n,a,o,l){var r=new cc.Node;r.setAnchorPoint(i||cc.v2(0,0)),r.setPosition(s||cc.v2(0,0));var c=r.addComponent(cc.RichText);return null==e&&(e=new cc.Color(255,255,255,255)),c.fontSize=t,c.horizontalAlign=cc.macro.TextAlignment.CENTER,c.verticalAlign=cc.macro.TextAlignment.CENTER,"left"==l?c.horizontalAlign=cc.macro.TextAlignment.LEFT:"right"==l&&(c.horizontalAlign=cc.macro.TextAlignment.RIGHT),c.lineHeight=n||t+4,r.color=e,c.maxWidth=a||300,o&&o.addChild(r),c},createImage:function(t,e,i,s,n,a,o,l){var r=new cc.Node,c=r.addComponent(cc.Sprite);return null!=e&&LoaderManager.getInstance().loadRes(e,function(t,e){t.spriteFrame=e}.bind(this,c)),null==n?r.setAnchorPoint(cc.v2(.5,.5)):r.setAnchorPoint(n),1==l&&(c.type=cc.Sprite.Type.SLICED,c.sizeMode=cc.Sprite.SizeMode.CUSTOM),null!=i&&null!=s&&r.setPosition(cc.v2(i,s)),t&&t.addChild(r,o||0),c},createEffectSpine:function(t,e,i,s,n,a,o,l){var r=new cc.Node;r.setPosition(e),r.setAnchorPoint(i);var c=r.addComponent(sp.Skeleton);t=t||"E88888",null==s&&(s=!0),n=n||PlayerAction.action;var _=cc.js.formatStr("spine/%s/action.atlas",t);return LoaderManager.getInstance().loadRes(_,function(t){c.skeletonData=t,null==l?c.setAnimation(0,n,s):c.setAnimation(1,n,s),a&&a()}.bind(this)),c},addRedPointToNodeByStatus:function(t,e,i,s,n,a){if(t)if(1==e){if(!t.red_point){i=i||0,s=s||0,n=n||10;var o=PathTool.getUIIconPath("mainui","mainui_1009");a&&2==a&&(o=PathTool.getCommonIcomPath("common_1014"));var l=t.getContentSize(),r=l.width/2+i,c=l.height/2+s,_=this.createImage(t,null,r,c,cc.v2(1,1),null,n);LoaderManager.getInstance().loadRes(o,function(t,e){t.spriteFrame=e}.bind(this,_)),t.red_point=_}t.red_point.node.active=!0}else t.red_point&&(t.red_point.node.active=!1)},getArrTrueLen:function(t){var e=0;for(var i in t){null!=t[i]&&(e+=1)}return e},getArrLen:function(t){return t instanceof Array?t.length:Object.keys(t).length},delayRun:function(t,e,i){if(i){null==t&&i();var s=cc.delayTime(e),n=cc.callFunc(function(){null!=t&&i()});t.runAction(cc.sequence(s,n))}},onTouchEnd:function(t,e,i){t?t.on(cc.Node.EventType.TOUCH_END,function(t){Utils.playButtonSound(i),e&&e()}):e&&e()},playButtonSound:function(t){if(t){var e=null;e=t==ButtonSound.Normal?"c_button1":t==ButtonSound.Close?"c_close":t==ButtonSound.Tab?"c_002":t,n.getInstance().playEffect(AUDIO_TYPE.COMMON,e)}},playEffectSound:function(t,e){n.getInstance().playEffectOnce(t,e)},playMusic:function(t,e,i){n.getInstance().playMusic(t,e,i)},getRandomSaveName:function(){var t=function(e){var i=e,s=String.fromCharCode(Math.random(65,90)),n=String.fromCharCode(Math.random(97,122)),a=String.fromCharCode(Math.random(48,57));return Math.random(3)%3==0?i+=s:Math.random(3)%2==0?i+=n:i+=a,this.getByteLen(i)<12&&(i=t(i)),i}.bind(this);return"sy"+t("")},getServerIndex:function(e){if(null==e)return[""];if("robot_1"==e||"robot"==e)return[0];var i=t("role_controller").getInstance().getRoleVo();if(i){var s=e.split("_"),n=i.srv_id.split("_");if(s[1]&&n[0]&&s[0]!=n[0])return[0];if(s.length>1)return e==i.srv_id?[s[s.length],!0]:[s[s.length]]}return[0]},commonShowSingleRowItemList:function(t,e,i,s,n,a){if(t&&i){if(e=e)for(var o in e)e[o].setVisible(!1);if(null==e&&(e=[]),0!=i.length){var l=(s=s||{}).scale||1,r=s.start_x||5,c=s.space_x||5,_=s.max_count,h=s.item_width||120,d=s.lock||!1,u=s.is_tip,m=s.callback||!1,f=i.length,p=2*r+(h*=l)*f+c*(f-1),g=n.getContentSize(),v=Math.max(g.width,p);n.setContentSize(cc.size(v,g.height)),_&&f<=_&&(t.off(cc.Node.EventType.TOUCH_START,t._onTouchBegan,t,!0),t.off(cc.Node.EventType.TOUCH_MOVE,t._onTouchMoved,t,!0),t.off(cc.Node.EventType.TOUCH_END,t._onTouchEnded,t,!0),t.off(cc.Node.EventType.TOUCH_CANCEL,t._onTouchCancelled,t,!0),s.is_center&&(r=.5*(g.width-p))<0&&(r=0)),n.stopAllActions();var b=function(t,e,i,n){t.setVisible(!0);var o=r+h/2+i*(h+c);t.setPosition(o,.5*g.height),t.setData({bid:e[0],num:e[1]}),t.showOrderWarLock(d),m&&(a?t.addActionCallBack(function(){m()}.bind(this)):t.addCallBack(function(){m()}.bind(this))),e[2]&&t.setExtendLabel(e[2],null,24),t.setDefaultTip(n),s.show_effect_id?t.showItemEffect(!0,s.show_effect_id,PlayerAction.action_1,!0,1.1):t.showItemEffect(!1)}.bind(this),w=null,y=e.length;for(var o in i)if(w=e[o])b(w,i[o],o,u);else{var C=o-y;C<=0&&(C=1),Utils.delayRun(n,C/60,function(t,i,s,a){e[t]||((s=ItemsPool.getInstance().getItem("backpack_item")).initConfig(!0,l),s.setParent(n),s.show(),e[t]=s,b(s,i,t,a))}.bind(this,o,i[o],w,u))}return e}}},commonShowEmptyIcon:function(t,e,i){if(t)if(e){var s=(i=i||{}).text||Utils.TI18N("\u6682\u65e0\u6570\u636e");if(t.empty_con)t.empty_con.action=!0;else{var n=t.getContentSize(),a=i.pos||cc.v2(.5*n.width,.5*n.width,.5*n.height+10),o=i.scale||1,l=i.offset_y||-110,r=i.label_color||(new cc.Color).fromHEX(Config.color_data.data_color16[175]),c=i.font_size||26;cc.size(200,200);t.empty_con=new cc.Node,t.empty_con.setContentSize(cc.size(120,120)),t.empty_con.setAnchorPoint(.5,.5),t.empty_con.setPosition(a.x,a.y),t.addChild(t.empty_con,10),Utils.createImage(t.empty_con,PathTool.getUIIconPath("bigbg","bigbg_3"),0,0,cc.v2(.5,.5),!1).node.scale=o,t.empty_label=Utils.createLabel(c,r,null,0,l,"",t.empty_con,0,cc.v2(.5,.5))}t.empty_label.string=s}else t.empty_con&&(t.empty_con.action=!1)},getType:function(t){return{"[object Boolean]":"boolean","[object Number]":"number","[object String]":"string","[object Function]":"function","[object Array]":"array","[object Date]":"date","[object RegExp]":"regExp","[object Undefined]":"undefined","[object Null]":"null","[object Object]":"object"}[Object.prototype.toString.call(t)]},deepCopy1:function(t){var e,i=this.getType(t);if("array"==i){e=[];for(var s=0;s<t.length;s++)e.push(this.deepCopy1(t[s]))}else{if("object"!=i)return t;for(var s in e={},t)e[s]=this.deepCopy1(t[s])}return e},commonCountDownTime:function(e,i,s){if(e){var n=(s=s||{}).callback,a=s.label_type,o=null,l=null,r=t("timetool");a&&"rich"==a&&(o=s.time_title||"",l=s.time_color);var c=function(t){e&&(n?n(t):a&&"rich"==a&&l?t>0?e.string=cc.js.formatStr("%s <color=%s>%s</c>",o,l,r.getTimeForFunction(t)):(e.node.stopAllActions(),e.string=cc.js.formatStr("%s <color=%s>00:00:00</c>",o,l)):t>0?e.string=r.getTimeForFunction(t):(e.node.stopAllActions(),e.string="00:00:00"))};e.node.stopAllActions(),i>0?(c(i),e.node.runAction(cc.repeatForever(cc.sequence(cc.delayTime(1),cc.callFunc(function(){c(i-=1)}.bind(this)))))):c(i)}},setChildUnEnabled:function(t,e){var i;i=e?cc.Material.getBuiltinMaterial("2d-gray-sprite"):cc.Material.getBuiltinMaterial("2d-sprite");for(var s=t.getComponentsInChildren(cc.Sprite),n=0;n<s.length;++n)s[n].setMaterial(0,i)},commonGetAttrInfoByKeyValue:function(e,i){if(e&&i){var s=Config.attr_data.data_key_to_name[e];if(s){var n=PathTool.getAttrIconByStr(e);return 1==t("partner_calculate").isShowPerByStr(e)&&(i=i/10+"%"),{res:PathTool.getUIIconPath("common",n),attr_name:s,attr_val:i,icon:n}}}},post_data:function(t,e,i){Object.keys(e).forEach(function(t){data_str.push(t+"="+encodeURIComponent(e[t]))}),xhr.open("POST",t,!0),xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),xhr.onreadystatechange=function(){if(4===xhr.readyState){var t=xhr.responseText;xhr.status>=200&&xhr.status<300?i(!0,t):i(!1,t)}},xhr.send([].join("&"))},post_json:function(t,e,i){xhr.open("POST",t,!0),xhr.setRequestHeader("Content-type","application/json"),xhr.onreadystatechange=function(){if(4===xhr.readyState){var t=xhr.responseText;xhr.status>=200&&xhr.status<300?i(!0,JSON.parse(t)):i(!1,t)}},xhr.send(JSON.stringify(e))}},cc._RF.pop()},{partner_calculate:"partner_calculate",role_controller:"role_controller",soundmanager:"soundmanager",timetool:"timetool"}],variety_store_item_panel:[function(t,e,i){"use strict";cc._RF.push(e,"2fa86M9CTxNG64SVRyeNqHA","variety_store_item_panel");var s=t("pathtool"),n=t("mall_controller"),a=t("mall_event"),o=t("mall_const"),l=t("guide_controller"),r=t("role_controller"),c=t("backpack_controller"),_=t("commonalert"),h=t("vip_controller"),d=t("backpack_const");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("mall","varietystore_item"),this.ctrl=n.getInstance(),this.model=n.getInstance().getModel()},initConfig:function(){this.size=cc.size(158,214)},initPanel:function(){var t=this.root_wnd.getChildByName("container");this.container=t,this.image_bg_nd=t.getChildByName("image_bg"),this.pos_node=t.getChildByName("pos_node"),this.image_zhe=t.getChildByName("image_zhe"),this.image_zhe.active=!1,this.zhe_label=this.image_zhe.getChildByName("zhe_label").getComponent(cc.Label),this.image_buy=t.getChildByName("image_buy"),this.image_buy.active=!1,this.price_img=this.container.getChildByName("price_img").getComponent(cc.Sprite),this.data&&this.updateInfo()},registerEvent:function(){Utils.onTouchEnd(this.image_bg_nd,function(){this.data&&this.data.has_buy&&this.data.limit_count&&this.data.has_buy>=this.data.limit_count?message(Utils.TI18N("\u8be5\u5546\u54c1\u5df2\u552e\u7f44")):this._onClickItem()}.bind(this),1),this.addGlobalEvent(a.Buy_One_Success,function(t,e){if(this.data&&this.data.order&&t.order==this.data.order){if(e&&e.item_id!=this.data.item_id)return;this.data.has_buy=this.data.has_buy+1,this.data.limit_count&&this.data.has_buy>=this.data.limit_count&&this.showSellOutStatus(!0)}}.bind(this))},_onClickItem:function(){this.data&&this.data.order&&(l.getInstance().isInGuide()?this.ctrl.sender13407(this.data.order,o.MallType.VarietyShop,1,this.data):this.showAlert(this.data))},showAlert:function(t){if(t){var e=t.price;if(0!=t.discount&&(e=t.discount),r.getInstance().getRoleVo())if(c.getInstance().getModel().getItemNumByBid(t.pay_type)>=e){var i=Utils.getItemConfig(t.item_id),s=d.Bag_Code.BACKPACK;1==i.sub_type&&(s=d.Bag_Code.EQUIPS);var n=c.getInstance().getModel().getItemNumByBid(t.item_id,s),a=cc.js.formatStr(Utils.TI18N("\u662f\u5426\u8d2d\u4e70<color=#289b14 fontsize= 26>%s</color>(\u62e5\u6709:<color=#289b14 fontsize= 26>%d</color>)\uff1f"),i.name,n);_.show(a,Utils.TI18N("\u786e\u5b9a"),function(){this.ctrl.sender13407(t.order,o.MallType.VarietyShop,1,this.data)}.bind(this),Utils.TI18N("\u53d6\u6d88"))}else{var l=null;if(l="number"==typeof t.pay_type?Utils.getItemConfig(t.pay_type):Utils.getItemConfig(Config.item_data.data_assets_label2id[t.pay_type]))if(l.id==Config.item_data.data_assets_label2id.gold)if(0==IS_SHOW_CHARGE)message(Utils.TI18N("\u94bb\u77f3\u4e0d\u8db3"));else{var u=function(){h.getInstance().openVipMainWindow(!0,VIPTABCONST.CHARGE)}.bind(this),m=cc.js.formatStr(Utils.TI18N("%s\u4e0d\u8db3\uff0c\u662f\u5426\u524d\u5f80\u5145\u503c\uff1f"),l.name);_.show(m,Utils.TI18N("\u786e\u5b9a"),u,Utils.TI18N("\u53d6\u6d88"))}else c.getInstance().openTipsSource(!0,l)}}},updateInfo:function(){if(this.root_wnd){this.image_bg_nd.name="buy_btn_"+(parseInt(this.tmp_index)+1),this.price_label||(this.price_label=Utils.createRichLabel(26,new cc.Color(123,41,0,255),cc.v2(.5,.5),cc.v2(15,-75),30),this.price_label.handleTouchEvent=!1,this.container.addChild(this.price_label.node));var t=this.data.pay_type,e=Utils.getItemConfig(t);if(e){var i=s.getItemRes(e.icon),n=this.data.price;this.data.discount>0&&(n=this.data.discount);var a=Utils.getMoneyString(n);this.price_label.string=a,this.loadRes(i,function(t){this.price_img.spriteFrame=t}.bind(this))}this.item_icon||(this.item_icon=ItemsPool.getInstance().getItem("backpack_item"),this.item_icon.initConfig(!1,1,null,!0),this.item_icon.setParent(this.pos_node),this.item_icon.show()),this.item_icon.setData({bid:this.data.item_id,num:this.data.item_num}),this.data.discount>0?(this.image_zhe.active=!0,this.zhe_label.string=cc.js.formatStr(Utils.TI18N("%d\u6298"),this.data.discount_type)):this.image_zhe.active=!1,this.data.limit_count=1,this.data.has_buy&&this.data.limit_count&&this.data.has_buy>=this.data.limit_count?this.showSellOutStatus(!0):this.showSellOutStatus(!1)}},setData:function(t){t&&(this.data=t,this.updateInfo())},showSellOutStatus:function(t){this.item_icon&&this.item_icon.setItemIconUnEnabled(t),this.image_buy&&(this.image_buy.active=t),this.container},onShow:function(t){},onHide:function(){},onDelete:function(){this.item_icon&&(this.item_icon.deleteMe(),this.item_icon=null)}});cc._RF.pop()},{backpack_const:"backpack_const",backpack_controller:"backpack_controller",commonalert:"commonalert",guide_controller:"guide_controller",mall_const:"mall_const",mall_controller:"mall_controller",mall_event:"mall_event",pathtool:"pathtool",role_controller:"role_controller",vip_controller:"vip_controller"}],variety_store_window:[function(t,e,i){"use strict";cc._RF.push(e,"bf47cbOcMtMtpRlgD62WU36","variety_store_window");var s=t("pathtool"),n=t("common_scrollview"),a=t("mall_const"),o=t("mall_event"),l=t("variety_store_item_panel"),r=t("timetool");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("mall","varietystore_window"),this.viewTag=SCENE_TAG.ui,this.win_type=WinType.Full,this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){},openCallBack:function(){this.background=this.root_wnd.getChildByName("background"),this.background.scale=FIT_SCALE,this.bg=this.background.getComponent(cc.Sprite),this.loadRes(s.getBigBg("bigbg_72"),function(t){this.bg.spriteFrame=t}.bind(this));var t=this.root_wnd.getChildByName("main_container");this.main_container=t,this.image_1=this.main_container.getChildByName("image_1").getComponent(cc.Sprite),this.loadRes(s.getBigBg("bigbg_74"),function(t){this.image_1.spriteFrame=t}.bind(this)),this.image_2_node=this.main_container.getChildByName("image_2"),this.image_2=this.image_2_node.getComponent(cc.Sprite),this.loadRes(s.getBigBg("bigbg_73"),function(t){this.image_2.spriteFrame=t}.bind(this)),this.image_3=this.main_container.getChildByName("image_3").getComponent(cc.Sprite),this.loadRes(s.getBigBg("bigbg_75"),function(t){this.image_3.spriteFrame=t}.bind(this)),this.image_4=this.main_container.getChildByName("image_4").getComponent(cc.Sprite),this.loadRes(s.getBigBg("bigbg_76"),function(t){this.image_4.spriteFrame=t}.bind(this)),this.refresh_label=t.getChildByName("refresh_label").getComponent(cc.Label),this.time_label=t.getChildByName("time_label").getComponent(cc.Label),this.time_label.string="0:00:00",this.refresh_btn=t.getChildByName("refresh_btn"),this.refresh_btn_label=Utils.createRichLabel(26,new cc.Color(255,255,255,255),cc.v2(.5,.5),cc.v2(0,0),30),this.refresh_btn.addChild(this.refresh_btn_label.node),this.close_btn=t.getChildByName("close_btn");var e=t.getChildByName("item_list"),i=e.getContentSize(),a=cc.size(i.width,i.height+50),o={item_class:l,start_x:20,space_x:38,start_y:30,space_y:85,item_width:158,item_height:214,row:0,col:3};this.item_scrollview=new n,this.item_scrollview.createScroll(e,cc.v2(0,-40),ScrollViewDir.vertical,ScrollViewStartPos.top,a,o),this.item_scrollview.setBounceEnabled(!1)},registerEvent:function(){Utils.onTouchEnd(this.close_btn,function(){this._onClickCloseBtn()}.bind(this),2),Utils.onTouchEnd(this.refresh_btn,function(){this._onClickRefreshBtn()}.bind(this),2),this.addGlobalEvent(o.Get_Buy_list,function(t){t.type==a.MallType.VarietyShop&&this.setData(t)}.bind(this)),this.addGlobalEvent(o.Free_Refresh_Data,function(t){if(t.type==a.MallType.VarietyShop&&t&&this.data){for(var e in t)this.data[e]=t[e];this.updateRefreshInfo()}}.bind(this))},setData:function(t){if(this.data=t||[],this.updateRefreshInfo(),t.item_list)for(var e in t.item_list)t.item_list[e].index=e;this.item_scrollview.setData(t.item_list||[])},updateRefreshInfo:function(){if(this.data){var t=Config.exchange_data.data_shop_exchage_cost.maximum_number;this.refresh_label.string=cc.js.formatStr(Utils.TI18N("\u5237\u65b0\u6b21\u6570:%d/%d"),this.data.count,t.val);var e="",i="";if(this.data.free_count>0){var n=Config.exchange_data.data_shop_exchage_cost.max_free_times;e=cc.js.formatStr(Utils.TI18N("<color=#ffffff><outline=2,color=#2B610D>\u5237\u65b0(%d/%d)</outline></color>"),this.data.free_count,n.val)}else{var o=Config.exchange_data.data_shop_list[a.MallType.VarietyShop];if(o&&o.cost_list){var l=o.cost_list[0][0],c=o.cost_list[0][1],_=Utils.getItemConfig(l);_&&(i=s.getItemRes(_.icon),e=cc.js.formatStr(Utils.TI18N("<img src='%s'/><color=#ffffff><outline=2,color=#2B610D> %d \u5237\u65b0</outline></color>"),_.icon,c))}}if(this.refresh_btn_label.string=e,i&&this.loadRes(i,function(t){this.refresh_btn_label.spriteFrame=t}.bind(this)),this.data.refresh_time>0){var h=this.data.refresh_time-gcore.SmartSocket.getTime();h<0?(h=0,this.openRefreshTimer(!1)):this.openRefreshTimer(!0),this.time_label.string=r.getTimeFormat(h)}else this.openRefreshTimer(!1),this.time_label.string="0:00:00"}},openRefreshTimer:function(t){1==t?null==this.refresh_timer&&(this.refresh_timer=gcore.Timer.set(function(){if(this.data&&this.data.refresh_time>0){var t=this.data.refresh_time-gcore.SmartSocket.getTime();t<0&&(gcore.Timer.del(this.refresh_timer),this.refresh_timer=null),this.time_label.string=r.getTimeFormat(t)}else this.time_label.string="0:00:00",gcore.Timer.del(this.refresh_timer),this.refresh_timer=null}.bind(this),1,-1)):null!=this.refresh_timer&&(gcore.Timer.del(this.refresh_timer),this.refresh_timer=null)},_onClickCloseBtn:function(){this.ctrl.openVarietyStoreWindows(!1)},_onClickRefreshBtn:function(){this.data&&this.ctrl.sender13405(a.MallType.VarietyShop)},openRootWnd:function(t){this.ctrl.sender13403(a.MallType.VarietyShop)},closeCallBack:function(){this.item_scrollview&&(this.item_scrollview.deleteMe(),this.item_scrollview=null),this.openRefreshTimer(!1),this.ctrl.openVarietyStoreWindows(!1)}});cc._RF.pop()},{common_scrollview:"common_scrollview",mall_const:"mall_const",mall_event:"mall_event",pathtool:"pathtool",timetool:"timetool",variety_store_item_panel:"variety_store_item_panel"}],vedio_collect_window:[function(t,e,i){"use strict";cc._RF.push(e,"6b6a2Ngwu5CLaSrT9lrtvei","vedio_collect_window");var s=t("pathtool"),n=t("common_scrollview"),a=t("vedio_controller"),o=t("vedio_const"),l=t("vedio_item_panel"),r=t("vedio_event"),c=t("role_controller"),_=t("chat_const");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("vedio","vedio_collect_window"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.big,this.ctrl=a.getInstance(),this._model=this.ctrl.getModel()},initConfig:function(){},openCallBack:function(){this.background=this.root_wnd.getChildByName("background");var t=this.root_wnd.getChildByName("main_container");this.main_container=t,this.share_panel=this.root_wnd.getChildByName("share_panel"),this.share_panel.active=!1,this.share_bg=this.share_panel.getChildByName("share_bg"),this.btn_guild=this.share_bg.getChildByName("btn_guild"),this.btn_world=this.share_bg.getChildByName("btn_world"),this.btn_cross=this.share_bg.getChildByName("btn_cross"),this.share_bg.getChildByName("guild_label").getComponent(cc.Label).string=Utils.TI18N("\u5206\u4eab\u5230\u516c\u4f1a\u9891\u9053"),this.share_bg.getChildByName("world_label").getComponent(cc.Label).string=Utils.TI18N("\u5206\u4eab\u5230\u4e16\u754c\u9891\u9053"),t.getChildByName("win_title").getComponent(cc.Label).string=Utils.TI18N("\u4e2a\u4eba\u6536\u85cf"),this.num_txt=t.getChildByName("num_txt").getComponent(cc.Label),this.no_vedio_image=t.getChildByName("no_vedio_image"),this.no_vedio_image.getChildByName("label").getComponent(cc.Label).string=Utils.TI18N("\u6682\u65e0\u5f55\u50cf\u6536\u85cf");var e=t.getChildByName("vedio_list"),i=e.getContentSize(),s={item_class:l,start_x:0,space_x:0,start_y:0,space_y:5,item_width:620,item_height:374,row:0,col:1,need_dynamic:!0};this.vedio_scrollview=new n,this.vedio_scrollview.createScroll(e,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,i,s)},registerEvent:function(){this.btn_guild.on("click",function(){if(Utils.playButtonSound(1),0!=c.getInstance().getRoleVo().isHasGuild()){if(this.replay_id){this.ctrl.requestShareVedio(this.replay_id,_.Channel.Gang,this.srv_id,this.combat_type),this._model.updateVedioData(null,this.replay_id,"share",this.share_num);var t=this.updateVedioDataById(this.replay_id,"share",this.share_num);gcore.GlobalEvent.fire(r.UpdateVedioDataEvent,t)}this.replay_id=null,this.srv_id=null,this.combat_type=null,this.share_panel.active=!1}else message(Utils.TI18N("\u60a8\u6682\u672a\u52a0\u5165\u516c\u4f1a"))},this),this.btn_world.on("click",function(){if(Utils.playButtonSound(1),this.replay_id){this.ctrl.requestShareVedio(this.replay_id,_.Channel.World,this.srv_id,this.combat_type),this._model.updateVedioData(null,this.replay_id,"share",this.share_num);var t=this.updateVedioDataById(this.replay_id,"share",this.share_num);gcore.GlobalEvent.fire(r.UpdateVedioDataEvent,t)}this.replay_id=null,this.srv_id=null,this.combat_type=null,this.share_panel.active=!1},this),this.share_panel.on("touchend",function(){this.share_panel.active=!1},this),this.background.on("touchend",function(){Utils.playButtonSound(2),this.ctrl.openVedioCollectWindow(!1)},this),this.addGlobalEvent(r.UpdateCollectVedioEvent,function(t){this.setData(t)}.bind(this)),this.addGlobalEvent(r.CancelCollectVedioEvent,function(t){for(var e=0;e<this.data.length;++e){if(this.data[e].id==t){this.data.splice(e,1);break}}null==Utils.next(this.data)?(this.no_vedio_image.active=!0,this.vedio_scrollview.setData(this.data)):(this.vedio_scrollview.resetAddPosition(this.data,this._onClickShareBtn.bind(this),{is_collect:!0}),this.no_vedio_image.active=!1),this.refreshCollectNum()}.bind(this))},openRootWnd:function(t){this.ctrl.requestMyVedioByType(o.MyVedio_Type.Collect),this.refreshCollectNum(),gcore.GlobalEvent.fire(r.OpenCollectViewEvent,!0)},setData:function(t){t&&null!=Utils.next(t)?(this.no_vedio_image.active=!1,this.data=t,this.vedio_scrollview.setData(this.data,this._onClickShareBtn.bind(this),{is_collect:!0}),this.refreshCollectNum()):this.no_vedio_image.active=!0},refreshCollectNum:function(){var t=0;this.data&&(t=this.data.length);var e=0,i=Config.video_data.data_const.self_collection_limit;i&&(e=i.val),this.num_txt.string=cc.js.formatStr(Utils.TI18N("\u6536\u85cf\u6570:%d/%d"),t,e)},_onClickShareBtn:function(t,e,i,s,n){this.replay_id=e,this.share_num=i,this.srv_id=s,this.combat_type=n;var a=this.share_panel.convertToNodeSpaceAR(t);a&&(this.share_bg.setPosition(cc.v2(a.x-60,a.y+45)),this.share_panel.active=!0)},updateVedioDataById:function(t,e,i){if(this.data){for(var s={},n=0;n<this.data.length;++n){var a=this.data[n];if(a.id==t){a[e]=i,s=a;break}}return s}},closeCallBack:function(){this.vedio_scrollview&&(this.vedio_scrollview.DeleteMe(),this.vedio_scrollview=null),gcore.GlobalEvent.fire(r.OpenCollectViewEvent,!1),this.ctrl.openVedioCollectWindow(!1)}});cc._RF.pop()},{chat_const:"chat_const",common_scrollview:"common_scrollview",pathtool:"pathtool",role_controller:"role_controller",vedio_const:"vedio_const",vedio_controller:"vedio_controller",vedio_event:"vedio_event",vedio_item_panel:"vedio_item_panel"}],vedio_const:[function(t,e,i){"use strict";var s,n,a;function o(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}cc._RF.push(e,"c8afd1OvodMWp/G7iyvZhRs","vedio_const");var l={Tab_Index:{Arena:1,Champion:2,Solo:3,Guildwar:4,Ladder:5,Elite:6,Hot:98},Color:{Atk:new cc.Color(168,46,26),Def:new cc.Color(39,134,188)},Cham_Name:(s={},o(s,2,"\u51b3\u8d5b"),o(s,4,"\u534a\u51b3\u8d5b"),o(s,8,"8\u5f3a\u8d5b"),o(s,16,"16\u5f3a\u8d5b"),o(s,32,"32\u5f3a\u8d5b"),o(s,128,"\u9009\u62d4\u8d5b"),s),Left_Role_Battle_Index:(n={},o(n,1,9),o(n,2,6),o(n,3,3),o(n,4,8),o(n,5,5),o(n,6,2),o(n,7,7),o(n,8,4),o(n,9,1),n),Right_Role_Battle_Index:(a={},o(a,1,3),o(a,2,6),o(a,3,9),o(a,4,2),o(a,5,5),o(a,6,8),o(a,7,1),o(a,8,4),o(a,9,7),a),ReqVedioDataNum:30,MyVedio_Type:{Myself:1,Collect:99},Share_Btn_Type:{eGuildBtn:1,eWorldBtn:2}};e.exports=l,cc._RF.pop()},{}],vedio_controller:[function(t,e,i){"use strict";var s;function n(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}cc._RF.push(e,"a44dbAoMmRGnZuWWAfZ2FFg","vedio_controller");var a=t("vedio_event"),o=t("vedio_const"),l=cc.Class((n(s={extends:BaseController,ctor:function(){},initConfig:function(){var e=t("vedio_model");this.model=new e,this.model.initConfig()},getModel:function(){return this.model},registerEvents:function(){},registerProtocals:function(){this.RegisterProtocal(19901,this.handle19901.bind(this)),this.RegisterProtocal(19902,this.handle19902.bind(this)),this.RegisterProtocal(19903,this.handle19903.bind(this)),this.RegisterProtocal(19904,this.handle19904.bind(this)),this.RegisterProtocal(19905,this.handle19905.bind(this)),this.RegisterProtocal(19906,this.handle19906.bind(this)),this.RegisterProtocal(19907,this.handle19907.bind(this)),this.RegisterProtocal(19908,this.handle19908.bind(this))},handle19901:function(t){t&&(t.type==o.MyVedio_Type.Myself?gcore.GlobalEvent.fire(a.UpdateMyselfVedioEvent,t.replay_list):t.type==o.MyVedio_Type.Collect&&gcore.GlobalEvent.fire(a.UpdateCollectVedioEvent,t.replay_list))},handle19902:function(t){t&&(this.model.setPublicVedioData(t),gcore.GlobalEvent.fire(a.UpdatePublicVedioEvent,t.type))},handle19903:function(t){message(t.msg),1==t.code&&gcore.GlobalEvent.fire(a.CLICK_Like_Vedio_EVENT)},handle19904:function(t){if(message(t.msg),1==t.code&&1==t.type){var e=this.model.updateVedioData(this.vedioType_flag,t.id,"is_collect",1);gcore.GlobalEvent.fire(a.UpdateVedioDataEvent,e),gcore.GlobalEvent.fire(a.CollectSuccessVedioEvent,t.id)}0==t.type&&gcore.GlobalEvent.fire(a.CancelCollectVedioEvent,t.id)},handle19905:function(t){message(t.msg)},handle19906:function(t){null!=t.like&&(this.model.setTodayLikeNum(t.like),gcore.GlobalEvent.fire(a.UpdateTodayLikeNum))},handle19907:function(e){if(e){var i=Config.partner_data.data_partner_base[e.bid],s=1;i&&(s=i.camp_type),e.camp_type=s,e.ext_data=e.ext,e.name=i.name;for(var n=0;n<e.ext.length;++n){var a=e.ext[n];111==a.key?e.hit_rate=a.val:112==a.key?e.dodge_rate=a.val:117==a.key?e.tenacity=a.val:121==a.key?e.dam=a.val:122==a.key?e.res=a.val:123==a.key?e.be_cure=a.val:124==a.key?e.cure=a.val:125==a.key?e.dam_p=a.val:126==a.key?e.dam_s=a.val:127==a.key?e.res_p=a.val:128==a.key&&(e.res_s=a.val)}t("hero_controller").getInstance().openHeroTipsPanel(!0,e)}},handle19908:function(){},requestPublicVedioData:function(t,e,i,s){var n={};n.type=t,n.cond_type=e,n.start=i,n.num=s,this.SendProtocal(19902,n)},requestVedioHeroData:function(t,e,i,s,n){var a={};a.replay_id=t,a.partner_id=e,a.type=i,a.srv_id=s,a.combat_type=n,this.SendProtocal(19907,a)},requestShareVedio:function(t,e,i,s){var n={};n.id=t,n.channel=e,n.srv_id=i,n.combat_type=s,this.SendProtocal(19905,n)},requestCollectVedio:function(t,e,i,s,n){this.vedioType_flag=n;var a={};a.id=t,a.type=e,a.srv_id=i,a.combat_type=s,this.SendProtocal(19904,a)},requestLikeVedio:function(t,e,i){var s={};s.id=t,s.srv_id=e,s.combat_type=i,this.SendProtocal(19903,s)},requestMyVedioByType:function(t){var e={};e.type=t,this.SendProtocal(19901,e)},send19908:function(t,e,i,s){var n={};n.replay_id=t,n.srv_id=e,n.type=i,n.channel=s,this.SendProtocal(19908,n)}},"handle19908",function(t){this.openVedioLookPanel(!0,t)}),n(s,"openVedioMainWindow",function(e,i){if(1==e){if(!this.vedio_main_wnd){var s=t("vedio_main_window");this.vedio_main_wnd=new s}0==this.vedio_main_wnd.isOpen()&&this.vedio_main_wnd.open(i)}else this.vedio_main_wnd&&(this.vedio_main_wnd.close(),this.vedio_main_wnd=null)}),n(s,"openVedioCollectWindow",function(e){if(1==e){if(null==this.vedio_collect_win){var i=t("vedio_collect_window");this.vedio_collect_win=new i}0==this.vedio_collect_win.isOpen()&&this.vedio_collect_win.open()}else this.vedio_collect_win&&(this.vedio_collect_win.close(),this.vedio_collect_win=null)}),n(s,"openVedioMyselfWindow",function(e){if(1==e){if(null==this.vedio_myself_win){var i=t("vedio_myself_window");this.vedio_myself_win=new i}0==this.vedio_myself_win.isOpen()&&this.vedio_myself_win.open()}else this.vedio_myself_win&&(this.vedio_myself_win.close(),this.vedio_myself_win=null)}),n(s,"openVedioLookPanel",function(e,i){if(1==e){if(!this.vedio_look_panel){var s=t("vedio_look_window");this.vedio_look_panel=new s}0==this.vedio_look_panel.isOpen()&&this.vedio_look_panel.open(i)}else this.vedio_look_panel&&(this.vedio_look_panel.close(),this.vedio_look_panel=null)}),n(s,"openVedioSharePanel",function(e,i,s,n,a,o){if(1==e){if(!this.vedio_share_panel){var l=t("vedio_share_window");this.vedio_share_panel=new l}0==this.vedio_share_panel.isOpen()&&this.vedio_share_panel.open({replay_id:i,world_pos:s,callback:n,srv_id:a,combat_type:o})}else this.vedio_share_panel&&(this.vedio_share_panel.close(),this.vedio_share_panel=null)}),s));e.exports=l,cc._RF.pop()},{hero_controller:"hero_controller",vedio_collect_window:"vedio_collect_window",vedio_const:"vedio_const",vedio_event:"vedio_event",vedio_look_window:"vedio_look_window",vedio_main_window:"vedio_main_window",vedio_model:"vedio_model",vedio_myself_window:"vedio_myself_window",vedio_share_window:"vedio_share_window"}],vedio_event:[function(t,e,i){"use strict";cc._RF.push(e,"331ccn36VpKXIJvIgwl/uM7","vedio_event");var s={UpdateMyselfVedioEvent:"VedioEvent.UpdateMyselfVedioEvent",UpdateCollectVedioEvent:"VedioEvent.UpdateCollectVedioEvent",UpdatePublicVedioEvent:"VedioEvent.UpdatePublicVedioEvent",CancelCollectVedioEvent:"VedioEvent.CancelCollectVedioEvent",CollectSuccessVedioEvent:"VedioEvent.CollectSuccessVedioEvent",UpdateVedioDataEvent:"VedioEvent.UpdateVedioDataEvent",UpdateTodayLikeNum:"VedioEvent.UpdateTodayLikeNum",OpenCollectViewEvent:"VedioEvent.OpenCollectViewEvent",LOOK_VEDIO_EVENT:"VedioEvent.LOOK_VEDIO_EVENT",CLICK_Like_Vedio_EVENT:"VedioEvent.CLICK_Like_Vedio_EVENT"};e.exports=s,cc._RF.pop()},{}],vedio_item_panel:[function(t,e,i){"use strict";cc._RF.push(e,"dcb06BvJbZGc7yn4wKqo+fR","vedio_item_panel");var s=t("pathtool"),n=t("timetool"),a=t("battle_const"),o=t("vedio_controller"),l=t("vedio_const"),r=t("chat_const"),c=t("battle_controller"),_=t("vedio_event"),h=t("role_controller");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("vedio","vedio_item"),this.ctrl=o.getInstance(),this._model=this.ctrl.getModel()},initConfig:function(){},initPanel:function(){var t=this,e=this;e.container=e.root_wnd.getChildByName("container");var i=e.container.getChildByName("image_panel");e.image_atk_left=i.getChildByName("image_atk_left"),e.image_atk_right=i.getChildByName("image_atk_right"),e.image_rank_left=i.getChildByName("image_rank_left"),e.image_rank_right=i.getChildByName("image_rank_right"),e.result_win=i.getChildByName("result_win"),e.result_loss=i.getChildByName("result_loss"),e.name_left=e.container.getChildByName("name_left").getComponent(cc.Label),e.name_right=e.container.getChildByName("name_right").getComponent(cc.Label),e.challenge_left=e.container.getChildByName("challenge_left").getComponent(cc.Label),e.challenge_right=e.container.getChildByName("challenge_right").getComponent(cc.Label),e.atk_label_left=e.container.getChildByName("atk_label_left").getComponent(cc.Label),e.atk_label_right=e.container.getChildByName("atk_label_right").getComponent(cc.Label),e.rank_label_left=e.container.getChildByName("rank_label_left").getComponent(cc.Label),e.rank_label_right=e.container.getChildByName("rank_label_right").getComponent(cc.Label),e.rank_title_left=e.container.getChildByName("rank_title_left").getComponent(cc.Label),e.rank_title_right=e.container.getChildByName("rank_title_right").getComponent(cc.Label),e.rank_title_left.string=Utils.TI18N("\u6392\u884c"),e.rank_title_right.string=Utils.TI18N("\u6392\u884c"),e.round_txt=e.container.getChildByName("round_txt").getComponent(cc.Label),e.type_txt=e.container.getChildByName("type_txt").getComponent(cc.Label),e.time_txt=e.container.getChildByName("time_txt").getComponent(cc.Label),e.level_left=e.container.getChildByName("level_left").getComponent(cc.Label),e.level_right=e.container.getChildByName("level_right").getComponent(cc.Label),e.play_btn=i.getChildByName("play_btn"),e.share_btn=i.getChildByName("share_btn").getComponent(cc.Button),e.info_btn=i.getChildByName("info_btn"),e.collect_btn=i.getChildByName("collect_btn").getComponent(cc.Button),e.collect_btn_sp=i.getChildByName("collect_btn").getComponent(cc.Sprite),e.like_btn=i.getChildByName("like_btn").getComponent(cc.Button),e.like_btn_sp=i.getChildByName("like_btn").getComponent(cc.Sprite),this.like_red_point=i.getChildByName("like_btn").getChildByName("red_point"),e.play_num=e.container.getChildByName("play_num").getComponent(cc.Label),e.play_num.string="0",e.share_num=e.container.getChildByName("share_num").getComponent(cc.Label),e.share_num.string="0",e.like_num=e.container.getChildByName("like_num").getComponent(cc.Label),e.like_num.string="0",e.left_item_list={},e.right_item_list={},e.panel_role_left=e.container.getChildByName("panel_role_left"),e.panel_role_right=e.container.getChildByName("panel_role_right");e.panel_role_left.getContentSize();e.postion_list={};for(var n=1;n<4;++n)for(var a=function(i){var a=3*(n-1)+i,o=cc.v2(68*(i-1)+30,70*(3-n)+30);e.postion_list[a]=o;var l=new cc.Node,r=new cc.Node;e.panel_role_left.addChild(l),e.panel_role_right.addChild(r),l.setPosition(o),r.setPosition(o),t.loadRes(s.getUIIconPath("vedio","vedio_1007"),function(t){l.addComponent(cc.Sprite).spriteFrame=t,r.addComponent(cc.Sprite).spriteFrame=t},t)},o=1;o<4;++o)a(o);this.data&&this.setData(this.data)},registerEvent:function(){this.update_self_event||(this.update_self_event=this.addGlobalEvent(_.UpdateVedioDataEvent,function(t){this.data&&t&&this.data.id==t.id&&this.setData(t)}.bind(this))),this.play_btn.on("click",function(){if(this.data){if(this.vedioType==l.Tab_Index.Ladder||1==this.is_share)c.getInstance().csRecordBattle(this.data.id,this.data.a_srv_id);else{var e=h.getInstance().getRoleVo();c.getInstance().csRecordBattle(this.data.id,e.srv_id)}this.play_num.string=1+this.data.play;var i=this._model.updateVedioData(this.vedioType,this.data.id,"play",this.data.play+1);(this.is_myself||this.is_collect)&&gcore.GlobalEvent.fire(_.UpdateVedioDataEvent,i),this._playCallBack&&this._playCallBack();var s=t("chat_controller");1==s.getInstance().isChatOpen()&&s.getInstance().closeChatPanel()}}.bind(this)),this.share_btn.node.on("click",function(t){if(Utils.playButtonSound(1),this.data.channel&&this.data.channel==r.Channel.Cross)message(TI18N("\u62b1\u6b49\uff0c\u8de8\u670d\u5206\u4eab\u7684\u5f55\u50cf\u65e0\u6cd5\u6536\u85cf\u3001\u70b9\u8d5e\u548c\u5206\u4eab"));else if(this._shareCallBack){var e=t.node.convertToWorldSpaceAR(cc.v2(0,0));this._shareCallBack(e,this.data.id,this.data.share+1,this.data.a_srv_id,this.data.combat_type)}},this),this.info_btn.on("click",function(){Utils.playButtonSound(1),this._onClickInfoBtn()},this),this.collect_btn.node.on("click",function(){if(Utils.playButtonSound(1),this.data.channel&&this.data.channel==r.Channel.Cross)message(TI18N("\u62b1\u6b49\uff0c\u8de8\u670d\u5206\u4eab\u7684\u5f55\u50cf\u65e0\u6cd5\u6536\u85cf\u3001\u70b9\u8d5e\u548c\u5206\u4eab"));else if(1==this.data.is_collect){this.data.is_collect=0,this.loadRes(s.getUIIconPath("vedio","txt_cn_vedio_collect"),function(t){this.collect_btn_sp.spriteFrame=t}.bind(this)),this.ctrl.requestCollectVedio(this.data.id,0,this.data.a_srv_id,this.data.combat_type);var t=this._model.updateVedioData(this.vedioType,this.data.id,"is_collect",0);(this.is_myself||this.is_collect)&&gcore.GlobalEvent.fire(_.UpdateVedioDataEvent,t)}else this.ctrl.requestCollectVedio(this.data.id,1,this.data.a_srv_id,this.data.combat_type,this.vedioType)},this),this.like_btn.node.on("click",function(){if(Utils.playButtonSound(1),this.data.channel&&this.data.channel==r.Channel.Cross)message(Utils.TI18N("\u62b1\u6b49\uff0c\u8de8\u670d\u5206\u4eab\u7684\u5f55\u50cf\u65e0\u6cd5\u6536\u85cf\u3001\u70b9\u8d5e\u548c\u5206\u4eab"));else if(this._model.checkTodayLikeIsFull())message(Utils.TI18N("\u4eca\u65e5\u70b9\u8d5e\u6b21\u6570\u5df2\u7528\u5b8c"));else{this.data.flag=1;var e="";if(""==this.data.a_srv_id||""==this.data.b_srv_id)e=t("role_controller").getInstance().getRoleVo().srv_id;else e=this.data.a_srv_id;this.ctrl.requestLikeVedio(this.data.id,e,this.data.combat_type),this.like_btn.interactable=!1,this.like_red_point.active=!1,this.loadRes(s.getUIIconPath("vedio","txt_cn_vedio_like_2"),function(t){this.like_btn_sp.spriteFrame=t}.bind(this)),this.like_num.string=this.data.like+1,this._model.updateVedioData(this.vedioType,this.data.id,"flag",1);var i=this._model.updateVedioData(this.vedioType,this.data.id,"like",this.data.like+1);(this.is_myself||this.is_collect)&&gcore.GlobalEvent.fire(_.UpdateVedioDataEvent,i)}},this),this.addGlobalEvent(_.CLICK_Like_Vedio_EVENT,function(t){this._model.checkTodayLikeIsFull()&&(this.like_red_point.active=!1)}.bind(this))},onShow:function(t){t&&(this.container.getChildByName("image_panel").getChildByName("image_bg").active=!1)},setData:function(t){var e=this;if(t&&(this.data=t,null!=this.root_wnd)){var i=this;i.type_txt.string=t.name;var o,r,c=0,_=t.combat_type,h=Config.combat_type_data.data_fight_list;h&&h[_]&&(c=h[_].max_action_count||0),i.round_txt.string=cc.js.formatStr(Utils.TI18N("%d/%d\u56de\u5408"),t.round||0,c),i.time_txt.string=n.dateFtt("yyyy-MM-dd hh:mm",t.time),i.play_num.string=t.play,i.share_num.string=t.share,i.like_num.string=t.like,o=1==t.is_collect?s.getUIIconPath("vedio","txt_cn_vedio_un_collect"):s.getUIIconPath("vedio","txt_cn_vedio_collect"),this.loadRes(o,function(t){i.collect_btn_sp.spriteFrame=t}.bind(this)),this.like_red_point.active=!this._model.checkTodayLikeIsFull(),i.is_myself?(i.like_btn.interactable=!1,this.like_red_point.active=!1,r=s.getUIIconPath("vedio","txt_cn_vedio_like")):1==t.flag?(i.like_btn.interactable=!1,this.like_red_point.active=!1,r=s.getUIIconPath("vedio","txt_cn_vedio_like_2")):(i.like_btn.interactable=!0,r=s.getUIIconPath("vedio","txt_cn_vedio_like")),this.loadRes(r,function(t){this.like_btn_sp.spriteFrame=t}.bind(this)),i.is_hot?i.vedioType=l.Tab_Index.Hot:t.combat_type==a.Fight_Type.Arena?i.vedioType=l.Tab_Index.Arena:t.combat_type==a.Fight_Type.Champion?i.vedioType=l.Tab_Index.Champion:t.combat_type==a.Fight_Type.PK?i.vedioType=l.Tab_Index.Solo:t.combat_type==a.Fight_Type.GuildWar?i.vedioType=l.Tab_Index.Guildwar:t.combat_type==a.Fight_Type.LadderWar?i.vedioType=l.Tab_Index.Ladder:t.combat_type!=a.Fight_Type.EliteMatchWar&&t.combat_type!=a.Fight_Type.EliteKingMatchWar||(i.vedioType=l.Tab_Index.Elite),i.result_win.active=!0,i.result_loss.active=!0,1==t.ret?(i.result_win.setPosition(cc.v2(27,353)),i.result_loss.setPosition(cc.v2(593,353))):2==t.ret?(i.result_win.setPosition(cc.v2(593,353)),i.result_loss.setPosition(cc.v2(27,353))):(i.result_win.active=!1,i.result_loss.active=!1),i.updateLikeBtnRedStatus(),i.name_left.string=Utils.transformNameByServ(t.a_name,t.a_srv_id),i.name_left._forceUpdateRenderData(),t.combat_type==a.Fight_Type.Champion?i.challenge_left.node.active=!1:(i.challenge_left.node.active=!0,i.challenge_left.string=Utils.TI18N("\u6311\u6218\u65b9"),i.challenge_left.node.color=l.Color.Atk),i.atk_label_left.string=t.a_power,i.level_left.string=t.a_lev+Utils.TI18N("\u7ea7");var d=i.name_left.node.getContentSize();i.level_left.node.x=i.name_left.node.x+d.width+10,t.combat_type==a.Fight_Type.Arena?(t.a_rank>0?i.rank_label_left.string=t.a_rank:i.rank_label_left.string=Utils.TI18N("\u6682\u65e0"),i.image_rank_left.active=!0,i.rank_title_left.node.active=!0,i.rank_label_left.node.active=!0):(i.image_rank_left.active=!1,i.rank_title_left.node.active=!1,i.rank_label_left.node.active=!1);for(var u=function(s){var n=l.Left_Role_Battle_Index[s],a=i.getRoleInfoByIndex(n,t.a_plist),o=i.left_item_list[s];a?(null==o?(o=i.createHeroExhibitionItemByIndex(s,i.panel_role_left),i.left_item_list[s]=o):o.setVisible(!0),o.setData(a),o.addCallBack(function(){this._onClickRoleHead(a,1)}.bind(e))):o&&o.setVisible(!1)},m=1;m<10;++m)u(m);i.name_right.string=Utils.transformNameByServ(t.b_name,t.b_srv_id),i.name_right._forceUpdateRenderData(),t.combat_type==a.Fight_Type.Champion?i.challenge_right.node.active=!1:(i.challenge_right.node.active=!0,i.challenge_right.string=Utils.TI18N("\u9632\u5b88\u65b9"),i.challenge_right.node.color=l.Color.Def),i.atk_label_right.string=t.b_power,i.level_right.string=t.b_lev+Utils.TI18N("\u7ea7");var f=i.name_right.node.getContentSize();i.level_right.node.x=i.name_right.node.x-f.width-10,t.combat_type==a.Fight_Type.Arena?(t.b_rank>0?i.rank_label_right.string=t.b_rank:i.rank_label_right.string=Utils.TI18N("\u6682\u65e0"),i.image_rank_right.active=!0,i.rank_label_right.node.active=!0,i.rank_title_right.node.active=!0):(i.image_rank_right.active=!1,i.rank_label_right.node.active=!1,i.rank_title_right.node.active=!1);for(var p=function(s){var n=l.Right_Role_Battle_Index[s],a=i.getRoleInfoByIndex(n,t.b_plist),o=i.right_item_list[s];a?(null==o?(o=i.createHeroExhibitionItemByIndex(s,i.panel_role_right),i.right_item_list[s]=o):o.setVisible(!0),o.setData(a),o.addCallBack(function(){this._onClickRoleHead(a,2)}.bind(e))):o&&o.setVisible(!1)},g=1;g<10;++g)p(g)}},onHide:function(){},setExtendData:function(t){t&&(this.is_myself=t.is_myself||!1,this.is_collect=t.is_collect||!1,this.is_hot=t.is_hot||!1)},addCallBack:function(t){this._shareCallBack=t},updateLikeBtnRedStatus:function(){},getRoleInfoByIndex:function(t,e){for(var i=0;i<e.length;++i){var s=e[i];if(s.pos==t)return s}return null},createHeroExhibitionItemByIndex:function(t,e){var i=ItemsPool.getInstance().getItem("hero_exhibition_item");i.setRootScale(.5);var s=this.postion_list[t]||cc.v2(0,0);return i.setPosition(s.x,s.y),i.setParent(e),i.setVisible(!0),i.show(),i},_onClickRoleHead:function(t,e){t&&this.data&&this.ctrl.requestVedioHeroData(this.data.id,t.id,e,this.data.a_srv_id,this.data.combat_type)},_onClickInfoBtn:function(){if(this.data){var t={};t.atk_name=this.data.a_name,t.def_name=this.data.b_name,t.hurt_statistics=[],t.vedio_id=this.data.id,t.srv_id=this.data.a_srv_id,t.combat_type=this.data.combat_type;for(var e=1;e<=2;++e){var i={};i.type=e,i.partner_hurts=[],i.partner_hurts=1==e?Utils.deepCopy(this.data.a_plist)||[]:Utils.deepCopy(this.data.b_plist)||[],t.hurt_statistics.push(i)}c.getInstance().openBattleHarmInfoView(!0,t)}},addPlayCallBack:function(t){this._playCallBack=t},onDelete:function(){if(this.left_item_list){for(var t in this.left_item_list)this.left_item_list[t]&&(this.left_item_list[t].deleteMe(),this.left_item_list[t]=null);this.left_item_list=null}if(this.right_item_list){for(var e in this.right_item_list)this.right_item_list[e]&&(this.right_item_list[e].deleteMe(),this.right_item_list[e]=null);this.right_item_list=null}}});cc._RF.pop()},{battle_const:"battle_const",battle_controller:"battle_controller",chat_const:"chat_const",chat_controller:"chat_controller",pathtool:"pathtool",role_controller:"role_controller",timetool:"timetool",vedio_const:"vedio_const",vedio_controller:"vedio_controller",vedio_event:"vedio_event"}],vedio_look_window:[function(t,e,i){"use strict";cc._RF.push(e,"99ffdFAolFPBJURf0PC+9vw","vedio_look_window");var s=t("vedio_item_panel"),n=t("pathtool"),a=t("vedio_controller"),o=t("vedio_const");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=n.getPrefabPath("vedio","vedio_look_panel"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Mini,this.ctrl=a.getInstance(),this._model=this.ctrl.getModel()},initConfig:function(){},openCallBack:function(){var t=this;t.background=t.root_wnd.getChildByName("background"),t.main_container=t.root_wnd.getChildByName("main_container"),t.main_panel=t.main_container.getChildByName("main_panel"),t.title_lb=t.main_panel.getChildByName("win_title").getComponent(cc.Label),t.title_lb.string=Utils.TI18N("\u5f55\u50cf\u8be6\u60c5"),t.cell=new s,t.cell.addCallBack(function(e){t.onShowSharePanel(e)}),t.cell.addPlayCallBack(function(){t.onClickBtnClose()}),t.cell.setPosition(0,0),t.cell.setParent(t.main_panel),t.cell.show(!0)},registerEvent:function(){this.background.on("touchend",function(){this.ctrl.openVedioLookPanel(!1),Utils.playButtonSound(2)},this)},openRootWnd:function(t){this.setData(t)},setData:function(t){this.data=t,this.cell.setData(t)},onShowSharePanel:function(t){t&&this.data&&this.ctrl.openVedioSharePanel(!0,this.data.id,t,function(t){this.updateData(t)}.bind(this),this.data.a_srv_id,this.data.combat_type)},onClickBtnClose:function(){this.ctrl.openVedioLookPanel(!1)},updateData:function(t){this.data&&(o.Share_Btn_Type.eGuildBtn,this.data.share=this.data.share+1,this.cell.setData(this.data))},closeCallBack:function(){this.cell&&(this.cell.deleteMe(),this.cell=null),this.ctrl.openVedioLookPanel(!1)}});cc._RF.pop()},{pathtool:"pathtool",vedio_const:"vedio_const",vedio_controller:"vedio_controller",vedio_item_panel:"vedio_item_panel"}],vedio_main_window:[function(t,e,i){"use strict";cc._RF.push(e,"4aad6uJw3dDlI0AEspLBCTj","vedio_main_window");var s=t("pathtool"),n=t("common_scrollview"),a=t("vedio_item_panel"),o=t("vedio_const"),l=t("common_tab_btn"),r=t("vedio_controller"),c=t("vedio_event"),_=t("role_controller"),h=t("chat_const");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("vedio","vedio_main_window"),this.win_type=WinType.Full,this.ctrl=r.getInstance(),this._model=this.ctrl.getModel()},initConfig:function(){this.req_flag=!1,this.filt_index_list={},this.filt_btn_list=[],this.vedio_data={}},openCallBack:function(){var t=this;t.background=t.root_wnd.getChildByName("background"),t.background.scale=FIT_SCALE,this.loadRes(s.getUIIconPath("bigbg","bigbg_2","jpg"),function(e){t.background.getComponent(cc.Sprite).spriteFrame=e}.bind(this)),t.mainContainer=t.root_wnd.getChildByName("main_container"),t.share_panel=t.mainContainer.getChildByName("share_panel"),t.share_panel.active=!1,t.share_bg=t.share_panel.getChildByName("share_bg"),t.btn_guild=t.share_bg.getChildByName("btn_guild"),t.btn_world=t.share_bg.getChildByName("btn_world"),t.btn_guild.getChildByName("guild_label").getComponent(cc.Label).string=Utils.TI18N("\u5206\u4eab\u5230\u516c\u4f1a\u9891\u9053"),t.btn_world.getChildByName("world_label").getComponent(cc.Label).string=Utils.TI18N("\u5206\u4eab\u5230\u4e16\u754c\u9891\u9053"),t.main_panel=t.mainContainer.getChildByName("main_panel"),t.main_panel.getChildByName("win_title").getComponent(cc.Label).string=Utils.TI18N("\u5f55\u50cf\u9986"),t.like_limit_num=t.main_panel.getChildByName("like_limit_num").getComponent(cc.Label),t.like_limit_num.string="",t.close_btn=t.main_panel.getChildByName("close_btn"),t.collect_btn=t.main_panel.getChildByName("collect_btn"),t.collect_btn.getChildByName("label").getComponent(cc.Label).string=Utils.TI18N("\u4e2a\u4eba\u6536\u85cf"),t.myself_btn=t.main_panel.getChildByName("myself_btn"),t.myself_btn.getChildByName("label").getComponent(cc.Label).string=Utils.TI18N("\u4e2a\u4eba\u8bb0\u5f55"),t.no_vedio_image=t.main_panel.getChildByName("no_vedio_image"),t.arrow=t.main_panel.getChildByName("arrow");var e=t.main_panel.getChildByName("filt_bg");t.filt_label=e.getChildByName("filt_label").getComponent(cc.Label),t.filt_btn=e.getChildByName("filt_btn"),t.filt_lv_btn=t.main_panel.getChildByName("filt_lv_btn"),t.filt_lv_btn.getComponent(cc.Toggle).isChecked=this._model.getFiltLevelFlag(),t.filt_lv_btn.getChildByName("name").getComponent(cc.Label).string=Utils.TI18N("\u7b5b\u9009\u4e34\u8fd1\u7b49\u7ea7");var i=t.main_panel.getChildByName("scrollCon"),o=i.getContentSize(),l=cc.size(o.width-10,o.height-10),r={item_class:a,start_x:0,space_x:0,start_y:0,space_y:3,item_width:620,item_height:374,row:0,col:1,need_dynamic:!0};this.vedio_scrollview=new n,this.vedio_scrollview.createScroll(i,cc.v2(4.5,5),ScrollViewDir.vertical,ScrollViewStartPos.top,l,r),this.createTabBtnList()},_createNewCell:function(){var t=new a;return t.addCallBack(this._onClickShareBtn.bind(this)),t.show(),t},_numberOfCells:function(){return this.vedio_show_data?this.vedio_show_data.length:0},_updateCellByIndex:function(t,e){if(this.vedio_show_data){t.index=e;var i=this.vedio_show_data[e];i&&(this.cur_index&&(this.cur_index==o.Tab_Index.Hot?t.setExtendData({is_hot:!0}):t.setExtendData({})),t.setData(i))}},createTabBtnList:function(){for(var t in this.tabArray=[],Config.video_data.data_vedio){var e=Config.video_data.data_vedio[t];if(1==e.is_show){var i={};i.title=e.name,i.index=e.id,i.sort_id=e.sort_id,this.filt_index_list[e.id]=this.getDefaultFiltIndex(),this.tabArray.push(i)}}this.tabArray.sort(Utils.tableLowerSorter(["sort_id"]))},registerEvent:function(){this.myself_btn.on("click",function(){this.ctrl.openVedioMyselfWindow(!0)},this),this.collect_btn.on("click",function(){Utils.playButtonSound(1),this.ctrl.openVedioCollectWindow(!0)},this),this.addGlobalEvent(c.UpdateTodayLikeNum,function(){this.refreshTodayLikeNum()}.bind(this)),this.addGlobalEvent(c.UpdatePublicVedioEvent,function(t){this.cur_index&&t&&this.cur_index==t&&(this.setData(),this.req_flag=!1)}.bind(this)),this.filt_lv_btn.on("toggle",function(t){Utils.playButtonSound(1),this._model.setFiltLevelFlag(t.isChecked),this.scroll_to_top=!0,this.setData()},this),this.close_btn.on("click",function(){Utils.playButtonSound(2),this.ctrl.openVedioMainWindow(!1)},this),this.share_panel.on("touchend",function(){this.share_panel.active=!1},this),this.btn_world.on("click",function(){if(Utils.playButtonSound(1),this.replay_id){this.ctrl.requestShareVedio(this.replay_id,h.Channel.World,this.srv_id,this.combat_type);var t=this._model.updateVedioData(this.cur_index,this.replay_id,"share",this.share_num);gcore.GlobalEvent.fire(c.UpdateVedioDataEvent,t)}this.replay_id=null,this.srv_id=null,this.combat_type=null,this.share_panel.active=!1},this),this.btn_guild.on("click",function(){if(Utils.playButtonSound(1),0!=_.getInstance().getRoleVo().isHasGuild()){if(this.replay_id){this.ctrl.requestShareVedio(this.replay_id,h.Channel.Gang,this.srv_id,this.combat_type);var t=this._model.updateVedioData(this.cur_index,this.replay_id,"share",this.share_num);gcore.GlobalEvent.fire(c.UpdateVedioDataEvent,t)}this.replay_id=null,this.srv_id=null,this.combat_type=null,this.share_panel.active=!1}else message(Utils.TI18N("\u60a8\u6682\u672a\u52a0\u5165\u516c\u4f1a"))},this),this.filt_btn.on("click",function(){Utils.playButtonSound(1),this._onClickFiltBtn()},this),this.addGlobalEvent(c.OpenCollectViewEvent,function(t){this.mainContainer&&(this.mainContainer.active=1!=t)}.bind(this))},openRootWnd:function(t){var e=this;t=t||o.Tab_Index.Hot;var i=this.main_panel.getChildByName("tab_container").getChildByName("content");this.tab_Btn=[];for(var s=function(t){var s=e.tabArray[t],n=new l;n.setParent(i),n.setTitle(s.title),n.addCallBack(function(){var t=s.index;this._onClickTabBtn(t)}.bind(e)),e.tab_Btn.push(n)},n=0;n<this.tabArray.length;++n)s(n);this.refreshTodayLikeNum();for(var a=0;a<this.tabArray.length;++a){var r=this.tabArray[a];if(t==r.index){this.tab_Btn[a].getToggle().check(),this._onClickTabBtn(r.index);break}}},_onClickTabBtn:function(t){this.cur_index=t,this.filt_lv_btn.active=this.cur_index==o.Tab_Index.Arena;var e=Config.video_data.data_vedio[this.cur_index],i=this.filt_index_list[this.cur_index];if(e){var s=e.evt[i],n=this.getFiltBtnNameByEvt(s);this.filt_label.string=n}this.vedio_data={},this.scroll_to_top=!0,this.cur_index==o.Tab_Index.Elite||(this._model.checkIsReqVedioDataByType(this.cur_index,i)?this.setData():this.ctrl.requestPublicVedioData(this.cur_index,i,1,o.ReqVedioDataNum))},refreshTodayLikeNum:function(){var t=this._model.getTodayLikeNum(),e=0,i=Config.video_data.data_const.likes_limit;i&&(e=i.val);var s=e-t;s<0&&(s=0),this.like_limit_num.string=cc.js.formatStr(Utils.TI18N("\u70b9\u8d5e\u6570:%d/%d"),s,e)},getDefaultFiltIndex:function(){return 0},getFiltBtnNameByEvt:function(t){if(!t)return"";var e=t[0],i="";if("all"==e)i=Utils.TI18N("\u5168\u90e8");else if("rank"==e){var s=t[1],n=t[2];s&&n?i=cc.js.formatStr(Utils.TI18N("%d-%d\u540d"),s,n):n||(i=cc.js.formatStr(Utils.TI18N("%d\u540d\u4ee5\u540e"),s))}else if("cham"==e){var a=t[1];i=Utils.TI18N(o.Cham_Name[a])}else if("lev"==e){var l=t[1],r=t[2];l&&r?i=cc.js.formatStr(Utils.TI18N("%d-%d\u7ea7"),l,r):r||(i=cc.js.formatStr(Utils.TI18N("%d\u7ea7\u4ee5\u4e0a"),l))}return i||""},setData:function(){if(this.cur_index){var t=this.filt_index_list[this.cur_index];if(null!=t){if(this.vedio_data=this._model.getPublicVedioData(this.cur_index,t)||{},this.vedio_show_data=[],this.cur_index==o.Tab_Index.Arena&&this._model.getFiltLevelFlag()){var e=Config.video_data.data_const.lev_interval_uplimit,i=Config.video_data.data_const.lev_interval_lowlimit,s=5;e&&(s=e.val||5);var n=5;i&&(n=i.val||5);for(var a=_.getInstance().getRoleVo(),l=this.vedio_data.vedio_data||[],r=0;r<l.length;++r){var c=this.vedio_data.vedio_data[r],h=c.a_lev-n,d=c.a_lev+s,u=c.b_lev-n,m=c.b_lev+s;(a.lev>=h&&a.lev<=d||a.lev>=u&&a.lev<=m)&&this.vedio_show_data.push(c)}}else this.vedio_show_data=this.vedio_data.vedio_data||[];if(null!=Utils.next(this.vedio_show_data)){var f;if(1==this.scroll_to_top)f=this.cur_index==o.Tab_Index.Hot?{is_hot:!0}:{},this.vedio_scrollview.setData(this.vedio_show_data,this._onClickShareBtn.bind(this),f);else this.vedio_scrollview.resetCurrentItems();this.vedio_scrollview.setVisible(!0),this.no_vedio_image.active=!1,this.scroll_to_top=!1}else this.vedio_scrollview.setVisible(!1),this.vedio_scrollview.setData(this.vedio_show_data,this._onClickShareBtn.bind(this)),this.no_vedio_image.active=!1}}},_onClickShareBtn:function(t,e,i,s,n){this.replay_id=e,this.share_num=i,this.srv_id=s,this.combat_type=n;var a=this.share_panel.convertToNodeSpaceAR(t);a&&(this.share_bg.setPosition(cc.v2(a.x-60,a.y+45)),this.share_panel.active=!0)},_onClickFiltBtn:function(){var t=this,e=this;if(e.cur_index){var i=Config.video_data.data_vedio[this.cur_index];if(!i)return;e.filt_layout||(e.filt_layout=new cc.Node,e.filt_layout.setContentSize(cc.size(676,918)),e.filt_layout.setAnchorPoint(.5,.5),e.filt_layout.setPosition(0,0),e.mainContainer.addChild(e.filt_layout),e.filt_layout.on("touchend",function(){e._onClickFiltBtn()}),e.filt_bg=Utils.createImage(e.filt_layout,null,0,0,cc.v2(1,1),!0,1,!0),e.filt_bg.node.setAnchorPoint(cc.v2(1,1)),this.loadRes(s.getUIIconPath("common","common_1092"),function(t){e.filt_bg.spriteFrame=t}.bind(this)),e.filt_layout.active=!1);for(var n=i.evt||[],a=0;a<e.filt_btn_list.length;++a){e.filt_btn_list[a].node.active=!1}var o=cc.size(150,50),l=cc.size(166,20+n.length*(o.height+0)-0);e.filt_bg.node.setContentSize(l);var r=e.filt_btn.convertToWorldSpaceAR(cc.v2(0,0)),c=e.filt_layout.convertToNodeSpaceAR(r);e.filt_bg.node.setPosition(cc.v2(c.x+22,c.y-22));for(var _=function(i){var a=n[i],l=e.filt_btn_list[i];if(null==l){l={};var r=Utils.createImage(e.filt_bg.node,null,0,0,cc.v2(.5,0),!0,1,!0);l.node=r.node,l.node.setContentSize(o);var c=l.node.addComponent(cc.Button);c.transition=cc.Button.Transition.SCALE,c.duration=.1,c.zoomScale=.9,t.loadRes(s.getUIIconPath("common","common_1046"),function(t){r.spriteFrame=t}.bind(t)),l.node.on("click",function(){this._onClickFiltItem(i)}.bind(t));var _=(new cc.Node).addComponent(cc.Label);_.horizontalAlign=cc.Label.HorizontalAlign.CENTER,_.horizontalAlign=cc.Label.VerticalAlign.CENTER,_.node.y=o.height/2,_.fontSize=22,_.lineHeight=25,_.node.color=new cc.Color(113,40,4),l.node.addChild(_.node),e.filt_btn_list.push(l),l.name=_}l.name.string=e.getFiltBtnNameByEvt(a),l.node.active=!0;var h=10+(i+1)*(o.height+0);l.node.setPosition(cc.v2(-83,-h))},h=0;h<n.length;++h)_(h);e.filt_layout.active=!e.filt_layout.active}},_onClickFiltItem:function(t){if(this.cur_index){var e=Config.video_data.data_vedio[this.cur_index];if(e){this.filt_index_list[this.cur_index]=t;var i=e.evt[t],s=this.getFiltBtnNameByEvt(i);this.filt_label.string=s,this._onClickFiltBtn(),this.cur_index!=o.Tab_Index.Elite&&(this.vedio_data={},this.scroll_to_top=!0,this._model.checkIsReqVedioDataByType(this.cur_index,t)?this.setData():this.ctrl.requestPublicVedioData(this.cur_index,t,1,o.ReqVedioDataNum))}}},closeCallBack:function(){if(this.tab_Btn)for(var t=0;t<this.tab_Btn.length;++t)this.tab_Btn&&(this.tab_Btn[t].deleteMe(),this.tab_Btn[t]=null);this.tab_Btn=null,this.vedio_scrollview&&(this.vedio_scrollview.DeleteMe(),this.vedio_scrollview=null),this.ctrl.openVedioMainWindow(!1)}});cc._RF.pop()},{chat_const:"chat_const",common_scrollview:"common_scrollview",common_tab_btn:"common_tab_btn",pathtool:"pathtool",role_controller:"role_controller",vedio_const:"vedio_const",vedio_controller:"vedio_controller",vedio_event:"vedio_event",vedio_item_panel:"vedio_item_panel"}],vedio_model:[function(t,e,i){"use strict";cc._RF.push(e,"70062pr0GVInaTKlun3vtGf","vedio_model");var s=t("mainui_controller"),n=t("mainui_const");cc.Class({extends:BaseClass,ctor:function(){},properties:{},initConfig:function(){this.today_like_num=0,this.today_like_is_full=!1,this.all_vedio_data={},this.filt_lv_flag=!0},setPublicVedioData:function(t){if(t){this.all_vedio_data[t.type]||(this.all_vedio_data[t.type]={}),this.all_vedio_data[t.type][t.cond_type]||(this.all_vedio_data[t.type][t.cond_type]={}),this.all_vedio_data[t.type][t.cond_type].vedio_data||(this.all_vedio_data[t.type][t.cond_type].vedio_data=[]);for(var e=0;e<t.replay_list.length;++e){var i=t.replay_list[e];this.all_vedio_data[t.type][t.cond_type].vedio_data.push(i)}t.len>this.all_vedio_data[t.type][t.cond_type].vedio_data.length?this.all_vedio_data[t.type][t.cond_type].is_full=!1:this.all_vedio_data[t.type][t.cond_type].is_full=!0}},getPublicVedioData:function(t,e){var i={};return t&&this.all_vedio_data[t]&&(i=this.all_vedio_data[t][e]||{}),i},setTodayLikeNum:function(t){this.today_like_num=t;var e=!1;this.today_like_is_full=!0;var i=Config.video_data.data_const.likes_limit;i&&i.val>t&&(e=!0,this.today_like_is_full=!1),s.getInstance().setFunctionTipsStatus(n.icon.vedio,e)},getTodayLikeNum:function(){return this.today_like_num},checkIsReqVedioDataByType:function(t,e){return!(!this.all_vedio_data[t]||!this.all_vedio_data[t][e])},getFiltLevelFlag:function(){return this.filt_lv_flag},setFiltLevelFlag:function(t){this.filt_lv_flag=t},checkTodayLikeIsFull:function(){return this.today_like_is_full},updateVedioData:function(t,e,i,s){var n;for(var a in this.all_vedio_data){var o=this.all_vedio_data[a];for(var l in o)for(var r=o[l],c=0;c<r.vedio_data.length;c++){var _=r.vedio_data[c];_.id==e&&(_[i]=s,n=_)}}return n}});cc._RF.pop()},{mainui_const:"mainui_const",mainui_controller:"mainui_controller"}],vedio_myself_window:[function(t,e,i){"use strict";cc._RF.push(e,"1e92d8s1o5NprGS157NZ+TU","vedio_myself_window");var s=t("pathtool"),n=t("common_scrollview"),a=t("vedio_controller"),o=t("vedio_const"),l=t("vedio_item_panel"),r=t("vedio_event"),c=t("role_controller"),_=t("chat_const");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("vedio","vedio_collect_window"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.big,this.ctrl=a.getInstance(),this._model=this.ctrl.getModel()},initConfig:function(){},openCallBack:function(){this.background=this.root_wnd.getChildByName("background");var t=this.root_wnd.getChildByName("main_container");this.main_container=t,this.share_panel=this.root_wnd.getChildByName("share_panel"),this.share_panel.active=!1,this.share_bg=this.share_panel.getChildByName("share_bg"),this.btn_guild=this.share_bg.getChildByName("btn_guild"),this.btn_world=this.share_bg.getChildByName("btn_world"),this.btn_cross=this.share_bg.getChildByName("btn_cross"),this.share_bg.getChildByName("guild_label").getComponent(cc.Label).string=Utils.TI18N("\u5206\u4eab\u5230\u516c\u4f1a\u9891\u9053"),this.share_bg.getChildByName("world_label").getComponent(cc.Label).string=Utils.TI18N("\u5206\u4eab\u5230\u4e16\u754c\u9891\u9053"),t.getChildByName("win_title").getComponent(cc.Label).string=Utils.TI18N("\u4e2a\u4eba\u8bb0\u5f55"),this.num_txt=t.getChildByName("num_txt").getComponent(cc.Label),this.num_txt.fontSize=22,this.num_txt.string=Utils.TI18N("\u8bb0\u5f55\u81ea\u5df1\u524d30\u6761PVP\u6311\u6218\u8bb0\u5f55"),this.no_vedio_image=t.getChildByName("no_vedio_image"),this.no_vedio_image.getChildByName("label").getComponent(cc.Label).string=Utils.TI18N("\u6682\u65e0\u5f55\u50cf\u6536\u85cf");var e=t.getChildByName("vedio_list"),i=e.getContentSize(),s={item_class:l,start_x:0,space_x:0,start_y:0,space_y:5,item_width:620,item_height:374,row:0,col:1,need_dynamic:!0};this.vedio_scrollview=new n,this.vedio_scrollview.createScroll(e,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,i,s)},registerEvent:function(){this.background.on("touchend",function(){Utils.playButtonSound(2),this.ctrl.openVedioMyselfWindow(!1)},this),this.btn_guild.on("click",function(){if(Utils.playButtonSound(1),0!=c.getInstance().getRoleVo().isHasGuild()){if(this.replay_id){this.ctrl.requestShareVedio(this.replay_id,_.Channel.Gang,this.srv_id,this.combat_type),this._model.updateVedioData(null,this.replay_id,"share",this.share_num);var t=this.updateVedioDataById(this.replay_id,"share",this.share_num);gcore.GlobalEvent.fire(r.UpdateVedioDataEvent,t)}this.replay_id=null,this.srv_id=null,this.combat_type=null,this.share_panel.active=!1}else message(Utils.TI18N("\u60a8\u6682\u672a\u52a0\u5165\u516c\u4f1a"))},this),this.btn_world.on("click",function(){if(Utils.playButtonSound(1),this.replay_id){this.ctrl.requestShareVedio(this.replay_id,_.Channel.World,this.srv_id,this.combat_type),this._model.updateVedioData(null,this.replay_id,"share",this.share_num);var t=this.updateVedioDataById(this.replay_id,"share",this.share_num);gcore.GlobalEvent.fire(r.UpdateVedioDataEvent,t)}this.replay_id=null,this.srv_id=null,this.combat_type=null,this.share_panel.active=!1},this),this.share_panel.on("touchend",function(){this.share_panel.active=!1},this),this.addGlobalEvent(r.UpdateMyselfVedioEvent,function(t){this.setData(t)}.bind(this)),this.addGlobalEvent(r.CollectSuccessVedioEvent,function(t){if(this.data){this._model.updateVedioData(null,t,"is_collect",1);var e=this.updateVedioDataById(t,"is_collect",1);gcore.GlobalEvent.fire(r.UpdateVedioDataEvent,e)}}.bind(this))},openRootWnd:function(t){this.ctrl.requestMyVedioByType(o.MyVedio_Type.Myself),gcore.GlobalEvent.fire(r.OpenCollectViewEvent,!0)},setData:function(t){t&&null!=Utils.next(t)?(this.no_vedio_image.active=!1,this.data=t,this.vedio_scrollview.setData(this.data,this._onClickShareBtn.bind(this),{is_myself:!0})):this.no_vedio_image.active=!0},_onClickShareBtn:function(t,e,i,s,n){this.replay_id=e,this.share_num=i,this.srv_id=s,this.combat_type=n;var a=this.share_panel.convertToNodeSpaceAR(t);a&&(this.share_bg.setPosition(cc.v2(a.x-60,a.y+45)),this.share_panel.active=!0)},updateVedioDataById:function(t,e,i){if(this.data){for(var s={},n=0;n<this.data.length;++n){var a=this.data[n];if(a.id==t){a[e]=i,s=a;break}}return s}},closeCallBack:function(){this.vedio_scrollview&&(this.vedio_scrollview.DeleteMe(),this.vedio_scrollview=null),gcore.GlobalEvent.fire(r.OpenCollectViewEvent,!1),this.ctrl.openVedioMyselfWindow(!1)}});cc._RF.pop()},{chat_const:"chat_const",common_scrollview:"common_scrollview",pathtool:"pathtool",role_controller:"role_controller",vedio_const:"vedio_const",vedio_controller:"vedio_controller",vedio_event:"vedio_event",vedio_item_panel:"vedio_item_panel"}],vedio_share_window:[function(t,e,i){"use strict";cc._RF.push(e,"cf33bCeZf1L44ATUjztcXQN","vedio_share_window");var s=t("pathtool"),n=t("vedio_controller"),a=t("role_controller"),o=t("chat_const"),l=t("vedio_const");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("vedio","vedio_share_panel"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Tips,this.ctrl=n.getInstance()},initConfig:function(){},openCallBack:function(){this.background=this.root_wnd.getChildByName("background"),this.share_panel=this.root_wnd.getChildByName("share_panel"),this.share_bg=this.share_panel.getChildByName("share_bg"),this.btn_guild=this.share_bg.getChildByName("btn_guild"),this.btn_world=this.share_bg.getChildByName("btn_world"),this.btn_cross=this.share_bg.getChildByName("btn_cross"),this.share_bg.getChildByName("guild_label").getComponent(cc.Label).string=Utils.TI18N("\u5206\u4eab\u5230\u516c\u4f1a\u9891\u9053"),this.share_bg.getChildByName("world_label").getComponent(cc.Label).string=Utils.TI18N("\u5206\u4eab\u5230\u4e16\u754c\u9891\u9053"),this.share_bg.getChildByName("cross_label").getComponent(cc.Label).string=Utils.TI18N("\u5206\u4eab\u5230\u8de8\u670d\u9891\u9053")},registerEvent:function(){this.background.on("touchend",function(){Utils.playButtonSound(2),this.onClickCloseBtn()},this),this.btn_guild.on("touchend",this.onClickGuildBtn,this),this.btn_world.on("touchend",this.onClickWorldBtn,this)},onClickCloseBtn:function(){this.ctrl.openVedioSharePanel(!1)},onClickGuildBtn:function(){Utils.playButtonSound(1),this.replay_id&&(0!=a.getInstance().getRoleVo().isHasGuild()?(this.ctrl.requestShareVedio(this.replay_id,o.Channel.Gang,this.srv_id,this.combat_type),this.callback&&this.callback(l.Share_Btn_Type.eGuildBtn),this.replay_id=null,this.onClickCloseBtn()):message(Utils.TI18N("\u60a8\u6682\u672a\u52a0\u5165\u516c\u4f1a")))},onClickWorldBtn:function(){Utils.playButtonSound(1),this.replay_id&&(this.ctrl.requestShareVedio(this.replay_id,o.Channel.World,this.srv_id,this.combat_type),this.callback&&this.callback(l.Share_Btn_Type.eWorldBtn),this.replay_id=null,this.onClickCloseBtn())},openRootWnd:function(t){if(t&&t.replay_id){this.replay_id=t.replay_id,this.callback=t.callback,this.srv_id=t.srv_id,this.combat_type=t.combat_type;var e=t.world_pos,i=this.share_panel.convertToNodeSpaceAR(e);i&&this.share_bg.setPosition(cc.v2(i.x-60,i.y+45))}},closeCallBack:function(){this.ctrl.openVedioSharePanel(!1)}});cc._RF.pop()},{chat_const:"chat_const",pathtool:"pathtool",role_controller:"role_controller",vedio_const:"vedio_const",vedio_controller:"vedio_controller"}],viewclass:[function(t,e,i){"use strict";cc._RF.push(e,"d63b5L717NIk7RrUbhm1PXP","viewclass");var s=t("loadermanager");window.ViewClass=cc.Class({extends:BaseClass,ctor:function(){this.active_status=!0,this.base_view_event_list={},this.res_list={},this.update_timers={},this.parent=null,this.ticks={},this.rleasePrefab=!0},seekChild:function(t,e,i){if(t&&("string"==typeof t||t instanceof cc.Node)){if("string"==typeof t&&(e&&cc.js.isChildClassOf(e,cc.Component)&&(i=e),e=t,t=this.root_wnd),e&&cc.js.isChildClassOf(e,cc.Component)&&(i=e),t.name===e)return t;var s=t.getChildren();for(var n in s){var a=this.seekChild(s[n],e,i);if(a)return i?a.getComponent(i):a}}},loadRes:function(t,e){this.res_list[t]?this.root_wnd&&this.root_wnd.isValid?e(this.res_list[t]):console.log("\u8282\u70b9\u5df2\u9500\u6bc1",this.prefabPath):s.getInstance().loadRes(t,function(i){(this.isCache||!this.is_close&&!this.delete)&&(i instanceof cc.Node||(this.res_list[t]=i),this.root_wnd&&this.root_wnd.isValid?e(i):console.log("\u8282\u70b9\u5df2\u9500\u6bc1",this.prefabPath))}.bind(this))},setParent:function(t){this.parent=t},deleteMe:function(){for(var t in cc.log("deleteMe",this.prefabPath),this.removeGlobalEvent(),this.root_wnd&&!this.isCache&&(this.root_wnd.destroy(),this.root_wnd=null),this.mainloop_timer&&gcore.Timer.del(this.mainloop_timer),this.update_timers)this.update_timers[t]&&gcore.Timer.del(this.update_timers[t].timer),this.update_timers[t]=null;for(var e in this.res_list)s.getInstance().releaseRes(e);this.isCache||this.rleasePrefab&&s.getInstance().releasePrefab(this.prefabPath)},addGlobalEvent:function(t,e){if(t)return this.base_view_event_list[t]?void 0:(this.base_view_event_list[t]=gcore.GlobalEvent.bind(t,function(){if(e){for(var t=arguments.length,i=new Array(t),s=0;s<t;s++)i[s]=arguments[s];e.apply(this,i)}}.bind(this)),this.base_view_event_list[t])},removeGlobalEvent:function(t){if(t)this.base_view_event_list[t]&&(gcore.GlobalEvent.unbind(this.base_view_event_list[t]),delete this.base_view_event_list[t]);else{for(var e in this.base_view_event_list)this.base_view_event_list[e]&&gcore.GlobalEvent.unbind(this.base_view_event_list[e]);this.base_view_event_list=null}},startUpdate:function(t,e,i){if(t=t>0?t:-1,i=i||100,t>0){if(e){var s=0,n=null;for(var a in this.update_timers){if(!this.update_timers[a]){n=a;break}s+=1}return n||(n="udpatetimer_"+s),this.update_timers[n]={},this.update_timers[n].finish=0,this.update_timers[n].times=t,this.update_timers[n].timer=gcore.Timer.set(function(t,e){t&&t(this.update_timers[e].finish),this.update_timers[e]&&(this.update_timers[e].finish+=1,this.update_timers[e].finish==this.update_timers[e].times&&(gcore.Timer.del(this.update_timers[e].timer),this.update_timers[e]=null))}.bind(this,e,n),i,t),this.update_timers[n].timer}}else if(!this.mainloop_timer)return this.mainloop_timer=gcore.Timer.set(function(){this.update&&this.update(.2)}.bind(this),200,-1),this.mainloop_timer},stopUpdate:function(t){if(t)for(var e in this.update_timers)this.update_timers[e]&&this.update_timers[e].timer===t&&(gcore.Timer.del(this.update_timers[e].timer),this.update_timers[e]=null);else this.mainloop_timer&&(gcore.Timer.del(this.mainloop_timer),this.mainloop_timer=null)},isOpen:function(){return!(!this.root_wnd||!this.root_wnd.active)},addTicket:function(t,e,i){e="number"==typeof parseInt(e)?1e3*e:0;var s=gcore.Timer.set(function(t){t&&t()}.bind(this,t),e,1);i&&(this.ticks[i]=s)},delTicker:function(t){this.ticks[t]&&(gcore.Timer.del(this.ticks[t]),delete this.ticks[t])},hasTicket:function(t){return!!this.ticks[t]},seekChildByTag:function(t,e){if(t){if(t.ui_tag===e)return t;var i=t.getChildren();for(var s in i){var n=this.seekChildByTag(i[s],e);if(n)return n}}}}),cc._RF.pop()},{loadermanager:"loadermanager"}],viewmanager:[function(t,e,i){"use strict";cc._RF.push(e,"1c8c29JRFBKR7m8lJHrGmyb","viewmanager"),window.ViewManager=cc.Class({cotr:function(){},properties:{node_list:[],self:null},statics:{instance:null},addSceneNode:function(t,e){this.node_list[t]=e},addToSceneNode:function(t,e){if(t){var i=this.node_list[e];i&&i.addChild(t)}},getSceneNode:function(t){return null==t&&(t=SCENE_TAG.win),this.node_list[t]}}),ViewManager.getInstance=function(){return ViewManager.instance||(ViewManager.instance=new ViewManager),ViewManager.instance},e.exports=ViewManager,cc._RF.pop()},{}],vip_award_item_panel:[function(t,e,i){"use strict";cc._RF.push(e,"1209eZd8zVBcqK+u0AjUOix","vip_award_item_panel");var s=t("pathtool");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("vip","vip_award_item")},initConfig:function(){},initPanel:function(){this.label=this.seekChild("label",cc.RichText)},registerEvent:function(){},setData:function(t){this.data=t,this.root_wnd&&this.onShow()},onShow:function(){if(null!=this.data){var t=this.data.replace(/289b14/,"ffef42");this.label.string=t;var e=this.data.match(/\'([^\']*)\'/);if(e&&e[1]){var i=s.getItemRes(e[1]);this.loadRes(i,function(t){this.label.spriteFrame=t}.bind(this))}}},onHide:function(){},onDelete:function(){}});cc._RF.pop()},{pathtool:"pathtool"}],vip_award_window:[function(t,e,i){"use strict";cc._RF.push(e,"8c585iLMDVETqxZ8ThjFnoN","vip_award_window");var s=t("pathtool"),n=t("vip_award_item_panel"),a=t("common_scrollview"),o=t("vip_controller"),l=t("vip_event");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("vip","vip_award_window"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Big,this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){this.BtnState=1},openCallBack:function(){this.background=this.root_wnd.getChildByName("background"),this.background.scale=FIT_SCALE,this.main_container=this.root_wnd.getChildByName("main_container"),this.vip_bg=this.main_container.getChildByName("background").getComponent(cc.Sprite);var t=s.getBigBg("give_vip_bg",null,"vip");this.loadRes(t,function(t){this.vip_bg.spriteFrame=t}.bind(this)),this.time_lab=this.main_container.getChildByName("time_lab").getComponent(cc.Label),this.giftCon_nd=this.main_container.getChildByName("giftCon"),this.close_btn=this.main_container.getChildByName("close_btn"),this.get_btn=this.main_container.getChildByName("get_btn"),this.get_btn_btn=this.get_btn.getComponent(cc.Button),this.get_btn_lab=this.get_btn.getChildByName("Label").getComponent(cc.Label),this.get_btn_lab.string=Utils.TI18N("\u514d\u8d39\u9886\u53d6"),this.common_goods_item=ItemsPool.getInstance().getItem("backpack_item"),this.common_goods_item.initConfig(!1,.8,null,!0),this.common_goods_item.setParent(this.main_container),this.common_goods_item.setPosition(-120,-200),this.common_goods_item.show();var e=this.giftCon_nd.getContentSize(),i={item_class:n,start_x:0,space_x:0,start_y:0,space_y:0,item_width:400,item_height:36,row:1,col:1,need_dynamic:!0};this.info_scroll=new a,this.info_scroll.createScroll(this.giftCon_nd,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,e,i,cc.v2(.5,.5))},registerEvent:function(){Utils.onTouchEnd(this.close_btn,function(){this.ctrl.openVipAwardWindow(!1)}.bind(this),2),Utils.onTouchEnd(this.get_btn,function(){var t=o.getInstance().getModel().getGiveVipInfo();if(t){var e=t.time-gcore.SmartSocket.getTime();0==t.state&&e>0||this.ctrl.sender16731()}}.bind(this),1),this.addGlobalEvent(l.GIVE_VIP_UPDATE,function(){this.updateData()}.bind(this))},updateData:function(){var t=o.getInstance().getModel().getGiveVipInfo(),e=Config.vip_data.data_vip_const.vip_give_reward,i=gdata("vip_data","data_get_reward",[1]);if(null!=t&&null!=i&&null!=e){var s=i.spe_desc;this.info_scroll.setData(s),this.common_goods_item.setData({bid:e.val[0][0],num:e.val[0][1]});var n=t.time-gcore.SmartSocket.getTime();this.setCountDownTime(this.time_lab,n)}},setCountDownTime:function(t,e){var i=t.node;if(i)if(i.stopAllActions(),e>0){this.updateBtnState(0),this.setTimeFormatString(t,e);var s=cc.callFunc(function(){(e-=1)<=0?(i.stopAllActions(),t.string="",this.updateBtnState(1)):(this.setTimeFormatString(t,e),this.updateBtnState(0))}.bind(this));i.runAction(cc.repeatForever(cc.sequence(cc.delayTime(1),s)))}else this.time_lab.node.stopAllActions(),this.time_lab.string="",this.updateBtnState(1)},setTimeFormatString:function(e,i){var s=t("timetool");i>0?e.string=s.getTimeForFunction(i):(e.node.stopAllActions(),e.string="")},updateBtnState:function(t){if(this.get_btn_btn&&this.BtnState!=t){this.BtnState=t;var e=o.getInstance().getModel().getGiveVipInfo();if(e){var i=e.time-gcore.SmartSocket.getTime();0==e.state&&i>0?(this.get_btn_btn.interactable=!1,this.get_btn_btn.enableAutoGrayEffect=!0,this.get_btn_lab.node.getComponent(cc.LabelOutline).enabled=!1):(this.get_btn_btn.interactable=!0,this.get_btn_btn.enableAutoGrayEffect=!1,this.get_btn_lab.node.getComponent(cc.LabelOutline).enabled=!0)}this.model.setGiveVipStatus()}},openRootWnd:function(t){this.updateData()},closeCallBack:function(){this.common_goods_item&&(this.common_goods_item.deleteMe(),this.common_goods_item=null),this.info_scroll&&(this.info_scroll.deleteMe(),this.info_scroll=null),this.time_lab&&this.time_lab.node.stopAllActions(),this.ctrl.openVipAwardWindow(!1)}});cc._RF.pop()},{common_scrollview:"common_scrollview",pathtool:"pathtool",timetool:"timetool",vip_award_item_panel:"vip_award_item_panel",vip_controller:"vip_controller",vip_event:"vip_event"}],vip_controller:[function(t,e,i){"use strict";cc._RF.push(e,"fc753Pu5ktBOZoyuaPREqO7","vip_controller");var s=t("role_controller"),n=t("vip_event"),a=cc.Class({extends:BaseController,ctor:function(){},initConfig:function(){var e=t("vip_model");this.model=new e,this.model.initConfig(),this.vip_redpoint_status={},this.vip_privilege_redpoint={},this.is_first=!0},getModel:function(){return this.model},registerEvents:function(){null==this.login_event_success&&(this.login_event_success=gcore.GlobalEvent.bind(EventId.EVT_ROLE_CREATE_SUCCESS,function(){gcore.GlobalEvent.unbind(this.login_event_success),this.login_event_success=null,this.role_vo=s.getInstance().getRoleVo(),this.role_vo&&null==this.role_assets_event&&(this.role_assets_event=this.role_vo.bind(EventId.UPDATE_ROLE_ATTRIBUTE,function(t,e){if("vip_lev"==t){this.setIsFirst(!0);var i=null==this.model.getGetGiftList()[this.role_vo.vip_lev]&&this.getIsFirst();this.setTipsVIPStstus(VIPREDPOINT.VIP_TAB,i),gcore.GlobalEvent.fire(n.UPDATA_ITEM_REDPOINT)}}.bind(this)))},this)),null==this.re_link_game_event&&(this.re_link_game_event=gcore.GlobalEvent.bind(EventId.EVT_RE_LINK_GAME,function(){},this))},registerProtocals:function(){this.RegisterProtocal(16700,this.handle16700),this.RegisterProtocal(16710,this.handle16710),this.RegisterProtocal(16711,this.handle16711),this.RegisterProtocal(16712,this.handle16712),this.RegisterProtocal(16713,this.handle16713),this.RegisterProtocal(21005,this.handle21005),this.RegisterProtocal(21006,this.handle21006),this.RegisterProtocal(24501,this.handle24501),this.RegisterProtocal(24502,this.handle24502),this.RegisterProtocal(16707,this.handle16707),this.RegisterProtocal(16708,this.handle16708),this.RegisterProtocal(16730,this.handle16730),this.RegisterProtocal(16731,this.handle16731),this.RegisterProtocal(21020,this.handle21020)},setPrivilegeRedpoint:function(t,e){this.vip_privilege_redpoint[t]=e},getPrivilegeRedpoint:function(t){return this.vip_privilege_redpoint[t]},getIsFirst:function(){return this.is_first},setIsFirst:function(t){this.is_first=t},sender16700:function(){this.SendProtocal(16700,{})},handle16700:function(t){gcore.GlobalEvent.fire(n.UPDATE_CHARGE_LIST,t.list)},sender21005:function(){this.SendProtocal(21005,{})},handle21005:function(t){gcore.GlobalEvent.fire(n.THREE_RECHARGE,t)},sender21006:function(){this.SendProtocal(21006,{})},handle21006:function(t){t&&(this.model.setDailyGiftData(t.first_gift),gcore.GlobalEvent.fire(n.DAILY_GIFT_INFO))},sender24501:function(t){var e={};e.id=t,this.SendProtocal(24501,e)},handle24501:function(t){t.msg&&message(t.msg)},sender24502:function(){this.SendProtocal(24502,{})},handle24502:function(t){if(t){this.model.setPrivilegeList(t.list);var e=this.model.getPrivilegeRedStatus();this.setTipsVIPStstus(VIPREDPOINT.PRIVILEGE,e),gcore.GlobalEvent.fire(n.PRIVILEGE_INFO)}},sender16707:function(){this.SendProtocal(16707,{})},handle16707:function(t){var e=!1;1==t.status&&(e=!0),this.model.setMonthCard(t.status),this.setTipsVIPStstus(VIPREDPOINT.MONTH_CARD,e),gcore.GlobalEvent.fire(n.SUPRE_CARD_GET,t.status)},sender16708:function(){this.SendProtocal(16708,{})},handle16708:function(t){message(t.msg)},sender16710:function(){this.SendProtocal(16710,{})},handle16710:function(t){this.model.setGetGiftList(t.list),null==this.role_vo&&(this.role_vo=s.getInstance().getRoleVo());var e=null==this.model.getGetGiftList()[this.role_vo.vip_lev]&&this.getIsFirst();this.setTipsVIPStstus(VIPREDPOINT.VIP_TAB,e),gcore.GlobalEvent.fire(n.UPDATA_ITEM_REDPOINT)},setTipsVIPStstus:function(e,i){this.vip_redpoint_status[e]=i;var s=!1;for(var n in this.vip_redpoint_status){if(1==this.vip_redpoint_status[n]){s=!0;break}}var a=t("mainui_controller"),o=t("mainui_const");a.getInstance().setFunctionTipsStatus(o.icon.charge,s)},sender16711:function(t){var e={};e.lev=t,this.SendProtocal(16711,e)},handle16711:function(t){message(t.msg)},sender16712:function(){this.SendProtocal(16712,{})},handle16712:function(t){this.charge_sum=t.charge_sum,this.model.setAccList(t.list),gcore.GlobalEvent.fire(n.ACC_RECHARGE_INFO,t)},getChargeSum:function(){return this.charge_sum||0},sender16713:function(t){var e={};e.id=t,this.SendProtocal(16713,e)},handle16713:function(t){message(t.msg)},sender16730:function(){this.SendProtocal(16730,{})},handle16730:function(t){this.model.setGiveVipInfo(t),this.model.setGiveVipStatus(),gcore.GlobalEvent.fire(n.GIVE_VIP_UPDATE)},sender16731:function(){this.SendProtocal(16731,{})},handle16731:function(t){message(t.msg),1==t.code&&(this.openVipAwardWindow(),this.sender16730())},openVipMainWindow:function(t,e,i,s){if(t){if(0==IS_SHOW_CHARGE)return void message(Utils.TI18N("\u529f\u80fd\u6682\u672a\u5f00\u653e\uff0c\u656c\u8bf7\u671f\u5f85"));var n=gdata("charge_data","data_constant",["open_lv"]);if(n&&this.role_vo&&this.role_vo.lev<n.val)return void message(n.desc);this.vip_window||(this.vip_window=Utils.createClass("vip_main_window")),e=e||1,this.vip_window&&this.vip_window.open(e,i),s&&(this.deleteCallFunc=s)}else this.vip_window&&(this.vip_window.close(),this.vip_window=null,this.deleteCallFunc&&(this.deleteCallFunc(),this.deleteCallFunc=null))},openVipAwardWindow:function(t){1==t?(this.vip_award_window||(this.vip_award_window=Utils.createClass("vip_award_window",this)),this.vip_award_window&&0==this.vip_award_window.isOpen()&&this.vip_award_window.open()):this.vip_award_window&&(this.vip_award_window.close(),this.vip_award_window=null)},changeMainWindowTab:function(t){this.vip_window&&this.vip_window.changeTabView(t)},handle21020:function(e){var i=!1;1==e.code&&(i=!0);var s=t("mainui_controller"),n=t("mainui_const");s.getInstance().setFunctionTipsStatus(n.icon.one_gift,i)}});e.exports=a,cc._RF.pop()},{mainui_const:"mainui_const",mainui_controller:"mainui_controller",role_controller:"role_controller",vip_event:"vip_event",vip_model:"vip_model"}],vip_event:[function(t,e,i){"use strict";cc._RF.push(e,"cbd1fKllrxH3rNf2E0eV4ax","vip_event"),e.exports={UPDATE_GET_LIST:"UPDATE_GET_LIST",UPDATE_CHARGE_LIST:"UPDATE_CHARGE_LIST",THREE_RECHARGE:"THREE_RECHARGE",ACC_RECHARGE_INFO:"ACC_RECHARGE_INFO",DAILY_GIFT_INFO:"DAILY_GIFT_INFO",PRIVILEGE_INFO:"PRIVILEGE_INFO",SUPRE_CARD_GET:"SUPRE_CARD_GET",UPDATA_ITEM_REDPOINT:"UPDATA_ITEM_REDPOINT",UPDATA_QQ_BALANCE:"UPDATA_QQ_BALANCE",GIVE_VIP_UPDATE:"GIVE_VIP_UPDATE"},cc._RF.pop()},{}],vip_label_item_panel:[function(t,e,i){"use strict";cc._RF.push(e,"07411s34wZMtoKRqTygjx0Z","vip_label_item_panel");var s=t("pathtool");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("vip","vip_label_item")},initConfig:function(){},initPanel:function(){this.label=this.seekChild("label",cc.RichText)},registerEvent:function(){},setData:function(t){this.data=t,this.root_wnd&&this.onShow()},onShow:function(){if(null!=this.data){this.label.string=this.data;var t=this.data.match(/\'([^\']*)\'/);if(t&&t[1]){var e=s.getItemRes(t[1]);this.loadRes(e,function(t){this.label.spriteFrame=t}.bind(this))}}},onHide:function(){},onDelete:function(){}});cc._RF.pop()},{pathtool:"pathtool"}],vip_main_tab_panel:[function(t,e,i){"use strict";cc._RF.push(e,"7bddarY3iNOOrtTBMbEXoYE","vip_main_tab_panel");var s=t("pathtool");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("vip","vip_tab_btn")},initConfig:function(){this.size=cc.size(155,130)},initPanel:function(){var t=this.seekChild("container");this.tips_nd=this.seekChild(t,"tab_tips"),this.tips_nd.active=!1,this.red_num_lb=this.seekChild(t,"red_num",cc.Label),this.red_num_lb.node.active=!1,this.select_bg_sp=this.seekChild(t,"select_bg",cc.Sprite),this.select_bg_sp.node.active=!1,this.unselect_bg_sp=this.seekChild(t,"unselect_bg",cc.Sprite),this.title_lb=this.seekChild(t,"title",cc.Label),this.title_img_sp=this.seekChild(t,"title_img",cc.Sprite),this.title_img_sp.node.active=!1,null!=this.status&&this.setSelect(this.status),null!=this.red_status&&this.showRedTips(this.red_status,this.num)},registerEvent:function(){this.root_wnd.on(cc.Node.EventType.TOUCH_END,function(){this.tab_type&&this.callback&&this.callback(this.tab_type)},this)},setData:function(t){this.data=t,this.root_wnd&&this.onShow()},onShow:function(){var t,e,i;null!=this.data&&(this.tab_type=this.data.index,this.title_lb.string=this.data.label,this.tab_type==VIPTABCONST.CHARGE?(t=s.getUIIconPath("vip","vip_tab10"),e=s.getUIIconPath("vip","vip_tab1"),i=s.getUIIconPath("vip","txt_cn_vip_tab1")):this.tab_type==VIPTABCONST.ACC_CHARGE?(t=s.getUIIconPath("vip","vip_tab20"),e=s.getUIIconPath("vip","vip_tab2"),i=s.getUIIconPath("vip","txt_cn_vip_tab2")):this.tab_type==VIPTABCONST.VIP?(t=s.getUIIconPath("vip","vip_tab30"),e=s.getUIIconPath("vip","vip_tab3"),i=s.getUIIconPath("vip","txt_cn_vip_tab3")):this.tab_type==VIPTABCONST.DAILY_GIFT?(t=s.getUIIconPath("vip","vip_tab40"),e=s.getUIIconPath("vip","vip_tab4"),i=s.getUIIconPath("vip","txt_cn_vip_tab4")):this.tab_type==VIPTABCONST.PRIVILEGE&&(t=s.getUIIconPath("vip","vip_tab50"),e=s.getUIIconPath("vip","vip_tab5"),i=s.getUIIconPath("vip","txt_cn_vip_tab5")),t&&this.loadRes(t,function(t){this.unselect_bg_sp.spriteFrame=t}.bind(this)),e&&this.loadRes(e,function(t){this.select_bg_sp.spriteFrame=t}.bind(this)),i&&this.loadRes(i,function(t){this.title_img_sp.spriteFrame=t}.bind(this)))},setSelect:function(t){this.status=t,null!=this.root_wnd&&(this.select_bg_sp.node.active=t,this.unselect_bg_sp.node.active=!t,this.title_img_sp.node.active=t,this.title_lb.node.active=!t)},showRedTips:function(t,e){this.red_status=t,this.num=e,null!=this.root_wnd&&(this.red_tips_status=t,this.tips_nd.active=t,e&&e>0?(this.red_num_lb.node.active=!0,this.red_num_lb.string=e):this.red_num_lb.node.active=!1)},getRedTipsStatus:function(){return this.red_tips_status},addCallBack:function(t){this.callback=t},onHide:function(){},onDelete:function(){}});cc._RF.pop()},{pathtool:"pathtool"}],vip_main_window:[function(t,e,i){"use strict";cc._RF.push(e,"0c6d2vJR5xCS4NBNmWNfC+a","vip_main_window");var s=t("pathtool"),n=t("vip_controller"),a=t("role_controller"),o=t("common_scrollview"),l=t("vip_panel_item"),r=t("vip_event"),c=t("welfare_event"),_=t("welfare_controller"),h=t("vip_main_tab_panel");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("vip","vip_main_window"),this.win_type=WinType.Full},initConfig:function(){this.ctrl=n.getInstance(),this.model=this.ctrl.getModel(),this.role_vo=a.getInstance().getRoleVo(),this.tab_array=[{label:Utils.TI18N("\u5145\u503c"),index:VIPTABCONST.CHARGE,status:!0,notice:""},{label:Utils.TI18N("VIP"),index:VIPTABCONST.VIP,status:!0,notice:""},{label:Utils.TI18N("\u6bcf\u65e5\u793c\u5305"),index:VIPTABCONST.DAILY_GIFT,status:!0,notice:""},{label:Utils.TI18N("\u7279\u6743\u5546\u57ce"),index:VIPTABCONST.PRIVILEGE,status:!0,notice:""}],this.tab_btn_list={},this.view_list={},this.cur_index=null,this.cur_tab=null},openCallBack:function(){this.background_nd=this.seekChild("background"),this.background_nd.scale=FIT_SCALE,this.loadRes(s.getBigBg("bigbg_23"),function(t){this.background_nd.getComponent(cc.Sprite).spriteFrame=t}.bind(this)),this.mainContainer_nd=this.seekChild("main_container"),this.main_panel_nd=this.seekChild("main_panel"),this.table_container_nd=this.seekChild("tab_container"),this.tab_scrollview_sv=this.seekChild(this.table_container_nd,"scrollview",cc.ScrollView),this.sv_content_nd=this.seekChild(this.tab_scrollview_sv.node,"content");for(var t=1;t<=this.tab_array.length;t++){var e=this.tab_array[t-1],i=this.tab_btn_list[e.index];null==i&&((i=new h).show(),i.addCallBack(this.changeTabView.bind(this)),i.setParent(this.sv_content_nd),this.tab_btn_list[e.index]=i,0==IS_SHOW_CHARGE&&i.setVisible(!1)),i.setPosition(78+155*(t-1)-333,0),i.setData(e)}var n=Config.vip_data.data_get_reward;for(var a in n){var r=gdata("vip_data","data_get_reward",[a]);null==this.ctrl.getPrivilegeRedpoint(r.lev)&&r.lev<=this.role_vo.vip_lev&&this.ctrl.setPrivilegeRedpoint(r.lev,!0)}this.title_con_nd=this.seekChild(this.mainContainer_nd,"titleCon"),this.loadingbar_pb=this.seekChild(this.title_con_nd,"loadingbar",cc.ProgressBar),this.loadingbar_pb.progress=0,this.exp_lb=this.seekChild(this.title_con_nd,"exp",cc.Label),this.exp_lb.string="0/0",this.title_bg_nd=this.seekChild(this.title_con_nd,"bg"),this.loadRes(s.getBigBg("bigbg_24"),function(t){this.title_bg_nd.getComponent(cc.Sprite).spriteFrame=t}.bind(this)),this.now_vip_cr=this.seekChild(this.title_con_nd,"now_vip").getComponent("CusRichText"),this.next_vip_cr=this.seekChild(this.title_con_nd,"next_vip").getComponent("CusRichText"),this.charge_num_cr=this.seekChild(this.title_con_nd,"charge_num").getComponent("CusRichText"),this.yuan_nd=this.seekChild(this.title_con_nd,"yuan"),this.sprite_6_nd=this.seekChild(this.title_con_nd,"Sprite_6"),this.sprite_6_0_nd=this.seekChild(this.title_con_nd,"Sprite_6_0"),this.qq_balance=this.seekChild(this.title_con_nd,"qq_balance"),this.balance_num=this.seekChild(this.qq_balance,"balance_num",cc.Label),this.balance_num.string="0",this.banner_image_sp=this.seekChild(this.mainContainer_nd,"banner_image",cc.Sprite),this.container_1_nd=this.seekChild(this.main_panel_nd,"container_1"),this.container_nd=this.seekChild(this.main_panel_nd,"container"),this.tabLayer_nd=this.seekChild(this.container_nd,"tabLayer");var c=this.tabLayer_nd.getContentSize(),_=cc.size(c.width+10,c.height),d={item_class:l,start_x:0,space_x:0,start_y:0,space_y:0,item_width:153,item_height:79,row:0,col:1,need_dynamic:!1};this.tab_scrollview=new o,this.tab_scrollview.createScroll(this.tabLayer_nd,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,_,d,cc.v2(.5,.5)),this.tab_scrollview.addEndCallBack(function(){var t=this.role_vo.vip_lev;t>=5&&this.tab_scrollview.jumpToMove_2(cc.v2(0,183*(t-4)+2*(t-4)),.2)}.bind(this)),this.close_btn=this.seekChild(this.main_panel_nd,"close_btn"),this.next_vip_desc_sp=this.seekChild(this.title_con_nd,"next_vip_desc",cc.Sprite),this.updateBar(),this.setVisibleVIPTabRedPoint(),this.resetTitlePos(),this.setTabRedStatus(this.model.getIsGetAcc(),VIPTABCONST.ACC_CHARGE),this.updateDailyAwardRed(),this.updatePrivilegeTabRedPoint(),0==IS_SHOW_CHARGE&&(this.title_con_nd.active=!1,this.banner_image_sp.node.active=!1)},registerEvent:function(){this.close_btn.on(cc.Node.EventType.TOUCH_END,function(){this.ctrl.openVipMainWindow(!1)},this),this.role_vo&&null==this.role_update_event&&(this.role_update_event=this.role_vo.bind(EventId.UPDATE_ROLE_ATTRIBUTE,function(t,e){"vip_lev"==t?this.updateBar():"vip_exp"==t&&this.updateBar()},this)),this.addGlobalEvent(r.ACC_RECHARGE_INFO,function(){this.setTabRedStatus(this.model.getIsGetAcc(),VIPTABCONST.ACC_CHARGE)},this),this.addGlobalEvent(r.SUPRE_CARD_GET,function(){this.setVisibleVIPTabRedPoint()},this),this.addGlobalEvent(c.Update_Daily_Awawd_Data,function(){this.updateDailyAwardRed()},this),this.addGlobalEvent(r.PRIVILEGE_INFO,function(){this.updatePrivilegeTabRedPoint()},this),this.addGlobalEvent(r.UPDATA_QQ_BALANCE,function(t){this.balance_num&&(this.balance_num.string=t.toString())},this),this.addGlobalEvent(r.UPDATA_ITEM_REDPOINT,function(t){this.setVisibleVIPTabRedPoint()},this)},openRootWnd:function(t,e){t=t||1;this.sub_type=e,0==IS_SHOW_CHARGE&&(t=1),1==t&&"QQ_SDK"==PLATFORM_TYPR&&1==USE_SDK&&SDK.checkBalance(),this.changeTabView(t)},changeTabView:function(t){this.cur_index!=t&&(1==t&&"QQ_SDK"==PLATFORM_TYPR&&1==USE_SDK?this.qq_balance.active=!0:this.qq_balance.active=!1,null!=this.cur_tab&&this.cur_tab.setSelect(!1),null!=this.pre_panel&&this.pre_panel.setVisibleStatus&&this.pre_panel.setVisibleStatus(!1),this.cur_index=t,this.cur_tab=this.tab_btn_list[t],null!=this.cur_tab&&(this.cur_tab.setSelect(!0),this.pre_panel=this.createSubPanel(this.cur_tab.tab_type||t),null!=this.pre_panel&&this.pre_panel.setVisibleStatus&&this.pre_panel.setVisibleStatus(!0),t==VIPTABCONST.PRIVILEGE&&this.cur_tab.getRedTipsStatus()&&(this.updatePrivilegeTabRedPoint(),this.ctrl.setTipsVIPStstus(VIPREDPOINT.PRIVILEGE,!1))))},createSubPanel:function(e){var i=this.view_list[e];this.container_1_nd.active=e==VIPTABCONST.ACC_CHARGE||e==VIPTABCONST.CHARGE||e==VIPTABCONST.DAILY_GIFT||e==VIPTABCONST.PRIVILEGE,this.container_nd.active=e==VIPTABCONST.VIP,this.banner_image_sp.node.active=e==VIPTABCONST.DAILY_GIFT||e==VIPTABCONST.PRIVILEGE,this.title_con_nd.active=e==VIPTABCONST.VIP||e==VIPTABCONST.ACC_CHARGE||e==VIPTABCONST.CHARGE;var n=null;if(e==VIPTABCONST.DAILY_GIFT?n=s.getBigBg("txt_cn_bigbg_24"):e==VIPTABCONST.PRIVILEGE&&(n=s.getBigBg("txt_cn_bigbg_23")),n&&this.loadRes(n,function(t){this.banner_image_sp.spriteFrame=t}.bind(this)),null==i){if(e==VIPTABCONST.VIP){var a=t("vip_panel");if((i=new a).show(),i.setData(this.sub_type),i.setParent(this.container_nd),this.tab_scrollview){var o=Config.vip_data.data_get_reward,l=[],r=0;r=this.role_vo.vip_lev<=9?10:10==this.role_vo.vip_lev?12:11==this.role_vo.vip_lev?13:Config.vip_data.data_get_reward_length;for(var c=0;c<r;c++)l[c]=o[c];this.tab_scrollview.setData(l,function(t){var e=this.tab_scrollview.getItemList();if(e)for(var s in e){var n=e[s];if(n.select_index=t.getData().lev,t.getData().lev==n.data.lev){this.ctrl.setPrivilegeRedpoint(s,!1);this.ctrl.getPrivilegeRedpoint(s);n.setVisibleRedStatus(!1),n.setSelect(!0),n.setNormal(!1),n.setTextColor(new cc.Color(169,95,15,255),new cc.Color(104,69,42,255)),i.setData(t.getData().lev)}else n.setSelect(!1),n.setNormal(!0),n.setTextColor(new cc.Color(255,230,201,255),new cc.Color(255,223,183,255))}}.bind(this))}}else if(e==VIPTABCONST.ACC_CHARGE){var _=t("accCharge_panel");(i=new _).show(),i.setParent(this.container_1_nd)}else if(e==VIPTABCONST.CHARGE){var h=t("charge_panel");(i=new h).show(),i.setParent(this.container_1_nd)}else if(e==VIPTABCONST.DAILY_GIFT){var d=t("daily_gift_panel");(i=new d).show(),i.setParent(this.container_1_nd)}else if(e==VIPTABCONST.PRIVILEGE){var u=t("privilege_panel");(i=new u).show(),i.setParent(this.container_1_nd)}this.view_list[e]=i}return i},updateBar:function(){var t=Config.vip_data.data_get_reward[this.role_vo.vip_lev],e=Config.vip_data.data_get_reward_length-1,i=Config.vip_data.data_get_reward[this.role_vo.vip_lev+1];t?i?(this.loadingbar_pb.progress=(this.role_vo.vip_exp+this.role_vo.vip_card_exp)/i.gold,this.exp_lb.string=this.role_vo.vip_exp+this.role_vo.vip_card_exp+"/"+i.gold,this.next_vip_cr.setNum(this.role_vo.vip_lev+1),this.charge_num_cr.setNum(i.gold-(this.role_vo.vip_exp+this.role_vo.vip_card_exp))):(this.loadingbar_pb.progress=1,this.exp_lb.string=t.gold+"/"+t.gold,this.next_vip_cr.setNum(this.role_vo.vip_lev),this.charge_num_cr.setNum(0)):(this.loadingbar_pb.progress=1,this.exp_lb.string=Config.vip_data.data_get_reward[e].gold+"/"+Config.vip_data.data_get_reward[e].gold,this.charge_num_cr.setNum(0),this.next_vip_cr.setNum(this.role_vo.vip_lev)),this.resetTitlePos(),28*String(this.charge_num_cr.getNum()).length>0&&(this.yuan_nd.x=this.charge_num_cr.x+28*String(this.charge_num_cr.getNum()).length),this.now_vip_cr.setNum(this.role_vo.vip_lev);var n=1;if(n=this.role_vo.vip_lev+1>=e?e:this.role_vo.vip_lev+1,0!=IS_SHOW_CHARGE){var a=s.getBigBg(cc.js.formatStr("vip_lev_desc_%d",n),null,"vip");this.loadRes(a,function(t){this.next_vip_desc_sp.spriteFrame=t}.bind(this))}},resetTitlePos:function(){this.yuan_nd.x=this.charge_num_cr.node.x+28*String(this.charge_num_cr.getNum()).length-25,this.sprite_6_nd.x=this.yuan_nd.x+this.yuan_nd.getContentSize().width+5,this.sprite_6_0_nd.x=this.sprite_6_nd.x+this.sprite_6_nd.getContentSize().width+10,this.next_vip_cr.node.x=this.sprite_6_0_nd.x+this.sprite_6_0_nd.getContentSize().width-5},setVisibleVIPTabRedPoint:function(){var t=this.model.getMonthCard(),e=null==this.model.getGetGiftList()[this.role_vo.vip_lev]&&this.ctrl.getIsFirst(),i=t||e;this.setTabRedStatus(i,VIPTABCONST.VIP)},updatePrivilegeTabRedPoint:function(){var t=this.model.getPrivilegeRedStatus();this.setTabRedStatus(t,VIPTABCONST.PRIVILEGE)},updateDailyAwardRed:function(){var t=!1;0==_.getInstance().getModel().getDailyAwardStatus()&&(t=!0),this.setTabRedStatus(t,VIPTABCONST.DAILY_GIFT)},setTabRedStatus:function(t,e,i){var s=this.tab_btn_list[e];s&&s.showRedTips(t,i)},closeCallBack:function(){for(var t in this.view_list)this.view_list[t]&&(this.view_list[t].deleteMe(),this.view_list[t]=null);if(this.view_list=null,this.tab_btn_list){for(var t in this.tab_btn_list)this.tab_btn_list[t]&&(this.tab_btn_list[t].deleteMe(),this.tab_btn_list[t]=null);this.tab_btn_list=null}this.tab_scrollview&&(this.tab_scrollview.deleteMe(),this.tab_scrollview=null),this.role_vo&&(this.role_update_event&&(this.role_vo.unbind(this.role_update_event),this.role_update_event=null),this.role_vo=null),this.ctrl.openVipMainWindow(!1)}});cc._RF.pop()},{accCharge_panel:void 0,charge_panel:"charge_panel",common_scrollview:"common_scrollview",daily_gift_panel:"daily_gift_panel",pathtool:"pathtool",privilege_panel:"privilege_panel",role_controller:"role_controller",vip_controller:"vip_controller",vip_event:"vip_event",vip_main_tab_panel:"vip_main_tab_panel",vip_panel:"vip_panel",vip_panel_item:"vip_panel_item",welfare_controller:"welfare_controller",welfare_event:"welfare_event"}],vip_model:[function(t,e,i){"use strict";cc._RF.push(e,"e7f2aNIdZxO9pXzD/6us16P","vip_model");var s=t("vip_event");cc.Class({extends:BaseClass,ctor:function(){},properties:{},initConfig:function(){this.get_list={},this.daily_gift={},this.privilege_list={}},setGetGiftList:function(t){if(t&&Utils.getArrLen(t)>0)for(var e in t){var i=t[e];this.get_list[i.lev]=i.lev}gcore.GlobalEvent.fire(s.UPDATE_GET_LIST)},getGetGiftList:function(){return this.get_list||{}},setAccList:function(t){this.acc_list=t},getAccList:function(){return this.acc_list},checkGiftList:function(t){for(var e in this.get_list){if(this.get_list[e]==t)return!0}return!1},getGiftListVip:function(){var t=1,e=[];if(Config.vip_data.data_vip_icon)for(var i in Config.vip_data.data_vip_icon){var s=gdata("vip_data","data_vip_icon",[i]);e.push(s)}for(var i in e.sort(Utils.tableLowerSorter(["vip_lev"])),e){s=e[i];if(!this.checkGiftList(s.vip_lev)){t=s.vip_lev;break}}return t},getIsGetAcc:function(){if(this.acc_lsit&&null!=Utils.next(this.acc_list)){var t=0;for(var e in this.acc_list){var i=this.acc_list[e];if(1==i.status)return!0;0!=i.status&&2!=i.status||(t+=1)}if(t==Utils.getArrLen(this.acc_list))return!1}return!1},setDailyGiftData:function(t){this.daily_gift=t||{}},getDailyGiftBuyCountById:function(t){var e=0;for(var i in this.daily_gift){var s=this.daily_gift[i];if(s.id==t){e=s.count;break}}return e},setPrivilegeList:function(t){this.privilege_list=t||{}},getPrivilegeDataById:function(t){for(var e in this.privilege_list)if(this.privilege_list[e].id==t)return this.privilege_list[e]},getPrivilegeRedStatus:function(){var t=!1;if(!this.privilege_flag)for(var e in t=!0,this.privilege_list)if(1==this.privilege_list[e].status){t=!1;break}return t},setPrivilegeOpenFlag:function(t){this.privilege_flag=t},setMonthCard:function(t){this.monthCard=t},getMonthCard:function(){return this.monthCard=this.monthCard||0,1==this.monthCard},setGiveVipInfo:function(t){this.giveVipInfo=t},getGiveVipInfo:function(){return this.giveVipInfo},setGiveVipStatus:function(){var e=this.getGiveVipInfo(),i=!1;if(e){var s=e.time-gcore.SmartSocket.getTime();0==e.state&&s<=0&&(i=!0)}this.giveVipRedStatus=i;var n=t("mainui_controller"),a=t("mainui_const");n.getInstance().setFunctionTipsStatus(a.icon.give_vip,i)},getGiveVipStatus:function(){return null!=this.giveVipRedStatus&&this.giveVipRedStatus}});cc._RF.pop()},{mainui_const:"mainui_const",mainui_controller:"mainui_controller",vip_event:"vip_event"}],vip_panel_item:[function(t,e,i){"use strict";cc._RF.push(e,"ed8e8GRoQJOnL5TjbtyfMX1","vip_panel_item");var s=t("pathtool"),n=t("vip_controller");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("vip","vip_panel_item")},initConfig:function(){this.role_vo=t("role_controller").getInstance().getRoleVo(),this.ctrl=n.getInstance(),this.select_index=null},initPanel:function(){if(this.container_nd=this.seekChild("container"),this.text_vip_lb=this.seekChild(this.container_nd,"VIP",cc.Label),this.text_reward_lb=this.seekChild(this.container_nd,"text_reward",cc.Label),this.normal_nd=this.seekChild(this.container_nd,"normal"),this.select_nd=this.seekChild(this.container_nd,"select"),this.select_nd.active=!1,this.red_point_nd=this.seekChild(this.container_nd,"red_point"),this.red_point_nd.active=!1,this.select_index=this.role_vo.vip_lev,this.data){this.role_vo.vip_lev==this.data.lev?(this.setSelect(!0),this.setNormal(!1),this.setTextColor(new cc.Color(169,95,15,255),new cc.Color(104,69,42,255))):this.setTextColor(new cc.Color(255,230,201,255),new cc.Color(255,223,183,255));var t=this.ctrl.getPrivilegeRedpoint(this.data.lev+1);t=1==t;var e=this.ctrl.getModel().checkGiftList(this.data.lev);this.data.lev!=this.role_vo.vip_lev&&1!=e||(t=!1),this.setVisibleRedStatus(t)}},registerEvent:function(){this.root_wnd.on(cc.Node.EventType.TOUCH_END,function(){this.callback&&this.callback(this)},this)},setData:function(t){this.data=t,this.root_wnd&&this.onShow()},onShow:function(){if(null!=this.data){var t=this.data;null!=this.select_index&&(this.select_index==this.data.lev?(this.setSelect(!0),this.setNormal(!1),this.setTextColor(new cc.Color(169,95,15,255),new cc.Color(104,69,42,255))):(this.setSelect(!1),this.setNormal(!0),this.setTextColor(new cc.Color(255,230,201,255),new cc.Color(255,223,183,255)))),this.text_vip_lb.string="VIP"+t.lev,t.desc?this.text_reward_lb.string=t.desc:this.text_reward_lb.string=""}},setNormal:function(t){this.normal_nd.active=t},setSelect:function(t){this.select_nd.active=t},setTextColor:function(t,e){this.text_vip_lb.node.color=t,this.text_reward_lb.node.color=e},onHide:function(){},addCallBack:function(t){this.callback=t},getData:function(){return this.data},setVisibleRedStatus:function(t){this.red_point_nd.active=t},onDelete:function(){}});cc._RF.pop()},{pathtool:"pathtool",role_controller:"role_controller",vip_controller:"vip_controller"}],vip_panel:[function(t,e,i){"use strict";cc._RF.push(e,"3ba6fK/WPlDb7Cx2tWlpg+g","vip_panel");var s=t("pathtool"),n=t("vip_controller"),a=t("role_controller"),o=t("vip_event"),l=t("common_scrollview"),r=t("vip_label_item_panel");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("vip","vip_panel")},initConfig:function(){this.ctrl=n.getInstance(),this.model=this.ctrl.getModel(),this.role_vo=a.getInstance().getRoleVo(),this.item_list={},this.desc_list={}},initPanel:function(){this.main_container_nd=this.seekChild("main_container"),this.chargeCon_nd=this.seekChild(this.main_container_nd,"chargeCon"),this.goods_scroll_nd=this.seekChild(this.chargeCon_nd,"goods_scroll"),this.giftCon_nd=this.seekChild(this.chargeCon_nd,"giftCon"),this.buy_btn_nd=this.seekChild(this.chargeCon_nd,"buy_btn"),this.buy_btn_nd.active=!0,this.buy_complete_nd=this.seekChild(this.chargeCon_nd,"buy_complete"),this.buy_complete_nd.active=!1,this.buy_btn_lb=this.seekChild(this.buy_btn_nd,"buy_btn_label",cc.Label),this.buy_btn_sp=this.seekChild(this.buy_btn_nd,"buy_price",cc.Sprite),this.buy_red_nd=this.seekChild(this.buy_btn_nd,"red"),this.buy_red_nd.active=!1,this.title_lb=this.seekChild(this.chargeCon_nd,"title",cc.Label),this.old_price_rt=this.seekChild(this.chargeCon_nd,"old_price",cc.RichText),this.buy_price_sp=this.seekChild(this.buy_btn_nd,"buy_price",cc.Sprite),this.sprite_1_nd=this.seekChild(this.main_container_nd,"Sprite_1"),this.sprite_1_sp=this.seekChild(this.main_container_nd,"Sprite_1",cc.Sprite),this.loadRes(s.getUIIconPath("vip","vipbg5"),function(t){this.sprite_1_sp.spriteFrame=t}.bind(this)),this.supre_good_con_nd=this.seekChild(this.sprite_1_nd,"good_con");var t=this.supre_good_con_nd.getContentSize(),e={item_class:"backpack_item",start_x:0,space_x:0,start_y:0,space_y:0,item_width:.6*BackPackItem.Width,item_height:.6*BackPackItem.Height,row:1,col:0,scale:.6};this.item_scrollview=new l,this.item_scrollview.createScroll(this.supre_good_con_nd,cc.v2(0,0),ScrollViewDir.horizontal,ScrollViewStartPos.top,t,e,cc.v2(.5,.5));t=this.goods_scroll_nd.getContentSize(),e={item_class:"backpack_item",start_x:0,space_x:0,start_y:0,space_y:10,item_width:.65*BackPackItem.Width,item_height:.8*BackPackItem.Height,row:1,col:0,scale:.65};this.reward_scrollview=new l,this.reward_scrollview.createScroll(this.goods_scroll_nd,cc.v2(0,0),ScrollViewDir.horizontal,ScrollViewStartPos.top,t,e,cc.v2(.5,.5));t=this.giftCon_nd.getContentSize(),e={item_class:r,start_x:0,space_x:0,start_y:0,space_y:0,item_width:400,item_height:30,row:1,col:1,need_dynamic:!0};this.info_scroll=new l,this.info_scroll.createScroll(this.giftCon_nd,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,t,e,cc.v2(.5,.5)),this.supre_card_get_nd=this.seekChild(this.sprite_1_nd,"btn_get"),this.supre_card_get_btn=this.seekChild(this.sprite_1_nd,"btn_get",cc.Button),this.supre_card_get_nd.active=!1,this.supre_card_get_lb=this.seekChild(this.supre_card_get_nd,"Text_3_0",cc.Label),this.supre_card_get_lb.string="\u9886\u53d6",this.supre_card_get_red_nd=this.seekChild(this.supre_card_get_nd,"red_point"),this.supre_card_get_red_nd.active=!1,this.des_labellist={},this.red_line_nd=this.seekChild(this.old_price_rt.node,"red_line"),this.desc_rt=this.seekChild(this.main_container_nd,"desc_label",cc.RichText),this.role_vo.vip_lev>Config.vip_data.data_get_reward_length-1?this.setData(Config.vip_data.data_get_reward_length-1):this.setData(this.role_vo.vip_lev)},registerEvent:function(){this.buy_btn_nd.on(cc.Node.EventType.TOUCH_END,function(){var t=this.role_vo.vip_lev,e=this.role_vo.is_vip;if(0==t&&1==e)if(0==this.config.lev)this.ctrl.sender16711(this.index);else{var i=cc.js.formatStr("\u672a\u8fbe\u5230VIP%s",this.config.lev);message(i)}else if(this.config)if(this.config.lev>t){i=cc.js.formatStr("\u672a\u8fbe\u5230VIP%s",this.config.lev);message(i)}else this.ctrl.sender16711(this.index)},this),this.addGlobalEvent(o.UPDATE_GET_LIST,function(){null!=this.model.getGetGiftList()[this.index]?(this.buy_price_sp.node.active=!1,this.buy_btn_nd.active=!1,this.buy_complete_nd.active=!0):(this.buy_price_sp.node.active=!0,this.buy_btn_nd.active=!0,this.buy_complete_nd.active=!1),this.updateRed()},this),this.role_vo&&null==this.role_update_event&&(this.role_update_event=this.role_vo.bind(EventId.UPDATE_ROLE_ATTRIBUTE,function(t,e){this.timer=gcore.Timer.set(function(){"vip_lev"==t&&this.updateRed()}.bind(this),1e3*Math.random(),1)},this)),this.addGlobalEvent(o.SUPRE_CARD_GET,function(t){this.supre_card_get_nd.active=!0,1==t?(Utils.setGreyButton(this.supre_card_get_btn,!1),this.supre_card_get_lb.string="\u9886\u53d6",this.supre_card_get_lb.node.color=new cc.Color(113,40,4),this.supre_card_get_red_nd.active=!0):(this.supre_card_get_red_nd.active=!1,0==t?(Utils.setGreyButton(this.supre_card_get_btn),this.supre_card_get_btn.interactable=!0,this.supre_card_get_lb.string="\u5f85\u6fc0\u6d3b",this.supre_card_get_lb.node.color=new cc.Color(113,40,4)):(Utils.setGreyButton(this.supre_card_get_btn),this.supre_card_get_lb.string="\u5df2\u9886\u53d6",this.supre_card_get_lb.node.color=new cc.Color(255,255,255)))},this),this.supre_card_get_nd.on("click",function(){this.ctrl.sender16708()},this),this.ctrl.sender16707(),this.ctrl.sender16710(),this.ctrl.setIsFirst(!1)},updateRed:function(){var t=this.model.getGetGiftList();this.index==this.role_vo.vip_lev&&null==t[this.index]&&this.ctrl.getIsFirst()?this.buy_red_nd.active=!0:this.buy_red_nd.active=!1},setData:function(t){this.index=t,this.root_wnd&&this.onShow()},onShow:function(){if(null!=this.index){var t=this.index,e=gdata("vip_data","data_get_reward",[t]),i=[],n=gdata("charge_data","data_supre_reward_data",[t]).reward;for(var a in n){var o=n[a];(h={}).bid=o[0],h.num=o[1],i.push(h)}this.item_scrollview.setData(i),this.item_scrollview.addEndCallBack(function(){var t=this.item_scrollview.getItemList();for(var e in t)t[e]&&t[e].setDefaultTip()}.bind(this)),this.config=e,this.title_lb.string=Utils.TI18N("VIP"+t+"\u7279\u6743");var l=gdata("item_data","data_assets_label2id","gold"),r=s.getItemRes(l),c=cc.js.formatStr(Utils.TI18N("\u7d2f\u8ba1\u5145\u503c<color=#249013>%s </c><img src='%s'/>\u5373\u53ef\u4eab\u53d7\u4ee5\u4e0b\u7279\u6743"),this.config.gold,l);this.desc_rt.string=c,this.loadRes(r,function(t){this.desc_rt.spriteFrame=t}.bind(this));var _=e.items;i=[];for(var a in _){var h;o=_[a];(h={}).bid=o[0],h.num=o[1],i.push(h)}this.reward_scrollview.setData(i,null,{scale:.65,is_show_tips:!0});var d=e.spe_desc;this.info_scroll.setData(d);var u=Utils.getItemConfig(e.old_price[0][0]).icon,m=s.getItemRes(u);this.old_price_rt.string=cc.js.formatStr(Utils.TI18N("\u539f\u4ef7<img src='%s'/>%s"),u,e.old_price[0][1]),this.loadRes(m,function(t){this.old_price_rt.spriteFrame=t}.bind(this)),this.buy_btn_lb.string=cc.js.formatStr(Utils.TI18N("%d \u8d2d\u4e70"),e.price[0][1]),this.loadRes(s.getItemRes(Utils.getItemConfig(e.old_price[0][0]).icon),function(t){this.buy_btn_sp.spriteFrame=t}.bind(this));var f=this.model.getGetGiftList();f&&null!=f[t]?(this.buy_price_sp.node.active=!1,this.buy_btn_nd.active=!1,this.buy_complete_nd.active=!0):(this.buy_price_sp.node.active=!0,this.buy_btn_nd.active=!0,this.buy_complete_nd.active=!1),this.updateRed()}},clearItemList:function(){if(this.item_list)for(var t in this.item_list){var e=this.item_list[t];e&&e.setVisible(!1)}},setVisibleStatus:function(t){this.setVisible(t)},onHide:function(){},onDelete:function(){for(var t in this.item_list)this.item_list[t]&&(this.item_list[t].deleteMe(),this.item_list[t]=null);this.item_list=null,this.role_vo&&null!=this.role_update_event&&(this.role_vo.unbind(this.role_update_event),this.role_update_event=null),this.role_vo=null,this.item_scrollview&&this.item_scrollview.DeleteMe(),this.item_scrollview=null,this.info_scroll&&this.info_scroll.DeleteMe(),this.info_scroll=null}});cc._RF.pop()},{common_scrollview:"common_scrollview",pathtool:"pathtool",role_controller:"role_controller",vip_controller:"vip_controller",vip_event:"vip_event",vip_label_item_panel:"vip_label_item_panel"}],voyage_const:[function(t,e,i){"use strict";var s,n,a,o,l;function r(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}cc._RF.push(e,"e03baPrxglD5IVgnmIp5tS2","voyage_const");var c={Order_Status:{Unget:1,Underway:2,Finish:3},Order_Rarity:{Normal:0,Excellent:1,Uncommon:2,Epic:3,Legend:4,Eternity:5}};c.Order_Rarity_Res=(r(s={},c.Order_Rarity.Normal,"voyage_1006"),r(s,c.Order_Rarity.Excellent,"voyage_1005"),r(s,c.Order_Rarity.Uncommon,"voyage_1004"),r(s,c.Order_Rarity.Epic,"voyage_1003"),r(s,c.Order_Rarity.Legend,"voyage_1002"),r(s,c.Order_Rarity.Eternity,"voyage_1001"),s),c.Order_Rarity_Color=(r(n={},c.Order_Rarity.Normal,new cc.Color(66,75,84,255)),r(n,c.Order_Rarity.Excellent,new cc.Color(35,119,1,255)),r(n,c.Order_Rarity.Uncommon,new cc.Color(6,79,147,255)),r(n,c.Order_Rarity.Epic,new cc.Color(126,6,147,255)),r(n,c.Order_Rarity.Legend,new cc.Color(147,86,6,255)),r(n,c.Order_Rarity.Eternity,new cc.Color(161,1,1,255)),n),c.Order_Status_Color=(r(a={},c.Order_Status.Unget,new cc.Color(37,85,5,255)),r(a,c.Order_Status.Underway,new cc.Color(37,85,5,255)),r(a,c.Order_Status.Finish,new cc.Color(113,40,4,255)),a),c.Chose_Hero_PosX=(r(o={},1,[319]),r(o,2,[255,383]),r(o,3,[191,319,447]),r(o,4,[127,255,383,511]),r(o,5,[63,191,319,447,575]),o),c.Condition_Icon_PosX=(r(l={},1,[0]),r(l,2,[-38,38]),r(l,3,[-76,0,76]),r(l,4,[-114,-38,38,114]),r(l,5,[-152,-76,0,76,152]),l),e.exports=c,cc._RF.pop()},{}],voyage_controller:[function(t,e,i){"use strict";var s;function n(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}cc._RF.push(e,"168fbzQKWtAJJKuVGIu0CSp","voyage_controller");var a=t("role_controller"),o=t("voyage_event"),l=cc.Class((n(s={extends:BaseController,ctor:function(){},initConfig:function(){var e=t("voyage_model");this.model=new e,this.model.initConfig()},getModel:function(){return this.model},registerEvents:function(){null==this.init_role_event&&(this.init_role_event=gcore.GlobalEvent.bind(EventId.EVT_ROLE_CREATE_SUCCESS,function(){gcore.GlobalEvent.unbind(this.init_role_event),this.init_role_event=null},this)),null==this.re_link_game_event&&(this.re_link_game_event=gcore.GlobalEvent.bind(EventId.EVT_RE_LINK_GAME,function(){},this))},requestVoyageInfo:function(){this.SendProtocal(23800,{})},requestReceiveOrder:function(t,e){var i={};i.order_id=t,i.assign_ids=e,this.SendProtocal(23802,i)},requestFinishOrder:function(t,e){var i={};i.order_id=t,i.type=e,this.SendProtocal(23803,i)},requestRefreshOrder:function(){this.SendProtocal(23804,{})},requestActivityStatus:function(){this.SendProtocal(23805,{})},registerProtocals:function(){this.RegisterProtocal(23800,this.handle23800),this.RegisterProtocal(23801,this.handle23801),this.RegisterProtocal(23802,this.handle23802),this.RegisterProtocal(23803,this.handle23803),this.RegisterProtocal(23804,this.handle23804),this.RegisterProtocal(23805,this.handle23805),this.RegisterProtocal(23820,this.handle23820),this.RegisterProtocal(23821,this.handle23821)},handle23800:function(t){t.order_list&&this.model.setOrderList(t.order_list),t.free_times&&this.model.setFreeTimes(t.free_times),t.coin_times&&this.model.setCoinTimes(t.coin_times),gcore.GlobalEvent.fire(o.UpdateVoyageDataEvent),gcore.GlobalEvent.fire(o.UpdateVoyageRedEvent)},handle23801:function(t){t&&(this.model.updateOneOrderData(t),gcore.GlobalEvent.fire(o.UpdateVoyageRedEvent))},handle23802:function(t){message(t.msg),1==t.flag&&this.openVoyageDispatchWindow(!1)},handle23803:function(t){message(t.msg),1==t.flag&&t.order_id&&(this.model.deleteOneOrderData(t.order_id),gcore.GlobalEvent.fire(o.DeleteOrderDataEvent),gcore.GlobalEvent.fire(o.UpdateVoyageRedEvent))},handle23804:function(t){message(t.msg)},handle23805:function(t){t.flag&&(this.model.setActivityStatus(t.flag),gcore.GlobalEvent.fire(o.UpdateActivityStatusEvent))},send23820:function(){this.SendProtocal(23820,{})},handle23820:function(t){},send23821:function(){this.SendProtocal(23821,{})},handle23821:function(t){this.model.setFirstFresh(1!=t.flag)},openVoyageMainWindow:function(t,e){if(1==t){if(!this.checkVoyageIsOpen(e))return;this.voyage_main_window||(this.voyage_main_window=Utils.createClass("voyage_main_window"),this.voyage_main_window.open())}else this.voyage_main_window&&(this.voyage_main_window.close(),this.voyage_main_window=null)},getVoyageMainRoot:function(){if(this.voyage_main_window)return this.voyage_main_window.root_wnd},openVoyageDispatchWindow:function(t,e){1==t?this.voyage_dispatch_window||(this.voyage_dispatch_window=Utils.createClass("voyage_dispatch_window"),this.voyage_dispatch_window.open(e)):this.voyage_dispatch_window&&(this.voyage_dispatch_window.close(),this.voyage_dispatch_window=null)},checkVoyageIsOpen:function(t){var e=!1,i=Config.shipping_data.data_const.guild_lev,s=a.getInstance().getRoleVo();return i&&i.val<=s.lev?e=!0:t||message(i.desc),e}},"getVoyageMainRoot",function(){if(this.voyage_main_window)return this.voyage_main_window.root_wnd}),n(s,"getVoyageDispatchRoot",function(){if(this.voyage_dispatch_window)return this.voyage_dispatch_window.root_wnd}),s));e.exports=l,cc._RF.pop()},{role_controller:"role_controller",voyage_event:"voyage_event",voyage_model:"voyage_model"}],voyage_dispatch_window:[function(t,e,i){"use strict";cc._RF.push(e,"f17504ZKR9EfYNuXooysn4U","voyage_dispatch_window");var s=t("pathtool"),n=t("hero_const"),a=t("hero_controller"),o=t("role_controller"),l=t("common_scrollview"),r=t("timetool"),c=t("voyage_const"),_=t("voyage_event"),h=t("voyage_controller"),d=t("guide_event");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("voyage","voyage_order_info"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Big},initConfig:function(){this.role_vo=o.getInstance().getRoleVo(),this.ctrl=h.getInstance(),this.model=this.ctrl.getModel(),this.camp_btns={},this.cur_camp=n.CampType.eNone,this.need_hero_num=0,this.chose_heros=[],this.hero_boxs={},this.hero_icons=[],this.camp_icons=[],this.conditions=[],this.con_status=!1,this.con_tips=Utils.TI18N("\u4e0d\u6ee1\u8db3\u6d3e\u9063\u6761\u4ef6"),this.node_list=[]},openCallBack:function(){this.background=this.seekChild("background"),this.background.scale=FIT_SCALE,this.main_container=this.seekChild("main_container");var t=this.seekChild(this.main_container,"camp_node");this.img_select_nd=this.seekChild(t,"img_select");for(var e=0;e<=5;e++){var i=t.getChildByName("camp_btn"+e);if(this.camp_btns[e]=i,0==e){var n=i.getPosition();this.img_select_nd.setPosition(n)}}this.no_hero_image_nd=this.seekChild(this.main_container,"no_hero_image"),this.quick_btn_nd=this.seekChild(this.main_container,"quick_btn"),this.dispatch_btn_nd=this.seekChild(this.main_container,"dispatch_btn");var a=this.seekChild(this.main_container,"num_bg_1");this.item_num_lb=this.seekChild(a,"item_num_label",cc.Label);var o=this.seekChild(this.main_container,"num_bg_2");this.time_lb=this.seekChild(o,"time_label",cc.Label);var r=this.seekChild(a,"image_res",cc.Sprite);this.loadRes(s.getItemRes(7),function(t){r.spriteFrame=t}.bind(this)),this.status_label_nd=this.seekChild(this.main_container,"status_label"),this.move_item_nd=this.seekChild(this.main_container,"move_item"),this.move_item=ItemsPool.getInstance().getItem("hero_exhibition_item"),this.move_item.setParent(this.move_item_nd),this.move_item.setData(null),this.move_item.show(),this.move_item_nd.active=!1,this.condition_layout=this.seekChild(this.main_container,"condition_layout"),this.hero_layout=this.seekChild(this.main_container,"hero_layout");var c=this.seekChild(this.main_container,"lay_scrollview"),_=c.getContentSize(),h=cc.size(_.width,_.height);this.hero_scrollview=new l,this.hero_scrollview.createScroll(c,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,h,{item_class:"hero_exhibition_item",start_x:10,space_x:20,start_y:0,space_y:0,item_width:108,item_height:108,row:0,col:5,scale:.9},cc.v2(.5,.5))},registerEvent:function(){Utils.onTouchEnd(this.background,function(){this._onClickCloseBtn()}.bind(this),1),Utils.onTouchEnd(this.quick_btn_nd,function(){this._onClickQuickChoseBtn()}.bind(this),1),Utils.onTouchEnd(this.dispatch_btn_nd,function(){this._onClickDispatchBtn()}.bind(this),1);for(var t=function(t,e){Utils.onTouchEnd(e,function(){this._onClickCampBtn(t,e)}.bind(this),1)}.bind(this),e=0;e<=5;e++)t(e,this.camp_btns[e]);null==this.role_assets_event&&(null==this.role_vo&&(this.role_vo=o.getInstance().getRoleVo()),this.role_assets_event=this.role_vo.bind(EventId.UPDATE_ROLE_ATTRIBUTE,function(t,e){"energy"==t&&this.refreshItemNum()},this)),this.addGlobalEvent(_.UpdateActivityStatusEvent,function(){this.refreshItemNum()},this)},openRootWnd:function(t){this.refreshCampHeroList(),this.showBaseInfo(t)},refreshCampHeroList:function(){for(var t=[],e=a.getInstance().getModel().getAllHeroArray(),i=0;i<e.length;i++){var o=e[i];this.cur_camp!=n.CampType.eNone&&this.cur_camp!=o.camp_type||(null==o.in_task&&(o.in_task=this.model.checkHeroIsInTaskById(o.partner_id)),t.push(o))}if(t.length<=0)return this.no_hero_image_nd.active=!0,null==this.no_hero_image_sp&&(this.no_hero_image_sp=this.no_hero_image_nd.getComponent(cc.Sprite),this.loadRes(s.getBigBg("bigbg_3"),function(t){this.no_hero_image_sp.spriteFrame=t}.bind(this))),void this.hero_scrollview.setData([]);this.no_hero_image_nd.active=!1;var l=t;l.sort(function(t,e){return!(t.in_task&&!e.in_task||(t.in_task||!e.in_task)&&!(t.camp_type!=e.camp_type?t.camp_type<e.camp_type:t.star!=e.star?t.star>e.star:t.lev>e.lev))});var r={scale:.9,can_click:!0,click_delay:.5,from_type:n.ExhibitionItemType.eVoyage};this.hero_scrollview.setData(l,function(t,e){this._onClickHero(t,e)}.bind(this),r)},refreshItemNum:function(){if(this.role_vo&&this.config){var t=this.role_vo.energy,e=0;if(this.config.expend[0]&&(e=this.config.expend[0][1]||0,1==this.model.getActivityStatus())){var i=Config.shipping_data.data_const.discount;i&&(e=e*i.val/1e3)}this.item_num_lb.string=t+"/"+e}},showBaseInfo:function(t){this.data=t||{};var e=this.data.config||{};for(var i in this.config=e,this.refreshItemNum(),this.time_lb.string=r.getTimeFormat(e.need_time),this.hero_boxs)this.hero_boxs[i].node.active=!1;var a=e.limit_num;this.need_hero_num=a;for(var o=c.Chose_Hero_PosX[a],l=function(t){var e=this.hero_boxs[t];null==e&&(e=Utils.createImage(this.hero_layout,null,0,0,cc.v2(.5,.5),!0),this.loadRes(s.getCommonIcomPath("common_1005"),function(t){e.spriteFrame=t}.bind(this)),this.hero_boxs[t]=e),e.node.active=!0;var i=o[t-1];i&&e.node.setPosition(cc.v2(i-319,0))}.bind(this),_=1;_<=a;_++)l(_);this.initConditionData();var h=[],d=0,u=1,m=[];for(var i in this.conditions){var f=this.conditions[i];f.star_num?(d=f.need_num,u=f.star_num):f.camp_type&&m.push(f.camp_type)}if(d>0){this.star_icon=Utils.createImage(this.condition_layout,null,0,0,cc.v2(.5,.5),!0),this.loadRes(s.getUIIconPath("voyage","voyage_1009"),function(t){this.star_icon.spriteFrame=t}.bind(this)),this.star_icon.setMaterial(0,cc.Material.getBuiltinMaterial("2d-gray-sprite"));Utils.createLabel(22,1,new cc.Color(132,16,0,255),0,0,u,this.star_icon.node,null,cc.v2(.5,.5));this.star_icon.node.on(cc.Node.EventType.TOUCH_END,function(){message(cc.js.formatStr(Utils.TI18N("\u9700\u8981\u4e00\u4e2a%d\u661f\u82f1\u96c4"),u))},this),h.push(this.star_icon)}for(var i in this.camp_icons)this.camp_icons[i].node.active=!1;l=function(t,e){if(null==t){t=Utils.createImage(this.condition_layout,null,0,0,cc.v2(.5,.5),!0);var i=s.getHeroCampRes(p);this.loadRes(s.getCommonIcomPath(i),function(e){t.spriteFrame=e}.bind(this)),t.node.scale=.8,t.node.on(cc.Node.EventType.TOUCH_END,function(t){message(cc.js.formatStr(Utils.TI18N("\u9700\u8981\u4e00\u4e2a%s\u82f1\u96c4"),n.CampAttrName[t]))}.bind(this,p),this),t.setMaterial(0,cc.Material.getBuiltinMaterial("2d-gray-sprite")),this.camp_icons.push(t)}t.camp_type=p,t.node.active=!0,h.push(t)}.bind(this);for(var _ in m){var p=m[_];l(this.camp_icons[_],_)}var g=c.Condition_Icon_PosX[h.length];for(var _ in h){var v=g[_];null!=v&&(h[_].node.x=v)}},getCampIconByCampType:function(t){for(var e in this.camp_icons){var i=this.camp_icons[e];if(i.camp_type==t)return i}},initConditionData:function(){if(this.conditions=[],this.config){var t=this.config.condition||{};for(var e in t){var i=t[e],s=(Config.shipping_data.data_condition[i]||{}).conition||{};if(s[0]){var n={};"partner_star"==s[0][0]?(n.star_num=s[0][1],n.need_num=s[0][2]):"partner_camp_type"==s[0][0]&&(n.camp_type=s[0][1],n.need_num=s[0][2]),null!=Utils.next(n)&&this.conditions.push(n)}}}},refreshConditionStatus:function(){for(var t in this.con_status=!0,this.conditions){var e=!1,i=this.conditions[t];if(i.star_num)e=this.checkIsMeetCondition(1,i.star_num,i.need_num),this.star_icon.setMaterial(0,e?cc.Material.getBuiltinMaterial("2d-sprite"):cc.Material.getBuiltinMaterial("2d-gray-sprite"));else if(i.camp_type){e=this.checkIsMeetCondition(2,i.camp_type,i.need_num),this.getCampIconByCampType(i.camp_type).setMaterial(0,e?cc.Material.getBuiltinMaterial("2d-sprite"):cc.Material.getBuiltinMaterial("2d-gray-sprite"))}0==e&&this.con_status&&(i.star_num?this.con_tips=cc.js.formatStr(Utils.TI18N("\u9700\u8981\u4e00\u4e2a%s\u661f\u82f1\u96c4"),i.star_num):i.camp_type&&(this.con_tips=cc.js.formatStr(Utils.TI18N("\u9700\u8981\u4e00\u4e2a%s\u7cfb\u82f1\u96c4"),n.CampName[i.camp_type])),this.con_status=!1)}this.con_status?this.status_label_nd.color=new cc.Color(36,144,3,255):this.status_label_nd.color=new cc.Color(201,38,6,255)},checkIsMeetCondition:function(t,e,i){var s=0;for(var n in this.chose_heros){var a=this.chose_heros[n];1==t&&a.star>=e?s+=1:2==t&&a.camp_type==e&&(s+=1)}return s>=i},checkIsMeetAllCondition:function(){var t=!0;for(var e in this.conditions){var i=this.conditions[e],s=!1;if(i.star_num?s=this.checkIsMeetCondition(1,i.star_num,i.need_num):i.camp_type&&(s=this.checkIsMeetCondition(2,i.star_num,i.need_num)),0==s){t=!1;break}}return t},_onClickHero:function(t,e){if(!(e=t.data).in_task){if(e.is_ui_select){for(var i in this.hero_icons){var s=this.hero_icons[i];if(s.getData().partner_id==e.partner_id){var n=s.parent,a=n.convertToWorldSpaceAR(cc.v2(0,0)),o=this.main_container.convertToNodeSpaceAR(a),l=this.main_container.convertToNodeSpaceAR(t.getWorldPos());this.move_item_nd.setPosition(o),this.move_item_nd.active=!0;var r=cc.moveTo(.07,l),c=function(){s.deleteMe(),s=null,n.box_index=null,this.hero_icons.splice(i,1),this.move_item_nd.active=!1}.bind(this);this.move_item_nd.runAction(cc.sequence(r,cc.callFunc(c)));break}}e.is_ui_select=!1,t.setSelected(!1),this.updateChoseHeroList(e,2)}else{if(this.need_hero_num<=this.chose_heros.length)return void message(Utils.TI18N("\u5df2\u8fbe\u82f1\u96c4\u6570\u91cf\u4e0a\u9650"));this.createChoseHeroIcon(e,t),e.is_ui_select=!0,t.setSelected(!0),this.updateChoseHeroList(e,1)}this.refreshConditionStatus()}},createChoseHeroIcon:function(t,e){this.checkDeleteSameHeroIcon(t.partner_id);var i=ItemsPool.getInstance().getItem("hero_exhibition_item");i.show(),i.setData(t),i.setVisible(!1),this.move_item.setData(t),i.addCallBack(function(){var t=i.getData(),e=this.hero_scrollview.getItemList(),s=null;for(var n in e){e[n].getData().partner_id==t.partner_id&&(s=e[n])}if(s)this._onClickHero(s,s.getData());else{for(var n in this.hero_icons){var a=this.hero_icons[n];if(a.getData().partner_id==t.partner_id){a.deleteMe(),this.hero_icons.splice(n,1);break}}t.is_ui_select=!1,this.updateChoseHeroList(t,2),this.refreshConditionStatus()}}.bind(this));var s=this.getMastLeftEmptyBox();if(s)if(i.setParent(s.node),this.hero_icons.push(i),e){var n=this.main_container.convertToNodeSpaceAR(e.getWorldPos()),a=s.node.convertToWorldSpaceAR(cc.v2(0,0)),o=this.main_container.convertToNodeSpaceAR(a);this.move_item_nd.setPosition(n),this.move_item_nd.active=!1,this.move_item_nd.runAction(cc.moveTo(.07,o),cc.callFunc(function(){this.move_item_nd.active=!1,i.setVisible(!0)}.bind(this)))}else i.setVisible(!0)},checkDeleteSameHeroIcon:function(t){for(var e in this.hero_icons){var i=this.hero_icons[e];if(i.getData().partner_id==t){i.deleteMe(),this.hero_icons.splice(e,1);break}}},getMastLeftEmptyBox:function(){var t;for(var e in this.hero_boxs){var i=this.hero_boxs[e];if(!i.node.getChildByName("hero_exhibition_item")&&null==i.node.box_index){t=i,i.node.box_index=e;break}}return t},updateChoseHeroList:function(t,e){if(1==e)this.chose_heros.push(t);else if(2==e)for(var i in this.chose_heros){if(this.chose_heros[i].partner_id==t.partner_id){this.chose_heros.splice(i,1);break}}},_onClickCampBtn:function(t,e){if(this.cur_camp!=t){this.cur_camp=t;var i=e.x,s=e.y;this.img_select_nd.setPosition(cc.v2(i,s)),this.refreshCampHeroList()}},_onClickQuickChoseBtn:function(){for(var t in this.hero_icons)this.hero_icons[t]&&(this.hero_icons[t].deleteMe(),this.hero_icons[t]=null);for(var t in this.hero_boxs)this.hero_boxs[t]&&(this.hero_boxs[t].node.box_index=null);window.TASK_TIPS&&gcore.GlobalEvent.fire(d.TaskNextStep,"quick_btn"),gcore.Timer.set(function(){this.oneCallBack()}.bind(this),100,1)},oneCallBack:function(){for(var t in this.hero_icons=[],this.chose_heros)this.chose_heros[t].is_ui_select=!1;this.chose_heros=[];var e=this.hero_scrollview.getItemList();for(var t in e)e[t].setSelected(!1);var i=a.getInstance().getModel().getHeroList(),s=0,n=0,o={};for(var t in this.conditions){(u=this.conditions[t]).star_num?(s=u.star_num,n=u.need_num):u.camp_type&&(o[u.camp_type]=u.need_num)}var l=[],r={},c=[];for(var t in i){var _=i[t],h=!1;for(var d in _.star>=s&&!this.model.checkHeroIsInTaskById(_.partner_id)&&(h=!0,l.push(_)),this.conditions){var u;(u=this.conditions[d]).camp_type&&u.camp_type==_.camp_type&&!this.model.checkHeroIsInTaskById(_.partner_id)&&(r[u.camp_type]||(r[u.camp_type]=[]),r[u.camp_type].push(_),h&&c.push(_))}}var m=Utils.tableLowerSorter(["star","lev","camp_type"]);for(var t in l.sort(m),c.sort(m),r)r[t].sort(m);for(var d in c){_=c[d];if(this.chose_heros.length<n)this.chose_heros.push(_);else{if(!this.checkIsMeetAllCondition())break;for(var f in o){var p=o[f];_.camp_type==f&&this.checkChoseHeroNumByCamp(f)<p&&this.chose_heros.push(_)}}}if(this.checkIsMeetAllCondition())this.afterQuickChoseHero();else{var g=n-this.chose_heros.length;if(g>0){var v=0;for(var d in l){var b=l[d];if(this.checkIsChoseHeroById(b.partner_id)||(this.chose_heros.push(b),v+=1),v>=g)break}}if(this.checkIsMeetAllCondition())this.afterQuickChoseHero();else{for(var w in r){var y=r[w],C=(p=o[w])-this.checkChoseHeroNumByCamp(w);if(C>0){v=0;for(var d in y){b=y[d];if(this.checkIsChoseHeroById(b.partner_id)||(this.chose_heros.push(b),v+=1),v>=C)break}}}this.afterQuickChoseHero()}}},checkIsChoseHeroById:function(t){var e=!1;for(var i in this.chose_heros)if(this.chose_heros[i].partner_id==t){e=!0;break}return e},checkChoseHeroNumByCamp:function(t){var e=0;for(var i in this.chose_heros)this.chose_heros[i].camp_type==t&&(e+=1);return e},afterQuickChoseHero:function(){for(var t in this.chose_heros){var e=this.chose_heros[t];e.is_ui_select=!0;var i=this.hero_scrollview.getItemList();for(var s in i){var n=i[s];n.getData().partner_id==e.partner_id&&n.setSelected(!0)}this.createChoseHeroIcon(e)}this.refreshConditionStatus()},_onClickDispatchBtn:function(){if(1==this.con_status){var t=[];for(var e in this.chose_heros){var i=this.chose_heros[e],s={};s.partner_id=i.partner_id,t.push(s)}this.data&&this.ctrl.requestReceiveOrder(this.data.order_id,t),window.TASK_TIPS&&gcore.GlobalEvent.fire(d.TaskNextStep,"dispatch_btn")}else this.con_tips=this.con_tips||Utils.TI18N("\u4e0d\u6ee1\u8db3\u6d3e\u9063\u6761\u4ef6"),message(this.con_tips)},_onClickCloseBtn:function(){this.ctrl.openVoyageDispatchWindow(!1)},closeCallBack:function(){this.hero_scrollview&&(this.hero_scrollview.deleteMe(),this.hero_scrollview=null);var t=a.getInstance().getModel().getHeroList();for(var e in t)t[e].is_ui_select=!1,t[e].in_task=null;for(var e in this.role_assets_event&&(this.role_vo&&this.role_vo.unbind(this.role_assets_event),this.role_assets_event=null,this.role_vo=null),this.hero_icons)this.hero_icons[e]&&(this.hero_icons[e].deleteMe(),this.hero_icons[e]=null);if(this.move_item&&(this.move_item.deleteMe(),this.move_item=null),this.camp_icons){for(var e in this.camp_icons){var i=this.camp_icons[e];i&&(i.node.destroy(),i=null)}this.camp_icons=null}gcore.GlobalEvent.fire(d.CloseTaskEffect),this.ctrl.openVoyageDispatchWindow(!1)}});cc._RF.pop()},{common_scrollview:"common_scrollview",guide_event:"guide_event",hero_const:"hero_const",hero_controller:"hero_controller",pathtool:"pathtool",role_controller:"role_controller",timetool:"timetool",voyage_const:"voyage_const",voyage_controller:"voyage_controller",voyage_event:"voyage_event"}],voyage_event:[function(t,e,i){"use strict";cc._RF.push(e,"8ccea12nQZBh7E6hN6F+MKR","voyage_event"),e.exports={UpdateOrderDataEvent:"UpdateOrderDataEvent",UpdateVoyageDataEvent:"UpdateVoyageDataEvent",DeleteOrderDataEvent:"DeleteOrderDataEvent",UpdateVoyageRedEvent:"UpdateVoyageRedEvent",UpdateActivityStatusEvent:"UpdateActivityStatusEvent"},cc._RF.pop()},{}],voyage_main_window:[function(t,e,i){"use strict";function s(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}cc._RF.push(e,"09a99xrtDJLHpoJEKE75Ygs","voyage_main_window");var n=t("pathtool"),a=t("role_controller"),o=t("common_scrollview"),l=t("voyage_controller"),r=t("voyage_event"),c=t("backpack_const"),_=t("backpack_controller"),h=t("voyage_order_item"),d=t("voyage_const");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=n.getPrefabPath("voyage","voyage_main_window"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Big},initConfig:function(){this.role_vo=a.getInstance().getRoleVo(),this.ctrl=l.getInstance(),this.model=this.ctrl.getModel()},openCallBack:function(){this.background=this.seekChild("background"),this.background.scale=FIT_SCALE,this.main_container=this.seekChild("main_container"),this.top_bg_sp=this.seekChild(this.main_container,"top_bg",cc.Sprite),this.loadRes(n.getBigBg("txt_cn_bigbg_22"),function(t){this.top_bg_sp.spriteFrame=t}.bind(this)),this.refresh_btn_nd=this.seekChild("refresh_btn"),this.refresh_btn_lb=this.seekChild(this.refresh_btn_nd,"label",cc.Label),this.refresh_btn_img_sp=this.seekChild(this.refresh_btn_nd,"img",cc.Sprite),this.refresh_btn_img_sp.node.active=!1,this.special_btn_nd=this.seekChild("special_btn"),this.explain_btn_nd=this.seekChild("explain_btn"),this.special_sk=this.seekChild(this.special_btn_nd,"special_sk",sp.Skeleton),this.progress_pb=this.seekChild(this.main_container,"progress",cc.ProgressBar),this.progress_pb.progress=0,this.progress_value_lb=this.seekChild(this.main_container,"progress_value",cc.Label),this.no_order_image_nd=this.seekChild(this.main_container,"no_order_image");var t=Config.shipping_data.data_const.refresh_cost;this.cost_item_bid=t.val[0][0],this.cost_item_num=t.val[0][1],this.item_count_lb=this.seekChild(this.main_container,"item_count",cc.Label);var e=Utils.getItemConfig(this.cost_item_bid),i=this.seekChild(this.main_container,"res_icon",cc.Sprite),s=this.seekChild(this.main_container,"item_icon",cc.Sprite);this.loadRes(n.getItemRes(7),function(t){i.spriteFrame=t}.bind(this)),this.loadRes(n.getItemRes(e.icon),function(t){s.spriteFrame=t}.bind(this));var a=this.seekChild(this.main_container,"order_list"),l=a.getContentSize(),r=cc.size(l.width-10,l.height-10),c={item_class:h,start_x:5,space_x:0,start_y:0,space_y:0,item_width:631,item_height:171,row:0,col:1,need_dynamic:!0};this.order_scrollview=new o,this.order_scrollview.createScroll(a,cc.v2(0,0),ScrollViewDir.vertical,ScrollViewStartPos.top,r,c,cc.v2(.5,.5))},registerEvent:function(){Utils.onTouchEnd(this.background,function(){this.ctrl.openVoyageMainWindow(!1)}.bind(this),2),this.explain_btn_nd.on(cc.Node.EventType.TOUCH_END,function(e){Utils.playButtonSound(1);var i=Config.shipping_data.data_explain[1],s=e.touch.getLocation();i&&t("tips_controller").getInstance().showCommonTips(StringUtil.parse(i.desc),s)}),this.special_btn_nd.on(cc.Node.EventType.TOUCH_END,function(t){Utils.playButtonSound(1);var e=t.touch.getLocation();this._onClickSpecialBtn(e)},this),Utils.onTouchEnd(this.refresh_btn_nd,function(){var e=this.model.getFirstFresh(),i=a.getInstance().getModel().checkPrivilegeStatus(3),s=a.getInstance().getModel().checkPrivilegeStatus(2);if(e&&!i&&!s){var n=Config.shipping_data.data_refresh[this.role_vo.vip_lev];if(!n)return;if(this.model.getFreeTimes()>=n.free_times){this.ctrl.send23820();var o=function(){t("vip_controller").getInstance().openVipMainWindow(!0,VIPTABCONST.PRIVILEGE),this.ctrl.openVoyageMainWindow(!1)}.bind(this),l=cc.js.formatStr(Utils.TI18N("\u83b7\u53d6\u8fdc\u822a\u7279\u6743\uff0c<color=#c92606>\u6bcf\u65e5\u9996\u6b21</c>\u94bb\u77f3\u3001\u5237\u65b0\u5238\u5237\u65b0\u5fc5\u51fa<color=#c92606>\u9ad8\u54c1\u8d28</c>\u8fdc\u822a\u4efb\u52a1\uff0c\u5b8c\u6210\u53ef\u83b7\u9ad8\u989d\u5956\u52b1\uff01\uff01\uff01"));return void t("commonalert").show(l,Utils.TI18N("\u7acb\u5373\u524d\u5f80"),o,Utils.TI18N("\u6b8b\u5fcd\u62d2\u7edd"),null,1)}}if(this.model.checkIsHaveHigherEpicOrder()){o=function(){this.ctrl.requestRefreshOrder()}.bind(this),l=cc.js.formatStr(Utils.TI18N("\u6709\u7d2b\u8272\u4ee5\u4e0a\u7684\u8fdc\u822a\u4efb\u52a1\u672a\u63a5\u53d6\uff0c\u662f\u5426\u7ee7\u7eed\uff1f"));t("commonalert").show(l,Utils.TI18N("\u786e\u5b9a"),o,Utils.TI18N("\u53d6\u6d88"),null,1)}else this.ctrl.requestRefreshOrder()}.bind(this),1),this.addGlobalEvent(r.UpdateVoyageDataEvent,function(){this.refreshOrderList(),this.refreshBtnStatus()},this),this.addGlobalEvent(r.DeleteOrderDataEvent,function(){this.refreshOrderList()},this),null==this.role_assets_event&&(null==this.role_vo&&(this.role_vo=a.getInstance().getRoleVo()),this.role_assets_event=this.role_vo.bind(EventId.UPDATE_ROLE_ATTRIBUTE,function(t,e){"energy"==t?this.refreshProgressInfo():"vip_lev"==t&&this.refreshBtnStatus()},this)),this.addGlobalEvent(EventId.ADD_GOODS,function(t,e){t==c.Bag_Code.BACKPACK&&this.checkNeedUpdateItemNum(e)},this),this.addGlobalEvent(EventId.MODIFY_GOODS_NUM,function(t,e){t==c.Bag_Code.BACKPACK&&this.checkNeedUpdateItemNum(e)},this),this.addGlobalEvent(EventId.DELETE_GOODS,function(t,e){t==c.Bag_Code.BACKPACK&&this.checkNeedUpdateItemNum(e)},this)},openRootWnd:function(){this.model.checkIsHaveOrderData()?(this.refreshOrderList(),this.refreshBtnStatus()):this.ctrl.requestVoyageInfo(),this.refreshProgressInfo(),this.refreshItemNum(),this.updateSpecialEffectStatus()},refreshOrderList:function(){var t=this.model.getAllOrderList();if(t&&null!=Utils.next(t)){var e,i=(s(e={},d.Order_Status.Finish,1),s(e,d.Order_Status.Unget,2),s(e,d.Order_Status.Underway,3),e);for(var a in t.sort(function(t,e){var s=i[t.status],n=i[e.status];return 1==t.order_id&&t.status==d.Order_Status.Unget&&1!=e.order_id?-1:1!=t.order_id&&1==e.order_id&&e.status==d.Order_Status.Unget?1:s==n?t.status==d.Order_Status.Unget?e.config.quality-t.config.quality:t.end_time-e.end_time:s-n}),t)t[a].index=a;this.order_scrollview.setData(t),this.no_order_image_nd.setPosition(1e3,0)}else this.no_order_image_nd.setPosition(0,0),null==this.no_order_image_sp&&(this.no_order_image_sp=this.no_order_image_nd.getComponent(cc.Sprite),this.loadRes(n.getBigBg("bigbg_3"),function(t){this.no_order_image_sp.spriteFrame=t}.bind(this))),this.order_scrollview.setData([])},refreshBtnStatus:function(){var t=Config.shipping_data.data_refresh[this.role_vo.vip_lev];if(t){if(this.model.getFreeTimes()<t.free_times)return this.refresh_btn_lb.string=Utils.TI18N("\u514d\u8d39\u5237\u65b0"),void(this.refresh_btn_img_sp.node.active=!1);if(_.getInstance().getModel().getItemNumByBid(this.cost_item_bid)>=this.cost_item_num){var e=Utils.getItemConfig(this.cost_item_bid),i=n.getItemRes(e.icon);return this.refresh_btn_lb.string=cc.js.formatStr("    %d \u5237\u65b0",this.cost_item_num),this.loadRes(i,function(t){this.refresh_btn_img_sp.spriteFrame=t}.bind(this)),void(this.refresh_btn_img_sp.node.active=!0)}if(this.model.getCoinTimes()<t.all_times){var s=t.expend[0][0],a=t.expend[0][1];e=Utils.getItemConfig(s),i=n.getItemRes(e.icon);return this.refresh_btn_lb.string=cc.js.formatStr("    %d \u5237\u65b0",a),this.loadRes(i,function(t){this.refresh_btn_img_sp.spriteFrame=t}.bind(this)),void(this.refresh_btn_img_sp.node.active=!0)}this.refresh_btn_lb.string=Utils.TI18N("\u5237\u65b0"),this.refresh_btn_img_sp.node.active=!1}},refreshProgressInfo:function(){if(this.role_vo){var t=this.role_vo.energy,e=this.role_vo.energy_max,i=t/e;this.progress_value_lb.string=t+"/"+e,this.progress_pb.progress=i}},refreshItemNum:function(){var t=_.getInstance().getModel().getItemNumByBid(this.cost_item_bid);this.item_count_lb.string=t},checkNeedUpdateItemNum:function(t){if(null!=t&&null!=Utils.next(t))for(var e in t){var i=t[e];if(i.config){var s=i.config.id;if(this.cost_item_bid&&s==this.cost_item_bid){this.refreshItemNum(),this.refreshBtnStatus();break}}}},updateSpecialEffectStatus:function(){var t=a.getInstance().getModel().checkPrivilegeStatus(2),e=a.getInstance().getModel().checkPrivilegeStatus(3);t||e?this.handleEffect(!0):this.handleEffect(!1)},handleEffect:function(t){if(0==t)this.special_sk&&(this.special_sk.setToSetupPose(),this.special_sk.clearTracks());else if(this.special_sk){var e=cc.js.formatStr("spine/%s/action.atlas",n.getEffectRes(628));this.loadRes(e,function(t){this.special_sk.skeletonData=t,this.special_sk.setAnimation(1,PlayerAction.action,!0)}.bind(this))}},_onClickSpecialBtn:function(e){for(var i="",s=1;s<=2;s++){var n=Config.shipping_data.data_explain[s+1];if(n){var o=a.getInstance().getModel().checkPrivilegeStatus(s+1),l=StringUtil.parse(n.desc||"");l+=o?Utils.TI18N("<color=#249003>                                 \uff08\u5df2\u6fc0\u6d3b\uff09</c>"):Utils.TI18N("<color=#c92606>                                 \uff08\u672a\u6fc0\u6d3b\uff09</c>"),i=1==s?l:i+"\n\n\n"+l}}t("tips_controller").getInstance().showCommonTips(i,cc.v2(e.x,e.y-80))},closeCallBack:function(){this.order_scrollview&&(this.order_scrollview.deleteMe(),this.order_scrollview=null),this.role_assets_event&&(this.role_vo.unbind(this.role_assets_event),this.role_assets_event=null,this.role_vo=null),this.handleEffect(!1);var e=t("guide_event");gcore.GlobalEvent.fire(e.CloseTaskEffect),this.ctrl.openVoyageMainWindow(!1)}});cc._RF.pop()},{backpack_const:"backpack_const",backpack_controller:"backpack_controller",common_scrollview:"common_scrollview",commonalert:"commonalert",guide_event:"guide_event",pathtool:"pathtool",role_controller:"role_controller",tips_controller:"tips_controller",vip_controller:"vip_controller",voyage_const:"voyage_const",voyage_controller:"voyage_controller",voyage_event:"voyage_event",voyage_order_item:"voyage_order_item"}],voyage_model:[function(t,e,i){"use strict";cc._RF.push(e,"cd20cms6apHoo9solcOUhFv","voyage_model");var s=t("voyage_order_vo"),n=t("voyage_const");cc.Class({extends:BaseClass,ctor:function(){},properties:{},initConfig:function(){this.ctrl=t("voyage_controller").getInstance(),this.order_list=[],this.free_times=0,this.coin_times=0},setOrderList:function(t){for(var e in this.order_list=[],t){var i=t[e],n=new s;n.updateData(i),this.order_list.push(n)}},getAllOrderList:function(){return this.order_list},updateOneOrderData:function(t){for(var e in this.order_list){var i=this.order_list[e];if(i.order_id==t.order_id){i.updateData(t);break}}},deleteOneOrderData:function(t){for(var e in this.order_list){if(this.order_list[e].order_id==t){this.order_list.splice(e,1);break}}},setFreeTimes:function(t){this.free_times=t},getFreeTimes:function(){return this.free_times},setCoinTimes:function(t){this.coin_times=t},getCoinTimes:function(){return this.coin_times},checkIsHaveHigherEpicOrder:function(){var t=!1;for(var e in this.order_list){var i=this.order_list[e];if(i.status==n.Order_Status.Unget&&i.config&&i.config.quality>=n.Order_Rarity.Epic){t=!0;break}}return t},checkHeroIsInTaskById:function(t){var e=!1;for(var i in this.order_list){var s=this.order_list[i];if(s.assign_ids)for(var n in s.assign_ids){var a=s.assign_ids[n];if(a.partner_id&&a.partner_id==t){e=!0;break}}if(e)break}return e},getQuickFinishNeedGoldByTime:function(t){var e=0;for(var i in Config.shipping_data.data_quick_cost){var s=Config.shipping_data.data_quick_cost[i];t>=s.min&&t<=s.max&&(e=s.gold)}return e},checkIsHaveOrderData:function(){return null!=Utils.next(this.order_list)},checkVoyageRedStatus:function(){var t=!1;for(var e in this.order_list){if(this.order_list[e].status==n.Order_Status.Finish){t=!0;break}}return t},setActivityStatus:function(t){this.activity_status=t},getActivityStatus:function(){return this.activity_status||0},getFirstFresh:function(){return this.is_first_fresh||!1},setFirstFresh:function(t){this.is_first_fresh=t}});cc._RF.pop()},{voyage_const:"voyage_const",voyage_controller:"voyage_controller",voyage_order_vo:"voyage_order_vo"}],voyage_order_item:[function(t,e,i){"use strict";cc._RF.push(e,"44b77iQXahB6KlEyNv5b3KT","voyage_order_item");var s=t("pathtool"),n=t("voyage_controller"),a=t("common_scrollview"),o=t("voyage_const"),l=t("timetool"),r=t("voyage_event"),c=t("guide_event");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("voyage","voyage_order_item")},initConfig:function(){this.ctrl=n.getInstance(),this.model=this.ctrl.getModel()},initPanel:function(){this.container=this.seekChild("container"),this.rarity_image_sp=this.seekChild(this.container,"rarity_image",cc.Sprite),this.order_name_lb=this.seekChild(this.container,"order_name",cc.Label),this.order_name_lo=this.seekChild(this.container,"order_name",cc.LabelOutline),this.get_btn_nd=this.seekChild(this.container,"get_btn"),this.get_btn_lb=this.seekChild(this.get_btn_nd,"label",cc.Label),this.get_btn_sp=this.seekChild(this.get_btn_nd,"img",cc.Sprite),this.get_btn_sp.node.active=!1,this.btn_sp=this.seekChild(this.container,"get_btn",cc.Sprite),this.progress_bg_nd=this.seekChild(this.container,"progress_bg"),this.progress_pb=this.seekChild(this.progress_bg_nd,"progress",cc.ProgressBar),this.progress_value_lb=this.seekChild(this.progress_bg_nd,"progress_value",cc.Label),this.special_sk=this.seekChild("effect").getComponent(sp.Skeleton);var t=this.seekChild(this.container,"goods_list"),e=t.getContentSize(),i=cc.size(e.width,e.height),s={item_class:"backpack_item",start_x:0,space_x:20,start_y:0,space_y:0,item_width:.7*BackPackItem.Width,item_height:.7*BackPackItem.Height,row:1,col:0,scale:.7};this.expend_label_rt=this.seekChild(this.container,"expend_label",cc.RichText),this.good_scrollview=new a,this.good_scrollview.createScroll(t,cc.v2(0,0),ScrollViewDir.horizontal,ScrollViewStartPos.top,i,s,cc.v2(.5,.5))},registerEvent:function(){Utils.onTouchEnd(this.get_btn_nd,function(){this.data&&(this.data.status==o.Order_Status.Unget?this.ctrl.openVoyageDispatchWindow(!0,this.data):this.data.status==o.Order_Status.Underway?this.ctrl.requestFinishOrder(this.data.order_id,1):this.data.status==o.Order_Status.Finish&&this.ctrl.requestFinishOrder(this.data.order_id,0),window.TASK_TIPS&&gcore.GlobalEvent.fire(c.TaskNextStep,"get_btn_1"))}.bind(this),2),this.addGlobalEvent(r.UpdateActivityStatusEvent,function(){this.refreshOrderBtnStatus()},this)},setData:function(t){this.data=t,this.root_wnd&&this.onShow()},onShow:function(){null!=this.data&&(null==this.update_self_event&&(this.update_self_event=this.data.bind(r.UpdateOrderDataEvent,function(){this.refreshOrderInfo()},this)),this.handleEffect(!1),this.refreshOrderInfo())},refreshOrderInfo:function(){if(this.data){var t=this.data.config;if(t&&null!=Utils.next(t)){this.config=t,this.get_btn_nd.name="get_btn_"+(this.tmp_index+1);var e=s.getUIIconPath("voyage",o.Order_Rarity_Res[t.quality]);this.loadRes(e,function(t){this.rarity_image_sp.spriteFrame=t}.bind(this)),this.order_name_lb.string=t.name,this.order_name_lo.color=o.Order_Rarity_Color[t.quality];var i=[];for(var n in t.award){var a=t.award[n],l=a[0],r=a[1],c={};c.bid=l,c.num=r,i.push(c)}this.good_scrollview.setData(i),this.good_scrollview.addEndCallBack(function(){for(var t=this.good_scrollview.getItemList(),e=0;e<t.length;++e)t[e].setDefaultTip(!0)}.bind(this)),this.refreshOrderBtnStatus()}}},refreshOrderBtnStatus:function(){if(this.data.status==o.Order_Status.Unget){var t=this.config.expend[0];if(t){var e=t[0],i=t[1],n=Utils.getItemConfig(e),a=s.getItemRes(n.icon);if(1==this.model.getActivityStatus()){var r=Config.shipping_data.data_const.discount;r&&(i=i*r.val/1e3)}this.expend_label_rt.string=cc.js.formatStr(Utils.TI18N("\u6d88\u8017: <img src='%s' /> %s"),n.icon,i),this.loadRes(a,function(t){this.expend_label_rt.spriteFrame=t}.bind(this))}this.get_btn_lb.string=Utils.TI18N("\u63a5\u53d6"),this.get_btn_lb.node.color=new cc.Color(37,85,5,255),this.loadRes(s.getUIIconPath("common","common_1098"),function(t){this.btn_sp.spriteFrame=t}.bind(this)),this.get_btn_sp.node.active=!1,this.openOrderTimer(!1),this.expend_label_rt.node.active=!0,this.progress_bg_nd.active=!1}else if(this.data.status==o.Order_Status.Underway){var c=gcore.SmartSocket.getTime();this.left_time=this.data.end_time-c,this.left_time<0&&(this.left_time=0);var _=this.model.getQuickFinishNeedGoldByTime(this.left_time);this.get_btn_lb.string=cc.js.formatStr("%d \u52a0\u901f",_),this.get_btn_lb.node.color=new cc.Color(37,85,5,255),this.loadRes(s.getUIIconPath("common","common_1098"),function(t){this.btn_sp.spriteFrame=t}.bind(this)),this.loadRes(s.getItemRes(3),function(t){this.get_btn_sp.spriteFrame=t}.bind(this)),this.get_btn_sp.node.active=!0;var h=1-this.left_time/this.config.need_time;this.progress_pb.progress=h,this.progress_value_lb.string=l.getTimeFormat(this.left_time),this.openOrderTimer(!0),this.data.old_status==o.Order_Status.Unget&&(this.data.old_status=this.data.status,this.handleEffect(!0)),this.expend_label_rt&&(this.expend_label_rt.node.active=!1),this.progress_bg_nd.active=!0}else this.data.status==o.Order_Status.Finish&&(this.get_btn_lb.string=Utils.TI18N("\u5b8c\u6210"),this.get_btn_lb.node.color=new cc.Color(113,40,4,255),this.loadRes(s.getUIIconPath("common","common_1027"),function(t){this.btn_sp.spriteFrame=t}.bind(this)),this.progress_pb.progress=1,this.progress_value_lb.string=Utils.TI18N("\u5b8c\u6210"),this.openOrderTimer(!1),this.expend_label_rt&&(this.expend_label_rt.node.active=!1),this.progress_bg_nd.active=!0)},openOrderTimer:function(t){1==t?null==this.order_timer&&(this.order_timer=gcore.Timer.set(function(){if(this.left_time=this.left_time-1,this.left_time>=0){var t=1-this.left_time/this.config.need_time;this.progress_pb.progress=t,this.progress_value_lb.string=l.getTimeFormat(this.left_time)}else this.progress.progress=1,this.progress_value_lb.string=Utils.TI18N("\u5b8c\u6210"),gcore.Timer.del(this.order_timer),this.order_timer=null}.bind(this),1e3,-1)):null!=this.order_timer&&(gcore.Timer.del(this.order_timer),this.order_timer=null)},handleEffect:function(t){if(0==t)this.special_sk&&(this.special_sk.setToSetupPose(),this.special_sk.clearTracks(),this.special_sk.node.active=!1);else if(this.special_sk){this.special_sk.node.active=!0;var e=cc.js.formatStr("spine/%s/action.atlas",s.getEffectRes(629));this.loadRes(e,function(t){this.special_sk.skeletonData=t,this.special_sk.setAnimation(1,PlayerAction.action,!1)}.bind(this))}},suspendAllActions:function(){null!=this.data&&(null!=this.update_self_event&&(this.data.unbind(this.update_self_event),this.update_self_event=null),this.data=null),this.handleEffect(!1),this.openOrderTimer(!1)},onHide:function(){},onDelete:function(){null!=this.update_self_event&&(this.data.unbind(this.update_self_event),this.update_self_event=null),this.good_scrollview&&(this.good_scrollview.deleteMe(),this.good_scrollview=null),null!=this.order_timer&&(gcore.Timer.del(this.order_timer),this.order_timer=null),this.handleEffect(!1),this.openOrderTimer(!1)}});cc._RF.pop()},{common_scrollview:"common_scrollview",guide_event:"guide_event",pathtool:"pathtool",timetool:"timetool",voyage_const:"voyage_const",voyage_controller:"voyage_controller",voyage_event:"voyage_event"}],voyage_order_vo:[function(t,e,i){"use strict";cc._RF.push(e,"23a0d1gU5hLdImWhGT624MV","voyage_order_vo");var s=t("voyage_const"),n=cc.Class({extends:gcore.BaseEvent,ctor:function(){this.order_id=0,this.order_bid=0,this.status=s.Order_Status.Finish,this.end_time=0,this.assign_ids={},this.config={},this.old_status=0},updateData:function(e){for(var i in this.old_status=this.status,e){var s=e[i];this[i]=s,"order_bid"==i&&(this.config=Config.shipping_data.data_order[s]||{})}this.fire(t("voyage_event").UpdateOrderDataEvent)},_delete:function(){}});e.exports=n,cc._RF.pop()},{voyage_const:"voyage_const",voyage_event:"voyage_event"}],week_card_tips_window:[function(t,e,i){"use strict";cc._RF.push(e,"11abdNifgpPdLQD8b+0+o6u","week_card_tips_window");var s=t("pathtool");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("tips","week_card_tips"),this.viewTag=SCENE_TAG.dialogue,this.win_type=WinType.Tips,this.ctrl=arguments[0]},initConfig:function(){this.item_list={}},openCallBack:function(){this.background=this.root_wnd.getChildByName("background"),this.main_panel=this.root_wnd.getChildByName("main_panel"),this.main_panel.getChildByName("week_card_spr").zIndex=10,this.text_name=this.main_panel.getChildByName("text_name").getComponent(cc.Label),this.text_name.string="",this.main_panel.getChildByName("name_0").getComponent(cc.Label).string=Utils.TI18N("\u7c7b\u578b\uff1a"),this.text_type=this.main_panel.getChildByName("text_type").getComponent(cc.Label),this.text_type.string="",this.main_panel.getChildByName("Text_1").getComponent(cc.Label).string=Utils.TI18N("\u7acb\u5373\u83b7\u53d6"),this.main_panel.getChildByName("Text_1_0").getComponent(cc.Label).string=Utils.TI18N("\u6301\u7eed\u4e03\u5929\uff0c\u6bcf\u5929\u767b\u5f55\u9886\u53d6"),this.btn_close=this.main_panel.getChildByName("btn_close"),this.tips_desc=this.main_panel.getChildByName("tips_desc").getComponent(cc.Label)},registerEvent:function(){this.background.on("touchend",function(){this.ctrl.showWeekCardTips(!1),Utils.playButtonSound(2)},this),this.btn_close.on("touchend",function(){this.ctrl.showWeekCardTips(!1),Utils.playButtonSound(2)},this)},openRootWnd:function(t){t&&this.setData(t)},setData:function(t){var e=t.name||"",i=t.type_desc||"";this.text_name.string=e,this.text_type.string=i,this.setShowItem(t)},setShowItem:function(t){if(t.id){this.goods_tips=ItemsPool.getInstance().getItem("backpack_item"),this.goods_tips.setParent(this.main_panel),this.goods_tips.initConfig(!1,1,!1,!1),this.goods_tips.setPosition(-132.5,205.5),this.goods_tips.show(),this.goods_tips.setData(t.id);var e=Config.gift_data.data_week_card_data;if(!e)return;var i=e[t.id];if(i){if(this.tips_desc.string=i.weekcard_desc,i.reward&&i.reward[0]&&i.reward[0][0]){var s=i.reward[0][1]||1;this.setGoodsData(1,i.reward[0][0],s,cc.v2(-82.5,-48.5),[-22.5,-49.5])}if(i.mail_reward&&i.mail_reward[0]&&i.mail_reward[0][0]){var n=i.mail_reward[0][1]||1;this.setGoodsData(2,i.mail_reward[0][0],n,cc.v2(-82.5,-211.5),[-22.5,-215.5])}}}},setGoodsData:function(t,e,i,s,n){this.item_list[t]||(this.item_list[t]=ItemsPool.getInstance().getItem("backpack_item"),this.item_list[t].initConfig(!1,.8,!1,!1),this.item_list[t].setPosition(s.x,s.y),this.item_list[t].setParent(this.main_panel),this.item_list[t].show()),this.item_list[t].setData({bid:e,num:i});var a=Utils.createLabel(22,new cc.Color(255,238,221,255),null,n[0],n[1],"",this.main_panel,null,cc.v2(0,.5)),o=Utils.getItemConfig(e);a.string=Utils.TI18N(o.name+" x "+i)},closeCallBack:function(){if(this.goods_tips&&(this.goods_tips.deleteMe(),this.goods_tips=null),this.item_list){for(var t in this.item_list)this.item_list[t]&&(this.item_list[t].deleteMe(),this.item_list[t]=null);this.item_list=null}this.ctrl.showWeekCardTips(!1)}});cc._RF.pop()},{pathtool:"pathtool"}],weixin_gift_panel:[function(t,e,i){"use strict";cc._RF.push(e,"dc3896lB81OxJlQtNYgR4yS","weixin_gift_panel");var s=t("pathtool");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("welfare","weixin_gift_panel")},initConfig:function(){},initPanel:function(){},registerEvent:function(){},onShow:function(t){},onHide:function(){},onDelete:function(){}});cc._RF.pop()},{pathtool:"pathtool"}],welfare_const:[function(t,e,i){"use strict";var s;function n(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}cc._RF.push(e,"9494aFFvcxO3q1c2kEEDBhL","welfare_const");var a={WelfarePanelTypeView:(s={},n(s,1,"supre_yueka_panel"),n(s,2,"hero_soul_wish_panel"),n(s,3,"sign_panel"),n(s,6,"weixin_gift_panel"),n(s,7,"action_invest_panel"),n(s,8,"action_grow_fund_panel"),n(s,9,"qrcode_shard_panel"),n(s,10,"honor_yueka_panel"),n(s,11,"surevey_quest_window"),n(s,12,"month_week_panel"),n(s,13,"month_week_panel"),n(s,14,"subscription_wechat_panel"),n(s,15,"bind_phone_panel"),n(s,16,"invitecode_panel"),n(s,17,"paste_panel"),n(s,18,"notice_panel"),n(s,19,"collect_panel"),s),WelfareIcon:{supre_yueka:8001,sign:8003,level_gift:8004,power_gift:8005,weixin_gift:8006,share_game:8007,partnersummon_welfar:8008,honor_yueka:8009,quest:8010,week:8011,month:8012,wechat:8014,bindphone:8015,invicode:8016,poste:8017,qq_notice:7001,sh_share_game:8101,sh_wechat:8102,sh_collect:8103},QuestConst:{single:1,multiple:3,fill_blank:4}};e.exports=a,cc._RF.pop()},{}],welfare_controller:[function(t,e,i){"use strict";var s;function n(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}cc._RF.push(e,"ed0a5fimtFPirDnn8tnfqpv","welfare_controller");var a=t("role_controller"),o=t("mainui_controller"),l=t("mainui_const"),r=t("welfare_event"),c=t("welfare_const"),_=cc.Class((n(s={extends:BaseController,ctor:function(){},initConfig:function(){var e=t("welfare_model");this.model=new e,this.model.initConfig(),this.welfare_list={},this.welfare_status_list={},this.welfare_cache_red={}},getModel:function(){return this.model},registerEvents:function(){null==this.init_role_event&&(this.init_role_event=gcore.GlobalEvent.bind(EventId.EVT_ROLE_CREATE_SUCCESS,function(){gcore.GlobalEvent.unbind(this.init_role_event),this.init_role_event=null,this.role_vo=a.getInstance().getRoleVo(),null==this.role_assets_event&&(this.role_assets_event=this.role_vo.bind(EventId.UPDATE_ROLE_ATTRIBUTE,function(t,e){"lev"==t&&this.updateWelfareRedStatus(e)},this))},this)),null==this.re_link_game_event&&(this.re_link_game_event=gcore.GlobalEvent.bind(EventId.EVT_RE_LINK_GAME,function(){t("guide_controller").getInstance().isInGuide()||this.openMainWindow(!1),null!=o.getInstance().getFunctionIconById(l.icon.welfare)&&this.sender16705()},this))},registerProtocals:function(){this.RegisterProtocal(14100,this.handle14100),this.RegisterProtocal(14101,this.handle14101),this.RegisterProtocal(16705,this.handle16705),this.RegisterProtocal(16706,this.handle16706),this.RegisterProtocal(21002,this.handle21002),this.RegisterProtocal(24600,this.handle24600),this.RegisterProtocal(24601,this.handle24601),this.RegisterProtocal(24602,this.handle24602),this.RegisterProtocal(24603,this.handle24603),this.RegisterProtocal(24604,this.handle24604),this.RegisterProtocal(21007,this.handle21007),this.RegisterProtocal(21008,this.handle21008),this.RegisterProtocal(21009,this.handle21009),this.RegisterProtocal(16635,this.handle16635),this.RegisterProtocal(16636,this.handle16636),this.RegisterProtocal(16697,this.handle16697),this.RegisterProtocal(16698,this.handle16698),this.RegisterProtocal(16633,this.handle16633),this.RegisterProtocal(16634,this.handle16634),this.RegisterProtocal(16691,this.handle16691),this.RegisterProtocal(16693,this.handle16693),this.RegisterProtocal(16692,this.handle16692),this.RegisterProtocal(16694,this.handle16694),this.RegisterProtocal(16695,this.handle16695),this.RegisterProtocal(16696,this.handle16696)},requestInitProto:function(){this.sender14100(),this.sender16705(),this.sender24600(),this.sender21008(),this.sender16635(),this.sender16633(),this.send16693(),this.send16691()},sender14100:function(){this.SendProtocal(14100,{})},sender16705:function(){this.SendProtocal(16705,{})},sender24600:function(){this.SendProtocal(24600,{})},sender21008:function(){this.SendProtocal(21008,{})},sender16635:function(){this.SendProtocal(16635,{})},sender16633:function(){this.SendProtocal(16633,{})},handle14100:function(t){gcore.GlobalEvent.fire(r.Update_Sign_Info,t);var e=!1,i=this.model.getRechargeCount();(0==t.status||i>0&&1==t.status)&&(e=!0),this.setWelfareStatus(c.WelfareIcon.sign,e)},sender14101:function(){this.SendProtocal(14101,{})},handle14101:function(t){if(message(t.msg),1==t.code){gcore.GlobalEvent.fire(r.Sign_Success,t);var e=!1,i=this.model.getRechargeCount();(0==t.status||i>0&&1==t.status)&&(e=!0),this.setWelfareStatus(c.WelfareIcon.sign,e)}},handle16705:function(t){this.model.setYueka(t),gcore.GlobalEvent.fire(r.Update_Yueka,t);var e=!1,i=!1;1==t.card1_is_reward&&(e=!0),1==t.card2_is_reward&&(i=!0),this.setWelfareStatus(c.WelfareIcon.supre_yueka,e),this.setWelfareStatus(c.WelfareIcon.honor_yueka,i)},sender16706:function(t){var e={};e.card_type=t,this.SendProtocal(16706,e)},handle16706:function(t){message(t.msg),1==t.code&&(gcore.GlobalEvent.fire(r.Update_Get_Yueka,t.card_type),1==t.card_type?this.setWelfareStatus(c.WelfareIcon.supre_yueka,!1):2==t.card_type&&this.setWelfareStatus(c.WelfareIcon.honor_yueka,!1))},sender21002:function(){this.SendProtocal(21002,{})},handle21002:function(t){this.model.setRechargeCount(t.count),this.sender14100()},checkCanAdd:function(t){var e=gdata("holiday_client_data","data_info",[t]);return null!=e&&(!(a.getInstance().getRoleVo().lev<e.open_lev)&&(1==e.is_verifyios||(t==c.WelfareIcon.bindphone||(t==c.WelfareIcon.wechat||(t==c.WelfareIcon.poste||(t==c.WelfareIcon.invicode||(t==c.WelfareIcon.share_game||IS_SHOW_CHARGE)))))))},openMainWindow:function(e,i){if(1==e){if(0==IS_SHOW_CHARGE)return;var s=a.getInstance().getRoleVo(),n=Config.holiday_client_data.data_info;if(n&&n[i]&&s.lev<n[i].open_lev)return void message(cc.js.formatStr(Utils.TI18N("\u4eba\u7269\u7b49\u7ea7%s\u5f00\u542f"),n[i].open_lev));var o=null;for(var l in Config.holiday_client_data.data_info){var r=gdata("holiday_client_data","data_info",[l]);if(null==this.welfare_list[r.bid])if(this.checkCanAdd(r.bid))null!=(o=new(t("welfare_sub_tab_vo"))).update&&o.update(r),this.welfare_list[r.bid]=o}this.welfare_win||(this.welfare_win=Utils.createClass("welfare_main_window")),this.welfare_win.open(i)}else null!=this.welfare_win&&(this.welfare_win.close(),this.welfare_win=null)},getWelfareSubList:function(){var e=[],i=t("action_controller");if(null!=this.welfare_list&&null!=Utils.next(this.welfare_list))for(var s in this.welfare_list){var n=this.welfare_list[s],a=!0;if(i.getInstance().isSpecialBid(n.bid))null==i.getInstance().getActionSubTabVo(n.bid)&&(a=!1);else if(n.bid==c.WelfareIcon.quest){var o=this.model.getQuestOpenData();o&&0==o.status&&(a=!1)}else if(n.bid==c.WelfareIcon.bindphone){1==this.checkBindPhoneStatus()&&(a=!1)}else n.bid==c.WelfareIcon.wechat?1!=USE_SDK||"QQ_SDK"!=PLATFORM_TYPR&&"SH_SDK"!=PLATFORM_TYPR?"SH_RH"==PLATFORM_TYPR&&0==SH_RH_IS_SHOW_SUBSCRIBE?a=!1:"SH_RH"==PLATFORM_TYPR&&0==SH_RH_IS_SHOW_SUBSCRIBE&&(a=!1):a=!1:n.bid==c.WelfareIcon.invicode?1==USE_SDK&&"QQ_SDK"==PLATFORM_TYPR&&(a=!1):n.bid==c.WelfareIcon.poste?1==USE_SDK&&"QQ_SDK"==PLATFORM_TYPR&&(a=!1):n.bid==c.WelfareIcon.share_game?1!=USE_SDK||"QQ_SDK"!=PLATFORM_TYPR&&"SH_SDK"!=PLATFORM_TYPR?"SH_RH"==PLATFORM_TYPR&&0==SH_RH_IS_SHOW_SHARE?a=!1:"SH_RH"==PLATFORM_TYPR&&0==SH_RH_IS_SHOW_SHARE&&(a=!1):a=!1:n.bid==c.WelfareIcon.qq_notice?0!=USE_SDK&&"QQ_SDK"==PLATFORM_TYPR||(a=!1):n.bid==c.WelfareIcon.sh_share_game||n.bid==c.WelfareIcon.sh_collect?0!=USE_SDK&&"SH_SDK"==PLATFORM_TYPR||(a=!1):n.bid==c.WelfareIcon.sh_wechat&&(0!=USE_SDK&&"SH_SDK"==PLATFORM_TYPR&&1!=window.SH_SDK_FOLLOW||(a=!1));1==a&&e.push(n)}return null!=Utils.next(e)&&e.sort(Utils.tableLowerSorter(["sort_val"])),e},updateWelfareRedStatus:function(t){if(null!=t&&null!=this.welfare_cache_red&&null!=this.welfare_cache_red[t]){var e=this.welfare_cache_red[t];for(var i in e)this.setWelfareStatus(i,e[i])}},setWelfareStatus:function(t,e){if(0==this.checkCanAdd(t)){var i=gdata("holiday_client_data","data_info",[t]);i&&(null==this.welfare_cache_red[i.open_lev]&&(this.welfare_cache_red[i.open_lev]={}),this.welfare_cache_red[i.open_lev][t]=e)}else{null==this.welfare_status_list&&(this.welfare_status_list=[]);var s=0;1==e&&(s=1);var n={bid:t,num:s},a={bid:t,status:e};this.welfare_status_list[t]=a,this.setPosteWelfareStatus(!0),o.getInstance().setFunctionTipsStatus(l.icon.welfare,n),gcore.GlobalEvent.fire(r.UPDATE_WELFARE_TAB_STATUS,a)}},setPosteWelfareStatus:function(t){},getWelfareStatusByID:function(t){if(this.welfare_status_list)return this.welfare_status_list[t]},handle21008:function(t){this.model.setDailyAwardStatus(t.status),gcore.GlobalEvent.fire(r.Update_Daily_Awawd_Data)},sender21009:function(){this.SendProtocal(21009,{})},handle21009:function(t){message(t.msg)},openSureveyQuestView:function(t){1==t?(this.sureveyQuestWindow||(this.sureveyQuestWindow=Utils.createClass("sureveyquest_window",this)),this.sureveyQuestWindow.open()):this.sureveyQuestWindow&&(this.sureveyQuestWindow.close(),this.sureveyQuestWindow=null)},handle24600:function(t){1!=t.status||0!=t.flag&&1!=t.flag?this.setWelfareStatus(c.WelfareIcon.quest,!1):this.setWelfareStatus(c.WelfareIcon.quest,!0),this.model.setQuestOpenData(t)},sender24601:function(){this.SendProtocal(24601,{})},handle24601:function(t){gcore.GlobalEvent.fire(r.Get_SureveyQuest_Basic,t)},sender24602:function(){this.SendProtocal(24602,{})},handle24602:function(t){gcore.GlobalEvent.fire(r.Get_SureveyQuest_Topic_Content,t)},sender24603:function(t){var e={};e.ret_list=t,this.SendProtocal(24603,e)},handle24603:function(t){message(t.msg),1==t.code&&gcore.GlobalEvent.fire(r.SureveyQuest_Submit,t)},sender24604:function(){this.SendProtocal(24604,{})},handle24604:function(t){message(t.msg),1==t.code&&gcore.GlobalEvent.fire(r.Get_SureveyQuest_Get_Reward,t)},sender21007:function(t){var e={};e.type=t||1,this.SendProtocal(21007,e)},handle21007:function(t){gcore.GlobalEvent.fire(r.Updata_Week_Month_Data,t)}},"handle21008",function(t){this.model.setDailyAwardStatus(t.status),gcore.GlobalEvent.fire(r.Update_Daily_Awawd_Data)}),n(s,"sender21009",function(){this.SendProtocal(21009,{})}),n(s,"handle21009",function(t){message(t.msg)}),n(s,"openCertifyBindPhoneWindow",function(t){t?(null==this.certify_phone&&(this.certify_phone=Utils.createClass("certify_bind_phone_window")),this.certify_phone.open()):this.certify_phone&&(this.certify_phone.close(),this.certify_phone=null)}),n(s,"checkBindPhoneStatus",function(){return"SH_RH"==PLATFORM_TYPR&&0==SH_RH_IS_SHOW_BINDPHONE&&"shmix"==PLATFORM_NAME||(null==this.bind_phone_data||0!=this.bind_phone_data.code||1==USE_SDK&&("QQ_SDK"==PLATFORM_TYPR||"SH_SDK"==PLATFORM_TYPR))}),n(s,"getBindPhoneData",function(){return this.bind_phone_data}),n(s,"handle16635",function(t){"SH_RH"!=PLATFORM_TYPR||0!=SH_RH_IS_SHOW_BINDPHONE||"shmix"!=PLATFORM_NAME?(this.bind_phone_data=t,this.bind_phone_data.status=t.code,0==t.code&&this.setWelfareStatus(c.WelfareIcon.bindphone,!0)):this.setWelfareStatus(c.WelfareIcon.bindphone,!1)}),n(s,"requestBindPhone",function(t,e){var i={};i.number=t,i.code=e,"SH_RH"==PLATFORM_TYPR&&0==SH_RH_IS_SHOW_BINDPHONE&&"shmix"==PLATFORM_NAME||this.SendProtocal(16636,i)}),n(s,"handle16636",function(t){"SH_RH"==PLATFORM_TYPR&&0==SH_RH_IS_SHOW_BINDPHONE&&"shmix"==PLATFORM_NAME||null!=this.bind_phone_data&&(message(t.msg),this.bind_phone_data.status=t.code,0!=t.code&&(1==t.code&&(this.bind_phone_data.code=1,this.openCertifyBindPhoneWindow(!1)),gcore.GlobalEvent.fire(r.UpdateBindPhoneStatus,this.bind_phone_data)))}),n(s,"handle16633",function(t){}),n(s,"tellServerWechatStatus",function(){}),n(s,"handle16634",function(t){}),n(s,"getWechatData",function(){return this.wechat_subscription_data}),n(s,"getWelfareRoot",function(){if(this.welfare_win)return this.welfare_win.root_wnd}),n(s,"send16691",function(){this.SendProtocal(16691,{})}),n(s,"handle16691",function(t){t&&(this.model.setShareAward(t.items),this.model.setShareAwardStatus(t.code),1==t.code&&("SH_SDK"==PLATFORM_TYPR?o.getInstance().removeFunctionIconById(l.icon.shwx_share):o.getInstance().removeFunctionIconById(l.icon.shrh_share)))}),n(s,"send16692",function(t){var e={};e.id=t,this.SendProtocal(16692,e)}),n(s,"handle16692",function(t){message(t.msg),t&&1==t.code&&(this.model.setShareAwardStatus(t.code),gcore.GlobalEvent.fire(r.Update_get_SHRH_share_award_status,t.code),"SH_SDK"==PLATFORM_TYPR?o.getInstance().removeFunctionIconById(l.icon.shwx_share):o.getInstance().removeFunctionIconById(l.icon.shrh_share))}),n(s,"send16693",function(){this.SendProtocal(16693,{})}),n(s,"handle16693",function(t){t&&(this.model.setSubscriptionAward(t.items),this.model.setSubscriptionAwardStatus(t.code),1==t.code&&("SH_SDK"==PLATFORM_TYPR?o.getInstance().removeFunctionIconById(l.icon.shwx_sub):o.getInstance().removeFunctionIconById(l.icon.shrh_sub)))}),n(s,"send16694",function(t){var e={};e.id=t,this.SendProtocal(16694,e)}),n(s,"handle16694",function(t){message(t.msg),t&&1==t.code&&(gcore.GlobalEvent.fire(r.Update_SHRH_Award_Status,1),this.model.setSubscriptionAwardStatus(t.code),"SH_SDK"==PLATFORM_TYPR?o.getInstance().removeFunctionIconById(l.icon.shwx_sub):o.getInstance().removeFunctionIconById(l.icon.shrh_sub))}),n(s,"send16695",function(){this.SendProtocal(16695,{})}),n(s,"handle16695",function(t){t&&(this.model.setCollectAward(t.items),this.model.setCollectAwardStatus(t.code),1==t.code&&o.getInstance().removeFunctionIconById(l.icon.shwx_collect))}),n(s,"send16696",function(){this.SendProtocal(16696,{})}),n(s,"handle16696",function(t){message(t.msg),t&&1==t.code&&(this.model.setCollectAwardStatus(t.code),gcore.GlobalEvent.fire(r.Update_get_SHWX_collect_award_status,1),o.getInstance().removeFunctionIconById(l.icon.shwx_collect))}),n(s,"shrhShareStatus",function(t,e){gcore.GlobalEvent.fire(r.Update_get_SHRH_share_award_status,2)}),n(s,"shrhRealNameStatus",function(t){t&&o.getInstance().removeFunctionIconById(l.icon.shrh_realname)}),n(s,"send16697",function(){this.SendProtocal(16697,{})}),n(s,"handle16697",function(t){"SH_RH"!=PLATFORM_TYPR||0!=SH_RH_IS_SHOW_BINDPHONE||"shmix"!=PLATFORM_NAME?t&&"shmix"==PLATFORM_NAME&&(this.bind_phone_data=t,this.bind_phone_data.status=t.code,0==t.code&&this.setWelfareStatus(c.WelfareIcon.bindphone,!0)):this.setWelfareStatus(c.WelfareIcon.bindphone,!1)}),n(s,"send16698",function(){this.SendProtocal(16698,{})}),n(s,"handle16698",function(t){message(t.msg),this.bind_phone_data.status=t.code,t&&1==t.code&&(this.bind_phone_data.code=t.code,gcore.GlobalEvent.fire(r.UpdateBindPhoneStatus,1))}),s));e.exports=_,cc._RF.pop()},{action_controller:"action_controller",guide_controller:"guide_controller",mainui_const:"mainui_const",mainui_controller:"mainui_controller",role_controller:"role_controller",welfare_const:"welfare_const",welfare_event:"welfare_event",welfare_model:"welfare_model",welfare_sub_tab_vo:"welfare_sub_tab_vo"}],welfare_event:[function(t,e,i){"use strict";cc._RF.push(e,"92615i8xulAy7gVEbJ4wLlU","welfare_event"),e.exports={UPDATE_WELFARE_TAB_STATUS:"UPDATE_WELFARE_TAB_STATUS",Update_Wish_Status:"Update_Wish_Status",Update_Sign_Info:"Update_Sign_Info",Sign_Success:"Sign_Success",Update_Lev_Gift:"Update_Lev_Gift",Update_Lev_Gift_Info:"Update_Lev_Gift_Info",Update_Power_Gift:"Update_Power_Gift",Update_Power_Gift_Info:"Update_Power_Gift_Info",Update_Yueka:"Update_Yueka",Update_Get_Yueka:"Update_Get_Yueka",Get_PartnerSummon_Data:"Get_PartnerSummon_Data",Get_SureveyQuest_Basic:"Get_SureveyQuest_Basic",Get_SureveyQuest_Topic_Content:"Get_SureveyQuest_Topic_Content",Get_SureveyQuest_Get_Reward:"Get_SureveyQuest_Get_Reward",SureveyQuest_Submit:"SureveyQuest_Submit",Updata_Week_Month_Data:"Updata_Week_Month_Data",Updata_Luxury_Data:"Updata_Luxury_Data",Update_Daily_Awawd_Data:"Update_Daily_Awawd_Data",UpdateBindPhoneStatus:"UpdateBindPhoneStatus",Update_SHRH_Award_Status:"Update_SHRH_Award_Status",Update_get_SHRH_Award_Status:"Update_get_SHRH_Award_Status",Update_get_SHRH_share_award_status:"Update_get_SHRH_share_award_status",Update_get_SHWX_collect_award_status:"Update_get_SHWX_collect_award_status",Update_SHWX_show_scene_val:"Update_SHWX_show_scene_val"},cc._RF.pop()},{}],welfare_main_window:[function(t,e,i){"use strict";cc._RF.push(e,"41dbb7vmw9KApsrv0m+tTYS","welfare_main_window");var s=t("pathtool"),n=t("welfare_const"),a=t("welfare_controller"),o=t("welfare_event"),l=t("action_event"),r=t("action_const"),c=t("action_controller"),_=t("mainui_const");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("welfare","welfare_main_view"),this.viewTag=SCENE_TAG.ui,this.win_type=WinType.Full},initConfig:function(){this.sub_list=[],this.tab_list={},this.tab_width=78,this.off_space=50,this.panel_list={},this.selected_tab=null,this.selected_panel=null,this.ctrl=a.getInstance(),this.model=this.ctrl.getModel(),this.action_ctrl=c.getInstance()},openCallBack:function(){this.background=this.seekChild("background"),this.background.scale=this.background.scale*FIT_SCALE,this.main_container_nd=this.seekChild("main_container"),this.main_panel_nd=this.seekChild(this.main_container_nd,"main_panel"),this.container_nd=this.seekChild(this.main_panel_nd,"container"),this.close_btn_nd=this.seekChild(this.main_container_nd,"close_btn"),this.tab_container_nd=this.seekChild(this.main_container_nd,"tab_container"),this.tab_scroll_nd=this.seekChild(this.tab_container_nd,"tab_scroll"),this.tab_scroll_sv=this.seekChild(this.tab_container_nd,"tab_scroll",cc.ScrollView),this.tab_scroll_content_nd=this.seekChild(this.tab_scroll_nd,"content"),this.loadRes(s.getBigBg("welfare/welfare_bg","jpg"),function(t){this.background.getComponent(cc.Sprite).spriteFrame=t}.bind(this)),this.loadRes(s.getBigBg("welfare/welfare_bg_1"),function(t){this.main_panel_nd.getChildByName("tab_sprite_bg").getComponent(cc.Sprite).spriteFrame=t}.bind(this))},registerEvent:function(){Utils.onTouchEnd(this.close_btn_nd,function(){this.ctrl.openMainWindow(!1)}.bind(this),1),this.addGlobalEvent(o.UPDATE_WELFARE_TAB_STATUS,function(t){this.setTabStatus(t.bid)},this),this.addGlobalEvent(l.UPDATE_HOLIDAY_TAB_STATUS,function(t,e){t==r.ActionType.Wonderful&&this.action_ctrl.isSpecialBid(e.bid)&&this.setTabStatus(e.bid)},this),this.addGlobalEvent(l.UPDATA_FUND_RED_STATUS_EVENT,function(){this.auto_bid==_.icon.fund&&this.setTabStatus(this.selected_tab.getData().bid)}.bind(this))},openRootWnd:function(t){if(t)if(t==_.icon.fund){for(var e=c.getInstance().getModel().getOpenFundIds(),i=0;i<e.length;++i){var s=e[i],a=Config.month_fund_data.data_fund_data[s.id];if(a){var o={};o.bid=s.id,o.title=a.name,o.ico=a.icon_id,this.sub_list.push(o)}}this.sub_list.sort(Utils.tableCommonSorter([["bid",!1]]))}else this.sub_list=this.ctrl.getWelfareSubList();else this.sub_list=this.ctrl.getWelfareSubList();this.auto_bid=t||n.WelfareIcon.sign,this.createSubType()},createSubType:function(){var e=this;if(null==this.sub_list||null==Utils.next(this.sub_list));else{var i=Utils.getArrLen(this.sub_list),s=i*(this.tab_width+this.off_space)+110;this.max_width=Math.max(this.tab_scroll_nd.width,s),this.tab_scroll_content_nd.width=this.max_width,this.tab_scroll_sv.scrollToLeft(0);for(var a=function(e){if(e.getData().bid==n.WelfareIcon.quest)this.ctrl.openSureveyQuestView(!0);else if(this.handleSelectedTab(e),e.getData().bid==r.FundType.type_one||e.getData().bid==r.FundType.type_two){var i=t("action_controller").getInstance().getModel();e.getData().bid==r.FundType.type_one?i.updateFundRedStatus(r.FundRedIndex.fund_buy_one,!1):i.updateFundRedStatus(r.FundRedIndex.fund_buy_two,!1)}}.bind(this),o=-1,l=null,c=null,h=null,d=function(i){var s=e.sub_list[i];Utils.delayRun(e.tab_scroll_content_nd,.01*Number(i),function(){if(null!=s&&null!=s.bid&&null==this.tab_list[s.bid]){var e=t("welfare_tab_panel");(l=new e).show(),l.setData(s),c=i*(this.tab_width+this.off_space)+110,l.setPosition(c,-68),l.setClickCallBack(a),l.setParent(this.tab_scroll_content_nd),this.tab_list[s.bid]=l,null!=this.auto_bid&&(this.auto_bid==s.bid?o=i:this.auto_bid!=_.icon.fund||s.bid!=r.FundType.type_one&&s.bid!=r.FundType.type_two||(o=0)),this.setTabStatus(s.bid)}}.bind(e))},u=0;u<i;u++)d(u);this.timer_hander=this.startUpdate(20,function(){null!=(h=this.sub_list[o])&&(o&&1!=o&&this.tab_scroll_sv.scrollToPercentHorizontal(o/i,.5),this.handleSelectedTab(this.tab_list[h.bid]),this.stopUpdate(this.timer_hander))}.bind(this),100)}},setTabStatus:function(e){var i;if(e==r.FundType.type_one||e==r.FundType.type_two){var s=t("action_controller").getInstance().getModel();e==r.FundType.type_one?(i=s.getFundRedStatusByBid(r.FundRedIndex.fund_get_one))||(i=s.getFundRedStatusByBid(r.FundRedIndex.fund_buy_one)):e==r.FundType.type_two&&((i=s.getFundRedStatusByBid(r.FundRedIndex.fund_get_two))||(i=s.getFundRedStatusByBid(r.FundRedIndex.fund_buy_two)))}else i=this.ctrl.getWelfareStatusByID(e);this.action_ctrl.isSpecialBid(e)&&(i=this.action_ctrl.getHolidayAweradsStatus(e));var n=this.tab_list[e];null!=n&&(null==i||0==i.status||0==i?n.updateTipsStatus&&n.updateTipsStatus(!1):n.updateTipsStatus&&n.updateTipsStatus(!0))},handleSelectedTab:function(t){null!=this.selected_tab&&this.selected_tab==t||(null!=this.selected_tab&&this.selected_tab.setSelected(!1),this.selected_tab=t,null!=this.selected_tab&&this.selected_tab.setSelected(!0),this.changePanelByTab())},changePanelByTab:function(){if(null!=this.selected_tab&&null!=this.selected_tab.data){var e=this.selected_tab.data;if(null!=e.bid&&0!=e.bid&&(null!=e.panel_type&&0!=e.panel_type&&null!=n.WelfarePanelTypeView[e.panel_type]||e.bid==r.FundType.type_one||e.bid==r.FundType.type_two)){if(null!=this.selected_panel&&(this.selected_panel.setVisibleStatus?this.selected_panel.setVisibleStatus(!1):this.selected_panel.setVisible(!1),this.selected_panel=null),null==this.panel_list[e.bid]){var i=n.WelfarePanelTypeView[e.panel_type];if(i)null==this.panel_list[e.bid]&&(this.panel_list[e.bid]=Utils.createClass(i),this.panel_list[e.bid].show(e.bid),this.panel_list[e.bid].setParent(this.container_nd));else{var s;if(e.bid==r.FundType.type_one||e.bid==r.FundType.type_two)s=new(t("action_fund_one_panel"))(e.bid);s&&(this.panel_list[e.bid]=s,this.panel_list[e.bid].show(),this.panel_list[e.bid].setParent(this.container_nd),this.panel_list[e.bid].setPosition(0,-20))}}this.selected_panel=this.panel_list[e.bid],null!=this.selected_panel&&(this.selected_panel.setVisibleStatus?this.selected_panel.setVisibleStatus(!0):this.selected_panel.setVisible(!0))}}},closeCallBack:function(){for(var t in this.panel_list)this.panel_list[t].deleteMe&&(this.panel_list[t].deleteMe(),this.panel_list[t]=null);for(var t in this.panel_list=null,this.tab_list)this.tab_list[t].deleteMe&&(this.tab_list[t].deleteMe(),this.tab_list[t]=null);this.tab_list=null,this.tab_scroll_content_nd.stopAllActions(),this.ctrl.openMainWindow(!1)}});cc._RF.pop()},{action_const:"action_const",action_controller:"action_controller",action_event:"action_event",action_fund_one_panel:"action_fund_one_panel",mainui_const:"mainui_const",pathtool:"pathtool",welfare_const:"welfare_const",welfare_controller:"welfare_controller",welfare_event:"welfare_event",welfare_tab_panel:"welfare_tab_panel"}],welfare_model:[function(t,e,i){"use strict";cc._RF.push(e,"59603epoM5B0qWPofuy3wHr","welfare_model");var s=t("role_controller"),n=t("welfare_const"),a=t("partnersummon_controller"),o=t("action_controller"),l=t("vip_controller"),r=cc.Class({extends:BaseClass,ctor:function(){},initConfig:function(){this.daily_award_status=1},setYueka:function(t){this.yueka_data=t},getYueka:function(){return this.yueka_data},setRechargeCount:function(t){this.recharge_num=t},checkWelfareSubIsOpen:function(t){var e=gdata("holiday_client_data","data_info",[t]);if(e){var i=s.getInstance().getRoleVo();if((IS_SHOW_CHARGE||0==IS_SHOW_CHARGE&&1==e.is_verifyios)&&i.lev>=e.open_lev)return!0}return!1},getYuekaStatus:function(){var t=!0;if(this.checkWelfareSubIsOpen(n.WelfareIcon.yueka))if(null==this.yueka_data)t=!0;else{var e=gcore.SmartSocket.getTime();this.yueka_data.card1_end_time&&this.yueka_data.card2_end_time&&(t=this.yueka_data.card1_end_time<e||this.yueka_data.card2_end_time<e)}else t=!1;return t},getRechargeCount:function(){return this.recharge_num||0},reverseTable:function(t){return t.reverse()},getPartnerSummonData:function(){var t=Config.recruit_award_data.data_huoli,e={},i={},s={},n={};for(var o in t){0==(c=t[o]).type?e.push(c):200==c.type?i.push(c):300==c.type?s.push(c):400==c.type&&n.push(c)}var l=a.getInstance().getModel().getOpenSummonData(),r=[];for(var o in l){var c;if(200==(c=l[o]))for(var _ in i)r.push(i[_]);else if(300==c)for(var _ in s)r.push(s[_]);else if(400==c)for(var _ in n)r.push(n[_])}for(var o in r=this.reverseTable(r))e.push(r[o]);return e=this.reverseTable(e)},getServeData:function(t){var e=[],i=this.getPartnerSummonData(),s=[];for(var n in t){var a=t[n];for(var l in i){var r=i[l];a.id==r.id&&s.push(a)}}var c=o.getInstance().getModel();for(var n in s=c.getReawardSortList(s)){a=s[n];for(var l in i){var _=i[l];a.id==_.id&&e.push(_)}}return this.setPartnerWelfarCallRedPoint(s),{open_data:s,list:e}},setPartnerWelfarCallRedPoint:function(t){this.callPartnerData=t},getPartnerWelfarCallRedPoint:function(){if(this.callPartnerData&&null!=Utils.next(this.callPartnerData)){var t=!1;for(var e in this.callPartnerData){if(1==this.callPartnerData[e].status){t=!0;break}}return t}},setPartnerSunmonWelfarData:function(t){this.summonWelfarBool=t},getPartnerSunmonWelfarData:function(){var t=!1;return 1==this.summonWelfarBool&&(t=!0),t},setQuestOpenData:function(t){this.questOpenData=t},getQuestOpenData:function(){return this.questOpenData},setWeekMonthSortData:function(){var t=Config.misc_data.data_cycle_gift_info;for(var e in this.weekGiftData=[],this.monthGiftData=[],t){var i=t[e];if(i)for(var s in i){var n=i[s];1==n.gift_type?this.weekGiftData.push(n):2==n.gift_type&&this.monthGiftData.push(n)}}this.weekGiftData.sort(Utils.tableLowerSorter(["charge_id"])),this.monthGiftData.sort(Utils.tableLowerSorter(["charge_id"]))},getWeekMonthSortData:function(t){if(this.weekGiftData&&this.monthGiftData)return 1==t?this.weekGiftData||[]:2==t?this.monthGiftData||[]:void 0},setDailyAwardStatus:function(t){this.daily_award_status=t,0==t?l.getInstance().setTipsVIPStstus(VIPREDPOINT.DAILY_AWARD,!0):l.getInstance().setTipsVIPStstus(VIPREDPOINT.DAILY_AWARD,!1)},getDailyAwardStatus:function(){return this.daily_award_status},setShareAward:function(t){this.share_award=t},getShareAward:function(){return this.share_award||[]},setShareAwardStatus:function(t){this.share_award_status=t},getShareAwardStatus:function(){return this.share_award_status||0},setSubscriptionAward:function(t){this.subscription_award=t},setSubscriptionAwardStatus:function(t){this.subscription_award_status=t},getSubscriptionAwardStatus:function(){return this.subscription_award_status||0},getSubscriptionAward:function(){return this.subscription_award||[]},setCollectAward:function(t){this.collect_award=t},getCollectAward:function(){return this.collect_award||[]},setCollectAwardStatus:function(t){this.collect_award_status=t},getCollectAwardStatus:function(){return this.collect_award_status||0}});e.exports=r,cc._RF.pop()},{action_controller:"action_controller",partnersummon_controller:"partnersummon_controller",role_controller:"role_controller",vip_controller:"vip_controller",welfare_const:"welfare_const"}],welfare_sub_tab_vo:[function(t,e,i){"use strict";cc._RF.push(e,"3d134tAcjlDKL9b/L6Fx/qn","welfare_sub_tab_vo");var s=cc.Class({extends:gcore.BaseEvent,ctor:function(){this.bid=0,this.sort_val=0,this.title="",this.ico="",this.type_ico=0,this.panel_type=0,this.reward_title="",this.aim_title="",this.title2="",this.top_banner="",this.rule_str="",this.time_str="",this.bottom_alert="",this.channel_ban="",this.remain_sec=0,this.tips_status=!1},update:function(t){if(t)for(var e in t)this.setParam(e,t[e])},setTipsStatus:function(t){this.tips_status=0!=t},setParam:function(t,e){this[t]!=e&&(this[t]=e)},_delete:function(){}});e.exports=s,cc._RF.pop()},{}],welfare_tab_panel:[function(t,e,i){"use strict";cc._RF.push(e,"91609Jd66ZAWpni1wPJULro","welfare_tab_panel");var s=t("pathtool");cc.Class({extends:BasePanel,ctor:function(){this.prefabPath=s.getPrefabPath("welfare","welfare_tab")},initConfig:function(){},initPanel:function(){this.main_container_nd=this.seekChild("main_container"),this.name_lb=this.seekChild("name",cc.Label),this.red_point_nd=this.seekChild("red_point"),this.icon_sp=this.seekChild("icon",cc.Sprite),this.select_nd=this.seekChild("select"),null!=this.red_status&&this.updateTipsStatus(this.red_status),null!=this.select_status&&this.setSelected(this.select_status)},registerEvent:function(){this.root_wnd.on(cc.Node.EventType.TOUCH_END,function(){null!=this.call_back&&(Utils.playButtonSound(1),this.call_back(this))},this)},setData:function(t){this.data=t,this.root_wnd&&this.onShow()},onShow:function(){if(null!=this.data){this.name_lb.string=this.data.title;var t=s.getIconPath("welfare/action_icon","welfare_icon_"+(this.data.ico||1));this.loadRes(t,function(t){this.icon_sp.spriteFrame=t}.bind(this))}},updateTipsStatus:function(t){null!=this.root_wnd?this.red_point_nd.active=t:this.red_status=t},getData:function(){return this.data},setSelected:function(t){null!=this.root_wnd?this.select_nd.active=t:this.select_status=t},setClickCallBack:function(t){this.call_back=t},onHide:function(){},onDelete:function(){}});cc._RF.pop()},{pathtool:"pathtool"}],worldmap_controller:[function(t,e,i){"use strict";cc._RF.push(e,"395efSzHtdCHZloLl2NV/QN","worldmap_controller");var s=cc.Class({extends:BaseController,ctor:function(){},initConfig:function(){var e=t("worldmap_model");this.model=new e,this.model.initConfig()},getModel:function(){return this.model},registerEvents:function(){},registerProtocals:function(){},openWorldMapMainWindow:function(t,e){0==t?null!=this.worldmap_window&&(this.worldmap_window.close(),this.worldmap_window=null):(null==this.worldmap_window&&(this.worldmap_window=Utils.createClass("worldmap_main_window",this)),this.worldmap_window&&0==this.worldmap_window.isOpen()&&this.worldmap_window.open(e))},__delete:function(){null!=this.model&&(this.model.DeleteMe(),this.model=null)}});e.exports=s,cc._RF.pop()},{worldmap_model:"worldmap_model"}],worldmap_item:[function(t,e,i){"use strict";cc._RF.push(e,"31bae3rDjJND6gEhy7c8h0j","worldmap_item");t("../../partner/partner_event");var s=t("battle_drama_controller"),n=t("worldmap_controller"),a=t("battle_drama_event"),o=t("battle_controller");cc.Class({extends:BaseClass,ctor:function(){this.ctrl=s.getInstance(),this.model=this.ctrl.getModel(),this.config=arguments[0],this.size=cc.size(50,50),this.scale=4,this.open_data=arguments[1],this.createRootWnd()},createRootWnd:function(){this.root_wnd=new cc.Node("map_item"),this.root_wnd.setAnchorPoint(.5,.5),this.root_wnd.setContentSize(this.size);var t=this.root_wnd.addComponent(cc.Button);t.transition=cc.Button.Transition.SCALE,t.duration=.1,t.zoomScale=.9;var e=new cc.Node;e.setAnchorPoint(.5,.5),e.setPosition(.5*this.size.width,.5*this.size.height),this.root_wnd.addChild(e),this.effect=e.addComponent(sp.Skeleton);var i=PathTool.getSpinePath(PathTool.getEffectRes(119),"action");LoaderManager.getInstance().loadRes(i,function(t){this.effect&&(this.effect.skeletonData=t,this.effect.setAnimation(0,PlayerAction.action_4,!0),this.fillData())}.bind(this)),this.progress_bg=Utils.createImage(this.root_wnd,null,.5*this.size.width,80,cc.v2(.5,.5)),LoaderManager.getInstance().loadRes(PathTool.getUIIconPath("worldmap","worldmap_1008"),function(t){this.progress_bg.spriteFrame=t}.bind(this)),this.progress_label=Utils.createLabel(18,new cc.Color(255,255,255,255),null,0,0,"",this.progress_bg.node,null,cc.v2(.5,.5)),this.name_bg=Utils.createImage(this.root_wnd,null,.5*this.size.width,-20,cc.v2(.5,.5)),LoaderManager.getInstance().loadRes(PathTool.getUIIconPath("worldmap","worldmap_1006"),function(t){this.name_bg.spriteFrame=t}.bind(this)),this.name_label=Utils.createLabel(18,new cc.Color(104,69,42,255),null,.5*this.size.width,-15,this.config.name,this.root_wnd,null,cc.v2(.5,.5)),this.click_layout=new cc.Node,this.click_layout.setContentSize(cc.size(100,100)),this.click_layout.setAnchorPoint(.5,.5),this.click_layout.setPosition(25,25),this.root_wnd.addChild(this.click_layout,90),this.registerEvent()},registerEvent:function(){Utils.onTouchEnd(this.click_layout,function(){this.call_back&&this.call_back();var t=this.model.getOpenSumChapter(this.drama_data.mode);if(this.drama_data)if(this.config.bid<=t&&this.config.bid!=this.drama_data.chapter_id){var e=this.model.getChapterListByID(this.drama_data.mode,this.config.bid),i=this.model.getHasPassChapterMaxDunId(this.drama_data.mode,this.config.bid);if(e&&0!=i){var s=this.model.getDramaData();s.mode=this.drama_data.mode,s.chapter_id=this.config.bid,s.dun_id=i,this.model.setDramaData(s)}else this.ctrl.send13002();n.getInstance().openWorldMapMainWindow(!1)}else this.config.bid==this.drama_data.chapter_id?this.open_data?n.getInstance().openWorldMapMainWindow(!1):message(Utils.TI18N("\u5df2\u5728\u5f53\u524d\u7ae0\u8282")):message(Utils.TI18N("\u524d\u9762\u7ae0\u8282\u6682\u6ca1\u901a\u5173"))}.bind(this),1),this.battle_event||(this.battle_event=gcore.GlobalEvent.getInstance().bind(a.BattleDrama_Drama_Unlock_View,function(t){this.config&&this.config.bid==t.bid&&n.getInstance().openWorldMapMainWindow(!1)}.bind(this)))},addToParent:function(t,e){t&&this.config&&(t.addChild(this.root_wnd),e&&(this.call_back=e),this.root_wnd.setPosition(this.config.x,this.config.y))},openEffect:function(){if(this.effect){var t=this;this.effect.setCompleteListener(function(){t.ctrl.openBattleDramaUnlockChapterView(!0,t.config),o.getInstance().setUnlockChapterStatus(!1)}),this.effect.setAnimation(0,PlayerAction.action_6,!1)}},fillData:function(){if(this.drama_data=this.model.getDramaData(),null!=this.config&&null!=this.drama_data){this.progress_bg.node.active=this.config.bid<=this.drama_data.chapter_id,this.progress_label.string=cc.js.formatStr("%s/%s",this.model.getHasCurChapterPassListNum(a.BattleDramaConst.Normal,this.config.bid),this.model.getChapterLength(a.BattleDramaConst.Normal,this.config.bid));var t=this.model.getOpenSumChapter(this.drama_data.mode);this.config.bid==this.drama_data.chapter_id?this.open_data?this.openEffect():this.effect.setAnimation(0,PlayerAction.action_1,!0):this.config.bid<t?this.effect.setAnimation(0,PlayerAction.action_3,!0):this.config.bid>t&&this.effect.setAnimation(0,PlayerAction.action_5,!0)}},clearEffect:function(){this.finger_effect&&(this.finger_effect.setToSetupPose(),this.finger_effect.clearTracks(),this.finger_effect=null),this.after_effect&&(this.after_effect.setToSetupPose(),this.after_effect.clearTracks(),this.after_effect=null),this.open_effect&&(this.open_effect.setToSetupPose(),this.open_effect.clearTracks(),this.open_effect=null)},DeleteMe:function(){for(var t in this.item_container&&this.item_container.stopAllActions(),this.item_list)this.item_list[t].DeleteMe();this.item_list=null,this.battle_event&&(gcore.GlobalEvent.getInstance().unbind(this.battle_event),this.battle_event=null)}});cc._RF.pop()},{"../../partner/partner_event":"partner_event",battle_controller:"battle_controller",battle_drama_controller:"battle_drama_controller",battle_drama_event:"battle_drama_event",worldmap_controller:"worldmap_controller"}],worldmap_land:[function(t,e,i){"use strict";cc._RF.push(e,"7f86aaVA5BKhbErVZ2PRfV/","worldmap_land");t("../../partner/partner_event"),cc.Class({extends:BaseClass,ctor:function(){this.config=arguments[0],this.land_id=arguments[1],this.click_callback=arguments[2],this.size=cc.size(100,38),this.scale=2,this.item_list={},this.had_unlock=!1,this.open_chapter_data=arguments[3],this.createRootWnd()},createRootWnd:function(){this.root_wnd=new cc.Node("lang_item"),this.root_wnd.setAnchorPoint(.5,0),this.root_wnd.setContentSize(this.size),this.land_id>=this.config.bid?(this.name_container=Utils.createImage(this.root_wnd,null,this.config.name_x-50,this.config.name_y,cc.v2(.5,.5),!1),LoaderManager.getInstance().loadRes(PathTool.getUIIconPath("worldmap","worldmap_1007"),function(t){this.name_container.spriteFrame=t}.bind(this)),this.name_label=Utils.createLabel(20,new cc.Color(255,255,255,255),new cc.Color(10,15,15,255),0,10,this.config.name,this.name_container.node,1,cc.v2(.5,.5)),this.had_unlock=!0):this.config.bid>1&&LoaderManager.getInstance().loadRes(PathTool.getBigBg(cc.js.formatStr("worldmap_100%s",this.config.bid),null,"worldmap"),function(t){this.mainland=Utils.createImage(this.root_wnd,null,.5*this.size.width-50,.5*this.size.height,cc.v2(.5,.5),!1),this.mainland.node.setScale(this.scale),this.mainland.spriteFrame=t}.bind(this)),1==this.had_unlock&&(this.click_layout=new cc.Node,this.click_layout.setAnchorPoint(.5,.5),this.root_wnd.addChild(this.click_layout,10),1==this.config.bid?(this.click_layout.setPosition(4,-14),this.click_layout.setContentSize(cc.size(440,300))):2==this.config.bid?(this.click_layout.setPosition(-7,17),this.click_layout.setContentSize(cc.size(600,200))):3==this.config.bid?(this.click_layout.setPosition(81,-5),this.click_layout.setContentSize(cc.size(500,300))):4==this.config.bid?(this.click_layout.setPosition(-28,49),this.click_layout.setContentSize(cc.size(200,380))):5==this.config.bid&&(this.click_layout.setPosition(44,14),this.click_layout.setContentSize(cc.size(200,380)))),this.registerEvent()},registerEvent:function(){this.click_layout&&this.click_layout.on(cc.Node.EventType.TOUCH_START,function(t){var e=t.getTouches();this.touch_began=e[0].getLocation()},this),this.click_layout&&this.click_layout.on(cc.Node.EventType.TOUCH_END,function(t){var e=t.getTouches();this.touch_end=e[0].getLocation();var i=!0;null!=this.touch_began&&(i=Math.abs(this.touch_end.x-this.touch_began.x)<=20&&Math.abs(this.touch_end.y-this.touch_began.y)<=20),1==i&&this.clickHandler()},this)},clickHandler:function(){this.click_callback&&this.click_callback(this)},addToParent:function(t){t&&this.config&&this.root_wnd&&(t.addChild(this.root_wnd),this.root_wnd.setPosition(this.config.x,this.config.y-640))},setSelectedLand:function(t){if(1==t){if(this.item_list)for(var e in this.item_list)this.item_list[e].clearEffect();this.name_container&&(this.name_container.node.active=!1),this.click_layout&&(this.click_layout.active=!1),null==this.item_container&&(this.item_container=new cc.Node,this.item_container.setContentSize(this.size),this.item_container.setAnchorPoint(cc.v2(0,0)),this.item_container.setPosition(cc.v2(-70,-30)),this.root_wnd.addChild(this.item_container)),this.item_container.active=!0,this.createItemList()}else this.click_layout&&(this.click_layout.active=!0),this.name_container&&(this.name_container.node.active=!0),this.item_container&&(this.item_container.active=!1)},createItemList:function(){if(null!=this.config&&null!=this.config.dungeon_list){var e=function(){if(this.item_list)for(var t in this.item_list)this.item_list[t].clearEffect()}.bind(this);for(var i in this.config.dungeon_list){var s=this.config.dungeon_list[i];if(null==this.item_list[s.bid]){var n=t("worldmap_item");this.item_list[s.bid]=new n(s,this.open_chapter_data),this.item_list[s.bid].addToParent(this.item_container,e)}}}},DeleteMe:function(){for(var t in this.item_container&&this.item_container.stopAllActions(),this.item_list)this.item_list[t].DeleteMe();this.item_list=null}});cc._RF.pop()},{"../../partner/partner_event":"partner_event",worldmap_item:"worldmap_item"}],worldmap_main_window:[function(t,e,i){"use strict";cc._RF.push(e,"72db9YV6MtIQIJjhgloBx6+","worldmap_main_window");var s=t("pathtool"),n=t("battle_drama_controller"),a=t("battle_controller");cc.Class({extends:BaseView,ctor:function(){this.prefabPath=s.getPrefabPath("worldmap","world_map_windows"),this.viewTag=SCENE_TAG.ui,this.win_type=WinType.Full,this.ctrl=arguments[0],this.model=this.ctrl.getModel()},initConfig:function(){this.config=Config.dungeon_scene_data,this.size=cc.size(this.config.width,this.config.height),this.land_list=[]},openCallBack:function(){this.map_wnd=this.root_wnd.getChildByName("map_wnd"),this.map_wnd.setContentSize(cc.size(1600,1280)),this.map_wnd.scale=FIT_SCALE;var t=s.getUIIconPath("worldmap","blayer","jpg");this.map_layer=this.map_wnd.addComponent(cc.Sprite),this.map_layer.type=cc.Sprite.Type.SIMPLE,this.map_layer.sizeMode=cc.Sprite.SizeMode.CUSTOM,this.loadRes(t,function(t){this.map_layer.spriteFrame=t}.bind(this)),this.top_info_container=this.root_wnd.getChildByName("top_info_container"),this.top_info_container.y=1025*FIT_SCALE,this.return_btn=this.top_info_container.getChildByName("return_btn")},registerEvent:function(){Utils.onTouchEnd(this.return_btn,function(){this.ctrl.openWorldMapMainWindow(!1,this.data)}.bind(this),1),this.map_wnd.on(cc.Node.EventType.TOUCH_START,function(t){return this.last_point=null,this.map_layer.node.stopAllActions(),!0},this),this.map_wnd.on(cc.Node.EventType.TOUCH_MOVE,function(t){var e=t.getTouches();this.last_point=e[0].getDelta(),this.moveMainScene(this.last_point.x)},this),this.map_wnd.on(cc.Node.EventType.TOUCH_END,function(t){if(this.last_point){var e=3*this.last_point.x,i=this.map_layer.node.x+e,s=this.scaleCheckPoint(i),n=cc.moveTo(1,cc.v2(s,this.map_wnd.height/2)),a=cc.callFunc(function(){});n.easing(cc.easeSineOut()),this.map_layer.node.runAction(cc.sequence(n,a))}},this)},moveMainScene:function(t){t=this.map_layer.node.x+t;var e=this.scaleCheckPoint(t);this.updateMainScene(e)},scaleCheckPoint:function(t){return t>0?t=0:t<SCREEN_WIDTH-this.map_layer.node.width*FIT_SCALE&&(t=SCREEN_WIDTH-this.map_layer.node.width*FIT_SCALE),t},updateMainScene:function(t,e){e=e||0,this.map_layer.node.setPosition(t,this.map_wnd.height/2+e)},openRootWnd:function(t){this.data=t,this.data&&a.getInstance().setUnlockChapterStatus(!0);var e=n.getInstance().getModel().getDramaData();if(null!=e){var i=e.dun_id;this.data&&(i=this.data.dun_id);var o=gdata("dungeon_data","data_drama_dungeon_info",i);null!=o&&(this.dungeon_config=o,this.createWorldLand(),this.updateScenePos())}gcore.Timer.set(function(){var t=new cc.Node;t.setAnchorPoint(0,0),t.setPosition(0,-this.map_wnd.height/2),this.map_layer.node.addChild(t),this.spine=t.addComponent(sp.Skeleton);var e=s.getSpinePath(s.getEffectRes(199),"action");LoaderManager.getInstance().loadRes(e,function(t){this.spine&&(this.spine.skeletonData=t,this.spine.setAnimation(0,PlayerAction.action,!0))}.bind(this))}.bind(this),.2,1)},createWorldLand:function(){if(null!=this.config&&null!=this.config.building_list){var e=function(t){this.selectedMainLandItem(t)}.bind(this),i=n.getInstance().getModel().getCurMaxChapterId(n.getInstance().getModel().getDramaData().mode);for(var s in this.config.building_list){var a=this.config.building_list[s];gcore.Timer.set(function(s){if(null==this.land_list[s.bid]){1;var n=t("worldmap_land");this.land_list[s.bid]=new n(s,i,e,this.data),this.land_list[s.bid].addToParent(this.map_layer.node),this.land_list[s.bid].info_data=s,s.bid==this.dungeon_config.land_id&&this.selectedMainLandItem(this.land_list[s.bid])}}.bind(this,a),1*s/60,1)}}},updateScenePos:function(){var t;if(n.getInstance().getModel().getDramaData()&&(t=n.getInstance().getModel().getDramaData().max_dun_id),this.data&&(t=this.data.dun_id),t&&gdata("dungeon_data","data_drama_dungeon_info",t)){var e=gdata("dungeon_data","data_drama_dungeon_info",t).next_id;0==e&&(e=t),gdata("dungeon_data","data_drama_dungeon_info",e)&&(this.target_config=gdata("dungeon_data","data_drama_dungeon_info",e));var i,s=null;if(null!=this.target_config)for(var a in this.land_list)if(this.land_list[a].info_data.bid==this.target_config.land_id){s=this.land_list[a].info_data;break}if(this.init_x=0,this.init_y=.5*(SCREEN_HEIGHT-this.size.height),s)if(s=null)this.init_x=.5*(SCREEN_WIDTH-this.size.width);else i=s.x<SCREEN_WIDTH/2?0:s.x>this.size.width-SCREEN_WIDTH/2?SCREEN_WIDTH-this.size.width:SCREEN_WIDTH/2-s.x,this.init_x=i;this.updateMainScene(this.init_x,this.init_y)}},selectedMainLandItem:function(t){t&&(null!=this.cur_main_land&&this.cur_main_land==t||(null!=this.cur_main_land&&(this.cur_main_land.setSelectedLand(!1),this.cur_main_land=null),this.cur_main_land=t,this.cur_main_land.setSelectedLand(!0)))},closeCallBack:function(){for(var t in this.map_layer&&this.map_layer.node.stopAllActions(),this.map_wnd&&this.map_wnd.stopAllActions(),this.spine&&(this.spine.setToSetupPose(),this.spine.clearTracks(),this.spine=null),a.getInstance().setUnlockChapterStatus(!1),this.land_list)this.land_list[t].DeleteMe();this.land_list=[],this.ctrl.openWorldMapMainWindow(!1,this.data)}});cc._RF.pop()},{battle_controller:"battle_controller",battle_drama_controller:"battle_drama_controller",pathtool:"pathtool",worldmap_land:"worldmap_land"}],worldmap_model:[function(t,e,i){"use strict";cc._RF.push(e,"27ee8SRuSBOsIUmL29nswKr","worldmap_model");cc.Class({extends:BaseClass,ctor:function(){},properties:{},initConfig:function(){}});cc._RF.pop()},{}],wx_sdk:[function(t,e,i){"use strict";cc._RF.push(e,"2d077OaeBRL8JWTIOk7HYAN","wx_sdk"),window.PACKAGE_NAME="\u95ea\u70c1\u4e4b\u5149\u53e3\u888b\u7248";var s=t("login_controller"),n=t("role_controller"),a=(t("sha1.min"),function(){wx=null});a.account_info=null,a.user_info=null,a.initSDK=function(){console.log("\u5fae\u4fe1SDK\u76f8\u5173"),console.log(window),window.wx&&(this.initTopInfo(),wx.setKeepScreenOn({keepScreenOn:!0}),wx.onShow(function(t){wx.setKeepScreenOn({keepScreenOn:!0})}),wx.onHide(function(t){wx.setKeepScreenOn({keepScreenOn:!1})}),wx.showShareMenu({success:function(){wx.onShareAppMessage(function(){return{title:"\u95ea\u70c1\u4e4b\u5149",imageUrl:""}})}}),wx.getSetting({success:function(t){if(cc.log(t),t.authSetting["scope.userInfo"])a.checkLoginStatus();else{var e=wx.getSystemInfoSync(),i=wx.createUserInfoButton({type:"text",text:"",style:{left:0,bottom:0,width:e.screenWidth,height:e.screenHeight/2,lineHeight:40,backgroundColor:"",color:"#ffffff",textAlign:"center",fontSize:16,borderRadius:4}});i.show(),i.onTap(function(t){i.hide(),a.checkLoginStatus(),console.log(t)})}}}))},a.initTopInfo=function(){var t=wx.getMenuButtonBoundingClientRect(),e=wx.getSystemInfoSync();window.WX_FIT=t.top/e.screenHeight*.8||0,console.log("\u5fae\u4fe1\u5c0f\u6e38\u620f\u83dc\u5355\u680f\u7684\u9002\u914d\u503c"),cc.log(WX_FIT)},a.checkLoginStatus=function(){try{var t=this.account_info=wx.getStorageSync("account_info");t?a.checkSessionKey(t):a.login()}catch(t){}},a.login=function(){window.wx&&wx.login({success:function(t){t.code?(cc.log("\u521d\u59cb\u5316\u767b\u5f55\u4fe1\u606f\u8fd4\u56de"),cc.log(t),wx.request({url:"https://s1-wx-h5sszg.shiyuegame.com/api.php/pf/wx/login/",method:"POST",data:{js_code:t.code,cps:"wxtest"},header:{"content-type":"application/json"},success:function(t){if(cc.log("\u670d\u52a1\u5668\u767b\u5f55\u4fe1\u606f\u8fd4\u56de"),cc.log(t),t&&t.data&&666==t.data.error)try{console.log("\u4fdd\u5b58\u7528\u6237\u4fe1\u606f\u5230\u672c\u5730"),cc.log(t.data.msg),a.account_info=t.data.msg,wx.setStorageSync("account_info",t.data.msg),a.initUserInfo()}catch(t){}}})):console.log("\u767b\u5f55\u5931\u8d25\uff01"+t.errMsg)}})},a.checkSessionKey=function(t){cc.log("\u6821\u9a8ckey\u662f\u5426\u8fc7\u671f"),wx.checkSession({success:function(){a.initUserInfo()},fail:function(){a.login()}})},a.initUserInfo=function(){wx.getUserInfo({success:function(t){a.user_info=t,cc.log("\u83b7\u53d6\u7528\u6237\u4fe1\u606f\u6210\u529f"),cc.log(t),a.setLoginData(t)},fail:function(t){cc.log("\u83b7\u53d6\u7528\u6237\u4fe1\u606f\u5931\u8d25")}})},a.setLoginData=function(t){this.user_info=t,this.sdkBackLogin()},a.sdkBackLogin=function(){var t={};t.usrName="wx_"+this.account_info.openid,t.password="wx123456",console.log("\u5fae\u4fe1\u6570\u636e\u521d\u59cb\u82b1\u6210\u529f\uff0c\u5f00\u59cb\u8bf7\u6c42\u670d\u52a1\u5668\u5217\u8868"),s.getInstance().loginPlatformRequest(t)},a.pay=function(e,i,o,l,r,c,_){console.log("\u5f00\u59cb\u8c03\u7528\u652f\u4ed8");var h=s.getInstance().model.getLoginInfo(),d=n.getInstance().getRoleVo();if(null!=d){var u=d.srv_id.split("_"),m=u[0]||"",f=u[1],p=wx.getSystemInfoSync().system,g="";p.indexOf("iOS")>-1||p.indexOf("Android")>-1&&(g="android");var v={openid:a.account_info.openid,time:a.account_info.time,sign:a.account_info.sign,zone_id:f,pf:g,cps:"wxtest"};wx.request({url:"https://"+h.host+"/api.php/pf/wx/balance",method:"POST",data:v,header:{"content-type":"application/json"},success:function(i){if(console.log("\u8bf7\u6c42\u4f59\u989d",i),i&&i.data&&666==i.data.error)try{var s=Math.ceil(Date.now()/1e3);l=l||10*e+"\u94bb\u77f3";var n="wxtest",r=CHANNEL,c=d.rid+"$$"+m+"$$"+f+"$$"+r+"$$"+o+"$$"+l+"$$"+n+"$$"+s;cc.log("\u62d3\u5c55\u53c2\u6570_extension==>",c);var _=t("base64").Base64;c=_.encode(c),cc.log("\u62d3\u5c55\u53c2\u6570_extension==222222222>",c),i.data.msg&&(i.data.msg.balance>=10*e?wx.request({url:"https://"+h.host+"/api.php/pf/wx/pay",method:"POST",data:{openid:a.account_info.openid,zone_id:f,pf:g,amt:10*e,time:a.account_info.time,sign:a.account_info.sign,app_remark:c,cps:n},header:{"content-type":"application/json"},success:function(t){console.log("\u9884\u4e0b\u5355\u8fd4\u56de"),console.log(t),t&&t.data&&(666==t.data.error||1==t.data.error||-1==t.data.error&&console.log("\u5145\u503c\u5931\u8d25"))}}):wx.requestMidasPayment({mode:"game",env:1,offerId:"1450021881",currencyType:"CNY",platform:g,buyQuantity:10*e,zoneId:f,success:function(t){console.log("\u652f\u4ed8\u56de\u8c03\u6210\u529f"),wx.request({url:"https://"+h.host+"/api.php/pf/wx/pay",method:"POST",data:{openid:a.account_info.openid,zone_id:f,pf:g,amt:10*e,time:a.account_info.time,sign:a.account_info.sign,app_remark:c,cps:n},header:{"content-type":"application/json"},success:function(t){console.log("\u9884\u4e0b\u5355\u8fd4\u56de"),console.log(t),t&&t.data&&(666==t.data.error||1==t.data.error||-1==t.data.error&&console.log("\u5145\u503c\u5931\u8d25"))}})},fail:function(t){console.log("\u652f\u4ed8\u56de\u8c03\u5931\u8d25",t)},complete:function(t){console.log("\u652f\u4ed8\u56de\u8c03complete",t)}}))}catch(t){}}})}},a.loginGame=function(){var t=s.getInstance().getTestAccount();cc.log("\u4f7f\u7528\u4e86\u5fae\u4fe1\u6d4b\u8bd5\u8d26\u53f7"),cc.log(t);var e={};e.account=t||"wx_"+this.account_info.openid,e.rawData=this.user_info.rawData,e.signature=this.user_info.signature,e.channel=CHANNEL,e.package_name=PACKAGE_NAME,e.package_version=PACKAGE_VERSION,e.platform=PLATFORM,e.token=a.account_info.session_key,e.timestamp=a.account_info.time,e.sign=a.account_info.sign,s.getInstance().cusSDKLogin(e)},a.submitLogin=function(t){if(t){var e="https://"+t+"/api.php/pf/wx/session";console.log(e),console.log(a.account_info),wx.request({url:e,method:"POST",data:{session_key:a.account_info.session_key,openid:a.account_info.openid,time:a.account_info.time,sign:a.account_info.sign,cps:"wxtest"},header:{"content-type":"application/json"},success:function(t){cc.log("\u670d\u52a1\u5668\u767b\u5f55\u4fe1\u606f\u8fd4\u56de"),cc.log(t),t&&t.data&&(console.log(t.data),t.data.error)}})}},a.getCurrChannel=function(){},a.getSubChannel=function(){},a.loginLog=function(){var t=wx.getLaunchOptionsSync();if(console.log("xhj------------",t),null!=t&&null!=t.query&&null!=t.query.weixinadinfo){var e=t.query.weixinadinfo.split(".")[0];if(null!=e){var i=window.location.href;console.log("xhj+++++++++++++",i),wx.request({url:"",method:"POST",data:{sku:t.query.sku,app_id:t.query.app_id,sy_ad_id:t.query.sy_ad_id,channel_id:t.query.channel_id,gdt_vid:t.query.gdt_vid,weixinadinfo:t.query.weixinadinfo,sub_ad_id:e,url:i},header:{"content-type":"application/json"},success:function(t){console.log("\u4e0a\u62a5\u767b\u5f55\u4fe1\u606f\u8fd4\u56de"),console.log(t)}})}}},a.download_qrcode_png=function(){wx.request({url:"https://s1-h5mlf-h5sszg.shiyuegame.com/api.php/pf/wx/token",method:"POST",data:{cps:"wxtest"},header:{"content-type":"application/json"},success:function(t){if(666==t.data.error){console.log("\u83b7\u53d6assess_token"),console.log(t);var e=wx.getLaunchOptionsSync(),i=decodeURIComponent(e.scene);console.log("\u83b7\u53d6\u5c0f\u6e38\u620fscene"),console.log(e),console.log(i),console.log("\u8bf7\u6c42\u4e8c\u7ef4\u7801\u76f8\u5173")}}})},a.createGameClubButton=function(){wx.createGameClubButton({icon:"green",style:{left:10,top:76,width:40,height:40}})},e.exports=a,cc._RF.pop()},{base64:"base64",login_controller:"login_controller",role_controller:"role_controller","sha1.min":"sha1.min"}]},{},["baseclass","basecontroller","basepanel","baserole","baseview","common_explain_window","common_scrollview","common_scrollview_single","common_tab_btn","common_window_tab","commonaction","commonalert","commonalertwin","commoninputalertwin","commonitemalertwin","CusRichText","downloadmanager","fileinfo","globalmessagemgr","gmcmd","itemspool","loadermanager","playerhead","red_mgr","soundmanager","spine_loading_item","viewclass","viewmanager","config","game_views","gamestart","lang","action_const","action_controller","action_event","action_model","action_acc_level_up_gift_panel","action_buy_skin_panel","action_buy_skin_window","action_common_Item","action_common_panel","action_func_award_Item","action_func_one_Item","action_fund_award_window","action_fund_one_panel","action_grow_fund_Item","action_grow_fund_panel","action_high_value_gift_panel","action_limit_buy_item","action_limit_buy_panel","action_limit_change_panel","action_limit_common_item","action_limit_gift_main_panel","action_limit_gift_main_window","action_limit_yuanzhen_panel","action_main_window","action_mysterious_store_item","action_mysterious_store_panel","action_open_server_gift_item_panel","action_open_server_gift_window","action_seven_goal_item_panel","action_seven_goal_window","action_seven_login_item_panel","action_seven_login_window","action_sub_tab_vo","action_time_gift_big_window","action_time_gift_item","action_time_shop_item","action_time_shop_panel","action_treasure_get_window","action_treasure_window","activity_const","activity_controller","activity_event","activity_model","activity_item_panel","activity_sign_window","activity_window","adventure_const","adventure_controller","adventure_event","adventure_model","adventure_box_reward_item_panel","adventure_box_reward_window","adventure_cell_item_panel","adventure_evt_answer_start_window","adventure_evt_answer_window","adventure_evt_box_window","adventure_evt_challenge_window","adventure_evt_fighterguess_window","adventure_evt_free_box_window","adventure_evt_npc_window","adventure_evt_other_npc_window","adventure_evt_shop_window","adventure_floor_result_item_panel","adventure_floor_result_window","adventure_form_window","adventure_main_window","adventure_shop_item_panel","adventure_shop_window","adventure_shot_kill_window","adventure_use_hp_window","adventureactivity_const","adventureactivity_controller","adventureactivity_model","adventureactivity_item_panel","adventureactivity_window","arena_champion_info_vo","arena_champion_model","arena_const","arena_controller","arena_event","arena_loop_challenge_vo","arena_model","arena_enter_champion_panel","arena_enter_loop_panel","arena_enter_window","arena_champion_cur_guess_panel","arena_champion_cur_rank_item","arena_champion_cur_rank_panel","arena_champion_guess_window","arena_champion_match_window","arena_champion_my_guess_item","arena_champion_my_guess_window","arena_champion_my_match_panel","arena_champion_my_match_ready_panel","arena_champion_rank_awards_item","arena_champion_rank_awards_window","arena_champion_rank_item","arena_champion_rank_window","arena_champion_report_item","arena_champion_report_window","arena_champion_top_32_1_panel","arena_champion_top_32_2_panel","arena_champion_top_32_panel","arena_champion_vs_panel","arean_loop_rank_item","arena_loop_activity_item","arena_loop_activity_panel","arena_loop_awards_item","arena_loop_awards_panel","arena_loop_challenge_buy_window","arena_loop_challenge_check_window","arena_loop_challenge_item","arena_loop_challenge_panel","arena_loop_match_window","arena_loop_my_log_item","arena_loop_my_log_window","arena_loop_rank_panel","arena_loop_result_window","backpack_const","backpack_controller","backpack_event","backpack_model","goods_vo","backpack_batchuse_window","backpack_item","backpack_sell_window","backpack_window","gift_select_item_panel","gift_select_window","item_sell_panel_window","round_item_panel","toggle_item","battle_buff_data","battle_const","battle_controller","battle_data","battle_event","battle_hook_model","battle_loop","battle_model","battle_res_pool","battle_role_data","battle_role_pool","skill_act","battle_buff_info_item_panel","battle_buff_info_window","battle_buff_list_item_panel","battle_buff_list_window","battle_button_list_panel","battle_camp_Item","battle_camp_window","battle_effect","battle_fail_window","battle_form_panel","battle_harm_info_item","battle_harm_info_window","battle_mvp_window","battle_pk_result_window","battle_result_window","battle_role","battle_scene","battle_drama_controller","battle_drama_event","battle_drama_model","battle_drama_boos_info_window","battle_drama_drop_boss_item","battle_drama_drop_sec_boss_item","battle_drama_drop_tips_panel","battle_drama_drop_window","battle_drama_hook_reward_list_panel","battle_drama_hook_reward_window","battle_drama_main_point_item","battle_drama_map_window","battle_drama_pass_vedio_item_panel","battle_drama_pass_vedio_window","battle_drama_quick_window","battle_drama_reward_item_panel","battle_drama_reward_window","battle_drama_unlock_chapter_window","battle_drama_unlock_window","chat_const","chat_controller","chat_event","chat_help","chat_item_controller","chat_model","chat_friend","chat_input","chat_input_list","chat_item","chat_window","equip_item","face_item","goods_item","crossshow_controller","crossshow_event","crossshow_model","crossshow_main_window","daycharge_controller","daycharge_event","daycharge_model","daycharge_window","element_controller","element_model","elitesummon_const","elitesummon_controller","elitesummon_event","elitesummon_model","elitesummon_panel","endless_trail_controller","endless_trail_event","endless_trail_model","endless_awards_item_panel","endless_awards_panel","endless_friend_help_item_2_panel","endless_friend_help_item_panel","endless_friend_help_window","endless_help_me_panel","endless_me_help_panel","endless_rank_item_panel","endless_rank_panel","endless_rank_window","endless_reward_window","endless_trail_battle_window","endless_trail_buff_item_panel","endless_trail_buff_window","endless_trail_main_window","endlesstrail_awards_tips_window","esecsice_const","esecsice_controller","esecsice_model","esecsice_item","esecsice_window","exchange_controller","exchange_event","exchange_model","exchange_window","forgehouse_const","forgehouse_controller","forgehouse_model","artifact_award_window","artifact_skill_item","artifact_skill_window","equipment_all_synthesis_window","equipment_comp_record_item","equipment_comp_record_window","forge_artifact_panel","forge_equip_panel","forge_house_window","forgehouse_item_panel","friend_const","friend_controller","friend_event","friend_model","friend_vo","friend_add_window","friend_apply_panel","friend_award_panel","friend_black_panel","friend_check_info_winodw","friend_glory_item","friend_glory_window","friend_list_item","friend_list_panel","friend_window","guide_const","guide_controller","guide_event","guide_model","guide_main_window","task_guide_window","guild_const","guild_controller","guild_event","guild_list_vo","guild_member_vo","guild_model","guild_my_info_vo","guild_action_goal_item","guild_action_goal_window","guild_apply_item","guild_apply_set_window","guild_apply_window","guild_change_name_window","guild_change_sign_window","guild_create_panel","guild_donate_item","guild_donate_window","guild_impeach_post_window","guild_list_panel","guild_main_window","guild_member_item","guild_member_window","guild_operation_post_window","guild_request_item","guild_reward_item","guild_reward_window","guild_search_panel","guildinit_window","guildboss_const","guildboss_controller","guildboss_event","guildboss_model","guildboss_main_window","guildboss_preview_item_panel","guildboss_preview_window","guildboss_rank_item_panel","guildboss_rank_window","guildboss_result_window","guildskill_const","guildskill_controller","guildskill_event","guildskill_model","guildskill_item","guildskill_main_window","guildwar_box_vo","guildwar_const","guildwar_controller","guildwar_event","guildwar_model","guildwar_position_vo","guildwar_attk_look_item","guildwar_attk_look_window","guildwar_attk_position_window","guildwar_award_box_item","guildwar_award_box_window","guildwar_award_item","guildwar_award_window","guildwar_battle_array_panel","guildwar_battle_list_item","guildwar_battle_list_window","guildwar_battle_log_item","guildwar_battle_log_window","guildwar_defend_look_item","guildwar_defend_look_window","guildwar_main_window","guildwar_position_item","guildwar_rank_window","hallows_const","hallows_controller","hallows_event","hallows_model","hallows_vo","hallows_activity_window","hallows_main_window","hallows_preview_item_panel","hallows_preview_window","hallows_step_up_window","hallows_task_item_panel","hallows_task_window","hallows_tips_window","hallows_trace_window","artifact_chose_window","artifact_com_tips_window","artifact_list_item","artifact_list_window","artifact_recast_window","artifact_tips_window","equip_cloth_item","equip_cloth_window","form_filter_hero_panel","form_go_fight_window","form_hallows_select_item","form_hallows_select_window","form_select_panel","hero_calculate","hero_const","hero_controller","hero_event","hero_model","hero_vo","skill_item","hero_bag_window","hero_break_exhibition_window","hero_break_window","hero_exhibition_item","hero_library_info_window","hero_library_main_item","hero_library_main_window","hero_library_story_window","hero_look_draw_window","hero_main_equip_panel","hero_main_info_window","hero_main_talent_panel","hero_main_upgrade_star_panel","hero_mian_train_panel","hero_reset_offer_window","hero_reset_window","hero_rest_return_window","hero_skin_tips_window","hero_skin_window","hero_smroom_info_window","hero_smroom_main_item","hero_smroom_main_window","hero_talent_skill_learn_window","hero_talent_skill_level_up_window","hero_tips_attr_window","hero_tips_window","hero_upgrade_star_exhibition_window","hero_upgrade_star_fuse_window","hero_upgrade_star_select_window","skill_unlock_window","heroexpedit_controller","heroexpedit_event","heroexpedit_model","browse_window","empoly_item_panel","empoly_window","heroexpedit_level_window","heroexpedit_window","invitecode_controller","invitecode_event","invitecode_model","invitecode_friend_item","invitecode_friend_panel","invitecode_my_item","invitecode_my_panel","invitecode_panel","ladder_const","ladder_controller","ladder_event","ladder_model","ladder_award_item","ladder_award_window","ladder_battle_result_window","ladder_god_log_item","ladder_log_window","ladder_main_window","ladder_my_log_item","ladder_rank_window","ladder_role_info_window","ladder_role_item","ladder_shop_window","ladder_top_three_window","levupgrade_controller","levupgrade_model","lev_upgrade_window","limitExercise_const","limitexercise_controller","limitexercise_event","limitexercise_model","limit_exercise_reward_item_panel","limitexercise_change_item_panel","limitexercise_change_window","limitexercise_hero_item_panel","limitexercise_panel","limitexercise_reward_window","login_controller","login_event","login_model","login_platform","enter_panel","login_window","server_list_item_panel","server_list_window","user_panel","look_controller","look_model","mail_controller","mail_event","mail_model","mail_vo","notice_vo","mail_cell","mail_info_window","mail_window","build_item","mainscene_const","mainscene_controller","mainscene_event","mainscene_model","scene_const","mainscene","build_vo","mainui_const","mainui_controller","mainui_event","mainui_model","customer_service_window","function_icon_panel","function_icon_vo","item_exhibition_list_panel","item_exhibition_window","mainui_view","task_tips_panel","mall_const","mall_controller","mall_event","mall_model","mall_action_window","mall_buy_window","mall_item","mall_son_panel","mall_window","variety_store_item_panel","variety_store_window","newfirstcharge_controller","newfirstcharge_event","newfirstcharge_model","newfirstcharge1_window","newfirstcharge_window","notice_controller","notice_model","bug_panel","notice_window","onlinegift_controller","onlinegift_event","onlinegift_model","onlinegift_window","orderaction_const","orderaction_controller","orderaction_event","orderaction_model","buy_lev_window","orderaction_end_warn_window","orderaction_main_window","orderaction_reward_item_panel","orderaction_reward_panel","orderaction_tesk_item_panel","orderaction_tesk_panel","untie_reward_1_window","untie_reward_window","partner_calculate","partner_const","partner_event","partner_model","partnersummon_const","partnersummon_controller","partnersummon_event","partnersummon_model","hero_get_item","partnersummon_gain_window","partnersummon_item","partnersummon_score_window","partnersummon_show_window","partnersummon_window","pokedex_controller","pokedex_event","pokedex_model","partner_comment_window","pokedex_comment_item","primus_controller","primus_event","primus_model","primus_challenge_record_item_panel","primus_challenge_record_window","primus_challenge_result_item_panel","primus_challenge_result_window","primus_challenge_window","primus_main_window","prompt_controller","prompt_event","prompt_model","prompt_type_const","prompt_vo","rank_constant","rank_controller","rank_event","rank_model","rank_item","rank_main_item","rank_main_window","rank_reward_item","rank_reward_window","rank_window","recruithero_controller","recruithero_event","recruithero_model","recruit_hero_window","redbag_controller","redbag_event","redbag_model","redbag_get_panel","redbag_item","redbag_list_panel","redbag_look_item","redbag_look_window","redbag_open_window","redbag_rank_item","redbag_rank_panel","redbag_send_panel","redbag_window","role_controller","role_event","role_model","role_vo","role_body_panel","role_decorate_window","role_face_item","role_face_panel","role_faced_panel","role_head_item","role_head_panel","role_reported_window","role_set_window","role_setname_window","role_title_panel","seerpalace_const","seerpalace_controller","seerpalace_event","seerpalace_model","seerpalace_change_panel","seerpalace_main_window","seerpalace_preview_window","seerpalace_shop_window","seerpalace_summon_Item","seerpalace_summon_panel","startower_controller","startower_event","startower_model","star_tower_award_item_panel","star_tower_award_window","star_tower_get_window","star_tower_item_panel","star_tower_list","star_tower_main_window","star_tower_result_window","star_tower_video_window","star_tower_window_window","stone_dungeon_controller","stone_dungeon_event","stone_dungeon_model","stone_dungeon_item","stone_dungeon_tab","stone_dungeon_window","story_controller","story_event","story_model","story_talk","story_view","stronger_controller","stronger_event","stronger_model","Stronger_panel_item","strong_main_window","stronger_panel","task_const","task_controller","task_event","task_model","task_vo","feat_panel","task_item","task_main_window","task_notice_view","task_panel","timesummon_const","timesummon_controller","timesummon_event","timesummon_model","action_time_summon_panel","time_summon_award_window","time_summon_preview_window","time_summon_progress_window","tips_const","tips_controller","tips_model","adventure_buff_tips","backpack_comp_tips_window","backpack_tips","common_tips","comp_choose_tips_window","equip_tips","head_circle_tips","skill_tips_window","source_item","tips_source_window","week_card_tips_window","vedio_const","vedio_controller","vedio_event","vedio_model","vedio_collect_window","vedio_item_panel","vedio_look_window","vedio_main_window","vedio_myself_window","vedio_share_window","charge_item","charge_panel","daily_gift_item","daily_gift_panel","privilege_item","privilege_panel","vip_award_item_panel","vip_award_window","vip_label_item_panel","vip_main_tab_panel","vip_main_window","vip_panel","vip_panel_item","vip_controller","vip_event","vip_model","voyage_dispatch_window","voyage_main_window","voyage_order_item","voyage_const","voyage_controller","voyage_event","voyage_model","voyage_order_vo","bind_phone_panel","certify_bind_phone_window","collect_panel","honor_yueka_panel","month_item","month_week_panel","notice_panel","paste_panel","qrcode_shard_panel","sign_item","sign_panel","start_work_panel","subscription_wechat_panel","supre_yueka_panel","sureveyquest_window","weixin_gift_panel","welfare_main_window","welfare_sub_tab_vo","welfare_tab_panel","welfare_const","welfare_controller","welfare_event","welfare_model","worldmap_item","worldmap_land","worldmap_main_window","worldmap_controller","worldmap_model","proto_mate","playeffect","sdk_config","sdk_lib","awy_sdk","qq_sdk","sdk","sh_rh","sh_sdk","sh_client","shsdk","shsdk_conf","wx_sdk","base64","game-core-js-min","jump_controller","pako","sys_controller","ZipLoader","jszip","cli_log","functiontool","global","md5.min","merge_json","modulelist","pathtool","sha1.min","string_util","timetool","utils","use_v2.0.x_cc.Toggle_event"]);